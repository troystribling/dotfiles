{"version":3,"file":"text.js","sourceRoot":"","sources":["../../../../coreutils/src/text.ts"],"names":[],"mappings":";AAAA,0CAA0C;AAC1C,2DAA2D;;AAE3D;;GAEG;AACH,IACU,IAAI,CAqEb;AAtED,WACU,IAAI;IAEZ,uEAAuE;IACvE,+DAA+D;IAC/D,qDAAqD;IACrD,0EAA0E;IAC1E,wDAAwD;IAExD,IAAM,cAAc,GAAY,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;IAElD;;;;;;;;OAQG;IACH,4BAC6B,KAAa,EAAE,IAAY;QACtD,EAAE,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC;YACnB,sCAAsC;YACtC,MAAM,CAAC,KAAK,CAAC;QACf,CAAC;QACD,IAAI,OAAO,GAAG,KAAK,CAAC;QACpB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,MAAM,IAAI,CAAC,GAAG,KAAK,EAAE,CAAC,EAAE,EAAE,CAAC;YACtD,IAAI,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;YAClC,2BAA2B;YAC3B,EAAE,CAAC,CAAC,QAAQ,IAAI,MAAM,IAAI,QAAQ,IAAI,MAAM,CAAC,CAAC,CAAC;gBAC7C,IAAI,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,GAAC,CAAC,CAAC,CAAC;gBACxC,EAAE,CAAC,CAAC,YAAY,IAAI,MAAM,IAAI,YAAY,IAAI,MAAM,CAAC,CAAC,CAAC;oBACrD,OAAO,EAAE,CAAC;oBACV,CAAC,EAAE,CAAC;gBACN,CAAC;YACH,CAAC;QACH,CAAC;QACD,MAAM,CAAC,OAAO,CAAC;IACjB,CAAC;IAlBQ,uBAAkB,qBAkB1B,CAAA;IAED;;;;;;;;OAQG;IACH,4BAC6B,OAAe,EAAE,IAAY;QACxD,EAAE,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC;YACnB,sCAAsC;YACtC,MAAM,CAAC,OAAO,CAAC;QACjB,CAAC;QACD,IAAI,KAAK,GAAG,OAAO,CAAC;QACpB,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,MAAM,IAAI,CAAC,GAAG,KAAK,EAAE,CAAC,EAAE,EAAE,CAAC;YACtD,IAAI,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;YAClC,2BAA2B;YAC3B,EAAE,CAAC,CAAC,QAAQ,IAAI,MAAM,IAAI,QAAQ,IAAI,MAAM,CAAC,CAAC,CAAC;gBAC7C,IAAI,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,GAAC,CAAC,CAAC,CAAC;gBACxC,EAAE,CAAC,CAAC,YAAY,IAAI,MAAM,IAAI,YAAY,IAAI,MAAM,CAAC,CAAC,CAAC;oBACrD,KAAK,EAAE,CAAC;oBACR,CAAC,EAAE,CAAC;gBACN,CAAC;YACH,CAAC;QACH,CAAC;QACD,MAAM,CAAC,KAAK,CAAC;IACf,CAAC;IAlBQ,uBAAkB,qBAkB1B,CAAA;AACH,CAAC,EArES,IAAI,GAAJ,YAAI,KAAJ,YAAI,QAqEb","sourcesContent":["// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\n/**\n * The namespace for text-related functions.\n */\nexport\nnamespace Text {\n\n  // javascript stores text as utf16 and string indices use \"code units\",\n  // which stores high-codepoint characters as \"surrogate pairs\",\n  // which occupy two indices in the javascript string.\n  // We need to translate cursor_pos in the Jupyter protocol (in characters)\n  // to js offset (with surrogate pairs taking two spots).\n\n  const HAS_SURROGATES: boolean = ('𝐚'.length > 1);\n\n  /**\n   * Convert a javascript string index into a unicode character offset\n   *\n   * @param jsIdx - The javascript string index (counting surrogate pairs)\n   *\n   * @param text - The text in which the offset is calculated\n   *\n   * @returns The unicode character offset\n   */\n  export\n  function jsIndexToCharIndex (jsIdx: number, text: string): number {\n    if (HAS_SURROGATES) {\n      // not using surrogates, nothing to do\n      return jsIdx;\n    }\n    var charIdx = jsIdx;\n    for (var i = 0; i + 1 < text.length && i < jsIdx; i++) {\n      var charCode = text.charCodeAt(i);\n      // check for surrogate pair\n      if (charCode >= 0xD800 && charCode <= 0xDBFF) {\n        var nextCharCode = text.charCodeAt(i+1);\n        if (nextCharCode >= 0xDC00 && nextCharCode <= 0xDFFF) {\n          charIdx--;\n          i++;\n        }\n      }\n    }\n    return charIdx;\n  }\n\n  /**\n   * Convert a unicode character offset to a javascript string index.\n   *\n   * @param charIdx - The index in unicode characters\n   *\n   * @param text - The text in which the offset is calculated\n   *\n   * @returns The js-native index\n   */\n  export\n  function charIndexToJsIndex (charIdx: number, text: string): number {\n    if (HAS_SURROGATES) {\n      // not using surrogates, nothing to do\n      return charIdx;\n    }\n    var jsIdx = charIdx;\n    for (var i = 0; i + 1 < text.length && i < jsIdx; i++) {\n      var charCode = text.charCodeAt(i);\n      // check for surrogate pair\n      if (charCode >= 0xD800 && charCode <= 0xDBFF) {\n        var nextCharCode = text.charCodeAt(i+1);\n        if (nextCharCode >= 0xDC00 && nextCharCode <= 0xDFFF) {\n          jsIdx++;\n          i++;\n        }\n      }\n    }\n    return jsIdx;\n  }\n}\n"]}