{"version":3,"file":"default.js","sourceRoot":"","sources":["../../../../../services/src/session/default.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\n import {\n  URLExt\n } from '@jupyterlab/coreutils';\n\nimport {\n  ArrayExt, each, find\n} from '@phosphor/algorithm';\n\nimport {\n  ISignal, Signal\n} from '@phosphor/signaling';\n\nimport {\n  Kernel, KernelMessage\n} from '../kernel';\n\nimport {\n  ServerConnection\n} from '..';\n\nimport {\n  Session\n} from './session';\n\nimport * as validate\n  from './validate';\n\n\n/**\n * The url for the session service.\n */\nconst SESSION_SERVICE_URL = 'api/sessions';\n\n\n/**\n * Session object for accessing the session REST api. The session\n * should be used to start kernels and then shut them down -- for\n * all other operations, the kernel object should be used.\n */\nexport\nclass DefaultSession implements Session.ISession {\n  /**\n   * Construct a new session.\n   */\n  constructor(options: Session.IOptions, id: string, kernel: Kernel.IKernel) {\n    this._id = id;\n    this._path = options.path;\n    this._type = options.type || 'file';\n    this._name = options.name || '';\n    this.serverSettings = options.serverSettings || ServerConnection.makeSettings();\n    Private.addRunning(this);\n    this.setupKernel(kernel);\n    this.terminated = new Signal<this, void>(this);\n  }\n\n  /**\n   * A signal emitted when the session is shut down.\n   */\n  readonly terminated: Signal<this, void>;\n\n  /**\n   * A signal emitted when the kernel changes.\n   */\n  get kernelChanged(): ISignal<this, Kernel.IKernelConnection> {\n    return this._kernelChanged;\n  }\n\n  /**\n   * A signal emitted when the kernel status changes.\n   */\n  get statusChanged(): ISignal<this, Kernel.Status> {\n    return this._statusChanged;\n  }\n\n  /**\n   * A signal emitted for a kernel messages.\n   */\n  get iopubMessage(): ISignal<this, KernelMessage.IIOPubMessage> {\n    return this._iopubMessage;\n  }\n\n  /**\n   * A signal emitted for an unhandled kernel message.\n   */\n  get unhandledMessage(): ISignal<this, KernelMessage.IMessage> {\n    return this._unhandledMessage;\n  }\n\n  /**\n   * A signal emitted when a session property changes.\n   */\n  get propertyChanged(): ISignal<this, 'path' | 'name' | 'type'> {\n    return this._propertyChanged;\n  }\n\n  /**\n   * Get the session id.\n   */\n  get id(): string {\n    return this._id;\n  }\n\n  /**\n   * Get the session kernel object.\n   *\n   * #### Notes\n   * This is a read-only property, and can be altered by [changeKernel].\n   * Use the [statusChanged] and [unhandledMessage] signals on the session\n   * instead of the ones on the kernel.\n   */\n  get kernel() : Kernel.IKernelConnection {\n    return this._kernel;\n  }\n\n  /**\n   * Get the session path.\n   */\n  get path(): string {\n    return this._path;\n  }\n\n  /**\n   * Get the session type.\n   */\n  get type(): string {\n    return this._type;\n  }\n\n  /**\n   * Get the session name.\n   */\n  get name(): string {\n    return this._name;\n  }\n\n  /**\n   * Get the model associated with the session.\n   */\n  get model(): Session.IModel {\n    return {\n      id: this.id,\n      kernel: this.kernel.model,\n      path: this._path,\n      type: this._type,\n      name: this._name\n    };\n  }\n\n  /**\n   * The current status of the session.\n   *\n   * #### Notes\n   * This is a delegate to the kernel status.\n   */\n  get status(): Kernel.Status {\n    return this._kernel ? this._kernel.status : 'dead';\n  }\n\n  /**\n   * The server settings of the session.\n   */\n  readonly serverSettings: ServerConnection.ISettings;\n\n  /**\n   * Test whether the session has been disposed.\n   */\n  get isDisposed(): boolean {\n    return this._isDisposed === true;\n  }\n\n  /**\n   * Clone the current session with a new clientId.\n   */\n  clone(): Promise<Session.ISession> {\n    return Kernel.connectTo(this.kernel.id, this.serverSettings).then(kernel => {\n      return new DefaultSession({\n        path: this._path,\n        serverSettings: this.serverSettings\n      }, this._id, kernel);\n    });\n  }\n\n  /**\n   * Update the session based on a session model from the server.\n   */\n  update(model: Session.IModel): Promise<void> {\n    // Avoid a race condition if we are waiting for a REST call return.\n    if (this._updating) {\n      return Promise.resolve(void 0);\n    }\n    let oldModel = this.model;\n    this._path = model.path;\n    this._name = model.name;\n    this._type = model.type;\n\n    if (this._kernel.isDisposed || model.kernel.id !== this._kernel.id) {\n      return Kernel.connectTo(model.kernel.id, this.serverSettings).then(kernel => {\n        this.setupKernel(kernel);\n        this._kernelChanged.emit(kernel);\n        this._handleModelChange(oldModel);\n      });\n    }\n\n    this._handleModelChange(oldModel);\n    return Promise.resolve(void 0);\n  }\n\n  /**\n   * Dispose of the resources held by the session.\n   */\n  dispose(): void {\n    if (this.isDisposed) {\n      return;\n    }\n    this._isDisposed = true;\n    this._kernel.dispose();\n    Private.removeRunning(this);\n    Signal.clearData(this);\n  }\n\n  /**\n   * Change the session path.\n   *\n   * @param path - The new session path.\n   *\n   * @returns A promise that resolves when the session has renamed.\n   *\n   * #### Notes\n   * This uses the Jupyter REST API, and the response is validated.\n   * The promise is fulfilled on a valid response and rejected otherwise.\n   */\n  setPath(path: string): Promise<void> {\n    if (this.isDisposed) {\n      return Promise.reject(new Error('Session is disposed'));\n    }\n    let data = JSON.stringify({ path });\n    return this._patch(data).then(() => { return void 0; });\n  }\n\n  /**\n   * Change the session name.\n   */\n  setName(name: string): Promise<void> {\n    if (this.isDisposed) {\n      return Promise.reject(new Error('Session is disposed'));\n    }\n    let data = JSON.stringify({ name });\n    return this._patch(data).then(() => { return void 0; });\n  }\n\n  /**\n   * Change the session type.\n   */\n  setType(type: string): Promise<void> {\n    if (this.isDisposed) {\n      return Promise.reject(new Error('Session is disposed'));\n    }\n    let data = JSON.stringify({ type });\n    return this._patch(data).then(() => { return void 0; });\n  }\n\n  /**\n   * Change the kernel.\n   *\n   * @params options - The name or id of the new kernel.\n   *\n   * #### Notes\n   * This shuts down the existing kernel and creates a new kernel,\n   * keeping the existing session ID and session path.\n   */\n  changeKernel(options: Partial<Kernel.IModel>): Promise<Kernel.IKernelConnection> {\n    if (this.isDisposed) {\n      return Promise.reject(new Error('Session is disposed'));\n    }\n    let data = JSON.stringify({ kernel: options });\n    if (this._kernel) {\n      return this._kernel.ready.then(() => {\n        this._kernel.dispose();\n        return this._patch(data);\n      }).then(() => this.kernel);\n    }\n    return this._patch(data).then(() => this.kernel);\n  }\n\n  /**\n   * Kill the kernel and shutdown the session.\n   *\n   * @returns - The promise fulfilled on a valid response from the server.\n   *\n   * #### Notes\n   * Uses the [Jupyter Notebook API](http://petstore.swagger.io/?url=https://raw.githubusercontent.com/jupyter/notebook/master/notebook/services/api/api.yaml#!/sessions), and validates the response.\n   * Emits a [sessionDied] signal on success.\n   */\n  shutdown(): Promise<void> {\n    if (this.isDisposed) {\n      return Promise.reject(new Error('Session is disposed'));\n    }\n    return Private.shutdownSession(this.id, this.serverSettings);\n  }\n\n  /**\n   * Handle connections to a kernel.\n   */\n  protected setupKernel(kernel: Kernel.IKernel): void {\n    this._kernel = kernel;\n    kernel.statusChanged.connect(this.onKernelStatus, this);\n    kernel.unhandledMessage.connect(this.onUnhandledMessage, this);\n    kernel.iopubMessage.connect(this.onIOPubMessage, this);\n  }\n\n  /**\n   * Handle to changes in the Kernel status.\n   */\n  protected onKernelStatus(sender: Kernel.IKernel, state: Kernel.Status) {\n    this._statusChanged.emit(state);\n  }\n\n  /**\n   * Handle iopub kernel messages.\n   */\n  protected onIOPubMessage(sender: Kernel.IKernel, msg: KernelMessage.IIOPubMessage) {\n    this._iopubMessage.emit(msg);\n  }\n\n  /**\n   * Handle unhandled kernel messages.\n   */\n  protected onUnhandledMessage(sender: Kernel.IKernel, msg: KernelMessage.IMessage) {\n    this._unhandledMessage.emit(msg);\n  }\n\n  /**\n   * Send a PATCH to the server, updating the session path or the kernel.\n   */\n  private _patch(data: string): Promise<Session.IModel> {\n    this._updating = true;\n    let settings = this.serverSettings;\n    let request = {\n      url: Private.getSessionUrl(settings.baseUrl, this._id),\n      method: 'PATCH',\n      data,\n      contentType: 'application/json',\n      cache: false\n    };\n    return ServerConnection.makeRequest(request, settings).then(response => {\n      this._updating = false;\n      if (response.xhr.status !== 200) {\n        throw ServerConnection.makeError(response);\n      }\n      let value = response.data;\n      try {\n        let model = validate.validateModel(value);\n        return Private.updateFromServer(model, settings.baseUrl);\n      } catch (err) {\n        throw ServerConnection.makeError(response, err.message);\n      }\n    }, error => {\n      this._updating = false;\n      return Private.onSessionError(error);\n    });\n  }\n\n  /**\n   * Handle a change to the model.\n   */\n  private _handleModelChange(oldModel: Session.IModel): void {\n    if (oldModel.name !== this._name) {\n      this._propertyChanged.emit('name');\n    }\n    if (oldModel.type !== this._type) {\n      this._propertyChanged.emit('type');\n    }\n    if (oldModel.path !== this._path) {\n      this._propertyChanged.emit('path');\n    }\n  }\n\n  private _id = '';\n  private _path = '';\n  private _name = '';\n  private _type = '';\n  private _kernel: Kernel.IKernel;\n  private _isDisposed = false;\n  private _updating = false;\n  private _kernelChanged = new Signal<this, Kernel.IKernelConnection>(this);\n  private _statusChanged = new Signal<this, Kernel.Status>(this);\n  private _iopubMessage = new Signal<this, KernelMessage.IIOPubMessage>(this);\n  private _unhandledMessage = new Signal<this, KernelMessage.IMessage>(this);\n  private _propertyChanged = new Signal<this, 'path' | 'name' | 'type'>(this);\n}\n\n\n/**\n * The namespace for `DefaultSession` statics.\n */\nexport\nnamespace DefaultSession {\n  /**\n   * List the running sessions.\n   */\n  export\n  function listRunning(settings?: ServerConnection.ISettings): Promise<Session.IModel[]> {\n    return Private.listRunning(settings);\n  }\n\n  /**\n   * Start a new session.\n   */\n  export\n  function startNew(options: Session.IOptions): Promise<Session.ISession> {\n    return Private.startNew(options);\n  }\n\n  /**\n   * Find a session by id.\n   */\n  export\n  function findById(id: string, settings?: ServerConnection.ISettings): Promise<Session.IModel> {\n    return Private.findById(id, settings);\n  }\n\n  /**\n   * Find a session by path.\n   */\n  export\n  function findByPath(path: string, settings?: ServerConnection.ISettings): Promise<Session.IModel> {\n    return Private.findByPath(path, settings);\n  }\n\n  /**\n   * Connect to a running session.\n   */\n  export\n  function connectTo(id: string, settings?: ServerConnection.ISettings): Promise<Session.ISession> {\n    return Private.connectTo(id, settings);\n  }\n\n  /**\n   * Shut down a session by id.\n   */\n  export\n  function shutdown(id: string, settings?: ServerConnection.ISettings): Promise<void> {\n    return Private.shutdownSession(id, settings);\n  }\n}\n\n\n/**\n * A namespace for session private data.\n */\nnamespace Private {\n  /**\n   * The running sessions mapped by base url.\n   */\n  const runningSessions = new Map<string, DefaultSession[]>();\n\n  /**\n   * Add a session to the running sessions.\n   */\n  export\n  function addRunning(session: DefaultSession): void {\n    let running: DefaultSession[] = (\n      runningSessions.get(session.serverSettings.baseUrl) || []\n    );\n    running.push(session);\n    runningSessions.set(session.serverSettings.baseUrl, running);\n  }\n\n  /**\n   * Remove a session from the running sessions.\n   */\n  export\n  function removeRunning(session: DefaultSession): void {\n    let running = runningSessions.get(session.serverSettings.baseUrl);\n    if (running) {\n      ArrayExt.removeFirstOf(running, session);\n    }\n  }\n\n  /**\n   * Connect to a running session.\n   */\n  export\n  function connectTo(id: string, settings?: ServerConnection.ISettings): Promise<Session.ISession> {\n    settings = settings || ServerConnection.makeSettings();\n    let running = runningSessions.get(settings.baseUrl) || [];\n    let session = find(running, value => value.id === id);\n    if (session) {\n      return Promise.resolve(session.clone());\n    }\n    return getSessionModel(id, settings).then(model => {\n      return createSession(model, settings);\n    }).catch(() => {\n      let msg = `No running session with id: ${id}`;\n      return typedThrow<Session.ISession>(msg);\n    });\n  }\n\n  /**\n   * Create a Session object.\n   *\n   * @returns - A promise that resolves with a started session.\n   */\n  export\n  function createSession(model: Session.IModel, settings?: ServerConnection.ISettings): Promise<DefaultSession> {\n    settings = settings || ServerConnection.makeSettings();\n    return Kernel.connectTo(model.kernel.id, settings).then(kernel => {\n      return new DefaultSession({\n        path: model.path,\n        type: model.type,\n        name: model.name,\n        serverSettings: settings\n      }, model.id, kernel);\n    }).catch(error => {\n      return typedThrow('Session failed to start: ' + error.message);\n    });\n  }\n\n  /**\n   * Find a session by id.\n   */\n  export\n  function findById(id: string, settings?: ServerConnection.ISettings): Promise<Session.IModel> {\n    settings = settings || ServerConnection.makeSettings();\n    let running = runningSessions.get(settings.baseUrl) || [];\n    let session = find(running, value => value.id === id);\n    if (session) {\n      return Promise.resolve(session.model);\n    }\n\n    return getSessionModel(id, settings).catch(() => {\n      let msg = `No running session for id: ${id}`;\n      return typedThrow<Session.IModel>(msg);\n    });\n  }\n\n  /**\n   * Find a session by path.\n   */\n  export\n  function findByPath(path: string, settings?: ServerConnection.ISettings): Promise<Session.IModel> {\n    settings = settings || ServerConnection.makeSettings();\n    let running = runningSessions.get(settings.baseUrl) || [];\n    let session = find(running, value => value.path === path);\n    if (session) {\n      return Promise.resolve(session.model);\n    }\n\n    return listRunning(settings).then(models => {\n      let model = find(models, value => {\n        return value.path === path;\n      });\n      if (model) {\n        return model;\n      }\n      let msg = `No running session for path: ${path}`;\n      return typedThrow<Session.IModel>(msg);\n    });\n  }\n\n  /**\n   * Get a full session model from the server by session id string.\n   */\n  export\n  function getSessionModel(id: string, settings?: ServerConnection.ISettings): Promise<Session.IModel> {\n    settings = settings || ServerConnection.makeSettings();\n    let request = {\n      url: getSessionUrl(settings.baseUrl, id),\n      method: 'GET',\n      cache: false\n    };\n    return ServerConnection.makeRequest(request, settings).then(response => {\n      if (response.xhr.status !== 200) {\n        throw ServerConnection.makeError(response);\n      }\n      let data = response.data as Session.IModel;\n      try {\n        validate.validateModel(data);\n      } catch (err) {\n        throw ServerConnection.makeError(response, err.message || String(err));\n      }\n      return updateFromServer(data, settings!.baseUrl);\n    }, Private.onSessionError);\n  }\n\n  /**\n   * Get a session url.\n   */\n  export\n  function getSessionUrl(baseUrl: string, id: string): string {\n    return URLExt.join(baseUrl, SESSION_SERVICE_URL, id);\n  }\n\n  /**\n   * Kill the sessions by id.\n   */\n  function killSessions(id: string, baseUrl: string): void {\n    let running = runningSessions.get(baseUrl) || [];\n    each(running.slice(), session => {\n      if (session.id === id) {\n        session.terminated.emit(void 0);\n        session.dispose();\n      }\n    });\n  }\n\n  /**\n   * List the running sessions.\n   */\n  export\n  function listRunning(settings?: ServerConnection.ISettings): Promise<Session.IModel[]> {\n    settings = settings || ServerConnection.makeSettings();\n    let request = {\n      url: URLExt.join(settings.baseUrl, SESSION_SERVICE_URL),\n      method: 'GET',\n      cache: false\n    };\n    return ServerConnection.makeRequest(request, settings).then(response => {\n      if (response.xhr.status !== 200) {\n        throw ServerConnection.makeError(response);\n      }\n      let data = response.data as Session.IModel[];\n      if (!Array.isArray(response.data)) {\n        throw ServerConnection.makeError(response, 'Invalid Session list');\n      }\n      for (let i = 0; i < data.length; i++) {\n        try {\n          validate.validateModel(data[i]);\n        } catch (err) {\n          throw ServerConnection.makeError(response, err.message);\n        }\n      }\n      return updateRunningSessions(data, settings!.baseUrl);\n    }, Private.onSessionError);\n  }\n\n  /**\n   * Handle an error on a session Ajax call.\n   */\n  export\n  function onSessionError(error: ServerConnection.IError): Promise<any> {\n    let text = (error.message ||\n                error.xhr.statusText ||\n                error.xhr.responseText);\n    let msg = `API request failed: ${text}`;\n    console.error(msg);\n    return Promise.reject(error);\n  }\n\n  /**\n   * Shut down a session by id.\n   */\n  export\n  function shutdownSession(id: string, settings?: ServerConnection.ISettings): Promise<void> {\n    settings = settings || ServerConnection.makeSettings();\n    let request = {\n      url: getSessionUrl(settings.baseUrl, id),\n      method: 'DELETE',\n      cache: false\n    };\n\n    return ServerConnection.makeRequest(request, settings).then(response => {\n      if (response.xhr.status !== 204) {\n        throw ServerConnection.makeError(response);\n      }\n      killSessions(id, settings!.baseUrl);\n    }, err => {\n      if (err.xhr.status === 404) {\n        let response = JSON.parse(err.xhr.responseText) as any;\n        console.warn(response['message']);\n        killSessions(id, settings!.baseUrl);\n        return;\n      }\n      if (err.xhr.status === 410) {\n        err.message = 'The kernel was deleted but the session was not';\n      }\n      return onSessionError(err);\n    });\n  }\n\n  /**\n   * Start a new session.\n   */\n  export\n  function startNew(options: Session.IOptions): Promise<Session.ISession> {\n    if (options.path === void 0) {\n      return Promise.reject(new Error('Must specify a path'));\n    }\n    return startSession(options).then(model => {\n      return createSession(model, options.serverSettings);\n    });\n  }\n\n  /**\n   * Create a new session, or return an existing session if a session if\n   * the session path already exists\n   */\n  export\n  function startSession(options: Session.IOptions): Promise<Session.IModel> {\n    let settings = options.serverSettings || ServerConnection.makeSettings();\n    let model = {\n      kernel: { name: options.kernelName, id: options.kernelId },\n      path: options.path,\n      type: options.type || '',\n      name: options.name || ''\n    };\n    let request = {\n      url: URLExt.join(settings.baseUrl, SESSION_SERVICE_URL),\n      method: 'POST',\n      cache: false,\n      data: JSON.stringify(model),\n      contentType: 'application/json'\n    };\n    return ServerConnection.makeRequest(request, settings).then(response => {\n      if (response.xhr.status !== 201) {\n        throw ServerConnection.makeError(response);\n      }\n      try {\n        validate.validateModel(response.data);\n      } catch (err) {\n        throw ServerConnection.makeError(response, err.message);\n      }\n      let data = response.data as Session.IModel;\n      return updateFromServer(data, settings.baseUrl);\n    }, onSessionError);\n  }\n\n  /**\n   * Throw a typed error.\n   */\n  export\n  function typedThrow<T>(msg: string): T {\n    throw new Error(msg);\n  }\n\n  /**\n   * Update the running sessions given an updated session Id.\n   */\n  export\n  function updateFromServer(model: Session.IModel, baseUrl: string): Promise<Session.IModel> {\n    let promises: Promise<void>[] = [];\n    let running = runningSessions.get(baseUrl) || [];\n    each(running.slice(), session => {\n      if (session.id === model.id) {\n        promises.push(session.update(model));\n      }\n    });\n    return Promise.all(promises).then(() => { return model; });\n  }\n\n  /**\n   * Update the running sessions based on new data from the server.\n   */\n  export\n  function updateRunningSessions(sessions: Session.IModel[], baseUrl: string): Promise<Session.IModel[]> {\n    let promises: Promise<void>[] = [];\n    let running = runningSessions.get(baseUrl) || [];\n    each(running.slice(), session => {\n      let updated = find(sessions, sId => {\n        if (session.id === sId.id) {\n          promises.push(session.update(sId));\n          return true;\n        }\n        return false;\n      });\n      // If session is no longer running on disk, emit dead signal.\n      if (!updated && session.status !== 'dead') {\n        session.terminated.emit(void 0);\n      }\n    });\n    return Promise.all(promises).then(() => { return sessions; });\n  }\n}\n\n"]}