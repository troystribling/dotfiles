!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(e.vg||(e.vg={})).dataflow=t()}}(function(){var t;return function e(t,n,r){function i(u,o){if(!n[u]){if(!t[u]){var s="function"==typeof require&&require;if(!o&&s)return s(u,!0);if(a)return a(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[u]={exports:{}};t[u][0].call(l.exports,function(e){var n=t[u][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[u].exports}for(var a="function"==typeof require&&require,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(t,e,n){},{}],2:[function(e,n,r){!function(e,i){"object"==typeof r&&"undefined"!=typeof n?i(r):"function"==typeof t&&t.amd?t(["exports"],i):i(e.dsv={})}(this,function(t){"use strict";var e=function(t){function e(t,e){var r;return n(t,function(t,n){if(r)return r(t,n-1);var i=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");r=e?function(t,n){return e(i(t),n)}:i})}function n(t,e){function n(){if(l>=c)return u;if(i)return i=!1,a;var e=l;if(34===t.charCodeAt(e)){for(var n=e;n++<c;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}l=n+2;var r=t.charCodeAt(n+1);return 13===r?(i=!0,10===t.charCodeAt(n+2)&&++l):10===r&&(i=!0),t.slice(e+1,n).replace(/""/g,'"')}for(;c>l;){var r=t.charCodeAt(l++),o=1;if(10===r)i=!0;else if(13===r)i=!0,10===t.charCodeAt(l)&&(++l,++o);else if(r!==s)continue;return t.slice(e,l-o)}return t.slice(e)}for(var r,i,a={},u={},o=[],c=t.length,l=0,f=0;(r=n())!==u;){for(var h=[];r!==a&&r!==u;)h.push(r),r=n();e&&null==(h=e(h,f++))||o.push(h)}return o}function r(e){if(Array.isArray(e[0]))return i(e);var n=Object.create(null),r=[];return e.forEach(function(t){for(var e in t)(e+="")in n||r.push(n[e]=e)}),[r.map(u).join(t)].concat(e.map(function(e){return r.map(function(t){return u(e[t])}).join(t)})).join("\n")}function i(t){return t.map(a).join("\n")}function a(e){return e.map(u).join(t)}function u(t){return o.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var o=new RegExp('["'+t+"\n]"),s=t.charCodeAt(0);return{parse:e,parseRows:n,format:r,formatRows:i}};t.csv=e(","),t.tsv=e("	"),t.dsv=e})},{}],3:[function(e,n,r){"undefined"==typeof Map?(Map=function(){this.clear()},Map.prototype={set:function(t,e){return this._[t]=e,this},get:function(t){return this._[t]},has:function(t){return t in this._},"delete":function(t){return t in this._&&delete this._[t]},clear:function(){this._=Object.create(null)},get size(){var t=0;for(var e in this._)++t;return t},forEach:function(t){for(var e in this._)t(this._[e],e,this)}}):function(){var t=new Map;t.set(0,0)!==t&&(t=t.set,Map.prototype.set=function(){return t.apply(this,arguments),this})}(),function(e,i){"object"==typeof r&&"undefined"!=typeof n?i(r):"function"==typeof t&&t.amd?t(["exports"],i):i(e.format={})}(this,function(t){"use strict";function e(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function n(t){return t=e(Math.abs(t)),t?t[1]:NaN}function r(t,n){var r=e(t,n);if(!r)return t+"";var i=r[0],a=r[1],u=a-(g=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=i.length;return u===o?i:u>o?i+new Array(u-o+1).join("0"):u>0?i.slice(0,u)+"."+i.slice(u):"0."+new Array(1-u).join("0")+e(t,n+u-1)[0]}function i(t,n){var r=e(t,n);if(!r)return t+"";var i=r[0],a=r[1];return 0>a?"0."+new Array(-a).join("0")+i:i.length>a+1?i.slice(0,a+1)+"."+i.slice(a+1):i+new Array(a-i.length+2).join("0")}function a(t,e){t=t.toPrecision(e);t:for(var n,r=t.length,i=1,a=-1;r>i;++i)switch(t[i]){case".":a=n=i;break;case"0":0===a&&(a=i),n=i;break;case"e":break t;default:a>0&&(a=0)}return a>0?t.slice(0,a)+t.slice(n+1):t}function u(t){return new o(t)}function o(t){if(!(e=$.exec(t)))throw new Error("invalid format: "+t);var e,n=e[1]||" ",r=e[2]||">",i=e[3]||"-",a=e[4]||"",u=!!e[5],o=e[6]&&+e[6],s=!!e[7],c=e[8]&&+e[8].slice(1),l=e[9]||"";"n"===l?(s=!0,l="g"):U[l]||(l=""),(u||"0"===n&&"="===r)&&(u=!0,n="0",r="="),this.fill=n,this.align=r,this.sign=i,this.symbol=a,this.zero=u,this.width=o,this.comma=s,this.precision=c,this.type=l}function s(t,e){return function(n,r){for(var i=n.length,a=[],u=0,o=t[0],s=0;i>0&&o>0&&(s+o+1>r&&(o=Math.max(1,r-s)),a.push(n.substring(i-=o,i+o)),!((s+=o+1)>r));)o=t[u=(u+1)%t.length];return a.reverse().join(e)}}function c(t){return t}function l(t){function e(t){t=u(t);var e=t.fill,n=t.align,r=t.sign,s=t.symbol,c=t.zero,l=t.width,f=t.comma,h=t.precision,d=t.type,m="$"===s?a[0]:"#"===s&&/[boxX]/.test(d)?"0"+d.toLowerCase():"",p="$"===s?a[1]:/[%p]/.test(d)?"%":"",v=U[d],y=!d||/[defgprs%]/.test(d);return h=null==h?d?6:12:/[gprs]/.test(d)?Math.max(1,Math.min(21,h)):Math.max(0,Math.min(20,h)),function(t){var a=m,u=p;if("c"===d)u=v(t)+u,t="";else{t=+t;var s=(0>t||0>1/t)&&(t*=-1,!0);if(t=v(t,h),a=(s?"("===r?r:"-":"-"===r||"("===r?"":r)+a,u=u+("s"===d?q[8+g/3]:"")+(s&&"("===r?")":""),y)for(var _,M=-1,b=t.length;++M<b;)if(_=t.charCodeAt(M),48>_||_>57){u=(46===_?o+t.slice(M+1):t.slice(M))+u,t=t.slice(0,M);break}}f&&!c&&(t=i(t,1/0));var w=a.length+t.length+u.length,x=l>w?new Array(l-w+1).join(e):"";switch(f&&c&&(t=i(x+t,x.length?l-u.length:1/0),x=""),n){case"<":return a+t+u+x;case"=":return a+x+t+u;case"^":return x.slice(0,w=x.length>>1)+a+t+u+x.slice(w)}return x+a+t+u}}function r(t,r){var i=e((t=u(t),t.type="f",t)),a=3*Math.max(-8,Math.min(8,Math.floor(n(r)/3))),o=Math.pow(10,-a),s=q[8+a/3];return function(t){return i(o*t)+s}}var i=t.grouping&&t.thousands?s(t.grouping,t.thousands):c,a=t.currency,o=t.decimal;return{format:e,formatPrefix:r}}function f(t,e){return Math.max(0,n(Math.abs(e))-n(Math.abs(t)))+1}function h(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(n(e)/3)))-n(Math.abs(t)))}function d(t){return Math.max(0,-n(Math.abs(t)))}function m(t){return"string"!=typeof t||(t=N.get(t))?l(t):null}var g,p={decimal:".",thousands:",",grouping:[3],currency:["¥",""]},v={decimal:",",thousands:" ",grouping:[3],currency:[""," руб."]},y={decimal:",",thousands:".",grouping:[3],currency:["R$",""]},_={decimal:",",thousands:".",grouping:[3],currency:["","zł"]},M={decimal:",",thousands:".",grouping:[3],currency:["€ ",""]},b={decimal:",",thousands:".",grouping:[3],currency:[""," ден."]},w={decimal:",",thousands:".",grouping:[3],currency:["€",""]},x={decimal:".",thousands:",",grouping:[3],currency:["₪",""]},D={decimal:",",thousands:".",grouping:[3],currency:[""," €"]},S={decimal:",",thousands:" ",grouping:[3],currency:["","$"]},T={decimal:",",thousands:" ",grouping:[3],currency:[""," €"]},C={decimal:",",thousands:".",grouping:[3],currency:[""," €"]},A={decimal:".",thousands:",",grouping:[3],currency:["$",""]},k={decimal:".",thousands:",",grouping:[3],currency:["£",""]},j={decimal:".",thousands:",",grouping:[3],currency:["$",""]},L={decimal:",",thousands:".",grouping:[3],currency:[""," €"]},F={decimal:",",thousands:".",grouping:[3],currency:[""," €"]},U={"":a,"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return i(100*t,e)},r:i,s:r,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},$=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;o.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var q=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"],N=(new Map).set("ca-ES",F).set("de-DE",L).set("en-CA",j).set("en-GB",k).set("en-US",A).set("es-ES",C).set("fi-FI",T).set("fr-CA",S).set("fr-FR",D).set("he-IL",x).set("it-IT",w).set("mk-MK",b).set("nl-NL",M).set("pl-PL",_).set("pt-BR",y).set("ru-RU",v).set("zh-CN",p),Y=l(A);t.format=Y.format,t.formatPrefix=Y.formatPrefix,t.localeFormat=m,t.formatSpecifier=u,t.precisionFixed=d,t.precisionPrefix=h,t.precisionRound=f})},{}],4:[function(e,n,r){"undefined"==typeof Map?(Map=function(){this.clear()},Map.prototype={set:function(t,e){return this._[t]=e,this},get:function(t){return this._[t]},has:function(t){return t in this._},"delete":function(t){return t in this._&&delete this._[t]},clear:function(){this._=Object.create(null)},get size(){var t=0;for(var e in this._)++t;return t},forEach:function(t){for(var e in this._)t(this._[e],e,this)}}):function(){var t=new Map;t.set(0,0)!==t&&(t=t.set,Map.prototype.set=function(){return t.apply(this,arguments),this})}(),function(e,i){"object"==typeof r&&"undefined"!=typeof n?i(r):"function"==typeof t&&t.amd?t(["exports"],i):i(e.timeFormat={})}(this,function(t){"use strict";function e(t,n,r){function i(e){return t(e=new Date(+e)),e}return i.floor=i,i.round=function(e){var r=new Date(+e),i=new Date(e-1);return t(r),t(i),n(i,1),i-e>e-r?r:i},i.ceil=function(e){return t(e=new Date(e-1)),n(e,1),e},i.offset=function(t,e){return n(t=new Date(+t),null==e?1:Math.floor(e)),t},i.range=function(e,r,i){var a=[];if(e=new Date(e-1),r=new Date(+r),i=null==i?1:Math.floor(i),!(r>e&&i>0))return a;for(n(e,1),t(e),r>e&&a.push(new Date(+e));n(e,i),t(e),r>e;)a.push(new Date(+e));return a},i.filter=function(r){return e(function(e){for(;t(e),!r(e);)e.setTime(e-1)},function(t,e){for(;--e>=0;)for(;n(t,1),!r(t););})},r&&(i.count=function(e,n){return Mt.setTime(+e),bt.setTime(+n),t(Mt),t(bt),Math.floor(r(Mt,bt))}),i}function n(t){return e(function(e){e.setHours(0,0,0,0),e.setDate(e.getDate()-(e.getDay()+7-t)%7)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5})}function r(t){return e(function(e){e.setUTCHours(0,0,0,0),e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/6048e5})}function i(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function a(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function u(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function o(t){function e(t,e){return function(n){for(var r,i,a,u=[],o=-1,s=0,c=t.length;++o<c;)37===t.charCodeAt(o)&&(u.push(t.slice(s,o)),null!=(i=jt[r=t.charAt(++o)])&&(r=t.charAt(++o)),(a=e[r])&&(r=a(n,null==i?"e"===r?" ":"0":i)),u.push(r),s=o+1);return u.push(t.slice(s,o)),u.join("")}}function n(t,e){return function(n){var i=u(1900),o=r(i,t,n,0);if(o!=n.length)return null;if("p"in i&&(i.H=i.H%12+12*i.p),"Z"in i){if("w"in i&&("W"in i||"U"in i)){var s=a(u(i.y)).getUTCDay();"W"in i&&(i.U=i.W,i.w=(i.w+6)%7,--s),i.m=0,i.d=i.w+7*i.U-(s+6)%7}return i.H+=i.Z/100|0,i.M+=i.Z%100,a(i)}if("w"in i&&("W"in i||"U"in i)){var s=e(u(i.y)).getDay();"W"in i&&(i.U=i.W,i.w=(i.w+6)%7,--s),i.m=0,i.d=i.w+7*i.U-(s+6)%7}return e(i)}}function r(t,e,n,r){for(var i,a,u=0,o=e.length,s=n.length;o>u;){if(r>=s)return-1;if(i=e.charCodeAt(u++),37===i){if(i=e.charAt(u++),a=Nt[i in jt?e.charAt(u++):i],!a||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}function o(t,e,n){var r=Ct.exec(e.slice(n));return r?(t.w=At.get(r[0].toLowerCase()),n+r[0].length):-1}function s(t,e,n){var r=St.exec(e.slice(n));return r?(t.w=Tt.get(r[0].toLowerCase()),n+r[0].length):-1}function c(t,e,n){var r=Ft.exec(e.slice(n));return r?(t.m=Ut.get(r[0].toLowerCase()),n+r[0].length):-1}function et(t,e,n){var r=kt.exec(e.slice(n));return r?(t.m=Lt.get(r[0].toLowerCase()),n+r[0].length):-1}function nt(t,e,n){return r(t,pt,e,n)}function rt(t,e,n){return r(t,vt,e,n)}function it(t,e,n){return r(t,yt,e,n)}function at(t,e,n){var r=Dt.get(e.slice(n,n+=2).toLowerCase());return null==r?-1:(t.p=r,n)}function ut(t){return bt[t.getDay()]}function ot(t){return Mt[t.getDay()]}function st(t){return xt[t.getMonth()]}function ct(t){return wt[t.getMonth()]}function lt(t){return _t[+(t.getHours()>=12)]}function ft(t){return bt[t.getUTCDay()]}function ht(t){return Mt[t.getUTCDay()]}function dt(t){return xt[t.getUTCMonth()]}function mt(t){return wt[t.getUTCMonth()]}function gt(t){return _t[+(t.getUTCHours()>=12)]}var pt=t.dateTime,vt=t.date,yt=t.time,_t=t.periods,Mt=t.days,bt=t.shortDays,wt=t.months,xt=t.shortMonths,Dt=f(_t),St=l(Mt),Tt=f(Mt),Ct=l(bt),At=f(bt),kt=l(wt),Lt=f(wt),Ft=l(xt),Ut=f(xt),$t={a:ut,A:ot,b:st,B:ct,c:null,d:T,e:T,H:C,I:A,j:k,L:j,m:L,M:F,p:lt,S:U,U:$,w:q,W:N,x:null,X:null,y:Y,Y:H,Z:z,"%":tt},qt={a:ft,A:ht,b:dt,B:mt,c:null,d:O,e:O,H:E,I:J,j:P,L:B,m:R,M:X,p:gt,S:I,U:W,w:V,W:G,x:null,X:null,y:Z,Y:K,Z:Q,"%":tt},Nt={a:o,A:s,b:c,B:et,c:nt,d:_,e:_,H:b,I:b,j:M,L:D,m:y,M:w,p:at,S:x,U:d,w:h,W:m,x:rt,X:it,y:p,Y:g,Z:v,"%":S};return $t.x=e(vt,$t),$t.X=e(yt,$t),$t.c=e(pt,$t),qt.x=e(vt,qt),qt.X=e(yt,qt),qt.c=e(pt,qt),{format:function(t){var r=e(t+="",$t);return r.parse=n(t,i),r.toString=function(){return t},r},utcFormat:function(t){var r=e(t+="",qt);return r.parse=n(t,a),r.toString=function(){return t},r}}}function s(t,e,n){var r=0>t?"-":"",i=(r?-t:t)+"",a=i.length;return r+(n>a?new Array(n-a+1).join(e)+i:i)}function c(t){return t.replace(Ut,"\\$&")}function l(t){return new RegExp("^(?:"+t.map(c).join("|")+")","i")}function f(t){for(var e=new Map,n=-1,r=t.length;++n<r;)e.set(t[n].toLowerCase(),n);return e}function h(t,e,n){var r=Lt.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function d(t,e,n){var r=Lt.exec(e.slice(n));return r?(t.U=+r[0],n+r[0].length):-1}function m(t,e,n){var r=Lt.exec(e.slice(n));return r?(t.W=+r[0],n+r[0].length):-1}function g(t,e,n){var r=Lt.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function p(t,e,n){var r=Lt.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function v(t,e,n){return/^[+-]\d{4}$/.test(e=e.slice(n,n+5))?(t.Z=-e,n+5):-1}function y(t,e,n){var r=Lt.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function _(t,e,n){var r=Lt.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function M(t,e,n){var r=Lt.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function b(t,e,n){var r=Lt.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function w(t,e,n){var r=Lt.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function x(t,e,n){var r=Lt.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function D(t,e,n){var r=Lt.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function S(t,e,n){var r=Ft.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function T(t,e){return s(t.getDate(),e,2)}function C(t,e){return s(t.getHours(),e,2)}function A(t,e){return s(t.getHours()%12||12,e,2)}function k(t,e){return s(1+wt.count(St(t),t),e,3)}function j(t,e){return s(t.getMilliseconds(),e,3)}function L(t,e){return s(t.getMonth()+1,e,2)}function F(t,e){return s(t.getMinutes(),e,2)}function U(t,e){return s(t.getSeconds(),e,2)}function $(t,e){return s(xt.count(St(t),t),e,2)}function q(t){return t.getDay()}function N(t,e){return s(Dt.count(St(t),t),e,2)}function Y(t,e){return s(t.getFullYear()%100,e,2)}function H(t,e){return s(t.getFullYear()%1e4,e,4)}function z(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+s(e/60|0,"0",2)+s(e%60,"0",2)}function O(t,e){return s(t.getUTCDate(),e,2)}function E(t,e){return s(t.getUTCHours(),e,2)}function J(t,e){return s(t.getUTCHours()%12||12,e,2)}function P(t,e){return s(1+Tt.count(kt(t),t),e,3)}function B(t,e){return s(t.getUTCMilliseconds(),e,3)}function R(t,e){return s(t.getUTCMonth()+1,e,2)}function X(t,e){return s(t.getUTCMinutes(),e,2)}function I(t,e){return s(t.getUTCSeconds(),e,2)}function W(t,e){return s(Ct.count(kt(t),t),e,2)}function V(t){return t.getUTCDay()}function G(t,e){return s(At.count(kt(t),t),e,2)}function Z(t,e){return s(t.getUTCFullYear()%100,e,2)}function K(t,e){return s(t.getUTCFullYear()%1e4,e,4)}function Q(){return"+0000"}function tt(){return"%"}function et(t){return t.toISOString()}function nt(t){return"string"!=typeof t||(t=Yt.get(t))?o(t):null}var rt={dateTime:"%a %b %e %X %Y",date:"%Y/%-m/%-d",time:"%H:%M:%S",periods:["上午","下午"],days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],shortDays:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],shortMonths:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]},it={dateTime:"%A, %e %B %Y г. %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],shortDays:["вс","пн","вт","ср","чт","пт","сб"],months:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],shortMonths:["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"]},at={dateTime:"%A, %e de %B de %Y. %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Segunda","Terça","Quarta","Quinta","Sexta","Sábado"],shortDays:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]},ut={dateTime:"%A, %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Niedziela","Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota"],shortDays:["Niedz.","Pon.","Wt.","Śr.","Czw.","Pt.","Sob."],months:["Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień"],shortMonths:["Stycz.","Luty","Marz.","Kwie.","Maj","Czerw.","Lipc.","Sierp.","Wrz.","Paźdz.","Listop.","Grudz."]},ot={dateTime:"%a %e %B %Y %T",date:"%d-%m-%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],shortDays:["zo","ma","di","wo","do","vr","za"],months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],shortMonths:["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"]},st={dateTime:"%A, %e %B %Y г. %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["недела","понеделник","вторник","среда","четврток","петок","сабота"],shortDays:["нед","пон","вто","сре","чет","пет","саб"],months:["јануари","февруари","март","април","мај","јуни","јули","август","септември","октомври","ноември","декември"],shortMonths:["јан","фев","мар","апр","мај","јун","јул","авг","сеп","окт","ное","дек"]},ct={dateTime:"%A %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato"],shortDays:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],shortMonths:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"]},lt={dateTime:"%A, %e ב%B %Y %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["ראשון","שני","שלישי","רביעי","חמישי","שישי","שבת"],shortDays:["א׳","ב׳","ג׳","ד׳","ה׳","ו׳","ש׳"],months:["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],shortMonths:["ינו׳","פבר׳","מרץ","אפר׳","מאי","יוני","יולי","אוג׳","ספט׳","אוק׳","נוב׳","דצמ׳"]},ft={dateTime:"%A, le %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],shortDays:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],months:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],shortMonths:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."]},ht={dateTime:"%a %e %b %Y %X",date:"%Y-%m-%d",time:"%H:%M:%S",periods:["",""],days:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],shortDays:["dim","lun","mar","mer","jeu","ven","sam"],months:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],shortMonths:["jan","fév","mar","avr","mai","jui","jul","aoû","sep","oct","nov","déc"]},dt={dateTime:"%A, %-d. %Bta %Y klo %X",date:"%-d.%-m.%Y",time:"%H:%M:%S",periods:["a.m.","p.m."],days:["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],shortDays:["Su","Ma","Ti","Ke","To","Pe","La"],months:["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kesäkuu","heinäkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],shortMonths:["Tammi","Helmi","Maalis","Huhti","Touko","Kesä","Heinä","Elo","Syys","Loka","Marras","Joulu"]},mt={dateTime:"%A, %e de %B de %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],shortDays:["dom","lun","mar","mié","jue","vie","sáb"],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortMonths:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"]},gt={dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},pt={dateTime:"%a %e %b %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},vt={dateTime:"%a %b %e %X %Y",date:"%Y-%m-%d",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},yt={dateTime:"%A, der %e. %B %Y, %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]},_t={dateTime:"%A, %e de %B de %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["diumenge","dilluns","dimarts","dimecres","dijous","divendres","dissabte"],shortDays:["dg.","dl.","dt.","dc.","dj.","dv.","ds."],months:["gener","febrer","març","abril","maig","juny","juliol","agost","setembre","octubre","novembre","desembre"],shortMonths:["gen.","febr.","març","abr.","maig","juny","jul.","ag.","set.","oct.","nov.","des."]},Mt=new Date,bt=new Date,wt=e(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5}),xt=n(0),Dt=n(1),St=e(function(t){t.setHours(0,0,0,0),t.setMonth(0,1)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()}),Tt=e(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5}),Ct=r(0),At=r(1),kt=e(function(t){t.setUTCHours(0,0,0,0),t.setUTCMonth(0,1)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),jt={"-":"",_:" ",0:"0"},Lt=/^\s*\d+/,Ft=/^%/,Ut=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,$t="%Y-%m-%dT%H:%M:%S.%LZ";et.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},et.toString=function(){return $t};var qt=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?et:gt.utcFormat($t),Nt=qt,Yt=(new Map).set("ca-ES",_t).set("de-DE",yt).set("en-CA",vt).set("en-GB",pt).set("en-US",gt).set("es-ES",mt).set("fi-FI",dt).set("fr-CA",ht).set("fr-FR",ft).set("he-IL",lt).set("it-IT",ct).set("mk-MK",st).set("nl-NL",ot).set("pl-PL",ut).set("pt-BR",at).set("ru-RU",it).set("zh-CN",rt),Ht=o(gt);t.format=Ht.format,t.utcFormat=Ht.utcFormat,t.localeFormat=nt,t.isoFormat=Nt})},{}],5:[function(e,n,r){!function(e,i){"object"==typeof r&&"undefined"!=typeof n?i(r):"function"==typeof t&&t.amd?t(["exports"],i):i(e.time={})}(this,function(t){"use strict";function e(t,n,r){function u(e){return t(e=new Date(+e)),e}return u.floor=u,u.round=function(e){var r=new Date(+e),i=new Date(e-1);return t(r),t(i),n(i,1),i-e>e-r?r:i},u.ceil=function(e){return t(e=new Date(e-1)),n(e,1),e},u.offset=function(t,e){return n(t=new Date(+t),null==e?1:Math.floor(e)),t},u.range=function(e,r,i){var a=[];if(e=new Date(e-1),r=new Date(+r),i=null==i?1:Math.floor(i),!(r>e&&i>0))return a;for(n(e,1),t(e),r>e&&a.push(new Date(+e));n(e,i),t(e),r>e;)a.push(new Date(+e));return a},u.filter=function(r){return e(function(e){for(;t(e),!r(e);)e.setTime(e-1)},function(t,e){for(;--e>=0;)for(;n(t,1),!r(t););})},r&&(u.count=function(e,n){return a.setTime(+e),i.setTime(+n),t(a),t(i),Math.floor(r(a,i))}),u}function n(t){return e(function(e){e.setHours(0,0,0,0),e.setDate(e.getDate()-(e.getDay()+7-t)%7)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5})}function r(t){return e(function(e){e.setUTCHours(0,0,0,0),e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/6048e5})}var i=new Date,a=new Date,u=e(function(t){t.setMilliseconds(0)},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3});t.seconds=u.range;var o=e(function(t){t.setSeconds(0,0)},function(t,e){t.setTime(+t+6e4*e)},function(t,e){return(e-t)/6e4});t.minutes=o.range;var s=e(function(t){t.setMinutes(0,0,0)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5});t.hours=s.range;var c=e(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5});t.days=c.range,t.sunday=n(0),t.sundays=t.sunday.range,t.monday=n(1),t.mondays=t.monday.range,t.tuesday=n(2),t.tuesdays=t.tuesday.range,t.wednesday=n(3),t.wednesdays=t.wednesday.range,t.thursday=n(4),t.thursdays=t.thursday.range,t.friday=n(5),t.fridays=t.friday.range,t.saturday=n(6),t.saturdays=t.saturday.range;var l=t.sunday;t.weeks=l.range;var f=e(function(t){t.setHours(0,0,0,0),t.setDate(1)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())});t.months=f.range;var h=e(function(t){t.setHours(0,0,0,0),t.setMonth(0,1)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()});t.years=h.range;var d=e(function(t){t.setUTCMilliseconds(0)},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3});t.utcSeconds=d.range;var m=e(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+6e4*e)},function(t,e){return(e-t)/6e4});t.utcMinutes=m.range;var g=e(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5});t.utcHours=g.range;var p=e(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5});t.utcDays=p.range,t.utcSunday=r(0),t.utcSundays=t.utcSunday.range,t.utcMonday=r(1),t.utcMondays=t.utcMonday.range,t.utcTuesday=r(2),t.utcTuesdays=t.utcTuesday.range,t.utcWednesday=r(3),t.utcWednesdays=t.utcWednesday.range,t.utcThursday=r(4),t.utcThursdays=t.utcThursday.range,t.utcFriday=r(5),t.utcFridays=t.utcFriday.range,t.utcSaturday=r(6),t.utcSaturdays=t.utcSaturday.range;var v=t.utcSunday;t.utcWeeks=v.range;var y=e(function(t){t.setUTCHours(0,0,0,0),t.setUTCDate(1)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())});t.utcMonths=y.range;var _=e(function(t){t.setUTCHours(0,0,0,0),t.setUTCMonth(0,1)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()});t.utcYears=_.range,t.interval=e,t.second=u,t.minute=o,t.hour=s,t.day=c,t.week=l,t.month=f,t.year=h,t.utcSecond=d,t.utcMinute=m,t.utcHour=g,t.utcDay=p,t.utcWeek=v,t.utcMonth=y,t.utcYear=_})},{}],6:[function(t,e,n){function r(){this._cells={},this._aggr=[],this._stream=!1}function i(t){if(a.isArray(t))return t;if(null==t)return[];var e,n,r=[];for(e in t)n=a.array(t[e]),r.push({name:e,ops:n});return r}var a=t("../util"),u=t("./measures"),o=t("./collector"),s=r.Flags={ADD_CELL:1,MOD_CELL:2},c=r.prototype;c.stream=function(t){return null==t?this._stream:(this._stream=!!t,this._aggr=[],this)},c.key=function(t){return null==t?this._key:(this._key=a.$(t),this)},c.groupby=function(t){return this._dims=a.array(t).map(function(t,e){if(t=a.isString(t)?{name:t,get:a.$(t)}:a.isFunction(t)?{name:a.name(t)||t.name||"_"+e,get:t}:t.name&&a.isFunction(t.get)?t:null,null==t)throw"Invalid groupby argument: "+t;return t}),this.clear()},c.summarize=function(t){t=i(t),this._count=!0;var e,n,r,o,s,c,l,f=this._aggr=[];for(r=0;r<t.length;++r){for(o=0,e=[],n=t[r];o<n.ops.length;++o)s=n.ops[o],"count"!==s&&(this._count=!1),c=n.as&&n.as[o]||s+("*"===n.name?"":"_"+n.name),e.push(u[s](c));l=n.get&&a.$(n.get)||("*"===n.name?a.identity:a.$(n.name)),f.push({name:n.name,measures:u.create(e,this._stream,l,this._assign)})}return this.clear()},c.count=function(){return this.summarize({"*":"count"})},c._assign=function(t,e,n){t[e]=n},c.clear=function(){return this._cells={},this},c._cellkey=function(t){var e,n=this._dims,r=n.length,i=String(n[0].get(t));for(e=1;r>e;++e)i+="|"+n[e].get(t);return i},c._cell=function(t){var e=this._dims.length?this._cellkey(t):"";return this._cells[e]||(this._cells[e]=this._newcell(t,e))},c._newcell=function(t,e){var n,r={num:0,tuple:this._newtuple(t,e),flag:s.ADD_CELL,aggs:{}},i=this._aggr;for(n=0;n<i.length;++n)r.aggs[i[n].name]=new i[n].measures(r,r.tuple);return r.collect&&(r.data=new o(this._key)),r},c._newtuple=function(t){var e,n,r=this._dims,i={};for(e=0,n=r.length;n>e;++e)i[r[e].name]=r[e].get(t);return this._ingest(i)},c._ingest=a.identity,c._add=function(t){var e,n=this._cell(t),r=this._aggr;if(n.num+=1,!this._count)for(n.collect&&n.data.add(t),e=0;e<r.length;++e)n.aggs[r[e].name].add(t);n.flag|=s.MOD_CELL,this._on_add&&this._on_add(t,n)},c._rem=function(t){var e,n=this._cell(t),r=this._aggr;if(n.num-=1,!this._count)for(n.collect&&n.data.rem(t),e=0;e<r.length;++e)n.aggs[r[e].name].rem(t);n.flag|=s.MOD_CELL,this._on_rem&&this._on_rem(t,n)},c._mod=function(t,e){var n,r=this._cell(e),i=this._cell(t),u=this._aggr;for(r!==i?(r.num-=1,i.num+=1,r.collect&&r.data.rem(e),i.collect&&i.data.add(t)):r.collect&&!a.isObject(t)&&(r.data.rem(e),r.data.add(t)),n=0;n<u.length;++n)r.aggs[u[n].name].rem(e),i.aggs[u[n].name].add(t);r.flag|=s.MOD_CELL,i.flag|=s.MOD_CELL,this._on_mod&&this._on_mod(t,e,r,i)},c.result=function(){var t,e,n,r=[],i=this._aggr;for(n in this._cells){if(t=this._cells[n],t.num>0){for(t.collect&&t.data.values(),e=0;e<i.length;++e)t.aggs[i[e].name].set();r.push(t.tuple)}else delete this._cells[n];t.flag=0}return this._rems=!1,r},c.changes=function(t){
var e,n,r,i,a=t||{add:[],rem:[],mod:[]},u=this._aggr;for(i in this._cells){for(e=this._cells[i],n=e.flag,e.collect&&e.data.values(),r=0;r<u.length;++r)e.aggs[u[r].name].set();e.num<=0?(a.rem.push(e.tuple),delete this._cells[i],this._on_drop&&this._on_drop(e)):(this._on_keep&&this._on_keep(e),n&s.ADD_CELL?a.add.push(e.tuple):n&s.MOD_CELL&&a.mod.push(e.tuple)),e.flag=0}return this._rems=!1,a},c.execute=function(t){return this.clear().insert(t).result()},c.insert=function(t){this._consolidate();for(var e=0;e<t.length;++e)this._add(t[e]);return this},c.remove=function(t){if(!this._stream)throw"Aggregator not configured for streaming removes. Call stream(true) prior to calling summarize.";for(var e=0;e<t.length;++e)this._rem(t[e]);return this._rems=!0,this},c._consolidate=function(){if(this._rems){for(var t in this._cells)this._cells[t].collect&&this._cells[t].data.values();this._rems=!1}},e.exports=r},{"../util":28,"./collector":7,"./measures":9}],7:[function(t,e,n){function r(t){this._add=[],this._rem=[],this._key=t||null,this._last=null}var i=t("../util"),a=t("../stats"),u="__dl_rem__",o=r.prototype;o.add=function(t){this._add.push(t)},o.rem=function(t){this._rem.push(t)},o.values=function(){if(this._get=null,0===this._rem.length)return this._add;var t,e,n,r,o=this._add,s=this._rem,c=this._key,l=Array(o.length-s.length);if(i.isObject(s[0]))if(c)for(r=i.toMap(s,c),t=0,e=0,n=o.length;n>t;++t)r.hasOwnProperty(c(o[t]))||(l[e++]=o[t]);else{for(t=0,n=s.length;n>t;++t)s[t][u]=1;for(t=0,e=0,n=o.length;n>t;++t)o[t][u]||(l[e++]=o[t]);for(t=0,n=s.length;n>t;++t)delete s[t][u]}else for(r=a.count.map(s),t=0,e=0,n=o.length;n>t;++t)r[o[t]]>0?r[o[t]]-=1:l[e++]=o[t];return this._rem=[],this._add=l},o.extent=function(t){if(this._get!==t||!this._ext){var e=this.values(),n=a.extent.index(e,t);this._ext=[e[n[0]],e[n[1]]],this._get=t}return this._ext},o.argmin=function(t){return this.extent(t)[0]},o.argmax=function(t){return this.extent(t)[1]},o.min=function(t){var e=this.extent(t)[0];return e?t(e):+(1/0)},o.max=function(t){var e=this.extent(t)[1];return e?t(e):-(1/0)},o.quartile=function(t){return this._get===t&&this._q||(this._q=a.quartile(this.values(),t),this._get=t),this._q},o.q1=function(t){return this.quartile(t)[0]},o.q2=function(t){return this.quartile(t)[1]},o.q3=function(t){return this.quartile(t)[2]},e.exports=r},{"../stats":25,"../util":28}],8:[function(t,e,n){var r=t("../util"),i=t("./aggregator");e.exports=function(){var t=[].reduce.call(arguments,function(t,e){return t.concat(r.array(e))},[]);return(new i).groupby(t).summarize({"*":"values"})}},{"../util":28,"./aggregator":6}],9:[function(t,e,n){function r(t){return function(e){var n=u.extend({init:"",add:"",rem:"",idx:0},t);return n.out=e||t.name,n}}function i(t,e){function n(t,r){function i(e){t[e]||n(t,t[e]=o[e]())}return r.req&&r.req.forEach(i),e&&r.str&&r.str.forEach(i),t}var r=t.reduce(n,t.reduce(function(t,e){return t[e.name]=e,t},{}));return u.vals(r).sort(function(t,e){return t.idx-e.idx})}function a(e,n,r,a){var o=i(e,n),s="this.cell = cell; this.tuple = t; this.valid = 0; this.missing = 0;",c="if (v==null) this.missing++; if (!this.isValid(v)) return; ++this.valid;",l="if (v==null) this.missing--; if (!this.isValid(v)) return; --this.valid;",f="var t = this.tuple; var cell = this.cell;";return o.forEach(function(t){t.idx<0?(s=t.init+s,c=t.add+c,l=t.rem+l):(s+=t.init,c+=t.add,l+=t.rem)}),e.slice().sort(function(t,e){return t.idx-e.idx}).forEach(function(t){f+="this.assign(t,'"+t.out+"',"+t.set+");"}),f+="return t;",s=Function("cell","t",s),s.prototype.assign=a,s.prototype.add=Function("t","var v = this.get(t);"+c),s.prototype.rem=Function("t","var v = this.get(t);"+l),s.prototype.set=Function(f),s.prototype.get=r,s.prototype.distinct=t("../stats").count.distinct,s.prototype.isValid=u.isValid,s.fields=e.map(u.$("out")),s}var u=t("../util"),o={values:r({name:"values",init:"cell.collect = true;",set:"cell.data.values()",idx:-1}),count:r({name:"count",set:"cell.num"}),missing:r({name:"missing",set:"this.missing"}),valid:r({name:"valid",set:"this.valid"}),sum:r({name:"sum",init:"this.sum = 0;",add:"this.sum += v;",rem:"this.sum -= v;",set:"this.sum"}),mean:r({name:"mean",init:"this.mean = 0;",add:"var d = v - this.mean; this.mean += d / this.valid;",rem:"var d = v - this.mean; this.mean -= this.valid ? d / this.valid : this.mean;",set:"this.mean"}),average:r({name:"average",set:"this.mean",req:["mean"],idx:1}),variance:r({name:"variance",init:"this.dev = 0;",add:"this.dev += d * (v - this.mean);",rem:"this.dev -= d * (v - this.mean);",set:"this.valid > 1 ? this.dev / (this.valid-1) : 0",req:["mean"],idx:1}),variancep:r({name:"variancep",set:"this.valid > 1 ? this.dev / this.valid : 0",req:["variance"],idx:2}),stdev:r({name:"stdev",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid-1)) : 0",req:["variance"],idx:2}),stdevp:r({name:"stdevp",set:"this.valid > 1 ? Math.sqrt(this.dev / this.valid) : 0",req:["variance"],idx:2}),median:r({name:"median",set:"cell.data.q2(this.get)",req:["values"],idx:3}),q1:r({name:"q1",set:"cell.data.q1(this.get)",req:["values"],idx:3}),q3:r({name:"q3",set:"cell.data.q3(this.get)",req:["values"],idx:3}),distinct:r({name:"distinct",set:"this.distinct(cell.data.values(), this.get)",req:["values"],idx:3}),argmin:r({name:"argmin",add:"if (v < this.min) this.argmin = t;",rem:"if (v <= this.min) this.argmin = null;",set:"this.argmin = this.argmin || cell.data.argmin(this.get)",req:["min"],str:["values"],idx:3}),argmax:r({name:"argmax",add:"if (v > this.max) this.argmax = t;",rem:"if (v >= this.max) this.argmax = null;",set:"this.argmax = this.argmax || cell.data.argmax(this.get)",req:["max"],str:["values"],idx:3}),min:r({name:"min",init:"this.min = +Infinity;",add:"if (v < this.min) this.min = v;",rem:"if (v <= this.min) this.min = NaN;",set:"this.min = (isNaN(this.min) ? cell.data.min(this.get) : this.min)",str:["values"],idx:4}),max:r({name:"max",init:"this.max = -Infinity;",add:"if (v > this.max) this.max = v;",rem:"if (v >= this.max) this.max = NaN;",set:"this.max = (isNaN(this.max) ? cell.data.max(this.get) : this.max)",str:["values"],idx:4}),modeskew:r({name:"modeskew",set:"this.dev===0 ? 0 : (this.mean - cell.data.q2(this.get)) / Math.sqrt(this.dev/(this.valid-1))",req:["mean","stdev","median"],idx:5})};o.create=a,e.exports=o},{"../stats":25,"../util":28}],10:[function(t,e,n){function r(t){if(!t)throw Error("Missing binning options.");var e,n,r,o,s,c,l,f=t.maxbins||15,h=t.base||10,d=Math.log(h),m=t.div||[5,2],g=t.min,p=t.max,v=p-g;if(t.step)e=t.step;else if(t.steps)e=t.steps[Math.min(t.steps.length-1,i(t.steps,v/f,0,t.steps.length))];else{n=Math.ceil(Math.log(f)/d),r=t.minstep||0,e=Math.max(r,Math.pow(h,Math.round(Math.log(v)/d)-n));do e*=h;while(Math.ceil(v/e)>f);for(c=0;c<m.length;++c)s=e/m[c],s>=r&&f>=v/s&&(e=s)}return s=Math.log(e),o=s>=0?0:~~(-s/d)+1,l=Math.pow(h,-o-1),g=Math.min(g,Math.floor(g/e+l)*e),p=Math.ceil(p/e)*e,{start:g,stop:p,step:e,unit:{precision:o},value:a,index:u}}function i(t,e,n,r){for(;r>n;){var i=n+r>>>1;c.cmp(t[i],e)<0?n=i+1:r=i}return n}function a(t){return this.step*Math.floor(t/this.step+f)}function u(t){return Math.floor((t-this.start)/this.step+f)}function o(t){return this.unit.date(a.call(this,t))}function s(t){return u.call(this,this.unit.unit(t))}var c=t("../util"),l=t("../time"),f=1e-15;r.date=function(t){if(!t)throw Error("Missing date binning options.");var e=t.utc?l.utc:l,n=t.min,i=t.max,a=t.maxbins||20,u=t.minbins||4,c=+i-+n,f=t.unit?e[t.unit]:e.find(c,u,a),h=r({min:null!=f.min?f.min:f.unit(n),max:null!=f.max?f.max:f.unit(i),maxbins:a,minstep:f.minstep,steps:f.step});return h.unit=f,h.index=s,t.raw||(h.value=o),h},e.exports=r},{"../time":27,"../util":28}],11:[function(t,e,n){function r(t,e,n){n=u(t,e,n);var r=a(n);return r?h.$func("bin",r.unit.unit?function(t){return r.value(r.unit.unit(t))}:function(t){return r.value(t)})(n.accessor):n.accessor||h.identity}function i(t,e,n){n=u(t,e,n);var r=a(n);return r?o(t,n.accessor,r):s(t,n.accessor,n&&n.sort)}function a(t){var e=t.type,n=null;return(null==e||m[e])&&("integer"===e&&null==t.minstep&&(t.minstep=1),n="date"===e?c.date(t):c(t)),n}function u(){var t=arguments,e=0,n=h.isArray(t[e])?t[e++]:null,r=h.isFunction(t[e])||h.isString(t[e])?h.$(t[e++]):null,i=h.extend({},t[e]);if(n&&(i.type=i.type||f(n,r),m[i.type])){var a=d.extent(n,r);i=h.extend({min:a[0],max:a[1]},i)}return r&&(i.accessor=r),i}function o(t,e,n){for(var r,i,a=l.range(n.start,n.stop+n.step/2,n.step).map(function(t){return{value:n.value(t),count:0}}),u=0;u<t.length;++u)if(r=e?e(t[u]):t[u],h.isValid(r)){if(i=n.index(r),0>i||i>=a.length||!isFinite(i))continue;a[i].count+=1}return a.bins=n,a}function s(t,e,n){var r=d.unique(t,e),i=d.count.map(t,e);return r.map(function(t){return{value:t,count:i[t]}}).sort(h.comparator(n?"-count":"+value"))}var c=t("./bins"),l=t("../generate"),f=t("../import/type"),h=t("../util"),d=t("../stats"),m={integer:1,number:1,date:1};e.exports={$bin:r,histogram:i}},{"../generate":13,"../import/type":22,"../stats":25,"../util":28,"./bins":10}],12:[function(t,e,n){function r(t){var e=f.localeFormat(t);if(null==e)throw Error("Unrecognized locale: "+t);h=e}function i(t){var e=l.localeFormat(t);if(null==e)throw Error("Unrecognized locale: "+t);d=e}function a(t,e){null==e&&(e=10);var n=t[0],r=t[t.length-1];n>r&&(u=r,r=n,n=u);var i=r-n,a=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),u=i/e/a;return u>=m?a*=10:u>=g?a*=5:u>=p&&(a*=2),[Math.ceil(n/a)*a,Math.floor(r/a)*a+a/2,a]}function u(t,e,n){var r=a(t,e);if(null==n)n=",."+f.precisionFixed(r[2])+"f";else switch(n=f.formatSpecifier(n),n.type){case"s":var i=Math.max(Math.abs(r[0]),Math.abs(r[1]));return null==n.precision&&(n.precision=f.precisionPrefix(r[2],i)),h.formatPrefix(n,i);case"":case"e":case"g":case"p":case"r":null==n.precision&&(n.precision=f.precisionRound(r[2],Math.max(Math.abs(r[0]),Math.abs(r[1])))-("e"===n.type));break;case"f":case"%":null==n.precision&&(n.precision=f.precisionFixed(r[2])-2*("%"===n.type))}return h.format(n)}function o(){var t=d.format,e=t(".%L"),n=t(":%S"),r=t("%I:%M"),i=t("%I %p"),a=t("%a %d"),u=t("%b %d"),o=t("%B"),s=t("%Y");return function(t){var l=+t;return(c.second(t)<l?e:c.minute(t)<l?n:c.hour(t)<l?r:c.day(t)<l?i:c.month(t)<l?c.week(t)<l?a:u:c.year(t)<l?o:s)(t)}}function s(){var t=d.utcFormat,e=t(".%L"),n=t(":%S"),r=t("%I:%M"),i=t("%I %p"),a=t("%a %d"),u=t("%b %d"),o=t("%B"),s=t("%Y");return function(t){var l=+t;return(c.utcSecond(t)<l?e:c.utcMinute(t)<l?n:c.utcHour(t)<l?r:c.utcDay(t)<l?i:c.utcMonth(t)<l?c.utcWeek(t)<l?a:u:c.utcYear(t)<l?o:s)(t)}}var c=t("d3-time"),l=t("d3-time-format"),f=t("d3-format"),h=f,d=l;e.exports={numberLocale:r,number:function(t){return h.format(t)},numberPrefix:function(t,e){return h.formatPrefix(t,e)},timeLocale:i,time:function(t){return d.format(t)},utc:function(t){return d.utcFormat(t)},locale:function(t){r(t),i(t)},auto:{number:u,time:function(){return o()},utc:function(){return s()}}};var m=Math.sqrt(50),g=Math.sqrt(10),p=Math.sqrt(2)},{"d3-format":3,"d3-time":5,"d3-time-format":4}],13:[function(t,e,n){var r=e.exports={};r.repeat=function(t,e){var n,r=Array(e);for(n=0;e>n;++n)r[n]=t;return r},r.zeros=function(t){return r.repeat(0,t)},r.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),(e-t)/n==1/0)throw new Error("Infinite range");var r,i=[],a=-1;if(0>n)for(;(r=t+n*++a)>e;)i.push(r);else for(;(r=t+n*++a)<e;)i.push(r);return i},r.random={},r.random.uniform=function(t,e){void 0===e&&(e=void 0===t?1:t,t=0);var n=e-t,i=function(){return t+n*Math.random()};return i.samples=function(t){return r.zeros(t).map(i)},i},r.random.integer=function(t,e){void 0===e&&(e=t,t=0);var n=e-t,i=function(){return t+Math.floor(n*Math.random())};return i.samples=function(t){return r.zeros(t).map(i)},i},r.random.normal=function(t,e){t=t||0,e=e||1;var n,i=function(){var r,i,a=0,u=0;if(void 0!==n)return a=n,n=void 0,a;do a=2*Math.random()-1,u=2*Math.random()-1,r=a*a+u*u;while(0===r||r>1);return i=Math.sqrt(-2*Math.log(r)/r),n=t+u*i*e,t+a*i*e};return i.samples=function(t){return r.zeros(t).map(i)},i}},{}],14:[function(t,e,n){function r(t,e){if(t){var n=e.header;t=(n?n.join(e.delimiter)+"\n":"")+t}return a.dsv(e.delimiter).parse(t)}var i=t("../../util"),a=t("d3-dsv");r.delimiter=function(t){var e={delimiter:t};return function(t,n){return r(t,n?i.extend(n,e):e)}},e.exports=r},{"../../util":28,"d3-dsv":2}],15:[function(t,e,n){var r=t("./dsv");e.exports={json:t("./json"),topojson:t("./topojson"),treejson:t("./treejson"),dsv:r,csv:r.delimiter(","),tsv:r.delimiter("	")}},{"./dsv":14,"./json":16,"./topojson":17,"./treejson":18}],16:[function(t,e,n){var r=t("../../util");e.exports=function(t,e){var n=r.isObject(t)&&!r.isBuffer(t)?t:JSON.parse(t);return e&&e.property&&(n=r.accessor(e.property)(n)),n}},{"../../util":28}],17:[function(t,e,n){(function(n){var r=t("./json"),i=function(t,e){var n=i.topojson;if(null==n)throw Error("TopoJSON library not loaded.");var a,u=r(t,e);if(e&&e.feature){if(a=u.objects[e.feature])return n.feature(u,a).features;throw Error("Invalid TopoJSON object: "+e.feature)}if(e&&e.mesh){if(a=u.objects[e.mesh])return[n.mesh(u,u.objects[e.mesh])];throw Error("Invalid TopoJSON object: "+e.mesh)}throw Error("Missing TopoJSON feature or mesh parameter.")};i.topojson="undefined"!=typeof window?window.topojson:"undefined"!=typeof n?n.topojson:null,e.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./json":16}],18:[function(t,e,n){function r(t,e){function n(t){r.push(t);var i=t[e];if(i)for(var a=0;a<i.length;++a)n(i[a],t)}e=e||"children";var r=[];return n(t,null),r.root=t,r}var i=t("./json");e.exports=function(t,e){return t=i(t,e),r(t,e&&e.children)}},{"./json":16}],19:[function(t,e,n){function r(e){var n=e.url;if(!n&&e.file)return f+e.file;if(e.baseURL&&!l.test(n)&&(c(n,"/")||"/"===e.baseURL[e.baseURL.length-1]||(n="/"+n),n=e.baseURL+n),!i.useXHR&&c(n,"//")&&(n=(e.defaultProtocol||"http")+":"+n),e.domainWhiteList){var r,a;if(i.useXHR){var u=document.createElement("a");u.href=n,""===u.host&&(u.href=u.href),r=u.hostname.toLowerCase(),a=window.location.hostname}else{var o=t("url").parse(n);r=o.hostname,a=null}if(a!==r){var s=e.domainWhiteList.some(function(t){var e=r.length-t.length;return t===r||e>1&&"."===r[e-1]&&r.lastIndexOf(t)===e});if(!s)throw"URL is not whitelisted: "+n}}return n}function i(t,e){var n,r=e||function(t){throw t};try{n=i.sanitizeUrl(t)}catch(a){return void r(a)}return n?i.useXHR?u(n,e):c(n,f)?o(n.slice(f.length),e):n.indexOf("://")<0?o(n,e):s(n,e):void r("Invalid URL: "+t.url)}function a(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function u(t,e){function n(){var t=i.status;!t&&a(i)||t>=200&&300>t||304===t?e(null,i.responseText):e(i,null)}var r=!!e,i=new XMLHttpRequest;return!this.XDomainRequest||"withCredentials"in i||!/^(http(s)?:)?\/\//.test(t)||(i=new XDomainRequest),r&&("onload"in i?i.onload=i.onerror=n:i.onreadystatechange=function(){i.readyState>3&&n()}),i.open("GET",t,r),i.send(),!r&&a(i)?i.responseText:void 0}function o(e,n){var r=t("fs");return n?void r.readFile(e,n):r.readFileSync(e,"utf8")}function s(e,n){if(!n)return t("sync-request")("GET",e).getBody();var r={url:e,encoding:null,gzip:!0};t("request")(r,function(t,e,r){t||200!==e.statusCode?(t=t||"Load failed with response code "+e.statusCode+".",n(t,null)):n(null,r)})}function c(t,e){return null==t?!1:0===t.lastIndexOf(e,0)}var l=/^([A-Za-z]+:)?\/\//,f="file://";i.sanitizeUrl=r,i.useXHR="undefined"!=typeof XMLHttpRequest,e.exports=i},{fs:1,request:1,"sync-request":1,url:1}],20:[function(t,e,n){function r(t,e){var n=e&&e.type||"json";return t=o[n](t,e),e&&e.parse&&i(t,e.parse),t}function i(t,e){var n,r,i,o,s,c,l=t.length;for(e="auto"===e?u.inferAll(t):a.duplicate(e),n=a.keys(e),r=n.map(function(t){return u.parsers[e[t]]}),o=0,c=n.length;l>o;++o)for(i=t[o],s=0;c>s;++s)i[n[s]]=r[s](i[n[s]]);u.annotation(t,e)}var a=t("../util"),u=t("./type"),o=t("./formats");r.formats=o,e.exports=r},{"../util":28,"./formats":15,"./type":22}],21:[function(t,e,n){var r=t("../util"),i=t("./load"),a=t("./read");e.exports=r.keys(a.formats).reduce(function(t,e){return t[e]=function(t,n,u){r.isString(t)&&(t={url:t}),2===arguments.length&&r.isFunction(n)&&(u=n,n=void 0),n=r.extend({parse:"auto"},n),n.type=e;var o=i(t,u?function(t,e){if(t)return void u(t,null);try{e=a(e,n),u(null,e)}catch(r){u(r,null)}}:void 0);return u?void 0:a(o,n)},t},{})},{"../util":28,"./load":19,"./read":20}],22:[function(t,e,n){function r(t,e){return e?void(t[c]=e):t&&t[c]||null}function i(t,e){e=s.$(e);var n,r,i;if(t[c]&&(n=e(t[c]),s.isString(n)))return n;for(r=0,i=t.length;!s.isValid(n)&&i>r;++r)n=e?e(t[r]):t[r];return s.isDate(n)?"date":s.isNumber(n)?"number":s.isBoolean(n)?"boolean":s.isString(n)?"string":null}function a(t,e){return t.length?(e=e||s.keys(t[0]),e.reduce(function(e,n){return e[n]=i(t,n),e},{})):void 0}function u(t,e){e=s.$(e);var n,r,i,a=["boolean","integer","number","date"];for(n=0;n<t.length;++n){for(i=e?e(t[n]):t[n],r=0;r<a.length;++r)s.isValid(i)&&!f[a[r]](i)&&(a.splice(r,1),r-=1);if(0===a.length)return"string"}return a[0]}function o(t,e){return e=e||s.keys(t[0]),e.reduce(function(e,n){return e[n]=u(t,n),e},{})}var s=t("../util"),c="__types__",l={"boolean":s["boolean"],integer:s.number,number:s.number,date:s.date,string:function(t){return""===t?null:t}},f={"boolean":function(t){return"true"===t||"false"===t||s.isBoolean(t)},integer:function(t){return f.number(t)&&(t=+t)===~~t},number:function(t){return!isNaN(+t)&&!s.isDate(t)},date:function(t){return!isNaN(Date.parse(t))}};i.annotation=r,i.all=a,i.infer=u,i.inferAll=o,i.parsers=l,e.exports=i},{"../util":28}],23:[function(t,e,n){var r=t("./util"),i={version:"1.4.5",load:t("./import/load"),read:t("./import/read"),type:t("./import/type"),Aggregator:t("./aggregate/aggregator"),groupby:t("./aggregate/groupby"),bins:t("./bins/bins"),$bin:t("./bins/histogram").$bin,histogram:t("./bins/histogram").histogram,format:t("./format"),print:t("./print"),template:t("./template"),time:t("./time")};r.extend(i,r),r.extend(i,t("./generate")),r.extend(i,t("./stats")),r.extend(i,t("./import/readers")),e.exports=i},{"./aggregate/aggregator":6,"./aggregate/groupby":8,"./bins/bins":10,"./bins/histogram":11,"./format":12,"./generate":13,"./import/load":19,"./import/read":20,"./import/readers":21,"./import/type":22,"./print":24,"./stats":25,"./template":26,"./time":27,"./util":28}],24:[function(t,e,n){function r(t){return["valid:    "+t.valid,"missing:  "+t.missing,"distinct: "+t.distinct,"min:      "+t.min,"max:      "+t.max,"median:   "+t.median,"mean:     "+t.mean,"stdev:    "+t.stdev,"modeskew: "+t.modeskew].join("\n")}function i(t){var e=["valid:    "+t.valid,"missing:  "+t.missing,"distinct: "+t.distinct,"top values: "],n=t.unique,r=a.keys(n).sort(function(t,e){return n[e]-n[t]}).slice(0,6).map(function(t){return" '"+t+"' ("+n[t]+")"});return e.concat(r).join("\n")}var a=t("./util"),u=t("./import/type"),o=t("./stats"),s=t("./template"),c={date:'|time:"%m/%d/%Y %H:%M:%S"',number:'|number:".4f"',integer:'|number:"d"'},l={number:"left",integer:"left"};e.exports.table=function(t,e){e=a.extend({separator:" ",minwidth:8,maxwidth:15},e);var n=e.fields||a.keys(t[0]),r=u.all(t);if(e.start||e.limit){var i=e.start||0,f=e.limit?i+e.limit:t.length;t=t.slice(i,f)}var h=n.map(function(n){var i=c[r[n]]||"",a=s("{{"+n+i+"}}"),u=o.max(t,function(t){return a(t).length});return u=Math.max(Math.min(n.length,e.minwidth),u),e.maxwidth>0?Math.min(u,e.maxwidth):u}),d=n.map(function(t,e){return a.truncate(a.pad(t,h[e],"center"),h[e])}).join(e.separator),m=s(n.map(function(t,e){return"{{"+t+(c[r[t]]||"")+("|pad:"+h[e]+","+(l[r[t]]||"right"))+("|truncate:"+h[e])+"}}"}).join(e.separator));return d+"\n"+t.map(m).join("\n")},e.exports.summary=function(t){t=t?t.__summary__?t:o.summary(t):this;var e,n,a=[];for(e=0,n=t.length;n>e;++e)a.push("-- "+t[e].field+" --"),"string"===t[e].type||t[e].distinct<10?a.push(i(t[e])):a.push(r(t[e])),a.push("");return a.join("\n")}},{"./import/type":22,"./stats":25,"./template":26,"./util":28}],25:[function(t,e,n){var r=t("./util"),i=t("./import/type"),a=t("./generate"),u={};u.unique=function(t,e,n){e=r.$(e),n=n||[];var i,a,u,o={};for(a=0,u=t.length;u>a;++a)i=e?e(t[a]):t[a],i in o||(o[i]=1,n.push(i));return n},u.count=function(t){return t&&t.length||0},u.count.valid=function(t,e){e=r.$(e);var n,i,a,u=0;for(i=0,a=t.length;a>i;++i)n=e?e(t[i]):t[i],r.isValid(n)&&(u+=1);return u},u.count.missing=function(t,e){e=r.$(e);var n,i,a,u=0;for(i=0,a=t.length;a>i;++i)n=e?e(t[i]):t[i],null==n&&(u+=1);return u},u.count.distinct=function(t,e){e=r.$(e);var n,i,a,u={},o=0;for(i=0,a=t.length;a>i;++i)n=e?e(t[i]):t[i],n in u||(u[n]=1,o+=1);return o},u.count.map=function(t,e){e=r.$(e);var n,i,a,u={};for(i=0,a=t.length;a>i;++i)n=e?e(t[i]):t[i],u[n]=n in u?u[n]+1:1;return u},u.median=function(t,e){return e&&(t=t.map(r.$(e))),t=t.filter(r.isValid).sort(r.cmp),u.quantile(t,.5)},u.quartile=function(t,e){e&&(t=t.map(r.$(e))),t=t.filter(r.isValid).sort(r.cmp);var n=u.quantile;return[n(t,.25),n(t,.5),n(t,.75)]},u.quantile=function(t,e,n){void 0===n&&(n=e,e=r.identity),e=r.$(e);var i=(t.length-1)*n+1,a=Math.floor(i),u=+e(t[a-1]),o=i-a;return o?u+o*(e(t[a])-u):u},u.sum=function(t,e){e=r.$(e);for(var n,i=0,a=0,u=t.length;u>a;++a)n=e?e(t[a]):t[a],r.isValid(n)&&(i+=n);return i},u.mean=function(t,e){e=r.$(e);var n,i,a,u,o,s=0;for(i=0,u=0,a=t.length;a>i;++i)o=e?e(t[i]):t[i],r.isValid(o)&&(n=o-s,s+=n/++u);return s},u.variance=function(t,e){if(e=r.$(e),!r.isArray(t)||t.length<2)return 0;var n,i,a,u,o=0,s=0;for(i=0,a=0;i<t.length;++i)u=e?e(t[i]):t[i],r.isValid(u)&&(n=u-o,o+=n/++a,s+=n*(u-o));return s/=a-1},u.stdev=function(t,e){return Math.sqrt(u.variance(t,e))},u.modeskew=function(t,e){var n=u.mean(t,e),r=u.median(t,e),i=u.stdev(t,e);return 0===i?0:(n-r)/i},u.min=function(t,e){return u.extent(t,e)[0]},u.max=function(t,e){return u.extent(t,e)[1]},u.extent=function(t,e){e=r.$(e);var n,i,a,u,o=t.length;for(u=0;o>u;++u)if(a=e?e(t[u]):t[u],r.isValid(a)){n=i=a;break}for(;o>u;++u)a=e?e(t[u]):t[u],r.isValid(a)&&(n>a&&(n=a),a>i&&(i=a));return[n,i]},u.extent.index=function(t,e){e=r.$(e);var n,i,a,u,o=-1,s=-1,c=t.length;for(u=0;c>u;++u)if(a=e?e(t[u]):t[u],r.isValid(a)){n=i=a,o=s=u;break}for(;c>u;++u)a=e?e(t[u]):t[u],r.isValid(a)&&(n>a&&(n=a,o=u),a>i&&(i=a,s=u));return[o,s]},u.dot=function(t,e,n){var i,a,u=0;if(n)for(e=r.$(e),n=r.$(n),i=0;i<t.length;++i)a=e(t[i])*n(t[i]),a===a&&(u+=a);else{if(t.length!==e.length)throw Error("Array lengths must match.");for(i=0;i<t.length;++i)a=t[i]*e[i],a===a&&(u+=a)}return u},u.rank=function(t,e){e=r.$(e)||r.identity;var n,i,a,u=t.map(function(t,n){return{idx:n,val:e(t)}}).sort(r.comparator("val")),o=t.length,s=Array(o),c=-1,l={};for(n=0;o>n;++n){if(i=u[n].val,0>c&&l===i)c=n-1;else if(c>-1&&l!==i){for(a=1+(n-1+c)/2;n>c;++c)s[u[c].idx]=a;c=-1}s[u[n].idx]=n+1,l=i}if(c>-1)for(a=1+(o-1+c)/2;o>c;++c)s[u[c].idx]=a;return s},u.cor=function(t,e,n){var i=n;n=i?t.map(r.$(n)):e,e=i?t.map(r.$(e)):t;var a=u.dot(e,n),o=u.mean(e),s=u.mean(n),c=u.stdev(e),l=u.stdev(n),f=t.length;return(a-f*o*s)/((f-1)*c*l)},u.cor.rank=function(t,e,n){var i,a,o,s=n?u.rank(t,r.$(e)):u.rank(t),c=n?u.rank(t,r.$(n)):u.rank(e),l=t.length;for(i=0,a=0;l>i;++i)o=s[i]-c[i],a+=o*o;return 1-6*a/(l*(l*l-1))},u.cor.dist=function(t,e,n){var i,a,o,s,c=n?t.map(r.$(e)):t,l=n?t.map(r.$(n)):e,f=u.dist.mat(c),h=u.dist.mat(l),d=f.length;for(i=0,a=0,o=0,s=0;d>i;++i)a+=f[i]*f[i],o+=h[i]*h[i],s+=f[i]*h[i];return Math.sqrt(s/Math.sqrt(a*o))},u.dist=function(t,e,n,i){var a,u,o=r.isFunction(n)||r.isString(n),s=t,c=o?t:e,l=o?i:n,f=2===l||null==l,h=t.length,d=0;for(o&&(e=r.$(e),n=r.$(n)),u=0;h>u;++u)a=o?e(s[u])-n(c[u]):s[u]-c[u],d+=f?a*a:Math.pow(Math.abs(a),l);return f?Math.sqrt(d):Math.pow(d,1/l)},u.dist.mat=function(t){var e,n,r,i=t.length,u=i*i,o=Array(u),s=a.zeros(i),c=0;for(n=0;i>n;++n)for(o[n*i+n]=0,r=n+1;i>r;++r)o[n*i+r]=e=Math.abs(t[n]-t[r]),o[r*i+n]=e,s[n]+=e,s[r]+=e;for(n=0;i>n;++n)c+=s[n],s[n]/=i;for(c/=u,n=0;i>n;++n)for(r=n;i>r;++r)o[n*i+r]+=c-s[n]-s[r],o[r*i+n]=o[n*i+r];return o},u.entropy=function(t,e){e=r.$(e);var n,i,a=0,u=0,o=t.length;for(n=0;o>n;++n)a+=e?e(t[n]):t[n];if(0===a)return 0;for(n=0;o>n;++n)i=(e?e(t[n]):t[n])/a,i&&(u+=i*Math.log(i));return-u/Math.LN2},u.mutual=function(t,e,n,i){var a,u,o,s=i?t.map(r.$(e)):t,c=i?t.map(r.$(n)):e,l=i?t.map(r.$(i)):n,f={},h={},d=l.length,m=0,g=0,p=0;for(o=0;d>o;++o)f[s[o]]=0,h[c[o]]=0;for(o=0;d>o;++o)f[s[o]]+=l[o],h[c[o]]+=l[o],m+=l[o];for(u=1/(m*Math.LN2),o=0;d>o;++o)0!==l[o]&&(a=m*l[o]/(f[s[o]]*h[c[o]]),g+=l[o]*u*Math.log(a),p+=l[o]*u*Math.log(l[o]/m));return[g,1+g/p]},u.mutual.info=function(t,e,n,r){return u.mutual(t,e,n,r)[0]},u.mutual.dist=function(t,e,n,r){return u.mutual(t,e,n,r)[1]},u.profile=function(t,e){var n,a,o,s,c,l=0,f=0,h=0,d=0,m=null,g=null,p=0,v=[],y={};for(o=0;o<t.length;++o)s=e?e(t[o]):t[o],y[s]=s in y?y[s]+1:(d+=1,1),null==s?++h:r.isValid(s)&&(c="string"==typeof s?s.length:s,(null===m||m>c)&&(m=c),(null===g||c>g)&&(g=c),n=c-l,l+=n/++f,p+=n*(c-l),v.push(c));return p/=f-1,a=Math.sqrt(p),v.sort(r.cmp),{type:i(t,e),unique:y,count:t.length,valid:f,missing:h,distinct:d,min:m,max:g,mean:l,stdev:a,median:s=u.quantile(v,.5),q1:u.quantile(v,.25),q3:u.quantile(v,.75),modeskew:0===a?0:(l-s)/a}},u.summary=function(t,e){e=e||r.keys(t[0]);var n=e.map(function(e){var n=u.profile(t,r.$(e));return n.field=e,n});return n.__summary__=!0,n},e.exports=u},{"./generate":13,"./import/type":22,"./util":28}],26:[function(t,e,n){function r(t){var e=i(t,"d");return e="var __t; return "+e+";",new Function("d",e).bind(l)}function i(t,e,n){e=e||"obj";var r=0,i="'",o=f;return t.replace(o,function(o,s,c){return i+=t.slice(r,c).replace(g,u),r=c+o.length,s&&(i+="'\n+((__t=("+a(s,e,n)+"))==null?'':__t)+\n'"),o}),i+"'"}function a(t,e,n){function i(t){return t=t||"",g?(g=!1,p="String("+p+")"+t):p+=t,p}function a(){return"(typeof "+p+'==="number"?new Date('+p+"):"+p+")"}function u(t,e){_=o(w[0],e,t),g=!1,p="this.formats["+_+"]("+p+")"}function l(t,e){_=o(w[0],e,t),g=!1,p="this.formats["+_+"]("+a()+")"}var f=t.match(h),m=f.shift().trim(),g=!0;n&&(n[m]=1);for(var p=r.property(e,m),v=0;v<f.length;++v){var y,_,M,b=f[v],w=null;switch((y=b.indexOf(":"))>0&&(b=b.slice(0,y),w=f[v].slice(y+1).match(d).map(function(t){return t.trim()})),b=b.trim()){case"length":i(".length");break;case"lower":i(".toLowerCase()");break;case"upper":i(".toUpperCase()");break;case"lower-locale":i(".toLocaleLowerCase()");break;case"upper-locale":i(".toLocaleUpperCase()");break;case"trim":i(".trim()");break;case"left":_=s.number(w[0]),i(".slice(0,"+_+")");break;case"right":_=s.number(w[0]),i(".slice(-"+_+")");break;case"mid":_=s.number(w[0]),M=_+s.number(w[1]),i(".slice(+"+_+","+M+")");break;case"slice":_=s.number(w[0]),i(".slice("+_+(w.length>1?","+s.number(w[1]):"")+")");break;case"truncate":_=s.number(w[0]),M=w[1],M="left"!==M&&"middle"!==M&&"center"!==M?"right":M,p="this.truncate("+i()+","+_+",'"+M+"')";break;case"pad":_=s.number(w[0]),M=w[1],M="left"!==M&&"middle"!==M&&"center"!==M?"right":M,p="this.pad("+i()+","+_+",'"+M+"')";break;case"number":u(c.number,"number");break;case"time":l(c.time,"time");break;case"time-utc":l(c.utc,"time-utc");break;default:throw Error("Unrecognized template filter: "+b)}}return p}function u(t){return"\\"+m[t]}function o(t,e,n){if(!("'"===t[0]&&"'"===t[t.length-1]||'"'===t[0]&&'"'===t[t.length-1]))throw Error("Format pattern must be quoted: "+t);if(t=t.slice(1,-1),e=e+":"+t,!l.format_map[e]){var r=n(t),i=l.formats.length;l.formats.push(r),l.format_map[e]=i}return l.format_map[e]}var s=t("./util"),c=t("./format"),l={formats:[],format_map:{},truncate:s.truncate,pad:s.pad};r.source=i,r.context=l,e.exports=r,r.clearFormatCache=function(){l.formats=[],l.format_map={}},r.property=function(t,e){var n=s.field(e).map(s.str).join("][");return t+"["+n+"]"};var f=/\{\{(.+?)\}\}|$/g,h=/(?:"[^"]*"|\'[^\']*\'|[^\|"]+|[^\|\']+)+/g,d=/(?:"[^"]*"|\'[^\']*\'|[^,"]+|[^,\']+)+/g,m={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},g=/\\|'|\r|\n|\u2028|\u2029/g},{"./format":12,"./util":28}],27:[function(t,e,n){function r(t){return c.setTime(+t),c}function i(t,e,n,r,i,a){var u={type:t,date:e,unit:n};return r?u.step=r:u.minstep=1,null!=i&&(u.min=i),null!=a&&(u.max=a),u}function a(t,e,n,r,a,u){return i(t,function(t){return e.offset(n,t)},function(t){return e.count(n,t)},r,a,u)}function u(t,e,n,r){var i,a,u,o=m[0];for(i=1,a=m.length;a>i;++i)if(o=m[i],e>o[0]){if(u=e/o[0],u>r)return t[m[i-1][1]];if(u>=n)return t[o[1]]}return t[m[a-1][1]]}function o(t){var e,n,r={};for(e=0,n=t.length;n>e;++e)r[t[e].type]=t[e];return r.find=function(e,n,r){return u(t,e,n,r)},r}var s=t("d3-time"),c=new Date,l=new Date(0,0,1).setFullYear(0),f=new Date(Date.UTC(0,0,1)).setUTCFullYear(0),h=[a("second",s.second,l),a("minute",s.minute,l),a("hour",s.hour,l),a("day",s.day,l,[1,7]),a("month",s.month,l,[1,3,6]),a("year",s.year,l),i("seconds",function(t){return new Date(1970,0,1,0,0,t)},function(t){return r(t).getSeconds()},null,0,59),i("minutes",function(t){return new Date(1970,0,1,0,t)},function(t){return r(t).getMinutes()},null,0,59),i("hours",function(t){return new Date(1970,0,1,t)},function(t){return r(t).getHours()},null,0,23),i("weekdays",function(t){return new Date(1970,0,4+t)},function(t){return r(t).getDay()},[1],0,6),i("dates",function(t){return new Date(1970,0,t)},function(t){return r(t).getDate()},[1],1,31),i("months",function(t){return new Date(1970,t%12,1)},function(t){return r(t).getMonth()},[1],0,11)],d=[a("second",s.utcSecond,f),a("minute",s.utcMinute,f),a("hour",s.utcHour,f),a("day",s.utcDay,f,[1,7]),a("month",s.utcMonth,f,[1,3,6]),a("year",s.utcYear,f),i("seconds",function(t){return new Date(Date.UTC(1970,0,1,0,0,t))},function(t){return r(t).getUTCSeconds()},null,0,59),i("minutes",function(t){return new Date(Date.UTC(1970,0,1,0,t))},function(t){return r(t).getUTCMinutes()},null,0,59),i("hours",function(t){return new Date(Date.UTC(1970,0,1,t))},function(t){return r(t).getUTCHours()},null,0,23),i("weekdays",function(t){return new Date(Date.UTC(1970,0,4+t))},function(t){return r(t).getUTCDay()},[1],0,6),i("dates",function(t){return new Date(Date.UTC(1970,0,t))},function(t){return r(t).getUTCDate()},[1],1,31),i("months",function(t){return new Date(Date.UTC(1970,t%12,1))},function(t){return r(t).getUTCMonth()},[1],0,11)],m=[[31536e6,5],[7776e6,4],[2592e6,4],[12096e5,3],[6048e5,3],[1728e5,3],[864e5,3],[432e5,2],[216e5,2],[108e5,2],[36e5,2],[18e5,1],[9e5,1],[3e5,1],[6e4,1],[3e4,0],[15e3,0],[5e3,0],[1e3,0]];e.exports=o(h),e.exports.utc=o(d)},{"d3-time":5}],28:[function(t,e,n){function r(t){return t.replace(h,"$1\\'")}function i(t,e){var n,r="";for(n=0;t>n;++n)r+=e;return r}function a(t,e,n){var r=0,i=t.split(m);return t=n?(i=i.reverse()).filter(function(t){return r+=t.length,e>=r}).reverse():i.filter(function(t){return r+=t.length,e>=r}),t.length?t.join("").trim():i[0].slice(0,e)}var u=t("buffer"),o=t("./time"),s=o.utc,c=e.exports={},l="__name__";c.namedfunc=function(t,e){return e[l]=t,e},c.name=function(t){return null==t?null:t[l]},c.identity=function(t){return t},c["true"]=c.namedfunc("true",function(){return!0}),c["false"]=c.namedfunc("false",function(){return!1}),c.duplicate=function(t){return JSON.parse(JSON.stringify(t))},c.equal=function(t,e){return JSON.stringify(t)===JSON.stringify(e)},c.extend=function(t){for(var e,n,r=1,i=arguments.length;i>r;++r){e=arguments[r];for(n in e)t[n]=e[n]}return t},c.length=function(t){return null!=t&&null!=t.length?t.length:null},c.keys=function(t){var e,n=[];for(e in t)n.push(e);return n},c.vals=function(t){var e,n=[];for(e in t)n.push(t[e]);return n},c.toMap=function(t,e){return(e=c.$(e))?t.reduce(function(t,n){return t[e(n)]=1,t},{}):t.reduce(function(t,e){return t[e]=1,t},{})},c.keystr=function(t){var e=t.length;if(!e)return"";for(var n=String(t[0]),r=1;e>r;++r)n+="|"+String(t[r]);return n};var f=Object.prototype.toString;c.isObject=function(t){return t===Object(t);
},c.isFunction=function(t){return"[object Function]"===f.call(t)},c.isString=function(t){return"string"==typeof value||"[object String]"===f.call(t)},c.isArray=Array.isArray||function(t){return"[object Array]"===f.call(t)},c.isNumber=function(t){return"number"==typeof t||"[object Number]"===f.call(t)},c.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==f.call(t)},c.isDate=function(t){return"[object Date]"===f.call(t)},c.isValid=function(t){return null!=t&&t===t},c.isBuffer=u.Buffer&&u.Buffer.isBuffer||c["false"],c.number=function(t){return null==t||""===t?null:+t},c["boolean"]=function(t){return null==t||""===t?null:"false"===t?!1:!!t},c.date=function(t){return null==t||""===t?null:Date.parse(t)},c.array=function(t){return null!=t?c.isArray(t)?t:[t]:[]},c.str=function(t){return c.isArray(t)?"["+t.map(c.str)+"]":c.isObject(t)?JSON.stringify(t):c.isString(t)?"'"+r(t)+"'":t};var h=/(^|[^\\])'/g,d=/\[(.*?)\]|[^.\[]+/g;c.field=function(t){return String(t).match(d).map(function(t){return"["!==t[0]?t:"'"!==t[1]&&'"'!==t[1]?t.slice(1,-1):t.slice(2,-2).replace(/\\(["'])/g,"$1")})},c.accessor=function(t){var e;return null==t||c.isFunction(t)?t:c.namedfunc(t,(e=c.field(t)).length>1?function(t){return e.reduce(function(t,e){return t[e]},t)}:function(e){return e[t]})},c.$=c.accessor,c.mutator=function(t){var e;return c.isString(t)&&(e=c.field(t)).length>1?function(t,n){for(var r=0;r<e.length-1;++r)t=t[e[r]];t[e[r]]=n}:function(e,n){e[t]=n}},c.$func=function(t,e){return function(n){n=c.$(n)||c.identity;var r=t+(c.name(n)?"_"+c.name(n):"");return c.namedfunc(r,function(t){return e(n(t))})}},c.$valid=c.$func("valid",c.isValid),c.$length=c.$func("length",c.length),c.$in=function(t,e){t=c.$(t);var n=c.isArray(e)?c.toMap(e):e;return function(e){return!!n[t(e)]}},c.$year=c.$func("year",o.year.unit),c.$month=c.$func("month",o.months.unit),c.$date=c.$func("date",o.dates.unit),c.$day=c.$func("day",o.weekdays.unit),c.$hour=c.$func("hour",o.hours.unit),c.$minute=c.$func("minute",o.minutes.unit),c.$second=c.$func("second",o.seconds.unit),c.$utcYear=c.$func("utcYear",s.year.unit),c.$utcMonth=c.$func("utcMonth",s.months.unit),c.$utcDate=c.$func("utcDate",s.dates.unit),c.$utcDay=c.$func("utcDay",s.weekdays.unit),c.$utcHour=c.$func("utcHour",s.hours.unit),c.$utcMinute=c.$func("utcMinute",s.minutes.unit),c.$utcSecond=c.$func("utcSecond",s.seconds.unit),c.comparator=function(t){var e=[];return void 0===t&&(t=[]),t=c.array(t).map(function(t){var n=1;return"-"===t[0]?(n=-1,t=t.slice(1)):"+"===t[0]&&(n=1,t=t.slice(1)),e.push(n),c.accessor(t)}),function(n,r){var i,a,u,o,s;for(i=0,a=t.length;a>i;++i){if(u=t[i],o=u(n),s=u(r),s>o)return-1*e[i];if(o>s)return e[i]}return 0}},c.cmp=function(t,e){return e>t?-1:t>e?1:t>=e?0:null===t?-1:null===e?1:NaN},c.numcmp=function(t,e){return t-e},c.stablesort=function(t,e,n){var r=t.reduce(function(t,e,r){return t[n(e)]=r,t},{});return t.sort(function(t,i){var a=e(t),u=e(i);return u>a?-1:a>u?1:r[n(t)]-r[n(i)]}),t},c.pad=function(t,e,n,r){r=r||" ";var a=e-t.length;if(0>=a)return t;switch(n){case"left":return i(a,r)+t;case"middle":case"center":return i(Math.floor(a/2),r)+t+i(Math.ceil(a/2),r);default:return t+i(a,r)}},c.truncate=function(t,e,n,r,i){var u=t.length;if(e>=u)return t;i=void 0!==i?String(i):"…";var o=Math.max(0,e-i.length);switch(n){case"left":return i+(r?a(t,o,1):t.slice(u-o));case"middle":case"center":var s=Math.ceil(o/2),c=Math.floor(o/2);return(r?a(t,s):t.slice(0,s))+i+(r?a(t,c,1):t.slice(u-c));default:return(r?a(t,o):t.slice(0,o))+i}};var m=/([\u0009\u000A\u000B\u000C\u000D\u0020\u00A0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u2028\u2029\u3000\uFEFF])/},{"./time":27,buffer:1}],29:[function(t,e,n){function r(t){t="[Vega Log] "+t,console.log(t)}function i(t){t="[Vega Err] "+t,console.error(t)}function a(t,e){if(a.enable){var n=Function.prototype.bind.call(console.log,console),r={prevTime:Date.now()-u,stamp:t.stamp};t.add&&(r.add=t.add.length,r.mod=t.mod.length,r.rem=t.rem.length,r.reflow=!!t.reflow),n.apply(console,(e.push(JSON.stringify(r)),e)),u=Date.now()}}var u=Date.now();e.exports={log:r,error:i,debug:(a.enable=!1,a)}},{}],30:[function(t,e,n){function r(t,e){var n={};return i(t,n),n.add=[],n.mod=[],n.rem=[],n.reflow=e,n}function i(t,e){e.stamp=t?t.stamp:0,e.sort=t?t.sort:null,e.facet=t?t.facet:null,e.trans=t?t.trans:null,e.dirty=t?t.dirty:[],e.request=t?t.request:null;for(var n,r=0,i=a.length;i>r;++r)e[n=a[r]]=t?t[n]:{}}var a=t("./Dependencies").ALL;e.exports={create:r,copy:i}},{"./Dependencies":33}],31:[function(t,e,n){function r(t){u.init.call(this,t),this._data=[],this.router(!0).collector(!0)}var i=t("vega-logging"),a=t("./Tuple"),u=t("./Node").prototype,o=r.prototype=Object.create(u);o.constructor=r,o.data=function(){return this._data},o.evaluate=function(t){return i.debug(t,["collecting"]),t.rem.length&&(this._data=a.idFilter(this._data,t.rem)),t.add.length&&(this._data=this._data.length?this._data.concat(t.add):t.add),t.sort&&this._data.sort(t.sort),t.reflow&&(t.mod=t.mod.concat(a.idFilter(this._data,t.add,t.mod,t.rem)),t.reflow=!1),t},e.exports=r},{"./Node":36,"./Tuple":38,"vega-logging":29}],32:[function(t,e,n){function r(t,e,n){this._graph=t,this._name=e,this._data=[],this._source=null,this._facet=n,this._input=s.create(),this._output=null,this._inputNode=null,this._outputNode=null,this._pipeline=null,this._collector=null,this._mutates=!1}function i(t){var e=new f(t._graph).router(!0).collector(!0);return e.data=function(){return t._data},e.evaluate=function(e){o.debug(e,["input",t._name]);var n,r=t._input,i=s.create(e);for(n in r.fields)i.fields[n]=1;return r.rem.length&&(t._data=l.idFilter(t._data,r.rem)),r.add.length&&(t._data=t._data.concat(r.add)),e.reflow&&(r.mod=r.mod.concat(l.idFilter(t._data,r.add,r.mod,r.rem))),t._input=s.create(),i.add=r.add,i.mod=r.mod,i.rem=r.rem,i.facet=t._facet,i},e}function a(t){var e=new f(t._graph).router(!0).reflows(!0).collector(!0);return e.data=function(){return t._collector?t._collector.data():t._data},e.evaluate=function(e){o.debug(e,["output",t._name]);var n=s.create(e,!0);return t._facet&&(t._facet.values=t.values(),e.facet=null),t._output=e,n.data[t._name]=1,n},e}function u(t){var e=new f(t._graph).router(!0);return e.evaluate=function(e){if(t.mutates()){var n=t._srcMap||(t._srcMap={}),r=s.create(e);return r.add=e.add.map(function(t){return n[t._id]=l.derive(t)}),r.mod=e.mod.map(function(t){return l.rederive(t,n[t._id])}),r.rem=e.rem.map(function(t){var e=n[t._id];return n[t._id]=null,e}),t._input=r}return t._input=e},e}var o=t("vega-logging"),s=t("./ChangeSet"),c=t("./Collector"),l=t("./Tuple"),f=t("./Node"),h=r.prototype;h.name=function(t){return arguments.length?(this._name=t,this):this._name},h.source=function(t){return arguments.length?this._source=this._graph.data(t):this._source},h.insert=function(t){return this._input.add=this._input.add.concat(t.map(l.ingest)),this},h.remove=function(t){var e=this._data.filter(t);return this._input.rem=this._input.rem.concat(e),this},h.update=function(t,e,n){var r=this._input.mod,i=l.idMap(r);return this._input.fields[e]=1,this._data.filter(t).forEach(function(t){var a=t[e],u=n(t);a!==u&&(l.set(t,e,u),1!==i[t._id]&&(r.push(t),i[t._id]=1))}),this},h.values=function(t){return arguments.length?(this._input.rem=this._data.slice(),t&&this.insert(t),this):this._collector.data()},h.mutates=function(t){return arguments.length?(this._mutates=this._mutates||t,this):this._mutates},h.last=function(){return this._output},h.fire=function(t){return t&&(this._input=t),this._graph.propagate(this._input,this._pipeline[0]),this},h.pipeline=function(t){if(!arguments.length)return this._pipeline;var e,n=this._graph;return t.unshift(this._inputNode=i(this)),e=n.preprocess(t),e.router&&t.push(e.collector=new c(n)),t.push(this._outputNode=a(this)),this._collector=e.collector,this._mutates=!!e.mutates,n.connect(this._pipeline=t),this},h.synchronize=function(){return this._graph.synchronize(this._pipeline),this},h.listener=function(){return u(this).addListener(this._inputNode)},h.addListener=function(t){return t instanceof r?this._collector.addListener(t.listener()):this._outputNode.addListener(t),this},h.removeListener=function(t){this._outputNode.removeListener(t)},h.listeners=function(t){return(t?this._collector:this._outputNode).listeners()},e.exports=r},{"./ChangeSet":30,"./Collector":31,"./Node":36,"./Tuple":38,"vega-logging":29}],33:[function(t,e,n){var r=e.exports={ALL:["data","fields","scales","signals"]};r.ALL.forEach(function(t){r[t.toUpperCase()]=t})},{}],34:[function(t,e,n){function r(){}var i=t("datalib"),a=t("./Heap"),u=t("./ChangeSet"),o=t("./DataSource"),s=t("./Collector"),c=t("./Tuple"),l=t("./Signal"),f=t("./Dependencies"),h=r.prototype;h.init=function(){this._stamp=0,this._rank=0,this._data={},this._signals={},this.doNotPropagate={}},h.rank=function(){return++this._rank},h.values=function(t,e,n){var r,a,u=t===f.SIGNALS?this._signals:this._data,o=void 0!==e?e:i.keys(u);if(Array.isArray(o)){for(r=n||{},a=0;a<o.length;++a)r[o[a]]=u[o[a]].values();return r}return u[o].values()},h.dataValues=function(t){return this.values(f.DATA,t)},h.signalValues=function(t){return this.values(f.SIGNALS,t)},h.data=function(t,e,n){var r=this._data;if(arguments.length)return 1===arguments.length?r[t]:r[t]=new o(this,t,n).pipeline(e);var i,a=[];for(i in r)a.push(r[i]);return a},h.signal=function(t,e){if(1===arguments.length){var n=this;return Array.isArray(t)?t.map(function(t){return n._signals[t]}):this._signals[t]}return this._signals[t]=new l(this,t,e)},h.signalRef=function(t){Array.isArray(t)||(t=i.field(t));var e=this.signal(t[0]).value();if(t.length>1)for(var n=1,r=t.length;r>n;++n)e=e[t[n]];return e},h.propagate=function(t,e,n){var r,i,o,s,c,l,f,h={},d=new a(function(t,e){return t._qrank-e._qrank});if(t.stamp)throw Error("Pulse already has a non-zero stamp.");for(t.stamp=n||++this._stamp,h[e._id]=t,d.push(e.qrank(!0));d.size()>0;)if(e=d.peek(),t=h[e._id],e.rank()!==e.qrank())d.replace(e.qrank(!0));else if(d.pop(),h[e._id]=null,r=e._listeners,t=this.evaluate(t,e),t!==this.doNotPropagate)for(!t.reflow&&e.reflows()&&(t=u.create(t,!0)),l=0,f=r.length;f>l;++l)if(i=r[l],void 0!==(o=h[i._id])){if(null===o)throw Error("Already propagated to node.");if(o===t)continue;if(s=t.add.length||t.mod.length||t.rem.length,c=o.add.length||o.mod.length||o.rem.length,s&&c)throw Error("Multiple changeset pulses to same node");h[i._id]=s?t:o,h[i._id].reflow=t.reflow||o.reflow}else d.push(i.qrank(!0)),h[i._id]=t},h.preprocess=function(t){for(var e,n,r,i,a=this,u=0,o=0;o<t.length;++o)e=t[o],e.batch()&&!e._collector&&(n||!r?(e=new s(a),t.splice(o,0,e),n=!1):e._collector=r),(i=e.collector())&&(r=e),n=n||e.router()&&!i,u=u||e.mutates(),e.produces()&&(t.splice(o+1,0,new s(a)),n=!1);return{router:n,collector:r,mutates:u}},h.connect=function(t){var e,n,r,i,a,u,o,s;for(a=0,u=t.length;u>a;++a){for(n=t[a],n.collector()&&(e=n),r=n.dependency(f.DATA),o=0,s=r.length;s>o;++o)this.data(r[o]).addListener(e);for(i=n.dependency(f.SIGNALS),o=0,s=i.length;s>o;++o)this.signal(i[o]).addListener(e);a>0&&t[a-1].addListener(n)}return t},h.disconnect=function(t){var e,n,r,i,a,u,o,s;for(a=0,u=t.length;u>a;++a){for(n=t[a],n.collector()&&(e=n),r=n.dependency(f.DATA),o=0,s=r.length;s>o;++o)this.data(r[o]).removeListener(e);for(i=n.dependency(f.SIGNALS),o=0,s=i.length;s>o;++o)this.signal(i[o]).removeListener(e);n.disconnect()}return t},h.synchronize=function(t){var e,n,r,i,a,u,o,s,l={};for(r=0,i=t.length;i>r;++r)if(e=t[r],e.collector())for(a=0,n=e.data(),u=n.length;u>a;++a)s=(o=n[a])._id,l[s]||(c.prev_update(o),l[s]=1);return this},h.reevaluate=function(t,e){var n=t.reflow&&e.last()>=t.stamp,r=e.router()||t.add.length||t.rem.length;return r||!n||e.reevaluate(t)},h.evaluate=function(t,e){return this.reevaluate(t,e)?(t=e.evaluate(t),e.last(t.stamp),t):t},e.exports=r},{"./ChangeSet":30,"./Collector":31,"./DataSource":32,"./Dependencies":33,"./Heap":35,"./Signal":37,"./Tuple":38,datalib:23}],35:[function(t,e,n){function r(t){this.cmp=t,this.nodes=[]}function i(t,e,n,r){var i,a,u;for(i=t[n];n>e&&(u=n-1>>1,a=t[u],r(i,a)<0);)t[n]=a,n=u;return t[n]=i}function a(t,e,n){for(var r,a=e,u=t.length,o=t[e],s=2*e+1;u>s;)r=s+1,u>r&&n(t[s],t[r])>=0&&(s=r),t[e]=t[s],e=s,s=2*e+1;return t[e]=o,i(t,a,e,n)}var u=r.prototype;u.size=function(){return this.nodes.length},u.clear=function(){return this.nodes=[],this},u.peek=function(){return this.nodes[0]},u.push=function(t){var e=this.nodes;return e.push(t),i(e,0,e.length-1,this.cmp)},u.pop=function(){var t,e=this.nodes,n=e.pop();return e.length?(t=e[0],e[0]=n,a(e,0,this.cmp)):t=n,t},u.replace=function(t){var e=this.nodes,n=e[0];return e[0]=t,a(e,0,this.cmp),n},u.pushpop=function(t){var e=this.nodes,n=e[0];return e.length&&this.cmp(n,t)<0&&(e[0]=t,t=n,a(e,0,this.cmp)),t},e.exports=r},{}],36:[function(t,e,n){function r(t){t&&this.init(t)}var i=t("./Dependencies").ALL,a=0,u=r.Flags={Router:1,Collector:2,Produces:4,Mutates:8,Reflows:16,Batch:32},o=r.prototype;o.init=function(t){this._id=++a,this._graph=t,this._rank=t.rank(),this._qrank=null,this._stamp=0,this._listeners=[],this._listeners._ids={},this._deps={};for(var e=0,n=i.length;n>e;++e)this._deps[i[e]]=[];return this._flags=0,this},o.rank=function(){return this._rank},o.qrank=function(){return arguments.length?(this._qrank=this._rank,this):this._qrank},o.last=function(t){return arguments.length?(this._stamp=t,this):this._stamp},o._setf=function(t,e){return e?this._flags|=t:this._flags&=~t,this},o.router=function(t){return arguments.length?this._setf(u.Router,t):this._flags&u.Router},o.collector=function(t){return arguments.length?this._setf(u.Collector,t):this._flags&u.Collector},o.produces=function(t){return arguments.length?this._setf(u.Produces,t):this._flags&u.Produces},o.mutates=function(t){return arguments.length?this._setf(u.Mutates,t):this._flags&u.Mutates},o.reflows=function(t){return arguments.length?this._setf(u.Reflows,t):this._flags&u.Reflows},o.batch=function(t){return arguments.length?this._setf(u.Batch,t):this._flags&u.Batch},o.dependency=function(t,e){var n=this._deps[t],r=n._names||(n._names={});if(1===arguments.length)return n;if(null===e)n.splice(0,n.length),n._names={};else if(Array.isArray(e))for(var i,a=0,u=e.length;u>a;++a)i=e[a],r[i]||(n.push(i),r[i]=1);else{if(r[e])return this;n.push(e),r[e]=1}return this},o.listeners=function(){return this._listeners},o.addListener=function(t){if(!(t instanceof r))throw Error("Listener is not a Node");if(this._listeners._ids[t._id])return this;if(this._listeners.push(t),this._listeners._ids[t._id]=1,this._rank>t._rank)for(var e,n=[t],i=this._graph;n.length;)e=n.shift(),e._rank=i.rank(),n.unshift.apply(n,e.listeners());return this},o.removeListener=function(t){if(!this._listeners._ids[t._id])return!1;var e=this._listeners.indexOf(t),n=e>=0;return n&&(this._listeners.splice(e,1),this._listeners._ids[t._id]=null),n},o.disconnect=function(){this._listeners=[],this._listeners._ids={}},o.evaluate=function(t){return t},o.reevaluate=function(t){var e,n,r,a,u,o;for(r=0,a=i.length;a>r;++r)for(e=i[r],n=this._deps[e],u=0,o=n.length;o>u;++u)if(t[e][n[u]])return!0;return!1},r.reset=function(){a=0},e.exports=r},{"./Dependencies":33}],37:[function(t,e,n){function r(t,e,n){return u.init.call(this,t),this._name=e,this._value=n,this._verbose=!1,this._handlers=[],this}var i=t("./ChangeSet"),a=t("./Node"),u=a.prototype,o=r.prototype=Object.create(u);o.constructor=r,o.name=function(){return this._name},o.value=function(t){return arguments.length?(this._value=t,this):this._value},o.values=o.value,o.verbose=function(t){return arguments.length?(this._verbose=!!t,this):this._verbose},o.evaluate=function(t){return t.signals[this._name]?t:this._graph.doNotPropagate},o.fire=function(t){t||(t=i.create(null,!0)),t.signals[this._name]=1,this._graph.propagate(t,this)},o.on=function(t){var e=this,n=new a(this._graph);return n.evaluate=function(n){return t(e.name(),e.value()),n},this._handlers.push({handler:t,node:n}),this.addListener(n)},o.off=function(t){var e,n,r=this._handlers;for(e=r.length;--e>=0;)t&&r[e].handler!==t||(n=r.splice(e,1)[0],this.removeListener(n.node));return this},e.exports=r},{"./ChangeSet":30,"./Node":36}],38:[function(t,e,n){function r(t){return t=t===Object(t)?t:{data:t},t._id=++u,t._prev&&(t._prev=null),t}function i(t,e){e=e||{};for(var n=0,r=t.length;r>n;++n)e[t[n]._id]=1;return e}function a(t,e){e=e||{};for(var n in t)"_prev"!==n&&"_id"!==n&&(e[n]=t[n]);return e}var u=0;e.exports={ingest:r,idMap:i,derive:function(t){return r(a(t))},rederive:function(t,e){return a(t,e)},set:function(t,e,n){return t[e]===n?0:(t[e]=n,1)},prev:function(t){return t._prev||t},prev_init:function(t){t._prev||(t._prev={_id:t._id})},prev_update:function(t){var e,n,r=t._prev;if(r)for(e in t)"_prev"!==e&&"_id"!==e&&(r[e]=(n=t[e])instanceof Object&&n._prev?n._prev:n)},reset:function(){u=0},idFilter:function(t){for(var e={},n=arguments.length;--n>0;)i(arguments[n],e);return t.filter(function(t){return!e[t._id]})}}},{}],39:[function(t,e,n){e.exports={ChangeSet:t("./ChangeSet"),Collector:t("./Collector"),DataSource:t("./DataSource"),Dependencies:t("./Dependencies"),Graph:t("./Graph"),Node:t("./Node"),Signal:t("./Signal"),Tuple:t("./Tuple"),debug:t("vega-logging").debug}},{"./ChangeSet":30,"./Collector":31,"./DataSource":32,"./Dependencies":33,"./Graph":34,"./Node":36,"./Signal":37,"./Tuple":38,"vega-logging":29}]},{},[39])(39)});
