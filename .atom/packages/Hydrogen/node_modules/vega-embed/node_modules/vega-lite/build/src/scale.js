"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var vega_util_1 = require("vega-util");
var channel_1 = require("./channel");
var log = tslib_1.__importStar(require("./log"));
var type_1 = require("./type");
var util_1 = require("./util");
var ScaleType;
(function (ScaleType) {
    // Continuous - Quantitative
    ScaleType.LINEAR = 'linear';
    ScaleType.BIN_LINEAR = 'bin-linear';
    ScaleType.LOG = 'log';
    ScaleType.POW = 'pow';
    ScaleType.SQRT = 'sqrt';
    // Continuous - Time
    ScaleType.TIME = 'time';
    ScaleType.UTC = 'utc';
    // sequential
    ScaleType.SEQUENTIAL = 'sequential';
    // Quantile, Quantize, threshold
    ScaleType.QUANTILE = 'quantile';
    ScaleType.QUANTIZE = 'quantize';
    ScaleType.THRESHOLD = 'threshold';
    ScaleType.ORDINAL = 'ordinal';
    ScaleType.BIN_ORDINAL = 'bin-ordinal';
    ScaleType.POINT = 'point';
    ScaleType.BAND = 'band';
})(ScaleType = exports.ScaleType || (exports.ScaleType = {}));
/**
 * Index for scale categories -- only scale of the same categories can be merged together.
 * Current implementation is trying to be conservative and avoid merging scale type that might not work together
 */
var SCALE_CATEGORY_INDEX = {
    linear: 'numeric',
    log: 'numeric',
    pow: 'numeric',
    sqrt: 'numeric',
    'bin-linear': 'bin-linear',
    time: 'time',
    utc: 'time',
    sequential: 'sequential',
    ordinal: 'ordinal',
    'bin-ordinal': 'bin-ordinal',
    point: 'ordinal-position',
    band: 'ordinal-position'
};
exports.SCALE_TYPES = util_1.keys(SCALE_CATEGORY_INDEX);
/**
 * Whether the two given scale types can be merged together.
 */
function scaleCompatible(scaleType1, scaleType2) {
    var scaleCategory1 = SCALE_CATEGORY_INDEX[scaleType1];
    var scaleCategory2 = SCALE_CATEGORY_INDEX[scaleType2];
    return scaleCategory1 === scaleCategory2 ||
        (scaleCategory1 === 'ordinal-position' && scaleCategory2 === 'time') ||
        (scaleCategory2 === 'ordinal-position' && scaleCategory1 === 'time');
}
exports.scaleCompatible = scaleCompatible;
/**
 * Index for scale precedence -- high score = higher priority for merging.
 */
var SCALE_PRECEDENCE_INDEX = {
    // numeric
    linear: 0,
    log: 1,
    pow: 1,
    sqrt: 1,
    // time
    time: 0,
    utc: 0,
    // ordinal-position -- these have higher precedence than continuous scales as they support more types of data
    point: 10,
    band: 11,
    // non grouped types
    'bin-linear': 0,
    sequential: 0,
    ordinal: 0,
    'bin-ordinal': 0,
};
/**
 * Return scale categories -- only scale of the same categories can be merged together.
 */
function scaleTypePrecedence(scaleType) {
    return SCALE_PRECEDENCE_INDEX[scaleType];
}
exports.scaleTypePrecedence = scaleTypePrecedence;
exports.CONTINUOUS_TO_CONTINUOUS_SCALES = ['linear', 'bin-linear', 'log', 'pow', 'sqrt', 'time', 'utc'];
var CONTINUOUS_TO_CONTINUOUS_INDEX = vega_util_1.toSet(exports.CONTINUOUS_TO_CONTINUOUS_SCALES);
exports.CONTINUOUS_DOMAIN_SCALES = exports.CONTINUOUS_TO_CONTINUOUS_SCALES.concat(['sequential' /* TODO add 'quantile', 'quantize', 'threshold'*/]);
var CONTINUOUS_DOMAIN_INDEX = vega_util_1.toSet(exports.CONTINUOUS_DOMAIN_SCALES);
exports.DISCRETE_DOMAIN_SCALES = ['ordinal', 'bin-ordinal', 'point', 'band'];
var DISCRETE_DOMAIN_INDEX = vega_util_1.toSet(exports.DISCRETE_DOMAIN_SCALES);
var BIN_SCALES_INDEX = vega_util_1.toSet(['bin-linear', 'bin-ordinal']);
exports.TIME_SCALE_TYPES = ['time', 'utc'];
function hasDiscreteDomain(type) {
    return type in DISCRETE_DOMAIN_INDEX;
}
exports.hasDiscreteDomain = hasDiscreteDomain;
function isBinScale(type) {
    return type in BIN_SCALES_INDEX;
}
exports.isBinScale = isBinScale;
function hasContinuousDomain(type) {
    return type in CONTINUOUS_DOMAIN_INDEX;
}
exports.hasContinuousDomain = hasContinuousDomain;
function isContinuousToContinuous(type) {
    return type in CONTINUOUS_TO_CONTINUOUS_INDEX;
}
exports.isContinuousToContinuous = isContinuousToContinuous;
exports.defaultScaleConfig = {
    textXRangeStep: 90,
    rangeStep: 21,
    pointPadding: 0.5,
    bandPaddingInner: 0.1,
    facetSpacing: 16,
    minBandSize: 2,
    minFontSize: 8,
    maxFontSize: 40,
    minOpacity: 0.3,
    maxOpacity: 0.8,
    // FIXME: revise if these *can* become ratios of rangeStep
    minSize: 9,
    minStrokeWidth: 1,
    maxStrokeWidth: 4
};
function isExtendedScheme(scheme) {
    return scheme && !!scheme['name'];
}
exports.isExtendedScheme = isExtendedScheme;
function isSelectionDomain(domain) {
    return domain && domain['selection'];
}
exports.isSelectionDomain = isSelectionDomain;
var SCALE_PROPERTY_INDEX = {
    type: 1,
    domain: 1,
    range: 1,
    rangeStep: 1,
    scheme: 1,
    // Other properties
    reverse: 1,
    round: 1,
    // quantitative / time
    clamp: 1,
    nice: 1,
    // quantitative
    base: 1,
    exponent: 1,
    interpolate: 1,
    zero: 1,
    // band/point
    padding: 1,
    paddingInner: 1,
    paddingOuter: 1
};
exports.SCALE_PROPERTIES = util_1.flagKeys(SCALE_PROPERTY_INDEX);
var type = SCALE_PROPERTY_INDEX.type, domain = SCALE_PROPERTY_INDEX.domain, range = SCALE_PROPERTY_INDEX.range, rangeStep = SCALE_PROPERTY_INDEX.rangeStep, scheme = SCALE_PROPERTY_INDEX.scheme, NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTY_INDEX = tslib_1.__rest(SCALE_PROPERTY_INDEX, ["type", "domain", "range", "rangeStep", "scheme"]);
exports.NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES = util_1.flagKeys(NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTY_INDEX);
exports.SCALE_TYPE_INDEX = generateScaleTypeIndex();
function scaleTypeSupportProperty(scaleType, propName) {
    switch (propName) {
        case 'type':
        case 'domain':
        case 'reverse':
        case 'range':
            return true;
        case 'scheme':
            return util_1.contains(['sequential', 'ordinal', 'bin-ordinal', 'quantile', 'quantize'], scaleType);
        case 'interpolate':
            // FIXME(https://github.com/vega/vega-lite/issues/2902) how about ordinal?
            return util_1.contains(['linear', 'bin-linear', 'pow', 'log', 'sqrt', 'utc', 'time'], scaleType);
        case 'round':
            return isContinuousToContinuous(scaleType) || scaleType === 'band' || scaleType === 'point';
        case 'padding':
            return isContinuousToContinuous(scaleType) || util_1.contains(['point', 'band'], scaleType);
        case 'paddingOuter':
        case 'rangeStep':
            return util_1.contains(['point', 'band'], scaleType);
        case 'paddingInner':
            return scaleType === 'band';
        case 'clamp':
            return isContinuousToContinuous(scaleType) || scaleType === 'sequential';
        case 'nice':
            return isContinuousToContinuous(scaleType) || scaleType === 'sequential' || scaleType === 'quantize';
        case 'exponent':
            return scaleType === 'pow';
        case 'base':
            return scaleType === 'log';
        case 'zero':
            return hasContinuousDomain(scaleType) && !util_1.contains([
                'log',
                'time', 'utc',
                'bin-linear',
                'threshold',
                'quantile' // quantile depends on distribution so zero does not matter
            ], scaleType);
    }
    /* istanbul ignore next: should never reach here*/
    throw new Error("Invalid scale property " + propName + ".");
}
exports.scaleTypeSupportProperty = scaleTypeSupportProperty;
/**
 * Returns undefined if the input channel supports the input scale property name
 */
function channelScalePropertyIncompatability(channel, propName) {
    switch (propName) {
        case 'interpolate':
        case 'scheme':
            if (!channel_1.isColorChannel(channel)) {
                return log.message.cannotUseScalePropertyWithNonColor(channel);
            }
            return undefined;
        case 'type':
        case 'domain':
        case 'range':
        case 'base':
        case 'exponent':
        case 'nice':
        case 'padding':
        case 'paddingInner':
        case 'paddingOuter':
        case 'rangeStep':
        case 'reverse':
        case 'round':
        case 'clamp':
        case 'zero':
            return undefined; // GOOD!
    }
    /* istanbul ignore next: it should never reach here */
    throw new Error("Invalid scale property \"" + propName + "\".");
}
exports.channelScalePropertyIncompatability = channelScalePropertyIncompatability;
function scaleTypeSupportDataType(specifiedType, fieldDefType, bin) {
    if (util_1.contains([type_1.Type.ORDINAL, type_1.Type.NOMINAL], fieldDefType)) {
        return specifiedType === undefined || hasDiscreteDomain(specifiedType);
    }
    else if (fieldDefType === type_1.Type.TEMPORAL) {
        return util_1.contains([ScaleType.TIME, ScaleType.UTC, ScaleType.SEQUENTIAL, undefined], specifiedType);
    }
    else if (fieldDefType === type_1.Type.QUANTITATIVE) {
        if (bin) {
            return util_1.contains([ScaleType.BIN_LINEAR, ScaleType.BIN_ORDINAL, ScaleType.LINEAR], specifiedType);
        }
        return util_1.contains([ScaleType.LOG, ScaleType.POW, ScaleType.SQRT, ScaleType.QUANTILE, ScaleType.QUANTIZE, ScaleType.LINEAR, ScaleType.SEQUENTIAL, undefined], specifiedType);
    }
    return true;
}
exports.scaleTypeSupportDataType = scaleTypeSupportDataType;
function channelSupportScaleType(channel, scaleType) {
    switch (channel) {
        case channel_1.Channel.X:
        case channel_1.Channel.Y:
        case channel_1.Channel.SIZE: // TODO: size and opacity can support ordinal with more modification
        case channel_1.Channel.OPACITY:
            // Although it generally doesn't make sense to use band with size and opacity,
            // it can also work since we use band: 0.5 to get midpoint.
            return isContinuousToContinuous(scaleType) || util_1.contains(['band', 'point'], scaleType);
        case channel_1.Channel.COLOR:
        case channel_1.Channel.FILL:
        case channel_1.Channel.STROKE:
            return scaleType !== 'band'; // band does not make sense with color
        case channel_1.Channel.SHAPE:
            return scaleType === 'ordinal'; // shape = lookup only
    }
    /* istanbul ignore next: it should never reach here */
    return false;
}
exports.channelSupportScaleType = channelSupportScaleType;
function getSupportedScaleType(channel, fieldDefType, bin) {
    return exports.SCALE_TYPE_INDEX[generateScaleTypeIndexKey(channel, fieldDefType, bin)];
}
exports.getSupportedScaleType = getSupportedScaleType;
// generates ScaleTypeIndex where keys are encoding channels and values are list of valid ScaleTypes
function generateScaleTypeIndex() {
    var index = {};
    for (var _i = 0, CHANNELS_1 = channel_1.CHANNELS; _i < CHANNELS_1.length; _i++) {
        var channel = CHANNELS_1[_i];
        for (var _a = 0, _b = util_1.keys(type_1.TYPE_INDEX); _a < _b.length; _a++) {
            var fieldDefType = _b[_a];
            for (var _c = 0, SCALE_TYPES_1 = exports.SCALE_TYPES; _c < SCALE_TYPES_1.length; _c++) {
                var scaleType = SCALE_TYPES_1[_c];
                for (var _d = 0, _e = [false, true]; _d < _e.length; _d++) {
                    var bin = _e[_d];
                    var key = generateScaleTypeIndexKey(channel, fieldDefType, bin);
                    if (channelSupportScaleType(channel, scaleType) && scaleTypeSupportDataType(scaleType, fieldDefType, bin)) {
                        index[key] = index[key] || [];
                        index[key].push(scaleType);
                    }
                }
            }
        }
    }
    return index;
}
function generateScaleTypeIndexKey(channel, fieldDefType, bin) {
    var key = channel + '_' + fieldDefType;
    return bin ? key + '_bin' : key;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NhbGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvc2NhbGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsdUNBQWdDO0FBRWhDLHFDQUE0RDtBQUU1RCxpREFBNkI7QUFDN0IsK0JBQXdDO0FBQ3hDLCtCQUFzRDtBQUd0RCxJQUFpQixTQUFTLENBc0J6QjtBQXRCRCxXQUFpQixTQUFTO0lBQ3hCLDRCQUE0QjtJQUNmLGdCQUFNLEdBQWEsUUFBUSxDQUFDO0lBQzVCLG9CQUFVLEdBQWlCLFlBQVksQ0FBQztJQUN4QyxhQUFHLEdBQVUsS0FBSyxDQUFDO0lBQ25CLGFBQUcsR0FBVSxLQUFLLENBQUM7SUFDbkIsY0FBSSxHQUFXLE1BQU0sQ0FBQztJQUNuQyxvQkFBb0I7SUFDUCxjQUFJLEdBQVcsTUFBTSxDQUFDO0lBQ3RCLGFBQUcsR0FBVSxLQUFLLENBQUM7SUFDaEMsYUFBYTtJQUNBLG9CQUFVLEdBQWlCLFlBQVksQ0FBQztJQUVyRCxnQ0FBZ0M7SUFDbkIsa0JBQVEsR0FBZSxVQUFVLENBQUM7SUFDbEMsa0JBQVEsR0FBZSxVQUFVLENBQUM7SUFDbEMsbUJBQVMsR0FBZ0IsV0FBVyxDQUFDO0lBRXJDLGlCQUFPLEdBQWMsU0FBUyxDQUFDO0lBQy9CLHFCQUFXLEdBQWtCLGFBQWEsQ0FBQztJQUMzQyxlQUFLLEdBQVksT0FBTyxDQUFDO0lBQ3pCLGNBQUksR0FBVyxNQUFNLENBQUM7QUFDckMsQ0FBQyxFQXRCZ0IsU0FBUyxHQUFULGlCQUFTLEtBQVQsaUJBQVMsUUFzQnpCO0FBVUQ7OztHQUdHO0FBQ0gsSUFBTSxvQkFBb0IsR0FHdEI7SUFDRixNQUFNLEVBQUUsU0FBUztJQUNqQixHQUFHLEVBQUUsU0FBUztJQUNkLEdBQUcsRUFBRSxTQUFTO0lBQ2QsSUFBSSxFQUFFLFNBQVM7SUFDZixZQUFZLEVBQUUsWUFBWTtJQUMxQixJQUFJLEVBQUUsTUFBTTtJQUNaLEdBQUcsRUFBRSxNQUFNO0lBQ1gsVUFBVSxF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QTNCLElBQU0sT0FBTyxpQkFBQTtRQUNoQixLQUEyQixVQUFnQixFQUFoQixLQUFBLFdBQUksQ0FBQyxpQkFBVSxDQUFDLEVBQWhCLGNBQWdCLEVBQWhCLElBQWdCLEVBQUU7WUFBeEMsSUFBTSxZQUFZLFNBQUE7WUFDckIsS0FBd0IsVUFBVyxFQUFYLGdCQUFBLG1CQUFXLEVBQVgseUJBQVcsRUFBWCxJQUFXLEVBQUU7Z0JBQWhDLElBQU0sU0FBUyxvQkFBQTtnQkFDbEIsS0FBa0IsVUFBYSxFQUFiLE1BQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFiLGNBQWEsRUFBYixJQUFhLEVBQUU7b0JBQTVCLElBQU0sR0FBRyxTQUFBO29CQUNaLElBQU0sR0FBRyxHQUFHLHlCQUF5QixDQUFDLE9BQU8sRUFBRSxZQUFZLEVBQUUsR0FBRyxDQUFDLENBQUM7b0JBQ2xFLElBQUksdUJBQXVCLENBQUMsT0FBTyxFQUFFLFNBQVMsQ0FBQyxJQUFJLHdCQUF3QixDQUFDLFNBQVMsRUFBRSxZQUFZLEVBQUUsR0FBRyxDQUFDLEVBQUU7d0JBQ3pHLEtBQUssQ0FBQyxHQUFHLENBQUMsR0FBRyxLQUFLLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDO3dCQUM5QixLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO3FCQUM1QjtpQkFDRjthQUNGO1NBQ0Y7S0FDRjtJQUNELE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQUVELG1DQUFtQyxPQUFnQixFQUFFLFlBQWtCLEVBQUUsR0FBWTtJQUNuRixJQUFNLEdBQUcsR0FBRyxPQUFPLEdBQUcsR0FBRyxHQUFHLFlBQVksQ0FBQztJQUN6QyxPQUFPLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDO0FBQ2xDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge3RvU2V0fSBmcm9tICd2ZWdhLXV0aWwnO1xuaW1wb3J0IHtCaW5QYXJhbXN9IGZyb20gJy4vYmluJztcbmltcG9ydCB7Q2hhbm5lbCwgQ0hBTk5FTFMsIGlzQ29sb3JDaGFubmVsfSBmcm9tICcuL2NoYW5uZWwnO1xuaW1wb3J0IHtEYXRlVGltZX0gZnJvbSAnLi9kYXRldGltZSc7XG5pbXBvcnQgKiBhcyBsb2cgZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtUeXBlLCBUWVBFX0lOREVYfSBmcm9tICcuL3R5cGUnO1xuaW1wb3J0IHtjb250YWlucywgRmxhZywgZmxhZ0tleXMsIGtleXN9IGZyb20gJy4vdXRpbCc7XG5pbXBvcnQge1NjYWxlSW50ZXJwb2xhdGUsIFNjYWxlSW50ZXJwb2xhdGVQYXJhbXN9IGZyb20gJy4vdmVnYS5zY2hlbWEnO1xuXG5leHBvcnQgbmFtZXNwYWNlIFNjYWxlVHlwZSB7XG4gIC8vIENvbnRpbnVvdXMgLSBRdWFudGl0YXRpdmVcbiAgZXhwb3J0IGNvbnN0IExJTkVBUjogJ2xpbmVhcicgPSAnbGluZWFyJztcbiAgZXhwb3J0IGNvbnN0IEJJTl9MSU5FQVI6ICdiaW4tbGluZWFyJyA9ICdiaW4tbGluZWFyJztcbiAgZXhwb3J0IGNvbnN0IExPRzogJ2xvZycgPSAnbG9nJztcbiAgZXhwb3J0IGNvbnN0IFBPVzogJ3BvdycgPSAncG93JztcbiAgZXhwb3J0IGNvbnN0IFNRUlQ6ICdzcXJ0JyA9ICdzcXJ0JztcbiAgLy8gQ29udGludW91cyAtIFRpbWVcbiAgZXhwb3J0IGNvbnN0IFRJTUU6ICd0aW1lJyA9ICd0aW1lJztcbiAgZXhwb3J0IGNvbnN0IFVUQzogJ3V0YycgPSAndXRjJztcbiAgLy8gc2VxdWVudGlhbFxuICBleHBvcnQgY29uc3QgU0VRVUVOVElBTDogJ3NlcXVlbnRpYWwnID0gJ3NlcXVlbnRpYWwnO1xuXG4gIC8vIFF1YW50aWxlLCBRdWFudGl6ZSwgdGhyZXNob2xkXG4gIGV4cG9ydCBjb25zdCBRVUFOVElMRTogJ3F1YW50aWxlJyA9ICdxdWFudGlsZSc7XG4gIGV4cG9ydCBjb25zdCBRVUFOVElaRTogJ3F1YW50aXplJyA9ICdxdWFudGl6ZSc7XG4gIGV4cG9ydCBjb25zdCBUSFJFU0hPTEQ6ICd0aHJlc2hvbGQnID0gJ3RocmVzaG9sZCc7XG5cbiAgZXhwb3J0IGNvbnN0IE9SRElOQUw6ICdvcmRpbmFsJyA9ICdvcmRpbmFsJztcbiAgZXhwb3J0IGNvbnN0IEJJTl9PUkRJTkFMOiAnYmluLW9yZGluYWwnID0gJ2Jpbi1vcmRpbmFsJztcbiAgZXhwb3J0IGNvbnN0IFBPSU5UOiAncG9pbnQnID0gJ3BvaW50JztcbiAgZXhwb3J0IGNvbnN0IEJBTkQ6ICdiYW5kJyA9ICdiYW5kJztcbn1cblxuZXhwb3J0IHR5cGUgU2NhbGVUeXBlID0gdHlwZW9mIFNjYWxlVHlwZS5MSU5FQVIgfCB0eXBlb2YgU2NhbGVUeXBlLkJJTl9MSU5FQVIgfFxuICB0eXBlb2YgU2NhbGVUeXBlLkxPRyB8IHR5cGVvZiBTY2FsZVR5cGUuUE9XIHwgdHlwZW9mIFNjYWxlVHlwZS5TUVJUIHxcbiAgdHlwZW9mIFNjYWxlVHlwZS5USU1FIHwgdHlwZW9mIFNjYWxlVHlwZS5VVEMgfFxuICAvLyBUT0RPOiBhZGQgJ3F1YW50aXplJywgJ3F1YW50aWxlJywgJ3RocmVzaG9sZCcgYmFjayB3aGVuIHdlIHJlYWxseSBzdXBwb3J0IHRoZW1cbiAgdHlwZW9mIFNjYWxlVHlwZS5TRVFVRU5USUFMIHwgLy8gdHlwZW9mIFNjYWxlVHlwZS5RVUFOVElMRSB8IHR5cGVvZiBTY2FsZVR5cGUuUVVBTlRJWkUgfCB0eXBlb2YgU2NhbGVUeXBlLlRIUkVTSE9MRCB8XG4gIHR5cGVvZiBTY2FsZVR5cGUuT1JESU5BTCB8IHR5cGVvZiBTY2FsZVR5cGUuQklOX09SRElOQUwgfCB0eXBlb2YgU2NhbGVUeXBlLlBPSU5UIHwgdHlwZW9mIFNjYWxlVHlwZS5CQU5EO1xuXG5cbi8qKlxuICogSW5kZXggZm9yIHNjYWxlIGNhdGVnb3JpZXMgLS0gb25seSBzY2FsZSBvZiB0aGUgc2FtZSBjYXRlZ29yaWVzIGNhbiBiZSBtZXJnZWQgdG9nZXRoZXIuXG4gKiBDdXJyZW50IGltcGxlbWVudGF0aW9uIGlzIHRyeWluZyB0byBiZSBjb25zZXJ2YXRpdmUgYW5kIGF2b2lkIG1lcmdpbmcgc2NhbGUgdHlwZSB0aGF0IG1pZ2h0IG5vdCB3b3JrIHRvZ2V0aGVyXG4gKi9cbmNvbnN0IFNDQUxFX0NBVEVHT1JZX0lOREVYOiB7XG4gIC8vIFVzaW5nIE1hcHBlZCBUeXBlIHRvIGRlY2xhcmUgdHlwZSAoaHR0cHM6Ly93d3cudHlwZXNjcmlwdGxhbmcub3JnL2RvY3MvaGFuZGJvb2svYWR2YW5jZWQtdHlwZXMuaHRtbCNtYXBwZWQtdHlwZXMpXG4gIFtrIGluIFNjYWxlVHlwZV06IFNjYWxlVHlwZSB8ICdudW1lcmljJyB8ICdvcmRpbmFsLXBvc2l0aW9uJ1xufSA9IHtcbiAgbGluZWFyOiAnbnVtZXJpYycsXG4gIGxvZzogJ251bWVyaWMnLFxuICBwb3c6ICdudW1lcmljJyxcbiAgc3FydDogJ251bWVyaWMnLFxuICAnYmluLWxpbmVhcic6ICdiaW4tbGluZWFyJywgLy8gVE9ETzogc2hvdWxkIGJpbi1saW5lYXIgc3VwcG9ydCBtZXJnaW5nIHdpdGggb3RoZXJcbiAgdGltZTogJ3RpbWUnLFxuICB1dGM6ICd0aW1lJyxcbiAgc2VxdWVudGlhbDogJ3NlcXVlbnRpYWwnLFxuICBvcmRpbmFsOiAnb3JkaW5hbCcsXG4gICdiaW4tb3JkaW5hbCc6ICdiaW4tb3JkaW5hbCcsIC8vIFRPRE86IHNob3VsZCBiaW4tb3JkaW5hbCBzdXBwb3J0IG1lcmdpbmcgd2l0aCBvdGhlclxuICBwb2ludDogJ29yZGluYWwtcG9zaXRpb24nLFxuICBiYW5kOiAnb3JkaW5hbC1wb3NpdGlvbidcbn07XG5cbmV4cG9ydCBjb25zdCBTQ0FMRV9UWVBFUyA9IGtleXMoU0NBTEVfQ0FURUdPUllfSU5ERVgpIGFzIFNjYWxlVHlwZVtdO1xuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHR3byBnaXZlbiBzY2FsZSB0eXBlcyBjYW4gYmUgbWVyZ2VkIHRvZ2V0aGVyLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc2NhbGVDb21wYXRpYmxlKHNjYWxlVHlwZTE6IFNjYWxlVHlwZSwgc2NhbGVUeXBlMjogU2NhbGVUeXBlKSB7XG4gIGNvbnN0IHNjYWxlQ2F0ZWdvcnkxID0gU0NBTEVfQ0FURUdPUllfSU5ERVhbc2NhbGVUeXBlMV07XG4gIGNvbnN0IHNjYWxlQ2F0ZWdvcnkyID0gU0NBTEVfQ0FURUdPUllfSU5ERVhbc2NhbGVUeXBlMl07XG4gIHJldHVybiBzY2FsZUNhdGVnb3J5MSA9PT0gc2NhbGVDYXRlZ29yeTIgfHxcbiAgICAoc2NhbGVDYXRlZ29yeTEgPT09ICdvcmRpbmFsLXBvc2l0aW9uJyAmJiBzY2FsZUNhdGVnb3J5MiA9PT0gJ3RpbWUnKSB8fFxuICAgIChzY2FsZUNhdGVnb3J5MiA9PT0gJ29yZGluYWwtcG9zaXRpb24nICYmIHNjYWxlQ2F0ZWdvcnkxID09PSAndGltZScpO1xufVxuXG4vKipcbiAqIEluZGV4IGZvciBzY2FsZSBwcmVjZWRlbmNlIC0tIGhpZ2ggc2NvcmUgPSBoaWdoZXIgcHJpb3JpdHkgZm9yIG1lcmdpbmcuXG4gKi9cbmNvbnN0IFNDQUxFX1BSRUNFREVOQ0VfSU5ERVg6IHtcbiAgLy8gVXNpbmcgTWFwcGVkIFR5cGUgdG8gZGVjbGFyZSB0eXBlIChodHRwczovL3d3dy50eXBlc2NyaXB0bGFuZy5vcmcvZG9jcy9oYW5kYm9vay9hZHZhbmNlZC10eXBlcy5odG1sI21hcHBlZC10eXBlcylcbiAgW2sgaW4gU2NhbGVUeXBlXTogbnVtYmVyXG59ID0ge1xuICAvLyBudW1lcmljXG4gIGxpbmVhcjogMCxcbiAgbG9nOiAxLFxuICBwb3c6IDEsXG4gIHNxcnQ6IDEsXG4gIC8vIHRpbWVcbiAgdGltZTogMCxcbiAgdXRjOiAwLFxuICAvLyBvcmRpbmFsLXBvc2l0aW9uIC0tIHRoZXNlIGhhdmUgaGlnaGVyIHByZWNlZGVuY2UgdGhhbiBjb250aW51b3VzIHNjYWxlcyBhcyB0aGV5IHN1cHBvcnQgbW9yZSB0eXBlcyBvZiBkYXRhXG4gIHBvaW50OiAxMCxcbiAgYmFuZDogMTEsIC8vIGJhbmQgaGFzIGhpZ2hlciBwcmVjZWRlbmNlIGFzIGl0IGlzIGJldHRlciBmb3IgaW50ZXJhY3Rpb25cbiAgLy8gbm9uIGdyb3VwZWQgdHlwZXNcbiAgJ2Jpbi1saW5lYXInOiAwLFxuICBzZXF1ZW50aWFsOiAwLFxuICBvcmRpbmFsOiAwLFxuICAnYmluLW9yZGluYWwnOiAwLFxufTtcblxuLyoqXG4gKiBSZXR1cm4gc2NhbGUgY2F0ZWdvcmllcyAtLSBvbmx5IHNjYWxlIG9mIHRoZSBzYW1lIGNhdGVnb3JpZXMgY2FuIGJlIG1lcmdlZCB0b2dldGhlci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNjYWxlVHlwZVByZWNlZGVuY2Uoc2NhbGVUeXBlOiBTY2FsZVR5cGUpOiBudW1iZXIge1xuICByZXR1cm4gU0NBTEVfUFJFQ0VERU5DRV9JTkRFWFtzY2FsZVR5cGVdO1xufVxuXG5leHBvcnQgY29uc3QgQ09OVElOVU9VU19UT19DT05USU5VT1VTX1NDQUxFUzogU2NhbGVUeXBlW10gPSBbJ2xpbmVhcicsICdiaW4tbGluZWFyJywgJ2xvZycsICdwb3cnLCAnc3FydCcsICd0aW1lJywgJ3V0YyddO1xuY29uc3QgQ09OVElOVU9VU19UT19DT05USU5VT1VTX0lOREVYID0gdG9TZXQoQ09OVElOVU9VU19UT19DT05USU5VT1VTX1NDQUxFUyk7XG5cbmV4cG9ydCBjb25zdCBDT05USU5VT1VTX0RPTUFJTl9TQ0FMRVM6IFNjYWxlVHlwZVtdID0gQ09OVElOVU9VU19UT19DT05USU5VT1VTX1NDQUxFUy5jb25jYXQoWydzZXF1ZW50aWFsJyAvKiBUT0RPIGFkZCAncXVhbnRpbGUnLCAncXVhbnRpemUnLCAndGhyZXNob2xkJyovXSk7XG5jb25zdCBDT05USU5VT1VTX0RPTUFJTl9JTkRFWCA9IHRvU2V0KENPTlRJTlVPVVNfRE9NQUlOX1NDQUxFUyk7XG5cbmV4cG9ydCBjb25zdCBESVNDUkVURV9ET01BSU5fU0NBTEVTOiBTY2FsZVR5cGVbXSA9IFsnb3JkaW5hbCcsICdiaW4tb3JkaW5hbCcsICdwb2ludCcsICdiYW5kJ107XG5jb25zdCBESVNDUkVURV9ET01BSU5fSU5ERVggPSB0b1NldChESVNDUkVURV9ET01BSU5fU0NBTEVTKTtcblxuY29uc3QgQklOX1NDQUxFU19JTkRFWCA9IHRvU2V0KFsnYmluLWxpbmVhcicsICdiaW4tb3JkaW5hbCddKTtcblxuZXhwb3J0IGNvbnN0IFRJTUVfU0NBTEVfVFlQRVM6IFNjYWxlVHlwZVtdID0gWyd0aW1lJywgJ3V0YyddO1xuXG5leHBvcnQgZnVuY3Rpb24gaGFzRGlzY3JldGVEb21haW4odHlwZTogU2NhbGVUeXBlKTogdHlwZSBpcyAnb3JkaW5hbCcgfCAnYmluLW9yZGluYWwnIHwgJ3BvaW50JyB8ICdiYW5kJyB7XG4gIHJldHVybiB0eXBlIGluIERJU0NSRVRFX0RPTUFJTl9JTkRFWDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQmluU2NhbGUodHlwZTogU2NhbGVUeXBlKTogdHlwZSBpcyAnYmluLWxpbmVhcicgfCAnYmluLW9yZGluYWwnIHtcbiAgcmV0dXJuIHR5cGUgaW4gQklOX1NDQUxFU19JTkRFWDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc0NvbnRpbnVvdXNEb21haW4odHlwZTogU2NhbGVUeXBlKTpcbiAgdHlwZSBpcyAnbGluZWFyJyB8ICdsb2cnIHwgJ3BvdycgfCAnc3FydCcgfCAndGltZScgfCAndXRjJ3xcbiAgICAgICAgICAnc2VxdWVudGlhbCcgLyogVE9ETyBhZGQgfCAncXVhbnRpbGUnIHwgJ3F1YW50aXplJyB8ICd0aHJlc2hvbGQnICovIHtcbiAgcmV0dXJuIHR5cGUgaW4gQ09OVElOVU9VU19ET01BSU5fSU5ERVg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NvbnRpbnVvdXNUb0NvbnRpbnVvdXModHlwZTogU2NhbGVUeXBlKTogdHlwZSBpcyAnbGluZWFyJyB8ICdiaW4tbGluZWFyJyB8ICdsb2cnIHwgJ3BvdycgfCAnc3FydCcgfCAndGltZScgfCAndXRjJyB7XG4gIHJldHVybiB0eXBlIGluIENPTlRJTlVPVVNfVE9fQ09OVElOVU9VU19JTkRFWDtcbn1cblxuZXhwb3J0IHR5cGUgTmljZVRpbWUgPSAnc2Vjb25kJyB8ICdtaW51dGUnIHwgJ2hvdXInIHwgJ2RheScgfCAnd2VlaycgfCAnbW9udGgnIHwgJ3llYXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNjYWxlQ29uZmlnIHtcbiAgLyoqXG4gICAqIElmIHRydWUsIHJvdW5kcyBudW1lcmljIG91dHB1dCB2YWx1ZXMgdG8gaW50ZWdlcnMuXG4gICAqIFRoaXMgY2FuIGJlIGhlbHBmdWwgZm9yIHNuYXBwaW5nIHRvIHRoZSBwaXhlbCBncmlkLlxuICAgKiAoT25seSBhdmFpbGFibGUgZm9yIGB4YCwgYHlgLCBhbmQgYHNpemVgIHNjYWxlcy4pXG4gICAqL1xuICByb3VuZD86IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIElmIHRydWUsIHZhbHVlcyB0aGF0IGV4Y2VlZCB0aGUgZGF0YSBkb21haW4gYXJlIGNsYW1wZWQgdG8gZWl0aGVyIHRoZSBtaW5pbXVtIG9yIG1heGltdW0gcmFuZ2UgdmFsdWVcbiAgICovXG4gIGNsYW1wPzogYm9vbGVhbjtcbiAgLyoqXG4gICAqICBEZWZhdWx0IHJhbmdlIHN0ZXAgZm9yIGB4YCBiYW5kIGFuZCBwb2ludCBzY2FsZXMgb2YgdGV4dCBtYXJrcy5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGA5MGBcbiAgICpcbiAgICogIEBtaW5pbXVtIDBcbiAgICovXG4gIHRleHRYUmFuZ2VTdGVwPzogbnVtYmVyOyAvLyBGSVhNRTogY29uc2lkZXIgaWYgd2Ugd2lsbCByZW5hbWUgdGhpcyBcInRhYmxlQ29sdW1uV2lkdGhcIlxuXG4gIC8qKlxuICAgKiBEZWZhdWx0IHJhbmdlIHN0ZXAgZm9yIGJhbmQgYW5kIHBvaW50IHNjYWxlcyBvZiAoMSkgdGhlIGB5YCBjaGFubmVsXG4gICAqIGFuZCAoMikgdGhlIGB4YCBjaGFubmVsIHdoZW4gdGhlIG1hcmsgaXMgbm90IGB0ZXh0YC5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGAyMWBcbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKi9cbiAgcmFuZ2VTdGVwPzogbnVtYmVyIHwgbnVsbDtcblxuICAvKipcbiAgICogRGVmYXVsdCBpbm5lciBwYWRkaW5nIGZvciBgeGAgYW5kIGB5YCBiYW5kLW9yZGluYWwgc2NhbGVzLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDAuMWBcbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKiBAbWF4aW11bSAxXG4gICAqL1xuICBiYW5kUGFkZGluZ0lubmVyPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG91dGVyIHBhZGRpbmcgZm9yIGB4YCBhbmQgYHlgIGJhbmQtb3JkaW5hbCBzY2FsZXMuXG4gICAqIElmIG5vdCBzcGVjaWZpZWQsIGJ5IGRlZmF1bHQsIGJhbmQgc2NhbGUncyBwYWRkaW5nT3V0ZXIgaXMgcGFkZGluZ0lubmVyLzIuXG4gICAqIEBtaW5pbXVtIDBcbiAgICogQG1heGltdW0gMVxuICAgKi9cbiAgYmFuZFBhZGRpbmdPdXRlcj86IG51bWJlcjtcblxuICAvKipcbiAgICogRGVmYXVsdCBwYWRkaW5nIGZvciBjb250aW51b3VzIHNjYWxlcy5cbiAgICpcbiAgICogX19EZWZhdWx0Ol9fIGA1YCBmb3IgY29udGludW91cyB4LXNjYWxlIG9mIGEgdmVydGljYWwgYmFyIGFuZCBjb250aW51b3VzIHktc2NhbGUgb2YgYSBob3Jpem9udGFsIGJhci47IGAwYCBvdGhlcndpc2UuXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIGNvbnRpbnVvdXNQYWRkaW5nPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG91dGVyIHBhZGRpbmcgZm9yIGB4YCBhbmQgYHlgIHBvaW50LW9yZGluYWwgc2NhbGVzLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDAuNWBcbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKiBAbWF4aW11bSAxXG4gICAqL1xuICBwb2ludFBhZGRpbmc/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFVzZSB0aGUgc291cmNlIGRhdGEgcmFuZ2UgYmVmb3JlIGFnZ3JlZ2F0aW9uIGFzIHNjYWxlIGRvbWFpbiBpbnN0ZWFkIG9mIGFnZ3JlZ2F0ZWQgZGF0YSBmb3IgYWdncmVnYXRlIGF4aXMuXG4gICAqXG4gICAqIFRoaXMgaXMgZXF1aXZhbGVudCB0byBzZXR0aW5nIGBkb21haW5gIHRvIGBcInVuYWdncmVnYXRlXCJgIGZvciBhZ2dyZWdhdGVkIF9xdWFudGl0YXRpdmVfIGZpZWxkcyBieSBkZWZhdWx0LlxuICAgKlxuICAgKiBUaGlzIHByb3BlcnR5IG9ubHkgd29ya3Mgd2l0aCBhZ2dyZWdhdGUgZnVuY3Rpb25zIHRoYXQgcHJvZHVjZSB2YWx1ZXMgd2l0aGluIHRoZSByYXcgZGF0YSBkb21haW4gKGBcIm1lYW5cImAsIGBcImF2ZXJhZ2VcImAsIGBcIm1lZGlhblwiYCwgYFwicTFcImAsIGBcInEzXCJgLCBgXCJtaW5cImAsIGBcIm1heFwiYCkuIEZvciBvdGhlciBhZ2dyZWdhdGlvbnMgdGhhdCBwcm9kdWNlIHZhbHVlcyBvdXRzaWRlIG9mIHRoZSByYXcgZGF0YSBkb21haW4gKGUuZy4gYFwiY291bnRcImAsIGBcInN1bVwiYCksIHRoaXMgcHJvcGVydHkgaXMgaWdub3JlZC5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBmYWxzZWBcbiAgICovXG4gIHVzZVVuYWdncmVnYXRlZERvbWFpbj86IGJvb2xlYW47XG5cbiAgLy8gbmljZSBzaG91bGQgZGVwZW5kcyBvbiB0eXBlIChxdWFudGl0YXRpdmUgb3IgdGVtcG9yYWwpLCBzb1xuICAvLyBsZXQncyBub3QgbWFrZSBhIGNvbmZpZy5cblxuICAvLyBDb25maWdzIGZvciBSYW5nZVxuXG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCBtYXggdmFsdWUgZm9yIG1hcHBpbmcgcXVhbnRpdGF0aXZlIGZpZWxkcyB0byBiYXIncyBzaXplL2JhbmRTaXplLlxuICAgKlxuICAgKiBJZiB1bmRlZmluZWQgKGRlZmF1bHQpLCB3ZSB3aWxsIHVzZSB0aGUgc2NhbGUncyBgcmFuZ2VTdGVwYCAtIDEuXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIG1heEJhbmRTaXplPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCBtaW4gdmFsdWUgZm9yIG1hcHBpbmcgcXVhbnRpdGF0aXZlIGZpZWxkcyB0byBiYXIgYW5kIHRpY2sncyBzaXplL2JhbmRTaXplIHNjYWxlIHdpdGggemVybz1mYWxzZS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGAyYFxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBtaW5CYW5kU2l6ZT86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIGRlZmF1bHQgbWF4IHZhbHVlIGZvciBtYXBwaW5nIHF1YW50aXRhdGl2ZSBmaWVsZHMgdG8gdGV4dCdzIHNpemUvZm9udFNpemUuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgNDBgXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIG1heEZvbnRTaXplPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCBtaW4gdmFsdWUgZm9yIG1hcHBpbmcgcXVhbnRpdGF0aXZlIGZpZWxkcyB0byB0aWNrJ3Mgc2l6ZS9mb250U2l6ZSBzY2FsZSB3aXRoIHplcm89ZmFsc2VcbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGA4YFxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBtaW5Gb250U2l6ZT86IG51bWJlcjtcblxuICAvKipcbiAgICogRGVmYXVsdCBtaW5pbXVtIG9wYWNpdHkgZm9yIG1hcHBpbmcgYSBmaWVsZCB0byBvcGFjaXR5LlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDAuM2BcbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKiBAbWF4aW11bSAxXG4gICAqL1xuICBtaW5PcGFjaXR5PzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG1heCBvcGFjaXR5IGZvciBtYXBwaW5nIGEgZmllbGQgdG8gb3BhY2l0eS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGAwLjhgXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICogQG1heGltdW0gMVxuICAgKi9cbiAgbWF4T3BhY2l0eT86IG51bWJlcjtcblxuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG1pbmltdW0gdmFsdWUgZm9yIHBvaW50IHNpemUgc2NhbGUgd2l0aCB6ZXJvPWZhbHNlLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDlgXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIG1pblNpemU/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIERlZmF1bHQgbWF4IHZhbHVlIGZvciBwb2ludCBzaXplIHNjYWxlLlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBtYXhTaXplPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG1pbmltdW0gc3Ryb2tlV2lkdGggZm9yIHRoZSBzY2FsZSBvZiBzdHJva2VXaWR0aCBmb3IgcnVsZSBhbmQgbGluZSBtYXJrcyBhbmQgb2Ygc2l6ZSBmb3IgdHJhaWwgbWFya3Mgd2l0aCB6ZXJvPWZhbHNlLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDFgXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIG1pblN0cm9rZVdpZHRoPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG1heCBzdHJva2VXaWR0aCBmb3IgdGhlIHNjYWxlIG9mIHN0cm9rZVdpZHRoIGZvciBydWxlIGFuZCBsaW5lIG1hcmtzIGFuZCBvZiBzaXplIGZvciB0cmFpbCBtYXJrcy5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGA0YFxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBtYXhTdHJva2VXaWR0aD86IG51bWJlcjtcbn1cblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRTY2FsZUNvbmZpZyA9IHtcbiAgdGV4dFhSYW5nZVN0ZXA6IDkwLFxuICByYW5nZVN0ZXA6IDIxLFxuICBwb2ludFBhZGRpbmc6IDAuNSxcbiAgYmFuZFBhZGRpbmdJbm5lcjogMC4xLFxuICBmYWNldFNwYWNpbmc6IDE2LFxuXG4gIG1pbkJhbmRTaXplOiAyLFxuXG4gIG1pbkZvbnRTaXplOiA4LFxuICBtYXhGb250U2l6ZTogNDAsXG5cbiAgbWluT3BhY2l0eTogMC4zLFxuICBtYXhPcGFjaXR5OiAwLjgsXG5cbiAgLy8gRklYTUU6IHJldmlzZSBpZiB0aGVzZSAqY2FuKiBiZWNvbWUgcmF0aW9zIG9mIHJhbmdlU3RlcFxuICBtaW5TaXplOiA5LCAvLyBQb2ludCBzaXplIGlzIGFyZWEuIEZvciBzcXVhcmUgcG9pbnQsIDkgPSAzIHBpeGVsIF4gMiwgbm90IHRvbyBzbWFsbCFcblxuICBtaW5TdHJva2VXaWR0aDogMSxcbiAgbWF4U3Ryb2tlV2lkdGg6IDRcbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2NoZW1lUGFyYW1zIHtcbiAgLyoqXG4gICAqIEEgY29sb3Igc2NoZW1lIG5hbWUgZm9yIHNlcXVlbnRpYWwvb3JkaW5hbCBzY2FsZXMgKGUuZy4sIGBcImNhdGVnb3J5MTBcImAgb3IgYFwidmlyaWRpc1wiYCkuXG4gICAqXG4gICAqIEZvciB0aGUgZnVsbCBsaXN0IG9mIHN1cHBvcnRlZCBzY2hlbWVzLCBwbGVhc2UgcmVmZXIgdG8gdGhlIFtWZWdhIFNjaGVtZV0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhL2RvY3Mvc2NoZW1lcy8jcmVmZXJlbmNlKSByZWZlcmVuY2UuXG4gICAqL1xuICBuYW1lOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEZvciBzZXF1ZW50aWFsIGFuZCBkaXZlcmdpbmcgc2NoZW1lcyBvbmx5LCBkZXRlcm1pbmVzIHRoZSBleHRlbnQgb2YgdGhlIGNvbG9yIHJhbmdlIHRvIHVzZS4gRm9yIGV4YW1wbGUgYFswLjIsIDFdYCB3aWxsIHJlc2NhbGUgdGhlIGNvbG9yIHNjaGVtZSBzdWNoIHRoYXQgY29sb3IgdmFsdWVzIGluIHRoZSByYW5nZSBfWzAsIDAuMilfIGFyZSBleGNsdWRlZCBmcm9tIHRoZSBzY2hlbWUuXG4gICAqL1xuICBleHRlbnQ/OiBudW1iZXJbXTtcblxuICAvKipcbiAgICogVGhlIG51bWJlciBvZiBjb2xvcnMgdG8gdXNlIGluIHRoZSBzY2hlbWUuIFRoaXMgY2FuIGJlIHVzZWZ1bCBmb3Igc2NhbGUgdHlwZXMgc3VjaCBhcyBgXCJxdWFudGl6ZVwiYCwgd2hpY2ggdXNlIHRoZSBsZW5ndGggb2YgdGhlIHNjYWxlIHJhbmdlIHRvIGRldGVybWluZSB0aGUgbnVtYmVyIG9mIGRpc2NyZXRlIGJpbnMgZm9yIHRoZSBzY2FsZSBkb21haW4uXG4gICAqXG4gICAqIEBoaWRlXG4gICAqL1xuICBjb3VudD86IG51bWJlcjtcbn1cblxuZXhwb3J0IHR5cGUgU2VsZWN0aW9uRG9tYWluID0ge1xuICAvKipcbiAgICogVGhlIG5hbWUgb2YgYSBzZWxlY3Rpb24uXG4gICAqL1xuICBzZWxlY3Rpb246IHN0cmluZyxcbiAgLyoqXG4gICAqIFRoZSBmaWVsZCBuYW1lIHRvIGV4dHJhY3Qgc2VsZWN0ZWQgdmFsdWVzIGZvciwgd2hlbiBhIHNlbGVjdGlvbiBpcyBbcHJvamVjdGVkXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3Byb2plY3QuaHRtbClcbiAgICogb3ZlciBtdWx0aXBsZSBmaWVsZHMgb3IgZW5jb2RpbmdzLlxuICAgKi9cbiAgZmllbGQ/OiBzdHJpbmdcbn0gfCB7XG4gIC8qKlxuICAgKiBUaGUgbmFtZSBvZiBhIHNlbGVjdGlvbi5cbiAgICovXG4gIHNlbGVjdGlvbjogc3RyaW5nLFxuICAvKipcbiAgICogVGhlIGVuY29kaW5nIGNoYW5uZWwgdG8gZXh0cmFjdCBzZWxlY3RlZCB2YWx1ZXMgZm9yLCB3aGVuIGEgc2VsZWN0aW9uIGlzIFtwcm9qZWN0ZWRdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvcHJvamVjdC5odG1sKVxuICAgKiBvdmVyIG11bHRpcGxlIGZpZWxkcyBvciBlbmNvZGluZ3MuXG4gICAqL1xuICBlbmNvZGluZz86IHN0cmluZ1xufTtcblxuZXhwb3J0IHR5cGUgRG9tYWluID0gbnVtYmVyW10gfCBzdHJpbmdbXSB8IGJvb2xlYW5bXSB8IERhdGVUaW1lW10gfCAndW5hZ2dyZWdhdGVkJyB8IFNlbGVjdGlvbkRvbWFpbjtcbmV4cG9ydCB0eXBlIFNjaGVtZSA9IHN0cmluZyB8IFNjaGVtZVBhcmFtcztcblxuZXhwb3J0IHR5cGUgUmFuZ2UgPSBudW1iZXJbXSB8IHN0cmluZ1tdIHwgc3RyaW5nO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNFeHRlbmRlZFNjaGVtZShzY2hlbWU6IHN0cmluZyB8IFNjaGVtZVBhcmFtcyk6IHNjaGVtZSBpcyBTY2hlbWVQYXJhbXMge1xuICByZXR1cm4gc2NoZW1lICYmICEhc2NoZW1lWyduYW1lJ107XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1NlbGVjdGlvbkRvbWFpbihkb21haW46IERvbWFpbik6IGRvbWFpbiBpcyBTZWxlY3Rpb25Eb21haW4ge1xuICByZXR1cm4gZG9tYWluICYmIGRvbWFpblsnc2VsZWN0aW9uJ107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2NhbGUge1xuICAvKipcbiAgICogVGhlIHR5cGUgb2Ygc2NhbGUuICBWZWdhLUxpdGUgc3VwcG9ydHMgdGhlIGZvbGxvd2luZyBjYXRlZ29yaWVzIG9mIHNjYWxlIHR5cGVzOlxuICAgKlxuICAgKiAxKSBbKipDb250aW51b3VzIFNjYWxlcyoqXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjY29udGludW91cykgLS0gbWFwcGluZyBjb250aW51b3VzIGRvbWFpbnMgdG8gY29udGludW91cyBvdXRwdXQgcmFuZ2VzIChbYFwibGluZWFyXCJgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjbGluZWFyKSwgW2BcInBvd1wiYF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI3BvdyksIFtgXCJzcXJ0XCJgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjc3FydCksIFtgXCJsb2dcImBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNsb2cpLCBbYFwidGltZVwiYF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI3RpbWUpLCBbYFwidXRjXCJgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjdXRjKSwgW2BcInNlcXVlbnRpYWxcImBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNzZXF1ZW50aWFsKSkuXG4gICAqXG4gICAqIDIpIFsqKkRpc2NyZXRlIFNjYWxlcyoqXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjZGlzY3JldGUpIC0tIG1hcHBpbmcgZGlzY3JldGUgZG9tYWlucyB0byBkaXNjcmV0ZSAoW2BcIm9yZGluYWxcImBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNvcmRpbmFsKSkgb3IgY29udGludW91cyAoW2BcImJhbmRcImBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNiYW5kKSBhbmQgW2BcInBvaW50XCJgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjcG9pbnQpKSBvdXRwdXQgcmFuZ2VzLlxuICAgKlxuICAgKiAzKSBbKipEaXNjcmV0aXppbmcgU2NhbGVzKipdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNkaXNjcmV0aXppbmcpIC0tIG1hcHBpbmcgY29udGludW91cyBkb21haW5zIHRvIGRpc2NyZXRlIG91dHB1dCByYW5nZXMgKFtgXCJiaW4tbGluZWFyXCJgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjYmluLWxpbmVhcikgYW5kIFtgXCJiaW4tb3JkaW5hbFwiYF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI2Jpbi1vcmRpbmFsKSkuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBwbGVhc2Ugc2VlIHRoZSBbc2NhbGUgdHlwZSB0YWJsZV0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI3R5cGUpLlxuICAgKi9cbiAgdHlwZT86IFNjYWxlVHlwZTtcblxuICAvKipcbiAgICogQ3VzdG9taXplZCBkb21haW4gdmFsdWVzLlxuICAgKlxuICAgKiBGb3IgX3F1YW50aXRhdGl2ZV8gZmllbGRzLCBgZG9tYWluYCBjYW4gdGFrZSB0aGUgZm9ybSBvZiBhIHR3by1lbGVtZW50IGFycmF5IHdpdGggbWluaW11bSBhbmQgbWF4aW11bSB2YWx1ZXMuICBbUGllY2V3aXNlIHNjYWxlc10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI3BpZWNld2lzZSkgY2FuIGJlIGNyZWF0ZWQgYnkgcHJvdmlkaW5nIGEgYGRvbWFpbmAgd2l0aCBtb3JlIHRoYW4gdHdvIGVudHJpZXMuXG4gICAqIElmIHRoZSBpbnB1dCBmaWVsZCBpcyBhZ2dyZWdhdGVkLCBgZG9tYWluYCBjYW4gYWxzbyBiZSBhIHN0cmluZyB2YWx1ZSBgXCJ1bmFnZ3JlZ2F0ZWRcImAsIGluZGljYXRpbmcgdGhhdCB0aGUgZG9tYWluIHNob3VsZCBpbmNsdWRlIHRoZSByYXcgZGF0YSB2YWx1ZXMgcHJpb3IgdG8gdGhlIGFnZ3JlZ2F0aW9uLlxuICAgKlxuICAgKiBGb3IgX3RlbXBvcmFsXyBmaWVsZHMsIGBkb21haW5gIGNhbiBiZSBhIHR3by1lbGVtZW50IGFycmF5IG1pbmltdW0gYW5kIG1heGltdW0gdmFsdWVzLCBpbiB0aGUgZm9ybSBvZiBlaXRoZXIgdGltZXN0YW1wcyBvciB0aGUgW0RhdGVUaW1lIGRlZmluaXRpb24gb2JqZWN0c10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy90eXBlcy5odG1sI2RhdGV0aW1lKS5cbiAgICpcbiAgICogRm9yIF9vcmRpbmFsXyBhbmQgX25vbWluYWxfIGZpZWxkcywgYGRvbWFpbmAgY2FuIGJlIGFuIGFycmF5IHRoYXQgbGlzdHMgdmFsaWQgaW5wdXQgdmFsdWVzLlxuICAgKlxuICAgKiBUaGUgYHNlbGVjdGlvbmAgcHJvcGVydHkgY2FuIGJlIHVzZWQgdG8gW2ludGVyYWN0aXZlbHkgZGV0ZXJtaW5lXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NlbGVjdGlvbi5odG1sI3NjYWxlLWRvbWFpbnMpIHRoZSBzY2FsZSBkb21haW4uXG4gICAqL1xuICBkb21haW4/OiBudW1iZXJbXSB8IHN0cmluZ1tdIHwgYm9vbGVhbltdIHwgRGF0ZVRpbWVbXSB8ICd1bmFnZ3JlZ2F0ZWQnIHwgU2VsZWN0aW9uRG9tYWluO1xuXG5cbiAgLy8gSGlkZSBiZWNhdXNlIHdlIG1pZ2h0IG5vdCByZWFsbHkgbmVlZCB0aGlzLlxuICAvKipcbiAgICogSWYgdHJ1ZSwgcmV2ZXJzZXMgdGhlIG9yZGVyIG9mIHRoZSBzY2FsZSByYW5nZS5cbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBmYWxzZWAuXG4gICAqXG4gICAqIEBoaWRlXG4gICAqL1xuICByZXZlcnNlPzogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhlIHJhbmdlIG9mIHRoZSBzY2FsZS4gT25lIG9mOlxuICAgKlxuICAgKiAtIEEgc3RyaW5nIGluZGljYXRpbmcgYSBbcHJlLWRlZmluZWQgbmFtZWQgc2NhbGUgcmFuZ2VdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNyYW5nZS1jb25maWcpIChlLmcuLCBleGFtcGxlLCBgXCJzeW1ib2xcImAsIG9yIGBcImRpdmVyZ2luZ1wiYCkuXG4gICAqXG4gICAqIC0gRm9yIFtjb250aW51b3VzIHNjYWxlc10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI2NvbnRpbnVvdXMpLCB0d28tZWxlbWVudCBhcnJheSBpbmRpY2F0aW5nICBtaW5pbXVtIGFuZCBtYXhpbXVtIHZhbHVlcywgb3IgYW4gYXJyYXkgd2l0aCBtb3JlIHRoYW4gdHdvIGVudHJpZXMgZm9yIHNwZWNpZnlpbmcgYSBbcGllY2V3aXNlIHNjYWxlXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjcGllY2V3aXNlKS5cbiAgICpcbiAgICogLSBGb3IgW2Rpc2NyZXRlXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjZGlzY3JldGUpIGFuZCBbZGlzY3JldGl6aW5nXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjZGlzY3JldGl6aW5nKSBzY2FsZXMsIGFuIGFycmF5IG9mIGRlc2lyZWQgb3V0cHV0IHZhbHVlcy5cbiAgICpcbiAgICogX19Ob3RlczpfX1xuICAgKlxuICAgKiAxKSBGb3IgW3NlcXVlbnRpYWxdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNzZXF1ZW50aWFsKSwgW29yZGluYWxdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNvcmRpbmFsKSwgYW5kIGRpc2NyZXRpemluZyBjb2xvciBzY2FsZXMsIHlvdSBjYW4gYWxzbyBzcGVjaWZ5IGEgY29sb3IgW2BzY2hlbWVgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjc2NoZW1lKSBpbnN0ZWFkIG9mIGByYW5nZWAuXG4gICAqXG4gICAqIDIpIEFueSBkaXJlY3RseSBzcGVjaWZpZWQgYHJhbmdlYCBmb3IgYHhgIGFuZCBgeWAgY2hhbm5lbHMgd2lsbCBiZSBpZ25vcmVkLiBSYW5nZSBjYW4gYmUgY3VzdG9taXplZCB2aWEgdGhlIHZpZXcncyBjb3JyZXNwb25kaW5nIFtzaXplXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NpemUuaHRtbCkgKGB3aWR0aGAgYW5kIGBoZWlnaHRgKSBvciB2aWEgW3JhbmdlIHN0ZXBzIGFuZCBwYWRkaW5ncyBwcm9wZXJ0aWVzXSgjcmFuZ2Utc3RlcCkgZm9yIFtiYW5kXSgjYmFuZCkgYW5kIFtwb2ludF0oI3BvaW50KSBzY2FsZXMuXG4gICAqL1xuICByYW5nZT86IG51bWJlcltdIHwgc3RyaW5nW10gfCBzdHJpbmc7XG5cbiAgLy8gb3JkaW5hbFxuICAvKipcbiAgICogVGhlIGRpc3RhbmNlIGJldHdlZW4gdGhlIHN0YXJ0cyBvZiBhZGphY2VudCBiYW5kcyBvciBwb2ludHMgaW4gW2JhbmRdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNiYW5kKSBhbmQgW3BvaW50XShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjcG9pbnQpIHNjYWxlcy5cbiAgICpcbiAgICogSWYgYHJhbmdlU3RlcGAgaXMgYG51bGxgIG9yIGlmIHRoZSB2aWV3IGNvbnRhaW5zIHRoZSBzY2FsZSdzIGNvcnJlc3BvbmRpbmcgW3NpemVdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2l6ZS5odG1sKSAoYHdpZHRoYCBmb3IgYHhgIHNjYWxlcyBhbmQgYGhlaWdodGAgZm9yIGB5YCBzY2FsZXMpLCBgcmFuZ2VTdGVwYCB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgZGV0ZXJtaW5lZCB0byBmaXQgdGhlIHNpemUgb2YgdGhlIHZpZXcuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyAgZGVyaXZlZCB0aGUgW3NjYWxlIGNvbmZpZ10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9jb25maWcuaHRtbCNzY2FsZS1jb25maWcpJ3MgYHRleHRYUmFuZ2VTdGVwYCAoYDkwYCBieSBkZWZhdWx0KSBmb3IgeC1zY2FsZXMgb2YgYHRleHRgIG1hcmtzIGFuZCBgcmFuZ2VTdGVwYCAoYDIxYCBieSBkZWZhdWx0KSBmb3IgeC1zY2FsZXMgb2Ygb3RoZXIgbWFya3MgYW5kIHktc2NhbGVzLlxuICAgKlxuICAgKiBfX1dhcm5pbmdfXzogSWYgYHJhbmdlU3RlcGAgaXMgYG51bGxgIGFuZCB0aGUgY2FyZGluYWxpdHkgb2YgdGhlIHNjYWxlJ3MgZG9tYWluIGlzIGhpZ2hlciB0aGFuIGB3aWR0aGAgb3IgYGhlaWdodGAsIHRoZSByYW5nZVN0ZXAgbWlnaHQgYmVjb21lIGxlc3MgdGhhbiBvbmUgcGl4ZWwgYW5kIHRoZSBtYXJrIG1pZ2h0IG5vdCBhcHBlYXIgY29ycmVjdGx5LlxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICByYW5nZVN0ZXA/OiBudW1iZXIgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBBIHN0cmluZyBpbmRpY2F0aW5nIGEgY29sb3IgW3NjaGVtZV0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI3NjaGVtZSkgbmFtZSAoZS5nLiwgYFwiY2F0ZWdvcnkxMFwiYCBvciBgXCJ2aXJpZGlzXCJgKSBvciBhIFtzY2hlbWUgcGFyYW1ldGVyIG9iamVjdF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI3NjaGVtZS1wYXJhbXMpLlxuICAgKlxuICAgKiBEaXNjcmV0ZSBjb2xvciBzY2hlbWVzIG1heSBiZSB1c2VkIHdpdGggW2Rpc2NyZXRlXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjZGlzY3JldGUpIG9yIFtkaXNjcmV0aXppbmddKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNkaXNjcmV0aXppbmcpIHNjYWxlcy4gQ29udGludW91cyBjb2xvciBzY2hlbWVzIGFyZSBpbnRlbmRlZCBmb3IgdXNlIHdpdGggW3NlcXVlbnRpYWxdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGVzLmh0bWwjc2VxdWVudGlhbCkgc2NhbGVzLlxuICAgKlxuICAgKiBGb3IgdGhlIGZ1bGwgbGlzdCBvZiBzdXBwb3J0ZWQgc2NoZW1lcywgcGxlYXNlIHJlZmVyIHRvIHRoZSBbVmVnYSBTY2hlbWVdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS9kb2NzL3NjaGVtZXMvI3JlZmVyZW5jZSkgcmVmZXJlbmNlLlxuICAgKi9cbiAgc2NoZW1lPzogc3RyaW5nIHwgU2NoZW1lUGFyYW1zO1xuXG4gIC8qKlxuICAgKiBJZiBgdHJ1ZWAsIHJvdW5kcyBudW1lcmljIG91dHB1dCB2YWx1ZXMgdG8gaW50ZWdlcnMuIFRoaXMgY2FuIGJlIGhlbHBmdWwgZm9yIHNuYXBwaW5nIHRvIHRoZSBwaXhlbCBncmlkLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYGZhbHNlYC5cbiAgICovXG4gIHJvdW5kPzogYm9vbGVhbjtcblxuICAvKipcbiAgICogRm9yIF9bY29udGludW91c10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI2NvbnRpbnVvdXMpXyBzY2FsZXMsIGV4cGFuZHMgdGhlIHNjYWxlIGRvbWFpbiB0byBhY2NvbW1vZGF0ZSB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiBwaXhlbHMgb24gZWFjaCBvZiB0aGUgc2NhbGUgcmFuZ2UuIFRoZSBzY2FsZSByYW5nZSBtdXN0IHJlcHJlc2VudCBwaXhlbHMgZm9yIHRoaXMgcGFyYW1ldGVyIHRvIGZ1bmN0aW9uIGFzIGludGVuZGVkLiBQYWRkaW5nIGFkanVzdG1lbnQgaXMgcGVyZm9ybWVkwqBwcmlvcsKgdG8gYWxsIG90aGVyIGFkanVzdG1lbnRzLCBpbmNsdWRpbmcgdGhlIGVmZmVjdHMgb2YgdGhlwqB6ZXJvLMKgbmljZSzCoGRvbWFpbk1pbiwgYW5kwqBkb21haW5NYXjCoHByb3BlcnRpZXMuXG4gICAqXG4gICAqIEZvciBfW2JhbmRdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNiYW5kKV8gc2NhbGVzLCBzaG9ydGN1dCBmb3Igc2V0dGluZyBgcGFkZGluZ0lubmVyYCBhbmQgYHBhZGRpbmdPdXRlcmAgdG8gdGhlIHNhbWUgdmFsdWUuXG4gICAqXG4gICAqIEZvciBfW3BvaW50XShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjcG9pbnQpXyBzY2FsZXMsIGFsaWFzIGZvciBgcGFkZGluZ091dGVyYC5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIEZvciBfY29udGludW91c18gc2NhbGVzLCBkZXJpdmVkIGZyb20gdGhlIFtzY2FsZSBjb25maWddKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNjb25maWcpJ3MgYGNvbnRpbnVvdXNQYWRkaW5nYC5cbiAgICogRm9yIF9iYW5kIGFuZCBwb2ludF8gc2NhbGVzLCBzZWUgYHBhZGRpbmdJbm5lcmAgYW5kIGBwYWRkaW5nT3V0ZXJgLlxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBwYWRkaW5nPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgaW5uZXIgcGFkZGluZyAoc3BhY2luZykgd2l0aGluIGVhY2ggYmFuZCBzdGVwIG9mIGJhbmQgc2NhbGVzLCBhcyBhIGZyYWN0aW9uIG9mIHRoZSBzdGVwIHNpemUuIFRoaXMgdmFsdWUgbXVzdCBsaWUgaW4gdGhlIHJhbmdlIFswLDFdLlxuICAgKlxuICAgKiBGb3IgcG9pbnQgc2NhbGUsIHRoaXMgcHJvcGVydHkgaXMgaW52YWxpZCBhcyBwb2ludCBzY2FsZXMgZG8gbm90IGhhdmUgaW50ZXJuYWwgYmFuZCB3aWR0aHMgKG9ubHkgc3RlcCBzaXplcyBiZXR3ZWVuIGJhbmRzKS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGRlcml2ZWQgZnJvbSB0aGUgW3NjYWxlIGNvbmZpZ10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI2NvbmZpZykncyBgYmFuZFBhZGRpbmdJbm5lcmAuXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICogQG1heGltdW0gMVxuICAgKi9cbiAgcGFkZGluZ0lubmVyPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgb3V0ZXIgcGFkZGluZyAoc3BhY2luZykgYXQgdGhlIGVuZHMgb2YgdGhlIHJhbmdlIG9mIGJhbmQgYW5kIHBvaW50IHNjYWxlcyxcbiAgICogYXMgYSBmcmFjdGlvbiBvZiB0aGUgc3RlcCBzaXplLiBUaGlzIHZhbHVlIG11c3QgbGllIGluIHRoZSByYW5nZSBbMCwxXS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGRlcml2ZWQgZnJvbSB0aGUgW3NjYWxlIGNvbmZpZ10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI2NvbmZpZykncyBgYmFuZFBhZGRpbmdPdXRlcmAgZm9yIGJhbmQgc2NhbGVzIGFuZCBgcG9pbnRQYWRkaW5nYCBmb3IgcG9pbnQgc2NhbGVzLlxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqIEBtYXhpbXVtIDFcbiAgICovXG4gIHBhZGRpbmdPdXRlcj86IG51bWJlcjtcblxuICAvLyB0eXBpY2FsXG4gIC8qKlxuICAgKiBJZiBgdHJ1ZWAsIHZhbHVlcyB0aGF0IGV4Y2VlZCB0aGUgZGF0YSBkb21haW4gYXJlIGNsYW1wZWQgdG8gZWl0aGVyIHRoZSBtaW5pbXVtIG9yIG1heGltdW0gcmFuZ2UgdmFsdWVcbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGRlcml2ZWQgZnJvbSB0aGUgW3NjYWxlIGNvbmZpZ10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9jb25maWcuaHRtbCNzY2FsZS1jb25maWcpJ3MgYGNsYW1wYCAoYHRydWVgIGJ5IGRlZmF1bHQpLlxuICAgKi9cbiAgY2xhbXA/OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBFeHRlbmRpbmcgdGhlIGRvbWFpbiBzbyB0aGF0IGl0IHN0YXJ0cyBhbmQgZW5kcyBvbiBuaWNlIHJvdW5kIHZhbHVlcy4gVGhpcyBtZXRob2QgdHlwaWNhbGx5IG1vZGlmaWVzIHRoZSBzY2FsZeKAmXMgZG9tYWluLCBhbmQgbWF5IG9ubHkgZXh0ZW5kIHRoZSBib3VuZHMgdG8gdGhlIG5lYXJlc3Qgcm91bmQgdmFsdWUuIE5pY2luZyBpcyB1c2VmdWwgaWYgdGhlIGRvbWFpbiBpcyBjb21wdXRlZCBmcm9tIGRhdGEgYW5kIG1heSBiZSBpcnJlZ3VsYXIuIEZvciBleGFtcGxlLCBmb3IgYSBkb21haW4gb2YgX1swLjIwMTQ3OeKApiwgMC45OTY2NznigKZdXywgYSBuaWNlIGRvbWFpbiBtaWdodCBiZSBfWzAuMiwgMS4wXV8uXG4gICAqXG4gICAqIEZvciBxdWFudGl0YXRpdmUgc2NhbGVzIHN1Y2ggYXMgbGluZWFyLCBgbmljZWAgY2FuIGJlIGVpdGhlciBhIGJvb2xlYW4gZmxhZyBvciBhIG51bWJlci4gSWYgYG5pY2VgIGlzIGEgbnVtYmVyLCBpdCB3aWxsIHJlcHJlc2VudCBhIGRlc2lyZWQgdGljayBjb3VudC4gVGhpcyBhbGxvd3MgZ3JlYXRlciBjb250cm9sIG92ZXIgdGhlIHN0ZXAgc2l6ZSB1c2VkIHRvIGV4dGVuZCB0aGUgYm91bmRzLCBndWFyYW50ZWVpbmcgdGhhdCB0aGUgcmV0dXJuZWQgdGlja3Mgd2lsbCBleGFjdGx5IGNvdmVyIHRoZSBkb21haW4uXG4gICAqXG4gICAqIEZvciB0ZW1wb3JhbCBmaWVsZHMgd2l0aCB0aW1lIGFuZCB1dGMgc2NhbGVzLCB0aGUgYG5pY2VgIHZhbHVlIGNhbiBiZSBhIHN0cmluZyBpbmRpY2F0aW5nIHRoZSBkZXNpcmVkIHRpbWUgaW50ZXJ2YWwuIExlZ2FsIHZhbHVlcyBhcmUgYFwibWlsbGlzZWNvbmRcImAsIGBcInNlY29uZFwiYCwgYFwibWludXRlXCJgLCBgXCJob3VyXCJgLCBgXCJkYXlcImAsIGBcIndlZWtcImAsIGBcIm1vbnRoXCJgLCBhbmQgYFwieWVhclwiYC4gQWx0ZXJuYXRpdmVseSwgYHRpbWVgIGFuZCBgdXRjYCBzY2FsZXMgY2FuIGFjY2VwdCBhbiBvYmplY3QtdmFsdWVkIGludGVydmFsIHNwZWNpZmllciBvZiB0aGUgZm9ybSBge1wiaW50ZXJ2YWxcIjogXCJtb250aFwiLCBcInN0ZXBcIjogM31gLCB3aGljaCBpbmNsdWRlcyBhIGRlc2lyZWQgbnVtYmVyIG9mIGludGVydmFsIHN0ZXBzLiBIZXJlLCB0aGUgZG9tYWluIHdvdWxkIHNuYXAgdG8gcXVhcnRlciAoSmFuLCBBcHIsIEp1bCwgT2N0KSBib3VuZGFyaWVzLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYHRydWVgIGZvciB1bmJpbm5lZCBfcXVhbnRpdGF0aXZlXyBmaWVsZHM7IGBmYWxzZWAgb3RoZXJ3aXNlLlxuICAgKlxuICAgKi9cbiAgbmljZT86IGJvb2xlYW4gfCBudW1iZXIgfCBOaWNlVGltZSB8IHtpbnRlcnZhbDogc3RyaW5nLCBzdGVwOiBudW1iZXJ9O1xuXG4gIC8qKlxuICAgKiBUaGUgbG9nYXJpdGhtIGJhc2Ugb2YgdGhlIGBsb2dgIHNjYWxlIChkZWZhdWx0IGAxMGApLlxuICAgKi9cbiAgYmFzZT86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIGV4cG9uZW50IG9mIHRoZSBgcG93YCBzY2FsZS5cbiAgICovXG4gIGV4cG9uZW50PzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBJZiBgdHJ1ZWAsIGVuc3VyZXMgdGhhdCBhIHplcm8gYmFzZWxpbmUgdmFsdWUgaXMgaW5jbHVkZWQgaW4gdGhlIHNjYWxlIGRvbWFpbi5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGB0cnVlYCBmb3IgeCBhbmQgeSBjaGFubmVscyBpZiB0aGUgcXVhbnRpdGF0aXZlIGZpZWxkIGlzIG5vdCBiaW5uZWQgYW5kIG5vIGN1c3RvbSBgZG9tYWluYCBpcyBwcm92aWRlZDsgYGZhbHNlYCBvdGhlcndpc2UuXG4gICAqXG4gICAqIF9fTm90ZTpfXyBMb2csIHRpbWUsIGFuZCB1dGMgc2NhbGVzIGRvIG5vdCBzdXBwb3J0IGB6ZXJvYC5cbiAgICovXG4gIHplcm8/OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGUgaW50ZXJwb2xhdGlvbiBtZXRob2QgZm9yIHJhbmdlIHZhbHVlcy4gQnkgZGVmYXVsdCwgYSBnZW5lcmFsIGludGVycG9sYXRvciBmb3IgbnVtYmVycywgZGF0ZXMsIHN0cmluZ3MgYW5kIGNvbG9ycyAoaW4gUkdCIHNwYWNlKSBpcyB1c2VkLiBGb3IgY29sb3IgcmFuZ2VzLCB0aGlzIHByb3BlcnR5IGFsbG93cyBpbnRlcnBvbGF0aW9uIGluIGFsdGVybmF0aXZlIGNvbG9yIHNwYWNlcy4gTGVnYWwgdmFsdWVzIGluY2x1ZGUgYHJnYmAsIGBoc2xgLCBgaHNsLWxvbmdgLCBgbGFiYCwgYGhjbGAsIGBoY2wtbG9uZ2AsIGBjdWJlaGVsaXhgIGFuZCBgY3ViZWhlbGl4LWxvbmdgICgnLWxvbmcnIHZhcmlhbnRzIHVzZSBsb25nZXIgcGF0aHMgaW4gcG9sYXIgY29vcmRpbmF0ZSBzcGFjZXMpLiBJZiBvYmplY3QtdmFsdWVkLCB0aGlzIHByb3BlcnR5IGFjY2VwdHMgYW4gb2JqZWN0IHdpdGggYSBzdHJpbmctdmFsdWVkIF90eXBlXyBwcm9wZXJ0eSBhbmQgYW4gb3B0aW9uYWwgbnVtZXJpYyBfZ2FtbWFfIHByb3BlcnR5IGFwcGxpY2FibGUgdG8gcmdiIGFuZCBjdWJlaGVsaXggaW50ZXJwb2xhdG9ycy4gRm9yIG1vcmUsIHNlZSB0aGUgW2QzLWludGVycG9sYXRlIGRvY3VtZW50YXRpb25dKGh0dHBzOi8vZ2l0aHViLmNvbS9kMy9kMy1pbnRlcnBvbGF0ZSkuXG4gICAqXG4gICAqIF9fTm90ZTpfXyBTZXF1ZW50aWFsIHNjYWxlcyBkbyBub3Qgc3VwcG9ydCBgaW50ZXJwb2xhdGVgIGFzIHRoZXkgaGF2ZSBhIGZpeGVkIGludGVycG9sYXRvci4gIFNpbmNlIFZlZ2EtTGl0ZSB1c2VzIHNlcXVlbnRpYWwgc2NhbGVzIGZvciBxdWFudGl0YXRpdmUgZmllbGRzIGJ5IGRlZmF1bHQsIHlvdSBoYXZlIHRvIHNldCB0aGUgc2NhbGUgYHR5cGVgIHRvIG90aGVyIHF1YW50aXRhdGl2ZSBzY2FsZSB0eXBlIHN1Y2ggYXMgYFwibGluZWFyXCJgIHRvIGN1c3RvbWl6ZSBgaW50ZXJwb2xhdGVgLlxuICAgKi9cbiAgaW50ZXJwb2xhdGU/OiBTY2FsZUludGVycG9sYXRlIHwgU2NhbGVJbnRlcnBvbGF0ZVBhcmFtcztcbn1cblxuY29uc3QgU0NBTEVfUFJPUEVSVFlfSU5ERVg6IEZsYWc8a2V5b2YgU2NhbGU+ID0ge1xuICB0eXBlOiAxLFxuICBkb21haW46IDEsXG4gIHJhbmdlOiAxLFxuICByYW5nZVN0ZXA6IDEsXG4gIHNjaGVtZTogMSxcbiAgLy8gT3RoZXIgcHJvcGVydGllc1xuICByZXZlcnNlOiAxLFxuICByb3VuZDogMSxcbiAgLy8gcXVhbnRpdGF0aXZlIC8gdGltZVxuICBjbGFtcDogMSxcbiAgbmljZTogMSxcbiAgLy8gcXVhbnRpdGF0aXZlXG4gIGJhc2U6IDEsXG4gIGV4cG9uZW50OiAxLFxuICBpbnRlcnBvbGF0ZTogMSxcbiAgemVybzogMSwgLy8gemVybyBkZXBlbmRzIG9uIGRvbWFpblxuICAvLyBiYW5kL3BvaW50XG4gIHBhZGRpbmc6IDEsXG4gIHBhZGRpbmdJbm5lcjogMSxcbiAgcGFkZGluZ091dGVyOiAxXG59O1xuXG5leHBvcnQgY29uc3QgU0NBTEVfUFJPUEVSVElFUyA9IGZsYWdLZXlzKFNDQUxFX1BST1BFUlRZX0lOREVYKTtcblxuY29uc3Qge3R5cGUsIGRvbWFpbiwgcmFuZ2UsIHJhbmdlU3RlcCwgc2NoZW1lLCAuLi5OT05fVFlQRV9ET01BSU5fUkFOR0VfVkVHQV9TQ0FMRV9QUk9QRVJUWV9JTkRFWH0gPSBTQ0FMRV9QUk9QRVJUWV9JTkRFWDtcblxuZXhwb3J0IGNvbnN0IE5PTl9UWVBFX0RPTUFJTl9SQU5HRV9WRUdBX1NDQUxFX1BST1BFUlRJRVMgPSBmbGFnS2V5cyhOT05fVFlQRV9ET01BSU5fUkFOR0VfVkVHQV9TQ0FMRV9QUk9QRVJUWV9JTkRFWCk7XG5cbmV4cG9ydCBjb25zdCBTQ0FMRV9UWVBFX0lOREVYID0gZ2VuZXJhdGVTY2FsZVR5cGVJbmRleCgpO1xuXG5leHBvcnQgZnVuY3Rpb24gc2NhbGVUeXBlU3VwcG9ydFByb3BlcnR5KHNjYWxlVHlwZTogU2NhbGVUeXBlLCBwcm9wTmFtZToga2V5b2YgU2NhbGUpIHtcbiAgc3dpdGNoIChwcm9wTmFtZSkge1xuICAgIGNhc2UgJ3R5cGUnOlxuICAgIGNhc2UgJ2RvbWFpbic6XG4gICAgY2FzZSAncmV2ZXJzZSc6XG4gICAgY2FzZSAncmFuZ2UnOlxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgY2FzZSAnc2NoZW1lJzpcbiAgICAgIHJldHVybiBjb250YWlucyhbJ3NlcXVlbnRpYWwnLCAnb3JkaW5hbCcsICdiaW4tb3JkaW5hbCcsICdxdWFudGlsZScsICdxdWFudGl6ZSddLCBzY2FsZVR5cGUpO1xuICAgIGNhc2UgJ2ludGVycG9sYXRlJzpcbiAgICAgIC8vIEZJWE1FKGh0dHBzOi8vZ2l0aHViLmNvbS92ZWdhL3ZlZ2EtbGl0ZS9pc3N1ZXMvMjkwMikgaG93IGFib3V0IG9yZGluYWw/XG4gICAgICByZXR1cm4gY29udGFpbnMoWydsaW5lYXInLCAnYmluLWxpbmVhcicsICdwb3cnLCAnbG9nJywgJ3NxcnQnLCAndXRjJywgJ3RpbWUnXSwgc2NhbGVUeXBlKTtcbiAgICBjYXNlICdyb3VuZCc6XG4gICAgICByZXR1cm4gaXNDb250aW51b3VzVG9Db250aW51b3VzKHNjYWxlVHlwZSkgfHwgc2NhbGVUeXBlID09PSAnYmFuZCcgfHwgc2NhbGVUeXBlID09PSAncG9pbnQnO1xuICAgIGNhc2UgJ3BhZGRpbmcnOlxuICAgICAgcmV0dXJuIGlzQ29udGludW91c1RvQ29udGludW91cyhzY2FsZVR5cGUpIHx8IGNvbnRhaW5zKFsncG9pbnQnLCAnYmFuZCddLCBzY2FsZVR5cGUpO1xuICAgIGNhc2UgJ3BhZGRpbmdPdXRlcic6XG4gICAgY2FzZSAncmFuZ2VTdGVwJzpcbiAgICAgIHJldHVybiBjb250YWlucyhbJ3BvaW50JywgJ2JhbmQnXSwgc2NhbGVUeXBlKTtcbiAgICBjYXNlICdwYWRkaW5nSW5uZXInOlxuICAgICAgcmV0dXJuIHNjYWxlVHlwZSA9PT0gJ2JhbmQnO1xuICAgIGNhc2UgJ2NsYW1wJzpcbiAgICAgIHJldHVybiBpc0NvbnRpbnVvdXNUb0NvbnRpbnVvdXMoc2NhbGVUeXBlKSB8fCBzY2FsZVR5cGUgPT09ICdzZXF1ZW50aWFsJztcbiAgICBjYXNlICduaWNlJzpcbiAgICAgIHJldHVybiBpc0NvbnRpbnVvdXNUb0NvbnRpbnVvdXMoc2NhbGVUeXBlKSB8fCBzY2FsZVR5cGUgPT09ICdzZXF1ZW50aWFsJyB8fCBzY2FsZVR5cGUgYXMgYW55ID09PSAncXVhbnRpemUnO1xuICAgIGNhc2UgJ2V4cG9uZW50JzpcbiAgICAgIHJldHVybiBzY2FsZVR5cGUgPT09ICdwb3cnO1xuICAgIGNhc2UgJ2Jhc2UnOlxuICAgICAgcmV0dXJuIHNjYWxlVHlwZSA9PT0gJ2xvZyc7XG4gICAgY2FzZSAnemVybyc6XG4gICAgICByZXR1cm4gaGFzQ29udGludW91c0RvbWFpbihzY2FsZVR5cGUpICYmICFjb250YWlucyhbXG4gICAgICAgICdsb2cnLCAgLy8gbG9nIHNjYWxlIGNhbm5vdCBoYXZlIHplcm8gdmFsdWVcbiAgICAgICAgJ3RpbWUnLCAndXRjJywgLy8gemVybyBpcyBub3QgbWVhbmluZ2Z1bCBmb3IgdGltZVxuICAgICAgICAnYmluLWxpbmVhcicsIC8vIGJpbm5pbmcgc2hvdWxkIG5vdCBhdXRvbWF0aWNhbGx5IGFkZCB6ZXJvXG4gICAgICAgICd0aHJlc2hvbGQnLCAvLyB0aHJlc2hvbGQgcmVxdWlyZXMgY3VzdG9tIGRvbWFpbiBzbyB6ZXJvIGRvZXMgbm90IG1hdHRlclxuICAgICAgICAncXVhbnRpbGUnIC8vIHF1YW50aWxlIGRlcGVuZHMgb24gZGlzdHJpYnV0aW9uIHNvIHplcm8gZG9lcyBub3QgbWF0dGVyXG4gICAgICBdLCBzY2FsZVR5cGUpO1xuICB9XG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBzaG91bGQgbmV2ZXIgcmVhY2ggaGVyZSovXG4gIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBzY2FsZSBwcm9wZXJ0eSAke3Byb3BOYW1lfS5gKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHVuZGVmaW5lZCBpZiB0aGUgaW5wdXQgY2hhbm5lbCBzdXBwb3J0cyB0aGUgaW5wdXQgc2NhbGUgcHJvcGVydHkgbmFtZVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hhbm5lbFNjYWxlUHJvcGVydHlJbmNvbXBhdGFiaWxpdHkoY2hhbm5lbDogQ2hhbm5lbCwgcHJvcE5hbWU6IGtleW9mIFNjYWxlKTogc3RyaW5nIHtcbiAgc3dpdGNoIChwcm9wTmFtZSkge1xuICAgIGNhc2UgJ2ludGVycG9sYXRlJzpcbiAgICBjYXNlICdzY2hlbWUnOlxuICAgICAgaWYgKCFpc0NvbG9yQ2hhbm5lbChjaGFubmVsKSkge1xuICAgICAgICByZXR1cm4gbG9nLm1lc3NhZ2UuY2Fubm90VXNlU2NhbGVQcm9wZXJ0eVdpdGhOb25Db2xvcihjaGFubmVsKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgY2FzZSAndHlwZSc6XG4gICAgY2FzZSAnZG9tYWluJzpcbiAgICBjYXNlICdyYW5nZSc6XG4gICAgY2FzZSAnYmFzZSc6XG4gICAgY2FzZSAnZXhwb25lbnQnOlxuICAgIGNhc2UgJ25pY2UnOlxuICAgIGNhc2UgJ3BhZGRpbmcnOlxuICAgIGNhc2UgJ3BhZGRpbmdJbm5lcic6XG4gICAgY2FzZSAncGFkZGluZ091dGVyJzpcbiAgICBjYXNlICdyYW5nZVN0ZXAnOlxuICAgIGNhc2UgJ3JldmVyc2UnOlxuICAgIGNhc2UgJ3JvdW5kJzpcbiAgICBjYXNlICdjbGFtcCc6XG4gICAgY2FzZSAnemVybyc6XG4gICAgICByZXR1cm4gdW5kZWZpbmVkOyAvLyBHT09EIVxuICB9XG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBpdCBzaG91bGQgbmV2ZXIgcmVhY2ggaGVyZSAqL1xuICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgc2NhbGUgcHJvcGVydHkgXCIke3Byb3BOYW1lfVwiLmApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2NhbGVUeXBlU3VwcG9ydERhdGFUeXBlKHNwZWNpZmllZFR5cGU6IFNjYWxlVHlwZSwgZmllbGREZWZUeXBlOiBUeXBlLCBiaW46IGJvb2xlYW58QmluUGFyYW1zKTpib29sZWFuIHtcbiAgaWYgKGNvbnRhaW5zKFtUeXBlLk9SRElOQUwsIFR5cGUuTk9NSU5BTF0sIGZpZWxkRGVmVHlwZSkpIHtcbiAgICByZXR1cm4gc3BlY2lmaWVkVHlwZSA9PT0gdW5kZWZpbmVkIHx8IGhhc0Rpc2NyZXRlRG9tYWluKHNwZWNpZmllZFR5cGUpO1xuICB9IGVsc2UgaWYgKGZpZWxkRGVmVHlwZSA9PT0gVHlwZS5URU1QT1JBTCkge1xuICAgIHJldHVybiBjb250YWlucyhbU2NhbGVUeXBlLlRJTUUsIFNjYWxlVHlwZS5VVEMsIFNjYWxlVHlwZS5TRVFVRU5USUFMLCB1bmRlZmluZWRdLCBzcGVjaWZpZWRUeXBlKTtcbiAgfSBlbHNlIGlmIChmaWVsZERlZlR5cGUgPT09IFR5cGUuUVVBTlRJVEFUSVZFKSB7XG4gICAgaWYgKGJpbikge1xuICAgICAgcmV0dXJuIGNvbnRhaW5zKFtTY2FsZVR5cGUuQklOX0xJTkVBUiwgU2NhbGVUeXBlLkJJTl9PUkRJTkFMLCBTY2FsZVR5cGUuTElORUFSXSwgc3BlY2lmaWVkVHlwZSk7XG4gICAgfVxuICAgIHJldHVybiBjb250YWlucyhbU2NhbGVUeXBlLkxPRywgU2NhbGVUeXBlLlBPVywgU2NhbGVUeXBlLlNRUlQsIFNjYWxlVHlwZS5RVUFOVElMRSwgU2NhbGVUeXBlLlFVQU5USVpFLCBTY2FsZVR5cGUuTElORUFSLCBTY2FsZVR5cGUuU0VRVUVOVElBTCwgdW5kZWZpbmVkXSwgc3BlY2lmaWVkVHlwZSk7XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNoYW5uZWxTdXBwb3J0U2NhbGVUeXBlKGNoYW5uZWw6IENoYW5uZWwsIHNjYWxlVHlwZTogU2NhbGVUeXBlKTogYm9vbGVhbiB7XG4gIHN3aXRjaCAoY2hhbm5lbCkge1xuICAgIGNhc2UgQ2hhbm5lbC5YOlxuICAgIGNhc2UgQ2hhbm5lbC5ZOlxuICAgIGNhc2UgQ2hhbm5lbC5TSVpFOiAvLyBUT0RPOiBzaXplIGFuZCBvcGFjaXR5IGNhbiBzdXBwb3J0IG9yZGluYWwgd2l0aCBtb3JlIG1vZGlmaWNhdGlvblxuICAgIGNhc2UgQ2hhbm5lbC5PUEFDSVRZOlxuICAgICAgLy8gQWx0aG91Z2ggaXQgZ2VuZXJhbGx5IGRvZXNuJ3QgbWFrZSBzZW5zZSB0byB1c2UgYmFuZCB3aXRoIHNpemUgYW5kIG9wYWNpdHksXG4gICAgICAvLyBpdCBjYW4gYWxzbyB3b3JrIHNpbmNlIHdlIHVzZSBiYW5kOiAwLjUgdG8gZ2V0IG1pZHBvaW50LlxuICAgICAgcmV0dXJuIGlzQ29udGludW91c1RvQ29udGludW91cyhzY2FsZVR5cGUpIHx8IGNvbnRhaW5zKFsnYmFuZCcsICdwb2ludCddLCBzY2FsZVR5cGUpO1xuXG4gICAgY2FzZSBDaGFubmVsLkNPTE9SOlxuICAgIGNhc2UgQ2hhbm5lbC5GSUxMOlxuICAgIGNhc2UgQ2hhbm5lbC5TVFJPS0U6XG4gICAgICByZXR1cm4gc2NhbGVUeXBlICE9PSAnYmFuZCc7ICAgIC8vIGJhbmQgZG9lcyBub3QgbWFrZSBzZW5zZSB3aXRoIGNvbG9yXG5cbiAgICBjYXNlIENoYW5uZWwuU0hBUEU6XG4gICAgICByZXR1cm4gc2NhbGVUeXBlID09PSAnb3JkaW5hbCc7IC8vIHNoYXBlID0gbG9va3VwIG9ubHlcbiAgfVxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dDogaXQgc2hvdWxkIG5ldmVyIHJlYWNoIGhlcmUgKi9cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3VwcG9ydGVkU2NhbGVUeXBlKGNoYW5uZWw6IENoYW5uZWwsIGZpZWxkRGVmVHlwZTogVHlwZSwgYmluPzogYm9vbGVhbikge1xuICByZXR1cm4gU0NBTEVfVFlQRV9JTkRFWFtnZW5lcmF0ZVNjYWxlVHlwZUluZGV4S2V5KGNoYW5uZWwsIGZpZWxkRGVmVHlwZSwgYmluKV07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2NhbGVUeXBlSW5kZXgge1xuICBbY2hhbm5lbDogc3RyaW5nXTogU2NhbGVUeXBlW107XG59XG5cbi8vIGdlbmVyYXRlcyBTY2FsZVR5cGVJbmRleCB3aGVyZSBrZXlzIGFyZSBlbmNvZGluZyBjaGFubmVscyBhbmQgdmFsdWVzIGFyZSBsaXN0IG9mIHZhbGlkIFNjYWxlVHlwZXNcbmZ1bmN0aW9uIGdlbmVyYXRlU2NhbGVUeXBlSW5kZXgoKSB7XG4gIGNvbnN0IGluZGV4OiBTY2FsZVR5cGVJbmRleCA9IHt9O1xuICBmb3IgKGNvbnN0IGNoYW5uZWwgb2YgQ0hBTk5FTFMpIHtcbiAgICBmb3IgKGNvbnN0IGZpZWxkRGVmVHlwZSBvZiBrZXlzKFRZUEVfSU5ERVgpKSB7XG4gICAgICBmb3IgKGNvbnN0IHNjYWxlVHlwZSBvZiBTQ0FMRV9UWVBFUykge1xuICAgICAgICBmb3IgKGNvbnN0IGJpbiBvZiBbZmFsc2UsIHRydWVdKSB7XG4gICAgICAgICAgY29uc3Qga2V5ID0gZ2VuZXJhdGVTY2FsZVR5cGVJbmRleEtleShjaGFubmVsLCBmaWVsZERlZlR5cGUsIGJpbik7XG4gICAgICAgICAgaWYgKGNoYW5uZWxTdXBwb3J0U2NhbGVUeXBlKGNoYW5uZWwsIHNjYWxlVHlwZSkgJiYgc2NhbGVUeXBlU3VwcG9ydERhdGFUeXBlKHNjYWxlVHlwZSwgZmllbGREZWZUeXBlLCBiaW4pKSB7XG4gICAgICAgICAgICBpbmRleFtrZXldID0gaW5kZXhba2V5XSB8fCBbXTtcbiAgICAgICAgICAgIGluZGV4W2tleV0ucHVzaChzY2FsZVR5cGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gaW5kZXg7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlU2NhbGVUeXBlSW5kZXhLZXkoY2hhbm5lbDogQ2hhbm5lbCwgZmllbGREZWZUeXBlOiBUeXBlLCBiaW46IGJvb2xlYW4pIHtcbiAgY29uc3Qga2V5ID0gY2hhbm5lbCArICdfJyArIGZpZWxkRGVmVHlwZTtcbiAgcmV0dXJuIGJpbiA/IGtleSArICdfYmluJyA6IGtleTtcbn1cbiJdfQ==