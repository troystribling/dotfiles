{"version":3,"file":"vega-lite.js","sources":["../node_modules/vega-util/src/accessor.js","../node_modules/vega-util/src/error.js","../node_modules/vega-util/src/splitAccessPath.js","../node_modules/vega-util/src/isArray.js","../node_modules/vega-util/src/isObject.js","../node_modules/vega-util/src/isString.js","../node_modules/vega-util/src/stringValue.js","../node_modules/vega-util/src/field.js","../node_modules/vega-util/src/accessors.js","../node_modules/vega-util/src/logger.js","../node_modules/vega-util/src/isBoolean.js","../node_modules/vega-util/src/isNumber.js","../node_modules/vega-util/src/toSet.js","../node_modules/tslib/tslib.es6.js","../node_modules/jsonify/lib/parse.js","../node_modules/jsonify/lib/stringify.js","../node_modules/jsonify/index.js","../node_modules/json-stable-stringify/index.js","src/logical.js","src/util.js","src/aggregate.js","src/axis.js","src/channel.js","src/bin.js","src/mark.js","src/log.js","src/datetime.js","src/timeunit.js","src/type.js","src/fielddef.js","src/encoding.js","src/compositemark/common.js","src/compositemark/boxplot.js","src/compositemark/errorbar.js","src/compositemark/index.js","src/guide.js","src/legend.js","src/scale.js","src/selection.js","src/title.js","src/config.js","src/stack.js","src/spec.js","src/toplevelprops.js","src/data.js","../node_modules/vega-event-selector/src/event-selector.js","src/vega.schema.js","src/compile/axis/assemble.js","src/compile/mark/valueref.js","src/compile/mark/mixins.js","src/compile/common.js","src/compile/layout/header.js","src/compile/layoutsize/assemble.js","src/compile/resolve.js","src/compile/split.js","src/compile/legend/component.js","src/compile/legend/encode.js","src/compile/legend/properties.js","src/compile/legend/parse.js","src/compile/legend/assemble.js","src/compile/projection/assemble.js","src/projection.js","src/compile/projection/component.js","src/compile/projection/parse.js","src/sort.js","src/compile/data/dataflow.js","src/compile/data/calculate.js","src/compile/data/aggregate.js","src/compile/data/facet.js","src/compile/data/filterinvalid.js","src/compile/data/formatparse.js","src/compile/data/source.js","src/compile/data/timeunit.js","src/compile/data/optimizers.js","src/compile/data/stack.js","src/compile/data/optimize.js","src/compile/scale/domain.js","src/compile/scale/assemble.js","src/compile/scale/component.js","src/compile/scale/range.js","src/compile/scale/properties.js","src/compile/scale/type.js","src/compile/scale/parse.js","src/compile/model.js","src/compile/selection/transforms/scales.js","src/compile/selection/interval.js","src/compile/selection/transforms/nearest.js","src/compile/selection/multi.js","src/compile/selection/single.js","src/compile/selection/transforms/inputs.js","src/compile/selection/transforms/project.js","src/compile/selection/transforms/toggle.js","src/compile/selection/transforms/translate.js","src/compile/selection/transforms/zoom.js","src/compile/selection/transforms/transforms.js","src/compile/selection/selection.js","src/predicate.js","src/transform.js","src/compile/data/bin.js","src/compile/data/filter.js","src/compile/data/geojson.js","src/compile/data/geopoint.js","src/compile/data/indentifier.js","src/compile/data/index.js","src/compile/data/lookup.js","src/compile/data/window.js","src/compile/data/parse.js","src/compile/baseconcat.js","src/compile/layoutsize/parse.js","src/compile/concat.js","src/compile/data/assemble.js","src/compile/repeater.js","src/compile/facet.js","src/compile/axis/component.js","src/compile/axis/config.js","src/compile/axis/encode.js","src/compile/axis/properties.js","src/compile/axis/parse.js","src/compile/mark/init.js","src/compile/mark/area.js","src/compile/mark/bar.js","src/compile/mark/geoshape.js","src/compile/mark/line.js","src/compile/mark/point.js","src/compile/mark/rect.js","src/compile/mark/rule.js","src/compile/mark/text.js","src/compile/mark/tick.js","src/compile/mark/mark.js","src/compile/unit.js","src/compile/layer.js","src/compile/repeat.js","src/compile/buildmodel.js","src/compile/compile.js","src/validate.js"],"sourcesContent":["export default function(fn, fields, name) {\n  fn.fields = fields || [];\n  fn.fname = name;\n  return fn;\n}\n\nexport function accessorName(fn) {\n  return fn == null ? null : fn.fname;\n}\n\nexport function accessorFields(fn) {\n  return fn == null ? null : fn.fields;\n}\n","export default function(message) {\n  throw Error(message);\n}\n","import error from './error';\n\nexport default function(p) {\n  var path = [],\n      q = null,\n      b = 0,\n      n = p.length,\n      s = '',\n      i, j, c;\n\n  p = p + '';\n\n  function push() {\n    path.push(s + p.substring(i, j));\n    s = '';\n    i = j + 1;\n  }\n\n  for (i=j=0; j<n; ++j) {\n    c = p[j];\n    if (c === '\\\\') {\n      s += p.substring(i, j);\n      i = ++j;\n    } else if (c === q) {\n      push();\n      q = null;\n      b = -1;\n    } else if (q) {\n      continue;\n    } else if (i === b && c === '\"') {\n      i = j + 1;\n      q = c;\n    } else if (i === b && c === \"'\") {\n      i = j + 1;\n      q = c;\n    } else if (c === '.' && !b) {\n      if (j > i) {\n        push();\n      } else {\n        i = j + 1;\n      }\n    } else if (c === '[') {\n      if (j > i) push();\n      b = i = j + 1;\n    } else if (c === ']') {\n      if (!b) error('Access path missing open bracket: ' + p);\n      if (b > 0) push();\n      b = 0;\n      i = j + 1;\n    }\n  }\n\n  if (b) error('Access path missing closing bracket: ' + p);\n  if (q) error('Access path missing closing quote: ' + p);\n\n  if (j > i) {\n    j++;\n    push();\n  }\n\n  return path;\n}\n","export default Array.isArray;\n","export default function(_) {\n  return _ === Object(_);\n}\n","export default function(_) {\n  return typeof _ === 'string';\n}\n","import isArray from './isArray';\nimport isObject from './isObject';\nimport isString from './isString';\n\nexport default function $(x) {\n  return isArray(x) ? '[' + x.map($) + ']'\n    : isObject(x) || isString(x) ?\n      // Output valid JSON and JS source strings.\n      // See http://timelessrepo.com/json-isnt-a-javascript-subset\n      JSON.stringify(x).replace('\\u2028','\\\\u2028').replace('\\u2029', '\\\\u2029')\n    : x;\n}\n","import accessor from './accessor';\nimport splitAccessPath from './splitAccessPath';\nimport stringValue from './stringValue';\n\nexport default function(field, name) {\n  var path = splitAccessPath(field),\n      code = 'return _[' + path.map(stringValue).join('][') + '];';\n\n  return accessor(\n    Function('_', code),\n    [(field = path.length===1 ? path[0] : field)],\n    name || field\n  );\n}\n","import accessor from './accessor';\nimport field from './field';\n\nvar empty = [];\n\nexport var id = field('id');\n\nexport var identity = accessor(function(_) { return _; }, empty, 'identity');\n\nexport var zero = accessor(function() { return 0; }, empty, 'zero');\n\nexport var one = accessor(function() { return 1; }, empty, 'one');\n\nexport var truthy = accessor(function() { return true; }, empty, 'true');\n\nexport var falsy = accessor(function() { return false; }, empty, 'false');\n","function log(method, level, input) {\n  var args = [level].concat([].slice.call(input));\n  console[method].apply(console, args); // eslint-disable-line no-console\n}\n\nexport var None  = 0;\nexport var Error = 1;\nexport var Warn  = 2;\nexport var Info  = 3;\nexport var Debug = 4;\n\nexport default function(_) {\n  var level = _ || None;\n  return {\n    level: function(_) {\n      if (arguments.length) {\n        level = +_;\n        return this;\n      } else {\n        return level;\n      }\n    },\n    error: function() {\n      if (level >= Error) log('error', 'ERROR', arguments);\n      return this;\n    },\n    warn: function() {\n      if (level >= Warn) log('warn', 'WARN', arguments);\n      return this;\n    },\n    info: function() {\n      if (level >= Info) log('log', 'INFO', arguments);\n      return this;\n    },\n    debug: function() {\n      if (level >= Debug) log('log', 'DEBUG', arguments);\n      return this;\n    }\n  }\n}\n","export default function(_) {\n  return typeof _ === 'boolean';\n}\n","export default function(_) {\n  return typeof _ === 'number';\n}\n","export default function(_) {\n  for (var s={}, i=0, n=_.length; i<n; ++i) s[_[i]] = true;\n  return s;\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = Object.setPrototypeOf ||\r\n    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = Object.assign || function __assign(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","var at, // The index of the current character\n    ch, // The current character\n    escapee = {\n        '\"':  '\"',\n        '\\\\': '\\\\',\n        '/':  '/',\n        b:    '\\b',\n        f:    '\\f',\n        n:    '\\n',\n        r:    '\\r',\n        t:    '\\t'\n    },\n    text,\n\n    error = function (m) {\n        // Call error when something is wrong.\n        throw {\n            name:    'SyntaxError',\n            message: m,\n            at:      at,\n            text:    text\n        };\n    },\n    \n    next = function (c) {\n        // If a c parameter is provided, verify that it matches the current character.\n        if (c && c !== ch) {\n            error(\"Expected '\" + c + \"' instead of '\" + ch + \"'\");\n        }\n        \n        // Get the next character. When there are no more characters,\n        // return the empty string.\n        \n        ch = text.charAt(at);\n        at += 1;\n        return ch;\n    },\n    \n    number = function () {\n        // Parse a number value.\n        var number,\n            string = '';\n        \n        if (ch === '-') {\n            string = '-';\n            next('-');\n        }\n        while (ch >= '0' && ch <= '9') {\n            string += ch;\n            next();\n        }\n        if (ch === '.') {\n            string += '.';\n            while (next() && ch >= '0' && ch <= '9') {\n                string += ch;\n            }\n        }\n        if (ch === 'e' || ch === 'E') {\n            string += ch;\n            next();\n            if (ch === '-' || ch === '+') {\n                string += ch;\n                next();\n            }\n            while (ch >= '0' && ch <= '9') {\n                string += ch;\n                next();\n            }\n        }\n        number = +string;\n        if (!isFinite(number)) {\n            error(\"Bad number\");\n        } else {\n            return number;\n        }\n    },\n    \n    string = function () {\n        // Parse a string value.\n        var hex,\n            i,\n            string = '',\n            uffff;\n        \n        // When parsing for string values, we must look for \" and \\ characters.\n        if (ch === '\"') {\n            while (next()) {\n                if (ch === '\"') {\n                    next();\n                    return string;\n                } else if (ch === '\\\\') {\n                    next();\n                    if (ch === 'u') {\n                        uffff = 0;\n                        for (i = 0; i < 4; i += 1) {\n                            hex = parseInt(next(), 16);\n                            if (!isFinite(hex)) {\n                                break;\n                            }\n                            uffff = uffff * 16 + hex;\n                        }\n                        string += String.fromCharCode(uffff);\n                    } else if (typeof escapee[ch] === 'string') {\n                        string += escapee[ch];\n                    } else {\n                        break;\n                    }\n                } else {\n                    string += ch;\n                }\n            }\n        }\n        error(\"Bad string\");\n    },\n\n    white = function () {\n\n// Skip whitespace.\n\n        while (ch && ch <= ' ') {\n            next();\n        }\n    },\n\n    word = function () {\n\n// true, false, or null.\n\n        switch (ch) {\n        case 't':\n            next('t');\n            next('r');\n            next('u');\n            next('e');\n            return true;\n        case 'f':\n            next('f');\n            next('a');\n            next('l');\n            next('s');\n            next('e');\n            return false;\n        case 'n':\n            next('n');\n            next('u');\n            next('l');\n            next('l');\n            return null;\n        }\n        error(\"Unexpected '\" + ch + \"'\");\n    },\n\n    value,  // Place holder for the value function.\n\n    array = function () {\n\n// Parse an array value.\n\n        var array = [];\n\n        if (ch === '[') {\n            next('[');\n            white();\n            if (ch === ']') {\n                next(']');\n                return array;   // empty array\n            }\n            while (ch) {\n                array.push(value());\n                white();\n                if (ch === ']') {\n                    next(']');\n                    return array;\n                }\n                next(',');\n                white();\n            }\n        }\n        error(\"Bad array\");\n    },\n\n    object = function () {\n\n// Parse an object value.\n\n        var key,\n            object = {};\n\n        if (ch === '{') {\n            next('{');\n            white();\n            if (ch === '}') {\n                next('}');\n                return object;   // empty object\n            }\n            while (ch) {\n                key = string();\n                white();\n                next(':');\n                if (Object.hasOwnProperty.call(object, key)) {\n                    error('Duplicate key \"' + key + '\"');\n                }\n                object[key] = value();\n                white();\n                if (ch === '}') {\n                    next('}');\n                    return object;\n                }\n                next(',');\n                white();\n            }\n        }\n        error(\"Bad object\");\n    };\n\nvalue = function () {\n\n// Parse a JSON value. It could be an object, an array, a string, a number,\n// or a word.\n\n    white();\n    switch (ch) {\n    case '{':\n        return object();\n    case '[':\n        return array();\n    case '\"':\n        return string();\n    case '-':\n        return number();\n    default:\n        return ch >= '0' && ch <= '9' ? number() : word();\n    }\n};\n\n// Return the json_parse function. It will have access to all of the above\n// functions and variables.\n\nmodule.exports = function (source, reviver) {\n    var result;\n    \n    text = source;\n    at = 0;\n    ch = ' ';\n    result = value();\n    white();\n    if (ch) {\n        error(\"Syntax error\");\n    }\n\n    // If there is a reviver function, we recursively walk the new structure,\n    // passing each name/value pair to the reviver function for possible\n    // transformation, starting with a temporary root object that holds the result\n    // in an empty key. If there is not a reviver function, we simply return the\n    // result.\n\n    return typeof reviver === 'function' ? (function walk(holder, key) {\n        var k, v, value = holder[key];\n        if (value && typeof value === 'object') {\n            for (k in value) {\n                if (Object.prototype.hasOwnProperty.call(value, k)) {\n                    v = walk(value, k);\n                    if (v !== undefined) {\n                        value[k] = v;\n                    } else {\n                        delete value[k];\n                    }\n                }\n            }\n        }\n        return reviver.call(holder, key, value);\n    }({'': result}, '')) : result;\n};\n","var cx = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,\n    escapable = /[\\\\\\\"\\x00-\\x1f\\x7f-\\x9f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g,\n    gap,\n    indent,\n    meta = {    // table of character substitutions\n        '\\b': '\\\\b',\n        '\\t': '\\\\t',\n        '\\n': '\\\\n',\n        '\\f': '\\\\f',\n        '\\r': '\\\\r',\n        '\"' : '\\\\\"',\n        '\\\\': '\\\\\\\\'\n    },\n    rep;\n\nfunction quote(string) {\n    // If the string contains no control characters, no quote characters, and no\n    // backslash characters, then we can safely slap some quotes around it.\n    // Otherwise we must also replace the offending characters with safe escape\n    // sequences.\n    \n    escapable.lastIndex = 0;\n    return escapable.test(string) ? '\"' + string.replace(escapable, function (a) {\n        var c = meta[a];\n        return typeof c === 'string' ? c :\n            '\\\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\n    }) + '\"' : '\"' + string + '\"';\n}\n\nfunction str(key, holder) {\n    // Produce a string from holder[key].\n    var i,          // The loop counter.\n        k,          // The member key.\n        v,          // The member value.\n        length,\n        mind = gap,\n        partial,\n        value = holder[key];\n    \n    // If the value has a toJSON method, call it to obtain a replacement value.\n    if (value && typeof value === 'object' &&\n            typeof value.toJSON === 'function') {\n        value = value.toJSON(key);\n    }\n    \n    // If we were called with a replacer function, then call the replacer to\n    // obtain a replacement value.\n    if (typeof rep === 'function') {\n        value = rep.call(holder, key, value);\n    }\n    \n    // What happens next depends on the value's type.\n    switch (typeof value) {\n        case 'string':\n            return quote(value);\n        \n        case 'number':\n            // JSON numbers must be finite. Encode non-finite numbers as null.\n            return isFinite(value) ? String(value) : 'null';\n        \n        case 'boolean':\n        case 'null':\n            // If the value is a boolean or null, convert it to a string. Note:\n            // typeof null does not produce 'null'. The case is included here in\n            // the remote chance that this gets fixed someday.\n            return String(value);\n            \n        case 'object':\n            if (!value) return 'null';\n            gap += indent;\n            partial = [];\n            \n            // Array.isArray\n            if (Object.prototype.toString.apply(value) === '[object Array]') {\n                length = value.length;\n                for (i = 0; i < length; i += 1) {\n                    partial[i] = str(i, value) || 'null';\n                }\n                \n                // Join all of the elements together, separated with commas, and\n                // wrap them in brackets.\n                v = partial.length === 0 ? '[]' : gap ?\n                    '[\\n' + gap + partial.join(',\\n' + gap) + '\\n' + mind + ']' :\n                    '[' + partial.join(',') + ']';\n                gap = mind;\n                return v;\n            }\n            \n            // If the replacer is an array, use it to select the members to be\n            // stringified.\n            if (rep && typeof rep === 'object') {\n                length = rep.length;\n                for (i = 0; i < length; i += 1) {\n                    k = rep[i];\n                    if (typeof k === 'string') {\n                        v = str(k, value);\n                        if (v) {\n                            partial.push(quote(k) + (gap ? ': ' : ':') + v);\n                        }\n                    }\n                }\n            }\n            else {\n                // Otherwise, iterate through all of the keys in the object.\n                for (k in value) {\n                    if (Object.prototype.hasOwnProperty.call(value, k)) {\n                        v = str(k, value);\n                        if (v) {\n                            partial.push(quote(k) + (gap ? ': ' : ':') + v);\n                        }\n                    }\n                }\n            }\n            \n        // Join all of the member texts together, separated with commas,\n        // and wrap them in braces.\n\n        v = partial.length === 0 ? '{}' : gap ?\n            '{\\n' + gap + partial.join(',\\n' + gap) + '\\n' + mind + '}' :\n            '{' + partial.join(',') + '}';\n        gap = mind;\n        return v;\n    }\n}\n\nmodule.exports = function (value, replacer, space) {\n    var i;\n    gap = '';\n    indent = '';\n    \n    // If the space parameter is a number, make an indent string containing that\n    // many spaces.\n    if (typeof space === 'number') {\n        for (i = 0; i < space; i += 1) {\n            indent += ' ';\n        }\n    }\n    // If the space parameter is a string, it will be used as the indent string.\n    else if (typeof space === 'string') {\n        indent = space;\n    }\n\n    // If there is a replacer, it must be a function or an array.\n    // Otherwise, throw an error.\n    rep = replacer;\n    if (replacer && typeof replacer !== 'function'\n    && (typeof replacer !== 'object' || typeof replacer.length !== 'number')) {\n        throw new Error('JSON.stringify');\n    }\n    \n    // Make a fake root object containing our value under the key of ''.\n    // Return the result of stringifying the value.\n    return str('', {'': value});\n};\n","exports.parse = require('./lib/parse');\nexports.stringify = require('./lib/stringify');\n","var json = typeof JSON !== 'undefined' ? JSON : require('jsonify');\n\nmodule.exports = function (obj, opts) {\n    if (!opts) opts = {};\n    if (typeof opts === 'function') opts = { cmp: opts };\n    var space = opts.space || '';\n    if (typeof space === 'number') space = Array(space+1).join(' ');\n    var cycles = (typeof opts.cycles === 'boolean') ? opts.cycles : false;\n    var replacer = opts.replacer || function(key, value) { return value; };\n\n    var cmp = opts.cmp && (function (f) {\n        return function (node) {\n            return function (a, b) {\n                var aobj = { key: a, value: node[a] };\n                var bobj = { key: b, value: node[b] };\n                return f(aobj, bobj);\n            };\n        };\n    })(opts.cmp);\n\n    var seen = [];\n    return (function stringify (parent, key, node, level) {\n        var indent = space ? ('\\n' + new Array(level + 1).join(space)) : '';\n        var colonSeparator = space ? ': ' : ':';\n\n        if (node && node.toJSON && typeof node.toJSON === 'function') {\n            node = node.toJSON();\n        }\n\n        node = replacer.call(parent, key, node);\n\n        if (node === undefined) {\n            return;\n        }\n        if (typeof node !== 'object' || node === null) {\n            return json.stringify(node);\n        }\n        if (isArray(node)) {\n            var out = [];\n            for (var i = 0; i < node.length; i++) {\n                var item = stringify(node, i, node[i], level+1) || json.stringify(null);\n                out.push(indent + space + item);\n            }\n            return '[' + out.join(',') + indent + ']';\n        }\n        else {\n            if (seen.indexOf(node) !== -1) {\n                if (cycles) return json.stringify('__cycle__');\n                throw new TypeError('Converting circular structure to JSON');\n            }\n            else seen.push(node);\n\n            var keys = objectKeys(node).sort(cmp && cmp(node));\n            var out = [];\n            for (var i = 0; i < keys.length; i++) {\n                var key = keys[i];\n                var value = stringify(node, key, node[key], level+1);\n\n                if(!value) continue;\n\n                var keyValue = json.stringify(key)\n                    + colonSeparator\n                    + value;\n                ;\n                out.push(indent + space + keyValue);\n            }\n            seen.splice(seen.indexOf(node), 1);\n            return '{' + out.join(',') + indent + '}';\n        }\n    })({ '': obj }, '', obj, 0);\n};\n\nvar isArray = Array.isArray || function (x) {\n    return {}.toString.call(x) === '[object Array]';\n};\n\nvar objectKeys = Object.keys || function (obj) {\n    var has = Object.prototype.hasOwnProperty || function () { return true };\n    var keys = [];\n    for (var key in obj) {\n        if (has.call(obj, key)) keys.push(key);\n    }\n    return keys;\n};\n","export function isLogicalOr(op) {\n    return !!op.or;\n}\nexport function isLogicalAnd(op) {\n    return !!op.and;\n}\nexport function isLogicalNot(op) {\n    return !!op.not;\n}\nexport function forEachLeaf(op, fn) {\n    if (isLogicalNot(op)) {\n        forEachLeaf(op.not, fn);\n    }\n    else if (isLogicalAnd(op)) {\n        for (var _i = 0, _a = op.and; _i < _a.length; _i++) {\n            var subop = _a[_i];\n            forEachLeaf(subop, fn);\n        }\n    }\n    else if (isLogicalOr(op)) {\n        for (var _b = 0, _c = op.or; _b < _c.length; _b++) {\n            var subop = _c[_b];\n            forEachLeaf(subop, fn);\n        }\n    }\n    else {\n        fn(op);\n    }\n}\nexport function normalizeLogicalOperand(op, normalizer) {\n    if (isLogicalNot(op)) {\n        return { not: normalizeLogicalOperand(op.not, normalizer) };\n    }\n    else if (isLogicalAnd(op)) {\n        return { and: op.and.map(function (o) { return normalizeLogicalOperand(o, normalizer); }) };\n    }\n    else if (isLogicalOr(op)) {\n        return { or: op.or.map(function (o) { return normalizeLogicalOperand(o, normalizer); }) };\n    }\n    else {\n        return normalizer(op);\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9naWNhbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9sb2dpY2FsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWNBLE1BQU0sc0JBQXNCLEVBQXVCO0lBQ2pELE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUM7QUFDakIsQ0FBQztBQUVELE1BQU0sdUJBQXVCLEVBQXVCO0lBQ2xELE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUM7QUFDbEIsQ0FBQztBQUVELE1BQU0sdUJBQXVCLEVBQXVCO0lBQ2xELE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUM7QUFDbEIsQ0FBQztBQUVELE1BQU0sc0JBQXlCLEVBQXFCLEVBQUUsRUFBbUI7SUFDdkUsSUFBSSxZQUFZLENBQUMsRUFBRSxDQUFDLEVBQUU7UUFDcEIsV0FBVyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLENBQUM7S0FDekI7U0FBTSxJQUFJLFlBQVksQ0FBQyxFQUFFLENBQUMsRUFBRTtRQUMzQixLQUFvQixVQUFNLEVBQU4sS0FBQSxFQUFFLENBQUMsR0FBRyxFQUFOLGNBQU0sRUFBTixJQUFNLEVBQUU7WUFBdkIsSUFBTSxLQUFLLFNBQUE7WUFDZCxXQUFXLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1NBQ3hCO0tBQ0Y7U0FBTSxJQUFJLFdBQVcsQ0FBQyxFQUFFLENBQUMsRUFBRTtRQUMxQixLQUFvQixVQUFLLEVBQUwsS0FBQSxFQUFFLENBQUMsRUFBRSxFQUFMLGNBQUssRUFBTCxJQUFLLEVBQUU7WUFBdEIsSUFBTSxLQUFLLFNBQUE7WUFDZCxXQUFXLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1NBQ3hCO0tBQ0Y7U0FBTTtRQUNMLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztLQUNSO0FBQ0gsQ0FBQztBQUVELE1BQU0sa0NBQXFDLEVBQXFCLEVBQUUsVUFBdUI7SUFDdkYsSUFBSSxZQUFZLENBQUMsRUFBRSxDQUFDLEVBQUU7UUFDcEIsT0FBTyxFQUFDLEdBQUcsRUFBRSx1QkFBdUIsQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLFVBQVUsQ0FBQyxFQUFDLENBQUM7S0FDM0Q7U0FBTSxJQUFJLFlBQVksQ0FBQyxFQUFFLENBQUMsRUFBRTtRQUMzQixPQUFPLEVBQUMsR0FBRyxFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsdUJBQXVCLENBQUMsQ0FBQyxFQUFFLFVBQVUsQ0FBQyxFQUF0QyxDQUFzQyxDQUFDLEVBQUMsQ0FBQztLQUN2RTtTQUFNLElBQUksV0FBVyxDQUFDLEVBQUUsQ0FBQyxFQUFFO1FBQzFCLE9BQU8sRUFBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsVUFBQSxDQUFDLElBQUksT0FBQSx1QkFBdUIsQ0FBQyxDQUFDLEVBQUUsVUFBVSxDQUFDLEVBQXRDLENBQXNDLENBQUMsRUFBQyxDQUFDO0tBQ3JFO1NBQU07UUFDTCxPQUFPLFVBQVUsQ0FBQyxFQUFFLENBQUMsQ0FBQztLQUN2QjtBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgdHlwZSBMb2dpY2FsT3BlcmFuZDxUPiA9IExvZ2ljYWxOb3Q8VD4gfCBMb2dpY2FsQW5kPFQ+IHwgTG9naWNhbE9yPFQ+IHwgVDtcblxuZXhwb3J0IGludGVyZmFjZSBMb2dpY2FsT3I8VD4ge1xuICBvcjogTG9naWNhbE9wZXJhbmQ8VD5bXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMb2dpY2FsQW5kPFQ+IHtcbiAgYW5kOiBMb2dpY2FsT3BlcmFuZDxUPltdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIExvZ2ljYWxOb3Q8VD4ge1xuICBub3Q6IExvZ2ljYWxPcGVyYW5kPFQ+O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNMb2dpY2FsT3Iob3A6IExvZ2ljYWxPcGVyYW5kPGFueT4pOiBvcCBpcyBMb2dpY2FsT3I8YW55PiB7XG4gIHJldHVybiAhIW9wLm9yO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNMb2dpY2FsQW5kKG9wOiBMb2dpY2FsT3BlcmFuZDxhbnk+KTogb3AgaXMgTG9naWNhbEFuZDxhbnk+IHtcbiAgcmV0dXJuICEhb3AuYW5kO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNMb2dpY2FsTm90KG9wOiBMb2dpY2FsT3BlcmFuZDxhbnk+KTogb3AgaXMgTG9naWNhbE5vdDxhbnk+IHtcbiAgcmV0dXJuICEhb3Aubm90O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZm9yRWFjaExlYWY8VD4ob3A6IExvZ2ljYWxPcGVyYW5kPFQ+LCBmbjogKG9wOiBUKSA9PiB2b2lkKSB7XG4gIGlmIChpc0xvZ2ljYWxOb3Qob3ApKSB7XG4gICAgZm9yRWFjaExlYWYob3Aubm90LCBmbik7XG4gIH0gZWxzZSBpZiAoaXNMb2dpY2FsQW5kKG9wKSkge1xuICAgIGZvciAoY29uc3Qgc3Vib3Agb2Ygb3AuYW5kKSB7XG4gICAgICBmb3JFYWNoTGVhZihzdWJvcCwgZm4pO1xuICAgIH1cbiAgfSBlbHNlIGlmIChpc0xvZ2ljYWxPcihvcCkpIHtcbiAgICBmb3IgKGNvbnN0IHN1Ym9wIG9mIG9wLm9yKSB7XG4gICAgICBmb3JFYWNoTGVhZihzdWJvcCwgZm4pO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmbihvcCk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZUxvZ2ljYWxPcGVyYW5kPFQ+KG9wOiBMb2dpY2FsT3BlcmFuZDxUPiwgbm9ybWFsaXplcjogKG86IFQpID0+IFQpOiBMb2dpY2FsT3BlcmFuZDxUPiB7XG4gIGlmIChpc0xvZ2ljYWxOb3Qob3ApKSB7XG4gICAgcmV0dXJuIHtub3Q6IG5vcm1hbGl6ZUxvZ2ljYWxPcGVyYW5kKG9wLm5vdCwgbm9ybWFsaXplcil9O1xuICB9IGVsc2UgaWYgKGlzTG9naWNhbEFuZChvcCkpIHtcbiAgICByZXR1cm4ge2FuZDogb3AuYW5kLm1hcChvID0+IG5vcm1hbGl6ZUxvZ2ljYWxPcGVyYW5kKG8sIG5vcm1hbGl6ZXIpKX07XG4gIH0gZWxzZSBpZiAoaXNMb2dpY2FsT3Iob3ApKSB7XG4gICAgcmV0dXJuIHtvcjogb3Aub3IubWFwKG8gPT4gbm9ybWFsaXplTG9naWNhbE9wZXJhbmQobywgbm9ybWFsaXplcikpfTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbm9ybWFsaXplcihvcCk7XG4gIH1cbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport stableStringify from 'json-stable-stringify';\nimport { isArray, isNumber, isString, splitAccessPath, stringValue } from 'vega-util';\nimport { isLogicalAnd, isLogicalNot, isLogicalOr } from './logical';\n/**\n * Creates an object composed of the picked object properties.\n *\n * Example:  (from lodash)\n *\n * var object = {'a': 1, 'b': '2', 'c': 3};\n * pick(object, ['a', 'c']);\n * // → {'a': 1, 'c': 3}\n *\n */\nexport function pick(obj, props) {\n    var copy = {};\n    for (var _i = 0, props_1 = props; _i < props_1.length; _i++) {\n        var prop = props_1[_i];\n        if (obj.hasOwnProperty(prop)) {\n            copy[prop] = obj[prop];\n        }\n    }\n    return copy;\n}\n/**\n * The opposite of _.pick; this method creates an object composed of the own\n * and inherited enumerable string keyed properties of object that are not omitted.\n */\nexport function omit(obj, props) {\n    var copy = tslib_1.__assign({}, obj);\n    for (var _i = 0, props_2 = props; _i < props_2.length; _i++) {\n        var prop = props_2[_i];\n        delete copy[prop];\n    }\n    return copy;\n}\n/**\n * Converts any object into a string representation that can be consumed by humans.\n */\nexport var stringify = stableStringify;\n/**\n * Converts any object into a string of limited size, or a number.\n */\nexport function hash(a) {\n    if (isNumber(a)) {\n        return a;\n    }\n    var str = isString(a) ? a : stableStringify(a);\n    // short strings can be used as hash directly, longer strings are hashed to reduce memory usage\n    if (str.length < 100) {\n        return str;\n    }\n    // from http://werxltd.com/wp/2010/05/13/javascript-implementation-of-javas-string-hashcode-method/\n    var h = 0;\n    for (var i = 0; i < str.length; i++) {\n        var char = str.charCodeAt(i);\n        h = ((h << 5) - h) + char;\n        h = h & h; // Convert to 32bit integer\n    }\n    return h;\n}\nexport function contains(array, item) {\n    return array.indexOf(item) > -1;\n}\n/** Returns the array without the elements in item */\nexport function without(array, excludedItems) {\n    return array.filter(function (item) { return !contains(excludedItems, item); });\n}\nexport function union(array, other) {\n    return array.concat(without(other, array));\n}\n/**\n * Returns true if any item returns true.\n */\nexport function some(arr, f) {\n    var i = 0;\n    for (var k = 0; k < arr.length; k++) {\n        if (f(arr[k], k, i++)) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Returns true if all items return true.\n */\nexport function every(arr, f) {\n    var i = 0;\n    for (var k = 0; k < arr.length; k++) {\n        if (!f(arr[k], k, i++)) {\n            return false;\n        }\n    }\n    return true;\n}\nexport function flatten(arrays) {\n    return [].concat.apply([], arrays);\n}\n/**\n * recursively merges src into dest\n */\nexport function mergeDeep(dest) {\n    var src = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        src[_i - 1] = arguments[_i];\n    }\n    for (var _a = 0, src_1 = src; _a < src_1.length; _a++) {\n        var s = src_1[_a];\n        dest = deepMerge_(dest, s);\n    }\n    return dest;\n}\n// recursively merges src into dest\nfunction deepMerge_(dest, src) {\n    if (typeof src !== 'object' || src === null) {\n        return dest;\n    }\n    for (var p in src) {\n        if (!src.hasOwnProperty(p)) {\n            continue;\n        }\n        if (src[p] === undefined) {\n            continue;\n        }\n        if (typeof src[p] !== 'object' || isArray(src[p]) || src[p] === null) {\n            dest[p] = src[p];\n        }\n        else if (typeof dest[p] !== 'object' || dest[p] === null) {\n            dest[p] = mergeDeep(isArray(src[p].constructor) ? [] : {}, src[p]);\n        }\n        else {\n            mergeDeep(dest[p], src[p]);\n        }\n    }\n    return dest;\n}\nexport function unique(values, f) {\n    var results = [];\n    var u = {};\n    var v;\n    for (var _i = 0, values_1 = values; _i < values_1.length; _i++) {\n        var val = values_1[_i];\n        v = f(val);\n        if (v in u) {\n            continue;\n        }\n        u[v] = 1;\n        results.push(val);\n    }\n    return results;\n}\n/**\n * Returns true if the two dictionaries disagree. Applies only to defined values.\n */\nexport function differ(dict, other) {\n    for (var key in dict) {\n        if (dict.hasOwnProperty(key)) {\n            if (other[key] && dict[key] && other[key] !== dict[key]) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nexport function hasIntersection(a, b) {\n    for (var key in a) {\n        if (key in b) {\n            return true;\n        }\n    }\n    return false;\n}\nexport function isNumeric(num) {\n    return !isNaN(num);\n}\nexport function differArray(array, other) {\n    if (array.length !== other.length) {\n        return true;\n    }\n    array.sort();\n    other.sort();\n    for (var i = 0; i < array.length; i++) {\n        if (other[i] !== array[i]) {\n            return true;\n        }\n    }\n    return false;\n}\n// This is a stricter version of Object.keys but with better types. See https://github.com/Microsoft/TypeScript/pull/12253#issuecomment-263132208\nexport var keys = Object.keys;\nexport function vals(x) {\n    var _vals = [];\n    for (var k in x) {\n        if (x.hasOwnProperty(k)) {\n            _vals.push(x[k]);\n        }\n    }\n    return _vals;\n}\nexport function flagKeys(f) {\n    return keys(f);\n}\nexport function duplicate(obj) {\n    return JSON.parse(JSON.stringify(obj));\n}\nexport function isBoolean(b) {\n    return b === true || b === false;\n}\n/**\n * Convert a string into a valid variable name\n */\nexport function varName(s) {\n    // Replace non-alphanumeric characters (anything besides a-zA-Z0-9_) with _\n    var alphanumericS = s.replace(/\\W/g, '_');\n    // Add _ if the string has leading numbers.\n    return (s.match(/^\\d+/) ? '_' : '') + alphanumericS;\n}\nexport function logicalExpr(op, cb) {\n    if (isLogicalNot(op)) {\n        return '!(' + logicalExpr(op.not, cb) + ')';\n    }\n    else if (isLogicalAnd(op)) {\n        return '(' + op.and.map(function (and) { return logicalExpr(and, cb); }).join(') && (') + ')';\n    }\n    else if (isLogicalOr(op)) {\n        return '(' + op.or.map(function (or) { return logicalExpr(or, cb); }).join(') || (') + ')';\n    }\n    else {\n        return cb(op);\n    }\n}\n/**\n * Delete nested property of an object, and delete the ancestors of the property if they become empty.\n */\nexport function deleteNestedProperty(obj, orderedProps) {\n    if (orderedProps.length === 0) {\n        return true;\n    }\n    var prop = orderedProps.shift();\n    if (deleteNestedProperty(obj[prop], orderedProps)) {\n        delete obj[prop];\n    }\n    return Object.keys(obj).length === 0;\n}\nexport function titlecase(s) {\n    return s.charAt(0).toUpperCase() + s.substr(1);\n}\n/**\n * Converts a path to an access path with datum.\n * @param path The field name.\n * @param datum The string to use for `datum`.\n */\nexport function accessPathWithDatum(path, datum) {\n    if (datum === void 0) { datum = 'datum'; }\n    var pieces = splitAccessPath(path);\n    var prefixes = [];\n    for (var i = 1; i <= pieces.length; i++) {\n        var prefix = \"[\" + pieces.slice(0, i).map(stringValue).join('][') + \"]\";\n        prefixes.push(\"\" + datum + prefix);\n    }\n    return prefixes.join(' && ');\n}\n/**\n * Return access with datum to the falttened field.\n * @param path The field name.\n * @param datum The string to use for `datum`.\n */\nexport function flatAccessWithDatum(path, datum) {\n    if (datum === void 0) { datum = 'datum'; }\n    return datum + \"[\" + stringValue(splitAccessPath(path).join('.')) + \"]\";\n}\n/**\n * Replaces path accesses with access to non-nested field.\n * For example, `foo[\"bar\"].baz` becomes `foo\\\\.bar\\\\.baz`.\n */\nexport function replacePathInField(path) {\n    return \"\" + splitAccessPath(path).map(function (p) { return p.replace('.', '\\\\.'); }).join('\\\\.');\n}\n/**\n * Remove path accesses with access from field.\n * For example, `foo[\"bar\"].baz` becomes `foo.bar.baz`.\n */\nexport function removePathFromField(path) {\n    return \"\" + splitAccessPath(path).join('.');\n}\n/**\n * Count the depth of the path. Returns 1 for fields that are not nested.\n */\nexport function accessPathDepth(path) {\n    if (!path) {\n        return 0;\n    }\n    return splitAccessPath(path).length;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLGVBQWUsTUFBTSx1QkFBdUIsQ0FBQztBQUNwRCxPQUFPLEVBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsZUFBZSxFQUFFLFdBQVcsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUNwRixPQUFPLEVBQUMsWUFBWSxFQUFFLFlBQVksRUFBRSxXQUFXLEVBQWlCLE1BQU0sV0FBVyxDQUFDO0FBRWxGOzs7Ozs7Ozs7R0FTRztBQUNILE1BQU0sZUFBZSxHQUFXLEVBQUUsS0FBZTtJQUMvQyxJQUFNLElBQUksR0FBRyxFQUFFLENBQUM7SUFDaEIsS0FBbUIsVUFBSyxFQUFMLGVBQUssRUFBTCxtQkFBSyxFQUFMLElBQUssRUFBRTtRQUFyQixJQUFNLElBQUksY0FBQTtRQUNiLElBQUksR0FBRyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUM1QixJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ3hCO0tBQ0Y7SUFDRCxPQUFPLElBQUksQ0FBQztBQUNkLENBQUM7QUFFRDs7O0dBR0c7QUFDSCxNQUFNLGVBQWUsR0FBVyxFQUFFLEtBQWU7SUFDL0MsSUFBTSxJQUFJLHdCQUFPLEdBQUcsQ0FBQyxDQUFDO0lBQ3RCLEtBQW1CLFVBQUssRUFBTCxlQUFLLEVBQUwsbUJBQUssRUFBTCxJQUFLLEVBQUU7UUFBckIsSUFBTSxJQUFJLGNBQUE7UUFDYixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUNuQjtJQUNELE9BQU8sSUFBSSxDQUFDO0FBQ2QsQ0FBQztBQUVEOztHQUVHO0FBQ0gsTUFBTSxDQUFDLElBQU0sU0FBUyxHQUFHLGVBQWUsQ0FBQztBQUV6Qzs7R0FFRztBQUNILE1BQU0sZUFBZSxDQUFNO0lBQ3pCLElBQUksUUFBUSxDQUFD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S0FDcEM7SUFDRCxPQUFPLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDL0IsQ0FBQztBQUVEOzs7O0dBSUc7QUFDSCxNQUFNLDhCQUE4QixJQUFZLEVBQUUsS0FBYTtJQUFiLHNCQUFBLEVBQUEsZUFBYTtJQUM3RCxPQUFVLEtBQUssU0FBSSxXQUFXLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFHLENBQUM7QUFDckUsQ0FBQztBQUVEOzs7R0FHRztBQUNILE1BQU0sNkJBQTZCLElBQVk7SUFDN0MsT0FBTyxLQUFHLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxLQUFLLENBQUMsRUFBckIsQ0FBcUIsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUcsQ0FBQztBQUNoRixDQUFDO0FBRUQ7OztHQUdHO0FBQ0gsTUFBTSw4QkFBOEIsSUFBWTtJQUM5QyxPQUFPLEtBQUcsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUcsQ0FBQztBQUM5QyxDQUFDO0FBRUQ7O0dBRUc7QUFDSCxNQUFNLDBCQUEwQixJQUFZO0lBQzFDLElBQUksQ0FBQyxJQUFJLEVBQUU7UUFDVCxPQUFPLENBQUMsQ0FBQztLQUNWO0lBQ0QsT0FBTyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDO0FBQ3RDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgc3RhYmxlU3RyaW5naWZ5IGZyb20gJ2pzb24tc3RhYmxlLXN0cmluZ2lmeSc7XG5pbXBvcnQge2lzQXJyYXksIGlzTnVtYmVyLCBpc1N0cmluZywgc3BsaXRBY2Nlc3NQYXRoLCBzdHJpbmdWYWx1ZX0gZnJvbSAndmVnYS11dGlsJztcbmltcG9ydCB7aXNMb2dpY2FsQW5kLCBpc0xvZ2ljYWxOb3QsIGlzTG9naWNhbE9yLCBMb2dpY2FsT3BlcmFuZH0gZnJvbSAnLi9sb2dpY2FsJztcblxuLyoqXG4gKiBDcmVhdGVzIGFuIG9iamVjdCBjb21wb3NlZCBvZiB0aGUgcGlja2VkIG9iamVjdCBwcm9wZXJ0aWVzLlxuICpcbiAqIEV4YW1wbGU6ICAoZnJvbSBsb2Rhc2gpXG4gKlxuICogdmFyIG9iamVjdCA9IHsnYSc6IDEsICdiJzogJzInLCAnYyc6IDN9O1xuICogcGljayhvYmplY3QsIFsnYScsICdjJ10pO1xuICogLy8g4oaSIHsnYSc6IDEsICdjJzogM31cbiAqXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwaWNrKG9iajogb2JqZWN0LCBwcm9wczogc3RyaW5nW10pIHtcbiAgY29uc3QgY29weSA9IHt9O1xuICBmb3IgKGNvbnN0IHByb3Agb2YgcHJvcHMpIHtcbiAgICBpZiAob2JqLmhhc093blByb3BlcnR5KHByb3ApKSB7XG4gICAgICBjb3B5W3Byb3BdID0gb2JqW3Byb3BdO1xuICAgIH1cbiAgfVxuICByZXR1cm4gY29weTtcbn1cblxuLyoqXG4gKiBUaGUgb3Bwb3NpdGUgb2YgXy5waWNrOyB0aGlzIG1ldGhvZCBjcmVhdGVzIGFuIG9iamVjdCBjb21wb3NlZCBvZiB0aGUgb3duXG4gKiBhbmQgaW5oZXJpdGVkIGVudW1lcmFibGUgc3RyaW5nIGtleWVkIHByb3BlcnRpZXMgb2Ygb2JqZWN0IHRoYXQgYXJlIG5vdCBvbWl0dGVkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gb21pdChvYmo6IG9iamVjdCwgcHJvcHM6IHN0cmluZ1tdKSB7XG4gIGNvbnN0IGNvcHkgPSB7Li4ub2JqfTtcbiAgZm9yIChjb25zdCBwcm9wIG9mIHByb3BzKSB7XG4gICAgZGVsZXRlIGNvcHlbcHJvcF07XG4gIH1cbiAgcmV0dXJuIGNvcHk7XG59XG5cbi8qKlxuICogQ29udmVydHMgYW55IG9iamVjdCBpbnRvIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIHRoYXQgY2FuIGJlIGNvbnN1bWVkIGJ5IGh1bWFucy5cbiAqL1xuZXhwb3J0IGNvbnN0IHN0cmluZ2lmeSA9IHN0YWJsZVN0cmluZ2lmeTtcblxuLyoqXG4gKiBDb252ZXJ0cyBhbnkgb2JqZWN0IGludG8gYSBzdHJpbmcgb2YgbGltaXRlZCBzaXplLCBvciBhIG51bWJlci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc2goYTogYW55KSB7XG4gIGlmIChpc051bWJlcihhKSkge1xuICAgIHJldHVybiBhO1xuICB9XG5cbiAgY29uc3Qgc3RyID0gaXNTdHJpbmcoYSkgPyBhIDogc3RhYmxlU3RyaW5naWZ5KGEpO1xuXG4gIC8vIHNob3J0IHN0cmluZ3MgY2FuIGJlIHVzZWQgYXMgaGFzaCBkaXJlY3RseSwgbG9uZ2VyIHN0cmluZ3MgYXJlIGhhc2hlZCB0byByZWR1Y2UgbWVtb3J5IHVzYWdlXG4gIGlmIChzdHIubGVuZ3RoIDwgMTAwKSB7XG4gICAgcmV0dXJuIHN0cjtcbiAgfVxuXG4gIC8vIGZyb20gaHR0cDovL3dlcnhsdGQuY29tL3dwLzIwMTAvMDUvMTMvamF2YXNjcmlwdC1pbXBsZW1lbnRhdGlvbi1vZi1qYXZhcy1zdHJpbmctaGFzaGNvZGUtbWV0aG9kL1xuICBsZXQgaCA9IDA7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgY2hhciA9IHN0ci5jaGFyQ29kZUF0KGkpO1xuICAgIGggPSAoKGg8PDUpLWgpK2NoYXI7XG4gICAgaCA9IGggJiBoOyAvLyBDb252ZXJ0IHRvIDMyYml0IGludGVnZXJcbiAgfVxuICByZXR1cm4gaDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnRhaW5zPFQ+KGFycmF5OiBUW10sIGl0ZW06IFQpIHtcbiAgcmV0dXJuIGFycmF5LmluZGV4T2YoaXRlbSkgPiAtMTtcbn1cblxuLyoqIFJldHVybnMgdGhlIGFycmF5IHdpdGhvdXQgdGhlIGVsZW1lbnRzIGluIGl0ZW0gKi9cbmV4cG9ydCBmdW5jdGlvbiB3aXRob3V0PFQ+KGFycmF5OiBUW10sIGV4Y2x1ZGVkSXRlbXM6IFRbXSkge1xuICByZXR1cm4gYXJyYXkuZmlsdGVyKGl0ZW0gPT4gIWNvbnRhaW5zKGV4Y2x1ZGVkSXRlbXMsIGl0ZW0pKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVuaW9uPFQ+KGFycmF5OiBUW10sIG90aGVyOiBUW10pIHtcbiAgcmV0dXJuIGFycmF5LmNvbmNhdCh3aXRob3V0KG90aGVyLCBhcnJheSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBhbnkgaXRlbSByZXR1cm5zIHRydWUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzb21lPFQ+KGFycjogVFtdLCBmOiAoZDogVCwgaz86IGFueSwgaT86IGFueSkgPT4gYm9vbGVhbikge1xuICBsZXQgaSA9IDA7XG4gIGZvciAobGV0IGsgPSAwOyBrPGFyci5sZW5ndGg7IGsrKykge1xuICAgIGlmIChmKGFycltrXSwgaywgaSsrKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgYWxsIGl0ZW1zIHJldHVybiB0cnVlLlxuICovXG4gZXhwb3J0IGZ1bmN0aW9uIGV2ZXJ5PFQ+KGFycjogVFtdLCBmOiAoZDogVCwgaz86IGFueSwgaT86IGFueSkgPT4gYm9vbGVhbikge1xuICBsZXQgaSA9IDA7XG4gIGZvciAobGV0IGsgPSAwOyBrPGFyci5sZW5ndGg7IGsrKykge1xuICAgIGlmICghZihhcnJba10sIGssIGkrKykpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmbGF0dGVuKGFycmF5czogYW55W10pIHtcbiAgcmV0dXJuIFtdLmNvbmNhdC5hcHBseShbXSwgYXJyYXlzKTtcbn1cblxuLyoqXG4gKiByZWN1cnNpdmVseSBtZXJnZXMgc3JjIGludG8gZGVzdFxuICovXG5leHBvcnQgZnVuY3Rpb24gbWVyZ2VEZWVwPFQ+KGRlc3Q6IFQsIC4uLnNyYzogUGFydGlhbDxUPltdKTogVCB7XG4gIGZvciAoY29uc3QgcyBvZiBzcmMpIHtcbiAgICBkZXN0ID0gZGVlcE1lcmdlXyhkZXN0LCBzKTtcbiAgfVxuICByZXR1cm4gZGVzdDtcbn1cblxuLy8gcmVjdXJzaXZlbHkgbWVyZ2VzIHNyYyBpbnRvIGRlc3RcbmZ1bmN0aW9uIGRlZXBNZXJnZV8oZGVzdDogYW55LCBzcmM6IGFueSkge1xuICBpZiAodHlwZW9mIHNyYyAhPT0gJ29iamVjdCcgfHwgc3JjID09PSBudWxsKSB7XG4gICAgcmV0dXJuIGRlc3Q7XG4gIH1cblxuICBmb3IgKGNvbnN0IHAgaW4gc3JjKSB7XG4gICAgaWYgKCFzcmMuaGFzT3duUHJvcGVydHkocCkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoc3JjW3BdID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHNyY1twXSAhPT0gJ29iamVjdCcgfHwgaXNBcnJheShzcmNbcF0pIHx8IHNyY1twXSA9PT0gbnVsbCkge1xuICAgICAgZGVzdFtwXSA9IHNyY1twXTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBkZXN0W3BdICE9PSAnb2JqZWN0JyB8fCBkZXN0W3BdID09PSBudWxsKSB7XG4gICAgICBkZXN0W3BdID0gbWVyZ2VEZWVwKGlzQXJyYXkoc3JjW3BdLmNvbnN0cnVjdG9yKSA/IFtdIDoge30sIHNyY1twXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIG1lcmdlRGVlcChkZXN0W3BdLCBzcmNbcF0pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZGVzdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVuaXF1ZTxUPih2YWx1ZXM6IFRbXSwgZjogKGl0ZW06IFQpID0+IHN0cmluZyB8IG51bWJlcik6IFRbXSB7XG4gIGNvbnN0IHJlc3VsdHM6IGFueVtdID0gW107XG4gIGNvbnN0IHUgPSB7fTtcbiAgbGV0IHY6IHN0cmluZyB8IG51bWJlcjtcbiAgZm9yIChjb25zdCB2YWwgb2YgdmFsdWVzKSB7XG4gICAgdiA9IGYodmFsKTtcbiAgICBpZiAodiBpbiB1KSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgdVt2XSA9IDE7XG4gICAgcmVzdWx0cy5wdXNoKHZhbCk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHM7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGljdDxUPiB7XG4gIFtrZXk6IHN0cmluZ106IFQ7XG59XG5cbmV4cG9ydCB0eXBlIFN0cmluZ1NldCA9IERpY3Q8dHJ1ZT47XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSB0d28gZGljdGlvbmFyaWVzIGRpc2FncmVlLiBBcHBsaWVzIG9ubHkgdG8gZGVmaW5lZCB2YWx1ZXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkaWZmZXI8VD4oZGljdDogRGljdDxUPiwgb3RoZXI6IERpY3Q8VD4pIHtcbiAgZm9yIChjb25zdCBrZXkgaW4gZGljdCkge1xuICAgIGlmIChkaWN0Lmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgIGlmIChvdGhlcltrZXldICYmIGRpY3Rba2V5XSAmJiBvdGhlcltrZXldICE9PSBkaWN0W2tleV0pIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc0ludGVyc2VjdGlvbihhOiBTdHJpbmdTZXQsIGI6IFN0cmluZ1NldCkge1xuICBmb3IgKGNvbnN0IGtleSBpbiBhKSB7XG4gICAgaWYgKGtleSBpbiBiKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNOdW1lcmljKG51bTogc3RyaW5nIHwgbnVtYmVyKSB7XG4gIHJldHVybiAhaXNOYU4obnVtIGFzIGFueSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkaWZmZXJBcnJheTxUPihhcnJheTogVFtdLCBvdGhlcjogVFtdKSB7XG4gIGlmIChhcnJheS5sZW5ndGggIT09IG90aGVyLmxlbmd0aCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgYXJyYXkuc29ydCgpO1xuICBvdGhlci5zb3J0KCk7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheS5sZW5ndGg7IGkrKykge1xuICAgIGlmIChvdGhlcltpXSAhPT0gYXJyYXlbaV0pIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBmYWxzZTtcbn1cblxuLy8gVGhpcyBpcyBhIHN0cmljdGVyIHZlcnNpb24gb2YgT2JqZWN0LmtleXMgYnV0IHdpdGggYmV0dGVyIHR5cGVzLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL01pY3Jvc29mdC9UeXBlU2NyaXB0L3B1bGwvMTIyNTMjaXNzdWVjb21tZW50LTI2MzEzMjIwOFxuZXhwb3J0IGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyBhcyA8VD4obzogVCkgPT4gKEV4dHJhY3Q8a2V5b2YgVCwgc3RyaW5nPilbXTtcblxuZXhwb3J0IGZ1bmN0aW9uIHZhbHM8VD4oeDoge1trZXk6IHN0cmluZ106IFR9KTogVFtdIHtcbiAgY29uc3QgX3ZhbHM6IFRbXSA9IFtdO1xuICBmb3IgKGNvbnN0IGsgaW4geCkge1xuICAgIGlmICh4Lmhhc093blByb3BlcnR5KGspKSB7XG4gICAgICBfdmFscy5wdXNoKHhba10pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gX3ZhbHM7XG59XG5cbi8vIFVzaW5nIG1hcHBlZCB0eXBlIHRvIGRlY2xhcmUgYSBjb2xsZWN0IG9mIGZsYWdzIGZvciBhIHN0cmluZyBsaXRlcmFsIHR5cGUgU1xuLy8gaHR0cHM6Ly93d3cudHlwZXNjcmlwdGxhbmcub3JnL2RvY3MvaGFuZGJvb2svYWR2YW5jZWQtdHlwZXMuaHRtbCNtYXBwZWQtdHlwZXNcbmV4cG9ydCB0eXBlIEZsYWc8UyBleHRlbmRzIHN0cmluZz4gPSB7XG4gIFtLIGluIFNdOiAxXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZmxhZ0tleXM8UyBleHRlbmRzIHN0cmluZz4oZjogRmxhZzxTPik6IFNbXSB7XG4gIHJldHVybiBrZXlzKGYpIGFzIFNbXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGR1cGxpY2F0ZTxUPihvYmo6IFQpOiBUIHtcbiAgcmV0dXJuIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkob2JqKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0Jvb2xlYW4oYjogYW55KTogYiBpcyBib29sZWFuIHtcbiAgcmV0dXJuIGIgPT09IHRydWUgfHwgYiA9PT0gZmFsc2U7XG59XG5cbi8qKlxuICogQ29udmVydCBhIHN0cmluZyBpbnRvIGEgdmFsaWQgdmFyaWFibGUgbmFtZVxuICovXG5leHBvcnQgZnVuY3Rpb24gdmFyTmFtZShzOiBzdHJpbmcpOiBzdHJpbmcge1xuICAvLyBSZXBsYWNlIG5vbi1hbHBoYW51bWVyaWMgY2hhcmFjdGVycyAoYW55dGhpbmcgYmVzaWRlcyBhLXpBLVowLTlfKSB3aXRoIF9cbiAgY29uc3QgYWxwaGFudW1lcmljUyA9IHMucmVwbGFjZSgvXFxXL2csICdfJyk7XG5cbiAgLy8gQWRkIF8gaWYgdGhlIHN0cmluZyBoYXMgbGVhZGluZyBudW1iZXJzLlxuICByZXR1cm4gKHMubWF0Y2goL15cXGQrLykgPyAnXycgOiAnJykgKyBhbHBoYW51bWVyaWNTO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbG9naWNhbEV4cHI8VD4ob3A6IExvZ2ljYWxPcGVyYW5kPFQ+LCBjYjogRnVuY3Rpb24pOiBzdHJpbmcge1xuICBpZiAoaXNMb2dpY2FsTm90KG9wKSkge1xuICAgIHJldHVybiAnISgnICsgbG9naWNhbEV4cHIob3Aubm90LCBjYikgKyAnKSc7XG4gIH0gZWxzZSBpZiAoaXNMb2dpY2FsQW5kKG9wKSkge1xuICAgIHJldHVybiAnKCcgKyBvcC5hbmQubWFwKChhbmQ6IExvZ2ljYWxPcGVyYW5kPFQ+KSA9PiBsb2dpY2FsRXhwcihhbmQsIGNiKSkuam9pbignKSAmJiAoJykgKyAnKSc7XG4gIH0gZWxzZSBpZiAoaXNMb2dpY2FsT3Iob3ApKSB7XG4gICAgcmV0dXJuICcoJyArIG9wLm9yLm1hcCgob3I6IExvZ2ljYWxPcGVyYW5kPFQ+KSA9PiBsb2dpY2FsRXhwcihvciwgY2IpKS5qb2luKCcpIHx8ICgnKSArICcpJztcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gY2Iob3ApO1xuICB9XG59XG5cbi8vIE9taXQgZnJvbSBodHRwOi8vaWRlYXNpbnRvc29mdHdhcmUuY29tL3R5cGVzY3JpcHQtYWR2YW5jZWQtdHJpY2tzL1xuZXhwb3J0IHR5cGUgRGlmZjxUIGV4dGVuZHMgc3RyaW5nIHwgbnVtYmVyIHwgc3ltYm9sLCBVIGV4dGVuZHMgc3RyaW5nIHwgbnVtYmVyIHwgc3ltYm9sPiA9ICh7W1AgaW4gVF06IFAgfSAmIHtbUCBpbiBVXTogbmV2ZXIgfSAmIHsgW3g6IHN0cmluZ106IG5ldmVyIH0pW1RdO1xuZXhwb3J0IHR5cGUgT21pdDxULCBLIGV4dGVuZHMga2V5b2YgVD4gPSB7W1AgaW4gRGlmZjxrZXlvZiBULCBLPl06IFRbUF19O1xuXG4vKipcbiAqIERlbGV0ZSBuZXN0ZWQgcHJvcGVydHkgb2YgYW4gb2JqZWN0LCBhbmQgZGVsZXRlIHRoZSBhbmNlc3RvcnMgb2YgdGhlIHByb3BlcnR5IGlmIHRoZXkgYmVjb21lIGVtcHR5LlxuICovXG5leHBvcnQgZnVuY3Rpb24gZGVsZXRlTmVzdGVkUHJvcGVydHkob2JqOiBhbnksIG9yZGVyZWRQcm9wczogc3RyaW5nW10pIHtcbiAgaWYgKG9yZGVyZWRQcm9wcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBjb25zdCBwcm9wID0gb3JkZXJlZFByb3BzLnNoaWZ0KCk7XG4gIGlmIChkZWxldGVOZXN0ZWRQcm9wZXJ0eShvYmpbcHJvcF0sIG9yZGVyZWRQcm9wcykpIHtcbiAgICBkZWxldGUgb2JqW3Byb3BdO1xuICB9XG4gIHJldHVybiBPYmplY3Qua2V5cyhvYmopLmxlbmd0aCA9PT0gMDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRpdGxlY2FzZShzOiBzdHJpbmcpIHtcbiAgcmV0dXJuIHMuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzLnN1YnN0cigxKTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhIHBhdGggdG8gYW4gYWNjZXNzIHBhdGggd2l0aCBkYXR1bS5cbiAqIEBwYXJhbSBwYXRoIFRoZSBmaWVsZCBuYW1lLlxuICogQHBhcmFtIGRhdHVtIFRoZSBzdHJpbmcgdG8gdXNlIGZvciBgZGF0dW1gLlxuICovXG5leHBvcnQgZnVuY3Rpb24gYWNjZXNzUGF0aFdpdGhEYXR1bShwYXRoOiBzdHJpbmcsIGRhdHVtPSdkYXR1bScpIHtcbiAgY29uc3QgcGllY2VzID0gc3BsaXRBY2Nlc3NQYXRoKHBhdGgpO1xuICBjb25zdCBwcmVmaXhlcyA9IFtdO1xuICBmb3IgKGxldCBpID0gMTsgaSA8PSBwaWVjZXMubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBwcmVmaXggPSBgWyR7cGllY2VzLnNsaWNlKDAsaSkubWFwKHN0cmluZ1ZhbHVlKS5qb2luKCddWycpfV1gO1xuICAgIHByZWZpeGVzLnB1c2goYCR7ZGF0dW19JHtwcmVmaXh9YCk7XG4gIH1cbiAgcmV0dXJuIHByZWZpeGVzLmpvaW4oJyAmJiAnKTtcbn1cblxuLyoqXG4gKiBSZXR1cm4gYWNjZXNzIHdpdGggZGF0dW0gdG8gdGhlIGZhbHR0ZW5lZCBmaWVsZC5cbiAqIEBwYXJhbSBwYXRoIFRoZSBmaWVsZCBuYW1lLlxuICogQHBhcmFtIGRhdHVtIFRoZSBzdHJpbmcgdG8gdXNlIGZvciBgZGF0dW1gLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZmxhdEFjY2Vzc1dpdGhEYXR1bShwYXRoOiBzdHJpbmcsIGRhdHVtPSdkYXR1bScpIHtcbiAgcmV0dXJuIGAke2RhdHVtfVske3N0cmluZ1ZhbHVlKHNwbGl0QWNjZXNzUGF0aChwYXRoKS5qb2luKCcuJykpfV1gO1xufVxuXG4vKipcbiAqIFJlcGxhY2VzIHBhdGggYWNjZXNzZXMgd2l0aCBhY2Nlc3MgdG8gbm9uLW5lc3RlZCBmaWVsZC5cbiAqIEZvciBleGFtcGxlLCBgZm9vW1wiYmFyXCJdLmJhemAgYmVjb21lcyBgZm9vXFxcXC5iYXJcXFxcLmJhemAuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlUGF0aEluRmllbGQocGF0aDogc3RyaW5nKSB7XG4gIHJldHVybiBgJHtzcGxpdEFjY2Vzc1BhdGgocGF0aCkubWFwKHAgPT4gcC5yZXBsYWNlKCcuJywgJ1xcXFwuJykpLmpvaW4oJ1xcXFwuJyl9YDtcbn1cblxuLyoqXG4gKiBSZW1vdmUgcGF0aCBhY2Nlc3NlcyB3aXRoIGFjY2VzcyBmcm9tIGZpZWxkLlxuICogRm9yIGV4YW1wbGUsIGBmb29bXCJiYXJcIl0uYmF6YCBiZWNvbWVzIGBmb28uYmFyLmJhemAuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVQYXRoRnJvbUZpZWxkKHBhdGg6IHN0cmluZykge1xuICByZXR1cm4gYCR7c3BsaXRBY2Nlc3NQYXRoKHBhdGgpLmpvaW4oJy4nKX1gO1xufVxuXG4vKipcbiAqIENvdW50IHRoZSBkZXB0aCBvZiB0aGUgcGF0aC4gUmV0dXJucyAxIGZvciBmaWVsZHMgdGhhdCBhcmUgbm90IG5lc3RlZC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFjY2Vzc1BhdGhEZXB0aChwYXRoOiBzdHJpbmcpIHtcbiAgaWYgKCFwYXRoKSB7XG4gICAgcmV0dXJuIDA7XG4gIH1cbiAgcmV0dXJuIHNwbGl0QWNjZXNzUGF0aChwYXRoKS5sZW5ndGg7XG59XG4iXX0=","import { toSet } from 'vega-util';\nimport { contains, flagKeys } from './util';\nvar AGGREGATE_OP_INDEX = {\n    argmax: 1,\n    argmin: 1,\n    average: 1,\n    count: 1,\n    distinct: 1,\n    max: 1,\n    mean: 1,\n    median: 1,\n    min: 1,\n    missing: 1,\n    q1: 1,\n    q3: 1,\n    ci0: 1,\n    ci1: 1,\n    stderr: 1,\n    stdev: 1,\n    stdevp: 1,\n    sum: 1,\n    valid: 1,\n    values: 1,\n    variance: 1,\n    variancep: 1,\n};\nexport var AGGREGATE_OPS = flagKeys(AGGREGATE_OP_INDEX);\nexport function isAggregateOp(a) {\n    return !!AGGREGATE_OP_INDEX[a];\n}\nexport var COUNTING_OPS = ['count', 'valid', 'missing', 'distinct'];\nexport function isCountingAggregateOp(aggregate) {\n    return aggregate && contains(COUNTING_OPS, aggregate);\n}\n/** Additive-based aggregation operations.  These can be applied to stack. */\nexport var SUM_OPS = [\n    'count',\n    'sum',\n    'distinct',\n    'valid',\n    'missing'\n];\n/**\n * Aggregation operators that always produce values within the range [domainMin, domainMax].\n */\nexport var SHARED_DOMAIN_OPS = [\n    'mean',\n    'average',\n    'median',\n    'q1',\n    'q3',\n    'min',\n    'max',\n];\nexport var SHARED_DOMAIN_OP_INDEX = toSet(SHARED_DOMAIN_OPS);\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWdncmVnYXRlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2FnZ3JlZ2F0ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQUMsS0FBSyxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBQ2hDLE9BQU8sRUFBQyxRQUFRLEVBQVEsUUFBUSxFQUFDLE1BQU0sUUFBUSxDQUFDO0FBRWhELElBQU0sa0JBQWtCLEdBQXNCO0lBQzVDLE1BQU0sRUFBRSxDQUFDO0lBQ1QsTUFBTSxFQUFFLENBQUM7SUFDVCxPQUFPLEVBQUUsQ0FBQztJQUNWLEtBQUssRUFBRSxDQUFDO0lBQ1IsUUFBUSxFQUFFLENBQUM7SUFDWCxHQUFHLEVBQUUsQ0FBQztJQUNOLElBQUksRUFBRSxDQUFDO0lBQ1AsTUFBTSxFQUFFLENBQUM7SUFDVCxHQUFHLEVBQUUsQ0FBQztJQUNOLE9BQU8sRUFBRSxDQUFDO0lBQ1YsRUFBRSxFQUFFLENBQUM7SUFDTCxFQUFFLEVBQUUsQ0FBQztJQUNMLEdBQUcsRUFBRSxDQUFDO0lBQ04sR0FBRyxFQUFFLENBQUM7SUFDTixNQUFNLEVBQUUsQ0FBQztJQUNULEtBQUssRUFBRSxDQUFDO0lBQ1IsTUFBTSxFQUFFLENBQUM7SUFDVCxHQUFHLEVBQUUsQ0FBQztJQUNOLEtBQUssRUFBRSxDQUFDO0lBQ1IsTUFBTSxFQUFFLENBQUM7SUFDVCxRQUFRLEVBQUUsQ0FBQztJQUNYLFNBQVMsRUFBRSxDQUFDO0NBQ2IsQ0FBQztBQUVGLE1BQU0sQ0FBQyxJQUFNLGFBQWEsR0FBRyxRQUFRLENBQUMsa0JBQWtCLENBQUMsQ0FBQztBQUUxRCxNQUFNLHdCQUF3QixDQUFTO0lBQ3JDLE9BQU8sQ0FBQyxDQUFDLGtCQUFrQixDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2pDLENBQUM7QUFFRCxNQUFNLENBQUMsSUFBTSxZQUFZLEdBQWtCLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUUsVUFBVSxDQUFDLENBQUM7QUFFckYsTUFBTSxnQ0FBZ0MsU0FBaUI7SUFDckQsT0FBTyxTQUFTLElBQUksUUFBUSxDQUFDLFlBQVksRUFBRSxTQUFTLENBQUMsQ0FBQztBQUN4RCxDQUFDO0FBRUQsNkVBQTZFO0FBQzdFLE1BQU0sQ0FBQyxJQUFNLE9BQU8sR0FBa0I7SUFDbEMsT0FBTztJQUNQLEtBQUs7SUFDTCxVQUFVO0lBQ1YsT0FBTztJQUNQLFNBQVM7Q0FDWixDQUFDO0FBRUY7O0dBRUc7QUFDSCxNQUFNLENBQUMsSUFBTSxpQkFBaUIsR0FBa0I7SUFDNUMsTUFBTTtJQUNOLFNBQVM7SUFDVCxRQUFRO0lBQ1IsSUFBSTtJQUNKLElBQUk7SUFDSixLQUFLO0lBQ0wsS0FBSztDQUNSLENBQUM7QUFFRixNQUFNLENBQUMsSUFBTSxzQkFBc0IsR0FBRyxLQUFLLENBQUMsaUJBQWlCLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7QWdncmVnYXRlT3B9IGZyb20gJ3ZlZ2EnO1xuaW1wb3J0IHt0b1NldH0gZnJvbSAndmVnYS11dGlsJztcbmltcG9ydCB7Y29udGFpbnMsIEZsYWcsIGZsYWdLZXlzfSBmcm9tICcuL3V0aWwnO1xuXG5jb25zdCBBR0dSRUdBVEVfT1BfSU5ERVg6IEZsYWc8QWdncmVnYXRlT3A+ID0ge1xuICBhcmdtYXg6IDEsXG4gIGFyZ21pbjogMSxcbiAgYXZlcmFnZTogMSxcbiAgY291bnQ6IDEsXG4gIGRpc3RpbmN0OiAxLFxuICBtYXg6IDEsXG4gIG1lYW46IDEsXG4gIG1lZGlhbjogMSxcbiAgbWluOiAxLFxuICBtaXNzaW5nOiAxLFxuICBxMTogMSxcbiAgcTM6IDEsXG4gIGNpMDogMSxcbiAgY2kxOiAxLFxuICBzdGRlcnI6IDEsXG4gIHN0ZGV2OiAxLFxuICBzdGRldnA6IDEsXG4gIHN1bTogMSxcbiAgdmFsaWQ6IDEsXG4gIHZhbHVlczogMSxcbiAgdmFyaWFuY2U6IDEsXG4gIHZhcmlhbmNlcDogMSxcbn07XG5cbmV4cG9ydCBjb25zdCBBR0dSRUdBVEVfT1BTID0gZmxhZ0tleXMoQUdHUkVHQVRFX09QX0lOREVYKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGlzQWdncmVnYXRlT3AoYTogc3RyaW5nKTogYSBpcyBBZ2dyZWdhdGVPcCB7XG4gIHJldHVybiAhIUFHR1JFR0FURV9PUF9JTkRFWFthXTtcbn1cblxuZXhwb3J0IGNvbnN0IENPVU5USU5HX09QUzogQWdncmVnYXRlT3BbXSA9IFsnY291bnQnLCAndmFsaWQnLCAnbWlzc2luZycsICdkaXN0aW5jdCddO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNDb3VudGluZ0FnZ3JlZ2F0ZU9wKGFnZ3JlZ2F0ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gIHJldHVybiBhZ2dyZWdhdGUgJiYgY29udGFpbnMoQ09VTlRJTkdfT1BTLCBhZ2dyZWdhdGUpO1xufVxuXG4vKiogQWRkaXRpdmUtYmFzZWQgYWdncmVnYXRpb24gb3BlcmF0aW9ucy4gIFRoZXNlIGNhbiBiZSBhcHBsaWVkIHRvIHN0YWNrLiAqL1xuZXhwb3J0IGNvbnN0IFNVTV9PUFM6IEFnZ3JlZ2F0ZU9wW10gPSBbXG4gICAgJ2NvdW50JyxcbiAgICAnc3VtJyxcbiAgICAnZGlzdGluY3QnLFxuICAgICd2YWxpZCcsXG4gICAgJ21pc3NpbmcnXG5dO1xuXG4vKipcbiAqIEFnZ3JlZ2F0aW9uIG9wZXJhdG9ycyB0aGF0IGFsd2F5cyBwcm9kdWNlIHZhbHVlcyB3aXRoaW4gdGhlIHJhbmdlIFtkb21haW5NaW4sIGRvbWFpbk1heF0uXG4gKi9cbmV4cG9ydCBjb25zdCBTSEFSRURfRE9NQUlOX09QUzogQWdncmVnYXRlT3BbXSA9IFtcbiAgICAnbWVhbicsXG4gICAgJ2F2ZXJhZ2UnLFxuICAgICdtZWRpYW4nLFxuICAgICdxMScsXG4gICAgJ3EzJyxcbiAgICAnbWluJyxcbiAgICAnbWF4Jyxcbl07XG5cbmV4cG9ydCBjb25zdCBTSEFSRURfRE9NQUlOX09QX0lOREVYID0gdG9TZXQoU0hBUkVEX0RPTUFJTl9PUFMpO1xuIl19","import * as tslib_1 from \"tslib\";\nimport { flagKeys } from './util';\nexport var AXIS_PARTS = ['domain', 'grid', 'labels', 'ticks', 'title'];\n/**\n * A dictionary listing whether a certain axis property is applicable for only main axes or only grid axes.\n * (Properties not listed are applicable for both)\n */\nexport var AXIS_PROPERTY_TYPE = {\n    grid: 'grid',\n    gridScale: 'grid',\n    domain: 'main',\n    labels: 'main',\n    labelFlush: 'main',\n    labelOverlap: 'main',\n    minExtent: 'main',\n    maxExtent: 'main',\n    offset: 'main',\n    ticks: 'main',\n    title: 'main',\n    values: 'both',\n    scale: 'both',\n    zindex: 'both' // this is actually set afterward, so it doesn't matter\n};\nvar COMMON_AXIS_PROPERTIES_INDEX = {\n    orient: 1,\n    domain: 1,\n    format: 1,\n    grid: 1,\n    labelBound: 1,\n    labelFlush: 1,\n    labelPadding: 1,\n    labels: 1,\n    labelOverlap: 1,\n    maxExtent: 1,\n    minExtent: 1,\n    offset: 1,\n    position: 1,\n    tickCount: 1,\n    ticks: 1,\n    tickSize: 1,\n    title: 1,\n    titlePadding: 1,\n    values: 1,\n    zindex: 1,\n};\nvar AXIS_PROPERTIES_INDEX = tslib_1.__assign({}, COMMON_AXIS_PROPERTIES_INDEX, { encoding: 1, labelAngle: 1, titleMaxLength: 1 });\nvar VG_AXIS_PROPERTIES_INDEX = tslib_1.__assign({ scale: 1 }, COMMON_AXIS_PROPERTIES_INDEX, { gridScale: 1, encode: 1 });\nexport function isAxisProperty(prop) {\n    return !!AXIS_PROPERTIES_INDEX[prop];\n}\nexport var VG_AXIS_PROPERTIES = flagKeys(VG_AXIS_PROPERTIES_INDEX);\n// Export for dependent projects\nexport var AXIS_PROPERTIES = flagKeys(AXIS_PROPERTIES_INDEX);\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXhpcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9heGlzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFFQSxPQUFPLEVBQU8sUUFBUSxFQUFDLE1BQU0sUUFBUSxDQUFDO0FBMkV0QyxNQUFNLENBQUMsSUFBTSxVQUFVLEdBQWUsQ0FBQyxRQUFRLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFJckY7OztHQUdHO0FBQ0gsTUFBTSxDQUFDLElBQU0sa0JBQWtCLEdBRzNCO0lBQ0YsSUFBSSxFQUFFLE1BQU07SUFDWixTQUFTLEVBQUUsTUFBTTtJQUVqQixNQUFNLEVBQUUsTUFBTTtJQUNkLE1BQU0sRUFBRSxNQUFNO0lBQ2QsVUFBVSxFQUFFLE1BQU07SUFDbEIsWUFBWSxFQUFFLE1BQU07SUFDcEIsU0FBUyxFQUFFLE1BQU07SUFDakIsU0FBUyxFQUFFLE1BQU07SUFDakIsTUFBTSxFQUFFLE1BQU07SUFDZCxLQUFLLEVBQUUsTUFBTTtJQUNiLEtBQUssRUFBRSxNQUFNO0lBQ2IsTUFBTSxFQUFFLE1BQU07SUFFZCxLQUFLLEVBQUUsTUFBTTtJQUNiLE1BQU0sRUFBRSxNQUFNLENBQUMsdURBQXVEO0NBQ3ZFLENBQUM7QUFrQ0YsSUFBTSw0QkFBNEIsR0FBZ0M7SUFDaEUsTUFBTSxFQUFFLENBQUM7SUFFVCxNQUFNLEVBQUUsQ0FBQztJQUNULE1BQU0sRUFBRSxDQUFDO0lBQ1QsSUFBSSxFQUFFLENBQUM7SUFDUCxVQUFVLEVBQUUsQ0FBQztJQUNiLFVBQVUsRUFBRSxDQUFDO0lBQ2IsWUFBWSxFQUFFLENBQUM7SUFDZixNQUFNLEVBQUUsQ0FBQztJQUNULFlBQVksRUFBRSxDQUFDO0lBQ2YsU0FBUyxFQUFFLENBQUM7SUFDWixTQUFTLEVBQUUsQ0FBQztJQUNaLE1BQU0sRUFBRSxDQUFDO0lBQ1QsUUFBUSxFQUFFLENBQUM7SUFDWCxTQUFTLEVBQUUsQ0FBQztJQUNaLEtBQUssRUFBRSxDQUFDO0lBQ1IsUUFBUSxFQUFFLENBQUM7SUFDWCxLQUFLLEVBQUUsQ0FBQztJQUNSLFlBQVksRUFBRSxDQUFDO0lBQ2YsTUFBTSxFQUFFLENBQUM7SUFDVCxNQUFNLEVBQUUsQ0FBQztDQUNWLENBQUM7QUFFRixJQUFNLHFCQUFxQix3QkFDdEIsNEJBQTRCLElBQy9CLFFBQVEsRUFBRSxDQUFDLEVBQ1gsVUFBVSxFQUFFLENBQUMsRUFDYixjQUFjLEVBQUUsQ0FBQyxHQUNsQixDQUFDO0FBRUYsSUFBTSx3QkFBd0Isc0JBQzVCLEtBQUssRUFBRSxDQUFDLElBQ0wsNEJBQTRCLElBQy9CLFNBQVMsRUFBRSxDQUFDLEVBQ1osTUFBTSxFQUFFLENBQUMsR0FDVixDQUFDO0FBRUYsTUFBTSx5QkFBeUIsSUFBWTtJQUN6QyxPQUFPLENBQUMsQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN2QyxDQUFDO0FBRUQsTUFBTSxDQUFDLElBQU0sa0JBQWtCLEdBQUcsUUFBUSxDQUFDLHdCQUF3QixDQUFDLENBQUM7QUFFckUsZ0NBQWdDO0FBQ2hDLE1BQU0sQ0FBQyxJQUFNLGVBQWUsR0FBRyxRQUFRLENBQUMscUJBQXFCLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7RGF0ZVRpbWV9IGZyb20gJy4vZGF0ZXRpbWUnO1xuaW1wb3J0IHtHdWlkZSwgR3VpZGVFbmNvZGluZ0VudHJ5LCBWbE9ubHlHdWlkZUNvbmZpZ30gZnJvbSAnLi9ndWlkZSc7XG5pbXBvcnQge0ZsYWcsIGZsYWdLZXlzfSBmcm9tICcuL3V0aWwnO1xuaW1wb3J0IHtBeGlzT3JpZW50LCBWZ0F4aXMsIFZnQXhpc0Jhc2UsIFZnQXhpc0NvbmZpZ30gZnJvbSAnLi92ZWdhLnNjaGVtYSc7XG5cblxuXG5leHBvcnQgaW50ZXJmYWNlIEF4aXNDb25maWcgZXh0ZW5kcyBWZ0F4aXNDb25maWcsIFZsT25seUd1aWRlQ29uZmlnIHt9XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXhpcyBleHRlbmRzIFZnQXhpc0Jhc2UsIEd1aWRlIHtcbiAgLyoqXG4gICAqIFRoZSBvcmllbnRhdGlvbiBvZiB0aGUgYXhpcy4gT25lIG9mIGBcInRvcFwiYCwgYFwiYm90dG9tXCJgLCBgXCJsZWZ0XCJgIG9yIGBcInJpZ2h0XCJgLiBUaGUgb3JpZW50YXRpb24gY2FuIGJlIHVzZWQgdG8gZnVydGhlciBzcGVjaWFsaXplIHRoZSBheGlzIHR5cGUgKGUuZy4sIGEgeSBheGlzIG9yaWVudGVkIGZvciB0aGUgcmlnaHQgZWRnZSBvZiB0aGUgY2hhcnQpLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYFwiYm90dG9tXCJgIGZvciB4LWF4ZXMgYW5kIGBcImxlZnRcImAgZm9yIHktYXhlcy5cbiAgICovXG4gIG9yaWVudD86IEF4aXNPcmllbnQ7XG5cbiAgLyoqXG4gICAqIFRoZSBvZmZzZXQsIGluIHBpeGVscywgYnkgd2hpY2ggdG8gZGlzcGxhY2UgdGhlIGF4aXMgZnJvbSB0aGUgZWRnZSBvZiB0aGUgZW5jbG9zaW5nIGdyb3VwIG9yIGRhdGEgcmVjdGFuZ2xlLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gZGVyaXZlZCBmcm9tIHRoZSBbYXhpcyBjb25maWddKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvY29uZmlnLmh0bWwjZmFjZXQtc2NhbGUtY29uZmlnKSdzIGBvZmZzZXRgIChgMGAgYnkgZGVmYXVsdClcbiAgICovXG4gIG9mZnNldD86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIGFuY2hvciBwb3NpdGlvbiBvZiB0aGUgYXhpcyBpbiBwaXhlbHMuIEZvciB4LWF4aXMgd2l0aCB0b3Agb3IgYm90dG9tIG9yaWVudGF0aW9uLCB0aGlzIHNldHMgdGhlIGF4aXMgZ3JvdXAgeCBjb29yZGluYXRlLiBGb3IgeS1heGlzIHdpdGggbGVmdCBvciByaWdodCBvcmllbnRhdGlvbiwgdGhpcyBzZXRzIHRoZSBheGlzIGdyb3VwIHkgY29vcmRpbmF0ZS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlX186IGAwYFxuICAgKi9cbiAgcG9zaXRpb24/OiBudW1iZXI7XG5cblxuICAvKipcbiAgICogVGhlIHJvdGF0aW9uIGFuZ2xlIG9mIHRoZSBheGlzIGxhYmVscy5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGAtOTBgIGZvciBub21pbmFsIGFuZCBvcmRpbmFsIGZpZWxkczsgYDBgIG90aGVyd2lzZS5cbiAgICpcbiAgICogQG1pbmltdW0gLTM2MFxuICAgKiBAbWF4aW11bSAzNjBcbiAgICovXG4gIGxhYmVsQW5nbGU/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIEEgZGVzaXJlZCBudW1iZXIgb2YgdGlja3MsIGZvciBheGVzIHZpc3VhbGl6aW5nIHF1YW50aXRhdGl2ZSBzY2FsZXMuIFRoZSByZXN1bHRpbmcgbnVtYmVyIG1heSBiZSBkaWZmZXJlbnQgc28gdGhhdCB2YWx1ZXMgYXJlIFwibmljZVwiIChtdWx0aXBsZXMgb2YgMiwgNSwgMTApIGFuZCBsaWUgd2l0aGluIHRoZSB1bmRlcmx5aW5nIHNjYWxlJ3MgcmFuZ2UuXG4gICAqIEBtaW5pbXVtIDBcbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlX186IERldGVybWluZSB1c2luZyBhIGZvcm11bGEgYGNlaWwod2lkdGgvNDApYCBmb3IgeCBhbmQgYGNlaWwoaGVpZ2h0LzQwKWAgZm9yIHkuXG4gICAqL1xuICB0aWNrQ291bnQ/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIEV4cGxpY2l0bHkgc2V0IHRoZSB2aXNpYmxlIGF4aXMgdGljayB2YWx1ZXMuXG4gICAqL1xuICB2YWx1ZXM/OiBudW1iZXJbXSB8IERhdGVUaW1lW107XG5cbiAgLyoqXG4gICAqIEEgbm9uLXBvc2l0aXZlIGludGVnZXIgaW5kaWNhdGluZyB6LWluZGV4IG9mIHRoZSBheGlzLlxuICAgKiBJZiB6aW5kZXggaXMgMCwgYXhlcyBzaG91bGQgYmUgZHJhd24gYmVoaW5kIGFsbCBjaGFydCBlbGVtZW50cy5cbiAgICogVG8gcHV0IHRoZW0gaW4gZnJvbnQsIHVzZSBgXCJ6aW5kZXggPSAxXCJgLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDFgIChpbiBmcm9udCBvZiB0aGUgbWFya3MpIGZvciBhY3R1YWwgYXhpcyBhbmQgYDBgIChiZWhpbmQgdGhlIG1hcmtzKSBmb3IgZ3JpZHMuXG4gICAqXG4gICAqIEBUSlMtdHlwZSBpbnRlZ2VyXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIHppbmRleD86IG51bWJlcjtcblxuICAvKipcbiAgICogTWFyayBkZWZpbml0aW9ucyBmb3IgY3VzdG9tIGF4aXMgZW5jb2RpbmcuXG4gICAqXG4gICAqIEBoaWRlXG4gICAqL1xuICBlbmNvZGluZz86IEF4aXNFbmNvZGluZztcbn1cblxuXG5leHBvcnQgdHlwZSBBeGlzUGFydCA9IGtleW9mIEF4aXNFbmNvZGluZztcbmV4cG9ydCBjb25zdCBBWElTX1BBUlRTOiBBeGlzUGFydFtdID0gWydkb21haW4nLCAnZ3JpZCcsICdsYWJlbHMnLCAndGlja3MnLCAndGl0bGUnXTtcblxuXG5cbi8qKlxuICogQSBkaWN0aW9uYXJ5IGxpc3Rpbmcgd2hldGhlciBhIGNlcnRhaW4gYXhpcyBwcm9wZXJ0eSBpcyBhcHBsaWNhYmxlIGZvciBvbmx5IG1haW4gYXhlcyBvciBvbmx5IGdyaWQgYXhlcy5cbiAqIChQcm9wZXJ0aWVzIG5vdCBsaXN0ZWQgYXJlIGFwcGxpY2FibGUgZm9yIGJvdGgpXG4gKi9cbmV4cG9ydCBjb25zdCBBWElTX1BST1BFUlRZX1RZUEU6IHtcbiAgLy8gVXNpbmcgTWFwcGVkIFR5cGUgdG8gZGVjbGFyZSB0eXBlIChodHRwczovL3d3dy50eXBlc2NyaXB0bGFuZy5vcmcvZG9jcy9oYW5kYm9vay9hZHZhbmNlZC10eXBlcy5odG1sI21hcHBlZC10eXBlcylcbiAgW2sgaW4ga2V5b2YgVmdBeGlzXTogJ21haW4nIHwgJ2dyaWQnIHwgJ2JvdGgnXG59ID0ge1xuICBncmlkOiAnZ3JpZCcsXG4gIGdyaWRTY2FsZTogJ2dyaWQnLFxuXG4gIGRvbWFpbjogJ21haW4nLFxuICBsYWJlbHM6ICdtYWluJyxcbiAgbGFiZWxGbHVzaDogJ21haW4nLFxuICBsYWJlbE92ZXJsYXA6ICdtYWluJyxcbiAgbWluRXh0ZW50OiAnbWFpbicsXG4gIG1heEV4dGVudDogJ21haW4nLFxuICBvZmZzZXQ6ICdtYWluJyxcbiAgdGlja3M6ICdtYWluJyxcbiAgdGl0bGU6ICdtYWluJyxcbiAgdmFsdWVzOiAnYm90aCcsXG5cbiAgc2NhbGU6ICdib3RoJyxcbiAgemluZGV4OiAnYm90aCcgLy8gdGhpcyBpcyBhY3R1YWxseSBzZXQgYWZ0ZXJ3YXJkLCBzbyBpdCBkb2Vzbid0IG1hdHRlclxufTtcblxuZXhwb3J0IGludGVyZmFjZSBBeGlzRW5jb2Rpbmcge1xuICAvKipcbiAgICogQ3VzdG9tIGVuY29kaW5nIGZvciB0aGUgYXhpcyBjb250YWluZXIuXG4gICAqL1xuICBheGlzPzogR3VpZGVFbmNvZGluZ0VudHJ5O1xuXG4gIC8qKlxuICAgKiBDdXN0b20gZW5jb2RpbmcgZm9yIHRoZSBheGlzIGRvbWFpbiBydWxlIG1hcmsuXG4gICAqL1xuICBkb21haW4/OiBHdWlkZUVuY29kaW5nRW50cnk7XG5cbiAgLyoqXG4gICAqIEN1c3RvbSBlbmNvZGluZyBmb3IgYXhpcyBncmlkbGluZSBydWxlIG1hcmtzLlxuICAgKi9cbiAgZ3JpZD86IEd1aWRlRW5jb2RpbmdFbnRyeTtcblxuICAvKipcbiAgICogQ3VzdG9tIGVuY29kaW5nIGZvciBheGlzIGxhYmVsIHRleHQgbWFya3MuXG4gICAqL1xuICBsYWJlbHM/OiBHdWlkZUVuY29kaW5nRW50cnk7XG5cbiAgLyoqXG4gICAqIEN1c3RvbSBlbmNvZGluZyBmb3IgYXhpcyB0aWNrIHJ1bGUgbWFya3MuXG4gICAqL1xuICB0aWNrcz86IEd1aWRlRW5jb2RpbmdFbnRyeTtcblxuICAvKipcbiAgICogQ3VzdG9tIGVuY29kaW5nIGZvciB0aGUgYXhpcyB0aXRsZSB0ZXh0IG1hcmsuXG4gICAqL1xuICB0aXRsZT86IEd1aWRlRW5jb2RpbmdFbnRyeTtcbn1cblxuY29uc3QgQ09NTU9OX0FYSVNfUFJPUEVSVElFU19JTkRFWDogRmxhZzxrZXlvZiAoVmdBeGlzIHwgQXhpcyk+ID0ge1xuICBvcmllbnQ6IDEsIC8vIG90aGVyIHRoaW5ncyBjYW4gZGVwZW5kIG9uIG9yaWVudFxuXG4gIGRvbWFpbjogMSxcbiAgZm9ybWF0OiAxLFxuICBncmlkOiAxLFxuICBsYWJlbEJvdW5kOiAxLFxuICBsYWJlbEZsdXNoOiAxLFxuICBsYWJlbFBhZGRpbmc6IDEsXG4gIGxhYmVsczogMSxcbiAgbGFiZWxPdmVybGFwOiAxLFxuICBtYXhFeHRlbnQ6IDEsXG4gIG1pbkV4dGVudDogMSxcbiAgb2Zmc2V0OiAxLFxuICBwb3NpdGlvbjogMSxcbiAgdGlja0NvdW50OiAxLFxuICB0aWNrczogMSxcbiAgdGlja1NpemU6IDEsXG4gIHRpdGxlOiAxLFxuICB0aXRsZVBhZGRpbmc6IDEsXG4gIHZhbHVlczogMSxcbiAgemluZGV4OiAxLFxufTtcblxuY29uc3QgQVhJU19QUk9QRVJUSUVTX0lOREVYOiBGbGFnPGtleW9mIEF4aXM+ID0ge1xuICAuLi5DT01NT05fQVhJU19QUk9QRVJUSUVTX0lOREVYLFxuICBlbmNvZGluZzogMSxcbiAgbGFiZWxBbmdsZTogMSxcbiAgdGl0bGVNYXhMZW5ndGg6IDFcbn07XG5cbmNvbnN0IFZHX0FYSVNfUFJPUEVSVElFU19JTkRFWDogRmxhZzxrZXlvZiBWZ0F4aXM+ID0ge1xuICBzY2FsZTogMSxcbiAgLi4uQ09NTU9OX0FYSVNfUFJPUEVSVElFU19JTkRFWCxcbiAgZ3JpZFNjYWxlOiAxLFxuICBlbmNvZGU6IDFcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0F4aXNQcm9wZXJ0eShwcm9wOiBzdHJpbmcpOiBwcm9wIGlzIGtleW9mIEF4aXMge1xuICByZXR1cm4gISFBWElTX1BST1BFUlRJRVNfSU5ERVhbcHJvcF07XG59XG5cbmV4cG9ydCBjb25zdCBWR19BWElTX1BST1BFUlRJRVMgPSBmbGFnS2V5cyhWR19BWElTX1BST1BFUlRJRVNfSU5ERVgpO1xuXG4vLyBFeHBvcnQgZm9yIGRlcGVuZGVudCBwcm9qZWN0c1xuZXhwb3J0IGNvbnN0IEFYSVNfUFJPUEVSVElFUyA9IGZsYWdLZXlzKEFYSVNfUFJPUEVSVElFU19JTkRFWCk7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXhpc0NvbmZpZ01peGlucyB7XG4gIC8qKlxuICAgKiBBeGlzIGNvbmZpZ3VyYXRpb24sIHdoaWNoIGRldGVybWluZXMgZGVmYXVsdCBwcm9wZXJ0aWVzIGZvciBhbGwgYHhgIGFuZCBgeWAgW2F4ZXNdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvYXhpcy5odG1sKS4gRm9yIGEgZnVsbCBsaXN0IG9mIGF4aXMgY29uZmlndXJhdGlvbiBvcHRpb25zLCBwbGVhc2Ugc2VlIHRoZSBbY29ycmVzcG9uZGluZyBzZWN0aW9uIG9mIHRoZSBheGlzIGRvY3VtZW50YXRpb25dKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvYXhpcy5odG1sI2NvbmZpZykuXG4gICAqL1xuICBheGlzPzogQXhpc0NvbmZpZztcblxuICAvKipcbiAgICogWC1heGlzIHNwZWNpZmljIGNvbmZpZy5cbiAgICovXG4gIGF4aXNYPzogVmdBeGlzQ29uZmlnO1xuXG4gIC8qKlxuICAgKiBZLWF4aXMgc3BlY2lmaWMgY29uZmlnLlxuICAgKi9cbiAgYXhpc1k/OiBWZ0F4aXNDb25maWc7XG5cbiAgLyoqXG4gICAqIFNwZWNpZmljIGF4aXMgY29uZmlnIGZvciB5LWF4aXMgYWxvbmcgdGhlIGxlZnQgZWRnZSBvZiB0aGUgY2hhcnQuXG4gICAqL1xuICBheGlzTGVmdD86IFZnQXhpc0NvbmZpZztcblxuICAvKipcbiAgICogU3BlY2lmaWMgYXhpcyBjb25maWcgZm9yIHktYXhpcyBhbG9uZyB0aGUgcmlnaHQgZWRnZSBvZiB0aGUgY2hhcnQuXG4gICAqL1xuICBheGlzUmlnaHQ/OiBWZ0F4aXNDb25maWc7XG5cbiAgLyoqXG4gICAqIFNwZWNpZmljIGF4aXMgY29uZmlnIGZvciB4LWF4aXMgYWxvbmcgdGhlIHRvcCBlZGdlIG9mIHRoZSBjaGFydC5cbiAgICovXG4gIGF4aXNUb3A/OiBWZ0F4aXNDb25maWc7XG5cbiAgLyoqXG4gICAqIFNwZWNpZmljIGF4aXMgY29uZmlnIGZvciB4LWF4aXMgYWxvbmcgdGhlIGJvdHRvbSBlZGdlIG9mIHRoZSBjaGFydC5cbiAgICovXG4gIGF4aXNCb3R0b20/OiBWZ0F4aXNDb25maWc7XG5cbiAgLyoqXG4gICAqIFNwZWNpZmljIGF4aXMgY29uZmlnIGZvciBheGVzIHdpdGggXCJiYW5kXCIgc2NhbGVzLlxuICAgKi9cbiAgYXhpc0JhbmQ/OiBWZ0F4aXNDb25maWc7XG59XG4iXX0=","/*\n * Constants and utilities for encoding channels (Visual variables)\n * such as 'x', 'y', 'color'.\n */\nimport * as tslib_1 from \"tslib\";\nimport { flagKeys } from './util';\nexport var Channel;\n(function (Channel) {\n    // Facet\n    Channel.ROW = 'row';\n    Channel.COLUMN = 'column';\n    // Position\n    Channel.X = 'x';\n    Channel.Y = 'y';\n    Channel.X2 = 'x2';\n    Channel.Y2 = 'y2';\n    // Geo Position\n    Channel.LATITUDE = 'latitude';\n    Channel.LONGITUDE = 'longitude';\n    Channel.LATITUDE2 = 'latitude2';\n    Channel.LONGITUDE2 = 'longitude2';\n    // Mark property with scale\n    Channel.COLOR = 'color';\n    Channel.FILL = 'fill';\n    Channel.STROKE = 'stroke';\n    Channel.SHAPE = 'shape';\n    Channel.SIZE = 'size';\n    Channel.OPACITY = 'opacity';\n    // Non-scale channel\n    Channel.TEXT = 'text';\n    Channel.ORDER = 'order';\n    Channel.DETAIL = 'detail';\n    Channel.KEY = 'key';\n    Channel.TOOLTIP = 'tooltip';\n    Channel.HREF = 'href';\n})(Channel || (Channel = {}));\nexport var X = Channel.X;\nexport var Y = Channel.Y;\nexport var X2 = Channel.X2;\nexport var Y2 = Channel.Y2;\nexport var LATITUDE = Channel.LATITUDE;\nexport var LATITUDE2 = Channel.LATITUDE2;\nexport var LONGITUDE = Channel.LONGITUDE;\nexport var LONGITUDE2 = Channel.LONGITUDE2;\nexport var ROW = Channel.ROW;\nexport var COLUMN = Channel.COLUMN;\nexport var SHAPE = Channel.SHAPE;\nexport var SIZE = Channel.SIZE;\nexport var COLOR = Channel.COLOR;\nexport var FILL = Channel.FILL;\nexport var STROKE = Channel.STROKE;\nexport var TEXT = Channel.TEXT;\nexport var DETAIL = Channel.DETAIL;\nexport var KEY = Channel.KEY;\nexport var ORDER = Channel.ORDER;\nexport var OPACITY = Channel.OPACITY;\nexport var TOOLTIP = Channel.TOOLTIP;\nexport var HREF = Channel.HREF;\nexport var GEOPOSITION_CHANNEL_INDEX = {\n    longitude: 1,\n    longitude2: 1,\n    latitude: 1,\n    latitude2: 1,\n};\nexport var GEOPOSITION_CHANNELS = flagKeys(GEOPOSITION_CHANNEL_INDEX);\nvar UNIT_CHANNEL_INDEX = tslib_1.__assign({ \n    // position\n    x: 1, y: 1, x2: 1, y2: 1 }, GEOPOSITION_CHANNEL_INDEX, { \n    // color\n    color: 1, fill: 1, stroke: 1, \n    // other non-position with scale\n    opacity: 1, size: 1, shape: 1, \n    // channels without scales\n    order: 1, text: 1, detail: 1, key: 1, tooltip: 1, href: 1 });\nexport function isColorChannel(channel) {\n    return channel === 'color' || channel === 'fill' || channel === 'stroke';\n}\nvar FACET_CHANNEL_INDEX = {\n    row: 1,\n    column: 1\n};\nvar CHANNEL_INDEX = tslib_1.__assign({}, UNIT_CHANNEL_INDEX, FACET_CHANNEL_INDEX);\nexport var CHANNELS = flagKeys(CHANNEL_INDEX);\nvar _o = CHANNEL_INDEX.order, _d = CHANNEL_INDEX.detail, SINGLE_DEF_CHANNEL_INDEX = tslib_1.__rest(CHANNEL_INDEX, [\"order\", \"detail\"]);\n/**\n * Channels that cannot have an array of channelDef.\n * model.fieldDef, getFieldDef only work for these channels.\n *\n * (The only two channels that can have an array of channelDefs are \"detail\" and \"order\".\n * Since there can be multiple fieldDefs for detail and order, getFieldDef/model.fieldDef\n * are not applicable for them.  Similarly, selection projection won't work with \"detail\" and \"order\".)\n */\nexport var SINGLE_DEF_CHANNELS = flagKeys(SINGLE_DEF_CHANNEL_INDEX);\nexport function isChannel(str) {\n    return !!CHANNEL_INDEX[str];\n}\n// CHANNELS without COLUMN, ROW\nexport var UNIT_CHANNELS = flagKeys(UNIT_CHANNEL_INDEX);\n// NONPOSITION_CHANNELS = UNIT_CHANNELS without X, Y, X2, Y2;\nvar _x = UNIT_CHANNEL_INDEX.x, _y = UNIT_CHANNEL_INDEX.y, \n// x2 and y2 share the same scale as x and y\n_x2 = UNIT_CHANNEL_INDEX.x2, _y2 = UNIT_CHANNEL_INDEX.y2, _latitude = UNIT_CHANNEL_INDEX.latitude, _longitude = UNIT_CHANNEL_INDEX.longitude, _latitude2 = UNIT_CHANNEL_INDEX.latitude2, _longitude2 = UNIT_CHANNEL_INDEX.longitude2, \n// The rest of unit channels then have scale\nNONPOSITION_CHANNEL_INDEX = tslib_1.__rest(UNIT_CHANNEL_INDEX, [\"x\", \"y\", \"x2\", \"y2\", \"latitude\", \"longitude\", \"latitude2\", \"longitude2\"]);\nexport var NONPOSITION_CHANNELS = flagKeys(NONPOSITION_CHANNEL_INDEX);\n// POSITION_SCALE_CHANNELS = X and Y;\nvar POSITION_SCALE_CHANNEL_INDEX = { x: 1, y: 1 };\nexport var POSITION_SCALE_CHANNELS = flagKeys(POSITION_SCALE_CHANNEL_INDEX);\n// NON_POSITION_SCALE_CHANNEL = SCALE_CHANNELS without X, Y\nvar \n// x2 and y2 share the same scale as x and y\n// text and tooltip have format instead of scale,\n// href has neither format, nor scale\n_t = NONPOSITION_CHANNEL_INDEX.text, _tt = NONPOSITION_CHANNEL_INDEX.tooltip, _hr = NONPOSITION_CHANNEL_INDEX.href, \n// detail and order have no scale\n_dd = NONPOSITION_CHANNEL_INDEX.detail, _k = NONPOSITION_CHANNEL_INDEX.key, _oo = NONPOSITION_CHANNEL_INDEX.order, NONPOSITION_SCALE_CHANNEL_INDEX = tslib_1.__rest(NONPOSITION_CHANNEL_INDEX, [\"text\", \"tooltip\", \"href\", \"detail\", \"key\", \"order\"]);\nexport var NONPOSITION_SCALE_CHANNELS = flagKeys(NONPOSITION_SCALE_CHANNEL_INDEX);\n// Declare SCALE_CHANNEL_INDEX\nvar SCALE_CHANNEL_INDEX = tslib_1.__assign({}, POSITION_SCALE_CHANNEL_INDEX, NONPOSITION_SCALE_CHANNEL_INDEX);\n/** List of channels with scales */\nexport var SCALE_CHANNELS = flagKeys(SCALE_CHANNEL_INDEX);\nexport function isScaleChannel(channel) {\n    return !!SCALE_CHANNEL_INDEX[channel];\n}\n/**\n * Return whether a channel supports a particular mark type.\n * @param channel  channel name\n * @param mark the mark type\n * @return whether the mark supports the channel\n */\nexport function supportMark(channel, mark) {\n    return mark in getSupportedMark(channel);\n}\n/**\n * Return a dictionary showing whether a channel supports mark type.\n * @param channel\n * @return A dictionary mapping mark types to boolean values.\n */\nexport function getSupportedMark(channel) {\n    switch (channel) {\n        case COLOR:\n        case FILL:\n        case STROKE:\n        case DETAIL:\n        case KEY:\n        case TOOLTIP:\n        case HREF:\n        case ORDER: // TODO: revise (order might not support rect, which is not stackable?)\n        case OPACITY:\n        case ROW:\n        case COLUMN:\n            return {\n                point: true, tick: true, rule: true, circle: true, square: true,\n                bar: true, rect: true, line: true, trail: true, area: true, text: true, geoshape: true\n            };\n        case X:\n        case Y:\n        case LATITUDE:\n        case LONGITUDE:\n            return {\n                point: true, tick: true, rule: true, circle: true, square: true,\n                bar: true, rect: true, line: true, trail: true, area: true, text: true\n            };\n        case X2:\n        case Y2:\n        case LATITUDE2:\n        case LONGITUDE2:\n            return {\n                rule: true, bar: true, rect: true, area: true\n            };\n        case SIZE:\n            return {\n                point: true, tick: true, rule: true, circle: true, square: true,\n                bar: true, text: true, line: true, trail: true\n            };\n        case SHAPE:\n            return { point: true, geoshape: true };\n        case TEXT:\n            return { text: true };\n    }\n}\nexport function rangeType(channel) {\n    switch (channel) {\n        case X:\n        case Y:\n        case SIZE:\n        case OPACITY:\n        // X2 and Y2 use X and Y scales, so they similarly have continuous range.\n        case X2:\n        case Y2:\n            return 'continuous';\n        case ROW:\n        case COLUMN:\n        case SHAPE:\n        // TEXT, TOOLTIP, and HREF have no scale but have discrete output\n        case TEXT:\n        case TOOLTIP:\n        case HREF:\n            return 'discrete';\n        // Color can be either continuous or discrete, depending on scale type.\n        case COLOR:\n        case FILL:\n        case STROKE:\n            return 'flexible';\n        // No scale, no range type.\n        case LATITUDE:\n        case LONGITUDE:\n        case LATITUDE2:\n        case LONGITUDE2:\n        case DETAIL:\n        case KEY:\n        case ORDER:\n            return undefined;\n    }\n    /* istanbul ignore next: should never reach here. */\n    throw new Error('rangeType not implemented for ' + channel);\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hhbm5lbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jaGFubmVsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7R0FHRzs7QUFNSCxPQUFPLEVBQU8sUUFBUSxFQUFDLE1BQU0sUUFBUSxDQUFDO0FBRXRDLE1BQU0sS0FBVyxPQUFPLENBb0N2QjtBQXBDRCxXQUFpQixPQUFPO0lBQ3RCLFFBQVE7SUFDSyxXQUFHLEdBQVUsS0FBSyxDQUFDO0lBQ25CLGNBQU0sR0FBYSxRQUFRLENBQUM7SUFFekMsV0FBVztJQUNFLFNBQUMsR0FBUSxHQUFHLENBQUM7SUFDYixTQUFDLEdBQVEsR0FBRyxDQUFDO0lBQ2IsVUFBRSxHQUFTLElBQUksQ0FBQztJQUNoQixVQUFFLEdBQVMsSUFBSSxDQUFDO0lBRTdCLGVBQWU7SUFDRixnQkFBUSxHQUFlLFVBQVUsQ0FBQztJQUNsQyxpQkFBUyxHQUFnQixXQUFXLENBQUM7SUFDckMsaUJBQVMsR0FBZ0IsV0FBVyxDQUFDO0lBQ3JDLGtCQUFVLEdBQWlCLFlBQVksQ0FBQztJQUVyRCwyQkFBMkI7SUFDZCxhQUFLLEdBQVksT0FBTyxDQUFDO0lBRXpCLFlBQUksR0FBVyxNQUFNLENBQUM7SUFFdEIsY0FBTSxHQUFhLFFBQVEsQ0FBQztJQUU1QixhQUFLLEdBQVksT0FBTyxDQUFDO0lBQ3pCLFlBQUksR0FBVyxNQUFNLENBQUM7SUFDdEIsZUFBTyxHQUFjLFNBQVMsQ0FBQztJQUU1QyxvQkFBb0I7SUFDUCxZQUFJLEdBQVcsTUFBTSxDQUFDO0lBQ3RCLGFBQUssR0FBWSxPQUFPLENBQUM7SUFDekIsY0FBTSxHQUFhLFFBQVEsQ0FBQztJQUM1QixXQUFHLEdBQVUsS0FBSyxDQUFDO0lBRW5CLGVBQU8sR0FBYyxTQUFTLENBQUM7SUFDL0IsWUFBSSxHQUFXLE1BQU0sQ0FBQztBQUNyQyxDQUFDLEVBcENnQixPQUFPLEtBQVAsT0FBTyxRQW9DdkI7QUFJRCxNQUFNLENBQUMsSUFBTSxDQUFDLEdBQUcsT0FBTyxDQUFDLENBQUMsQ0FBQztBQUMzQixNQUFNLENBQUMsSUFBTSxDQUFDLEdBQUcsT0FBTyxDQUFDLENBQUMsQ0FBQztBQUMzQixNQUFNLENBQUMsSUFBTSxFQUFFLEdBQUcsT0FBTyxDQUFDLEVBQUUsQ0FBQztBQUM3QixNQUFNLENBQUMsSUFBTSxFQUFFLEdBQUcsT0FBTyxDQUFDLEVBQUUsQ0FBQztBQUU3QixNQUFNLENBQUMsSUFBTSxRQUFRLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUN6QyxNQUFNLENBQUMsSUFBTSxTQUFTLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUMzQyxNQUFNLENBQUMsSUFBTSxTQUFTLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQztBQUMzQyxNQUFNLENBQUMsSUFBTSxVQUFVLEdBQUcsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUU3QyxNQUFNLENBQUMsSUFBTSxHQUFHLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQztBQUMvQixNQUFNLENBQUMsSUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUNyQyxNQUFNLENBQUMsSUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQztBQUNuQyxNQUFNLENBQUMsSUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQztBQUNqQyxNQUFNLENBQUMsSUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQztBQUVuQyxNQUFNLENBQUMsSUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQztBQUNqQyxNQUFNLENBQUMsSUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUNyQyxNQUFNLENBQUMsSUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQztBQUNqQyxNQUFNLENBQUMsSUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQztBQUNyQyxNQUFNLENBQUMsSUFBTSxHQUFHLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQztBQUMvQixN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S0FBSyxJQUFJO1lBQ1AsT0FBTyxFQUFDLElBQUksRUFBRSxJQUFJLEVBQUMsQ0FBQztLQUN2QjtBQUNILENBQUM7QUFFRCxNQUFNLG9CQUFvQixPQUFnQjtJQUN4QyxRQUFRLE9BQU8sRUFBRTtRQUNmLEtBQUssQ0FBQyxDQUFDO1FBQ1AsS0FBSyxDQUFDLENBQUM7UUFDUCxLQUFLLElBQUksQ0FBQztRQUNWLEtBQUssT0FBTyxDQUFDO1FBQ2IseUVBQXlFO1FBQ3pFLEtBQUssRUFBRSxDQUFDO1FBQ1IsS0FBSyxFQUFFO1lBQ0wsT0FBTyxZQUFZLENBQUM7UUFFdEIsS0FBSyxHQUFHLENBQUM7UUFDVCxLQUFLLE1BQU0sQ0FBQztRQUNaLEtBQUssS0FBSyxDQUFDO1FBQ1gsaUVBQWlFO1FBQ2pFLEtBQUssSUFBSSxDQUFDO1FBQ1YsS0FBSyxPQUFPLENBQUM7UUFDYixLQUFLLElBQUk7WUFDUCxPQUFPLFVBQVUsQ0FBQztRQUVwQix1RUFBdUU7UUFDdkUsS0FBSyxLQUFLLENBQUM7UUFDWCxLQUFLLElBQUksQ0FBQztRQUNWLEtBQUssTUFBTTtZQUNULE9BQU8sVUFBVSxDQUFDO1FBRXBCLDJCQUEyQjtRQUUzQixLQUFLLFFBQVEsQ0FBQztRQUNkLEtBQUssU0FBUyxDQUFDO1FBQ2YsS0FBSyxTQUFTLENBQUM7UUFDZixLQUFLLFVBQVUsQ0FBQztRQUNoQixLQUFLLE1BQU0sQ0FBQztRQUNaLEtBQUssR0FBRyxDQUFDO1FBQ1QsS0FBSyxLQUFLO1lBQ1IsT0FBTyxTQUFTLENBQUM7S0FDcEI7SUFDRCxvREFBb0Q7SUFDcEQsTUFBTSxJQUFJLEtBQUssQ0FBQyxnQ0FBZ0MsR0FBRyxPQUFPLENBQUMsQ0FBQztBQUM5RCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvbnN0YW50cyBhbmQgdXRpbGl0aWVzIGZvciBlbmNvZGluZyBjaGFubmVscyAoVmlzdWFsIHZhcmlhYmxlcylcbiAqIHN1Y2ggYXMgJ3gnLCAneScsICdjb2xvcicuXG4gKi9cblxuaW1wb3J0IHtSYW5nZVR5cGV9IGZyb20gJy4vY29tcGlsZS9zY2FsZS90eXBlJztcbmltcG9ydCB7RW5jb2Rpbmd9IGZyb20gJy4vZW5jb2RpbmcnO1xuaW1wb3J0IHtGYWNldE1hcHBpbmd9IGZyb20gJy4vZmFjZXQnO1xuaW1wb3J0IHtNYXJrfSBmcm9tICcuL21hcmsnO1xuaW1wb3J0IHtGbGFnLCBmbGFnS2V5c30gZnJvbSAnLi91dGlsJztcblxuZXhwb3J0IG5hbWVzcGFjZSBDaGFubmVsIHtcbiAgLy8gRmFjZXRcbiAgZXhwb3J0IGNvbnN0IFJPVzogJ3JvdycgPSAncm93JztcbiAgZXhwb3J0IGNvbnN0IENPTFVNTjogJ2NvbHVtbicgPSAnY29sdW1uJztcblxuICAvLyBQb3NpdGlvblxuICBleHBvcnQgY29uc3QgWDogJ3gnID0gJ3gnO1xuICBleHBvcnQgY29uc3QgWTogJ3knID0gJ3knO1xuICBleHBvcnQgY29uc3QgWDI6ICd4MicgPSAneDInO1xuICBleHBvcnQgY29uc3QgWTI6ICd5MicgPSAneTInO1xuXG4gIC8vIEdlbyBQb3NpdGlvblxuICBleHBvcnQgY29uc3QgTEFUSVRVREU6ICdsYXRpdHVkZScgPSAnbGF0aXR1ZGUnO1xuICBleHBvcnQgY29uc3QgTE9OR0lUVURFOiAnbG9uZ2l0dWRlJyA9ICdsb25naXR1ZGUnO1xuICBleHBvcnQgY29uc3QgTEFUSVRVREUyOiAnbGF0aXR1ZGUyJyA9ICdsYXRpdHVkZTInO1xuICBleHBvcnQgY29uc3QgTE9OR0lUVURFMjogJ2xvbmdpdHVkZTInID0gJ2xvbmdpdHVkZTInO1xuXG4gIC8vIE1hcmsgcHJvcGVydHkgd2l0aCBzY2FsZVxuICBleHBvcnQgY29uc3QgQ09MT1I6ICdjb2xvcicgPSAnY29sb3InO1xuXG4gIGV4cG9ydCBjb25zdCBGSUxMOiAnZmlsbCcgPSAnZmlsbCc7XG5cbiAgZXhwb3J0IGNvbnN0IFNUUk9LRTogJ3N0cm9rZScgPSAnc3Ryb2tlJztcblxuICBleHBvcnQgY29uc3QgU0hBUEU6ICdzaGFwZScgPSAnc2hhcGUnO1xuICBleHBvcnQgY29uc3QgU0laRTogJ3NpemUnID0gJ3NpemUnO1xuICBleHBvcnQgY29uc3QgT1BBQ0lUWTogJ29wYWNpdHknID0gJ29wYWNpdHknO1xuXG4gIC8vIE5vbi1zY2FsZSBjaGFubmVsXG4gIGV4cG9ydCBjb25zdCBURVhUOiAndGV4dCcgPSAndGV4dCc7XG4gIGV4cG9ydCBjb25zdCBPUkRFUjogJ29yZGVyJyA9ICdvcmRlcic7XG4gIGV4cG9ydCBjb25zdCBERVRBSUw6ICdkZXRhaWwnID0gJ2RldGFpbCc7XG4gIGV4cG9ydCBjb25zdCBLRVk6ICdrZXknID0gJ2tleSc7XG5cbiAgZXhwb3J0IGNvbnN0IFRPT0xUSVA6ICd0b29sdGlwJyA9ICd0b29sdGlwJztcbiAgZXhwb3J0IGNvbnN0IEhSRUY6ICdocmVmJyA9ICdocmVmJztcbn1cblxuZXhwb3J0IHR5cGUgQ2hhbm5lbCA9IGtleW9mIEVuY29kaW5nPGFueT4gfCBrZXlvZiBGYWNldE1hcHBpbmc8YW55PjtcblxuZXhwb3J0IGNvbnN0IFggPSBDaGFubmVsLlg7XG5leHBvcnQgY29uc3QgWSA9IENoYW5uZWwuWTtcbmV4cG9ydCBjb25zdCBYMiA9IENoYW5uZWwuWDI7XG5leHBvcnQgY29uc3QgWTIgPSBDaGFubmVsLlkyO1xuXG5leHBvcnQgY29uc3QgTEFUSVRVREUgPSBDaGFubmVsLkxBVElUVURFO1xuZXhwb3J0IGNvbnN0IExBVElUVURFMiA9IENoYW5uZWwuTEFUSVRVREUyO1xuZXhwb3J0IGNvbnN0IExPTkdJVFVERSA9IENoYW5uZWwuTE9OR0lUVURFO1xuZXhwb3J0IGNvbnN0IExPTkdJVFVERTIgPSBDaGFubmVsLkxPTkdJVFVERTI7XG5cbmV4cG9ydCBjb25zdCBST1cgPSBDaGFubmVsLlJPVztcbmV4cG9ydCBjb25zdCBDT0xVTU4gPSBDaGFubmVsLkNPTFVNTjtcbmV4cG9ydCBjb25zdCBTSEFQRSA9IENoYW5uZWwuU0hBUEU7XG5leHBvcnQgY29uc3QgU0laRSA9IENoYW5uZWwuU0laRTtcbmV4cG9ydCBjb25zdCBDT0xPUiA9IENoYW5uZWwuQ09MT1I7XG5cbmV4cG9ydCBjb25zdCBGSUxMID0gQ2hhbm5lbC5GSUxMO1xuZXhwb3J0IGNvbnN0IFNUUk9LRSA9IENoYW5uZWwuU1RST0tFO1xuZXhwb3J0IGNvbnN0IFRFWFQgPSBDaGFubmVsLlRFWFQ7XG5leHBvcnQgY29uc3QgREVUQUlMID0gQ2hhbm5lbC5ERVRBSUw7XG5leHBvcnQgY29uc3QgS0VZID0gQ2hhbm5lbC5LRVk7XG5leHBvcnQgY29uc3QgT1JERVIgPSBDaGFubmVsLk9SREVSO1xuZXhwb3J0IGNvbnN0IE9QQUNJVFkgPSBDaGFubmVsLk9QQUNJVFk7XG5leHBvcnQgY29uc3QgVE9PTFRJUCA9IENoYW5uZWwuVE9PTFRJUDtcbmV4cG9ydCBjb25zdCBIUkVGID0gQ2hhbm5lbC5IUkVGO1xuXG5leHBvcnQgdHlwZSBHZW9Qb3NpdGlvbkNoYW5uZWwgPSAnbG9uZ2l0dWRlJyB8ICdsYXRpdHVkZScgfCAnbG9uZ2l0dWRlMicgfCAnbGF0aXR1ZGUyJztcblxuZXhwb3J0IGNvbnN0IEdFT1BPU0lUSU9OX0NIQU5ORUxfSU5ERVg6IEZsYWc8R2VvUG9zaXRpb25DaGFubmVsPiA9IHtcbiAgbG9uZ2l0dWRlOiAxLFxuICBsb25naXR1ZGUyOiAxLFxuICBsYXRpdHVkZTogMSxcbiAgbGF0aXR1ZGUyOiAxLFxufTtcblxuZXhwb3J0IGNvbnN0IEdFT1BPU0lUSU9OX0NIQU5ORUxTID0gZmxhZ0tleXMoR0VPUE9TSVRJT05fQ0hBTk5FTF9JTkRFWCk7XG5cbmNvbnN0IFVOSVRfQ0hBTk5FTF9JTkRFWDogRmxhZzxrZXlvZiBFbmNvZGluZzxhbnk+PiA9IHtcbiAgLy8gcG9zaXRpb25cbiAgeDogMSxcbiAgeTogMSxcbiAgeDI6IDEsXG4gIHkyOiAxLFxuXG4gIC4uLkdFT1BPU0lUSU9OX0NIQU5ORUxfSU5ERVgsXG5cbiAgLy8gY29sb3JcbiAgY29sb3I6IDEsXG4gIGZpbGw6IDEsXG4gIHN0cm9rZTogMSxcblxuICAvLyBvdGhlciBub24tcG9zaXRpb24gd2l0aCBzY2FsZVxuICBvcGFjaXR5OiAxLFxuICBzaXplOiAxLFxuICBzaGFwZTogMSxcblxuICAvLyBjaGFubmVscyB3aXRob3V0IHNjYWxlc1xuICBvcmRlcjogMSxcbiAgdGV4dDogMSxcbiAgZGV0YWlsOiAxLFxuICBrZXk6IDEsXG4gIHRvb2x0aXA6IDEsXG4gIGhyZWY6IDEsXG59O1xuXG5leHBvcnQgdHlwZSBDb2xvckNoYW5uZWwgPSAnY29sb3InIHwgJ2ZpbGwnIHwgJ3N0cm9rZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NvbG9yQ2hhbm5lbChjaGFubmVsOiBDaGFubmVsKTogY2hhbm5lbCBpcyBDb2xvckNoYW5uZWwge1xuICByZXR1cm4gY2hhbm5lbCA9PT0gJ2NvbG9yJyB8fCBjaGFubmVsID09PSAnZmlsbCcgfHwgY2hhbm5lbCA9PT0gJ3N0cm9rZSc7XG59XG5cbmNvbnN0IEZBQ0VUX0NIQU5ORUxfSU5ERVg6IEZsYWc8a2V5b2YgRmFjZXRNYXBwaW5nPGFueT4+ID0ge1xuICByb3c6IDEsXG4gIGNvbHVtbjogMVxufTtcblxuY29uc3QgQ0hBTk5FTF9JTkRFWCA9IHtcbiAgLi4uVU5JVF9DSEFOTkVMX0lOREVYLFxuICAuLi5GQUNFVF9DSEFOTkVMX0lOREVYXG59O1xuXG5leHBvcnQgY29uc3QgQ0hBTk5FTFMgPSBmbGFnS2V5cyhDSEFOTkVMX0lOREVYKTtcblxuY29uc3Qge29yZGVyOiBfbywgZGV0YWlsOiBfZCwgLi4uU0lOR0xFX0RFRl9DSEFOTkVMX0lOREVYfSA9IENIQU5ORUxfSU5ERVg7XG4vKipcbiAqIENoYW5uZWxzIHRoYXQgY2Fubm90IGhhdmUgYW4gYXJyYXkgb2YgY2hhbm5lbERlZi5cbiAqIG1vZGVsLmZpZWxkRGVmLCBnZXRGaWVsZERlZiBvbmx5IHdvcmsgZm9yIHRoZXNlIGNoYW5uZWxzLlxuICpcbiAqIChUaGUgb25seSB0d28gY2hhbm5lbHMgdGhhdCBjYW4gaGF2ZSBhbiBhcnJheSBvZiBjaGFubmVsRGVmcyBhcmUgXCJkZXRhaWxcIiBhbmQgXCJvcmRlclwiLlxuICogU2luY2UgdGhlcmUgY2FuIGJlIG11bHRpcGxlIGZpZWxkRGVmcyBmb3IgZGV0YWlsIGFuZCBvcmRlciwgZ2V0RmllbGREZWYvbW9kZWwuZmllbGREZWZcbiAqIGFyZSBub3QgYXBwbGljYWJsZSBmb3IgdGhlbS4gIFNpbWlsYXJseSwgc2VsZWN0aW9uIHByb2plY3Rpb24gd29uJ3Qgd29yayB3aXRoIFwiZGV0YWlsXCIgYW5kIFwib3JkZXJcIi4pXG4gKi9cblxuZXhwb3J0IGNvbnN0IFNJTkdMRV9ERUZfQ0hBTk5FTFM6IFNpbmdsZURlZkNoYW5uZWxbXSA9IGZsYWdLZXlzKFNJTkdMRV9ERUZfQ0hBTk5FTF9JTkRFWCk7XG5cbi8vIFVzaW5nIHRoZSBmb2xsb3dpbmcgbGluZSBsZWFkcyB0byBUeXBlRXJyb3I6IENhbm5vdCByZWFkIHByb3BlcnR5ICdlbGVtZW50VHlwZXMnIG9mIHVuZGVmaW5lZFxuLy8gd2hlbiBydW5uaW5nIHRoZSBzY2hlbWEgZ2VuZXJhdG9yXG4vLyBleHBvcnQgdHlwZSBTaW5nbGVEZWZDaGFubmVsID0gdHlwZW9mIFNJTkdMRV9ERUZfQ0hBTk5FTFNbMF07XG5leHBvcnQgdHlwZSBTaW5nbGVEZWZDaGFubmVsID0gJ3gnIHwgJ3knIHwgJ3gyJyB8ICd5MicgfFxuICAnbG9uZ2l0dWRlJyB8ICdsYXRpdHVkZScgfCAnbG9uZ2l0dWRlMicgfCAnbGF0aXR1ZGUyJyB8XG4gICdyb3cnIHwgJ2NvbHVtbicgfFxuICAnY29sb3InIHwgJ2ZpbGwnIHwgJ3N0cm9rZScgfFxuICAnc2l6ZScgfCAnc2hhcGUnIHwgJ29wYWNpdHknIHxcbiAgJ3RleHQnIHwgJ3Rvb2x0aXAnIHwgJ2hyZWYnIHwgJ2tleSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NoYW5uZWwoc3RyOiBzdHJpbmcpOiBzdHIgaXMgQ2hhbm5lbCB7XG4gIHJldHVybiAhIUNIQU5ORUxfSU5ERVhbc3RyXTtcbn1cblxuLy8gQ0hBTk5FTFMgd2l0aG91dCBDT0xVTU4sIFJPV1xuZXhwb3J0IGNvbnN0IFVOSVRfQ0hBTk5FTFMgPSBmbGFnS2V5cyhVTklUX0NIQU5ORUxfSU5ERVgpO1xuXG5cbi8vIE5PTlBPU0lUSU9OX0NIQU5ORUxTID0gVU5JVF9DSEFOTkVMUyB3aXRob3V0IFgsIFksIFgyLCBZMjtcbmNvbnN0IHtcbiAgeDogX3gsIHk6IF95LFxuICAvLyB4MiBhbmQgeTIgc2hhcmUgdGhlIHNhbWUgc2NhbGUgYXMgeCBhbmQgeVxuICB4MjogX3gyLCB5MjogX3kyLFxuICBsYXRpdHVkZTogX2xhdGl0dWRlLCBsb25naXR1ZGU6IF9sb25naXR1ZGUsXG4gIGxhdGl0dWRlMjogX2xhdGl0dWRlMiwgbG9uZ2l0dWRlMjogX2xvbmdpdHVkZTIsXG4gIC8vIFRoZSByZXN0IG9mIHVuaXQgY2hhbm5lbHMgdGhlbiBoYXZlIHNjYWxlXG4gIC4uLk5PTlBPU0lUSU9OX0NIQU5ORUxfSU5ERVhcbn0gPSBVTklUX0NIQU5ORUxfSU5ERVg7XG5cbmV4cG9ydCBjb25zdCBOT05QT1NJVElPTl9DSEFOTkVMUyA9IGZsYWdLZXlzKE5PTlBPU0lUSU9OX0NIQU5ORUxfSU5ERVgpO1xuZXhwb3J0IHR5cGUgTm9uUG9zaXRpb25DaGFubmVsID0gdHlwZW9mIE5PTlBPU0lUSU9OX0NIQU5ORUxTWzBdO1xuXG4vLyBQT1NJVElPTl9TQ0FMRV9DSEFOTkVMUyA9IFggYW5kIFk7XG5jb25zdCBQT1NJVElPTl9TQ0FMRV9DSEFOTkVMX0lOREVYOiB7eDoxLCB5OjF9ID0ge3g6MSwgeToxfTtcbmV4cG9ydCBjb25zdCBQT1NJVElPTl9TQ0FMRV9DSEFOTkVMUyA9IGZsYWdLZXlzKFBPU0lUSU9OX1NDQUxFX0NIQU5ORUxfSU5ERVgpO1xuZXhwb3J0IHR5cGUgUG9zaXRpb25TY2FsZUNoYW5uZWwgPSB0eXBlb2YgUE9TSVRJT05fU0NBTEVfQ0hBTk5FTFNbMF07XG5cbi8vIE5PTl9QT1NJVElPTl9TQ0FMRV9DSEFOTkVMID0gU0NBTEVfQ0hBTk5FTFMgd2l0aG91dCBYLCBZXG5jb25zdCB7XG4gIC8vIHgyIGFuZCB5MiBzaGFyZSB0aGUgc2FtZSBzY2FsZSBhcyB4IGFuZCB5XG4gIC8vIHRleHQgYW5kIHRvb2x0aXAgaGF2ZSBmb3JtYXQgaW5zdGVhZCBvZiBzY2FsZSxcbiAgLy8gaHJlZiBoYXMgbmVpdGhlciBmb3JtYXQsIG5vciBzY2FsZVxuICB0ZXh0OiBfdCwgdG9vbHRpcDogX3R0LCBocmVmOiBfaHIsXG4gIC8vIGRldGFpbCBhbmQgb3JkZXIgaGF2ZSBubyBzY2FsZVxuICBkZXRhaWw6IF9kZCwga2V5OiBfaywgb3JkZXI6IF9vbyxcbiAgLi4uTk9OUE9TSVRJT05fU0NBTEVfQ0hBTk5FTF9JTkRFWFxufSA9IE5PTlBPU0lUSU9OX0NIQU5ORUxfSU5ERVg7XG5leHBvcnQgY29uc3QgTk9OUE9TSVRJT05fU0NBTEVfQ0hBTk5FTFMgPSBmbGFnS2V5cyhOT05QT1NJVElPTl9TQ0FMRV9DSEFOTkVMX0lOREVYKTtcbmV4cG9ydCB0eXBlIE5vblBvc2l0aW9uU2NhbGVDaGFubmVsID0gdHlwZW9mIE5PTlBPU0lUSU9OX1NDQUxFX0NIQU5ORUxTWzBdO1xuXG4vLyBEZWNsYXJlIFNDQUxFX0NIQU5ORUxfSU5ERVhcbmNvbnN0IFNDQUxFX0NIQU5ORUxfSU5ERVggPSB7XG4gIC4uLlBPU0lUSU9OX1NDQUxFX0NIQU5ORUxfSU5ERVgsXG4gIC4uLk5PTlBPU0lUSU9OX1NDQUxFX0NIQU5ORUxfSU5ERVhcbn07XG5cbi8qKiBMaXN0IG9mIGNoYW5uZWxzIHdpdGggc2NhbGVzICovXG5leHBvcnQgY29uc3QgU0NBTEVfQ0hBTk5FTFMgPSBmbGFnS2V5cyhTQ0FMRV9DSEFOTkVMX0lOREVYKTtcbmV4cG9ydCB0eXBlIFNjYWxlQ2hhbm5lbCA9IHR5cGVvZiBTQ0FMRV9DSEFOTkVMU1swXTtcblxuZXhwb3J0IGZ1bmN0aW9uIGlzU2NhbGVDaGFubmVsKGNoYW5uZWw6IENoYW5uZWwpOiBjaGFubmVsIGlzIFNjYWxlQ2hhbm5lbCB7XG4gIHJldHVybiAhIVNDQUxFX0NIQU5ORUxfSU5ERVhbY2hhbm5lbF07XG59XG5cbmV4cG9ydCB0eXBlIFN1cHBvcnRlZE1hcmsgPSB7XG4gIFttYXJrIGluIE1hcmtdPzogYm9vbGVhblxufTtcblxuLyoqXG4gKiBSZXR1cm4gd2hldGhlciBhIGNoYW5uZWwgc3VwcG9ydHMgYSBwYXJ0aWN1bGFyIG1hcmsgdHlwZS5cbiAqIEBwYXJhbSBjaGFubmVsICBjaGFubmVsIG5hbWVcbiAqIEBwYXJhbSBtYXJrIHRoZSBtYXJrIHR5cGVcbiAqIEByZXR1cm4gd2hldGhlciB0aGUgbWFyayBzdXBwb3J0cyB0aGUgY2hhbm5lbFxuICovXG5leHBvcnQgZnVuY3Rpb24gc3VwcG9ydE1hcmsoY2hhbm5lbDogQ2hhbm5lbCwgbWFyazogTWFyaykge1xuICByZXR1cm4gbWFyayBpbiBnZXRTdXBwb3J0ZWRNYXJrKGNoYW5uZWwpO1xufVxuXG4vKipcbiAqIFJldHVybiBhIGRpY3Rpb25hcnkgc2hvd2luZyB3aGV0aGVyIGEgY2hhbm5lbCBzdXBwb3J0cyBtYXJrIHR5cGUuXG4gKiBAcGFyYW0gY2hhbm5lbFxuICogQHJldHVybiBBIGRpY3Rpb25hcnkgbWFwcGluZyBtYXJrIHR5cGVzIHRvIGJvb2xlYW4gdmFsdWVzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3VwcG9ydGVkTWFyayhjaGFubmVsOiBDaGFubmVsKTogU3VwcG9ydGVkTWFyayB7XG4gIHN3aXRjaCAoY2hhbm5lbCkge1xuICAgIGNhc2UgQ09MT1I6XG4gICAgY2FzZSBGSUxMOlxuICAgIGNhc2UgU1RST0tFOlxuXG4gICAgY2FzZSBERVRBSUw6XG4gICAgY2FzZSBLRVk6XG4gICAgY2FzZSBUT09MVElQOlxuICAgIGNhc2UgSFJFRjpcbiAgICBjYXNlIE9SREVSOiAgICAvLyBUT0RPOiByZXZpc2UgKG9yZGVyIG1pZ2h0IG5vdCBzdXBwb3J0IHJlY3QsIHdoaWNoIGlzIG5vdCBzdGFja2FibGU/KVxuICAgIGNhc2UgT1BBQ0lUWTpcbiAgICBjYXNlIFJPVzpcbiAgICBjYXNlIENPTFVNTjpcbiAgICAgIHJldHVybiB7IC8vIGFsbCBtYXJrc1xuICAgICAgICBwb2ludDogdHJ1ZSwgdGljazogdHJ1ZSwgcnVsZTogdHJ1ZSwgY2lyY2xlOiB0cnVlLCBzcXVhcmU6IHRydWUsXG4gICAgICAgIGJhcjogdHJ1ZSwgcmVjdDogdHJ1ZSwgbGluZTogdHJ1ZSwgdHJhaWw6IHRydWUsIGFyZWE6IHRydWUsIHRleHQ6IHRydWUsIGdlb3NoYXBlOiB0cnVlXG4gICAgICB9O1xuICAgIGNhc2UgWDpcbiAgICBjYXNlIFk6XG4gICAgY2FzZSBMQVRJVFVERTpcbiAgICBjYXNlIExPTkdJVFVERTpcbiAgICAgIHJldHVybiB7IC8vIGFsbCBtYXJrcyBleGNlcHQgZ2Vvc2hhcGUuIGdlb3NoYXBlIGRvZXMgbm90IHVzZSBYLCBZIC0tIGl0IHVzZXMgYSBwcm9qZWN0aW9uXG4gICAgICAgIHBvaW50OiB0cnVlLCB0aWNrOiB0cnVlLCBydWxlOiB0cnVlLCBjaXJjbGU6IHRydWUsIHNxdWFyZTogdHJ1ZSxcbiAgICAgICAgYmFyOiB0cnVlLCByZWN0OiB0cnVlLCBsaW5lOiB0cnVlLCB0cmFpbDogdHJ1ZSwgYXJlYTogdHJ1ZSwgdGV4dDogdHJ1ZVxuICAgICAgfTtcbiAgICBjYXNlIFgyOlxuICAgIGNhc2UgWTI6XG4gICAgY2FzZSBMQVRJVFVERTI6XG4gICAgY2FzZSBMT05HSVRVREUyOlxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcnVsZTogdHJ1ZSwgYmFyOiB0cnVlLCByZWN0OiB0cnVlLCBhcmVhOiB0cnVlXG4gICAgICB9O1xuICAgIGNhc2UgU0laRTpcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHBvaW50OiB0cnVlLCB0aWNrOiB0cnVlLCBydWxlOiB0cnVlLCBjaXJjbGU6IHRydWUsIHNxdWFyZTogdHJ1ZSxcbiAgICAgICAgYmFyOiB0cnVlLCB0ZXh0OiB0cnVlLCBsaW5lOiB0cnVlLCB0cmFpbDogdHJ1ZVxuICAgICAgfTtcbiAgICBjYXNlIFNIQVBFOlxuICAgICAgcmV0dXJuIHtwb2ludDogdHJ1ZSwgZ2Vvc2hhcGU6IHRydWV9O1xuICAgIGNhc2UgVEVYVDpcbiAgICAgIHJldHVybiB7dGV4dDogdHJ1ZX07XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJhbmdlVHlwZShjaGFubmVsOiBDaGFubmVsKTogUmFuZ2VUeXBlIHtcbiAgc3dpdGNoIChjaGFubmVsKSB7XG4gICAgY2FzZSBYOlxuICAgIGNhc2UgWTpcbiAgICBjYXNlIFNJWkU6XG4gICAgY2FzZSBPUEFDSVRZOlxuICAgIC8vIFgyIGFuZCBZMiB1c2UgWCBhbmQgWSBzY2FsZXMsIHNvIHRoZXkgc2ltaWxhcmx5IGhhdmUgY29udGludW91cyByYW5nZS5cbiAgICBjYXNlIFgyOlxuICAgIGNhc2UgWTI6XG4gICAgICByZXR1cm4gJ2NvbnRpbnVvdXMnO1xuXG4gICAgY2FzZSBST1c6XG4gICAgY2FzZSBDT0xVTU46XG4gICAgY2FzZSBTSEFQRTpcbiAgICAvLyBURVhULCBUT09MVElQLCBhbmQgSFJFRiBoYXZlIG5vIHNjYWxlIGJ1dCBoYXZlIGRpc2NyZXRlIG91dHB1dFxuICAgIGNhc2UgVEVYVDpcbiAgICBjYXNlIFRPT0xUSVA6XG4gICAgY2FzZSBIUkVGOlxuICAgICAgcmV0dXJuICdkaXNjcmV0ZSc7XG5cbiAgICAvLyBDb2xvciBjYW4gYmUgZWl0aGVyIGNvbnRpbnVvdXMgb3IgZGlzY3JldGUsIGRlcGVuZGluZyBvbiBzY2FsZSB0eXBlLlxuICAgIGNhc2UgQ09MT1I6XG4gICAgY2FzZSBGSUxMOlxuICAgIGNhc2UgU1RST0tFOlxuICAgICAgcmV0dXJuICdmbGV4aWJsZSc7XG5cbiAgICAvLyBObyBzY2FsZSwgbm8gcmFuZ2UgdHlwZS5cblxuICAgIGNhc2UgTEFUSVRVREU6XG4gICAgY2FzZSBMT05HSVRVREU6XG4gICAgY2FzZSBMQVRJVFVERTI6XG4gICAgY2FzZSBMT05HSVRVREUyOlxuICAgIGNhc2UgREVUQUlMOlxuICAgIGNhc2UgS0VZOlxuICAgIGNhc2UgT1JERVI6XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBzaG91bGQgbmV2ZXIgcmVhY2ggaGVyZS4gKi9cbiAgdGhyb3cgbmV3IEVycm9yKCdyYW5nZVR5cGUgbm90IGltcGxlbWVudGVkIGZvciAnICsgY2hhbm5lbCk7XG59XG4iXX0=","import { isBoolean } from 'vega-util';\nimport { COLOR, COLUMN, FILL, OPACITY, ROW, SHAPE, SIZE, STROKE } from './channel';\nimport { keys, varName } from './util';\nexport function binToString(bin) {\n    if (isBoolean(bin)) {\n        return 'bin';\n    }\n    return 'bin' + keys(bin).map(function (p) { return varName(\"_\" + p + \"_\" + bin[p]); }).join('');\n}\nexport function isBinParams(bin) {\n    return bin && !isBoolean(bin);\n}\nexport function autoMaxBins(channel) {\n    switch (channel) {\n        case ROW:\n        case COLUMN:\n        case SIZE:\n        case COLOR:\n        case FILL:\n        case STROKE:\n        case OPACITY:\n        // Facets and Size shouldn't have too many bins\n        // We choose 6 like shape to simplify the rule\n        case SHAPE:\n            return 6; // Vega's \"shape\" has 6 distinct values\n        default:\n            return 10;\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmluLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2Jpbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsU0FBUyxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBQ3BDLE9BQU8sRUFBVSxLQUFLLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxPQUFPLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBQzFGLE9BQU8sRUFBQyxJQUFJLEVBQUUsT0FBTyxFQUFDLE1BQU0sUUFBUSxDQUFDO0FBNkRyQyxNQUFNLHNCQUFzQixHQUF3QjtJQUNsRCxJQUFJLFNBQVMsQ0FBQyxHQUFHLENBQUMsRUFBRTtRQUNsQixPQUFPLEtBQUssQ0FBQztLQUNkO0lBQ0QsT0FBTyxLQUFLLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFBLENBQUMsSUFBSSxPQUFBLE9BQU8sQ0FBQyxNQUFJLENBQUMsU0FBSSxHQUFHLENBQUMsQ0FBQyxDQUFHLENBQUMsRUFBMUIsQ0FBMEIsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUN6RSxDQUFDO0FBRUQsTUFBTSxzQkFBc0IsR0FBd0I7SUFDbEQsT0FBTyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDaEMsQ0FBQztBQUVELE1BQU0sc0JBQXNCLE9BQWdCO0lBQzFDLFFBQVEsT0FBTyxFQUFFO1FBQ2YsS0FBSyxHQUFHLENBQUM7UUFDVCxLQUFLLE1BQU0sQ0FBQztRQUNaLEtBQUssSUFBSSxDQUFDO1FBQ1YsS0FBSyxLQUFLLENBQUM7UUFDWCxLQUFLLElBQUksQ0FBQztRQUNWLEtBQUssTUFBTSxDQUFDO1FBQ1osS0FBSyxPQUFPLENBQUM7UUFDWCwrQ0FBK0M7UUFDL0MsOENBQThDO1FBQ2hELEtBQUssS0FBSztZQUNSLE9BQU8sQ0FBQyxDQUFDLENBQUMsdUNBQXVDO1FBQ25EO1lBQ0UsT0FBTyxFQUFFLENBQUM7S0FDYjtBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2lzQm9vbGVhbn0gZnJvbSAndmVnYS11dGlsJztcbmltcG9ydCB7Q2hhbm5lbCwgQ09MT1IsIENPTFVNTiwgRklMTCwgT1BBQ0lUWSwgUk9XLCBTSEFQRSwgU0laRSwgU1RST0tFfSBmcm9tICcuL2NoYW5uZWwnO1xuaW1wb3J0IHtrZXlzLCB2YXJOYW1lfSBmcm9tICcuL3V0aWwnO1xuXG5cbmV4cG9ydCBpbnRlcmZhY2UgQmFzZUJpbiB7XG4gIC8qKlxuICAgKiBUaGUgbnVtYmVyIGJhc2UgdG8gdXNlIGZvciBhdXRvbWF0aWMgYmluIGRldGVybWluYXRpb24gKGRlZmF1bHQgaXMgYmFzZSAxMCkuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgMTBgXG4gICAqXG4gICAqL1xuICBiYXNlPzogbnVtYmVyO1xuICAvKipcbiAgICogQW4gZXhhY3Qgc3RlcCBzaXplIHRvIHVzZSBiZXR3ZWVuIGJpbnMuXG4gICAqXG4gICAqIF9fTm90ZTpfXyBJZiBwcm92aWRlZCwgb3B0aW9ucyBzdWNoIGFzIG1heGJpbnMgd2lsbCBiZSBpZ25vcmVkLlxuICAgKi9cbiAgc3RlcD86IG51bWJlcjtcbiAgLyoqXG4gICAqIEFuIGFycmF5IG9mIGFsbG93YWJsZSBzdGVwIHNpemVzIHRvIGNob29zZSBmcm9tLlxuICAgKiBAbWluSXRlbXMgMVxuICAgKi9cbiAgc3RlcHM/OiBudW1iZXJbXTtcbiAgLyoqXG4gICAqIEEgbWluaW11bSBhbGxvd2FibGUgc3RlcCBzaXplIChwYXJ0aWN1bGFybHkgdXNlZnVsIGZvciBpbnRlZ2VyIHZhbHVlcykuXG4gICAqL1xuICBtaW5zdGVwPzogbnVtYmVyO1xuICAvKipcbiAgICogU2NhbGUgZmFjdG9ycyBpbmRpY2F0aW5nIGFsbG93YWJsZSBzdWJkaXZpc2lvbnMuIFRoZSBkZWZhdWx0IHZhbHVlIGlzIFs1LCAyXSwgd2hpY2ggaW5kaWNhdGVzIHRoYXQgZm9yIGJhc2UgMTAgbnVtYmVycyAodGhlIGRlZmF1bHQgYmFzZSksIHRoZSBtZXRob2QgbWF5IGNvbnNpZGVyIGRpdmlkaW5nIGJpbiBzaXplcyBieSA1IGFuZC9vciAyLiBGb3IgZXhhbXBsZSwgZm9yIGFuIGluaXRpYWwgc3RlcCBzaXplIG9mIDEwLCB0aGUgbWV0aG9kIGNhbiBjaGVjayBpZiBiaW4gc2l6ZXMgb2YgMiAoPSAxMC81KSwgNSAoPSAxMC8yKSwgb3IgMSAoPSAxMC8oNSoyKSkgbWlnaHQgYWxzbyBzYXRpc2Z5IHRoZSBnaXZlbiBjb25zdHJhaW50cy5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBbNSwgMl1gXG4gICAqXG4gICAqIEBtaW5JdGVtcyAxXG4gICAqL1xuICBkaXZpZGU/OiBudW1iZXJbXTtcbiAgLyoqXG4gICAqIE1heGltdW0gbnVtYmVyIG9mIGJpbnMuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgNmAgZm9yIGByb3dgLCBgY29sdW1uYCBhbmQgYHNoYXBlYCBjaGFubmVsczsgYDEwYCBmb3Igb3RoZXIgY2hhbm5lbHNcbiAgICpcbiAgICogQG1pbmltdW0gMlxuICAgKi9cbiAgbWF4Ymlucz86IG51bWJlcjtcbiAgLyoqXG4gICAqIElmIHRydWUgKHRoZSBkZWZhdWx0KSwgYXR0ZW1wdHMgdG8gbWFrZSB0aGUgYmluIGJvdW5kYXJpZXMgdXNlIGh1bWFuLWZyaWVuZGx5IGJvdW5kYXJpZXMsIHN1Y2ggYXMgbXVsdGlwbGVzIG9mIHRlbi5cbiAgICovXG4gIG5pY2U/OiBib29sZWFuO1xufVxuXG5cbi8qKlxuICogQmlubmluZyBwcm9wZXJ0aWVzIG9yIGJvb2xlYW4gZmxhZyBmb3IgZGV0ZXJtaW5pbmcgd2hldGhlciB0byBiaW4gZGF0YSBvciBub3QuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQmluUGFyYW1zIGV4dGVuZHMgQmFzZUJpbiB7XG4gIC8qKlxuICAgKiBBIHR3by1lbGVtZW50IChgW21pbiwgbWF4XWApIGFycmF5IGluZGljYXRpbmcgdGhlIHJhbmdlIG9mIGRlc2lyZWQgYmluIHZhbHVlcy5cbiAgICogQG1pbkl0ZW1zIDJcbiAgICogQG1heEl0ZW1zIDJcbiAgICovXG4gIGV4dGVudD86IG51bWJlcltdOyAgLy8gVmdCaW5UcmFuc2Zvcm0gdXNlcyBhIGRpZmZlcmVudCBleHRlbnQgc28gd2UgbmVlZCB0byBwdWxsIHRoaXMgb3V0LlxufVxuXG5leHBvcnQgZnVuY3Rpb24gYmluVG9TdHJpbmcoYmluOiBCaW5QYXJhbXMgfCBib29sZWFuKSB7XG4gIGlmIChpc0Jvb2xlYW4oYmluKSkge1xuICAgIHJldHVybiAnYmluJztcbiAgfVxuICByZXR1cm4gJ2JpbicgKyBrZXlzKGJpbikubWFwKHAgPT4gdmFyTmFtZShgXyR7cH1fJHtiaW5bcF19YCkpLmpvaW4oJycpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNCaW5QYXJhbXMoYmluOiBCaW5QYXJhbXMgfCBib29sZWFuKTogYmluIGlzIEJpblBhcmFtcyB7XG4gIHJldHVybiBiaW4gJiYgIWlzQm9vbGVhbihiaW4pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXV0b01heEJpbnMoY2hhbm5lbDogQ2hhbm5lbCk6IG51bWJlciB7XG4gIHN3aXRjaCAoY2hhbm5lbCkge1xuICAgIGNhc2UgUk9XOlxuICAgIGNhc2UgQ09MVU1OOlxuICAgIGNhc2UgU0laRTpcbiAgICBjYXNlIENPTE9SOlxuICAgIGNhc2UgRklMTDpcbiAgICBjYXNlIFNUUk9LRTpcbiAgICBjYXNlIE9QQUNJVFk6XG4gICAgICAvLyBGYWNldHMgYW5kIFNpemUgc2hvdWxkbid0IGhhdmUgdG9vIG1hbnkgYmluc1xuICAgICAgLy8gV2UgY2hvb3NlIDYgbGlrZSBzaGFwZSB0byBzaW1wbGlmeSB0aGUgcnVsZVxuICAgIGNhc2UgU0hBUEU6XG4gICAgICByZXR1cm4gNjsgLy8gVmVnYSdzIFwic2hhcGVcIiBoYXMgNiBkaXN0aW5jdCB2YWx1ZXNcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIDEwO1xuICB9XG59XG4iXX0=","import { toSet } from 'vega-util';\nimport { contains, flagKeys } from './util';\nexport var Mark;\n(function (Mark) {\n    Mark.AREA = 'area';\n    Mark.BAR = 'bar';\n    Mark.LINE = 'line';\n    Mark.POINT = 'point';\n    Mark.RECT = 'rect';\n    Mark.RULE = 'rule';\n    Mark.TEXT = 'text';\n    Mark.TICK = 'tick';\n    Mark.TRAIL = 'trail';\n    Mark.CIRCLE = 'circle';\n    Mark.SQUARE = 'square';\n    Mark.GEOSHAPE = 'geoshape';\n})(Mark || (Mark = {}));\nexport var AREA = Mark.AREA;\nexport var BAR = Mark.BAR;\nexport var LINE = Mark.LINE;\nexport var POINT = Mark.POINT;\nexport var TEXT = Mark.TEXT;\nexport var TICK = Mark.TICK;\nexport var TRAIL = Mark.TRAIL;\nexport var RECT = Mark.RECT;\nexport var RULE = Mark.RULE;\nexport var GEOSHAPE = Mark.GEOSHAPE;\nexport var CIRCLE = Mark.CIRCLE;\nexport var SQUARE = Mark.SQUARE;\n// Using mapped type to declare index, ensuring we always have all marks when we add more.\nvar MARK_INDEX = {\n    area: 1,\n    bar: 1,\n    line: 1,\n    point: 1,\n    text: 1,\n    tick: 1,\n    trail: 1,\n    rect: 1,\n    geoshape: 1,\n    rule: 1,\n    circle: 1,\n    square: 1\n};\nexport function isMark(m) {\n    return !!MARK_INDEX[m];\n}\nexport function isPathMark(m) {\n    return contains(['line', 'area', 'trail'], m);\n}\nexport var PRIMITIVE_MARKS = flagKeys(MARK_INDEX);\nexport function isMarkDef(mark) {\n    return mark['type'];\n}\nvar PRIMITIVE_MARK_INDEX = toSet(PRIMITIVE_MARKS);\nexport function isPrimitiveMark(mark) {\n    var markType = isMarkDef(mark) ? mark.type : mark;\n    return markType in PRIMITIVE_MARK_INDEX;\n}\nexport var STROKE_CONFIG = ['stroke', 'strokeWidth',\n    'strokeDash', 'strokeDashOffset', 'strokeOpacity'];\nexport var FILL_CONFIG = ['fill', 'fillOpacity'];\nexport var FILL_STROKE_CONFIG = [].concat(STROKE_CONFIG, FILL_CONFIG);\nexport var VL_ONLY_MARK_CONFIG_PROPERTIES = ['filled', 'color'];\nexport var VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX = {\n    area: ['line', 'point'],\n    bar: ['binSpacing', 'continuousBandSize', 'discreteBandSize'],\n    line: ['point'],\n    text: ['shortTimeLabels'],\n    tick: ['bandSize', 'thickness']\n};\nexport var defaultMarkConfig = {\n    color: '#4c78a8',\n};\nexport var defaultBarConfig = {\n    binSpacing: 1,\n    continuousBandSize: 5\n};\nexport var defaultTickConfig = {\n    thickness: 1\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFyay5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tYXJrLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBQyxLQUFLLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFFaEMsT0FBTyxFQUFDLFFBQVEsRUFBRSxRQUFRLEVBQUMsTUFBTSxRQUFRLENBQUM7QUFHMUMsTUFBTSxLQUFXLElBQUksQ0FhcEI7QUFiRCxXQUFpQixJQUFJO0lBQ04sU0FBSSxHQUFXLE1BQU0sQ0FBQztJQUN0QixRQUFHLEdBQVUsS0FBSyxDQUFDO0lBQ25CLFNBQUksR0FBVyxNQUFNLENBQUM7SUFDdEIsVUFBSyxHQUFZLE9BQU8sQ0FBQztJQUN6QixTQUFJLEdBQVcsTUFBTSxDQUFDO0lBQ3RCLFNBQUksR0FBVyxNQUFNLENBQUM7SUFDdEIsU0FBSSxHQUFXLE1BQU0sQ0FBQztJQUN0QixTQUFJLEdBQVcsTUFBTSxDQUFDO0lBQ3RCLFVBQUssR0FBWSxPQUFPLENBQUM7SUFDekIsV0FBTSxHQUFhLFFBQVEsQ0FBQztJQUM1QixXQUFNLEdBQWEsUUFBUSxDQUFDO0lBQzVCLGFBQVEsR0FBZSxVQUFVLENBQUM7QUFDakQsQ0FBQyxFQWJnQixJQUFJLEtBQUosSUFBSSxRQWFwQjtBQVFELE1BQU0sQ0FBQyxJQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO0FBQzlCLE1BQU0sQ0FBQyxJQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDO0FBQzVCLE1BQU0sQ0FBQyxJQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO0FBQzlCLE1BQU0sQ0FBQyxJQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO0FBQ2hDLE1BQU0sQ0FBQyxJQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO0FBQzlCLE1BQU0sQ0FBQyxJQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO0FBQzlCLE1BQU0sQ0FBQyxJQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO0FBQ2hDLE1BQU0sQ0FBQyxJQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO0FBQzlCLE1BQU0sQ0FBQyxJQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO0FBQzlCLE1BQU0sQ0FBQyxJQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDO0FBRXRDLE1BQU0sQ0FBQyxJQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO0FBQ2xDLE1BQU0sQ0FBQyxJQUFNLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO0FBRWxDLDBGQUEwRjtBQUMxRixJQUFNLFVBQVUsR0FBcUI7SUFDbkMsSUFBSSxFQUFFLENBQUM7SUFDUCxHQUFHLEVBQUUsQ0FBQztJQUNOLElBQUksRUFBRSxDQUFDO0lBQ1AsS0FBSyxFQUFFLENBQUM7SUFDUixJQUFJLEVBQUUsQ0FBQztJQUNQLElBQUksRUFBRSxDQUFDO0lBQ1AsS0FBSyxFQUFFLENBQUM7SUFDUixJQUFJLEVBQUUsQ0FBQztJQUNQLFFBQVEsRUFBRSxDQUFDO0lBQ1gsSUFBSSxFQUFFLENBQUM7SUFDUCxNQUFNLEVBQUUsQ0FBQztJQUNULE1BQU0sRUFBRSxDQUFDO0NBQ1YsQ0FBQztBQUVGLE1BQU0saUJBQWlCLENBQVM7SUFDOUIsT0FBTyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3pCLENBQUM7QUFFRCxNQUFNLHFCQUFxQixDQUF1QjtJQUNoRCxPQUFPLFFBQVEsQ0FBQyxDQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFDaEQsQ0FBQztBQUVELE1BQU0sQ0FBQyxJQUFNLGVBQWUsR0FBRyxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUM7QUErQ3BELE1BQU0sb0JBQW9CLElBQWE7SUFDckMsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDdEIsQ0FBQztBQUVELElBQU0sb0JBQW9CLEdBQUcsS0FBSyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBRXBELE1BQU0sMEJBQTBCLElBQXVEO0lBQ3JGLElBQU0sUUFBUSxHQUFHLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0lBQ3BELE9BQU8sUUFBUSxJQUFJLG9CQUFvQixDQUFDO0FBQzFDLENBQUM7QUFFRCxNQUFNLENBQUMsSUFBTSxhQUFhLEdBQUcsQ0FBQyxRQUFRLEVBQUUsYUFBYTtJQUNuRCxZQUFZLEVBQUUsa0JBQWtCLEVBQUUsZUFBZSxDQUFDLENBQUM7QUFFckQsTUFBTSxDQUFDLElBQU0sV0FBVyxHQUFHLENBQUMsTUFBTSxFQUFFLGFBQWEsQ0FBQyxDQUFDO0FBRW5ELE1BQU0sQ0FBQyxJQUFNLGtCQUFrQixHQUFHLEVBQUUsQ0FBQyxNQUFNLENBQUMsYUFBYSxFQUFFLFdBQVcsQ0FBQyxDQUFDO0FBRXhFLE1BQU0sQ0FBQyxJQUFNLDhCQUE4QixHQUF5QixDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztBQUV4RixNQUFNLENBQUMsSUFBTSwyQ0FBMkMsR0FFcEQ7SUFDRixJQUFJLEVBQUUsQ0FBQyxNQUFNLEVBQUUsT0FBTyxDQUFDO0lBQ3ZCLEdBQUcsRUFBRSxDQUFDLFlBQVksRUFBRSxvQkFBb0IsRUFBRSxrQkFBa0IsQ0FBQztJQUM3RCxJQUFJLEVBQUUsQ0FBQyxPQUFPLENBQUM7SUFDZixJQUFJLEVBQUUsQ0FBQyxpQkFBaUIsQ0FBQztJQUN6QixJQUFJLEVBQUUsQ0FBQyxVQUFVLEVBQUUsV0FBVyxDQUFDO0NBQ2hDLENBQUM7QUFFRixNQUFNLENBQUMsSUFBTSxpQkFBaUIsR0FBZTtJQUMzQyxLQUFLLEVBQUUsU0FBUztDQUNqQixDQUFDO0FBd0pGLE1BQU0sQ0FBQyxJQUFNLGdCQUFnQixHQUFjO0lBQ3pDLFVBQVUsRUFBRSxDQUFDO0lBQ2Isa0JBQWtCLEVBQUUsQ0FBQztDQUN0QixDQUFDO0FBbUJGLE1BQU0sQ0FBQyxJQUFNLGlCQUFpQixHQUFlO0lBQzNDLFNBQVMsRUFBRSxDQUFDO0NBQ2IsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7dG9TZXR9IGZyb20gJ3ZlZ2EtdXRpbCc7XG5pbXBvcnQge0NvbXBvc2l0ZU1hcmssIENvbXBvc2l0ZU1hcmtEZWZ9IGZyb20gJy4vY29tcG9zaXRlbWFyay9pbmRleCc7XG5pbXBvcnQge2NvbnRhaW5zLCBmbGFnS2V5c30gZnJvbSAnLi91dGlsJztcbmltcG9ydCB7VmdNYXJrQ29uZmlnfSBmcm9tICcuL3ZlZ2Euc2NoZW1hJztcblxuZXhwb3J0IG5hbWVzcGFjZSBNYXJrIHtcbiAgZXhwb3J0IGNvbnN0IEFSRUE6ICdhcmVhJyA9ICdhcmVhJztcbiAgZXhwb3J0IGNvbnN0IEJBUjogJ2JhcicgPSAnYmFyJztcbiAgZXhwb3J0IGNvbnN0IExJTkU6ICdsaW5lJyA9ICdsaW5lJztcbiAgZXhwb3J0IGNvbnN0IFBPSU5UOiAncG9pbnQnID0gJ3BvaW50JztcbiAgZXhwb3J0IGNvbnN0IFJFQ1Q6ICdyZWN0JyA9ICdyZWN0JztcbiAgZXhwb3J0IGNvbnN0IFJVTEU6ICdydWxlJyA9ICdydWxlJztcbiAgZXhwb3J0IGNvbnN0IFRFWFQ6ICd0ZXh0JyA9ICd0ZXh0JztcbiAgZXhwb3J0IGNvbnN0IFRJQ0s6ICd0aWNrJyA9ICd0aWNrJztcbiAgZXhwb3J0IGNvbnN0IFRSQUlMOiAndHJhaWwnID0gJ3RyYWlsJztcbiAgZXhwb3J0IGNvbnN0IENJUkNMRTogJ2NpcmNsZScgPSAnY2lyY2xlJztcbiAgZXhwb3J0IGNvbnN0IFNRVUFSRTogJ3NxdWFyZScgPSAnc3F1YXJlJztcbiAgZXhwb3J0IGNvbnN0IEdFT1NIQVBFOiAnZ2Vvc2hhcGUnID0gJ2dlb3NoYXBlJztcbn1cblxuLyoqXG4gKiBBbGwgdHlwZXMgb2YgcHJpbWl0aXZlIG1hcmtzLlxuICovXG5leHBvcnQgdHlwZSBNYXJrID0gdHlwZW9mIE1hcmsuQVJFQSB8IHR5cGVvZiBNYXJrLkJBUiB8IHR5cGVvZiBNYXJrLkxJTkUgfCB0eXBlb2YgTWFyay5UUkFJTCB8IHR5cGVvZiBNYXJrLlBPSU5UIHwgdHlwZW9mIE1hcmsuVEVYVCB8IHR5cGVvZiBNYXJrLlRJQ0sgfCB0eXBlb2YgTWFyay5SRUNUIHwgdHlwZW9mIE1hcmsuUlVMRSB8IHR5cGVvZiBNYXJrLkNJUkNMRSB8IHR5cGVvZiBNYXJrLlNRVUFSRSB8IHR5cGVvZiBNYXJrLkdFT1NIQVBFO1xuXG5cbmV4cG9ydCBjb25zdCBBUkVBID0gTWFyay5BUkVBO1xuZXhwb3J0IGNvbnN0IEJBUiA9IE1hcmsuQkFSO1xuZXhwb3J0IGNvbnN0IExJTkUgPSBNYXJrLkxJTkU7XG5leHBvcnQgY29uc3QgUE9JTlQgPSBNYXJrLlBPSU5UO1xuZXhwb3J0IGNvbnN0IFRFWFQgPSBNYXJrLlRFWFQ7XG5leHBvcnQgY29uc3QgVElDSyA9IE1hcmsuVElDSztcbmV4cG9ydCBjb25zdCBUUkFJTCA9IE1hcmsuVFJBSUw7XG5leHBvcnQgY29uc3QgUkVDVCA9IE1hcmsuUkVDVDtcbmV4cG9ydCBjb25zdCBSVUxFID0gTWFyay5SVUxFO1xuZXhwb3J0IGNvbnN0IEdFT1NIQVBFID0gTWFyay5HRU9TSEFQRTtcblxuZXhwb3J0IGNvbnN0IENJUkNMRSA9IE1hcmsuQ0lSQ0xFO1xuZXhwb3J0IGNvbnN0IFNRVUFSRSA9IE1hcmsuU1FVQVJFO1xuXG4vLyBVc2luZyBtYXBwZWQgdHlwZSB0byBkZWNsYXJlIGluZGV4LCBlbnN1cmluZyB3ZSBhbHdheXMgaGF2ZSBhbGwgbWFya3Mgd2hlbiB3ZSBhZGQgbW9yZS5cbmNvbnN0IE1BUktfSU5ERVg6IHtbTSBpbiBNYXJrXTogMX0gPSB7XG4gIGFyZWE6IDEsXG4gIGJhcjogMSxcbiAgbGluZTogMSxcbiAgcG9pbnQ6IDEsXG4gIHRleHQ6IDEsXG4gIHRpY2s6IDEsXG4gIHRyYWlsOiAxLFxuICByZWN0OiAxLFxuICBnZW9zaGFwZTogMSxcbiAgcnVsZTogMSxcbiAgY2lyY2xlOiAxLFxuICBzcXVhcmU6IDFcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBpc01hcmsobTogc3RyaW5nKTogbSBpcyBNYXJrIHtcbiAgcmV0dXJuICEhTUFSS19JTkRFWFttXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzUGF0aE1hcmsobTogTWFyayB8IENvbXBvc2l0ZU1hcmspOiBtIGlzICdsaW5lJyB8ICdhcmVhJyB8ICd0cmFpbCcge1xuICByZXR1cm4gY29udGFpbnMoWydsaW5lJywgJ2FyZWEnLCAndHJhaWwnXSwgbSk7XG59XG5cbmV4cG9ydCBjb25zdCBQUklNSVRJVkVfTUFSS1MgPSBmbGFnS2V5cyhNQVJLX0lOREVYKTtcblxuXG5leHBvcnQgaW50ZXJmYWNlIE1hcmtDb25maWcgZXh0ZW5kcyBWZ01hcmtDb25maWcge1xuICAvLyAtLS0tLS0tLS0tIENvbG9yIC0tLS0tLS0tLS1cbiAgLyoqXG4gICAqIFdoZXRoZXIgdGhlIG1hcmsncyBjb2xvciBzaG91bGQgYmUgdXNlZCBhcyBmaWxsIGNvbG9yIGluc3RlYWQgb2Ygc3Ryb2tlIGNvbG9yLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYHRydWVgIGZvciBhbGwgbWFya3MgZXhjZXB0IGBwb2ludGAgYW5kIGBmYWxzZWAgZm9yIGBwb2ludGAuXG4gICAqXG4gICAqIF9fQXBwbGljYWJsZSBmb3I6X18gYGJhcmAsIGBwb2ludGAsIGBjaXJjbGVgLCBgc3F1YXJlYCwgYW5kIGBhcmVhYCBtYXJrcy5cbiAgICpcbiAgICogX19Ob3RlOl9fIFRoaXMgcHJvcGVydHkgY2Fubm90IGJlIHVzZWQgaW4gYSBbc3R5bGUgY29uZmlnXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL21hcmsuaHRtbCNzdHlsZS1jb25maWcpLlxuICAgKlxuICAgKi9cbiAgZmlsbGVkPzogYm9vbGVhbjtcblxuICAvKipcbiAgICogRGVmYXVsdCBjb2xvci4gIE5vdGUgdGhhdCBgZmlsbGAgYW5kIGBzdHJva2VgIGhhdmUgaGlnaGVyIHByZWNlZGVuY2UgdGhhbiBgY29sb3JgIGFuZCB3aWxsIG92ZXJyaWRlIGBjb2xvcmAuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyA8c3BhbiBzdHlsZT1cImNvbG9yOiAjNDY4MmI0O1wiPiYjOTYzMjs8L3NwYW4+IGBcIiM0NjgyYjRcImBcbiAgICpcbiAgICogX19Ob3RlOl9fIFRoaXMgcHJvcGVydHkgY2Fubm90IGJlIHVzZWQgaW4gYSBbc3R5bGUgY29uZmlnXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL21hcmsuaHRtbCNzdHlsZS1jb25maWcpLlxuICAgKi9cbiAgY29sb3I/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmFyQmluU3BhY2luZ01peGlucyB7XG4gIC8qKlxuICAgKiBPZmZzZXQgYmV0d2VlbiBiYXJzIGZvciBiaW5uZWQgZmllbGQuICBJZGVhbCB2YWx1ZSBmb3IgdGhpcyBpcyBlaXRoZXIgMCAoUHJlZmVycmVkIGJ5IHN0YXRpc3RpY2lhbnMpIG9yIDEgKFZlZ2EtTGl0ZSBEZWZhdWx0LCBEMyBleGFtcGxlIHN0eWxlKS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGAxYFxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBiaW5TcGFjaW5nPzogbnVtYmVyO1xufVxuXG5cbi8qKiBAaGlkZSAqL1xuZXhwb3J0IHR5cGUgSGlkZGVuQ29tcG9zaXRlID0gQ29tcG9zaXRlTWFyayB8IENvbXBvc2l0ZU1hcmtEZWY7XG5cbmV4cG9ydCB0eXBlIEFueU1hcmsgPVxuICBIaWRkZW5Db21wb3NpdGUgfFxuICBNYXJrIHxcbiAgTWFya0RlZjtcblxuZXhwb3J0IGZ1bmN0aW9uIGlzTWFya0RlZihtYXJrOiBBbnlNYXJrKTogbWFyayBpcyAoTWFya0RlZiB8IENvbXBvc2l0ZU1hcmtEZWYpIHtcbiAgcmV0dXJuIG1hcmtbJ3R5cGUnXTtcbn1cblxuY29uc3QgUFJJTUlUSVZFX01BUktfSU5ERVggPSB0b1NldChQUklNSVRJVkVfTUFSS1MpO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNQcmltaXRpdmVNYXJrKG1hcms6IENvbXBvc2l0ZU1hcmsgfCBDb21wb3NpdGVNYXJrRGVmIHwgTWFyayB8IE1hcmtEZWYpOiBtYXJrIGlzIE1hcmsge1xuICBjb25zdCBtYXJrVHlwZSA9IGlzTWFya0RlZihtYXJrKSA/IG1hcmsudHlwZSA6IG1hcms7XG4gIHJldHVybiBtYXJrVHlwZSBpbiBQUklNSVRJVkVfTUFSS19JTkRFWDtcbn1cblxuZXhwb3J0IGNvbnN0IFNUUk9LRV9DT05GSUcgPSBbJ3N0cm9rZScsICdzdHJva2VXaWR0aCcsXG4gICdzdHJva2VEYXNoJywgJ3N0cm9rZURhc2hPZmZzZXQnLCAnc3Ryb2tlT3BhY2l0eSddO1xuXG5leHBvcnQgY29uc3QgRklMTF9DT05GSUcgPSBbJ2ZpbGwnLCAnZmlsbE9wYWNpdHknXTtcblxuZXhwb3J0IGNvbnN0IEZJTExfU1RST0tFX0NPTkZJRyA9IFtdLmNvbmNhdChTVFJPS0VfQ09ORklHLCBGSUxMX0NPTkZJRyk7XG5cbmV4cG9ydCBjb25zdCBWTF9PTkxZX01BUktfQ09ORklHX1BST1BFUlRJRVM6IChrZXlvZiBNYXJrQ29uZmlnKVtdID0gWydmaWxsZWQnLCAnY29sb3InXTtcblxuZXhwb3J0IGNvbnN0IFZMX09OTFlfTUFSS19TUEVDSUZJQ19DT05GSUdfUFJPUEVSVFlfSU5ERVg6IHtcbiAgW2sgaW4gKHR5cGVvZiBQUklNSVRJVkVfTUFSS1NbMF0pXT86IChrZXlvZiBNYXJrQ29uZmlnTWl4aW5zW2tdKVtdXG59ID0ge1xuICBhcmVhOiBbJ2xpbmUnLCAncG9pbnQnXSxcbiAgYmFyOiBbJ2JpblNwYWNpbmcnLCAnY29udGludW91c0JhbmRTaXplJywgJ2Rpc2NyZXRlQmFuZFNpemUnXSxcbiAgbGluZTogWydwb2ludCddLFxuICB0ZXh0OiBbJ3Nob3J0VGltZUxhYmVscyddLFxuICB0aWNrOiBbJ2JhbmRTaXplJywgJ3RoaWNrbmVzcyddXG59O1xuXG5leHBvcnQgY29uc3QgZGVmYXVsdE1hcmtDb25maWc6IE1hcmtDb25maWcgPSB7XG4gIGNvbG9yOiAnIzRjNzhhOCcsXG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIE1hcmtDb25maWdNaXhpbnMge1xuICAvKiogTWFyayBDb25maWcgKi9cbiAgbWFyaz86IE1hcmtDb25maWc7XG5cbiAgLy8gTUFSSy1TUEVDSUZJQyBDT05GSUdTXG4gIC8qKiBBcmVhLVNwZWNpZmljIENvbmZpZyAqL1xuICBhcmVhPzogQXJlYUNvbmZpZztcblxuICAvKiogQmFyLVNwZWNpZmljIENvbmZpZyAqL1xuICBiYXI/OiBCYXJDb25maWc7XG5cbiAgLyoqIENpcmNsZS1TcGVjaWZpYyBDb25maWcgKi9cbiAgY2lyY2xlPzogTWFya0NvbmZpZztcblxuICAvKiogTGluZS1TcGVjaWZpYyBDb25maWcgKi9cbiAgbGluZT86IExpbmVDb25maWc7XG5cbiAgLyoqIFBvaW50LVNwZWNpZmljIENvbmZpZyAqL1xuICBwb2ludD86IE1hcmtDb25maWc7XG5cbiAgLyoqIFJlY3QtU3BlY2lmaWMgQ29uZmlnICovXG4gIHJlY3Q/OiBNYXJrQ29uZmlnO1xuXG4gIC8qKiBSdWxlLVNwZWNpZmljIENvbmZpZyAqL1xuICBydWxlPzogTWFya0NvbmZpZztcblxuICAvKiogU3F1YXJlLVNwZWNpZmljIENvbmZpZyAqL1xuICBzcXVhcmU/OiBNYXJrQ29uZmlnO1xuXG4gIC8qKiBUZXh0LVNwZWNpZmljIENvbmZpZyAqL1xuICB0ZXh0PzogVGV4dENvbmZpZztcblxuICAvKiogVGljay1TcGVjaWZpYyBDb25maWcgKi9cbiAgdGljaz86IFRpY2tDb25maWc7XG5cbiAgLyoqIFRyYWlsLVNwZWNpZmljIENvbmZpZyAqL1xuICB0cmFpbD86IExpbmVDb25maWc7XG5cbiAgLyoqIEdlb3NoYXBlLVNwZWNpZmljIENvbmZpZyAqL1xuICBnZW9zaGFwZT86IE1hcmtDb25maWc7XG59XG5cblxuZXhwb3J0IGludGVyZmFjZSBCYXJDb25maWcgZXh0ZW5kcyBCYXJCaW5TcGFjaW5nTWl4aW5zLCBNYXJrQ29uZmlnIHtcblxuICAvKipcbiAgICogVGhlIGRlZmF1bHQgc2l6ZSBvZiB0aGUgYmFycyBvbiBjb250aW51b3VzIHNjYWxlcy5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGA1YFxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBjb250aW51b3VzQmFuZFNpemU/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBzaXplIG9mIHRoZSBiYXJzLiAgSWYgdW5zcGVjaWZpZWQsIHRoZSBkZWZhdWx0IHNpemUgaXMgIGBiYW5kU2l6ZS0xYCxcbiAgICogd2hpY2ggcHJvdmlkZXMgMSBwaXhlbCBvZmZzZXQgYmV0d2VlbiBiYXJzLlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBkaXNjcmV0ZUJhbmRTaXplPzogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBvaW50T3ZlcmxheU1peGlucyB7XG4gIC8qKlxuICAgKiBBIGZsYWcgZm9yIG92ZXJsYXlpbmcgcG9pbnRzIG9uIHRvcCBvZiBsaW5lIG9yIGFyZWEgbWFya3MsIG9yIGFuIG9iamVjdCBkZWZpbmluZyB0aGUgcHJvcGVydGllcyBvZiB0aGUgb3ZlcmxheWVkIHBvaW50cy5cbiAgICpcbiAgICogLSBJZiB0aGlzIHByb3BlcnR5IGlzIGBcInRyYW5zcGFyZW50XCJgLCB0cmFuc3BhcmVudCBwb2ludHMgd2lsbCBiZSB1c2VkIChmb3IgZW5oYW5jaW5nIHRvb2x0aXBzIGFuZCBzZWxlY3Rpb25zKS5cbiAgICpcbiAgICogLSBJZiB0aGlzIHByb3BlcnR5IGlzIGFuIGVtcHR5IG9iamVjdCAoYHt9YCkgb3IgYHRydWVgLCBmaWxsZWQgcG9pbnRzIHdpdGggZGVmYXVsdCBwcm9wZXJ0aWVzIHdpbGwgYmUgdXNlZC5cbiAgICpcbiAgICogLSBJZiB0aGlzIHByb3BlcnR5IGlzIGBmYWxzZWAsIG5vIHBvaW50cyB3b3VsZCBiZSBhdXRvbWF0aWNhbGx5IGFkZGVkIHRvIGxpbmUgb3IgYXJlYSBtYXJrcy5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBmYWxzZWAuXG4gICAqL1xuICBwb2ludD86IGJvb2xlYW4gfCBNYXJrQ29uZmlnIHwgJ3RyYW5zcGFyZW50Jztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMaW5lQ29uZmlnIGV4dGVuZHMgTWFya0NvbmZpZywgUG9pbnRPdmVybGF5TWl4aW5zIHt9XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGluZU92ZXJsYXlNaXhpbnMge1xuICAvKipcbiAgICogQSBmbGFnIGZvciBvdmVybGF5aW5nIGxpbmUgb24gdG9wIG9mIGFyZWEgbWFya3MsIG9yIGFuIG9iamVjdCBkZWZpbmluZyB0aGUgcHJvcGVydGllcyBvZiB0aGUgb3ZlcmxheWVkIGxpbmVzLlxuICAgKlxuICAgKiAtIElmIHRoaXMgdmFsdWUgaXMgYW4gZW1wdHkgb2JqZWN0IChge31gKSBvciBgdHJ1ZWAsIGxpbmVzIHdpdGggZGVmYXVsdCBwcm9wZXJ0aWVzIHdpbGwgYmUgdXNlZC5cbiAgICpcbiAgICogLSBJZiB0aGlzIHZhbHVlIGlzIGBmYWxzZWAsIG5vIGxpbmVzIHdvdWxkIGJlIGF1dG9tYXRpY2FsbHkgYWRkZWQgdG8gYXJlYSBtYXJrcy5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBmYWxzZWAuXG4gICAqL1xuICBsaW5lPzogYm9vbGVhbiB8IE1hcmtDb25maWc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXJlYUNvbmZpZyBleHRlbmRzIE1hcmtDb25maWcsIFBvaW50T3ZlcmxheU1peGlucywgTGluZU92ZXJsYXlNaXhpbnMge31cblxuZXhwb3J0IGludGVyZmFjZSBUaWNrVGhpY2tuZXNzTWl4aW5zIHtcbiAgLyoqXG4gICAqIFRoaWNrbmVzcyBvZiB0aGUgdGljayBtYXJrLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gIGAxYFxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICB0aGlja25lc3M/OiBudW1iZXI7XG59XG5cbi8vIFBvaW50L0xpbmUgT3ZlcmxheU1peGlucyBhcmUgb25seSBmb3IgYXJlYSwgbGluZSwgYW5kIHRyYWlsIGJ1dCB3ZSBkb24ndCB3YW50IHRvIGRlY2xhcmUgbXVsdGlwbGUgdHlwZXMgb2YgTWFya0RlZlxuZXhwb3J0IGludGVyZmFjZSBNYXJrRGVmIGV4dGVuZHMgQmFyQmluU3BhY2luZ01peGlucywgTWFya0NvbmZpZywgUG9pbnRPdmVybGF5TWl4aW5zLCBMaW5lT3ZlcmxheU1peGlucywgVGlja1RoaWNrbmVzc01peGlucyB7XG4gIC8qKlxuICAgKiBUaGUgbWFyayB0eXBlLlxuICAgKiBPbmUgb2YgYFwiYmFyXCJgLCBgXCJjaXJjbGVcImAsIGBcInNxdWFyZVwiYCwgYFwidGlja1wiYCwgYFwibGluZVwiYCxcbiAgICogYFwiYXJlYVwiYCwgYFwicG9pbnRcImAsIGBcImdlb3NoYXBlXCJgLCBgXCJydWxlXCJgLCBhbmQgYFwidGV4dFwiYC5cbiAgICovXG4gIHR5cGU6IE1hcms7XG5cbiAgLyoqXG4gICAqIEEgc3RyaW5nIG9yIGFycmF5IG9mIHN0cmluZ3MgaW5kaWNhdGluZyB0aGUgbmFtZSBvZiBjdXN0b20gc3R5bGVzIHRvIGFwcGx5IHRvIHRoZSBtYXJrLiBBIHN0eWxlIGlzIGEgbmFtZWQgY29sbGVjdGlvbiBvZiBtYXJrIHByb3BlcnR5IGRlZmF1bHRzIGRlZmluZWQgd2l0aGluIHRoZSBbc3R5bGUgY29uZmlndXJhdGlvbl0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9tYXJrLmh0bWwjc3R5bGUtY29uZmlnKS4gSWYgc3R5bGUgaXMgYW4gYXJyYXksIGxhdGVyIHN0eWxlcyB3aWxsIG92ZXJyaWRlIGVhcmxpZXIgc3R5bGVzLiBBbnkgW21hcmsgcHJvcGVydGllc10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9lbmNvZGluZy5odG1sI21hcmstcHJvcCkgZXhwbGljaXRseSBkZWZpbmVkIHdpdGhpbiB0aGUgYGVuY29kaW5nYCB3aWxsIG92ZXJyaWRlIGEgc3R5bGUgZGVmYXVsdC5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIFRoZSBtYXJrJ3MgbmFtZS4gIEZvciBleGFtcGxlLCBhIGJhciBtYXJrIHdpbGwgaGF2ZSBzdHlsZSBgXCJiYXJcImAgYnkgZGVmYXVsdC5cbiAgICogX19Ob3RlOl9fIEFueSBzcGVjaWZpZWQgc3R5bGUgd2lsbCBhdWdtZW50IHRoZSBkZWZhdWx0IHN0eWxlLiBGb3IgZXhhbXBsZSwgYSBiYXIgbWFyayB3aXRoIGBcInN0eWxlXCI6IFwiZm9vXCJgIHdpbGwgcmVjZWl2ZSBmcm9tIGBjb25maWcuc3R5bGUuYmFyYCBhbmQgYGNvbmZpZy5zdHlsZS5mb29gICh0aGUgc3BlY2lmaWVkIHN0eWxlIGBcImZvb1wiYCBoYXMgaGlnaGVyIHByZWNlZGVuY2UpLlxuICAgKi9cbiAgc3R5bGU/OiBzdHJpbmcgfCBzdHJpbmdbXTtcblxuICAvKipcbiAgICogV2hldGhlciBhIG1hcmsgYmUgY2xpcHBlZCB0byB0aGUgZW5jbG9zaW5nIGdyb3Vw4oCZcyB3aWR0aCBhbmQgaGVpZ2h0LlxuICAgKi9cbiAgY2xpcD86IGJvb2xlYW47XG5cbiAgLy8gT2Zmc2V0IHByb3BlcnRpZXMgc2hvdWxkIG5vdCBiZSBhIHBhcnQgb2YgY29uZmlnXG5cbiAgLyoqXG4gICAqIE9mZnNldCBmb3IgeC1wb3NpdGlvbi5cbiAgICovXG4gIHhPZmZzZXQ/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIE9mZnNldCBmb3IgeS1wb3NpdGlvbi5cbiAgICovXG4gIHlPZmZzZXQ/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIE9mZnNldCBmb3IgeDItcG9zaXRpb24uXG4gICAqL1xuICB4Mk9mZnNldD86IG51bWJlcjtcblxuICAvKipcbiAgICogT2Zmc2V0IGZvciB5Mi1wb3NpdGlvbi5cbiAgICovXG4gIHkyT2Zmc2V0PzogbnVtYmVyO1xufVxuXG5leHBvcnQgY29uc3QgZGVmYXVsdEJhckNvbmZpZzogQmFyQ29uZmlnID0ge1xuICBiaW5TcGFjaW5nOiAxLFxuICBjb250aW51b3VzQmFuZFNpemU6IDVcbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGV4dENvbmZpZyBleHRlbmRzIE1hcmtDb25maWcge1xuICAvKipcbiAgICogV2hldGhlciBtb250aCBuYW1lcyBhbmQgd2Vla2RheSBuYW1lcyBzaG91bGQgYmUgYWJicmV2aWF0ZWQuXG4gICAqL1xuICBzaG9ydFRpbWVMYWJlbHM/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRpY2tDb25maWcgZXh0ZW5kcyBNYXJrQ29uZmlnLCBUaWNrVGhpY2tuZXNzTWl4aW5zIHtcbiAgLyoqXG4gICAqIFRoZSB3aWR0aCBvZiB0aGUgdGlja3MuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyAgMi8zIG9mIHJhbmdlU3RlcC5cbiAgICogQG1pbmltdW0gMFxuICAgKi9cbiAgYmFuZFNpemU/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBjb25zdCBkZWZhdWx0VGlja0NvbmZpZzogVGlja0NvbmZpZyA9IHtcbiAgdGhpY2tuZXNzOiAxXG59O1xuIl19","/**\n * Vega-Lite's singleton logger utility.\n */\nimport { logger, Warn } from 'vega-util';\nimport { stringify } from './util';\n/**\n * Main (default) Vega Logger instance for Vega-Lite\n */\nvar main = logger(Warn);\nvar current = main;\n/**\n * Logger tool for checking if the code throws correct warning\n */\nvar LocalLogger = /** @class */ (function () {\n    function LocalLogger() {\n        this.warns = [];\n        this.infos = [];\n        this.debugs = [];\n    }\n    LocalLogger.prototype.level = function () {\n        return this;\n    };\n    LocalLogger.prototype.warn = function () {\n        var _a;\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        (_a = this.warns).push.apply(_a, args);\n        return this;\n    };\n    LocalLogger.prototype.info = function () {\n        var _a;\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        (_a = this.infos).push.apply(_a, args);\n        return this;\n    };\n    LocalLogger.prototype.debug = function () {\n        var _a;\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        (_a = this.debugs).push.apply(_a, args);\n        return this;\n    };\n    return LocalLogger;\n}());\nexport { LocalLogger };\nexport function wrap(f) {\n    return function () {\n        current = new LocalLogger();\n        f(current);\n        reset();\n    };\n}\n/**\n * Set the singleton logger to be a custom logger\n */\nexport function set(newLogger) {\n    current = newLogger;\n    return current;\n}\n/**\n * Reset the main logger to use the default Vega Logger\n */\nexport function reset() {\n    current = main;\n    return current;\n}\nexport function warn() {\n    var _ = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        _[_i] = arguments[_i];\n    }\n    current.warn.apply(current, arguments);\n}\nexport function info() {\n    var _ = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        _[_i] = arguments[_i];\n    }\n    current.info.apply(current, arguments);\n}\nexport function debug() {\n    var _ = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        _[_i] = arguments[_i];\n    }\n    current.debug.apply(current, arguments);\n}\n/**\n * Collection of all Vega-Lite Error Messages\n */\nexport var message;\n(function (message) {\n    message.INVALID_SPEC = 'Invalid spec';\n    // FIT\n    message.FIT_NON_SINGLE = 'Autosize \"fit\" only works for single views and layered views.';\n    message.CANNOT_FIX_RANGE_STEP_WITH_FIT = 'Cannot use a fixed value of \"rangeStep\" when \"autosize\" is \"fit\".';\n    // SELECTION\n    function cannotProjectOnChannelWithoutField(channel) {\n        return \"Cannot project a selection on encoding channel \\\"\" + channel + \"\\\", which has no field.\";\n    }\n    message.cannotProjectOnChannelWithoutField = cannotProjectOnChannelWithoutField;\n    function nearestNotSupportForContinuous(mark) {\n        return \"The \\\"nearest\\\" transform is not supported for \" + mark + \" marks.\";\n    }\n    message.nearestNotSupportForContinuous = nearestNotSupportForContinuous;\n    function selectionNotFound(name) {\n        return \"Cannot find a selection named \\\"\" + name + \"\\\"\";\n    }\n    message.selectionNotFound = selectionNotFound;\n    message.SCALE_BINDINGS_CONTINUOUS = 'Scale bindings are currently only supported for scales with unbinned, continuous domains.';\n    // REPEAT\n    function noSuchRepeatedValue(field) {\n        return \"Unknown repeated value \\\"\" + field + \"\\\".\";\n    }\n    message.noSuchRepeatedValue = noSuchRepeatedValue;\n    // CONCAT\n    message.CONCAT_CANNOT_SHARE_AXIS = 'Axes cannot be shared in concatenated views.';\n    // REPEAT\n    message.REPEAT_CANNOT_SHARE_AXIS = 'Axes cannot be shared in repeated views.';\n    // TITLE\n    function cannotSetTitleAnchor(type) {\n        return \"Cannot set title \\\"anchor\\\" for a \" + type + \" spec\";\n    }\n    message.cannotSetTitleAnchor = cannotSetTitleAnchor;\n    // DATA\n    function unrecognizedParse(p) {\n        return \"Unrecognized parse \\\"\" + p + \"\\\".\";\n    }\n    message.unrecognizedParse = unrecognizedParse;\n    function differentParse(field, local, ancestor) {\n        return \"An ancestor parsed field \\\"\" + field + \"\\\" as \" + ancestor + \" but a child wants to parse the field as \" + local + \".\";\n    }\n    message.differentParse = differentParse;\n    // TRANSFORMS\n    function invalidTransformIgnored(transform) {\n        return \"Ignoring an invalid transform: \" + stringify(transform) + \".\";\n    }\n    message.invalidTransformIgnored = invalidTransformIgnored;\n    message.NO_FIELDS_NEEDS_AS = 'If \"from.fields\" is not specified, \"as\" has to be a string that specifies the key to be used for the data from the secondary source.';\n    // ENCODING & FACET\n    function encodingOverridden(channels) {\n        return \"Layer's shared \" + channels.join(',') + \" channel \" + (channels.length === 1 ? 'is' : 'are') + \" overriden\";\n    }\n    message.encodingOverridden = encodingOverridden;\n    function projectionOverridden(opt) {\n        var parentProjection = opt.parentProjection, projection = opt.projection;\n        return \"Layer's shared projection \" + stringify(parentProjection) + \" is overridden by a child projection \" + stringify(projection) + \".\";\n    }\n    message.projectionOverridden = projectionOverridden;\n    function primitiveChannelDef(channel, type, value) {\n        return \"Channel \" + channel + \" is a \" + type + \". Converted to {value: \" + stringify(value) + \"}.\";\n    }\n    message.primitiveChannelDef = primitiveChannelDef;\n    function invalidFieldType(type) {\n        return \"Invalid field type \\\"\" + type + \"\\\"\";\n    }\n    message.invalidFieldType = invalidFieldType;\n    function nonZeroScaleUsedWithLengthMark(mark, channel, opt) {\n        var scaleText = opt.scaleType ? opt.scaleType + \" scale\" :\n            opt.zeroFalse ? 'scale with zero=false' :\n                'scale with custom domain that excludes zero';\n        return \"A \" + scaleText + \" is used with \" + mark + \" mark. This can be misleading as the \" + (channel === 'x' ? 'width' : 'height') + \" of the \" + mark + \" can be arbitrary based on the scale domain. You may want to use point mark instead.\";\n    }\n    message.nonZeroScaleUsedWithLengthMark = nonZeroScaleUsedWithLengthMark;\n    function invalidFieldTypeForCountAggregate(type, aggregate) {\n        return \"Invalid field type \\\"\" + type + \"\\\" for aggregate: \\\"\" + aggregate + \"\\\", using \\\"quantitative\\\" instead.\";\n    }\n    message.invalidFieldTypeForCountAggregate = invalidFieldTypeForCountAggregate;\n    function invalidAggregate(aggregate) {\n        return \"Invalid aggregation operator \\\"\" + aggregate + \"\\\"\";\n    }\n    message.invalidAggregate = invalidAggregate;\n    function emptyOrInvalidFieldType(type, channel, newType) {\n        return \"Invalid field type \\\"\" + type + \"\\\" for channel \\\"\" + channel + \"\\\", using \\\"\" + newType + \"\\\" instead.\";\n    }\n    message.emptyOrInvalidFieldType = emptyOrInvalidFieldType;\n    function droppingColor(type, opt) {\n        var fill = opt.fill, stroke = opt.stroke;\n        return \"Dropping color \" + type + \" as the plot also has \" + (fill && stroke ? 'fill and stroke' : fill ? 'fill' : 'stroke');\n    }\n    message.droppingColor = droppingColor;\n    function emptyFieldDef(fieldDef, channel) {\n        return \"Dropping \" + stringify(fieldDef) + \" from channel \\\"\" + channel + \"\\\" since it does not contain data field or value.\";\n    }\n    message.emptyFieldDef = emptyFieldDef;\n    function latLongDeprecated(channel, type, newChannel) {\n        return channel + \"-encoding with type \" + type + \" is deprecated. Replacing with \" + newChannel + \"-encoding.\";\n    }\n    message.latLongDeprecated = latLongDeprecated;\n    message.LINE_WITH_VARYING_SIZE = 'Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.';\n    function incompatibleChannel(channel, markOrFacet, when) {\n        return channel + \" dropped as it is incompatible with \\\"\" + markOrFacet + \"\\\"\" + (when ? \" when \" + when : '') + \".\";\n    }\n    message.incompatibleChannel = incompatibleChannel;\n    function invalidEncodingChannel(channel) {\n        return channel + \"-encoding is dropped as \" + channel + \" is not a valid encoding channel.\";\n    }\n    message.invalidEncodingChannel = invalidEncodingChannel;\n    function facetChannelShouldBeDiscrete(channel) {\n        return channel + \" encoding should be discrete (ordinal / nominal / binned).\";\n    }\n    message.facetChannelShouldBeDiscrete = facetChannelShouldBeDiscrete;\n    function discreteChannelCannotEncode(channel, type) {\n        return \"Using discrete channel \\\"\" + channel + \"\\\" to encode \\\"\" + type + \"\\\" field can be misleading as it does not encode \" + (type === 'ordinal' ? 'order' : 'magnitude') + \".\";\n    }\n    message.discreteChannelCannotEncode = discreteChannelCannotEncode;\n    // Mark\n    message.BAR_WITH_POINT_SCALE_AND_RANGESTEP_NULL = 'Bar mark should not be used with point scale when rangeStep is null. Please use band scale instead.';\n    function lineWithRange(hasX2, hasY2) {\n        var channels = hasX2 && hasY2 ? 'x2 and y2' : hasX2 ? 'x2' : 'y2';\n        return \"Line mark is for continuous lines and thus cannot be used with \" + channels + \". We will use the rule mark (line segments) instead.\";\n    }\n    message.lineWithRange = lineWithRange;\n    function unclearOrientContinuous(mark) {\n        return \"Cannot clearly determine orientation for \\\"\" + mark + \"\\\" since both x and y channel encode continuous fields. In this case, we use vertical by default\";\n    }\n    message.unclearOrientContinuous = unclearOrientContinuous;\n    function unclearOrientDiscreteOrEmpty(mark) {\n        return \"Cannot clearly determine orientation for \\\"\" + mark + \"\\\" since both x and y channel encode discrete or empty fields.\";\n    }\n    message.unclearOrientDiscreteOrEmpty = unclearOrientDiscreteOrEmpty;\n    function orientOverridden(original, actual) {\n        return \"Specified orient \\\"\" + original + \"\\\" overridden with \\\"\" + actual + \"\\\"\";\n    }\n    message.orientOverridden = orientOverridden;\n    // SCALE\n    message.CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN = 'custom domain scale cannot be unioned with default field-based domain';\n    function cannotUseScalePropertyWithNonColor(prop) {\n        return \"Cannot use the scale property \\\"\" + prop + \"\\\" with non-color channel.\";\n    }\n    message.cannotUseScalePropertyWithNonColor = cannotUseScalePropertyWithNonColor;\n    function unaggregateDomainHasNoEffectForRawField(fieldDef) {\n        return \"Using unaggregated domain with raw field has no effect (\" + stringify(fieldDef) + \").\";\n    }\n    message.unaggregateDomainHasNoEffectForRawField = unaggregateDomainHasNoEffectForRawField;\n    function unaggregateDomainWithNonSharedDomainOp(aggregate) {\n        return \"Unaggregated domain not applicable for \\\"\" + aggregate + \"\\\" since it produces values outside the origin domain of the source data.\";\n    }\n    message.unaggregateDomainWithNonSharedDomainOp = unaggregateDomainWithNonSharedDomainOp;\n    function unaggregatedDomainWithLogScale(fieldDef) {\n        return \"Unaggregated domain is currently unsupported for log scale (\" + stringify(fieldDef) + \").\";\n    }\n    message.unaggregatedDomainWithLogScale = unaggregatedDomainWithLogScale;\n    function cannotApplySizeToNonOrientedMark(mark) {\n        return \"Cannot apply size to non-oriented mark \\\"\" + mark + \"\\\".\";\n    }\n    message.cannotApplySizeToNonOrientedMark = cannotApplySizeToNonOrientedMark;\n    function rangeStepDropped(channel) {\n        return \"rangeStep for \\\"\" + channel + \"\\\" is dropped as top-level \" + (channel === 'x' ? 'width' : 'height') + \" is provided.\";\n    }\n    message.rangeStepDropped = rangeStepDropped;\n    function scaleTypeNotWorkWithChannel(channel, scaleType, defaultScaleType) {\n        return \"Channel \\\"\" + channel + \"\\\" does not work with \\\"\" + scaleType + \"\\\" scale. We are using \\\"\" + defaultScaleType + \"\\\" scale instead.\";\n    }\n    message.scaleTypeNotWorkWithChannel = scaleTypeNotWorkWithChannel;\n    function scaleTypeNotWorkWithFieldDef(scaleType, defaultScaleType) {\n        return \"FieldDef does not work with \\\"\" + scaleType + \"\\\" scale. We are using \\\"\" + defaultScaleType + \"\\\" scale instead.\";\n    }\n    message.scaleTypeNotWorkWithFieldDef = scaleTypeNotWorkWithFieldDef;\n    function scalePropertyNotWorkWithScaleType(scaleType, propName, channel) {\n        return channel + \"-scale's \\\"\" + propName + \"\\\" is dropped as it does not work with \" + scaleType + \" scale.\";\n    }\n    message.scalePropertyNotWorkWithScaleType = scalePropertyNotWorkWithScaleType;\n    function scaleTypeNotWorkWithMark(mark, scaleType) {\n        return \"Scale type \\\"\" + scaleType + \"\\\" does not work with mark \\\"\" + mark + \"\\\".\";\n    }\n    message.scaleTypeNotWorkWithMark = scaleTypeNotWorkWithMark;\n    function mergeConflictingProperty(property, propertyOf, v1, v2) {\n        return \"Conflicting \" + propertyOf.toString() + \" property \\\"\" + property.toString() + \"\\\" (\" + stringify(v1) + \" and \" + stringify(v2) + \").  Using \" + stringify(v1) + \".\";\n    }\n    message.mergeConflictingProperty = mergeConflictingProperty;\n    function independentScaleMeansIndependentGuide(channel) {\n        return \"Setting the scale to be independent for \\\"\" + channel + \"\\\" means we also have to set the guide (axis or legend) to be independent.\";\n    }\n    message.independentScaleMeansIndependentGuide = independentScaleMeansIndependentGuide;\n    function domainSortDropped(sort) {\n        return \"Dropping sort property \" + stringify(sort) + \" as unioned domains only support boolean or op 'count'.\";\n    }\n    message.domainSortDropped = domainSortDropped;\n    message.UNABLE_TO_MERGE_DOMAINS = 'Unable to merge domains';\n    message.MORE_THAN_ONE_SORT = 'Domains that should be unioned has conflicting sort properties. Sort will be set to true.';\n    // AXIS\n    message.INVALID_CHANNEL_FOR_AXIS = 'Invalid channel for axis.';\n    // STACK\n    function cannotStackRangedMark(channel) {\n        return \"Cannot stack \\\"\" + channel + \"\\\" if there is already \\\"\" + channel + \"2\\\"\";\n    }\n    message.cannotStackRangedMark = cannotStackRangedMark;\n    function cannotStackNonLinearScale(scaleType) {\n        return \"Cannot stack non-linear scale (\" + scaleType + \")\";\n    }\n    message.cannotStackNonLinearScale = cannotStackNonLinearScale;\n    function stackNonSummativeAggregate(aggregate) {\n        return \"Stacking is applied even though the aggregate function is non-summative (\\\"\" + aggregate + \"\\\")\";\n    }\n    message.stackNonSummativeAggregate = stackNonSummativeAggregate;\n    // TIMEUNIT\n    function invalidTimeUnit(unitName, value) {\n        return \"Invalid \" + unitName + \": \" + stringify(value);\n    }\n    message.invalidTimeUnit = invalidTimeUnit;\n    function dayReplacedWithDate(fullTimeUnit) {\n        return \"Time unit \\\"\" + fullTimeUnit + \"\\\" is not supported. We are replacing it with \" + fullTimeUnit.replace('day', 'date') + \".\";\n    }\n    message.dayReplacedWithDate = dayReplacedWithDate;\n    function droppedDay(d) {\n        return \"Dropping day from datetime \" + stringify(d) + \" as day cannot be combined with other units.\";\n    }\n    message.droppedDay = droppedDay;\n})(message || (message = {}));\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9nLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2xvZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7R0FFRztBQUdILE9BQU8sRUFBQyxNQUFNLEVBQW1CLElBQUksRUFBQyxNQUFNLFdBQVcsQ0FBQztBQVN4RCxPQUFPLEVBQUMsU0FBUyxFQUFDLE1BQU0sUUFBUSxDQUFDO0FBTWpDOztHQUVHO0FBQ0gsSUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQzFCLElBQUksT0FBTyxHQUFvQixJQUFJLENBQUM7QUFFcEM7O0dBRUc7QUFDSDtJQUFBO1FBQ1MsVUFBSyxHQUFVLEVBQUUsQ0FBQztRQUNsQixVQUFLLEdBQVUsRUFBRSxDQUFDO1FBQ2xCLFdBQU0sR0FBVSxFQUFFLENBQUM7SUFvQjVCLENBQUM7SUFsQlEsMkJBQUssR0FBWjtRQUNFLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVNLDBCQUFJLEdBQVg7O1FBQVksY0FBYzthQUFkLFVBQWMsRUFBZCxxQkFBYyxFQUFkLElBQWM7WUFBZCx5QkFBYzs7UUFDeEIsQ0FBQSxLQUFBLElBQUksQ0FBQyxLQUFLLENBQUEsQ0FBQyxJQUFJLFdBQUksSUFBSSxFQUFFO1FBQ3pCLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVNLDBCQUFJLEdBQVg7O1FBQVksY0FBYzthQUFkLFVBQWMsRUFBZCxxQkFBYyxFQUFkLElBQWM7WUFBZCx5QkFBYzs7UUFDeEIsQ0FBQSxLQUFBLElBQUksQ0FBQyxLQUFLLENBQUEsQ0FBQyxJQUFJLFdBQUksSUFBSSxFQUFFO1FBQ3pCLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVNLDJCQUFLLEdBQVo7O1FBQWEsY0FBYzthQUFkLFVBQWMsRUFBZCxxQkFBYyxFQUFkLElBQWM7WUFBZCx5QkFBYzs7UUFDekIsQ0FBQSxLQUFBLElBQUksQ0FBQyxNQUFNLENBQUEsQ0FBQyxJQUFJLFdBQUksSUFBSSxF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RkFBMkYsQ0FBQztJQUU5SCxPQUFPO0lBQ00sZ0NBQXdCLEdBQUcsMkJBQTJCLENBQUM7SUFFcEUsUUFBUTtJQUNSLCtCQUFzQyxPQUFnQjtRQUNwRCxPQUFPLG9CQUFpQixPQUFPLGlDQUEwQixPQUFPLFFBQUksQ0FBQztJQUN2RSxDQUFDO0lBRmUsNkJBQXFCLHdCQUVwQyxDQUFBO0lBRUQsbUNBQTBDLFNBQW9CO1FBQzVELE9BQU8sb0NBQWtDLFNBQVMsTUFBRyxDQUFDO0lBQ3hELENBQUM7SUFGZSxpQ0FBeUIsNEJBRXhDLENBQUE7SUFFRCxvQ0FBMkMsU0FBaUI7UUFDMUQsT0FBTyxnRkFBNkUsU0FBUyxRQUFJLENBQUM7SUFDcEcsQ0FBQztJQUZlLGtDQUEwQiw2QkFFekMsQ0FBQTtJQUVELFdBQVc7SUFDWCx5QkFBZ0MsUUFBZ0IsRUFBRSxLQUFzQjtRQUN0RSxPQUFPLGFBQVcsUUFBUSxVQUFLLFNBQVMsQ0FBQyxLQUFLLENBQUcsQ0FBQztJQUNwRCxDQUFDO0lBRmUsdUJBQWUsa0JBRTlCLENBQUE7SUFFRCw2QkFBb0MsWUFBb0I7UUFDdEQsT0FBTyxpQkFBYyxZQUFZLHNEQUMvQixZQUFZLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsTUFBRyxDQUFDO0lBQzNDLENBQUM7SUFIZSwyQkFBbUIsc0JBR2xDLENBQUE7SUFFRCxvQkFBMkIsQ0FBMEI7UUFDbkQsT0FBTyxnQ0FBOEIsU0FBUyxDQUFDLENBQUMsQ0FBQyxpREFBOEMsQ0FBQztJQUNsRyxDQUFDO0lBRmUsa0JBQVUsYUFFekIsQ0FBQTtBQUNILENBQUMsRUE1T2dCLE9BQU8sS0FBUCxPQUFPLFFBNE92QiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogVmVnYS1MaXRlJ3Mgc2luZ2xldG9uIGxvZ2dlciB1dGlsaXR5LlxuICovXG5cbmltcG9ydCB7QWdncmVnYXRlT3B9IGZyb20gJ3ZlZ2EnO1xuaW1wb3J0IHtsb2dnZXIsIExvZ2dlckludGVyZmFjZSwgV2Fybn0gZnJvbSAndmVnYS11dGlsJztcbmltcG9ydCB7Q2hhbm5lbCwgR2VvUG9zaXRpb25DaGFubmVsfSBmcm9tICcuL2NoYW5uZWwnO1xuaW1wb3J0IHtDb21wb3NpdGVNYXJrfSBmcm9tICcuL2NvbXBvc2l0ZW1hcmsnO1xuaW1wb3J0IHtEYXRlVGltZSwgRGF0ZVRpbWVFeHByfSBmcm9tICcuL2RhdGV0aW1lJztcbmltcG9ydCB7RmllbGREZWZ9IGZyb20gJy4vZmllbGRkZWYnO1xuaW1wb3J0IHtNYXJrfSBmcm9tICcuL21hcmsnO1xuaW1wb3J0IHtQcm9qZWN0aW9ufSBmcm9tICcuL3Byb2plY3Rpb24nO1xuaW1wb3J0IHtTY2FsZVR5cGV9IGZyb20gJy4vc2NhbGUnO1xuaW1wb3J0IHtUeXBlfSBmcm9tICcuL3R5cGUnO1xuaW1wb3J0IHtzdHJpbmdpZnl9IGZyb20gJy4vdXRpbCc7XG5pbXBvcnQge1ZnU29ydEZpZWxkfSBmcm9tICcuL3ZlZ2Euc2NoZW1hJztcblxuXG5leHBvcnQge0xvZ2dlckludGVyZmFjZX0gZnJvbSAndmVnYS11dGlsJztcblxuLyoqXG4gKiBNYWluIChkZWZhdWx0KSBWZWdhIExvZ2dlciBpbnN0YW5jZSBmb3IgVmVnYS1MaXRlXG4gKi9cbmNvbnN0IG1haW4gPSBsb2dnZXIoV2Fybik7XG5sZXQgY3VycmVudDogTG9nZ2VySW50ZXJmYWNlID0gbWFpbjtcblxuLyoqXG4gKiBMb2dnZXIgdG9vbCBmb3IgY2hlY2tpbmcgaWYgdGhlIGNvZGUgdGhyb3dzIGNvcnJlY3Qgd2FybmluZ1xuICovXG5leHBvcnQgY2xhc3MgTG9jYWxMb2dnZXIgaW1wbGVtZW50cyBMb2dnZXJJbnRlcmZhY2Uge1xuICBwdWJsaWMgd2FybnM6IGFueVtdID0gW107XG4gIHB1YmxpYyBpbmZvczogYW55W10gPSBbXTtcbiAgcHVibGljIGRlYnVnczogYW55W10gPSBbXTtcblxuICBwdWJsaWMgbGV2ZWwoKSB7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBwdWJsaWMgd2FybiguLi5hcmdzOiBhbnlbXSkge1xuICAgIHRoaXMud2FybnMucHVzaCguLi5hcmdzKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIHB1YmxpYyBpbmZvKC4uLmFyZ3M6IGFueVtdKSB7XG4gICAgdGhpcy5pbmZvcy5wdXNoKC4uLmFyZ3MpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgcHVibGljIGRlYnVnKC4uLmFyZ3M6IGFueVtdKSB7XG4gICAgdGhpcy5kZWJ1Z3MucHVzaCguLi5hcmdzKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gd3JhcChmOiAobG9nZ2VyOiBMb2NhbExvZ2dlcikgPT4gdm9pZCkge1xuICByZXR1cm4gKCkgPT4ge1xuICAgIGN1cnJlbnQgPSBuZXcgTG9jYWxMb2dnZXIoKTtcbiAgICBmKGN1cnJlbnQgYXMgTG9jYWxMb2dnZXIpO1xuICAgIHJlc2V0KCk7XG4gIH07XG59XG5cbi8qKlxuICogU2V0IHRoZSBzaW5nbGV0b24gbG9nZ2VyIHRvIGJlIGEgY3VzdG9tIGxvZ2dlclxuICovXG5leHBvcnQgZnVuY3Rpb24gc2V0KG5ld0xvZ2dlcjogTG9nZ2VySW50ZXJmYWNlKSB7XG4gIGN1cnJlbnQgPSBuZXdMb2dnZXI7XG4gIHJldHVybiBjdXJyZW50O1xufVxuXG4vKipcbiAqIFJlc2V0IHRoZSBtYWluIGxvZ2dlciB0byB1c2UgdGhlIGRlZmF1bHQgVmVnYSBMb2dnZXJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0KCkge1xuICBjdXJyZW50ID0gbWFpbjtcbiAgcmV0dXJuIGN1cnJlbnQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB3YXJuKC4uLl86IGFueVtdKSB7XG4gIGN1cnJlbnQud2Fybi5hcHBseShjdXJyZW50LCBhcmd1bWVudHMpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaW5mbyguLi5fOiBhbnlbXSkge1xuICBjdXJyZW50LmluZm8uYXBwbHkoY3VycmVudCwgYXJndW1lbnRzKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlYnVnKC4uLl86IGFueVtdKSB7XG4gIGN1cnJlbnQuZGVidWcuYXBwbHkoY3VycmVudCwgYXJndW1lbnRzKTtcbn1cblxuLyoqXG4gKiBDb2xsZWN0aW9uIG9mIGFsbCBWZWdhLUxpdGUgRXJyb3IgTWVzc2FnZXNcbiAqL1xuZXhwb3J0IG5hbWVzcGFjZSBtZXNzYWdlIHtcbiAgZXhwb3J0IGNvbnN0IElOVkFMSURfU1BFQyA9ICdJbnZhbGlkIHNwZWMnO1xuXG4gIC8vIEZJVFxuICBleHBvcnQgY29uc3QgRklUX05PTl9TSU5HTEUgPSAnQXV0b3NpemUgXCJmaXRcIiBvbmx5IHdvcmtzIGZvciBzaW5nbGUgdmlld3MgYW5kIGxheWVyZWQgdmlld3MuJztcblxuICBleHBvcnQgY29uc3QgQ0FOTk9UX0ZJWF9SQU5HRV9TVEVQX1dJVEhfRklUID0gJ0Nhbm5vdCB1c2UgYSBmaXhlZCB2YWx1ZSBvZiBcInJhbmdlU3RlcFwiIHdoZW4gXCJhdXRvc2l6ZVwiIGlzIFwiZml0XCIuJztcblxuICAvLyBTRUxFQ1RJT05cbiAgZXhwb3J0IGZ1bmN0aW9uIGNhbm5vdFByb2plY3RPbkNoYW5uZWxXaXRob3V0RmllbGQoY2hhbm5lbDogQ2hhbm5lbCkge1xuICAgIHJldHVybiBgQ2Fubm90IHByb2plY3QgYSBzZWxlY3Rpb24gb24gZW5jb2RpbmcgY2hhbm5lbCBcIiR7Y2hhbm5lbH1cIiwgd2hpY2ggaGFzIG5vIGZpZWxkLmA7XG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gbmVhcmVzdE5vdFN1cHBvcnRGb3JDb250aW51b3VzKG1hcms6IHN0cmluZykge1xuICAgIHJldHVybiBgVGhlIFwibmVhcmVzdFwiIHRyYW5zZm9ybSBpcyBub3Qgc3VwcG9ydGVkIGZvciAke21hcmt9IG1hcmtzLmA7XG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gc2VsZWN0aW9uTm90Rm91bmQobmFtZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIGBDYW5ub3QgZmluZCBhIHNlbGVjdGlvbiBuYW1lZCBcIiR7bmFtZX1cImA7XG4gIH1cblxuICBleHBvcnQgY29uc3QgU0NBTEVfQklORElOR1NfQ09OVElOVU9VUyA9ICdTY2FsZSBiaW5kaW5ncyBhcmUgY3VycmVudGx5IG9ubHkgc3VwcG9ydGVkIGZvciBzY2FsZXMgd2l0aCB1bmJpbm5lZCwgY29udGludW91cyBkb21haW5zLic7XG5cbiAgLy8gUkVQRUFUXG4gIGV4cG9ydCBmdW5jdGlvbiBub1N1Y2hSZXBlYXRlZFZhbHVlKGZpZWxkOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gYFVua25vd24gcmVwZWF0ZWQgdmFsdWUgXCIke2ZpZWxkfVwiLmA7XG4gIH1cblxuICAvLyBDT05DQVRcbiAgZXhwb3J0IGNvbnN0IENPTkNBVF9DQU5OT1RfU0hBUkVfQVhJUyA9ICdBeGVzIGNhbm5vdCBiZSBzaGFyZWQgaW4gY29uY2F0ZW5hdGVkIHZpZXdzLic7XG5cbiAgLy8gUkVQRUFUXG4gIGV4cG9ydCBjb25zdCBSRVBFQVRfQ0FOTk9UX1NIQVJFX0FYSVMgPSAnQXhlcyBjYW5ub3QgYmUgc2hhcmVkIGluIHJlcGVhdGVkIHZpZXdzLic7XG5cbiAgLy8gVElUTEVcbiAgZXhwb3J0IGZ1bmN0aW9uIGNhbm5vdFNldFRpdGxlQW5jaG9yKHR5cGU6IHN0cmluZykge1xuICAgIHJldHVybiBgQ2Fubm90IHNldCB0aXRsZSBcImFuY2hvclwiIGZvciBhICR7dHlwZX0gc3BlY2A7XG4gIH1cblxuICAvLyBEQVRBXG4gIGV4cG9ydCBmdW5jdGlvbiB1bnJlY29nbml6ZWRQYXJzZShwOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gYFVucmVjb2duaXplZCBwYXJzZSBcIiR7cH1cIi5gO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIGRpZmZlcmVudFBhcnNlKGZpZWxkOiBzdHJpbmcsIGxvY2FsOiBzdHJpbmcsIGFuY2VzdG9yOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gYEFuIGFuY2VzdG9yIHBhcnNlZCBmaWVsZCBcIiR7ZmllbGR9XCIgYXMgJHthbmNlc3Rvcn0gYnV0IGEgY2hpbGQgd2FudHMgdG8gcGFyc2UgdGhlIGZpZWxkIGFzICR7bG9jYWx9LmA7XG4gIH1cblxuICAvLyBUUkFOU0ZPUk1TXG4gIGV4cG9ydCBmdW5jdGlvbiBpbnZhbGlkVHJhbnNmb3JtSWdub3JlZCh0cmFuc2Zvcm06IGFueSkge1xuICAgIHJldHVybiBgSWdub3JpbmcgYW4gaW52YWxpZCB0cmFuc2Zvcm06ICR7c3RyaW5naWZ5KHRyYW5zZm9ybSl9LmA7XG4gIH1cblxuICBleHBvcnQgY29uc3QgTk9fRklFTERTX05FRURTX0FTID0gJ0lmIFwiZnJvbS5maWVsZHNcIiBpcyBub3Qgc3BlY2lmaWVkLCBcImFzXCIgaGFzIHRvIGJlIGEgc3RyaW5nIHRoYXQgc3BlY2lmaWVzIHRoZSBrZXkgdG8gYmUgdXNlZCBmb3IgdGhlIGRhdGEgZnJvbSB0aGUgc2Vjb25kYXJ5IHNvdXJjZS4nO1xuXG4gIC8vIEVOQ09ESU5HICYgRkFDRVRcblxuICBleHBvcnQgZnVuY3Rpb24gZW5jb2RpbmdPdmVycmlkZGVuKGNoYW5uZWxzOiBDaGFubmVsW10pIHtcbiAgICByZXR1cm4gYExheWVyJ3Mgc2hhcmVkICR7Y2hhbm5lbHMuam9pbignLCcpfSBjaGFubmVsICR7Y2hhbm5lbHMubGVuZ3RoID09PSAxID8gJ2lzJyA6ICdhcmUnfSBvdmVycmlkZW5gO1xuICB9XG4gIGV4cG9ydCBmdW5jdGlvbiBwcm9qZWN0aW9uT3ZlcnJpZGRlbihvcHQ6IHtwYXJlbnRQcm9qZWN0aW9uOiBQcm9qZWN0aW9uLCBwcm9qZWN0aW9uOiBQcm9qZWN0aW9ufSkge1xuICAgIGNvbnN0IHtwYXJlbnRQcm9qZWN0aW9uLCBwcm9qZWN0aW9ufSA9IG9wdDtcbiAgICByZXR1cm4gYExheWVyJ3Mgc2hhcmVkIHByb2plY3Rpb24gJHtzdHJpbmdpZnkocGFyZW50UHJvamVjdGlvbil9IGlzIG92ZXJyaWRkZW4gYnkgYSBjaGlsZCBwcm9qZWN0aW9uICR7c3RyaW5naWZ5KHByb2plY3Rpb24pfS5gO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIHByaW1pdGl2ZUNoYW5uZWxEZWYoY2hhbm5lbDogQ2hhbm5lbCwgdHlwZTogJ3N0cmluZycgfCAnbnVtYmVyJyB8ICdib29sZWFuJywgdmFsdWU6IHN0cmluZyB8IG51bWJlciB8IGJvb2xlYW4pIHtcbiAgICByZXR1cm4gYENoYW5uZWwgJHtjaGFubmVsfSBpcyBhICR7dHlwZX0uIENvbnZlcnRlZCB0byB7dmFsdWU6ICR7c3RyaW5naWZ5KHZhbHVlKX19LmA7XG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gaW52YWxpZEZpZWxkVHlwZSh0eXBlOiBUeXBlKSB7XG4gICAgcmV0dXJuIGBJbnZhbGlkIGZpZWxkIHR5cGUgXCIke3R5cGV9XCJgO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIG5vblplcm9TY2FsZVVzZWRXaXRoTGVuZ3RoTWFyayhcbiAgICBtYXJrOiAnYmFyJyB8ICdhcmVhJywgY2hhbm5lbDogQ2hhbm5lbCxcbiAgICBvcHQ6IHtzY2FsZVR5cGU/OiBTY2FsZVR5cGUsIHplcm9GYWxzZT86IGJvb2xlYW59XG4gICkge1xuICAgIGNvbnN0IHNjYWxlVGV4dCA9IG9wdC5zY2FsZVR5cGUgPyBgJHtvcHQuc2NhbGVUeXBlfSBzY2FsZWAgOlxuICAgICAgb3B0Lnplcm9GYWxzZSA/ICdzY2FsZSB3aXRoIHplcm89ZmFsc2UnIDpcbiAgICAgICdzY2FsZSB3aXRoIGN1c3RvbSBkb21haW4gdGhhdCBleGNsdWRlcyB6ZXJvJztcblxuICAgIHJldHVybiBgQSAke3NjYWxlVGV4dH0gaXMgdXNlZCB3aXRoICR7bWFya30gbWFyay4gVGhpcyBjYW4gYmUgbWlzbGVhZGluZyBhcyB0aGUgJHtjaGFubmVsID09PSAneCcgPyAnd2lkdGgnIDogJ2hlaWdodCd9IG9mIHRoZSAke21hcmt9IGNhbiBiZSBhcmJpdHJhcnkgYmFzZWQgb24gdGhlIHNjYWxlIGRvbWFpbi4gWW91IG1heSB3YW50IHRvIHVzZSBwb2ludCBtYXJrIGluc3RlYWQuYDtcbiAgfVxuXG4gIGV4cG9ydCBmdW5jdGlvbiBpbnZhbGlkRmllbGRUeXBlRm9yQ291bnRBZ2dyZWdhdGUodHlwZTogVHlwZSwgYWdncmVnYXRlOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gYEludmFsaWQgZmllbGQgdHlwZSBcIiR7dHlwZX1cIiBmb3IgYWdncmVnYXRlOiBcIiR7YWdncmVnYXRlfVwiLCB1c2luZyBcInF1YW50aXRhdGl2ZVwiIGluc3RlYWQuYDtcbiAgfVxuXG4gIGV4cG9ydCBmdW5jdGlvbiBpbnZhbGlkQWdncmVnYXRlKGFnZ3JlZ2F0ZTogQWdncmVnYXRlT3AgfCBzdHJpbmcpIHtcbiAgICByZXR1cm4gYEludmFsaWQgYWdncmVnYXRpb24gb3BlcmF0b3IgXCIke2FnZ3JlZ2F0ZX1cImA7XG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gZW1wdHlPckludmFsaWRGaWVsZFR5cGUodHlwZTogVHlwZSB8IHN0cmluZywgY2hhbm5lbDogQ2hhbm5lbCwgbmV3VHlwZTogVHlwZSkge1xuICAgIHJldHVybiBgSW52YWxpZCBmaWVsZCB0eXBlIFwiJHt0eXBlfVwiIGZvciBjaGFubmVsIFwiJHtjaGFubmVsfVwiLCB1c2luZyBcIiR7bmV3VHlwZX1cIiBpbnN0ZWFkLmA7XG4gIH1cbiAgZXhwb3J0IGZ1bmN0aW9uIGRyb3BwaW5nQ29sb3IodHlwZTogJ2VuY29kaW5nJyB8ICdwcm9wZXJ0eScsIG9wdDoge2ZpbGw/OiBib29sZWFuLCBzdHJva2U/OiBib29sZWFufSkge1xuICAgIGNvbnN0IHtmaWxsLCBzdHJva2V9ID0gb3B0O1xuICAgIHJldHVybiBgRHJvcHBpbmcgY29sb3IgJHt0eXBlfSBhcyB0aGUgcGxvdCBhbHNvIGhhcyBgICsgKFxuICAgICAgZmlsbCAmJiBzdHJva2UgPyAnZmlsbCBhbmQgc3Ryb2tlJyA6IGZpbGwgPyAnZmlsbCcgOiAnc3Ryb2tlJ1xuICAgICk7XG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gZW1wdHlGaWVsZERlZihmaWVsZERlZjogRmllbGREZWY8c3RyaW5nPiwgY2hhbm5lbDogQ2hhbm5lbCkge1xuICAgIHJldHVybiBgRHJvcHBpbmcgJHtzdHJpbmdpZnkoZmllbGREZWYpfSBmcm9tIGNoYW5uZWwgXCIke2NoYW5uZWx9XCIgc2luY2UgaXQgZG9lcyBub3QgY29udGFpbiBkYXRhIGZpZWxkIG9yIHZhbHVlLmA7XG4gIH1cbiAgZXhwb3J0IGZ1bmN0aW9uIGxhdExvbmdEZXByZWNhdGVkKGNoYW5uZWw6IENoYW5uZWwsIHR5cGU6IFR5cGUsIG5ld0NoYW5uZWw6IEdlb1Bvc2l0aW9uQ2hhbm5lbCkge1xuICAgIHJldHVybiBgJHtjaGFubmVsfS1lbmNvZGluZyB3aXRoIHR5cGUgJHt0eXBlfSBpcyBkZXByZWNhdGVkLiBSZXBsYWNpbmcgd2l0aCAke25ld0NoYW5uZWx9LWVuY29kaW5nLmA7XG4gIH1cblxuICBleHBvcnQgY29uc3QgTElORV9XSVRIX1ZBUllJTkdfU0laRSA9ICdMaW5lIG1hcmtzIGNhbm5vdCBlbmNvZGUgc2l6ZSB3aXRoIGEgbm9uLWdyb3VwYnkgZmllbGQuIFlvdSBtYXkgd2FudCB0byB1c2UgdHJhaWwgbWFya3MgaW5zdGVhZC4nO1xuXG4gIGV4cG9ydCBmdW5jdGlvbiBpbmNvbXBhdGlibGVDaGFubmVsKGNoYW5uZWw6IENoYW5uZWwsIG1hcmtPckZhY2V0OiBNYXJrIHwgJ2ZhY2V0JyB8IENvbXBvc2l0ZU1hcmssIHdoZW4/OiBzdHJpbmcpIHtcbiAgICByZXR1cm4gYCR7Y2hhbm5lbH0gZHJvcHBlZCBhcyBpdCBpcyBpbmNvbXBhdGlibGUgd2l0aCBcIiR7bWFya09yRmFjZXR9XCIke3doZW4gPyBgIHdoZW4gJHt3aGVufWAgOiAnJ30uYDtcbiAgfVxuXG4gIGV4cG9ydCBmdW5jdGlvbiBpbnZhbGlkRW5jb2RpbmdDaGFubmVsKGNoYW5uZWw6IHN0cmluZykge1xuICAgIHJldHVybiBgJHtjaGFubmVsfS1lbmNvZGluZyBpcyBkcm9wcGVkIGFzICR7Y2hhbm5lbH0gaXMgbm90IGEgdmFsaWQgZW5jb2RpbmcgY2hhbm5lbC5gO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIGZhY2V0Q2hhbm5lbFNob3VsZEJlRGlzY3JldGUoY2hhbm5lbDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIGAke2NoYW5uZWx9IGVuY29kaW5nIHNob3VsZCBiZSBkaXNjcmV0ZSAob3JkaW5hbCAvIG5vbWluYWwgLyBiaW5uZWQpLmA7XG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gZGlzY3JldGVDaGFubmVsQ2Fubm90RW5jb2RlKGNoYW5uZWw6IENoYW5uZWwsIHR5cGU6IFR5cGUpIHtcbiAgICByZXR1cm4gYFVzaW5nIGRpc2NyZXRlIGNoYW5uZWwgXCIke2NoYW5uZWx9XCIgdG8gZW5jb2RlIFwiJHt0eXBlfVwiIGZpZWxkIGNhbiBiZSBtaXNsZWFkaW5nIGFzIGl0IGRvZXMgbm90IGVuY29kZSAke3R5cGUgPT09ICdvcmRpbmFsJyA/ICdvcmRlcicgOiAnbWFnbml0dWRlJ30uYDtcbiAgfVxuXG4gIC8vIE1hcmtcbiAgZXhwb3J0IGNvbnN0IEJBUl9XSVRIX1BPSU5UX1NDQUxFX0FORF9SQU5HRVNURVBfTlVMTCA9ICdCYXIgbWFyayBzaG91bGQgbm90IGJlIHVzZWQgd2l0aCBwb2ludCBzY2FsZSB3aGVuIHJhbmdlU3RlcCBpcyBudWxsLiBQbGVhc2UgdXNlIGJhbmQgc2NhbGUgaW5zdGVhZC4nO1xuXG4gIGV4cG9ydCBmdW5jdGlvbiBsaW5lV2l0aFJhbmdlKGhhc1gyOiBib29sZWFuLCBoYXNZMjogYm9vbGVhbikge1xuICAgIGNvbnN0IGNoYW5uZWxzID0gaGFzWDIgJiYgaGFzWTIgPyAneDIgYW5kIHkyJyA6IGhhc1gyID8gJ3gyJyA6ICd5Mic7XG4gICAgcmV0dXJuIGBMaW5lIG1hcmsgaXMgZm9yIGNvbnRpbnVvdXMgbGluZXMgYW5kIHRodXMgY2Fubm90IGJlIHVzZWQgd2l0aCAke2NoYW5uZWxzfS4gV2Ugd2lsbCB1c2UgdGhlIHJ1bGUgbWFyayAobGluZSBzZWdtZW50cykgaW5zdGVhZC5gO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIHVuY2xlYXJPcmllbnRDb250aW51b3VzKG1hcms6IE1hcmspIHtcbiAgICByZXR1cm4gYENhbm5vdCBjbGVhcmx5IGRldGVybWluZSBvcmllbnRhdGlvbiBmb3IgXCIke21hcmt9XCIgc2luY2UgYm90aCB4IGFuZCB5IGNoYW5uZWwgZW5jb2RlIGNvbnRpbnVvdXMgZmllbGRzLiBJbiB0aGlzIGNhc2UsIHdlIHVzZSB2ZXJ0aWNhbCBieSBkZWZhdWx0YDtcbiAgfVxuXG4gIGV4cG9ydCBmdW5jdGlvbiB1bmNsZWFyT3JpZW50RGlzY3JldGVPckVtcHR5KG1hcms6IE1hcmspIHtcbiAgICByZXR1cm4gYENhbm5vdCBjbGVhcmx5IGRldGVybWluZSBvcmllbnRhdGlvbiBmb3IgXCIke21hcmt9XCIgc2luY2UgYm90aCB4IGFuZCB5IGNoYW5uZWwgZW5jb2RlIGRpc2NyZXRlIG9yIGVtcHR5IGZpZWxkcy5gO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIG9yaWVudE92ZXJyaWRkZW4ob3JpZ2luYWw6IHN0cmluZywgYWN0dWFsOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gYFNwZWNpZmllZCBvcmllbnQgXCIke29yaWdpbmFsfVwiIG92ZXJyaWRkZW4gd2l0aCBcIiR7YWN0dWFsfVwiYDtcbiAgfVxuXG4gIC8vIFNDQUxFXG4gIGV4cG9ydCBjb25zdCBDQU5OT1RfVU5JT05fQ1VTVE9NX0RPTUFJTl9XSVRIX0ZJRUxEX0RPTUFJTiA9ICdjdXN0b20gZG9tYWluIHNjYWxlIGNhbm5vdCBiZSB1bmlvbmVkIHdpdGggZGVmYXVsdCBmaWVsZC1iYXNlZCBkb21haW4nO1xuXG4gIGV4cG9ydCBmdW5jdGlvbiBjYW5ub3RVc2VTY2FsZVByb3BlcnR5V2l0aE5vbkNvbG9yKHByb3A6IHN0cmluZykge1xuICAgIHJldHVybiBgQ2Fubm90IHVzZSB0aGUgc2NhbGUgcHJvcGVydHkgXCIke3Byb3B9XCIgd2l0aCBub24tY29sb3IgY2hhbm5lbC5gO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIHVuYWdncmVnYXRlRG9tYWluSGFzTm9FZmZlY3RGb3JSYXdGaWVsZChmaWVsZERlZjogRmllbGREZWY8c3RyaW5nPikge1xuICAgIHJldHVybiBgVXNpbmcgdW5hZ2dyZWdhdGVkIGRvbWFpbiB3aXRoIHJhdyBmaWVsZCBoYXMgbm8gZWZmZWN0ICgke3N0cmluZ2lmeShmaWVsZERlZil9KS5gO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIHVuYWdncmVnYXRlRG9tYWluV2l0aE5vblNoYXJlZERvbWFpbk9wKGFnZ3JlZ2F0ZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIGBVbmFnZ3JlZ2F0ZWQgZG9tYWluIG5vdCBhcHBsaWNhYmxlIGZvciBcIiR7YWdncmVnYXRlfVwiIHNpbmNlIGl0IHByb2R1Y2VzIHZhbHVlcyBvdXRzaWRlIHRoZSBvcmlnaW4gZG9tYWluIG9mIHRoZSBzb3VyY2UgZGF0YS5gO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIHVuYWdncmVnYXRlZERvbWFpbldpdGhMb2dTY2FsZShmaWVsZERlZjogRmllbGREZWY8c3RyaW5nPikge1xuICAgIHJldHVybiBgVW5hZ2dyZWdhdGVkIGRvbWFpbiBpcyBjdXJyZW50bHkgdW5zdXBwb3J0ZWQgZm9yIGxvZyBzY2FsZSAoJHtzdHJpbmdpZnkoZmllbGREZWYpfSkuYDtcbiAgfVxuXG4gIGV4cG9ydCBmdW5jdGlvbiBjYW5ub3RBcHBseVNpemVUb05vbk9yaWVudGVkTWFyayhtYXJrOiBNYXJrKSB7XG4gICAgcmV0dXJuIGBDYW5ub3QgYXBwbHkgc2l6ZSB0byBub24tb3JpZW50ZWQgbWFyayBcIiR7bWFya31cIi5gO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIHJhbmdlU3RlcERyb3BwZWQoY2hhbm5lbDogQ2hhbm5lbCkge1xuICAgIHJldHVybiBgcmFuZ2VTdGVwIGZvciBcIiR7Y2hhbm5lbH1cIiBpcyBkcm9wcGVkIGFzIHRvcC1sZXZlbCAke1xuICAgICAgY2hhbm5lbCA9PT0gJ3gnID8gJ3dpZHRoJyA6ICdoZWlnaHQnfSBpcyBwcm92aWRlZC5gO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIHNjYWxlVHlwZU5vdFdvcmtXaXRoQ2hhbm5lbChjaGFubmVsOiBDaGFubmVsLCBzY2FsZVR5cGU6IFNjYWxlVHlwZSwgZGVmYXVsdFNjYWxlVHlwZTogU2NhbGVUeXBlKSB7XG4gICAgcmV0dXJuIGBDaGFubmVsIFwiJHtjaGFubmVsfVwiIGRvZXMgbm90IHdvcmsgd2l0aCBcIiR7c2NhbGVUeXBlfVwiIHNjYWxlLiBXZSBhcmUgdXNpbmcgXCIke2RlZmF1bHRTY2FsZVR5cGV9XCIgc2NhbGUgaW5zdGVhZC5gO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIHNjYWxlVHlwZU5vdFdvcmtXaXRoRmllbGREZWYoc2NhbGVUeXBlOiBTY2FsZVR5cGUsIGRlZmF1bHRTY2FsZVR5cGU6IFNjYWxlVHlwZSkge1xuICAgIHJldHVybiBgRmllbGREZWYgZG9lcyBub3Qgd29yayB3aXRoIFwiJHtzY2FsZVR5cGV9XCIgc2NhbGUuIFdlIGFyZSB1c2luZyBcIiR7ZGVmYXVsdFNjYWxlVHlwZX1cIiBzY2FsZSBpbnN0ZWFkLmA7XG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gc2NhbGVQcm9wZXJ0eU5vdFdvcmtXaXRoU2NhbGVUeXBlKHNjYWxlVHlwZTogU2NhbGVUeXBlLCBwcm9wTmFtZTogc3RyaW5nLCBjaGFubmVsOiBDaGFubmVsKSB7XG4gICAgcmV0dXJuIGAke2NoYW5uZWx9LXNjYWxlJ3MgXCIke3Byb3BOYW1lfVwiIGlzIGRyb3BwZWQgYXMgaXQgZG9lcyBub3Qgd29yayB3aXRoICR7c2NhbGVUeXBlfSBzY2FsZS5gO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIHNjYWxlVHlwZU5vdFdvcmtXaXRoTWFyayhtYXJrOiBNYXJrLCBzY2FsZVR5cGU6IFNjYWxlVHlwZSkge1xuICAgIHJldHVybiBgU2NhbGUgdHlwZSBcIiR7c2NhbGVUeXBlfVwiIGRvZXMgbm90IHdvcmsgd2l0aCBtYXJrIFwiJHttYXJrfVwiLmA7XG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gbWVyZ2VDb25mbGljdGluZ1Byb3BlcnR5PFQ+KHByb3BlcnR5OiBzdHJpbmcgfCBudW1iZXIgfCBzeW1ib2wsIHByb3BlcnR5T2Y6IHN0cmluZyB8IG51bWJlciB8IHN5bWJvbCwgdjE6IFQsIHYyOiBUKSB7XG4gICAgcmV0dXJuIGBDb25mbGljdGluZyAke3Byb3BlcnR5T2YudG9TdHJpbmcoKX0gcHJvcGVydHkgXCIke3Byb3BlcnR5LnRvU3RyaW5nKCl9XCIgKCR7c3RyaW5naWZ5KHYxKX0gYW5kICR7c3RyaW5naWZ5KHYyKX0pLiAgVXNpbmcgJHtzdHJpbmdpZnkodjEpfS5gO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIGluZGVwZW5kZW50U2NhbGVNZWFuc0luZGVwZW5kZW50R3VpZGUoY2hhbm5lbDogQ2hhbm5lbCkge1xuICAgIHJldHVybiBgU2V0dGluZyB0aGUgc2NhbGUgdG8gYmUgaW5kZXBlbmRlbnQgZm9yIFwiJHtjaGFubmVsfVwiIG1lYW5zIHdlIGFsc28gaGF2ZSB0byBzZXQgdGhlIGd1aWRlIChheGlzIG9yIGxlZ2VuZCkgdG8gYmUgaW5kZXBlbmRlbnQuYDtcbiAgfVxuXG4gIGV4cG9ydCBmdW5jdGlvbiBkb21haW5Tb3J0RHJvcHBlZChzb3J0OiBWZ1NvcnRGaWVsZCkge1xuICAgIHJldHVybiBgRHJvcHBpbmcgc29ydCBwcm9wZXJ0eSAke3N0cmluZ2lmeShzb3J0KX0gYXMgdW5pb25lZCBkb21haW5zIG9ubHkgc3VwcG9ydCBib29sZWFuIG9yIG9wICdjb3VudCcuYDtcbiAgfVxuXG4gIGV4cG9ydCBjb25zdCBVTkFCTEVfVE9fTUVSR0VfRE9NQUlOUyA9ICdVbmFibGUgdG8gbWVyZ2UgZG9tYWlucyc7XG5cbiAgZXhwb3J0IGNvbnN0IE1PUkVfVEhBTl9PTkVfU09SVCA9ICdEb21haW5zIHRoYXQgc2hvdWxkIGJlIHVuaW9uZWQgaGFzIGNvbmZsaWN0aW5nIHNvcnQgcHJvcGVydGllcy4gU29ydCB3aWxsIGJlIHNldCB0byB0cnVlLic7XG5cbiAgLy8gQVhJU1xuICBleHBvcnQgY29uc3QgSU5WQUxJRF9DSEFOTkVMX0ZPUl9BWElTID0gJ0ludmFsaWQgY2hhbm5lbCBmb3IgYXhpcy4nO1xuXG4gIC8vIFNUQUNLXG4gIGV4cG9ydCBmdW5jdGlvbiBjYW5ub3RTdGFja1JhbmdlZE1hcmsoY2hhbm5lbDogQ2hhbm5lbCkge1xuICAgIHJldHVybiBgQ2Fubm90IHN0YWNrIFwiJHtjaGFubmVsfVwiIGlmIHRoZXJlIGlzIGFscmVhZHkgXCIke2NoYW5uZWx9MlwiYDtcbiAgfVxuXG4gIGV4cG9ydCBmdW5jdGlvbiBjYW5ub3RTdGFja05vbkxpbmVhclNjYWxlKHNjYWxlVHlwZTogU2NhbGVUeXBlKSB7XG4gICAgcmV0dXJuIGBDYW5ub3Qgc3RhY2sgbm9uLWxpbmVhciBzY2FsZSAoJHtzY2FsZVR5cGV9KWA7XG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gc3RhY2tOb25TdW1tYXRpdmVBZ2dyZWdhdGUoYWdncmVnYXRlOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gYFN0YWNraW5nIGlzIGFwcGxpZWQgZXZlbiB0aG91Z2ggdGhlIGFnZ3JlZ2F0ZSBmdW5jdGlvbiBpcyBub24tc3VtbWF0aXZlIChcIiR7YWdncmVnYXRlfVwiKWA7XG4gIH1cblxuICAvLyBUSU1FVU5JVFxuICBleHBvcnQgZnVuY3Rpb24gaW52YWxpZFRpbWVVbml0KHVuaXROYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcgfCBudW1iZXIpIHtcbiAgICByZXR1cm4gYEludmFsaWQgJHt1bml0TmFtZX06ICR7c3RyaW5naWZ5KHZhbHVlKX1gO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIGRheVJlcGxhY2VkV2l0aERhdGUoZnVsbFRpbWVVbml0OiBzdHJpbmcpIHtcbiAgICByZXR1cm4gYFRpbWUgdW5pdCBcIiR7ZnVsbFRpbWVVbml0fVwiIGlzIG5vdCBzdXBwb3J0ZWQuIFdlIGFyZSByZXBsYWNpbmcgaXQgd2l0aCAke1xuICAgICAgZnVsbFRpbWVVbml0LnJlcGxhY2UoJ2RheScsICdkYXRlJyl9LmA7XG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gZHJvcHBlZERheShkOiBEYXRlVGltZSB8IERhdGVUaW1lRXhwcikge1xuICAgIHJldHVybiBgRHJvcHBpbmcgZGF5IGZyb20gZGF0ZXRpbWUgJHtzdHJpbmdpZnkoZCl9IGFzIGRheSBjYW5ub3QgYmUgY29tYmluZWQgd2l0aCBvdGhlciB1bml0cy5gO1xuICB9XG59XG5cbiJdfQ==","// DateTime definition object\nimport { isNumber } from 'vega-util';\nimport * as log from './log';\nimport { duplicate, keys } from './util';\n/*\n * A designated year that starts on Sunday.\n */\nvar SUNDAY_YEAR = 2006;\nexport function isDateTime(o) {\n    return !!o && (!!o.year || !!o.quarter || !!o.month || !!o.date || !!o.day ||\n        !!o.hours || !!o.minutes || !!o.seconds || !!o.milliseconds);\n}\nexport var MONTHS = ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'];\nexport var SHORT_MONTHS = MONTHS.map(function (m) { return m.substr(0, 3); });\nexport var DAYS = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];\nexport var SHORT_DAYS = DAYS.map(function (d) { return d.substr(0, 3); });\nfunction normalizeQuarter(q) {\n    if (isNumber(q)) {\n        if (q > 4) {\n            log.warn(log.message.invalidTimeUnit('quarter', q));\n        }\n        // We accept 1-based quarter, so need to readjust to 0-based quarter\n        return (q - 1) + '';\n    }\n    else {\n        // Invalid quarter\n        throw new Error(log.message.invalidTimeUnit('quarter', q));\n    }\n}\nfunction normalizeMonth(m) {\n    if (isNumber(m)) {\n        // We accept 1-based month, so need to readjust to 0-based month\n        return (m - 1) + '';\n    }\n    else {\n        var lowerM = m.toLowerCase();\n        var monthIndex = MONTHS.indexOf(lowerM);\n        if (monthIndex !== -1) {\n            return monthIndex + ''; // 0 for january, ...\n        }\n        var shortM = lowerM.substr(0, 3);\n        var shortMonthIndex = SHORT_MONTHS.indexOf(shortM);\n        if (shortMonthIndex !== -1) {\n            return shortMonthIndex + '';\n        }\n        // Invalid month\n        throw new Error(log.message.invalidTimeUnit('month', m));\n    }\n}\nfunction normalizeDay(d) {\n    if (isNumber(d)) {\n        // mod so that this can be both 0-based where 0 = sunday\n        // and 1-based where 7=sunday\n        return (d % 7) + '';\n    }\n    else {\n        var lowerD = d.toLowerCase();\n        var dayIndex = DAYS.indexOf(lowerD);\n        if (dayIndex !== -1) {\n            return dayIndex + ''; // 0 for january, ...\n        }\n        var shortD = lowerD.substr(0, 3);\n        var shortDayIndex = SHORT_DAYS.indexOf(shortD);\n        if (shortDayIndex !== -1) {\n            return shortDayIndex + '';\n        }\n        // Invalid day\n        throw new Error(log.message.invalidTimeUnit('day', d));\n    }\n}\n/**\n * Return Vega Expression for a particular date time.\n * @param d\n * @param normalize whether to normalize quarter, month, day.\n */\nexport function dateTimeExpr(d, normalize) {\n    if (normalize === void 0) { normalize = false; }\n    var units = [];\n    if (normalize && d.day !== undefined) {\n        if (keys(d).length > 1) {\n            log.warn(log.message.droppedDay(d));\n            d = duplicate(d);\n            delete d.day;\n        }\n    }\n    if (d.year !== undefined) {\n        units.push(d.year);\n    }\n    else if (d.day !== undefined) {\n        // Set year to 2006 for working with day since January 1 2006 is a Sunday\n        units.push(SUNDAY_YEAR);\n    }\n    else {\n        units.push(0);\n    }\n    if (d.month !== undefined) {\n        var month = normalize ? normalizeMonth(d.month) : d.month;\n        units.push(month);\n    }\n    else if (d.quarter !== undefined) {\n        var quarter = normalize ? normalizeQuarter(d.quarter) : d.quarter;\n        units.push(quarter + '*3');\n    }\n    else {\n        units.push(0); // months start at zero in JS\n    }\n    if (d.date !== undefined) {\n        units.push(d.date);\n    }\n    else if (d.day !== undefined) {\n        // HACK: Day only works as a standalone unit\n        // This is only correct because we always set year to 2006 for day\n        var day = normalize ? normalizeDay(d.day) : d.day;\n        units.push(day + '+1');\n    }\n    else {\n        units.push(1); // Date starts at 1 in JS\n    }\n    // Note: can't use TimeUnit enum here as importing it will create\n    // circular dependency problem!\n    for (var _i = 0, _a = ['hours', 'minutes', 'seconds', 'milliseconds']; _i < _a.length; _i++) {\n        var timeUnit = _a[_i];\n        if (d[timeUnit] !== undefined) {\n            units.push(d[timeUnit]);\n        }\n        else {\n            units.push(0);\n        }\n    }\n    if (d.utc) {\n        return \"utc(\" + units.join(', ') + \")\";\n    }\n    else {\n        return \"datetime(\" + units.join(', ') + \")\";\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZXRpbWUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZGF0ZXRpbWUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsNkJBQTZCO0FBRTdCLE9BQU8sRUFBQyxRQUFRLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDbkMsT0FBTyxLQUFLLEdBQUcsTUFBTSxPQUFPLENBQUM7QUFDN0IsT0FBTyxFQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUMsTUFBTSxRQUFRLENBQUM7QUFHdkM7O0dBRUc7QUFDSCxJQUFNLFdBQVcsR0FBRyxJQUFJLENBQUM7QUE4R3pCLE1BQU0scUJBQXFCLENBQU07SUFDL0IsT0FBTyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHO1FBQ3hFLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUM7QUFDakUsQ0FBQztBQUVELE1BQU0sQ0FBQyxJQUFNLE1BQU0sR0FBRyxDQUFDLFNBQVMsRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsV0FBVyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsVUFBVSxDQUFDLENBQUM7QUFDakosTUFBTSxDQUFDLElBQU0sWUFBWSxHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQUMsVUFBQyxDQUFDLElBQUssT0FBQSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxD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U0FDekI7YUFBTTtZQUNMLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDZjtLQUNGO0lBRUQsSUFBSSxDQUFDLENBQUMsR0FBRyxFQUFFO1FBQ1QsT0FBTyxTQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQUcsQ0FBQztLQUNuQztTQUFNO1FBQ0wsT0FBTyxjQUFZLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQUcsQ0FBQztLQUN4QztBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBEYXRlVGltZSBkZWZpbml0aW9uIG9iamVjdFxuXG5pbXBvcnQge2lzTnVtYmVyfSBmcm9tICd2ZWdhLXV0aWwnO1xuaW1wb3J0ICogYXMgbG9nIGZyb20gJy4vbG9nJztcbmltcG9ydCB7ZHVwbGljYXRlLCBrZXlzfSBmcm9tICcuL3V0aWwnO1xuXG5cbi8qXG4gKiBBIGRlc2lnbmF0ZWQgeWVhciB0aGF0IHN0YXJ0cyBvbiBTdW5kYXkuXG4gKi9cbmNvbnN0IFNVTkRBWV9ZRUFSID0gMjAwNjtcblxuLyoqXG4gKiBAbWluaW11bSAxXG4gKiBAbWF4aW11bSAxMlxuICogQFRKUy10eXBlIGludGVnZXJcbiAqL1xuZXhwb3J0IHR5cGUgTW9udGggPSBudW1iZXI7XG5cbi8qKlxuICogQG1pbmltdW0gMVxuICogQG1heGltdW0gN1xuICovXG5leHBvcnQgdHlwZSBEYXkgPSBudW1iZXI7XG5cbi8qKlxuICogT2JqZWN0IGZvciBkZWZpbmluZyBkYXRldGltZSBpbiBWZWdhLUxpdGUgRmlsdGVyLlxuICogSWYgYm90aCBtb250aCBhbmQgcXVhcnRlciBhcmUgcHJvdmlkZWQsIG1vbnRoIGhhcyBoaWdoZXIgcHJlY2VkZW5jZS5cbiAqIGBkYXlgIGNhbm5vdCBiZSBjb21iaW5lZCB3aXRoIG90aGVyIGRhdGUuXG4gKiBXZSBhY2NlcHQgc3RyaW5nIGZvciBtb250aCBhbmQgZGF5IG5hbWVzLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIERhdGVUaW1lIHtcbiAgLyoqXG4gICAqIEludGVnZXIgdmFsdWUgcmVwcmVzZW50aW5nIHRoZSB5ZWFyLlxuICAgKiBAVEpTLXR5cGUgaW50ZWdlclxuICAgKi9cbiAgeWVhcj86IG51bWJlcjtcblxuICAvKipcbiAgICogSW50ZWdlciB2YWx1ZSByZXByZXNlbnRpbmcgdGhlIHF1YXJ0ZXIgb2YgdGhlIHllYXIgKGZyb20gMS00KS5cbiAgICogQG1pbmltdW0gMVxuICAgKiBAbWF4aW11bSA0XG4gICAqIEBUSlMtdHlwZSBpbnRlZ2VyXG4gICAqL1xuICBxdWFydGVyPzogbnVtYmVyO1xuXG4gIC8qKiBPbmUgb2Y6ICgxKSBpbnRlZ2VyIHZhbHVlIHJlcHJlc2VudGluZyB0aGUgbW9udGggZnJvbSBgMWAtYDEyYC4gYDFgIHJlcHJlc2VudHMgSmFudWFyeTsgICgyKSBjYXNlLWluc2Vuc2l0aXZlIG1vbnRoIG5hbWUgKGUuZy4sIGBcIkphbnVhcnlcImApOyAgKDMpIGNhc2UtaW5zZW5zaXRpdmUsIDMtY2hhcmFjdGVyIHNob3J0IG1vbnRoIG5hbWUgKGUuZy4sIGBcIkphblwiYCkuICovXG4gIG1vbnRoPzogTW9udGggfCBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEludGVnZXIgdmFsdWUgcmVwcmVzZW50aW5nIHRoZSBkYXRlIGZyb20gMS0zMS5cbiAgICogQG1pbmltdW0gMVxuICAgKiBAbWF4aW11bSAzMVxuICAgKiBAVEpTLXR5cGUgaW50ZWdlclxuICAgKi9cbiAgZGF0ZT86IG51bWJlcjtcblxuICAvKipcbiAgICogVmFsdWUgcmVwcmVzZW50aW5nIHRoZSBkYXkgb2YgYSB3ZWVrLiAgVGhpcyBjYW4gYmUgb25lIG9mOiAoMSkgaW50ZWdlciB2YWx1ZSAtLSBgMWAgcmVwcmVzZW50cyBNb25kYXk7ICgyKSBjYXNlLWluc2Vuc2l0aXZlIGRheSBuYW1lIChlLmcuLCBgXCJNb25kYXlcImApOyAgKDMpIGNhc2UtaW5zZW5zaXRpdmUsIDMtY2hhcmFjdGVyIHNob3J0IGRheSBuYW1lIChlLmcuLCBgXCJNb25cImApLiAgIDxici8+ICoqV2FybmluZzoqKiBBIERhdGVUaW1lIGRlZmluaXRpb24gb2JqZWN0IHdpdGggYGRheWAqKiBzaG91bGQgbm90IGJlIGNvbWJpbmVkIHdpdGggYHllYXJgLCBgcXVhcnRlcmAsIGBtb250aGAsIG9yIGBkYXRlYC5cbiAgICovXG4gIGRheT86IERheSB8IHN0cmluZztcblxuICAvKipcbiAgICogSW50ZWdlciB2YWx1ZSByZXByZXNlbnRpbmcgdGhlIGhvdXIgb2YgYSBkYXkgZnJvbSAwLTIzLlxuICAgKiBAbWluaW11bSAwXG4gICAqIEBtYXhpbXVtIDIzXG4gICAqIEBUSlMtdHlwZSBpbnRlZ2VyXG4gICAqL1xuICBob3Vycz86IG51bWJlcjtcblxuICAvKipcbiAgICogSW50ZWdlciB2YWx1ZSByZXByZXNlbnRpbmcgdGhlIG1pbnV0ZSBzZWdtZW50IG9mIHRpbWUgZnJvbSAwLTU5LlxuICAgKiBAbWluaW11bSAwXG4gICAqIEBtYXhpbXVtIDU5XG4gICAqIEBUSlMtdHlwZSBpbnRlZ2VyXG4gICAqL1xuICBtaW51dGVzPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBJbnRlZ2VyIHZhbHVlIHJlcHJlc2VudGluZyB0aGUgc2Vjb25kIHNlZ21lbnQgKDAtNTkpIG9mIGEgdGltZSB2YWx1ZVxuICAgKiBAbWluaW11bSAwXG4gICAqIEBtYXhpbXVtIDU5XG4gICAqIEBUSlMtdHlwZSBpbnRlZ2VyXG4gICAqL1xuICBzZWNvbmRzPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBJbnRlZ2VyIHZhbHVlIHJlcHJlc2VudGluZyB0aGUgbWlsbGlzZWNvbmQgc2VnbWVudCBvZiB0aW1lLlxuICAgKiBAbWluaW11bSAwXG4gICAqIEBtYXhpbXVtIDk5OVxuICAgKiBAVEpTLXR5cGUgaW50ZWdlclxuICAgKi9cbiAgbWlsbGlzZWNvbmRzPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBBIGJvb2xlYW4gZmxhZyBpbmRpY2F0aW5nIGlmIGRhdGUgdGltZSBpcyBpbiB1dGMgdGltZS4gSWYgZmFsc2UsIHRoZSBkYXRlIHRpbWUgaXMgaW4gbG9jYWwgdGltZVxuICAgKi9cbiAgdXRjPzogYm9vbGVhbjtcbn1cblxuXG4vKipcbiAqIEludGVybmFsIE9iamVjdCBmb3IgZGVmaW5pbmcgZGF0ZXRpbWUgZXhwcmVzc2lvbnMuXG4gKiBUaGlzIGlzIGFuIGV4cHJlc3Npb24gdmVyc2lvbiBvZiBEYXRlVGltZS5cbiAqIElmIGJvdGggbW9udGggYW5kIHF1YXJ0ZXIgYXJlIHByb3ZpZGVkLCBtb250aCBoYXMgaGlnaGVyIHByZWNlZGVuY2UuXG4gKiBgZGF5YCBjYW5ub3QgYmUgY29tYmluZWQgd2l0aCBvdGhlciBkYXRlLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIERhdGVUaW1lRXhwciB7XG4gIHllYXI/OiBzdHJpbmc7XG4gIHF1YXJ0ZXI/OiBzdHJpbmc7XG4gIG1vbnRoPzogc3RyaW5nO1xuICBkYXRlPzogc3RyaW5nO1xuICBkYXk/OiBzdHJpbmc7XG4gIGhvdXJzPzogc3RyaW5nO1xuICBtaW51dGVzPzogc3RyaW5nO1xuICBzZWNvbmRzPzogc3RyaW5nO1xuICBtaWxsaXNlY29uZHM/OiBzdHJpbmc7XG4gIHV0Yz86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0RhdGVUaW1lKG86IGFueSk6IG8gaXMgRGF0ZVRpbWUge1xuICByZXR1cm4gISFvICYmICghIW8ueWVhciB8fCAhIW8ucXVhcnRlciB8fCAhIW8ubW9udGggfHwgISFvLmRhdGUgfHwgISFvLmRheSB8fFxuICAgICEhby5ob3VycyB8fCAhIW8ubWludXRlcyB8fCAhIW8uc2Vjb25kcyB8fCAhIW8ubWlsbGlzZWNvbmRzKTtcbn1cblxuZXhwb3J0IGNvbnN0IE1PTlRIUyA9IFsnamFudWFyeScsICdmZWJydWFyeScsICdtYXJjaCcsICdhcHJpbCcsICdtYXknLCAnanVuZScsICdqdWx5JywgJ2F1Z3VzdCcsICdzZXB0ZW1iZXInLCAnb2N0b2JlcicsICdub3ZlbWJlcicsICdkZWNlbWJlciddO1xuZXhwb3J0IGNvbnN0IFNIT1JUX01PTlRIUyA9IE1PTlRIUy5tYXAoKG0pID0+IG0uc3Vic3RyKDAsIDMpKTtcblxuZXhwb3J0IGNvbnN0IERBWVMgPSBbJ3N1bmRheScsICdtb25kYXknLCAndHVlc2RheScsICd3ZWRuZXNkYXknLCAndGh1cnNkYXknLCAnZnJpZGF5JywgJ3NhdHVyZGF5J107XG5leHBvcnQgY29uc3QgU0hPUlRfREFZUyA9IERBWVMubWFwKChkKSA9PiBkLnN1YnN0cigwLDMpKTtcblxuZnVuY3Rpb24gbm9ybWFsaXplUXVhcnRlcihxOiBudW1iZXIgfCBzdHJpbmcpIHtcbiAgaWYgKGlzTnVtYmVyKHEpKSB7XG4gICAgaWYgKHEgPiA0KSB7XG4gICAgICBsb2cud2Fybihsb2cubWVzc2FnZS5pbnZhbGlkVGltZVVuaXQoJ3F1YXJ0ZXInLCBxKSk7XG4gICAgfVxuICAgIC8vIFdlIGFjY2VwdCAxLWJhc2VkIHF1YXJ0ZXIsIHNvIG5lZWQgdG8gcmVhZGp1c3QgdG8gMC1iYXNlZCBxdWFydGVyXG4gICAgcmV0dXJuIChxIC0gMSkgKyAnJztcbiAgfSBlbHNlIHtcbiAgICAvLyBJbnZhbGlkIHF1YXJ0ZXJcbiAgICB0aHJvdyBuZXcgRXJyb3IobG9nLm1lc3NhZ2UuaW52YWxpZFRpbWVVbml0KCdxdWFydGVyJywgcSkpO1xuICB9XG59XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZU1vbnRoKG06IHN0cmluZyB8IG51bWJlcikge1xuICBpZiAoaXNOdW1iZXIobSkpIHtcbiAgICAvLyBXZSBhY2NlcHQgMS1iYXNlZCBtb250aCwgc28gbmVlZCB0byByZWFkanVzdCB0byAwLWJhc2VkIG1vbnRoXG4gICAgcmV0dXJuIChtIC0gMSkgKyAnJztcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBsb3dlck0gPSBtLnRvTG93ZXJDYXNlKCk7XG4gICAgY29uc3QgbW9udGhJbmRleCA9IE1PTlRIUy5pbmRleE9mKGxvd2VyTSk7XG4gICAgaWYgKG1vbnRoSW5kZXggIT09IC0xKSB7XG4gICAgICByZXR1cm4gbW9udGhJbmRleCArICcnOyAvLyAwIGZvciBqYW51YXJ5LCAuLi5cbiAgICB9XG4gICAgY29uc3Qgc2hvcnRNID0gbG93ZXJNLnN1YnN0cigwLCAzKTtcbiAgICBjb25zdCBzaG9ydE1vbnRoSW5kZXggPSBTSE9SVF9NT05USFMuaW5kZXhPZihzaG9ydE0pO1xuICAgIGlmIChzaG9ydE1vbnRoSW5kZXggIT09IC0xKSB7XG4gICAgICByZXR1cm4gc2hvcnRNb250aEluZGV4ICsgJyc7XG4gICAgfVxuICAgIC8vIEludmFsaWQgbW9udGhcbiAgICB0aHJvdyBuZXcgRXJyb3IobG9nLm1lc3NhZ2UuaW52YWxpZFRpbWVVbml0KCdtb250aCcsIG0pKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBub3JtYWxpemVEYXkoZDogc3RyaW5nIHwgbnVtYmVyKSB7XG4gIGlmIChpc051bWJlcihkKSkge1xuICAgIC8vIG1vZCBzbyB0aGF0IHRoaXMgY2FuIGJlIGJvdGggMC1iYXNlZCB3aGVyZSAwID0gc3VuZGF5XG4gICAgLy8gYW5kIDEtYmFzZWQgd2hlcmUgNz1zdW5kYXlcbiAgICByZXR1cm4gKGQgJSA3KSArICcnO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGxvd2VyRCA9IGQudG9Mb3dlckNhc2UoKTtcbiAgICBjb25zdCBkYXlJbmRleCA9IERBWVMuaW5kZXhPZihsb3dlckQpO1xuICAgIGlmIChkYXlJbmRleCAhPT0gLTEpIHtcbiAgICAgIHJldHVybiBkYXlJbmRleCArICcnOyAvLyAwIGZvciBqYW51YXJ5LCAuLi5cbiAgICB9XG4gICAgY29uc3Qgc2hvcnREID0gbG93ZXJELnN1YnN0cigwLCAzKTtcbiAgICBjb25zdCBzaG9ydERheUluZGV4ID0gU0hPUlRfREFZUy5pbmRleE9mKHNob3J0RCk7XG4gICAgaWYgKHNob3J0RGF5SW5kZXggIT09IC0xKSB7XG4gICAgICByZXR1cm4gc2hvcnREYXlJbmRleCArICcnO1xuICAgIH1cbiAgICAvLyBJbnZhbGlkIGRheVxuICAgIHRocm93IG5ldyBFcnJvcihsb2cubWVzc2FnZS5pbnZhbGlkVGltZVVuaXQoJ2RheScsIGQpKTtcbiAgfVxufVxuXG4vKipcbiAqIFJldHVybiBWZWdhIEV4cHJlc3Npb24gZm9yIGEgcGFydGljdWxhciBkYXRlIHRpbWUuXG4gKiBAcGFyYW0gZFxuICogQHBhcmFtIG5vcm1hbGl6ZSB3aGV0aGVyIHRvIG5vcm1hbGl6ZSBxdWFydGVyLCBtb250aCwgZGF5LlxuICovXG5leHBvcnQgZnVuY3Rpb24gZGF0ZVRpbWVFeHByKGQ6IERhdGVUaW1lIHwgRGF0ZVRpbWVFeHByLCBub3JtYWxpemUgPSBmYWxzZSkge1xuICBjb25zdCB1bml0czogKHN0cmluZyB8IG51bWJlcilbXSA9IFtdO1xuXG4gIGlmIChub3JtYWxpemUgJiYgZC5kYXkgIT09IHVuZGVmaW5lZCkge1xuICAgIGlmIChrZXlzKGQpLmxlbmd0aCA+IDEpIHtcbiAgICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLmRyb3BwZWREYXkoZCkpO1xuICAgICAgZCA9IGR1cGxpY2F0ZShkKTtcbiAgICAgIGRlbGV0ZSBkLmRheTtcbiAgICB9XG4gIH1cblxuICBpZiAoZC55ZWFyICE9PSB1bmRlZmluZWQpIHtcbiAgICB1bml0cy5wdXNoKGQueWVhcik7XG4gIH0gZWxzZSBpZiAoZC5kYXkgIT09IHVuZGVmaW5lZCkge1xuICAgIC8vIFNldCB5ZWFyIHRvIDIwMDYgZm9yIHdvcmtpbmcgd2l0aCBkYXkgc2luY2UgSmFudWFyeSAxIDIwMDYgaXMgYSBTdW5kYXlcbiAgICB1bml0cy5wdXNoKFNVTkRBWV9ZRUFSKTtcbiAgfSBlbHNlIHtcbiAgICB1bml0cy5wdXNoKDApO1xuICB9XG5cbiAgaWYgKGQubW9udGggIT09IHVuZGVmaW5lZCkge1xuICAgIGNvbnN0IG1vbnRoID0gbm9ybWFsaXplID8gbm9ybWFsaXplTW9udGgoZC5tb250aCkgOiBkLm1vbnRoO1xuICAgIHVuaXRzLnB1c2gobW9udGgpO1xuICB9IGVsc2UgaWYgKGQucXVhcnRlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgY29uc3QgcXVhcnRlciA9IG5vcm1hbGl6ZSA/IG5vcm1hbGl6ZVF1YXJ0ZXIoZC5xdWFydGVyKSA6IGQucXVhcnRlcjtcbiAgICB1bml0cy5wdXNoKHF1YXJ0ZXIgKyAnKjMnKTtcbiAgfSBlbHNlIHtcbiAgICB1bml0cy5wdXNoKDApOyAvLyBtb250aHMgc3RhcnQgYXQgemVybyBpbiBKU1xuICB9XG5cbiAgaWYgKGQuZGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdW5pdHMucHVzaChkLmRhdGUpO1xuICB9IGVsc2UgaWYgKGQuZGF5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAvLyBIQUNLOiBEYXkgb25seSB3b3JrcyBhcyBhIHN0YW5kYWxvbmUgdW5pdFxuICAgIC8vIFRoaXMgaXMgb25seSBjb3JyZWN0IGJlY2F1c2Ugd2UgYWx3YXlzIHNldCB5ZWFyIHRvIDIwMDYgZm9yIGRheVxuICAgIGNvbnN0IGRheSA9IG5vcm1hbGl6ZSA/IG5vcm1hbGl6ZURheShkLmRheSkgOiBkLmRheTtcbiAgICB1bml0cy5wdXNoKGRheSArICcrMScpO1xuICB9IGVsc2Uge1xuICAgIHVuaXRzLnB1c2goMSk7IC8vIERhdGUgc3RhcnRzIGF0IDEgaW4gSlNcbiAgfVxuXG4gIC8vIE5vdGU6IGNhbid0IHVzZSBUaW1lVW5pdCBlbnVtIGhlcmUgYXMgaW1wb3J0aW5nIGl0IHdpbGwgY3JlYXRlXG4gIC8vIGNpcmN1bGFyIGRlcGVuZGVuY3kgcHJvYmxlbSFcbiAgZm9yIChjb25zdCB0aW1lVW5pdCBvZiBbJ2hvdXJzJywgJ21pbnV0ZXMnLCAnc2Vjb25kcycsICdtaWxsaXNlY29uZHMnXSkge1xuICAgIGlmIChkW3RpbWVVbml0XSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB1bml0cy5wdXNoKGRbdGltZVVuaXRdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdW5pdHMucHVzaCgwKTtcbiAgICB9XG4gIH1cblxuICBpZiAoZC51dGMpIHtcbiAgICByZXR1cm4gYHV0Yygke3VuaXRzLmpvaW4oJywgJyl9KWA7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGBkYXRldGltZSgke3VuaXRzLmpvaW4oJywgJyl9KWA7XG4gIH1cbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { dateTimeExpr } from './datetime';\nimport * as log from './log';\nimport { accessPathWithDatum, flagKeys } from './util';\nexport var TimeUnit;\n(function (TimeUnit) {\n    TimeUnit.YEAR = 'year';\n    TimeUnit.MONTH = 'month';\n    TimeUnit.DAY = 'day';\n    TimeUnit.DATE = 'date';\n    TimeUnit.HOURS = 'hours';\n    TimeUnit.MINUTES = 'minutes';\n    TimeUnit.SECONDS = 'seconds';\n    TimeUnit.MILLISECONDS = 'milliseconds';\n    TimeUnit.YEARMONTH = 'yearmonth';\n    TimeUnit.YEARMONTHDATE = 'yearmonthdate';\n    TimeUnit.YEARMONTHDATEHOURS = 'yearmonthdatehours';\n    TimeUnit.YEARMONTHDATEHOURSMINUTES = 'yearmonthdatehoursminutes';\n    TimeUnit.YEARMONTHDATEHOURSMINUTESSECONDS = 'yearmonthdatehoursminutesseconds';\n    // MONTHDATE always include 29 February since we use year 0th (which is a leap year);\n    TimeUnit.MONTHDATE = 'monthdate';\n    TimeUnit.HOURSMINUTES = 'hoursminutes';\n    TimeUnit.HOURSMINUTESSECONDS = 'hoursminutesseconds';\n    TimeUnit.MINUTESSECONDS = 'minutesseconds';\n    TimeUnit.SECONDSMILLISECONDS = 'secondsmilliseconds';\n    TimeUnit.QUARTER = 'quarter';\n    TimeUnit.YEARQUARTER = 'yearquarter';\n    TimeUnit.QUARTERMONTH = 'quartermonth';\n    TimeUnit.YEARQUARTERMONTH = 'yearquartermonth';\n    TimeUnit.UTCYEAR = 'utcyear';\n    TimeUnit.UTCMONTH = 'utcmonth';\n    TimeUnit.UTCDAY = 'utcday';\n    TimeUnit.UTCDATE = 'utcdate';\n    TimeUnit.UTCHOURS = 'utchours';\n    TimeUnit.UTCMINUTES = 'utcminutes';\n    TimeUnit.UTCSECONDS = 'utcseconds';\n    TimeUnit.UTCMILLISECONDS = 'utcmilliseconds';\n    TimeUnit.UTCYEARMONTH = 'utcyearmonth';\n    TimeUnit.UTCYEARMONTHDATE = 'utcyearmonthdate';\n    TimeUnit.UTCYEARMONTHDATEHOURS = 'utcyearmonthdatehours';\n    TimeUnit.UTCYEARMONTHDATEHOURSMINUTES = 'utcyearmonthdatehoursminutes';\n    TimeUnit.UTCYEARMONTHDATEHOURSMINUTESSECONDS = 'utcyearmonthdatehoursminutesseconds';\n    // MONTHDATE always include 29 February since we use year 0th (which is a leap year);\n    TimeUnit.UTCMONTHDATE = 'utcmonthdate';\n    TimeUnit.UTCHOURSMINUTES = 'utchoursminutes';\n    TimeUnit.UTCHOURSMINUTESSECONDS = 'utchoursminutesseconds';\n    TimeUnit.UTCMINUTESSECONDS = 'utcminutesseconds';\n    TimeUnit.UTCSECONDSMILLISECONDS = 'utcsecondsmilliseconds';\n    TimeUnit.UTCQUARTER = 'utcquarter';\n    TimeUnit.UTCYEARQUARTER = 'utcyearquarter';\n    TimeUnit.UTCQUARTERMONTH = 'utcquartermonth';\n    TimeUnit.UTCYEARQUARTERMONTH = 'utcyearquartermonth';\n})(TimeUnit || (TimeUnit = {}));\n/** Time Unit that only corresponds to only one part of Date objects. */\nvar LOCAL_SINGLE_TIMEUNIT_INDEX = {\n    year: 1,\n    quarter: 1,\n    month: 1,\n    day: 1,\n    date: 1,\n    hours: 1,\n    minutes: 1,\n    seconds: 1,\n    milliseconds: 1\n};\nexport var TIMEUNIT_PARTS = flagKeys(LOCAL_SINGLE_TIMEUNIT_INDEX);\nexport function isLocalSingleTimeUnit(timeUnit) {\n    return !!LOCAL_SINGLE_TIMEUNIT_INDEX[timeUnit];\n}\nvar UTC_SINGLE_TIMEUNIT_INDEX = {\n    utcyear: 1,\n    utcquarter: 1,\n    utcmonth: 1,\n    utcday: 1,\n    utcdate: 1,\n    utchours: 1,\n    utcminutes: 1,\n    utcseconds: 1,\n    utcmilliseconds: 1\n};\nexport function isUtcSingleTimeUnit(timeUnit) {\n    return !!UTC_SINGLE_TIMEUNIT_INDEX[timeUnit];\n}\nvar LOCAL_MULTI_TIMEUNIT_INDEX = {\n    yearquarter: 1,\n    yearquartermonth: 1,\n    yearmonth: 1,\n    yearmonthdate: 1,\n    yearmonthdatehours: 1,\n    yearmonthdatehoursminutes: 1,\n    yearmonthdatehoursminutesseconds: 1,\n    quartermonth: 1,\n    monthdate: 1,\n    hoursminutes: 1,\n    hoursminutesseconds: 1,\n    minutesseconds: 1,\n    secondsmilliseconds: 1\n};\nvar UTC_MULTI_TIMEUNIT_INDEX = {\n    utcyearquarter: 1,\n    utcyearquartermonth: 1,\n    utcyearmonth: 1,\n    utcyearmonthdate: 1,\n    utcyearmonthdatehours: 1,\n    utcyearmonthdatehoursminutes: 1,\n    utcyearmonthdatehoursminutesseconds: 1,\n    utcquartermonth: 1,\n    utcmonthdate: 1,\n    utchoursminutes: 1,\n    utchoursminutesseconds: 1,\n    utcminutesseconds: 1,\n    utcsecondsmilliseconds: 1\n};\nvar UTC_TIMEUNIT_INDEX = tslib_1.__assign({}, UTC_SINGLE_TIMEUNIT_INDEX, UTC_MULTI_TIMEUNIT_INDEX);\nexport function isUTCTimeUnit(t) {\n    return !!UTC_TIMEUNIT_INDEX[t];\n}\nexport function getLocalTimeUnit(t) {\n    return t.substr(3);\n}\nvar TIMEUNIT_INDEX = tslib_1.__assign({}, LOCAL_SINGLE_TIMEUNIT_INDEX, UTC_SINGLE_TIMEUNIT_INDEX, LOCAL_MULTI_TIMEUNIT_INDEX, UTC_MULTI_TIMEUNIT_INDEX);\nexport var TIMEUNITS = flagKeys(TIMEUNIT_INDEX);\nexport function isTimeUnit(t) {\n    return !!TIMEUNIT_INDEX[t];\n}\nvar SET_DATE_METHOD = {\n    year: 'setFullYear',\n    month: 'setMonth',\n    date: 'setDate',\n    hours: 'setHours',\n    minutes: 'setMinutes',\n    seconds: 'setSeconds',\n    milliseconds: 'setMilliseconds',\n    // Day and quarter have their own special cases\n    quarter: null,\n    day: null,\n};\n/**\n * Converts a date to only have the measurements relevant to the specified unit\n * i.e. ('yearmonth', '2000-12-04 07:58:14') -> '2000-12-01 00:00:00'\n * Note: the base date is Jan 01 1900 00:00:00\n */\nexport function convert(unit, date) {\n    var isUTC = isUTCTimeUnit(unit);\n    var result = isUTC ?\n        // start with uniform date\n        new Date(Date.UTC(0, 0, 1, 0, 0, 0, 0)) :\n        new Date(0, 0, 1, 0, 0, 0, 0);\n    for (var _i = 0, TIMEUNIT_PARTS_1 = TIMEUNIT_PARTS; _i < TIMEUNIT_PARTS_1.length; _i++) {\n        var timeUnitPart = TIMEUNIT_PARTS_1[_i];\n        if (containsTimeUnit(unit, timeUnitPart)) {\n            switch (timeUnitPart) {\n                case TimeUnit.DAY:\n                    throw new Error('Cannot convert to TimeUnits containing \\'day\\'');\n                case TimeUnit.QUARTER: {\n                    var _a = dateMethods('month', isUTC), getDateMethod_1 = _a.getDateMethod, setDateMethod_1 = _a.setDateMethod;\n                    // indicate quarter by setting month to be the first of the quarter i.e. may (4) -> april (3)\n                    result[setDateMethod_1]((Math.floor(date[getDateMethod_1]() / 3)) * 3);\n                    break;\n                }\n                default:\n                    var _b = dateMethods(timeUnitPart, isUTC), getDateMethod = _b.getDateMethod, setDateMethod = _b.setDateMethod;\n                    result[setDateMethod](date[getDateMethod]());\n            }\n        }\n    }\n    return result;\n}\nfunction dateMethods(singleUnit, isUtc) {\n    var rawSetDateMethod = SET_DATE_METHOD[singleUnit];\n    var setDateMethod = isUtc ? 'setUTC' + rawSetDateMethod.substr(3) : rawSetDateMethod;\n    var getDateMethod = 'get' + (isUtc ? 'UTC' : '') + rawSetDateMethod.substr(3);\n    return { setDateMethod: setDateMethod, getDateMethod: getDateMethod };\n}\nexport function getTimeUnitParts(timeUnit) {\n    return TIMEUNIT_PARTS.reduce(function (parts, part) {\n        if (containsTimeUnit(timeUnit, part)) {\n            return parts.concat(part);\n        }\n        return parts;\n    }, []);\n}\n/** Returns true if fullTimeUnit contains the timeUnit, false otherwise. */\nexport function containsTimeUnit(fullTimeUnit, timeUnit) {\n    var index = fullTimeUnit.indexOf(timeUnit);\n    return index > -1 &&\n        (timeUnit !== TimeUnit.SECONDS ||\n            index === 0 ||\n            fullTimeUnit.charAt(index - 1) !== 'i' // exclude milliseconds\n        );\n}\n/**\n * Returns Vega expresssion for a given timeUnit and fieldRef\n */\nexport function fieldExpr(fullTimeUnit, field) {\n    var fieldRef = accessPathWithDatum(field);\n    var utc = isUTCTimeUnit(fullTimeUnit) ? 'utc' : '';\n    function func(timeUnit) {\n        if (timeUnit === TimeUnit.QUARTER) {\n            // quarter starting at 0 (0,3,6,9).\n            return \"(\" + utc + \"quarter(\" + fieldRef + \")-1)\";\n        }\n        else {\n            return \"\" + utc + timeUnit + \"(\" + fieldRef + \")\";\n        }\n    }\n    var d = TIMEUNIT_PARTS.reduce(function (dateExpr, tu) {\n        if (containsTimeUnit(fullTimeUnit, tu)) {\n            dateExpr[tu] = func(tu);\n        }\n        return dateExpr;\n    }, {});\n    return dateTimeExpr(d);\n}\n/**\n * returns the signal expression used for axis labels for a time unit\n */\nexport function formatExpression(timeUnit, field, shortTimeLabels, isUTCScale) {\n    if (!timeUnit) {\n        return undefined;\n    }\n    var dateComponents = [];\n    var expression = '';\n    var hasYear = containsTimeUnit(timeUnit, TimeUnit.YEAR);\n    if (containsTimeUnit(timeUnit, TimeUnit.QUARTER)) {\n        // special expression for quarter as prefix\n        expression = \"'Q' + quarter(\" + field + \")\";\n    }\n    if (containsTimeUnit(timeUnit, TimeUnit.MONTH)) {\n        // By default use short month name\n        dateComponents.push(shortTimeLabels !== false ? '%b' : '%B');\n    }\n    if (containsTimeUnit(timeUnit, TimeUnit.DAY)) {\n        dateComponents.push(shortTimeLabels ? '%a' : '%A');\n    }\n    else if (containsTimeUnit(timeUnit, TimeUnit.DATE)) {\n        dateComponents.push('%d' + (hasYear ? ',' : '')); // add comma if there is year\n    }\n    if (hasYear) {\n        dateComponents.push(shortTimeLabels ? '%y' : '%Y');\n    }\n    var timeComponents = [];\n    if (containsTimeUnit(timeUnit, TimeUnit.HOURS)) {\n        timeComponents.push('%H');\n    }\n    if (containsTimeUnit(timeUnit, TimeUnit.MINUTES)) {\n        timeComponents.push('%M');\n    }\n    if (containsTimeUnit(timeUnit, TimeUnit.SECONDS)) {\n        timeComponents.push('%S');\n    }\n    if (containsTimeUnit(timeUnit, TimeUnit.MILLISECONDS)) {\n        timeComponents.push('%L');\n    }\n    var dateTimeComponents = [];\n    if (dateComponents.length > 0) {\n        dateTimeComponents.push(dateComponents.join(' '));\n    }\n    if (timeComponents.length > 0) {\n        dateTimeComponents.push(timeComponents.join(':'));\n    }\n    if (dateTimeComponents.length > 0) {\n        if (expression) {\n            // Add space between quarter and main time format\n            expression += \" + ' ' + \";\n        }\n        // We only use utcFormat for utc scale\n        // For utc time units, the data is already converted as a part of timeUnit transform.\n        // Thus, utc time units should use timeFormat to avoid shifting the time twice.\n        if (isUTCScale) {\n            expression += \"utcFormat(\" + field + \", '\" + dateTimeComponents.join(' ') + \"')\";\n        }\n        else {\n            expression += \"timeFormat(\" + field + \", '\" + dateTimeComponents.join(' ') + \"')\";\n        }\n    }\n    // If expression is still an empty string, return undefined instead.\n    return expression || undefined;\n}\nexport function normalizeTimeUnit(timeUnit) {\n    if (timeUnit !== 'day' && timeUnit.indexOf('day') >= 0) {\n        log.warn(log.message.dayReplacedWithDate(timeUnit));\n        return timeUnit.replace('day', 'date');\n    }\n    return timeUnit;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGltZXVuaXQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdGltZXVuaXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBZSxZQUFZLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDdEQsT0FBTyxLQUFLLEdBQUcsTUFBTSxPQUFPLENBQUM7QUFDN0IsT0FBTyxFQUFDLG1CQUFtQixFQUFRLFFBQVEsRUFBQyxNQUFNLFFBQVEsQ0FBQztBQUUzRCxNQUFNLEtBQVcsUUFBUSxDQWlEeEI7QUFqREQsV0FBaUIsUUFBUTtJQUNWLGFBQUksR0FBVyxNQUFNLENBQUM7SUFDdEIsY0FBSyxHQUFZLE9BQU8sQ0FBQztJQUN6QixZQUFHLEdBQVUsS0FBSyxDQUFDO0lBQ25CLGFBQUksR0FBVyxNQUFNLENBQUM7SUFDdEIsY0FBSyxHQUFZLE9BQU8sQ0FBQztJQUN6QixnQkFBTyxHQUFjLFNBQVMsQ0FBQztJQUMvQixnQkFBTyxHQUFjLFNBQVMsQ0FBQztJQUMvQixxQkFBWSxHQUFtQixjQUFjLENBQUM7SUFDOUMsa0JBQVMsR0FBZ0IsV0FBVyxDQUFDO0lBQ3JDLHNCQUFhLEdBQW9CLGVBQWUsQ0FBQztJQUNqRCwyQkFBa0IsR0FBeUIsb0JBQW9CLENBQUM7SUFDaEUsa0NBQXlCLEdBQWdDLDJCQUEyQixDQUFDO0lBQ3JGLHlDQUFnQyxHQUF1QyxrQ0FBa0MsQ0FBQztJQUV2SCxxRkFBcUY7SUFDeEUsa0JBQVMsR0FBZ0IsV0FBVyxDQUFDO0lBQ3JDLHFCQUFZLEdBQW1CLGNBQWMsQ0FBQztJQUM5Qyw0QkFBbUIsR0FBMEIscUJBQXFCLENBQUM7SUFDbkUsdUJBQWMsR0FBcUIsZ0JBQWdCLENBQUM7SUFDcEQsNEJBQW1CLEdBQTBCLHFCQUFxQixDQUFDO0lBQ25FLGdCQUFPLEdBQWMsU0FBUyxDQUFDO0lBQy9CLG9CQUFXLEdBQWtCLGFBQWEsQ0FBQztJQUMzQyxxQkFBWSxHQUFtQixjQUFjLENBQUM7SUFDOUMseUJBQWdC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QU8sVUFBVSxJQUFJLFNBQVMsQ0FBQztBQUNqQyxDQUFDO0FBRUQsTUFBTSw0QkFBNEIsUUFBa0I7SUFDbEQsSUFBSSxRQUFRLEtBQUssS0FBSyxJQUFJLFFBQVEsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFO1FBQ3RELEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1FBQ3BELE9BQU8sUUFBUSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFhLENBQUM7S0FDcEQ7SUFDRCxPQUFPLFFBQVEsQ0FBQztBQUNsQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtEYXRlVGltZUV4cHIsIGRhdGVUaW1lRXhwcn0gZnJvbSAnLi9kYXRldGltZSc7XG5pbXBvcnQgKiBhcyBsb2cgZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHthY2Nlc3NQYXRoV2l0aERhdHVtLCBGbGFnLCBmbGFnS2V5c30gZnJvbSAnLi91dGlsJztcblxuZXhwb3J0IG5hbWVzcGFjZSBUaW1lVW5pdCB7XG4gIGV4cG9ydCBjb25zdCBZRUFSOiAneWVhcicgPSAneWVhcic7XG4gIGV4cG9ydCBjb25zdCBNT05USDogJ21vbnRoJyA9ICdtb250aCc7XG4gIGV4cG9ydCBjb25zdCBEQVk6ICdkYXknID0gJ2RheSc7XG4gIGV4cG9ydCBjb25zdCBEQVRFOiAnZGF0ZScgPSAnZGF0ZSc7XG4gIGV4cG9ydCBjb25zdCBIT1VSUzogJ2hvdXJzJyA9ICdob3Vycyc7XG4gIGV4cG9ydCBjb25zdCBNSU5VVEVTOiAnbWludXRlcycgPSAnbWludXRlcyc7XG4gIGV4cG9ydCBjb25zdCBTRUNPTkRTOiAnc2Vjb25kcycgPSAnc2Vjb25kcyc7XG4gIGV4cG9ydCBjb25zdCBNSUxMSVNFQ09ORFM6ICdtaWxsaXNlY29uZHMnID0gJ21pbGxpc2Vjb25kcyc7XG4gIGV4cG9ydCBjb25zdCBZRUFSTU9OVEg6ICd5ZWFybW9udGgnID0gJ3llYXJtb250aCc7XG4gIGV4cG9ydCBjb25zdCBZRUFSTU9OVEhEQVRFOiAneWVhcm1vbnRoZGF0ZScgPSAneWVhcm1vbnRoZGF0ZSc7XG4gIGV4cG9ydCBjb25zdCBZRUFSTU9OVEhEQVRFSE9VUlM6ICd5ZWFybW9udGhkYXRlaG91cnMnID0gJ3llYXJtb250aGRhdGVob3Vycyc7XG4gIGV4cG9ydCBjb25zdCBZRUFSTU9OVEhEQVRFSE9VUlNNSU5VVEVTOiAneWVhcm1vbnRoZGF0ZWhvdXJzbWludXRlcycgPSAneWVhcm1vbnRoZGF0ZWhvdXJzbWludXRlcyc7XG4gIGV4cG9ydCBjb25zdCBZRUFSTU9OVEhEQVRFSE9VUlNNSU5VVEVTU0VDT05EUzogJ3llYXJtb250aGRhdGVob3Vyc21pbnV0ZXNzZWNvbmRzJyA9ICd5ZWFybW9udGhkYXRlaG91cnNtaW51dGVzc2Vjb25kcyc7XG5cbiAgLy8gTU9OVEhEQVRFIGFsd2F5cyBpbmNsdWRlIDI5IEZlYnJ1YXJ5IHNpbmNlIHdlIHVzZSB5ZWFyIDB0aCAod2hpY2ggaXMgYSBsZWFwIHllYXIpO1xuICBleHBvcnQgY29uc3QgTU9OVEhEQVRFOiAnbW9udGhkYXRlJyA9ICdtb250aGRhdGUnO1xuICBleHBvcnQgY29uc3QgSE9VUlNNSU5VVEVTOiAnaG91cnNtaW51dGVzJyA9ICdob3Vyc21pbnV0ZXMnO1xuICBleHBvcnQgY29uc3QgSE9VUlNNSU5VVEVTU0VDT05EUzogJ2hvdXJzbWludXRlc3NlY29uZHMnID0gJ2hvdXJzbWludXRlc3NlY29uZHMnO1xuICBleHBvcnQgY29uc3QgTUlOVVRFU1NFQ09ORFM6ICdtaW51dGVzc2Vjb25kcycgPSAnbWludXRlc3NlY29uZHMnO1xuICBleHBvcnQgY29uc3QgU0VDT05EU01JTExJU0VDT05EUzogJ3NlY29uZHNtaWxsaXNlY29uZHMnID0gJ3NlY29uZHNtaWxsaXNlY29uZHMnO1xuICBleHBvcnQgY29uc3QgUVVBUlRFUjogJ3F1YXJ0ZXInID0gJ3F1YXJ0ZXInO1xuICBleHBvcnQgY29uc3QgWUVBUlFVQVJURVI6ICd5ZWFycXVhcnRlcicgPSAneWVhcnF1YXJ0ZXInO1xuICBleHBvcnQgY29uc3QgUVVBUlRFUk1PTlRIOiAncXVhcnRlcm1vbnRoJyA9ICdxdWFydGVybW9udGgnO1xuICBleHBvcnQgY29uc3QgWUVBUlFVQVJURVJNT05USDogJ3llYXJxdWFydGVybW9udGgnID0gJ3llYXJxdWFydGVybW9udGgnO1xuICBleHBvcnQgY29uc3QgVVRDWUVBUjogJ3V0Y3llYXInID0gJ3V0Y3llYXInO1xuICBleHBvcnQgY29uc3QgVVRDTU9OVEg6ICd1dGNtb250aCcgPSAndXRjbW9udGgnO1xuICBleHBvcnQgY29uc3QgVVRDREFZOiAndXRjZGF5JyA9ICd1dGNkYXknO1xuICBleHBvcnQgY29uc3QgVVRDREFURTogJ3V0Y2RhdGUnID0gJ3V0Y2RhdGUnO1xuICBleHBvcnQgY29uc3QgVVRDSE9VUlM6ICd1dGNob3VycycgPSAndXRjaG91cnMnO1xuICBleHBvcnQgY29uc3QgVVRDTUlOVVRFUzogJ3V0Y21pbnV0ZXMnID0gJ3V0Y21pbnV0ZXMnO1xuICBleHBvcnQgY29uc3QgVVRDU0VDT05EUzogJ3V0Y3NlY29uZHMnID0gJ3V0Y3NlY29uZHMnO1xuICBleHBvcnQgY29uc3QgVVRDTUlMTElTRUNPTkRTOiAndXRjbWlsbGlzZWNvbmRzJyA9ICd1dGNtaWxsaXNlY29uZHMnO1xuICBleHBvcnQgY29uc3QgVVRDWUVBUk1PTlRIOiAndXRjeWVhcm1vbnRoJyA9ICd1dGN5ZWFybW9udGgnO1xuICBleHBvcnQgY29uc3QgVVRDWUVBUk1PTlRIREFURTogJ3V0Y3llYXJtb250aGRhdGUnID0gJ3V0Y3llYXJtb250aGRhdGUnO1xuICBleHBvcnQgY29uc3QgVVRDWUVBUk1PTlRIREFURUhPVVJTOiAndXRjeWVhcm1vbnRoZGF0ZWhvdXJzJyA9ICd1dGN5ZWFybW9udGhkYXRlaG91cnMnO1xuICBleHBvcnQgY29uc3QgVVRDWUVBUk1PTlRIREFURUhPVVJTTUlOVVRFUzogJ3V0Y3llYXJtb250aGRhdGVob3Vyc21pbnV0ZXMnID0gJ3V0Y3llYXJtb250aGRhdGVob3Vyc21pbnV0ZXMnO1xuICBleHBvcnQgY29uc3QgVVRDWUVBUk1PTlRIREFURUhPVVJTTUlOVVRFU1NFQ09ORFM6ICd1dGN5ZWFybW9udGhkYXRlaG91cnNtaW51dGVzc2Vjb25kcycgPSAndXRjeWVhcm1vbnRoZGF0ZWhvdXJzbWludXRlc3NlY29uZHMnO1xuXG4gIC8vIE1PTlRIREFURSBhbHdheXMgaW5jbHVkZSAyOSBGZWJydWFyeSBzaW5jZSB3ZSB1c2UgeWVhciAwdGggKHdoaWNoIGlzIGEgbGVhcCB5ZWFyKTtcbiAgZXhwb3J0IGNvbnN0IFVUQ01PTlRIREFURTogJ3V0Y21vbnRoZGF0ZScgPSAndXRjbW9udGhkYXRlJztcbiAgZXhwb3J0IGNvbnN0IFVUQ0hPVVJTTUlOVVRFUzogJ3V0Y2hvdXJzbWludXRlcycgPSAndXRjaG91cnNtaW51dGVzJztcbiAgZXhwb3J0IGNvbnN0IFVUQ0hPVVJTTUlOVVRFU1NFQ09ORFM6ICd1dGNob3Vyc21pbnV0ZXNzZWNvbmRzJyA9ICd1dGNob3Vyc21pbnV0ZXNzZWNvbmRzJztcbiAgZXhwb3J0IGNvbnN0IFVUQ01JTlVURVNTRUNPTkRTOiAndXRjbWludXRlc3NlY29uZHMnID0gJ3V0Y21pbnV0ZXNzZWNvbmRzJztcbiAgZXhwb3J0IGNvbnN0IFVUQ1NFQ09ORFNNSUxMSVNFQ09ORFM6ICd1dGNzZWNvbmRzbWlsbGlzZWNvbmRzJyA9ICd1dGNzZWNvbmRzbWlsbGlzZWNvbmRzJztcbiAgZXhwb3J0IGNvbnN0IFVUQ1FVQVJURVI6ICd1dGNxdWFydGVyJyA9ICd1dGNxdWFydGVyJztcbiAgZXhwb3J0IGNvbnN0IFVUQ1lFQVJRVUFSVEVSOiAndXRjeWVhcnF1YXJ0ZXInID0gJ3V0Y3llYXJxdWFydGVyJztcbiAgZXhwb3J0IGNvbnN0IFVUQ1FVQVJURVJNT05USDogJ3V0Y3F1YXJ0ZXJtb250aCcgPSAndXRjcXVhcnRlcm1vbnRoJztcbiAgZXhwb3J0IGNvbnN0IFVUQ1lFQVJRVUFSVEVSTU9OVEg6ICd1dGN5ZWFycXVhcnRlcm1vbnRoJyA9ICd1dGN5ZWFycXVhcnRlcm1vbnRoJztcbn1cblxuZXhwb3J0IHR5cGUgTG9jYWxTaW5nbGVUaW1lVW5pdCA9XG4gIHR5cGVvZiBUaW1lVW5pdC5ZRUFSIHxcbiAgdHlwZW9mIFRpbWVVbml0LlFVQVJURVIgfFxuICB0eXBlb2YgVGltZVVuaXQuTU9OVEggfFxuICB0eXBlb2YgVGltZVVuaXQuREFZIHxcbiAgdHlwZW9mIFRpbWVVbml0LkRBVEUgfFxuICB0eXBlb2YgVGltZVVuaXQuSE9VUlMgfFxuICB0eXBlb2YgVGltZVVuaXQuTUlOVVRFUyB8XG4gIHR5cGVvZiBUaW1lVW5pdC5TRUNPTkRTIHxcbiAgdHlwZW9mIFRpbWVVbml0Lk1JTExJU0VDT05EUztcblxuLyoqIFRpbWUgVW5pdCB0aGF0IG9ubHkgY29ycmVzcG9uZHMgdG8gb25seSBvbmUgcGFydCBvZiBEYXRlIG9iamVjdHMuICovXG5jb25zdCBMT0NBTF9TSU5HTEVfVElNRVVOSVRfSU5ERVg6IEZsYWc8TG9jYWxTaW5nbGVUaW1lVW5pdD4gPSB7XG4gIHllYXI6IDEsXG4gIHF1YXJ0ZXI6IDEsXG4gIG1vbnRoOiAxLFxuICBkYXk6IDEsXG4gIGRhdGU6IDEsXG4gIGhvdXJzOiAxLFxuICBtaW51dGVzOiAxLFxuICBzZWNvbmRzOiAxLFxuICBtaWxsaXNlY29uZHM6IDFcbn07XG5cbmV4cG9ydCBjb25zdCBUSU1FVU5JVF9QQVJUUyA9IGZsYWdLZXlzKExPQ0FMX1NJTkdMRV9USU1FVU5JVF9JTkRFWCk7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0xvY2FsU2luZ2xlVGltZVVuaXQodGltZVVuaXQ6IHN0cmluZyk6IHRpbWVVbml0IGlzIExvY2FsU2luZ2xlVGltZVVuaXQge1xuICByZXR1cm4gISFMT0NBTF9TSU5HTEVfVElNRVVOSVRfSU5ERVhbdGltZVVuaXRdO1xufVxuXG5leHBvcnQgdHlwZSBVdGNTaW5nbGVUaW1lVW5pdCA9XG4gIHR5cGVvZiBUaW1lVW5pdC5VVENZRUFSIHxcbiAgdHlwZW9mIFRpbWVVbml0LlVUQ1FVQVJURVIgfFxuICB0eXBlb2YgVGltZVVuaXQuVVRDTU9OVEggfFxuICB0eXBlb2YgVGltZVVuaXQuVVRDREFZIHxcbiAgdHlwZW9mIFRpbWVVbml0LlVUQ0RBVEUgfFxuICB0eXBlb2YgVGltZVVuaXQuVVRDSE9VUlMgfFxuICB0eXBlb2YgVGltZVVuaXQuVVRDTUlOVVRFUyB8XG4gIHR5cGVvZiBUaW1lVW5pdC5VVENTRUNPTkRTIHxcbiAgdHlwZW9mIFRpbWVVbml0LlVUQ01JTExJU0VDT05EUztcblxuY29uc3QgVVRDX1NJTkdMRV9USU1FVU5JVF9JTkRFWDogRmxhZzxVdGNTaW5nbGVUaW1lVW5pdD4gPSB7XG4gIHV0Y3llYXI6IDEsXG4gIHV0Y3F1YXJ0ZXI6IDEsXG4gIHV0Y21vbnRoOiAxLFxuICB1dGNkYXk6IDEsXG4gIHV0Y2RhdGU6IDEsXG4gIHV0Y2hvdXJzOiAxLFxuICB1dGNtaW51dGVzOiAxLFxuICB1dGNzZWNvbmRzOiAxLFxuICB1dGNtaWxsaXNlY29uZHM6IDFcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1V0Y1NpbmdsZVRpbWVVbml0KHRpbWVVbml0OiBzdHJpbmcpOiB0aW1lVW5pdCBpcyBVdGNTaW5nbGVUaW1lVW5pdCB7XG4gIHJldHVybiAhIVVUQ19TSU5HTEVfVElNRVVOSVRfSU5ERVhbdGltZVVuaXRdO1xufVxuXG5leHBvcnQgdHlwZSBTaW5nbGVUaW1lVW5pdCA9IExvY2FsU2luZ2xlVGltZVVuaXQgfCBVdGNTaW5nbGVUaW1lVW5pdDtcblxuZXhwb3J0IHR5cGUgTG9jYWxNdWx0aVRpbWVVbml0ID1cbiAgLy8gTG9jYWwgVGltZVxuICB0eXBlb2YgVGltZVVuaXQuWUVBUlFVQVJURVIgfCB0eXBlb2YgVGltZVVuaXQuWUVBUlFVQVJURVJNT05USCB8XG4gIHR5cGVvZiBUaW1lVW5pdC5ZRUFSTU9OVEggfCB0eXBlb2YgVGltZVVuaXQuWUVBUk1PTlRIREFURSB8IHR5cGVvZiBUaW1lVW5pdC5ZRUFSTU9OVEhEQVRFSE9VUlMgfCB0eXBlb2YgVGltZVVuaXQuWUVBUk1PTlRIREFURUhPVVJTTUlOVVRFU3wgdHlwZW9mIFRpbWVVbml0LllFQVJNT05USERBVEVIT1VSU01JTlVURVNTRUNPTkRTIHxcbiAgdHlwZW9mIFRpbWVVbml0LlFVQVJURVJNT05USCB8XG4gIHR5cGVvZiBUaW1lVW5pdC5NT05USERBVEUgfFxuICB0eXBlb2YgVGltZVVuaXQuSE9VUlNNSU5VVEVTIHwgdHlwZW9mIFRpbWVVbml0LkhPVVJTTUlOVVRFU1NFQ09ORFMgfFxuICB0eXBlb2YgVGltZVVuaXQuTUlOVVRFU1NFQ09ORFMgfFxuICB0eXBlb2YgVGltZVVuaXQuU0VDT05EU01JTExJU0VDT05EUztcblxuY29uc3QgTE9DQUxfTVVMVElfVElNRVVOSVRfSU5ERVg6IEZsYWc8TG9jYWxNdWx0aVRpbWVVbml0PiA9IHtcbiAgeWVhcnF1YXJ0ZXI6IDEsXG4gIHllYXJxdWFydGVybW9udGg6IDEsXG5cbiAgeWVhcm1vbnRoOiAxLFxuICB5ZWFybW9udGhkYXRlOiAxLFxuICB5ZWFybW9udGhkYXRlaG91cnM6IDEsXG4gIHllYXJtb250aGRhdGVob3Vyc21pbnV0ZXM6IDEsXG4gIHllYXJtb250aGRhdGVob3Vyc21pbnV0ZXNzZWNvbmRzOiAxLFxuXG4gIHF1YXJ0ZXJtb250aDogMSxcblxuICBtb250aGRhdGU6IDEsXG5cbiAgaG91cnNtaW51dGVzOiAxLFxuICBob3Vyc21pbnV0ZXNzZWNvbmRzOiAxLFxuXG4gIG1pbnV0ZXNzZWNvbmRzOiAxLFxuXG4gIHNlY29uZHNtaWxsaXNlY29uZHM6IDFcbn07XG5cbmV4cG9ydCB0eXBlIFV0Y011bHRpVGltZVVuaXQgPVxuICB0eXBlb2YgVGltZVVuaXQuVVRDWUVBUlFVQVJURVIgfCB0eXBlb2YgVGltZVVuaXQuVVRDWUVBUlFVQVJURVJNT05USCB8XG4gIHR5cGVvZiBUaW1lVW5pdC5VVENZRUFSTU9OVEggfCB0eXBlb2YgVGltZVVuaXQuVVRDWUVBUk1PTlRIREFURSB8IHR5cGVvZiBUaW1lVW5pdC5VVENZRUFSTU9OVEhEQVRFSE9VUlMgfCB0eXBlb2YgVGltZVVuaXQuVVRDWUVBUk1PTlRIREFURUhPVVJTTUlOVVRFU3wgdHlwZW9mIFRpbWVVbml0LlVUQ1lFQVJNT05USERBVEVIT1VSU01JTlVURVNTRUNPTkRTIHxcbiAgdHlwZW9mIFRpbWVVbml0LlVUQ1FVQVJURVJNT05USCB8XG4gIHR5cGVvZiBUaW1lVW5pdC5VVENNT05USERBVEUgfFxuICB0eXBlb2YgVGltZVVuaXQuVVRDSE9VUlNNSU5VVEVTIHwgdHlwZW9mIFRpbWVVbml0LlVUQ0hPVVJTTUlOVVRFU1NFQ09ORFMgfFxuICB0eXBlb2YgVGltZVVuaXQuVVRDTUlOVVRFU1NFQ09ORFMgfFxuICB0eXBlb2YgVGltZVVuaXQuVVRDU0VDT05EU01JTExJU0VDT05EUztcblxuY29uc3QgVVRDX01VTFRJX1RJTUVVTklUX0lOREVYOiBGbGFnPFV0Y011bHRpVGltZVVuaXQ+ID0ge1xuICB1dGN5ZWFycXVhcnRlcjogMSxcbiAgdXRjeWVhcnF1YXJ0ZXJtb250aDogMSxcblxuICB1dGN5ZWFybW9udGg6IDEsXG4gIHV0Y3llYXJtb250aGRhdGU6IDEsXG4gIHV0Y3llYXJtb250aGRhdGVob3VyczogMSxcbiAgdXRjeWVhcm1vbnRoZGF0ZWhvdXJzbWludXRlczogMSxcbiAgdXRjeWVhcm1vbnRoZGF0ZWhvdXJzbWludXRlc3NlY29uZHM6IDEsXG5cbiAgdXRjcXVhcnRlcm1vbnRoOiAxLFxuXG4gIHV0Y21vbnRoZGF0ZTogMSxcblxuICB1dGNob3Vyc21pbnV0ZXM6IDEsXG4gIHV0Y2hvdXJzbWludXRlc3NlY29uZHM6IDEsXG5cbiAgdXRjbWludXRlc3NlY29uZHM6IDEsXG5cbiAgdXRjc2Vjb25kc21pbGxpc2Vjb25kczogMVxufTtcblxuZXhwb3J0IHR5cGUgTXVsdGlUaW1lVW5pdCA9IExvY2FsTXVsdGlUaW1lVW5pdCB8IFV0Y011bHRpVGltZVVuaXQ7XG5cblxuZXhwb3J0IHR5cGUgTG9jYWxUaW1lVW5pdCA9IExvY2FsU2luZ2xlVGltZVVuaXQgfCBMb2NhbE11bHRpVGltZVVuaXQ7XG5leHBvcnQgdHlwZSBVdGNUaW1lVW5pdCA9IFV0Y1NpbmdsZVRpbWVVbml0IHwgVXRjTXVsdGlUaW1lVW5pdDtcblxuY29uc3QgVVRDX1RJTUVVTklUX0lOREVYOiBGbGFnPFV0Y1RpbWVVbml0PiA9IHtcbiAgLi4uVVRDX1NJTkdMRV9USU1FVU5JVF9JTkRFWCxcbiAgLi4uVVRDX01VTFRJX1RJTUVVTklUX0lOREVYXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gaXNVVENUaW1lVW5pdCh0OiBzdHJpbmcpOiB0IGlzIFV0Y1RpbWVVbml0IHtcbiAgcmV0dXJuICEhVVRDX1RJTUVVTklUX0lOREVYW3RdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TG9jYWxUaW1lVW5pdCh0OiBVdGNUaW1lVW5pdCk6IExvY2FsVGltZVVuaXQge1xuICByZXR1cm4gdC5zdWJzdHIoMykgYXMgTG9jYWxUaW1lVW5pdDtcbn1cblxuZXhwb3J0IHR5cGUgVGltZVVuaXQgPSBTaW5nbGVUaW1lVW5pdCB8IE11bHRpVGltZVVuaXQ7XG5cbmNvbnN0IFRJTUVVTklUX0lOREVYOiBGbGFnPFRpbWVVbml0PiA9IHtcbiAgLi4uTE9DQUxfU0lOR0xFX1RJTUVVTklUX0lOREVYLFxuICAuLi5VVENfU0lOR0xFX1RJTUVVTklUX0lOREVYLFxuICAuLi5MT0NBTF9NVUxUSV9USU1FVU5JVF9JTkRFWCxcbiAgLi4uVVRDX01VTFRJX1RJTUVVTklUX0lOREVYXG59O1xuXG5leHBvcnQgY29uc3QgVElNRVVOSVRTID0gZmxhZ0tleXMoVElNRVVOSVRfSU5ERVgpO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNUaW1lVW5pdCh0OiBzdHJpbmcpOiB0IGlzIFRpbWVVbml0IHtcbiAgcmV0dXJuICEhVElNRVVOSVRfSU5ERVhbdF07XG59XG5cbnR5cGUgRGF0ZU1ldGhvZE5hbWUgPSBrZXlvZiBEYXRlO1xuXG5jb25zdCBTRVRfREFURV9NRVRIT0Q6IFJlY29yZDxMb2NhbFNpbmdsZVRpbWVVbml0LCBEYXRlTWV0aG9kTmFtZT4gPSB7XG4gIHllYXI6ICdzZXRGdWxsWWVhcicsXG4gIG1vbnRoOiAnc2V0TW9udGgnLFxuICBkYXRlOiAnc2V0RGF0ZScsXG4gIGhvdXJzOiAnc2V0SG91cnMnLFxuICBtaW51dGVzOiAnc2V0TWludXRlcycsXG4gIHNlY29uZHM6ICdzZXRTZWNvbmRzJyxcbiAgbWlsbGlzZWNvbmRzOiAnc2V0TWlsbGlzZWNvbmRzJyxcbiAgLy8gRGF5IGFuZCBxdWFydGVyIGhhdmUgdGhlaXIgb3duIHNwZWNpYWwgY2FzZXNcbiAgcXVhcnRlcjogbnVsbCxcbiAgZGF5OiBudWxsLFxufTtcblxuLyoqXG4gKiBDb252ZXJ0cyBhIGRhdGUgdG8gb25seSBoYXZlIHRoZSBtZWFzdXJlbWVudHMgcmVsZXZhbnQgdG8gdGhlIHNwZWNpZmllZCB1bml0XG4gKiBpLmUuICgneWVhcm1vbnRoJywgJzIwMDAtMTItMDQgMDc6NTg6MTQnKSAtPiAnMjAwMC0xMi0wMSAwMDowMDowMCdcbiAqIE5vdGU6IHRoZSBiYXNlIGRhdGUgaXMgSmFuIDAxIDE5MDAgMDA6MDA6MDBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnQodW5pdDogVGltZVVuaXQsIGRhdGU6IERhdGUpOiBEYXRlIHtcbiAgY29uc3QgaXNVVEMgPSBpc1VUQ1RpbWVVbml0KHVuaXQpO1xuICBjb25zdCByZXN1bHQ6IERhdGUgPSBpc1VUQyA/XG4gICAgLy8gc3RhcnQgd2l0aCB1bmlmb3JtIGRhdGVcbiAgICBuZXcgRGF0ZShEYXRlLlVUQygwLCAwLCAxLCAwLCAwLCAwLCAwKSkgOlxuICAgIG5ldyBEYXRlKDAsIDAsIDEsIDAsIDAsIDAsIDApO1xuICAgIGZvciAoY29uc3QgdGltZVVuaXRQYXJ0IG9mIFRJTUVVTklUX1BBUlRTKSB7XG4gICAgaWYgKGNvbnRhaW5zVGltZVVuaXQodW5pdCwgdGltZVVuaXRQYXJ0KSkge1xuICAgICAgc3dpdGNoICh0aW1lVW5pdFBhcnQpIHtcbiAgICAgICAgY2FzZSBUaW1lVW5pdC5EQVk6XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgY29udmVydCB0byBUaW1lVW5pdHMgY29udGFpbmluZyBcXCdkYXlcXCcnKTtcbiAgICAgICAgY2FzZSBUaW1lVW5pdC5RVUFSVEVSOiB7XG4gICAgICAgICAgY29uc3Qge2dldERhdGVNZXRob2QsIHNldERhdGVNZXRob2R9ID0gZGF0ZU1ldGhvZHMoJ21vbnRoJywgaXNVVEMpO1xuICAgICAgICAgIC8vIGluZGljYXRlIHF1YXJ0ZXIgYnkgc2V0dGluZyBtb250aCB0byBiZSB0aGUgZmlyc3Qgb2YgdGhlIHF1YXJ0ZXIgaS5lLiBtYXkgKDQpIC0+IGFwcmlsICgzKVxuICAgICAgICAgIHJlc3VsdFtzZXREYXRlTWV0aG9kXSgoTWF0aC5mbG9vcihkYXRlW2dldERhdGVNZXRob2RdKCkgLyAzKSkgKiAzKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGNvbnN0IHtnZXREYXRlTWV0aG9kLCBzZXREYXRlTWV0aG9kfSA9IGRhdGVNZXRob2RzKHRpbWVVbml0UGFydCwgaXNVVEMpO1xuICAgICAgICAgIHJlc3VsdFtzZXREYXRlTWV0aG9kXShkYXRlW2dldERhdGVNZXRob2RdKCkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBkYXRlTWV0aG9kcyhzaW5nbGVVbml0OiBTaW5nbGVUaW1lVW5pdCwgaXNVdGM6IGJvb2xlYW4pIHtcbiAgY29uc3QgcmF3U2V0RGF0ZU1ldGhvZCA9IFNFVF9EQVRFX01FVEhPRFtzaW5nbGVVbml0XTtcbiAgY29uc3Qgc2V0RGF0ZU1ldGhvZCA9IGlzVXRjID8gJ3NldFVUQycgKyByYXdTZXREYXRlTWV0aG9kLnN1YnN0cigzKSA6IHJhd1NldERhdGVNZXRob2Q7XG4gIGNvbnN0IGdldERhdGVNZXRob2QgPSAnZ2V0JyArIChpc1V0YyA/ICdVVEMnIDogJycpICsgcmF3U2V0RGF0ZU1ldGhvZC5zdWJzdHIoMyk7XG4gIHJldHVybiB7c2V0RGF0ZU1ldGhvZCwgZ2V0RGF0ZU1ldGhvZH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUaW1lVW5pdFBhcnRzKHRpbWVVbml0OiBUaW1lVW5pdCkge1xuICByZXR1cm4gVElNRVVOSVRfUEFSVFMucmVkdWNlKChwYXJ0cywgcGFydCkgPT4ge1xuICAgIGlmIChjb250YWluc1RpbWVVbml0KHRpbWVVbml0LCBwYXJ0KSkge1xuICAgICAgcmV0dXJuIHBhcnRzLmNvbmNhdChwYXJ0KTtcbiAgICB9XG4gICAgcmV0dXJuIHBhcnRzO1xuICB9LCBbXSk7XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgZnVsbFRpbWVVbml0IGNvbnRhaW5zIHRoZSB0aW1lVW5pdCwgZmFsc2Ugb3RoZXJ3aXNlLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbnRhaW5zVGltZVVuaXQoZnVsbFRpbWVVbml0OiBUaW1lVW5pdCwgdGltZVVuaXQ6IFRpbWVVbml0KSB7XG4gIGNvbnN0IGluZGV4ID0gZnVsbFRpbWVVbml0LmluZGV4T2YodGltZVVuaXQpO1xuICByZXR1cm4gaW5kZXggPiAtMSAmJlxuICAgIChcbiAgICAgIHRpbWVVbml0ICE9PSBUaW1lVW5pdC5TRUNPTkRTIHx8XG4gICAgICBpbmRleCA9PT0gMCB8fFxuICAgICAgZnVsbFRpbWVVbml0LmNoYXJBdChpbmRleC0xKSAhPT0gJ2knIC8vIGV4Y2x1ZGUgbWlsbGlzZWNvbmRzXG4gICAgKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIFZlZ2EgZXhwcmVzc3Npb24gZm9yIGEgZ2l2ZW4gdGltZVVuaXQgYW5kIGZpZWxkUmVmXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmaWVsZEV4cHIoZnVsbFRpbWVVbml0OiBUaW1lVW5pdCwgZmllbGQ6IHN0cmluZyk6IHN0cmluZyB7XG4gIGNvbnN0IGZpZWxkUmVmID0gYWNjZXNzUGF0aFdpdGhEYXR1bShmaWVsZCk7XG5cbiAgY29uc3QgdXRjID0gaXNVVENUaW1lVW5pdChmdWxsVGltZVVuaXQpID8gJ3V0YycgOiAnJztcbiAgZnVuY3Rpb24gZnVuYyh0aW1lVW5pdDogVGltZVVuaXQpIHtcbiAgICBpZiAodGltZVVuaXQgPT09IFRpbWVVbml0LlFVQVJURVIpIHtcbiAgICAgIC8vIHF1YXJ0ZXIgc3RhcnRpbmcgYXQgMCAoMCwzLDYsOSkuXG4gICAgICByZXR1cm4gYCgke3V0Y31xdWFydGVyKCR7ZmllbGRSZWZ9KS0xKWA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBgJHt1dGN9JHt0aW1lVW5pdH0oJHtmaWVsZFJlZn0pYDtcbiAgICB9XG4gIH1cblxuICBjb25zdCBkID0gVElNRVVOSVRfUEFSVFMucmVkdWNlKChkYXRlRXhwcjogRGF0ZVRpbWVFeHByLCB0dTogVGltZVVuaXQpID0+IHtcbiAgICBpZiAoY29udGFpbnNUaW1lVW5pdChmdWxsVGltZVVuaXQsIHR1KSkge1xuICAgICAgZGF0ZUV4cHJbdHVdID0gZnVuYyh0dSk7XG4gICAgfVxuICAgIHJldHVybiBkYXRlRXhwcjtcbiAgfSwge30gYXMge1trZXkgaW4gU2luZ2xlVGltZVVuaXRdOiBzdHJpbmd9KTtcblxuICByZXR1cm4gZGF0ZVRpbWVFeHByKGQpO1xufVxuXG4vKipcbiAqIHJldHVybnMgdGhlIHNpZ25hbCBleHByZXNzaW9uIHVzZWQgZm9yIGF4aXMgbGFiZWxzIGZvciBhIHRpbWUgdW5pdFxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0RXhwcmVzc2lvbih0aW1lVW5pdDogVGltZVVuaXQsIGZpZWxkOiBzdHJpbmcsIHNob3J0VGltZUxhYmVsczogYm9vbGVhbiwgaXNVVENTY2FsZTogYm9vbGVhbik6IHN0cmluZyB7XG4gIGlmICghdGltZVVuaXQpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgY29uc3QgZGF0ZUNvbXBvbmVudHM6IHN0cmluZ1tdID0gW107XG4gIGxldCBleHByZXNzaW9uID0gJyc7XG4gIGNvbnN0IGhhc1llYXIgPSBjb250YWluc1RpbWVVbml0KHRpbWVVbml0LCBUaW1lVW5pdC5ZRUFSKTtcblxuICBpZiAoY29udGFpbnNUaW1lVW5pdCh0aW1lVW5pdCwgVGltZVVuaXQuUVVBUlRFUikpIHtcbiAgIC8vIHNwZWNpYWwgZXhwcmVzc2lvbiBmb3IgcXVhcnRlciBhcyBwcmVmaXhcbiAgICBleHByZXNzaW9uID0gYCdRJyArIHF1YXJ0ZXIoJHtmaWVsZH0pYDtcbiAgfVxuXG4gIGlmIChjb250YWluc1RpbWVVbml0KHRpbWVVbml0LCBUaW1lVW5pdC5NT05USCkpIHtcbiAgICAvLyBCeSBkZWZhdWx0IHVzZSBzaG9ydCBtb250aCBuYW1lXG4gICAgZGF0ZUNvbXBvbmVudHMucHVzaChzaG9ydFRpbWVMYWJlbHMgIT09IGZhbHNlID8gJyViJyA6ICclQicpO1xuICB9XG5cbiAgaWYgKGNvbnRhaW5zVGltZVVuaXQodGltZVVuaXQsIFRpbWVVbml0LkRBWSkpIHtcbiAgICBkYXRlQ29tcG9uZW50cy5wdXNoKHNob3J0VGltZUxhYmVscyA/ICclYScgOiAnJUEnKTtcbiAgfSBlbHNlIGlmIChjb250YWluc1RpbWVVbml0KHRpbWVVbml0LCBUaW1lVW5pdC5EQVRFKSkge1xuICAgIGRhdGVDb21wb25lbnRzLnB1c2goJyVkJyArIChoYXNZZWFyID8gJywnIDogJycpKTsgLy8gYWRkIGNvbW1hIGlmIHRoZXJlIGlzIHllYXJcbiAgfVxuXG4gIGlmIChoYXNZZWFyKSB7XG4gICAgZGF0ZUNvbXBvbmVudHMucHVzaChzaG9ydFRpbWVMYWJlbHMgPyAnJXknIDogJyVZJyk7XG4gIH1cblxuICBjb25zdCB0aW1lQ29tcG9uZW50czogc3RyaW5nW10gPSBbXTtcblxuICBpZiAoY29udGFpbnNUaW1lVW5pdCh0aW1lVW5pdCwgVGltZVVuaXQuSE9VUlMpKSB7XG4gICAgdGltZUNvbXBvbmVudHMucHVzaCgnJUgnKTtcbiAgfVxuICBpZiAoY29udGFpbnNUaW1lVW5pdCh0aW1lVW5pdCwgVGltZVVuaXQuTUlOVVRFUykpIHtcbiAgICB0aW1lQ29tcG9uZW50cy5wdXNoKCclTScpO1xuICB9XG4gIGlmIChjb250YWluc1RpbWVVbml0KHRpbWVVbml0LCBUaW1lVW5pdC5TRUNPTkRTKSkge1xuICAgIHRpbWVDb21wb25lbnRzLnB1c2goJyVTJyk7XG4gIH1cbiAgaWYgKGNvbnRhaW5zVGltZVVuaXQodGltZVVuaXQsIFRpbWVVbml0Lk1JTExJU0VDT05EUykpIHtcbiAgICB0aW1lQ29tcG9uZW50cy5wdXNoKCclTCcpO1xuICB9XG5cbiAgY29uc3QgZGF0ZVRpbWVDb21wb25lbnRzOiBzdHJpbmdbXSA9IFtdO1xuICBpZiAoZGF0ZUNvbXBvbmVudHMubGVuZ3RoID4gMCkge1xuICAgIGRhdGVUaW1lQ29tcG9uZW50cy5wdXNoKGRhdGVDb21wb25lbnRzLmpvaW4oJyAnKSk7XG4gIH1cbiAgaWYgKHRpbWVDb21wb25lbnRzLmxlbmd0aCA+IDApIHtcbiAgICBkYXRlVGltZUNvbXBvbmVudHMucHVzaCh0aW1lQ29tcG9uZW50cy5qb2luKCc6JykpO1xuICB9XG5cbiAgaWYgKGRhdGVUaW1lQ29tcG9uZW50cy5sZW5ndGggPiAwKSB7XG4gICAgaWYgKGV4cHJlc3Npb24pIHtcbiAgICAgIC8vIEFkZCBzcGFjZSBiZXR3ZWVuIHF1YXJ0ZXIgYW5kIG1haW4gdGltZSBmb3JtYXRcbiAgICAgIGV4cHJlc3Npb24gKz0gYCArICcgJyArIGA7XG4gICAgfVxuXG4gICAgLy8gV2Ugb25seSB1c2UgdXRjRm9ybWF0IGZvciB1dGMgc2NhbGVcbiAgICAvLyBGb3IgdXRjIHRpbWUgdW5pdHMsIHRoZSBkYXRhIGlzIGFscmVhZHkgY29udmVydGVkIGFzIGEgcGFydCBvZiB0aW1lVW5pdCB0cmFuc2Zvcm0uXG4gICAgLy8gVGh1cywgdXRjIHRpbWUgdW5pdHMgc2hvdWxkIHVzZSB0aW1lRm9ybWF0IHRvIGF2b2lkIHNoaWZ0aW5nIHRoZSB0aW1lIHR3aWNlLlxuICAgIGlmIChpc1VUQ1NjYWxlKSB7XG4gICAgICBleHByZXNzaW9uICs9IGB1dGNGb3JtYXQoJHtmaWVsZH0sICcke2RhdGVUaW1lQ29tcG9uZW50cy5qb2luKCcgJyl9JylgO1xuICAgIH0gZWxzZSB7XG4gICAgICBleHByZXNzaW9uICs9IGB0aW1lRm9ybWF0KCR7ZmllbGR9LCAnJHtkYXRlVGltZUNvbXBvbmVudHMuam9pbignICcpfScpYDtcbiAgICB9XG4gIH1cblxuICAvLyBJZiBleHByZXNzaW9uIGlzIHN0aWxsIGFuIGVtcHR5IHN0cmluZywgcmV0dXJuIHVuZGVmaW5lZCBpbnN0ZWFkLlxuICByZXR1cm4gZXhwcmVzc2lvbiB8fCB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVUaW1lVW5pdCh0aW1lVW5pdDogVGltZVVuaXQpOiBUaW1lVW5pdCB7XG4gIGlmICh0aW1lVW5pdCAhPT0gJ2RheScgJiYgdGltZVVuaXQuaW5kZXhPZignZGF5JykgPj0gMCkge1xuICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLmRheVJlcGxhY2VkV2l0aERhdGUodGltZVVuaXQpKTtcbiAgICByZXR1cm4gdGltZVVuaXQucmVwbGFjZSgnZGF5JywgJ2RhdGUnKSBhcyBUaW1lVW5pdDtcbiAgfVxuICByZXR1cm4gdGltZVVuaXQ7XG59XG4iXX0=","/** Constants and utilities for data type */\n/** Data type based on level of measurement */\nexport var Type;\n(function (Type) {\n    Type.QUANTITATIVE = 'quantitative';\n    Type.ORDINAL = 'ordinal';\n    Type.TEMPORAL = 'temporal';\n    Type.NOMINAL = 'nominal';\n    Type.LATITUDE = 'latitude';\n    Type.LONGITUDE = 'longitude';\n    Type.GEOJSON = 'geojson';\n})(Type || (Type = {}));\nexport var TYPE_INDEX = {\n    quantitative: 1,\n    ordinal: 1,\n    temporal: 1,\n    nominal: 1,\n    latitude: 1,\n    longitude: 1,\n    geojson: 1\n};\nexport function isType(t) {\n    return !!TYPE_INDEX[t];\n}\nexport var QUANTITATIVE = Type.QUANTITATIVE;\nexport var ORDINAL = Type.ORDINAL;\nexport var TEMPORAL = Type.TEMPORAL;\nexport var NOMINAL = Type.NOMINAL;\nexport var GEOJSON = Type.GEOJSON;\n/**\n * Get full, lowercase type name for a given type.\n * @param  type\n * @return Full type name.\n */\nexport function getFullName(type) {\n    if (type) {\n        type = type.toLowerCase();\n        switch (type) {\n            case 'q':\n            case QUANTITATIVE:\n                return 'quantitative';\n            case 't':\n            case TEMPORAL:\n                return 'temporal';\n            case 'o':\n            case ORDINAL:\n                return 'ordinal';\n            case 'n':\n            case NOMINAL:\n                return 'nominal';\n            case Type.LATITUDE:\n                return 'latitude';\n            case Type.LONGITUDE:\n                return 'longitude';\n            case GEOJSON:\n                return 'geojson';\n        }\n    }\n    // If we get invalid input, return undefined type.\n    return undefined;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90eXBlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLDRDQUE0QztBQUM1Qyw4Q0FBOEM7QUFFOUMsTUFBTSxLQUFXLElBQUksQ0FTcEI7QUFURCxXQUFpQixJQUFJO0lBQ04saUJBQVksR0FBbUIsY0FBYyxDQUFDO0lBQzlDLFlBQU8sR0FBYyxTQUFTLENBQUM7SUFDL0IsYUFBUSxHQUFlLFVBQVUsQ0FBQztJQUNsQyxZQUFPLEdBQWMsU0FBUyxDQUFDO0lBRS9CLGFBQVEsR0FBZSxVQUFVLENBQUM7SUFDbEMsY0FBUyxHQUFnQixXQUFXLENBQUM7SUFDckMsWUFBTyxHQUFjLFNBQVMsQ0FBQztBQUM5QyxDQUFDLEVBVGdCLElBQUksS0FBSixJQUFJLFFBU3BCO0FBTUQsTUFBTSxDQUFDLElBQU0sVUFBVSxHQUFlO0lBQ3BDLFlBQVksRUFBRSxDQUFDO0lBQ2YsT0FBTyxFQUFFLENBQUM7SUFDVixRQUFRLEVBQUUsQ0FBQztJQUNYLE9BQU8sRUFBRSxDQUFDO0lBQ1YsUUFBUSxFQUFFLENBQUM7SUFDWCxTQUFTLEVBQUUsQ0FBQztJQUNaLE9BQU8sRUFBRSxDQUFDO0NBQ1gsQ0FBQztBQUVGLE1BQU0saUJBQWlCLENBQU07SUFDM0IsT0FBTyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3pCLENBQUM7QUFFRCxNQUFNLENBQUMsSUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQztBQUM5QyxNQUFNLENBQUMsSUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztBQUNwQyxNQUFNLENBQUMsSUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQztBQUN0QyxNQUFNLENBQUMsSUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztBQUVwQyxNQUFNLENBQUMsSUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQztBQUVwQzs7OztHQUlHO0FBQ0gsTUFBTSxzQkFBc0IsSUFBaUI7SUFDM0MsSUFBSSxJQUFJLEVBQUU7UUFDUixJQUFJLEdBQUcsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQzFCLFFBQVEsSUFBSSxFQUFFO1lBQ1osS0FBSyxHQUFHLENBQUM7WUFDVCxLQUFLLFlBQVk7Z0JBQ2YsT0FBTyxjQUFjLENBQUM7WUFDeEIsS0FBSyxHQUFHLENBQUM7WUFDVCxLQUFLLFFBQVE7Z0JBQ1gsT0FBTyxVQUFVLENBQUM7WUFDcEIsS0FBSyxHQUFHLENBQUM7WUFDVCxLQUFLLE9BQU87Z0JBQ1YsT0FBTyxTQUFTLENBQUM7WUFDbkIsS0FBSyxHQUFHLENBQUM7WUFDVCxLQUFLLE9BQU87Z0JBQ1YsT0FBTyxTQUFTLENBQUM7WUFDbkIsS0FBSyxJQUFJLENBQUMsUUFBUTtnQkFDaEIsT0FBTyxVQUFVLENBQUM7WUFDcEIsS0FBSyxJQUFJLENBQUMsU0FBUztnQkFDakIsT0FBTyxXQUFXLENBQUM7WUFDckIsS0FBSyxPQUFPO2dCQUNWLE9BQU8sU0FBUyxDQUFDO1NBQ3BCO0tBQ0Y7SUFDRCxrREFBa0Q7SUFDbEQsT0FBTyxTQUFTLENBQUM7QUFDbkIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7RmxhZ30gZnJvbSAnLi91dGlsJztcbi8qKiBDb25zdGFudHMgYW5kIHV0aWxpdGllcyBmb3IgZGF0YSB0eXBlICovXG4vKiogRGF0YSB0eXBlIGJhc2VkIG9uIGxldmVsIG9mIG1lYXN1cmVtZW50ICovXG5cbmV4cG9ydCBuYW1lc3BhY2UgVHlwZSB7XG4gIGV4cG9ydCBjb25zdCBRVUFOVElUQVRJVkU6ICdxdWFudGl0YXRpdmUnID0gJ3F1YW50aXRhdGl2ZSc7XG4gIGV4cG9ydCBjb25zdCBPUkRJTkFMOiAnb3JkaW5hbCcgPSAnb3JkaW5hbCc7XG4gIGV4cG9ydCBjb25zdCBURU1QT1JBTDogJ3RlbXBvcmFsJyA9ICd0ZW1wb3JhbCc7XG4gIGV4cG9ydCBjb25zdCBOT01JTkFMOiAnbm9taW5hbCcgPSAnbm9taW5hbCc7XG5cbiAgZXhwb3J0IGNvbnN0IExBVElUVURFOiAnbGF0aXR1ZGUnID0gJ2xhdGl0dWRlJztcbiAgZXhwb3J0IGNvbnN0IExPTkdJVFVERTogJ2xvbmdpdHVkZScgPSAnbG9uZ2l0dWRlJztcbiAgZXhwb3J0IGNvbnN0IEdFT0pTT046ICdnZW9qc29uJyA9ICdnZW9qc29uJztcbn1cbmV4cG9ydCB0eXBlIEJhc2ljVHlwZSA9IHR5cGVvZiBUeXBlLlFVQU5USVRBVElWRSB8IHR5cGVvZiBUeXBlLk9SRElOQUwgfCB0eXBlb2YgVHlwZS5URU1QT1JBTCB8IHR5cGVvZiBUeXBlLk5PTUlOQUw7XG5leHBvcnQgdHlwZSBHZW9UeXBlID0gdHlwZW9mIFR5cGUuTEFUSVRVREUgfCB0eXBlb2YgVHlwZS5MT05HSVRVREUgfCB0eXBlb2YgVHlwZS5HRU9KU09OO1xuXG5leHBvcnQgdHlwZSBUeXBlID0gQmFzaWNUeXBlIHwgR2VvVHlwZTtcblxuZXhwb3J0IGNvbnN0IFRZUEVfSU5ERVg6IEZsYWc8VHlwZT4gPSB7XG4gIHF1YW50aXRhdGl2ZTogMSxcbiAgb3JkaW5hbDogMSxcbiAgdGVtcG9yYWw6IDEsXG4gIG5vbWluYWw6IDEsXG4gIGxhdGl0dWRlOiAxLFxuICBsb25naXR1ZGU6IDEsXG4gIGdlb2pzb246IDFcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1R5cGUodDogYW55KTogdCBpcyBUeXBlIHtcbiAgcmV0dXJuICEhVFlQRV9JTkRFWFt0XTtcbn1cblxuZXhwb3J0IGNvbnN0IFFVQU5USVRBVElWRSA9IFR5cGUuUVVBTlRJVEFUSVZFO1xuZXhwb3J0IGNvbnN0IE9SRElOQUwgPSBUeXBlLk9SRElOQUw7XG5leHBvcnQgY29uc3QgVEVNUE9SQUwgPSBUeXBlLlRFTVBPUkFMO1xuZXhwb3J0IGNvbnN0IE5PTUlOQUwgPSBUeXBlLk5PTUlOQUw7XG5cbmV4cG9ydCBjb25zdCBHRU9KU09OID0gVHlwZS5HRU9KU09OO1xuXG4vKipcbiAqIEdldCBmdWxsLCBsb3dlcmNhc2UgdHlwZSBuYW1lIGZvciBhIGdpdmVuIHR5cGUuXG4gKiBAcGFyYW0gIHR5cGVcbiAqIEByZXR1cm4gRnVsbCB0eXBlIG5hbWUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRGdWxsTmFtZSh0eXBlOiBUeXBlfHN0cmluZyk6IFR5cGUge1xuICBpZiAodHlwZSkge1xuICAgIHR5cGUgPSB0eXBlLnRvTG93ZXJDYXNlKCk7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICBjYXNlICdxJzpcbiAgICAgIGNhc2UgUVVBTlRJVEFUSVZFOlxuICAgICAgICByZXR1cm4gJ3F1YW50aXRhdGl2ZSc7XG4gICAgICBjYXNlICd0JzpcbiAgICAgIGNhc2UgVEVNUE9SQUw6XG4gICAgICAgIHJldHVybiAndGVtcG9yYWwnO1xuICAgICAgY2FzZSAnbyc6XG4gICAgICBjYXNlIE9SRElOQUw6XG4gICAgICAgIHJldHVybiAnb3JkaW5hbCc7XG4gICAgICBjYXNlICduJzpcbiAgICAgIGNhc2UgTk9NSU5BTDpcbiAgICAgICAgcmV0dXJuICdub21pbmFsJztcbiAgICAgIGNhc2UgVHlwZS5MQVRJVFVERTpcbiAgICAgICAgcmV0dXJuICdsYXRpdHVkZSc7XG4gICAgICBjYXNlIFR5cGUuTE9OR0lUVURFOlxuICAgICAgICByZXR1cm4gJ2xvbmdpdHVkZSc7XG4gICAgICBjYXNlIEdFT0pTT046XG4gICAgICAgIHJldHVybiAnZ2VvanNvbic7XG4gICAgfVxuICB9XG4gIC8vIElmIHdlIGdldCBpbnZhbGlkIGlucHV0LCByZXR1cm4gdW5kZWZpbmVkIHR5cGUuXG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { isArray, isBoolean, isNumber, isString } from 'vega-util';\nimport { isAggregateOp, isCountingAggregateOp } from './aggregate';\nimport { autoMaxBins, binToString } from './bin';\nimport { rangeType } from './channel';\nimport * as log from './log';\nimport { getTimeUnitParts, normalizeTimeUnit } from './timeunit';\nimport { getFullName, QUANTITATIVE } from './type';\nimport { flatAccessWithDatum, replacePathInField, titlecase } from './util';\nexport function isConditionalSelection(c) {\n    return c['selection'];\n}\nexport function isRepeatRef(field) {\n    return field && !isString(field) && 'repeat' in field;\n}\nexport function toFieldDefBase(fieldDef) {\n    var field = fieldDef.field, timeUnit = fieldDef.timeUnit, bin = fieldDef.bin, aggregate = fieldDef.aggregate;\n    return tslib_1.__assign({}, (timeUnit ? { timeUnit: timeUnit } : {}), (bin ? { bin: bin } : {}), (aggregate ? { aggregate: aggregate } : {}), { field: field });\n}\nexport function isConditionalDef(channelDef) {\n    return !!channelDef && !!channelDef.condition;\n}\n/**\n * Return if a channelDef is a ConditionalValueDef with ConditionFieldDef\n */\nexport function hasConditionalFieldDef(channelDef) {\n    return !!channelDef && !!channelDef.condition && !isArray(channelDef.condition) && isFieldDef(channelDef.condition);\n}\nexport function hasConditionalValueDef(channelDef) {\n    return !!channelDef && !!channelDef.condition && (isArray(channelDef.condition) || isValueDef(channelDef.condition));\n}\nexport function isFieldDef(channelDef) {\n    return !!channelDef && (!!channelDef['field'] || channelDef['aggregate'] === 'count');\n}\nexport function isStringFieldDef(fieldDef) {\n    return isFieldDef(fieldDef) && isString(fieldDef.field);\n}\nexport function isValueDef(channelDef) {\n    return channelDef && 'value' in channelDef && channelDef['value'] !== undefined;\n}\nexport function isScaleFieldDef(channelDef) {\n    return !!channelDef && (!!channelDef['scale'] || !!channelDef['sort']);\n}\nfunction isOpFieldDef(fieldDef) {\n    return !!fieldDef['op'];\n}\nexport function vgField(fieldDef, opt) {\n    if (opt === void 0) { opt = {}; }\n    var field = fieldDef.field;\n    var prefix = opt.prefix;\n    var suffix = opt.suffix;\n    if (isCount(fieldDef)) {\n        field = 'count_*';\n    }\n    else {\n        var fn = undefined;\n        if (!opt.nofn) {\n            if (isOpFieldDef(fieldDef)) {\n                fn = fieldDef.op;\n            }\n            else if (fieldDef.bin) {\n                fn = binToString(fieldDef.bin);\n                suffix = opt.binSuffix || '';\n            }\n            else if (fieldDef.aggregate) {\n                fn = String(fieldDef.aggregate);\n            }\n            else if (fieldDef.timeUnit) {\n                fn = String(fieldDef.timeUnit);\n            }\n        }\n        if (fn) {\n            field = field ? fn + \"_\" + field : fn;\n        }\n    }\n    if (suffix) {\n        field = field + \"_\" + suffix;\n    }\n    if (prefix) {\n        field = prefix + \"_\" + field;\n    }\n    if (opt.expr) {\n        // Expression to access flattened field. No need to escape dots.\n        return flatAccessWithDatum(field, opt.expr);\n    }\n    else {\n        // We flattened all fields so paths should have become dot.\n        return replacePathInField(field);\n    }\n}\nexport function isDiscrete(fieldDef) {\n    switch (fieldDef.type) {\n        case 'nominal':\n        case 'ordinal':\n        case 'geojson':\n            return true;\n        case 'quantitative':\n            return !!fieldDef.bin;\n        case 'latitude':\n        case 'longitude':\n        case 'temporal':\n            return false;\n    }\n    throw new Error(log.message.invalidFieldType(fieldDef.type));\n}\nexport function isContinuous(fieldDef) {\n    return !isDiscrete(fieldDef);\n}\nexport function isCount(fieldDef) {\n    return fieldDef.aggregate === 'count';\n}\nexport function verbalTitleFormatter(fieldDef, config) {\n    var field = fieldDef.field, bin = fieldDef.bin, timeUnit = fieldDef.timeUnit, aggregate = fieldDef.aggregate;\n    if (aggregate === 'count') {\n        return config.countTitle;\n    }\n    else if (bin) {\n        return field + \" (binned)\";\n    }\n    else if (timeUnit) {\n        var units = getTimeUnitParts(timeUnit).join('-');\n        return field + \" (\" + units + \")\";\n    }\n    else if (aggregate) {\n        return titlecase(aggregate) + \" of \" + field;\n    }\n    return field;\n}\nexport function functionalTitleFormatter(fieldDef, config) {\n    var fn = fieldDef.aggregate || fieldDef.timeUnit || (fieldDef.bin && 'bin');\n    if (fn) {\n        return fn.toUpperCase() + '(' + fieldDef.field + ')';\n    }\n    else {\n        return fieldDef.field;\n    }\n}\nexport var defaultTitleFormatter = function (fieldDef, config) {\n    switch (config.fieldTitle) {\n        case 'plain':\n            return fieldDef.field;\n        case 'functional':\n            return functionalTitleFormatter(fieldDef, config);\n        default:\n            return verbalTitleFormatter(fieldDef, config);\n    }\n};\nvar titleFormatter = defaultTitleFormatter;\nexport function setTitleFormatter(formatter) {\n    titleFormatter = formatter;\n}\nexport function resetTitleFormatter() {\n    setTitleFormatter(defaultTitleFormatter);\n}\nexport function title(fieldDef, config) {\n    return titleFormatter(fieldDef, config);\n}\nexport function defaultType(fieldDef, channel) {\n    if (fieldDef.timeUnit) {\n        return 'temporal';\n    }\n    if (fieldDef.bin) {\n        return 'quantitative';\n    }\n    switch (rangeType(channel)) {\n        case 'continuous':\n            return 'quantitative';\n        case 'discrete':\n            return 'nominal';\n        case 'flexible': // color\n            return 'nominal';\n        default:\n            return 'quantitative';\n    }\n}\n/**\n * Returns the fieldDef -- either from the outer channelDef or from the condition of channelDef.\n * @param channelDef\n */\nexport function getFieldDef(channelDef) {\n    if (isFieldDef(channelDef)) {\n        return channelDef;\n    }\n    else if (hasConditionalFieldDef(channelDef)) {\n        return channelDef.condition;\n    }\n    return undefined;\n}\n/**\n * Convert type to full, lowercase type, or augment the fieldDef with a default type if missing.\n */\nexport function normalize(channelDef, channel) {\n    if (isString(channelDef) || isNumber(channelDef) || isBoolean(channelDef)) {\n        var primitiveType = isString(channelDef) ? 'string' :\n            isNumber(channelDef) ? 'number' : 'boolean';\n        log.warn(log.message.primitiveChannelDef(channel, primitiveType, channelDef));\n        return { value: channelDef };\n    }\n    // If a fieldDef contains a field, we need type.\n    if (isFieldDef(channelDef)) {\n        return normalizeFieldDef(channelDef, channel);\n    }\n    else if (hasConditionalFieldDef(channelDef)) {\n        return tslib_1.__assign({}, channelDef, { \n            // Need to cast as normalizeFieldDef normally return FieldDef, but here we know that it is definitely Condition<FieldDef>\n            condition: normalizeFieldDef(channelDef.condition, channel) });\n    }\n    return channelDef;\n}\nexport function normalizeFieldDef(fieldDef, channel) {\n    // Drop invalid aggregate\n    if (fieldDef.aggregate && !isAggregateOp(fieldDef.aggregate)) {\n        var aggregate = fieldDef.aggregate, fieldDefWithoutAggregate = tslib_1.__rest(fieldDef, [\"aggregate\"]);\n        log.warn(log.message.invalidAggregate(fieldDef.aggregate));\n        fieldDef = fieldDefWithoutAggregate;\n    }\n    // Normalize Time Unit\n    if (fieldDef.timeUnit) {\n        fieldDef = tslib_1.__assign({}, fieldDef, { timeUnit: normalizeTimeUnit(fieldDef.timeUnit) });\n    }\n    // Normalize bin\n    if (fieldDef.bin) {\n        fieldDef = tslib_1.__assign({}, fieldDef, { bin: normalizeBin(fieldDef.bin, channel) });\n    }\n    // Normalize Type\n    if (fieldDef.type) {\n        var fullType = getFullName(fieldDef.type);\n        if (fieldDef.type !== fullType) {\n            // convert short type to full type\n            fieldDef = tslib_1.__assign({}, fieldDef, { type: fullType });\n        }\n        if (fieldDef.type !== 'quantitative') {\n            if (isCountingAggregateOp(fieldDef.aggregate)) {\n                log.warn(log.message.invalidFieldTypeForCountAggregate(fieldDef.type, fieldDef.aggregate));\n                fieldDef = tslib_1.__assign({}, fieldDef, { type: 'quantitative' });\n            }\n        }\n    }\n    else {\n        // If type is empty / invalid, then augment with default type\n        var newType = defaultType(fieldDef, channel);\n        log.warn(log.message.emptyOrInvalidFieldType(fieldDef.type, channel, newType));\n        fieldDef = tslib_1.__assign({}, fieldDef, { type: newType });\n    }\n    var _a = channelCompatibility(fieldDef, channel), compatible = _a.compatible, warning = _a.warning;\n    if (!compatible) {\n        log.warn(warning);\n    }\n    return fieldDef;\n}\nexport function normalizeBin(bin, channel) {\n    if (isBoolean(bin)) {\n        return { maxbins: autoMaxBins(channel) };\n    }\n    else if (!bin.maxbins && !bin.step) {\n        return tslib_1.__assign({}, bin, { maxbins: autoMaxBins(channel) });\n    }\n    else {\n        return bin;\n    }\n}\nvar COMPATIBLE = { compatible: true };\nexport function channelCompatibility(fieldDef, channel) {\n    var type = fieldDef.type;\n    switch (channel) {\n        case 'row':\n        case 'column':\n            if (isContinuous(fieldDef)) {\n                return {\n                    compatible: false,\n                    warning: log.message.facetChannelShouldBeDiscrete(channel)\n                };\n            }\n            return COMPATIBLE;\n        case 'x':\n        case 'y':\n        case 'color':\n        case 'fill':\n        case 'stroke':\n        case 'text':\n        case 'detail':\n        case 'key':\n        case 'tooltip':\n        case 'href':\n            return COMPATIBLE;\n        case 'longitude':\n        case 'longitude2':\n        case 'latitude':\n        case 'latitude2':\n            if (type !== QUANTITATIVE) {\n                return {\n                    compatible: false,\n                    warning: \"Channel \" + channel + \" should be used with a quantitative field only, not \" + fieldDef.type + \" field.\"\n                };\n            }\n            return COMPATIBLE;\n        case 'opacity':\n        case 'size':\n        case 'x2':\n        case 'y2':\n            if ((type === 'nominal' && !fieldDef['sort']) || type === 'geojson') {\n                return {\n                    compatible: false,\n                    warning: \"Channel \" + channel + \" should not be used with an unsorted discrete field.\"\n                };\n            }\n            return COMPATIBLE;\n        case 'shape':\n            if (fieldDef.type !== 'nominal' && fieldDef.type !== 'geojson') {\n                return {\n                    compatible: false,\n                    warning: 'Shape channel should be used with only either nominal or geojson data'\n                };\n            }\n            return COMPATIBLE;\n        case 'order':\n            if (fieldDef.type === 'nominal') {\n                return {\n                    compatible: false,\n                    warning: \"Channel order is inappropriate for nominal field, which has no inherent order.\"\n                };\n            }\n            return COMPATIBLE;\n    }\n    throw new Error('channelCompatability not implemented for channel ' + channel);\n}\nexport function isNumberFieldDef(fieldDef) {\n    return fieldDef.type === 'quantitative' || !!fieldDef.bin;\n}\nexport function isTimeFieldDef(fieldDef) {\n    return fieldDef.type === 'temporal' || !!fieldDef.timeUnit;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmllbGRkZWYuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZmllbGRkZWYudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUVBLE9BQU8sRUFBQyxPQUFPLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDakUsT0FBTyxFQUFDLGFBQWEsRUFBRSxxQkFBcUIsRUFBQyxNQUFNLGFBQWEsQ0FBQztBQUVqRSxPQUFPLEVBQUMsV0FBVyxFQUFhLFdBQVcsRUFBQyxNQUFNLE9BQU8sQ0FBQztBQUMxRCxPQUFPLEVBQVUsU0FBUyxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBSzdDLE9BQU8sS0FBSyxHQUFHLE1BQU0sT0FBTyxDQUFDO0FBTTdCLE9BQU8sRUFBQyxnQkFBZ0IsRUFBRSxpQkFBaUIsRUFBVyxNQUFNLFlBQVksQ0FBQztBQUV6RSxPQUFPLEVBQUMsV0FBVyxFQUFFLFlBQVksRUFBTyxNQUFNLFFBQVEsQ0FBQztBQUN2RCxPQUFPLEVBQUMsbUJBQW1CLEVBQUUsa0JBQWtCLEVBQUUsU0FBUyxFQUFDLE1BQU0sUUFBUSxDQUFDO0FBZ0MxRSxNQUFNLGlDQUFvQyxDQUFpQjtJQUN6RCxPQUFPLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUN4QixDQUFDO0FBbURELE1BQU0sc0JBQXNCLEtBQVk7SUFDdEMsT0FBTyxLQUFLLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLElBQUksUUFBUSxJQUFJLEtBQUssQ0FBQztBQUN4RCxDQUFDO0FBZ0RELE1BQU0seUJBQXlCLFFBQTBCO0lBQ2hELElBQUEsc0JBQUssRUFBRSw0QkFBUSxFQUFFLGtCQUFHLEVBQUUsOEJBQVMsQ0FBYTtJQUNuRCw0QkFDSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBQyxRQUFRLFVBQUEsRUFBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFDNUIsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFD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QUFLLFNBQVMsSUFBSSxRQUFRLENBQUMsSUFBSSxLQUFLLFNBQVMsRUFBRTtnQkFDOUQsT0FBTztvQkFDTCxVQUFVLEVBQUUsS0FBSztvQkFDakIsT0FBTyxFQUFFLHVFQUF1RTtpQkFDakYsQ0FBQzthQUNIO1lBQ0QsT0FBTyxVQUFVLENBQUM7UUFFcEIsS0FBSyxPQUFPO1lBQ1YsSUFBSSxRQUFRLENBQUMsSUFBSSxLQUFLLFNBQVMsRUFBRTtnQkFDL0IsT0FBTztvQkFDTCxVQUFVLEVBQUUsS0FBSztvQkFDakIsT0FBTyxFQUFFLGdGQUFnRjtpQkFDMUYsQ0FBQzthQUNIO1lBQ0QsT0FBTyxVQUFVLENBQUM7S0FDckI7SUFDRCxNQUFNLElBQUksS0FBSyxDQUFDLG1EQUFtRCxHQUFHLE9BQU8sQ0FBQyxDQUFDO0FBQ2pGLENBQUM7QUFFRCxNQUFNLDJCQUEyQixRQUF1QjtJQUN0RCxPQUFPLFFBQVEsQ0FBQyxJQUFJLEtBQUssY0FBYyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDO0FBQzVELENBQUM7QUFFRCxNQUFNLHlCQUF5QixRQUF1QjtJQUNwRCxPQUFPLFFBQVEsQ0FBQyxJQUFJLEtBQUssVUFBVSxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDO0FBQzdELENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBEZWNsYXJhdGlvbiBhbmQgdXRpbGl0eSBmb3IgdmFyaWFudHMgb2YgYSBmaWVsZCBkZWZpbml0aW9uIG9iamVjdFxuaW1wb3J0IHtBZ2dyZWdhdGVPcH0gZnJvbSAndmVnYSc7XG5pbXBvcnQge2lzQXJyYXksIGlzQm9vbGVhbiwgaXNOdW1iZXIsIGlzU3RyaW5nfSBmcm9tICd2ZWdhLXV0aWwnO1xuaW1wb3J0IHtpc0FnZ3JlZ2F0ZU9wLCBpc0NvdW50aW5nQWdncmVnYXRlT3B9IGZyb20gJy4vYWdncmVnYXRlJztcbmltcG9ydCB7QXhpc30gZnJvbSAnLi9heGlzJztcbmltcG9ydCB7YXV0b01heEJpbnMsIEJpblBhcmFtcywgYmluVG9TdHJpbmd9IGZyb20gJy4vYmluJztcbmltcG9ydCB7Q2hhbm5lbCwgcmFuZ2VUeXBlfSBmcm9tICcuL2NoYW5uZWwnO1xuaW1wb3J0IHtDb21wb3NpdGVBZ2dyZWdhdGV9IGZyb20gJy4vY29tcG9zaXRlbWFyayc7XG5pbXBvcnQge0NvbmZpZ30gZnJvbSAnLi9jb25maWcnO1xuaW1wb3J0IHtUaXRsZU1peGluc30gZnJvbSAnLi9ndWlkZSc7XG5pbXBvcnQge0xlZ2VuZH0gZnJvbSAnLi9sZWdlbmQnO1xuaW1wb3J0ICogYXMgbG9nIGZyb20gJy4vbG9nJztcbmltcG9ydCB7TG9naWNhbE9wZXJhbmR9IGZyb20gJy4vbG9naWNhbCc7XG5pbXBvcnQge1ByZWRpY2F0ZX0gZnJvbSAnLi9wcmVkaWNhdGUnO1xuaW1wb3J0IHtTY2FsZX0gZnJvbSAnLi9zY2FsZSc7XG5pbXBvcnQge0VuY29kaW5nU29ydEZpZWxkLCBTb3J0T3JkZXJ9IGZyb20gJy4vc29ydCc7XG5pbXBvcnQge1N0YWNrT2Zmc2V0fSBmcm9tICcuL3N0YWNrJztcbmltcG9ydCB7Z2V0VGltZVVuaXRQYXJ0cywgbm9ybWFsaXplVGltZVVuaXQsIFRpbWVVbml0fSBmcm9tICcuL3RpbWV1bml0JztcbmltcG9ydCB7QWdncmVnYXRlZEZpZWxkRGVmLCBXaW5kb3dGaWVsZERlZn0gZnJvbSAnLi90cmFuc2Zvcm0nO1xuaW1wb3J0IHtnZXRGdWxsTmFtZSwgUVVBTlRJVEFUSVZFLCBUeXBlfSBmcm9tICcuL3R5cGUnO1xuaW1wb3J0IHtmbGF0QWNjZXNzV2l0aERhdHVtLCByZXBsYWNlUGF0aEluRmllbGQsIHRpdGxlY2FzZX0gZnJvbSAnLi91dGlsJztcblxuXG4vKipcbiAqIERlZmluaXRpb24gb2JqZWN0IGZvciBhIGNvbnN0YW50IHZhbHVlIG9mIGFuIGVuY29kaW5nIGNoYW5uZWwuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgVmFsdWVEZWYge1xuICAvKipcbiAgICogQSBjb25zdGFudCB2YWx1ZSBpbiB2aXN1YWwgZG9tYWluIChlLmcuLCBgXCJyZWRcImAgLyBcIiMwMDk5ZmZcIiBmb3IgY29sb3IsIHZhbHVlcyBiZXR3ZWVuIGAwYCB0byBgMWAgZm9yIG9wYWNpdHkpLlxuICAgKi9cbiAgdmFsdWU6IG51bWJlciB8IHN0cmluZyB8IGJvb2xlYW47XG59XG5cbi8qKlxuICogR2VuZXJpYyB0eXBlIGZvciBjb25kaXRpb25hbCBjaGFubmVsRGVmLlxuICogRiBkZWZpbmVzIHRoZSB1bmRlcmx5aW5nIEZpZWxkRGVmIHR5cGUuXG4gKi9cbmV4cG9ydCB0eXBlIENoYW5uZWxEZWZXaXRoQ29uZGl0aW9uPEYgZXh0ZW5kcyBGaWVsZERlZjxhbnk+PiA9IEZpZWxkRGVmV2l0aENvbmRpdGlvbjxGPiB8IFZhbHVlRGVmV2l0aENvbmRpdGlvbjxGPjtcblxuZXhwb3J0IHR5cGUgQ29uZGl0aW9uYWw8VD4gPSBDb25kaXRpb25hbFByZWRpY2F0ZTxUPiB8IENvbmRpdGlvbmFsU2VsZWN0aW9uPFQ+O1xuXG5leHBvcnQgdHlwZSBDb25kaXRpb25hbFByZWRpY2F0ZTxUPiA9IHtcbiAgdGVzdDogTG9naWNhbE9wZXJhbmQ8UHJlZGljYXRlPjtcbn0gJiBUO1xuXG5leHBvcnQgdHlwZSBDb25kaXRpb25hbFNlbGVjdGlvbjxUPiA9IHtcbiAgLyoqXG4gICAqIEEgW3NlbGVjdGlvbiBuYW1lXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NlbGVjdGlvbi5odG1sKSwgb3IgYSBzZXJpZXMgb2YgW2NvbXBvc2VkIHNlbGVjdGlvbnNdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2VsZWN0aW9uLmh0bWwjY29tcG9zZSkuXG4gICAqL1xuICBzZWxlY3Rpb246IExvZ2ljYWxPcGVyYW5kPHN0cmluZz47XG59ICYgVDtcblxuZXhwb3J0IGZ1bmN0aW9uIGlzQ29uZGl0aW9uYWxTZWxlY3Rpb248VD4oYzogQ29uZGl0aW9uYWw8VD4pOiBjIGlzIENvbmRpdGlvbmFsU2VsZWN0aW9uPFQ+IHtcbiAgcmV0dXJuIGNbJ3NlbGVjdGlvbiddO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbmRpdGlvblZhbHVlRGVmTWl4aW5zIHtcbiAgLyoqXG4gICAqIE9uZSBvciBtb3JlIHZhbHVlIGRlZmluaXRpb24ocykgd2l0aCBhIHNlbGVjdGlvbiBwcmVkaWNhdGUuXG4gICAqXG4gICAqIF9fTm90ZTpfXyBBIGZpZWxkIGRlZmluaXRpb24ncyBgY29uZGl0aW9uYCBwcm9wZXJ0eSBjYW4gb25seSBjb250YWluIFt2YWx1ZSBkZWZpbml0aW9uc10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9lbmNvZGluZy5odG1sI3ZhbHVlLWRlZilcbiAgICogc2luY2UgVmVnYS1MaXRlIG9ubHkgYWxsb3dzIGF0IG1vc3Qgb25lIGVuY29kZWQgZmllbGQgcGVyIGVuY29kaW5nIGNoYW5uZWwuXG4gICAqL1xuICBjb25kaXRpb24/OiBDb25kaXRpb25hbDxWYWx1ZURlZj4gfCBDb25kaXRpb25hbDxWYWx1ZURlZj5bXTtcbn1cblxuLyoqXG4gKiBBIEZpZWxkRGVmIHdpdGggQ29uZGl0aW9uPFZhbHVlRGVmPlxuICoge1xuICogICBjb25kaXRpb246IHt2YWx1ZTogLi4ufSxcbiAqICAgZmllbGQ6IC4uLixcbiAqICAgLi4uXG4gKiB9XG4gKi9cblxuZXhwb3J0IHR5cGUgRmllbGREZWZXaXRoQ29uZGl0aW9uPEYgZXh0ZW5kcyBGaWVsZERlZjxhbnk+PiA9IEYgJiBDb25kaXRpb25WYWx1ZURlZk1peGlucztcblxuLyoqXG4gKiBBIFZhbHVlRGVmIHdpdGggQ29uZGl0aW9uPFZhbHVlRGVmIHwgRmllbGREZWY+XG4gKiB7XG4gKiAgIGNvbmRpdGlvbjoge2ZpZWxkOiAuLi59IHwge3ZhbHVlOiAuLi59LFxuICogICB2YWx1ZTogLi4uLFxuICogfVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFZhbHVlRGVmV2l0aENvbmRpdGlvbjxGIGV4dGVuZHMgRmllbGREZWY8YW55Pj4ge1xuICAvKipcbiAgICogQSBmaWVsZCBkZWZpbml0aW9uIG9yIG9uZSBvciBtb3JlIHZhbHVlIGRlZmluaXRpb24ocykgd2l0aCBhIHNlbGVjdGlvbiBwcmVkaWNhdGUuXG4gICAqL1xuICBjb25kaXRpb24/OiBDb25kaXRpb25hbDxGPiB8IENvbmRpdGlvbmFsPFZhbHVlRGVmPiB8IENvbmRpdGlvbmFsPFZhbHVlRGVmPltdO1xuXG4gIC8qKlxuICAgKiBBIGNvbnN0YW50IHZhbHVlIGluIHZpc3VhbCBkb21haW4uXG4gICAqL1xuICB2YWx1ZT86IG51bWJlciB8IHN0cmluZyB8IGJvb2xlYW47XG59XG5cbi8qKlxuICogUmVmZXJlbmNlIHRvIGEgcmVwZWF0ZWQgdmFsdWUuXG4gKi9cbmV4cG9ydCB0eXBlIFJlcGVhdFJlZiA9IHtcbiAgcmVwZWF0OiAncm93JyB8ICdjb2x1bW4nXG59O1xuXG5leHBvcnQgdHlwZSBGaWVsZCA9IHN0cmluZyB8IFJlcGVhdFJlZjtcblxuZXhwb3J0IGZ1bmN0aW9uIGlzUmVwZWF0UmVmKGZpZWxkOiBGaWVsZCk6IGZpZWxkIGlzIFJlcGVhdFJlZiB7XG4gIHJldHVybiBmaWVsZCAmJiAhaXNTdHJpbmcoZmllbGQpICYmICdyZXBlYXQnIGluIGZpZWxkO1xufVxuXG4vKiogQGhpZGUgKi9cbmV4cG9ydCB0eXBlIEhpZGRlbkNvbXBvc2l0ZUFnZ3JlZ2F0ZSA9IENvbXBvc2l0ZUFnZ3JlZ2F0ZTtcblxuZXhwb3J0IHR5cGUgQWdncmVnYXRlID0gQWdncmVnYXRlT3AgfCBIaWRkZW5Db21wb3NpdGVBZ2dyZWdhdGU7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmllbGREZWZCYXNlPEY+IHtcblxuICAvKipcbiAgICogX19SZXF1aXJlZC5fXyBBIHN0cmluZyBkZWZpbmluZyB0aGUgbmFtZSBvZiB0aGUgZmllbGQgZnJvbSB3aGljaCB0byBwdWxsIGEgZGF0YSB2YWx1ZVxuICAgKiBvciBhbiBvYmplY3QgZGVmaW5pbmcgaXRlcmF0ZWQgdmFsdWVzIGZyb20gdGhlIFtgcmVwZWF0YF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9yZXBlYXQuaHRtbCkgb3BlcmF0b3IuXG4gICAqXG4gICAqIF9fTm90ZTpfXyBEb3RzIChgLmApIGFuZCBicmFja2V0cyAoYFtgIGFuZCBgXWApIGNhbiBiZSB1c2VkIHRvIGFjY2VzcyBuZXN0ZWQgb2JqZWN0cyAoZS5nLiwgYFwiZmllbGRcIjogXCJmb28uYmFyXCJgIGFuZCBgXCJmaWVsZFwiOiBcImZvb1snYmFyJ11cImApLlxuICAgKiBJZiBmaWVsZCBuYW1lcyBjb250YWluIGRvdHMgb3IgYnJhY2tldHMgYnV0IGFyZSBub3QgbmVzdGVkLCB5b3UgY2FuIHVzZSBgXFxcXGAgdG8gZXNjYXBlIGRvdHMgYW5kIGJyYWNrZXRzIChlLmcuLCBgXCJhXFxcXC5iXCJgIGFuZCBgXCJhXFxcXFswXFxcXF1cImApLlxuICAgKiBTZWUgbW9yZSBkZXRhaWxzIGFib3V0IGVzY2FwaW5nIGluIHRoZSBbZmllbGQgZG9jdW1lbnRhdGlvbl0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9maWVsZC5odG1sKS5cbiAgICpcbiAgICogX19Ob3RlOl9fIGBmaWVsZGAgaXMgbm90IHJlcXVpcmVkIGlmIGBhZ2dyZWdhdGVgIGlzIGBjb3VudGAuXG4gICAqL1xuICBmaWVsZD86IEY7XG5cbiAgLy8gZnVuY3Rpb25cblxuICAvKipcbiAgICogVGltZSB1bml0IChlLmcuLCBgeWVhcmAsIGB5ZWFybW9udGhgLCBgbW9udGhgLCBgaG91cnNgKSBmb3IgYSB0ZW1wb3JhbCBmaWVsZC5cbiAgICogb3IgW2EgdGVtcG9yYWwgZmllbGQgdGhhdCBnZXRzIGNhc3RlZCBhcyBvcmRpbmFsXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3R5cGUuaHRtbCNjYXN0KS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGB1bmRlZmluZWRgIChOb25lKVxuICAgKi9cbiAgdGltZVVuaXQ/OiBUaW1lVW5pdDtcblxuICAvKipcbiAgICogQSBmbGFnIGZvciBiaW5uaW5nIGEgYHF1YW50aXRhdGl2ZWAgZmllbGQsIG9yIFthbiBvYmplY3QgZGVmaW5pbmcgYmlubmluZyBwYXJhbWV0ZXJzXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL2Jpbi5odG1sI3BhcmFtcykuXG4gICAqIElmIGB0cnVlYCwgZGVmYXVsdCBbYmlubmluZyBwYXJhbWV0ZXJzXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL2Jpbi5odG1sKSB3aWxsIGJlIGFwcGxpZWQuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgZmFsc2VgXG4gICAqL1xuICBiaW4/OiBib29sZWFuIHwgQmluUGFyYW1zO1xuXG4gIC8qKlxuICAgKiBBZ2dyZWdhdGlvbiBmdW5jdGlvbiBmb3IgdGhlIGZpZWxkXG4gICAqIChlLmcuLCBgbWVhbmAsIGBzdW1gLCBgbWVkaWFuYCwgYG1pbmAsIGBtYXhgLCBgY291bnRgKS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGB1bmRlZmluZWRgIChOb25lKVxuICAgKi9cbiAgYWdncmVnYXRlPzogQWdncmVnYXRlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdG9GaWVsZERlZkJhc2UoZmllbGREZWY6IEZpZWxkRGVmPHN0cmluZz4pOiBGaWVsZERlZkJhc2U8c3RyaW5nPiB7XG4gIGNvbnN0IHtmaWVsZCwgdGltZVVuaXQsIGJpbiwgYWdncmVnYXRlfSA9IGZpZWxkRGVmO1xuICByZXR1cm4ge1xuICAgIC4uLih0aW1lVW5pdCA/IHt0aW1lVW5pdH0gOiB7fSksXG4gICAgLi4uKGJpbiA/IHtiaW59IDoge30pLFxuICAgIC4uLihhZ2dyZWdhdGUgPyB7YWdncmVnYXRlfSA6IHt9KSxcbiAgICBmaWVsZFxuICB9O1xufVxuXG4vKipcbiAqICBEZWZpbml0aW9uIG9iamVjdCBmb3IgYSBkYXRhIGZpZWxkLCBpdHMgdHlwZSBhbmQgdHJhbnNmb3JtYXRpb24gb2YgYW4gZW5jb2RpbmcgY2hhbm5lbC5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBGaWVsZERlZjxGPiBleHRlbmRzIEZpZWxkRGVmQmFzZTxGPiwgVGl0bGVNaXhpbnMge1xuICAvKipcbiAgICogVGhlIGVuY29kZWQgZmllbGQncyB0eXBlIG9mIG1lYXN1cmVtZW50IChgXCJxdWFudGl0YXRpdmVcImAsIGBcInRlbXBvcmFsXCJgLCBgXCJvcmRpbmFsXCJgLCBvciBgXCJub21pbmFsXCJgKS5cbiAgICogSXQgY2FuIGFsc28gYmUgYSBgXCJnZW9qc29uXCJgIHR5cGUgZm9yIGVuY29kaW5nIFsnZ2Vvc2hhcGUnXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL2dlb3NoYXBlLmh0bWwpLlxuICAgKi9cbiAgLy8gKiBvciBhbiBpbml0aWFsIGNoYXJhY3RlciBvZiB0aGUgdHlwZSBuYW1lIChgXCJRXCJgLCBgXCJUXCJgLCBgXCJPXCJgLCBgXCJOXCJgKS5cbiAgLy8gKiBUaGlzIHByb3BlcnR5IGlzIGNhc2UtaW5zZW5zaXRpdmUuXG4gIHR5cGU6IFR5cGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2NhbGVGaWVsZERlZjxGPiBleHRlbmRzIEZpZWxkRGVmPEY+IHtcbiAgLyoqXG4gICAqIEFuIG9iamVjdCBkZWZpbmluZyBwcm9wZXJ0aWVzIG9mIHRoZSBjaGFubmVsJ3Mgc2NhbGUsIHdoaWNoIGlzIHRoZSBmdW5jdGlvbiB0aGF0IHRyYW5zZm9ybXMgdmFsdWVzIGluIHRoZSBkYXRhIGRvbWFpbiAobnVtYmVycywgZGF0ZXMsIHN0cmluZ3MsIGV0YykgdG8gdmlzdWFsIHZhbHVlcyAocGl4ZWxzLCBjb2xvcnMsIHNpemVzKSBvZiB0aGUgZW5jb2RpbmcgY2hhbm5lbHMuXG4gICAqXG4gICAqIElmIGBudWxsYCwgdGhlIHNjYWxlIHdpbGwgYmUgW2Rpc2FibGVkIGFuZCB0aGUgZGF0YSB2YWx1ZSB3aWxsIGJlIGRpcmVjdGx5IGVuY29kZWRdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNkaXNhYmxlKS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIElmIHVuZGVmaW5lZCwgZGVmYXVsdCBbc2NhbGUgcHJvcGVydGllc10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sKSBhcmUgYXBwbGllZC5cbiAgICovXG4gIHNjYWxlPzogU2NhbGUgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBTb3J0IG9yZGVyIGZvciB0aGUgZW5jb2RlZCBmaWVsZC5cbiAgICogU3VwcG9ydGVkIGBzb3J0YCB2YWx1ZXMgaW5jbHVkZSBgXCJhc2NlbmRpbmdcImAsIGBcImRlc2NlbmRpbmdcImAsIGBudWxsYCAobm8gc29ydGluZyksIG9yIGFuIGFycmF5IHNwZWNpZnlpbmcgdGhlIHByZWZlcnJlZCBvcmRlciBvZiB2YWx1ZXMuXG4gICAqIEZvciBmaWVsZHMgd2l0aCBkaXNjcmV0ZSBkb21haW5zLCBgc29ydGAgY2FuIGFsc28gYmUgYSBbc29ydCBmaWVsZCBkZWZpbml0aW9uIG9iamVjdF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zb3J0Lmh0bWwjc29ydC1maWVsZCkuXG4gICAqIEZvciBgc29ydGAgYXMgYW4gW2FycmF5IHNwZWNpZnlpbmcgdGhlIHByZWZlcnJlZCBvcmRlciBvZiB2YWx1ZXNdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc29ydC5odG1sI3NvcnQtYXJyYXkpLCB0aGUgc29ydCBvcmRlciB3aWxsIG9iZXkgdGhlIHZhbHVlcyBpbiB0aGUgYXJyYXksIGZvbGxvd2VkIGJ5IGFueSB1bnNwZWNpZmllZCB2YWx1ZXMgaW4gdGhlaXIgb3JpZ2luYWwgb3JkZXIuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgXCJhc2NlbmRpbmdcImBcbiAgICovXG4gIHNvcnQ/OiBzdHJpbmdbXSB8IFNvcnRPcmRlciB8IEVuY29kaW5nU29ydEZpZWxkPEY+IHwgbnVsbDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQb3NpdGlvbkZpZWxkRGVmPEY+IGV4dGVuZHMgU2NhbGVGaWVsZERlZjxGPiB7XG4gIC8qKlxuICAgKiBBbiBvYmplY3QgZGVmaW5pbmcgcHJvcGVydGllcyBvZiBheGlzJ3MgZ3JpZGxpbmVzLCB0aWNrcyBhbmQgbGFiZWxzLlxuICAgKiBJZiBgbnVsbGAsIHRoZSBheGlzIGZvciB0aGUgZW5jb2RpbmcgY2hhbm5lbCB3aWxsIGJlIHJlbW92ZWQuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBJZiB1bmRlZmluZWQsIGRlZmF1bHQgW2F4aXMgcHJvcGVydGllc10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9heGlzLmh0bWwpIGFyZSBhcHBsaWVkLlxuICAgKi9cbiAgYXhpcz86IEF4aXMgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBUeXBlIG9mIHN0YWNraW5nIG9mZnNldCBpZiB0aGUgZmllbGQgc2hvdWxkIGJlIHN0YWNrZWQuXG4gICAqIGBzdGFja2AgaXMgb25seSBhcHBsaWNhYmxlIGZvciBgeGAgYW5kIGB5YCBjaGFubmVscyB3aXRoIGNvbnRpbnVvdXMgZG9tYWlucy5cbiAgICogRm9yIGV4YW1wbGUsIGBzdGFja2Agb2YgYHlgIGNhbiBiZSB1c2VkIHRvIGN1c3RvbWl6ZSBzdGFja2luZyBmb3IgYSB2ZXJ0aWNhbCBiYXIgY2hhcnQuXG4gICAqXG4gICAqIGBzdGFja2AgY2FuIGJlIG9uZSBvZiB0aGUgZm9sbG93aW5nIHZhbHVlczpcbiAgICogLSBgXCJ6ZXJvXCJgOiBzdGFja2luZyB3aXRoIGJhc2VsaW5lIG9mZnNldCBhdCB6ZXJvIHZhbHVlIG9mIHRoZSBzY2FsZSAoZm9yIGNyZWF0aW5nIHR5cGljYWwgc3RhY2tlZCBbYmFyXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3N0YWNrLmh0bWwjYmFyKSBhbmQgW2FyZWFdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc3RhY2suaHRtbCNhcmVhKSBjaGFydCkuXG4gICAqIC0gYFwibm9ybWFsaXplXCJgIC0gc3RhY2tpbmcgd2l0aCBub3JtYWxpemVkIGRvbWFpbiAoZm9yIGNyZWF0aW5nIFtub3JtYWxpemVkIHN0YWNrZWQgYmFyIGFuZCBhcmVhIGNoYXJ0c10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zdGFjay5odG1sI25vcm1hbGl6ZWQpLiA8YnIvPlxuICAgKiAtYFwiY2VudGVyXCJgIC0gc3RhY2tpbmcgd2l0aCBjZW50ZXIgYmFzZWxpbmUgKGZvciBbc3RyZWFtZ3JhcGhdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc3RhY2suaHRtbCNzdHJlYW1ncmFwaCkpLlxuICAgKiAtIGBudWxsYCAtIE5vLXN0YWNraW5nLiBUaGlzIHdpbGwgcHJvZHVjZSBsYXllcmVkIFtiYXJdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc3RhY2suaHRtbCNsYXllcmVkLWJhci1jaGFydCkgYW5kIGFyZWEgY2hhcnQuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgemVyb2AgZm9yIHBsb3RzIHdpdGggYWxsIG9mIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucyBhcmUgdHJ1ZTpcbiAgICogKDEpIHRoZSBtYXJrIGlzIGBiYXJgIG9yIGBhcmVhYDtcbiAgICogKDIpIHRoZSBzdGFja2VkIG1lYXN1cmUgY2hhbm5lbCAoeCBvciB5KSBoYXMgYSBsaW5lYXIgc2NhbGU7XG4gICAqICgzKSBBdCBsZWFzdCBvbmUgb2Ygbm9uLXBvc2l0aW9uIGNoYW5uZWxzIG1hcHBlZCB0byBhbiB1bmFnZ3JlZ2F0ZWQgZmllbGQgdGhhdCBpcyBkaWZmZXJlbnQgZnJvbSB4IGFuZCB5LiAgT3RoZXJ3aXNlLCBgbnVsbGAgYnkgZGVmYXVsdC5cbiAgICovXG4gIHN0YWNrPzogU3RhY2tPZmZzZXQgfCBudWxsO1xufVxuXG4vKipcbiAqIEZpZWxkIGRlZmluaXRpb24gb2YgYSBtYXJrIHByb3BlcnR5LCB3aGljaCBjYW4gY29udGFpbiBhIGxlZ2VuZC5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBNYXJrUHJvcEZpZWxkRGVmPEY+IGV4dGVuZHMgU2NhbGVGaWVsZERlZjxGPiB7XG4gICAvKipcbiAgICAqIEFuIG9iamVjdCBkZWZpbmluZyBwcm9wZXJ0aWVzIG9mIHRoZSBsZWdlbmQuXG4gICAgKiBJZiBgbnVsbGAsIHRoZSBsZWdlbmQgZm9yIHRoZSBlbmNvZGluZyBjaGFubmVsIHdpbGwgYmUgcmVtb3ZlZC5cbiAgICAqXG4gICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gSWYgdW5kZWZpbmVkLCBkZWZhdWx0IFtsZWdlbmQgcHJvcGVydGllc10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9sZWdlbmQuaHRtbCkgYXJlIGFwcGxpZWQuXG4gICAgKi9cbiAgbGVnZW5kPzogTGVnZW5kIHwgbnVsbDtcbn1cblxuLy8gRGV0YWlsXG5cbi8vIE9yZGVyIFBhdGggaGF2ZSBubyBzY2FsZVxuXG5leHBvcnQgaW50ZXJmYWNlIE9yZGVyRmllbGREZWY8Rj4gZXh0ZW5kcyBGaWVsZERlZjxGPiB7XG4gIC8qKlxuICAgKiBUaGUgc29ydCBvcmRlci4gT25lIG9mIGBcImFzY2VuZGluZ1wiYCAoZGVmYXVsdCkgb3IgYFwiZGVzY2VuZGluZ1wiYC5cbiAgICovXG4gIHNvcnQ/OiBTb3J0T3JkZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGV4dEZpZWxkRGVmPEY+IGV4dGVuZHMgRmllbGREZWY8Rj4ge1xuICAvKipcbiAgICogVGhlIFtmb3JtYXR0aW5nIHBhdHRlcm5dKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvZm9ybWF0Lmh0bWwpIGZvciBhIHRleHQgZmllbGQuIElmIG5vdCBkZWZpbmVkLCB0aGlzIHdpbGwgYmUgZGV0ZXJtaW5lZCBhdXRvbWF0aWNhbGx5LlxuICAgKi9cbiAgZm9ybWF0Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgdHlwZSBDaGFubmVsRGVmPEY+ID0gQ2hhbm5lbERlZldpdGhDb25kaXRpb248RmllbGREZWY8Rj4+O1xuXG5leHBvcnQgZnVuY3Rpb24gaXNDb25kaXRpb25hbERlZjxGPihjaGFubmVsRGVmOiBDaGFubmVsRGVmPEY+KTogY2hhbm5lbERlZiBpcyBDaGFubmVsRGVmV2l0aENvbmRpdGlvbjxGaWVsZERlZjxGPj4ge1xuICByZXR1cm4gISFjaGFubmVsRGVmICYmICEhY2hhbm5lbERlZi5jb25kaXRpb247XG59XG5cbi8qKlxuICogUmV0dXJuIGlmIGEgY2hhbm5lbERlZiBpcyBhIENvbmRpdGlvbmFsVmFsdWVEZWYgd2l0aCBDb25kaXRpb25GaWVsZERlZlxuICovXG5leHBvcnQgZnVuY3Rpb24gaGFzQ29uZGl0aW9uYWxGaWVsZERlZjxGPihjaGFubmVsRGVmOiBDaGFubmVsRGVmPEY+KTogY2hhbm5lbERlZiBpcyAoVmFsdWVEZWYgJiB7Y29uZGl0aW9uOiBDb25kaXRpb25hbDxGaWVsZERlZjxGPj59KSB7XG4gIHJldHVybiAhIWNoYW5uZWxEZWYgJiYgISFjaGFubmVsRGVmLmNvbmRpdGlvbiAmJiAhaXNBcnJheShjaGFubmVsRGVmLmNvbmRpdGlvbikgJiYgaXNGaWVsZERlZihjaGFubmVsRGVmLmNvbmRpdGlvbik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYXNDb25kaXRpb25hbFZhbHVlRGVmPEY+KGNoYW5uZWxEZWY6IENoYW5uZWxEZWY8Rj4pOiBjaGFubmVsRGVmIGlzIChWYWx1ZURlZiAmIHtjb25kaXRpb246IENvbmRpdGlvbmFsPFZhbHVlRGVmPiB8IENvbmRpdGlvbmFsPFZhbHVlRGVmPltdfSkge1xuICByZXR1cm4gISFjaGFubmVsRGVmICYmICEhY2hhbm5lbERlZi5jb25kaXRpb24gJiYgKFxuICAgIGlzQXJyYXkoY2hhbm5lbERlZi5jb25kaXRpb24pIHx8IGlzVmFsdWVEZWYoY2hhbm5lbERlZi5jb25kaXRpb24pXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0ZpZWxkRGVmPEY+KGNoYW5uZWxEZWY6IENoYW5uZWxEZWY8Rj4pOiBjaGFubmVsRGVmIGlzIEZpZWxkRGVmPEY+IHwgUG9zaXRpb25GaWVsZERlZjxGPiB8IFNjYWxlRmllbGREZWY8Rj4gfCBNYXJrUHJvcEZpZWxkRGVmPEY+IHwgT3JkZXJGaWVsZERlZjxGPiB8IFRleHRGaWVsZERlZjxGPiB7XG4gIHJldHVybiAhIWNoYW5uZWxEZWYgJiYgKCEhY2hhbm5lbERlZlsnZmllbGQnXSB8fCBjaGFubmVsRGVmWydhZ2dyZWdhdGUnXSA9PT0gJ2NvdW50Jyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1N0cmluZ0ZpZWxkRGVmKGZpZWxkRGVmOiBDaGFubmVsRGVmPHN0cmluZ3xSZXBlYXRSZWY+KTogZmllbGREZWYgaXMgRmllbGREZWY8c3RyaW5nPiB7XG4gIHJldHVybiBpc0ZpZWxkRGVmKGZpZWxkRGVmKSAmJiBpc1N0cmluZyhmaWVsZERlZi5maWVsZCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbHVlRGVmPEY+KGNoYW5uZWxEZWY6IENoYW5uZWxEZWY8Rj4pOiBjaGFubmVsRGVmIGlzIFZhbHVlRGVmIHtcbiAgcmV0dXJuIGNoYW5uZWxEZWYgJiYgJ3ZhbHVlJyBpbiBjaGFubmVsRGVmICYmIGNoYW5uZWxEZWZbJ3ZhbHVlJ10gIT09IHVuZGVmaW5lZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU2NhbGVGaWVsZERlZjxGPihjaGFubmVsRGVmOiBDaGFubmVsRGVmPEY+KTogY2hhbm5lbERlZiBpcyBTY2FsZUZpZWxkRGVmPEY+IHtcbiAgcmV0dXJuICEhY2hhbm5lbERlZiAmJiAoISFjaGFubmVsRGVmWydzY2FsZSddIHx8ICEhY2hhbm5lbERlZlsnc29ydCddKTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGaWVsZFJlZk9wdGlvbiB7XG4gIC8qKiBleGNsdWRlIGJpbiwgYWdncmVnYXRlLCB0aW1lVW5pdCAqL1xuICBub2ZuPzogYm9vbGVhbjtcbiAgLyoqIFdyYXAgdGhlIGZpZWxkIHdpdGggZGF0dW0gb3IgcGFyZW50IChlLmcuLCBkYXR1bVsnLi4uJ10gZm9yIFZlZ2EgRXhwcmVzc2lvbiAqL1xuICBleHByPzogJ2RhdHVtJyB8ICdwYXJlbnQnO1xuICAvKiogcHJlcGVuZCBmbiB3aXRoIGN1c3RvbSBmdW5jdGlvbiBwcmVmaXggKi9cbiAgcHJlZml4Pzogc3RyaW5nO1xuICAvKiogYXBwZW5kIHN1ZmZpeCB0byB0aGUgZmllbGQgcmVmIGZvciBiaW4gKGRlZmF1bHQ9J3N0YXJ0JykgKi9cbiAgYmluU3VmZml4PzogJ2VuZCcgfCAncmFuZ2UnIHwgJ21pZCc7XG4gIC8qKiBhcHBlbmQgc3VmZml4IHRvIHRoZSBmaWVsZCByZWYgKGdlbmVyYWwpICovXG4gIHN1ZmZpeD86IHN0cmluZztcbn1cblxuZnVuY3Rpb24gaXNPcEZpZWxkRGVmKGZpZWxkRGVmOiBGaWVsZERlZkJhc2U8c3RyaW5nPiB8IFdpbmRvd0ZpZWxkRGVmIHwgQWdncmVnYXRlZEZpZWxkRGVmKTogZmllbGREZWYgaXMgV2luZG93RmllbGREZWYgfCBBZ2dyZWdhdGVkRmllbGREZWYge1xuICByZXR1cm4gISFmaWVsZERlZlsnb3AnXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZnRmllbGQoZmllbGREZWY6IEZpZWxkRGVmQmFzZTxzdHJpbmc+IHwgV2luZG93RmllbGREZWYgfCBBZ2dyZWdhdGVkRmllbGREZWYsIG9wdDogRmllbGRSZWZPcHRpb24gPSB7fSk6IHN0cmluZyB7XG4gIGxldCBmaWVsZCA9IGZpZWxkRGVmLmZpZWxkO1xuICBjb25zdCBwcmVmaXggPSBvcHQucHJlZml4O1xuICBsZXQgc3VmZml4ID0gb3B0LnN1ZmZpeDtcblxuICBpZiAoaXNDb3VudChmaWVsZERlZikpIHtcbiAgICBmaWVsZCA9ICdjb3VudF8qJztcbiAgfSBlbHNlIHtcbiAgICBsZXQgZm46IHN0cmluZyA9IHVuZGVmaW5lZDtcblxuICAgIGlmICghb3B0Lm5vZm4pIHtcbiAgICAgIGlmIChpc09wRmllbGREZWYoZmllbGREZWYpKSB7XG4gICAgICAgIGZuID0gZmllbGREZWYub3A7XG4gICAgICB9IGVsc2UgaWYgKGZpZWxkRGVmLmJpbikge1xuICAgICAgICBmbiA9IGJpblRvU3RyaW5nKGZpZWxkRGVmLmJpbik7XG4gICAgICAgIHN1ZmZpeCA9IG9wdC5iaW5TdWZmaXggfHwgJyc7XG4gICAgICB9IGVsc2UgaWYgKGZpZWxkRGVmLmFnZ3JlZ2F0ZSkge1xuICAgICAgICBmbiA9IFN0cmluZyhmaWVsZERlZi5hZ2dyZWdhdGUpO1xuICAgICAgfSBlbHNlIGlmIChmaWVsZERlZi50aW1lVW5pdCkge1xuICAgICAgICBmbiA9IFN0cmluZyhmaWVsZERlZi50aW1lVW5pdCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGZuKSB7XG4gICAgICBmaWVsZCA9IGZpZWxkID8gYCR7Zm59XyR7ZmllbGR9YCA6IGZuO1xuICAgIH1cbiAgfVxuXG4gIGlmIChzdWZmaXgpIHtcbiAgICBmaWVsZCA9IGAke2ZpZWxkfV8ke3N1ZmZpeH1gO1xuICB9XG5cbiAgaWYgKHByZWZpeCkge1xuICAgIGZpZWxkID0gYCR7cHJlZml4fV8ke2ZpZWxkfWA7XG4gIH1cblxuICBpZiAob3B0LmV4cHIpIHtcbiAgICAvLyBFeHByZXNzaW9uIHRvIGFjY2VzcyBmbGF0dGVuZWQgZmllbGQuIE5vIG5lZWQgdG8gZXNjYXBlIGRvdHMuXG4gICAgcmV0dXJuIGZsYXRBY2Nlc3NXaXRoRGF0dW0oZmllbGQsIG9wdC5leHByKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBXZSBmbGF0dGVuZWQgYWxsIGZpZWxkcyBzbyBwYXRocyBzaG91bGQgaGF2ZSBiZWNvbWUgZG90LlxuICAgIHJldHVybiByZXBsYWNlUGF0aEluRmllbGQoZmllbGQpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0Rpc2NyZXRlKGZpZWxkRGVmOiBGaWVsZERlZjxGaWVsZD4pIHtcbiAgc3dpdGNoIChmaWVsZERlZi50eXBlKSB7XG4gICAgY2FzZSAnbm9taW5hbCc6XG4gICAgY2FzZSAnb3JkaW5hbCc6XG4gICAgY2FzZSAnZ2VvanNvbic6XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICBjYXNlICdxdWFudGl0YXRpdmUnOlxuICAgICAgcmV0dXJuICEhZmllbGREZWYuYmluO1xuICAgIGNhc2UgJ2xhdGl0dWRlJzpcbiAgICBjYXNlICdsb25naXR1ZGUnOlxuICAgIGNhc2UgJ3RlbXBvcmFsJzpcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICB0aHJvdyBuZXcgRXJyb3IobG9nLm1lc3NhZ2UuaW52YWxpZEZpZWxkVHlwZShmaWVsZERlZi50eXBlKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NvbnRpbnVvdXMoZmllbGREZWY6IEZpZWxkRGVmPEZpZWxkPikge1xuICByZXR1cm4gIWlzRGlzY3JldGUoZmllbGREZWYpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNDb3VudChmaWVsZERlZjogRmllbGREZWZCYXNlPEZpZWxkPikge1xuICByZXR1cm4gZmllbGREZWYuYWdncmVnYXRlID09PSAnY291bnQnO1xufVxuXG5leHBvcnQgdHlwZSBGaWVsZFRpdGxlRm9ybWF0dGVyID0gKGZpZWxkRGVmOiBGaWVsZERlZkJhc2U8c3RyaW5nPiwgY29uZmlnOiBDb25maWcpID0+IHN0cmluZztcblxuZXhwb3J0IGZ1bmN0aW9uIHZlcmJhbFRpdGxlRm9ybWF0dGVyKGZpZWxkRGVmOiBGaWVsZERlZkJhc2U8c3RyaW5nPiwgY29uZmlnOiBDb25maWcpIHtcbiAgY29uc3Qge2ZpZWxkOiBmaWVsZCwgYmluLCB0aW1lVW5pdCwgYWdncmVnYXRlfSA9IGZpZWxkRGVmO1xuICBpZiAoYWdncmVnYXRlID09PSAnY291bnQnKSB7XG4gICAgcmV0dXJuIGNvbmZpZy5jb3VudFRpdGxlO1xuICB9IGVsc2UgaWYgKGJpbikge1xuICAgIHJldHVybiBgJHtmaWVsZH0gKGJpbm5lZClgO1xuICB9IGVsc2UgaWYgKHRpbWVVbml0KSB7XG4gICAgY29uc3QgdW5pdHMgPSBnZXRUaW1lVW5pdFBhcnRzKHRpbWVVbml0KS5qb2luKCctJyk7XG4gICAgcmV0dXJuIGAke2ZpZWxkfSAoJHt1bml0c30pYDtcbiAgfSBlbHNlIGlmIChhZ2dyZWdhdGUpIHtcbiAgICByZXR1cm4gYCR7dGl0bGVjYXNlKGFnZ3JlZ2F0ZSl9IG9mICR7ZmllbGR9YDtcbiAgfVxuICByZXR1cm4gZmllbGQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmdW5jdGlvbmFsVGl0bGVGb3JtYXR0ZXIoZmllbGREZWY6IEZpZWxkRGVmQmFzZTxzdHJpbmc+LCBjb25maWc6IENvbmZpZykge1xuICBjb25zdCBmbiA9IGZpZWxkRGVmLmFnZ3JlZ2F0ZSB8fCBmaWVsZERlZi50aW1lVW5pdCB8fCAoZmllbGREZWYuYmluICYmICdiaW4nKTtcbiAgaWYgKGZuKSB7XG4gICAgcmV0dXJuIGZuLnRvVXBwZXJDYXNlKCkgKyAnKCcgKyBmaWVsZERlZi5maWVsZCArICcpJztcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZmllbGREZWYuZmllbGQ7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRUaXRsZUZvcm1hdHRlcjogRmllbGRUaXRsZUZvcm1hdHRlciA9IChmaWVsZERlZjogRmllbGREZWZCYXNlPHN0cmluZz4sIGNvbmZpZzogQ29uZmlnKSA9PiB7XG4gIHN3aXRjaCAoY29uZmlnLmZpZWxkVGl0bGUpIHtcbiAgICBjYXNlICdwbGFpbic6XG4gICAgICByZXR1cm4gZmllbGREZWYuZmllbGQ7XG4gICAgY2FzZSAnZnVuY3Rpb25hbCc6XG4gICAgICByZXR1cm4gZnVuY3Rpb25hbFRpdGxlRm9ybWF0dGVyKGZpZWxkRGVmLCBjb25maWcpO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gdmVyYmFsVGl0bGVGb3JtYXR0ZXIoZmllbGREZWYsIGNvbmZpZyk7XG4gIH1cbn07XG5cbmxldCB0aXRsZUZvcm1hdHRlciA9IGRlZmF1bHRUaXRsZUZvcm1hdHRlcjtcblxuZXhwb3J0IGZ1bmN0aW9uIHNldFRpdGxlRm9ybWF0dGVyKGZvcm1hdHRlcjogRmllbGRUaXRsZUZvcm1hdHRlcikge1xuICB0aXRsZUZvcm1hdHRlciA9IGZvcm1hdHRlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc2V0VGl0bGVGb3JtYXR0ZXIoKSB7XG4gIHNldFRpdGxlRm9ybWF0dGVyKGRlZmF1bHRUaXRsZUZvcm1hdHRlcik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0aXRsZShmaWVsZERlZjogRmllbGREZWZCYXNlPHN0cmluZz4sIGNvbmZpZzogQ29uZmlnKSB7XG4gIHJldHVybiB0aXRsZUZvcm1hdHRlcihmaWVsZERlZiwgY29uZmlnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlZmF1bHRUeXBlKGZpZWxkRGVmOiBGaWVsZERlZjxGaWVsZD4sIGNoYW5uZWw6IENoYW5uZWwpOiBUeXBlIHtcbiAgaWYgKGZpZWxkRGVmLnRpbWVVbml0KSB7XG4gICAgcmV0dXJuICd0ZW1wb3JhbCc7XG4gIH1cbiAgaWYgKGZpZWxkRGVmLmJpbikge1xuICAgIHJldHVybiAncXVhbnRpdGF0aXZlJztcbiAgfVxuICBzd2l0Y2ggKHJhbmdlVHlwZShjaGFubmVsKSkge1xuICAgIGNhc2UgJ2NvbnRpbnVvdXMnOlxuICAgICAgcmV0dXJuICdxdWFudGl0YXRpdmUnO1xuICAgIGNhc2UgJ2Rpc2NyZXRlJzpcbiAgICAgIHJldHVybiAnbm9taW5hbCc7XG4gICAgY2FzZSAnZmxleGlibGUnOiAvLyBjb2xvclxuICAgICAgcmV0dXJuICdub21pbmFsJztcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuICdxdWFudGl0YXRpdmUnO1xuICB9XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgZmllbGREZWYgLS0gZWl0aGVyIGZyb20gdGhlIG91dGVyIGNoYW5uZWxEZWYgb3IgZnJvbSB0aGUgY29uZGl0aW9uIG9mIGNoYW5uZWxEZWYuXG4gKiBAcGFyYW0gY2hhbm5lbERlZlxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0RmllbGREZWY8Rj4oY2hhbm5lbERlZjogQ2hhbm5lbERlZjxGPik6IEZpZWxkRGVmPEY+IHtcbiAgaWYgKGlzRmllbGREZWYoY2hhbm5lbERlZikpIHtcbiAgICByZXR1cm4gY2hhbm5lbERlZjtcbiAgfSBlbHNlIGlmIChoYXNDb25kaXRpb25hbEZpZWxkRGVmKGNoYW5uZWxEZWYpKSB7XG4gICAgcmV0dXJuIGNoYW5uZWxEZWYuY29uZGl0aW9uO1xuICB9XG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG5cbi8qKlxuICogQ29udmVydCB0eXBlIHRvIGZ1bGwsIGxvd2VyY2FzZSB0eXBlLCBvciBhdWdtZW50IHRoZSBmaWVsZERlZiB3aXRoIGEgZGVmYXVsdCB0eXBlIGlmIG1pc3NpbmcuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemUoY2hhbm5lbERlZjogQ2hhbm5lbERlZjxzdHJpbmc+LCBjaGFubmVsOiBDaGFubmVsKTogQ2hhbm5lbERlZjxhbnk+IHtcbiAgaWYgKGlzU3RyaW5nKGNoYW5uZWxEZWYpIHx8IGlzTnVtYmVyKGNoYW5uZWxEZWYpIHx8IGlzQm9vbGVhbihjaGFubmVsRGVmKSkge1xuICAgIGNvbnN0IHByaW1pdGl2ZVR5cGUgPSBpc1N0cmluZyhjaGFubmVsRGVmKSA/ICdzdHJpbmcnIDpcbiAgICAgIGlzTnVtYmVyKGNoYW5uZWxEZWYpID8gJ251bWJlcicgOiAnYm9vbGVhbic7XG4gICAgbG9nLndhcm4obG9nLm1lc3NhZ2UucHJpbWl0aXZlQ2hhbm5lbERlZihjaGFubmVsLCBwcmltaXRpdmVUeXBlLCBjaGFubmVsRGVmKSk7XG4gICAgcmV0dXJuIHt2YWx1ZTogY2hhbm5lbERlZn07XG4gIH1cblxuICAvLyBJZiBhIGZpZWxkRGVmIGNvbnRhaW5zIGEgZmllbGQsIHdlIG5lZWQgdHlwZS5cbiAgaWYgKGlzRmllbGREZWYoY2hhbm5lbERlZikpIHtcbiAgICByZXR1cm4gbm9ybWFsaXplRmllbGREZWYoY2hhbm5lbERlZiwgY2hhbm5lbCk7XG4gIH0gZWxzZSBpZiAoaGFzQ29uZGl0aW9uYWxGaWVsZERlZihjaGFubmVsRGVmKSkge1xuICAgIHJldHVybiB7XG4gICAgICAuLi5jaGFubmVsRGVmLFxuICAgICAgLy8gTmVlZCB0byBjYXN0IGFzIG5vcm1hbGl6ZUZpZWxkRGVmIG5vcm1hbGx5IHJldHVybiBGaWVsZERlZiwgYnV0IGhlcmUgd2Uga25vdyB0aGF0IGl0IGlzIGRlZmluaXRlbHkgQ29uZGl0aW9uPEZpZWxkRGVmPlxuICAgICAgY29uZGl0aW9uOiBub3JtYWxpemVGaWVsZERlZihjaGFubmVsRGVmLmNvbmRpdGlvbiwgY2hhbm5lbCkgYXMgQ29uZGl0aW9uYWw8RmllbGREZWY8c3RyaW5nPj5cbiAgICB9O1xuICB9XG4gIHJldHVybiBjaGFubmVsRGVmO1xufVxuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZUZpZWxkRGVmKGZpZWxkRGVmOiBGaWVsZERlZjxzdHJpbmc+LCBjaGFubmVsOiBDaGFubmVsKSB7XG4gIC8vIERyb3AgaW52YWxpZCBhZ2dyZWdhdGVcbiAgaWYgKGZpZWxkRGVmLmFnZ3JlZ2F0ZSAmJiAhaXNBZ2dyZWdhdGVPcChmaWVsZERlZi5hZ2dyZWdhdGUpKSB7XG4gICAgY29uc3Qge2FnZ3JlZ2F0ZSwgLi4uZmllbGREZWZXaXRob3V0QWdncmVnYXRlfSA9IGZpZWxkRGVmO1xuICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLmludmFsaWRBZ2dyZWdhdGUoZmllbGREZWYuYWdncmVnYXRlKSk7XG4gICAgZmllbGREZWYgPSBmaWVsZERlZldpdGhvdXRBZ2dyZWdhdGU7XG4gIH1cblxuICAvLyBOb3JtYWxpemUgVGltZSBVbml0XG4gIGlmIChmaWVsZERlZi50aW1lVW5pdCkge1xuICAgIGZpZWxkRGVmID0ge1xuICAgICAgLi4uZmllbGREZWYsXG4gICAgICB0aW1lVW5pdDogbm9ybWFsaXplVGltZVVuaXQoZmllbGREZWYudGltZVVuaXQpXG4gICAgfTtcbiAgfVxuXG4gIC8vIE5vcm1hbGl6ZSBiaW5cbiAgaWYgKGZpZWxkRGVmLmJpbikge1xuICAgIGZpZWxkRGVmID0ge1xuICAgICAgLi4uZmllbGREZWYsXG4gICAgICBiaW46IG5vcm1hbGl6ZUJpbihmaWVsZERlZi5iaW4sIGNoYW5uZWwpXG4gICAgfTtcbiAgfVxuXG4gIC8vIE5vcm1hbGl6ZSBUeXBlXG4gIGlmIChmaWVsZERlZi50eXBlKSB7XG4gICAgY29uc3QgZnVsbFR5cGUgPSBnZXRGdWxsTmFtZShmaWVsZERlZi50eXBlKTtcbiAgICBpZiAoZmllbGREZWYudHlwZSAhPT0gZnVsbFR5cGUpIHtcbiAgICAgIC8vIGNvbnZlcnQgc2hvcnQgdHlwZSB0byBmdWxsIHR5cGVcbiAgICAgIGZpZWxkRGVmID0ge1xuICAgICAgICAuLi5maWVsZERlZixcbiAgICAgICAgdHlwZTogZnVsbFR5cGVcbiAgICAgIH07XG4gICAgfVxuICAgIGlmIChmaWVsZERlZi50eXBlICE9PSAncXVhbnRpdGF0aXZlJykge1xuICAgICAgaWYgKGlzQ291bnRpbmdBZ2dyZWdhdGVPcChmaWVsZERlZi5hZ2dyZWdhdGUpKSB7XG4gICAgICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLmludmFsaWRGaWVsZFR5cGVGb3JDb3VudEFnZ3JlZ2F0ZShmaWVsZERlZi50eXBlLCBmaWVsZERlZi5hZ2dyZWdhdGUpKTtcbiAgICAgICAgZmllbGREZWYgPSB7XG4gICAgICAgICAgLi4uZmllbGREZWYsXG4gICAgICAgICAgdHlwZTogJ3F1YW50aXRhdGl2ZSdcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8gSWYgdHlwZSBpcyBlbXB0eSAvIGludmFsaWQsIHRoZW4gYXVnbWVudCB3aXRoIGRlZmF1bHQgdHlwZVxuICAgIGNvbnN0IG5ld1R5cGUgPSBkZWZhdWx0VHlwZShmaWVsZERlZiwgY2hhbm5lbCk7XG4gICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuZW1wdHlPckludmFsaWRGaWVsZFR5cGUoZmllbGREZWYudHlwZSwgY2hhbm5lbCwgbmV3VHlwZSkpO1xuICAgIGZpZWxkRGVmID0ge1xuICAgICAgICAuLi5maWVsZERlZixcbiAgICAgIHR5cGU6IG5ld1R5cGVcbiAgICB9O1xuICB9XG5cbiAgY29uc3Qge2NvbXBhdGlibGUsIHdhcm5pbmd9ID0gY2hhbm5lbENvbXBhdGliaWxpdHkoZmllbGREZWYsIGNoYW5uZWwpO1xuICBpZiAoIWNvbXBhdGlibGUpIHtcbiAgICBsb2cud2Fybih3YXJuaW5nKTtcbiAgfVxuICByZXR1cm4gZmllbGREZWY7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVCaW4oYmluOiBCaW5QYXJhbXN8Ym9vbGVhbiwgY2hhbm5lbDogQ2hhbm5lbCkge1xuICBpZiAoaXNCb29sZWFuKGJpbikpIHtcbiAgICByZXR1cm4ge21heGJpbnM6IGF1dG9NYXhCaW5zKGNoYW5uZWwpfTtcbiAgfSBlbHNlIGlmICghYmluLm1heGJpbnMgJiYgIWJpbi5zdGVwKSB7XG4gICAgcmV0dXJuIHsuLi5iaW4sIG1heGJpbnM6IGF1dG9NYXhCaW5zKGNoYW5uZWwpfTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYmluO1xuICB9XG59XG5cbmNvbnN0IENPTVBBVElCTEUgPSB7Y29tcGF0aWJsZTogdHJ1ZX07XG5leHBvcnQgZnVuY3Rpb24gY2hhbm5lbENvbXBhdGliaWxpdHkoZmllbGREZWY6IEZpZWxkRGVmPEZpZWxkPiwgY2hhbm5lbDogQ2hhbm5lbCk6IHtjb21wYXRpYmxlOiBib29sZWFuOyB3YXJuaW5nPzogc3RyaW5nO30ge1xuICBjb25zdCB0eXBlID0gZmllbGREZWYudHlwZTtcblxuICBzd2l0Y2ggKGNoYW5uZWwpIHtcbiAgICBjYXNlICdyb3cnOlxuICAgIGNhc2UgJ2NvbHVtbic6XG4gICAgICBpZiAoaXNDb250aW51b3VzKGZpZWxkRGVmKSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGNvbXBhdGlibGU6IGZhbHNlLFxuICAgICAgICAgIHdhcm5pbmc6IGxvZy5tZXNzYWdlLmZhY2V0Q2hhbm5lbFNob3VsZEJlRGlzY3JldGUoY2hhbm5lbClcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBDT01QQVRJQkxFO1xuXG4gICAgY2FzZSAneCc6XG4gICAgY2FzZSAneSc6XG4gICAgY2FzZSAnY29sb3InOlxuICAgIGNhc2UgJ2ZpbGwnOlxuICAgIGNhc2UgJ3N0cm9rZSc6XG4gICAgY2FzZSAndGV4dCc6XG4gICAgY2FzZSAnZGV0YWlsJzpcbiAgICBjYXNlICdrZXknOlxuICAgIGNhc2UgJ3Rvb2x0aXAnOlxuICAgIGNhc2UgJ2hyZWYnOlxuICAgICAgcmV0dXJuIENPTVBBVElCTEU7XG5cbiAgICBjYXNlICdsb25naXR1ZGUnOlxuICAgIGNhc2UgJ2xvbmdpdHVkZTInOlxuICAgIGNhc2UgJ2xhdGl0dWRlJzpcbiAgICBjYXNlICdsYXRpdHVkZTInOlxuICAgICAgaWYgKHR5cGUgIT09IFFVQU5USVRBVElWRSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGNvbXBhdGlibGU6IGZhbHNlLFxuICAgICAgICAgIHdhcm5pbmc6IGBDaGFubmVsICR7Y2hhbm5lbH0gc2hvdWxkIGJlIHVzZWQgd2l0aCBhIHF1YW50aXRhdGl2ZSBmaWVsZCBvbmx5LCBub3QgJHtmaWVsZERlZi50eXBlfSBmaWVsZC5gXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gQ09NUEFUSUJMRTtcblxuICAgIGNhc2UgJ29wYWNpdHknOlxuICAgIGNhc2UgJ3NpemUnOlxuICAgIGNhc2UgJ3gyJzpcbiAgICBjYXNlICd5Mic6XG4gICAgICBpZiAoKHR5cGUgPT09ICdub21pbmFsJyAmJiAhZmllbGREZWZbJ3NvcnQnXSkgfHwgdHlwZSA9PT0gJ2dlb2pzb24nKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgY29tcGF0aWJsZTogZmFsc2UsXG4gICAgICAgICAgd2FybmluZzogYENoYW5uZWwgJHtjaGFubmVsfSBzaG91bGQgbm90IGJlIHVzZWQgd2l0aCBhbiB1bnNvcnRlZCBkaXNjcmV0ZSBmaWVsZC5gXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gQ09NUEFUSUJMRTtcblxuICAgIGNhc2UgJ3NoYXBlJzpcbiAgICAgIGlmIChmaWVsZERlZi50eXBlICE9PSAnbm9taW5hbCcgJiYgZmllbGREZWYudHlwZSAhPT0gJ2dlb2pzb24nKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgY29tcGF0aWJsZTogZmFsc2UsXG4gICAgICAgICAgd2FybmluZzogJ1NoYXBlIGNoYW5uZWwgc2hvdWxkIGJlIHVzZWQgd2l0aCBvbmx5IGVpdGhlciBub21pbmFsIG9yIGdlb2pzb24gZGF0YSdcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBDT01QQVRJQkxFO1xuXG4gICAgY2FzZSAnb3JkZXInOlxuICAgICAgaWYgKGZpZWxkRGVmLnR5cGUgPT09ICdub21pbmFsJykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGNvbXBhdGlibGU6IGZhbHNlLFxuICAgICAgICAgIHdhcm5pbmc6IGBDaGFubmVsIG9yZGVyIGlzIGluYXBwcm9wcmlhdGUgZm9yIG5vbWluYWwgZmllbGQsIHdoaWNoIGhhcyBubyBpbmhlcmVudCBvcmRlci5gXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gQ09NUEFUSUJMRTtcbiAgfVxuICB0aHJvdyBuZXcgRXJyb3IoJ2NoYW5uZWxDb21wYXRhYmlsaXR5IG5vdCBpbXBsZW1lbnRlZCBmb3IgY2hhbm5lbCAnICsgY2hhbm5lbCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc051bWJlckZpZWxkRGVmKGZpZWxkRGVmOiBGaWVsZERlZjxhbnk+KSB7XG4gIHJldHVybiBmaWVsZERlZi50eXBlID09PSAncXVhbnRpdGF0aXZlJyB8fCAhIWZpZWxkRGVmLmJpbjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVGltZUZpZWxkRGVmKGZpZWxkRGVmOiBGaWVsZERlZjxhbnk+KSB7XG4gIHJldHVybiBmaWVsZERlZi50eXBlID09PSAndGVtcG9yYWwnIHx8ICEhZmllbGREZWYudGltZVVuaXQ7XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { isArray } from 'vega-util';\nimport { CHANNELS, isChannel, supportMark } from './channel';\nimport { getFieldDef, hasConditionalFieldDef, isConditionalDef, isFieldDef, isValueDef, normalize, normalizeFieldDef } from './fielddef';\nimport * as log from './log';\nimport { Type } from './type';\nimport { contains, keys, some } from './util';\nexport function channelHasField(encoding, channel) {\n    var channelDef = encoding && encoding[channel];\n    if (channelDef) {\n        if (isArray(channelDef)) {\n            return some(channelDef, function (fieldDef) { return !!fieldDef.field; });\n        }\n        else {\n            return isFieldDef(channelDef) || hasConditionalFieldDef(channelDef);\n        }\n    }\n    return false;\n}\nexport function isAggregate(encoding) {\n    return some(CHANNELS, function (channel) {\n        if (channelHasField(encoding, channel)) {\n            var channelDef = encoding[channel];\n            if (isArray(channelDef)) {\n                return some(channelDef, function (fieldDef) { return !!fieldDef.aggregate; });\n            }\n            else {\n                var fieldDef = getFieldDef(channelDef);\n                return fieldDef && !!fieldDef.aggregate;\n            }\n        }\n        return false;\n    });\n}\nexport function normalizeEncoding(encoding, mark) {\n    return keys(encoding).reduce(function (normalizedEncoding, channel) {\n        var _a;\n        if (!isChannel(channel)) {\n            // Drop invalid channel\n            log.warn(log.message.invalidEncodingChannel(channel));\n            return normalizedEncoding;\n        }\n        if (!supportMark(channel, mark)) {\n            // Drop unsupported channel\n            log.warn(log.message.incompatibleChannel(channel, mark));\n            return normalizedEncoding;\n        }\n        // Drop line's size if the field is aggregated.\n        if (channel === 'size' && mark === 'line') {\n            var fieldDef = getFieldDef(encoding[channel]);\n            if (fieldDef && fieldDef.aggregate) {\n                log.warn(log.message.LINE_WITH_VARYING_SIZE);\n                return normalizedEncoding;\n            }\n        }\n        // Drop color if either fill or stroke is specified\n        if (channel === 'color' && ('fill' in encoding || 'stroke' in encoding)) {\n            log.warn(log.message.droppingColor('encoding', { fill: 'fill' in encoding, stroke: 'stroke' in encoding }));\n            return normalizedEncoding;\n        }\n        var channelDef = encoding[channel];\n        if (channel === 'detail' ||\n            (channel === 'order' && !isArray(channelDef) && !isValueDef(channelDef)) ||\n            (channel === 'tooltip' && isArray(channelDef))) {\n            if (channelDef) {\n                // Array of fieldDefs for detail channel (or production rule)\n                normalizedEncoding[channel] = (isArray(channelDef) ? channelDef : [channelDef])\n                    .reduce(function (defs, fieldDef) {\n                    if (!isFieldDef(fieldDef)) {\n                        log.warn(log.message.emptyFieldDef(fieldDef, channel));\n                    }\n                    else {\n                        defs.push(normalizeFieldDef(fieldDef, channel));\n                    }\n                    return defs;\n                }, []);\n            }\n        }\n        else {\n            var fieldDef = getFieldDef(encoding[channel]);\n            if (fieldDef && contains([Type.LATITUDE, Type.LONGITUDE], fieldDef.type)) {\n                var _b = channel, _ = normalizedEncoding[_b], newEncoding = tslib_1.__rest(normalizedEncoding, [typeof _b === \"symbol\" ? _b : _b + \"\"]);\n                var newChannel = channel === 'x' ? 'longitude' :\n                    channel === 'y' ? 'latitude' :\n                        channel === 'x2' ? 'longitude2' :\n                            channel === 'y2' ? 'latitude2' : undefined;\n                log.warn(log.message.latLongDeprecated(channel, fieldDef.type, newChannel));\n                return tslib_1.__assign({}, newEncoding, (_a = {}, _a[newChannel] = tslib_1.__assign({}, normalize(fieldDef, channel), { type: 'quantitative' }), _a));\n            }\n            if (!isFieldDef(channelDef) && !isValueDef(channelDef) && !isConditionalDef(channelDef)) {\n                log.warn(log.message.emptyFieldDef(channelDef, channel));\n                return normalizedEncoding;\n            }\n            normalizedEncoding[channel] = normalize(channelDef, channel);\n        }\n        return normalizedEncoding;\n    }, {});\n}\nexport function isRanged(encoding) {\n    return encoding && ((!!encoding.x && !!encoding.x2) || (!!encoding.y && !!encoding.y2));\n}\nexport function fieldDefs(encoding) {\n    var arr = [];\n    CHANNELS.forEach(function (channel) {\n        if (channelHasField(encoding, channel)) {\n            var channelDef = encoding[channel];\n            (isArray(channelDef) ? channelDef : [channelDef]).forEach(function (def) {\n                if (isFieldDef(def)) {\n                    arr.push(def);\n                }\n                else if (hasConditionalFieldDef(def)) {\n                    arr.push(def.condition);\n                }\n            });\n        }\n    });\n    return arr;\n}\nexport function forEach(mapping, f, thisArg) {\n    if (!mapping) {\n        return;\n    }\n    var _loop_1 = function (channel) {\n        if (isArray(mapping[channel])) {\n            mapping[channel].forEach(function (channelDef) {\n                f.call(thisArg, channelDef, channel);\n            });\n        }\n        else {\n            f.call(thisArg, mapping[channel], channel);\n        }\n    };\n    for (var _i = 0, _a = keys(mapping); _i < _a.length; _i++) {\n        var channel = _a[_i];\n        _loop_1(channel);\n    }\n}\nexport function reduce(mapping, f, init, thisArg) {\n    if (!mapping) {\n        return init;\n    }\n    return keys(mapping).reduce(function (r, channel) {\n        var map = mapping[channel];\n        if (isArray(map)) {\n            return map.reduce(function (r1, channelDef) {\n                return f.call(thisArg, r1, channelDef, channel);\n            }, r);\n        }\n        else {\n            return f.call(thisArg, r, map, channel);\n        }\n    }, init);\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW5jb2RpbmcuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZW5jb2RpbmcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBLE9BQU8sRUFBQyxPQUFPLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDbEMsT0FBTyxFQUFVLFFBQVEsRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBRXBFLE9BQU8sRUFLTCxXQUFXLEVBQ1gsc0JBQXNCLEVBQ3RCLGdCQUFnQixFQUNoQixVQUFVLEVBQ1YsVUFBVSxFQUVWLFNBQVMsRUFDVCxpQkFBaUIsRUFNbEIsTUFBTSxZQUFZLENBQUM7QUFDcEIsT0FBTyxLQUFLLEdBQUcsTUFBTSxPQUFPLENBQUM7QUFFN0IsT0FBTyxFQUFDLElBQUksRUFBQyxNQUFNLFFBQVEsQ0FBQztBQUM1QixPQUFPLEVBQUMsUUFBUSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUMsTUFBTSxRQUFRLENBQUM7QUE4STVDLE1BQU0sMEJBQTBCLFFBQWtDLEVBQUUsT0FBZ0I7SUFDbEYsSUFBTSxVQUFVLEdBQUcsUUFBUSxJQUFJLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNqRCxJQUFJLFVBQVUsRUFBRTtRQUNkLElBQUksT0FBTyxDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQ3ZCLE9BQU8sSUFBSSxDQUFDLFVBQVUsRUFBRSxVQUFDLFFBQVEsSUFBSyxPQUFBLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxFQUFoQixDQUFnQixDQUFDLENBQUM7U0FDekQ7YUFBTTtZQUNMLE9BQU8sVUFBVSxDQUFDLFVBQVUsQ0FBQyxJQUFJLHNCQUFzQixDQUFDLFVBQVUsQ0FBQyxDQUFDO1NBQ3JFO0tBQ0Y7SUFDRCxPQUFPLEtBQUssQ0FBQztBQUNmLENBQUM7QUFHRCxNQUFNLHNCQUFzQixRQUFrQztJQUM1RCxPQUFPLElBQUksQ0FBQyxRQUFRLEVBQUUsVUFBQyxPQUFPO1FBQzVCLElBQUksZUFBZSxD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LEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQzdCLElBQUksT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1lBQ2hCLE9BQU8sR0FBRyxDQUFDLE1BQU0sQ0FBQyxVQUFDLEVBQUssRUFBRSxVQUE4QjtnQkFDdEQsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxFQUFFLEVBQUUsVUFBVSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1lBQ2xELENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztTQUNQO2FBQU07WUFDTCxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUMsRUFBRSxHQUFHLEVBQUUsT0FBTyxDQUFDLENBQUM7U0FDekM7SUFDSCxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDWCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQge2lzQXJyYXl9IGZyb20gJ3ZlZ2EtdXRpbCc7XG5pbXBvcnQge0NoYW5uZWwsIENIQU5ORUxTLCBpc0NoYW5uZWwsIHN1cHBvcnRNYXJrfSBmcm9tICcuL2NoYW5uZWwnO1xuaW1wb3J0IHtGYWNldE1hcHBpbmd9IGZyb20gJy4vZmFjZXQnO1xuaW1wb3J0IHtcbiAgQ2hhbm5lbERlZixcbiAgRmllbGQsXG4gIEZpZWxkRGVmLFxuICBGaWVsZERlZldpdGhDb25kaXRpb24sXG4gIGdldEZpZWxkRGVmLFxuICBoYXNDb25kaXRpb25hbEZpZWxkRGVmLFxuICBpc0NvbmRpdGlvbmFsRGVmLFxuICBpc0ZpZWxkRGVmLFxuICBpc1ZhbHVlRGVmLFxuICBNYXJrUHJvcEZpZWxkRGVmLFxuICBub3JtYWxpemUsXG4gIG5vcm1hbGl6ZUZpZWxkRGVmLFxuICBPcmRlckZpZWxkRGVmLFxuICBQb3NpdGlvbkZpZWxkRGVmLFxuICBUZXh0RmllbGREZWYsXG4gIFZhbHVlRGVmLFxuICBWYWx1ZURlZldpdGhDb25kaXRpb25cbn0gZnJvbSAnLi9maWVsZGRlZic7XG5pbXBvcnQgKiBhcyBsb2cgZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtNYXJrfSBmcm9tICcuL21hcmsnO1xuaW1wb3J0IHtUeXBlfSBmcm9tICcuL3R5cGUnO1xuaW1wb3J0IHtjb250YWlucywga2V5cywgc29tZX0gZnJvbSAnLi91dGlsJztcblxuZXhwb3J0IGludGVyZmFjZSBFbmNvZGluZzxGPiB7XG4gIC8qKlxuICAgKiBYIGNvb3JkaW5hdGVzIG9mIHRoZSBtYXJrcywgb3Igd2lkdGggb2YgaG9yaXpvbnRhbCBgXCJiYXJcImAgYW5kIGBcImFyZWFcImAuXG4gICAqL1xuICB4PzogUG9zaXRpb25GaWVsZERlZjxGPiB8IFZhbHVlRGVmO1xuXG4gIC8qKlxuICAgKiBZIGNvb3JkaW5hdGVzIG9mIHRoZSBtYXJrcywgb3IgaGVpZ2h0IG9mIHZlcnRpY2FsIGBcImJhclwiYCBhbmQgYFwiYXJlYVwiYC5cbiAgICovXG4gIHk/OiBQb3NpdGlvbkZpZWxkRGVmPEY+IHwgVmFsdWVEZWY7XG5cbiAgLyoqXG4gICAqIFgyIGNvb3JkaW5hdGVzIGZvciByYW5nZWQgYFwiYXJlYVwiYCwgYFwiYmFyXCJgLCBgXCJyZWN0XCJgLCBhbmQgIGBcInJ1bGVcImAuXG4gICAqL1xuICAvLyBUT0RPOiBIYW0gbmVlZCB0byBhZGQgZGVmYXVsdCBiZWhhdmlvclxuICB4Mj86IEZpZWxkRGVmPEY+IHwgVmFsdWVEZWY7XG5cbiAgLyoqXG4gICAqIFkyIGNvb3JkaW5hdGVzIGZvciByYW5nZWQgYFwiYXJlYVwiYCwgYFwiYmFyXCJgLCBgXCJyZWN0XCJgLCBhbmQgIGBcInJ1bGVcImAuXG4gICAqL1xuICAvLyBUT0RPOiBIYW0gbmVlZCB0byBhZGQgZGVmYXVsdCBiZWhhdmlvclxuICB5Mj86IEZpZWxkRGVmPEY+IHwgVmFsdWVEZWY7XG5cblxuICAvKipcbiAgICogTG9uZ2l0dWRlIHBvc2l0aW9uIG9mIGdlb2dyYXBoaWNhbGx5IHByb2plY3RlZCBtYXJrcy5cbiAgICovXG4gIGxvbmdpdHVkZT86IEZpZWxkRGVmPEY+O1xuXG4gIC8qKlxuICAgKiBMYXRpdHVkZSBwb3NpdGlvbiBvZiBnZW9ncmFwaGljYWxseSBwcm9qZWN0ZWQgbWFya3MuXG4gICAqL1xuICBsYXRpdHVkZT86IEZpZWxkRGVmPEY+O1xuXG4gIC8qKlxuICAgKiBMb25naXR1ZGUtMiBwb3NpdGlvbiBmb3IgZ2VvZ3JhcGhpY2FsbHkgcHJvamVjdGVkIHJhbmdlZCBgXCJhcmVhXCJgLCBgXCJiYXJcImAsIGBcInJlY3RcImAsIGFuZCAgYFwicnVsZVwiYC5cbiAgICovXG4gIGxvbmdpdHVkZTI/OiBGaWVsZERlZjxGPjtcblxuICAvKipcbiAgICogTGF0aXR1ZGUtMiBwb3NpdGlvbiBmb3IgZ2VvZ3JhcGhpY2FsbHkgcHJvamVjdGVkIHJhbmdlZCBgXCJhcmVhXCJgLCBgXCJiYXJcImAsIGBcInJlY3RcImAsIGFuZCAgYFwicnVsZVwiYC5cbiAgICovXG4gIGxhdGl0dWRlMj86IEZpZWxkRGVmPEY+O1xuXG4gIC8qKlxuICAgKiBDb2xvciBvZiB0aGUgbWFya3Mg4oCTIGVpdGhlciBmaWxsIG9yIHN0cm9rZSBjb2xvciBiYXNlZCBvbiAgdGhlIGBmaWxsZWRgIHByb3BlcnR5IG9mIG1hcmsgZGVmaW5pdGlvbi5cbiAgICogQnkgZGVmYXVsdCwgYGNvbG9yYCByZXByZXNlbnRzIGZpbGwgY29sb3IgZm9yIGBcImFyZWFcImAsIGBcImJhclwiYCwgYFwidGlja1wiYCxcbiAgICogYFwidGV4dFwiYCwgYFwidHJhaWxcImAsIGBcImNpcmNsZVwiYCwgYW5kIGBcInNxdWFyZVwiYCAvIHN0cm9rZSBjb2xvciBmb3IgYFwibGluZVwiYCBhbmQgYFwicG9pbnRcImAuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBJZiB1bmRlZmluZWQsIHRoZSBkZWZhdWx0IGNvbG9yIGRlcGVuZHMgb24gW21hcmsgY29uZmlnXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL2NvbmZpZy5odG1sI21hcmspJ3MgYGNvbG9yYCBwcm9wZXJ0eS5cbiAgICpcbiAgICogX05vdGU6X1xuICAgKiAxKSBGb3IgZmluZS1ncmFpbmVkIGNvbnRyb2wgb3ZlciBib3RoIGZpbGwgYW5kIHN0cm9rZSBjb2xvcnMgb2YgdGhlIG1hcmtzLCBwbGVhc2UgdXNlIHRoZSBgZmlsbGAgYW5kIGBzdHJva2VgIGNoYW5uZWxzLiAgSWYgZWl0aGVyIGBmaWxsYCBvciBgc3Ryb2tlYCBjaGFubmVsIGlzIHNwZWNpZmllZCwgYGNvbG9yYCBjaGFubmVsIHdpbGwgYmUgaWdub3JlZC5cbiAgICogMikgU2VlIHRoZSBzY2FsZSBkb2N1bWVudGF0aW9uIGZvciBtb3JlIGluZm9ybWF0aW9uIGFib3V0IGN1c3RvbWl6aW5nIFtjb2xvciBzY2hlbWVdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNzY2hlbWUpLlxuICAgKi9cbiAgY29sb3I/OiBGaWVsZERlZldpdGhDb25kaXRpb248TWFya1Byb3BGaWVsZERlZjxGPj4gfCBWYWx1ZURlZldpdGhDb25kaXRpb248TWFya1Byb3BGaWVsZERlZjxGPj47XG5cbiAgLyoqXG4gICAqIEZpbGwgY29sb3Igb2YgdGhlIG1hcmtzLlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gSWYgdW5kZWZpbmVkLCB0aGUgZGVmYXVsdCBjb2xvciBkZXBlbmRzIG9uIFttYXJrIGNvbmZpZ10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9jb25maWcuaHRtbCNtYXJrKSdzIGBjb2xvcmAgcHJvcGVydHkuXG4gICAqXG4gICAqIF9Ob3RlOl8gV2hlbiB1c2luZyBgZmlsbGAgY2hhbm5lbCwgYGNvbG9yIGAgY2hhbm5lbCB3aWxsIGJlIGlnbm9yZWQuIFRvIGN1c3RvbWl6ZSBib3RoIGZpbGwgYW5kIHN0cm9rZSwgcGxlYXNlIHVzZSBgZmlsbGAgYW5kIGBzdHJva2VgIGNoYW5uZWxzIChub3QgYGZpbGxgIGFuZCBgY29sb3JgKS5cbiAgICovXG4gIGZpbGw/OiBGaWVsZERlZldpdGhDb25kaXRpb248TWFya1Byb3BGaWVsZERlZjxGPj4gfCBWYWx1ZURlZldpdGhDb25kaXRpb248TWFya1Byb3BGaWVsZERlZjxGPj47XG5cblxuICAvKipcbiAgICogU3Ryb2tlIGNvbG9yIG9mIHRoZSBtYXJrcy5cbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIElmIHVuZGVmaW5lZCwgdGhlIGRlZmF1bHQgY29sb3IgZGVwZW5kcyBvbiBbbWFyayBjb25maWddKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvY29uZmlnLmh0bWwjbWFyaykncyBgY29sb3JgIHByb3BlcnR5LlxuICAgKlxuICAgKiBfTm90ZTpfIFdoZW4gdXNpbmcgYHN0cm9rZWAgY2hhbm5lbCwgYGNvbG9yIGAgY2hhbm5lbCB3aWxsIGJlIGlnbm9yZWQuIFRvIGN1c3RvbWl6ZSBib3RoIHN0cm9rZSBhbmQgZmlsbCwgcGxlYXNlIHVzZSBgc3Ryb2tlYCBhbmQgYGZpbGxgIGNoYW5uZWxzIChub3QgYHN0cm9rZWAgYW5kIGBjb2xvcmApLlxuICAgKi9cbiAgc3Ryb2tlPzogRmllbGREZWZXaXRoQ29uZGl0aW9uPE1hcmtQcm9wRmllbGREZWY8Rj4+IHwgVmFsdWVEZWZXaXRoQ29uZGl0aW9uPE1hcmtQcm9wRmllbGREZWY8Rj4+O1xuXG5cbiAgLyoqXG4gICAqIE9wYWNpdHkgb2YgdGhlIG1hcmtzIOKAkyBlaXRoZXIgY2FuIGJlIGEgdmFsdWUgb3IgYSByYW5nZS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIElmIHVuZGVmaW5lZCwgdGhlIGRlZmF1bHQgb3BhY2l0eSBkZXBlbmRzIG9uIFttYXJrIGNvbmZpZ10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9jb25maWcuaHRtbCNtYXJrKSdzIGBvcGFjaXR5YCBwcm9wZXJ0eS5cbiAgICovXG4gIG9wYWNpdHk/OiBGaWVsZERlZldpdGhDb25kaXRpb248TWFya1Byb3BGaWVsZERlZjxGPj4gfCBWYWx1ZURlZldpdGhDb25kaXRpb248TWFya1Byb3BGaWVsZERlZjxGPj47XG5cbiAgLyoqXG4gICAqIFNpemUgb2YgdGhlIG1hcmsuXG4gICAqIC0gRm9yIGBcInBvaW50XCJgLCBgXCJzcXVhcmVcImAgYW5kIGBcImNpcmNsZVwiYCwg4oCTIHRoZSBzeW1ib2wgc2l6ZSwgb3IgcGl4ZWwgYXJlYSBvZiB0aGUgbWFyay5cbiAgICogLSBGb3IgYFwiYmFyXCJgIGFuZCBgXCJ0aWNrXCJgIOKAkyB0aGUgYmFyIGFuZCB0aWNrJ3Mgc2l6ZS5cbiAgICogLSBGb3IgYFwidGV4dFwiYCDigJMgdGhlIHRleHQncyBmb250IHNpemUuXG4gICAqIC0gU2l6ZSBpcyB1bnN1cHBvcnRlZCBmb3IgYFwibGluZVwiYCwgYFwiYXJlYVwiYCwgYW5kIGBcInJlY3RcImAuIChVc2UgYFwidHJhaWxcImAgaW5zdGVhZCBvZiBsaW5lIHdpdGggdmFyeWluZyBzaXplKVxuICAgKi9cbiAgc2l6ZT86IEZpZWxkRGVmV2l0aENvbmRpdGlvbjxNYXJrUHJvcEZpZWxkRGVmPEY+PiB8IFZhbHVlRGVmV2l0aENvbmRpdGlvbjxNYXJrUHJvcEZpZWxkRGVmPEY+PjtcblxuICAvKipcbiAgICogRm9yIGBwb2ludGAgbWFya3MgdGhlIHN1cHBvcnRlZCB2YWx1ZXMgYXJlXG4gICAqIGBcImNpcmNsZVwiYCAoZGVmYXVsdCksIGBcInNxdWFyZVwiYCwgYFwiY3Jvc3NcImAsIGBcImRpYW1vbmRcImAsIGBcInRyaWFuZ2xlLXVwXCJgLFxuICAgKiBvciBgXCJ0cmlhbmdsZS1kb3duXCJgLCBvciBlbHNlIGEgY3VzdG9tIFNWRyBwYXRoIHN0cmluZy5cbiAgICogRm9yIGBnZW9zaGFwZWAgbWFya3MgaXQgc2hvdWxkIGJlIGEgZmllbGQgZGVmaW5pdGlvbiBvZiB0aGUgZ2VvanNvbiBkYXRhXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBJZiB1bmRlZmluZWQsIHRoZSBkZWZhdWx0IHNoYXBlIGRlcGVuZHMgb24gW21hcmsgY29uZmlnXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL2NvbmZpZy5odG1sI3BvaW50LWNvbmZpZykncyBgc2hhcGVgIHByb3BlcnR5LlxuICAgKi9cbiAgc2hhcGU/OiBGaWVsZERlZldpdGhDb25kaXRpb248TWFya1Byb3BGaWVsZERlZjxGPj4gfCBWYWx1ZURlZldpdGhDb25kaXRpb248TWFya1Byb3BGaWVsZERlZjxGPj47IC8vIFRPRE86IG1heWJlIGRpc3Rpbmd1aXNoIG9yZGluYWwtb25seVxuXG4gIC8qKlxuICAgKiBBZGRpdGlvbmFsIGxldmVscyBvZiBkZXRhaWwgZm9yIGdyb3VwaW5nIGRhdGEgaW4gYWdncmVnYXRlIHZpZXdzIGFuZFxuICAgKiBpbiBsaW5lLCB0cmFpbCwgYW5kIGFyZWEgbWFya3Mgd2l0aG91dCBtYXBwaW5nIGRhdGEgdG8gYSBzcGVjaWZpYyB2aXN1YWwgY2hhbm5lbC5cbiAgICovXG4gIGRldGFpbD86IEZpZWxkRGVmPEY+IHwgRmllbGREZWY8Rj5bXTtcblxuICAvKipcbiAgICogQSBkYXRhIGZpZWxkIHRvIHVzZSBhcyBhIHVuaXF1ZSBrZXkgZm9yIGRhdGEgYmluZGluZy4gV2hlbiBhIHZpc3VhbGl6YXRpb27igJlzIGRhdGEgaXMgdXBkYXRlZCwgdGhlIGtleSB2YWx1ZSB3aWxsIGJlIHVzZWQgdG8gbWF0Y2ggZGF0YSBlbGVtZW50cyB0byBleGlzdGluZyBtYXJrIGluc3RhbmNlcy4gVXNlIGEga2V5IGNoYW5uZWwgdG8gZW5hYmxlIG9iamVjdCBjb25zdGFuY3kgZm9yIHRyYW5zaXRpb25zIG92ZXIgZHluYW1pYyBkYXRhLlxuICAgKi9cbiAga2V5PzogRmllbGREZWY8Rj47XG5cbiAgLyoqXG4gICAqIFRleHQgb2YgdGhlIGB0ZXh0YCBtYXJrLlxuICAgKi9cbiAgdGV4dD86IEZpZWxkRGVmV2l0aENvbmRpdGlvbjxUZXh0RmllbGREZWY8Rj4+IHwgVmFsdWVEZWZXaXRoQ29uZGl0aW9uPFRleHRGaWVsZERlZjxGPj47XG5cbiAgLyoqXG4gICAqIFRoZSB0b29sdGlwIHRleHQgdG8gc2hvdyB1cG9uIG1vdXNlIGhvdmVyLlxuICAgKi9cbiAgdG9vbHRpcD86IEZpZWxkRGVmV2l0aENvbmRpdGlvbjxUZXh0RmllbGREZWY8Rj4+IHwgVmFsdWVEZWZXaXRoQ29uZGl0aW9uPFRleHRGaWVsZERlZjxGPj4gfCBUZXh0RmllbGREZWY8Rj5bXTtcblxuICAvKipcbiAgICogQSBVUkwgdG8gbG9hZCB1cG9uIG1vdXNlIGNsaWNrLlxuICAgKi9cbiAgaHJlZj86IEZpZWxkRGVmV2l0aENvbmRpdGlvbjxGaWVsZERlZjxGPj4gfCBWYWx1ZURlZldpdGhDb25kaXRpb248RmllbGREZWY8Rj4+O1xuXG4gIC8qKlxuICAgKiBPcmRlciBvZiB0aGUgbWFya3MuXG4gICAqIC0gRm9yIHN0YWNrZWQgbWFya3MsIHRoaXMgYG9yZGVyYCBjaGFubmVsIGVuY29kZXMgW3N0YWNrIG9yZGVyXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3N0YWNrLmh0bWwjb3JkZXIpLlxuICAgKiAtIEZvciBsaW5lIGFuZCB0cmFpbCBtYXJrcywgdGhpcyBgb3JkZXJgIGNoYW5uZWwgZW5jb2RlcyBvcmRlciBvZiBkYXRhIHBvaW50cyBpbiB0aGUgbGluZXMuIFRoaXMgY2FuIGJlIHVzZWZ1bCBmb3IgY3JlYXRpbmcgW2EgY29ubmVjdGVkIHNjYXR0ZXJwbG90XShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9leGFtcGxlcy9jb25uZWN0ZWRfc2NhdHRlcnBsb3QuaHRtbCkuICBTZXR0aW5nIGBvcmRlcmAgdG8gYHtcInZhbHVlXCI6IG51bGx9YCBtYWtlcyB0aGUgbGluZSBtYXJrcyB1c2UgdGhlIG9yaWdpbmFsIG9yZGVyIGluIHRoZSBkYXRhIHNvdXJjZXMuXG4gICAqIC0gT3RoZXJ3aXNlLCB0aGlzIGBvcmRlcmAgY2hhbm5lbCBlbmNvZGVzIGxheWVyIG9yZGVyIG9mIHRoZSBtYXJrcy5cbiAgICpcbiAgICogX19Ob3RlX186IEluIGFnZ3JlZ2F0ZSBwbG90cywgYG9yZGVyYCBmaWVsZCBzaG91bGQgYmUgYGFnZ3JlZ2F0ZWBkIHRvIGF2b2lkIGNyZWF0aW5nIGFkZGl0aW9uYWwgYWdncmVnYXRpb24gZ3JvdXBpbmcuXG4gICAqL1xuICBvcmRlcj86IE9yZGVyRmllbGREZWY8Rj4gfCBPcmRlckZpZWxkRGVmPEY+W10gfCBWYWx1ZURlZjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFbmNvZGluZ1dpdGhGYWNldDxGPiBleHRlbmRzIEVuY29kaW5nPEY+LCBGYWNldE1hcHBpbmc8Rj4ge31cblxuZXhwb3J0IGZ1bmN0aW9uIGNoYW5uZWxIYXNGaWVsZChlbmNvZGluZzogRW5jb2RpbmdXaXRoRmFjZXQ8RmllbGQ+LCBjaGFubmVsOiBDaGFubmVsKTogYm9vbGVhbiB7XG4gIGNvbnN0IGNoYW5uZWxEZWYgPSBlbmNvZGluZyAmJiBlbmNvZGluZ1tjaGFubmVsXTtcbiAgaWYgKGNoYW5uZWxEZWYpIHtcbiAgICBpZiAoaXNBcnJheShjaGFubmVsRGVmKSkge1xuICAgICAgcmV0dXJuIHNvbWUoY2hhbm5lbERlZiwgKGZpZWxkRGVmKSA9PiAhIWZpZWxkRGVmLmZpZWxkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGlzRmllbGREZWYoY2hhbm5lbERlZikgfHwgaGFzQ29uZGl0aW9uYWxGaWVsZERlZihjaGFubmVsRGVmKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBpc0FnZ3JlZ2F0ZShlbmNvZGluZzogRW5jb2RpbmdXaXRoRmFjZXQ8RmllbGQ+KSB7XG4gIHJldHVybiBzb21lKENIQU5ORUxTLCAoY2hhbm5lbCkgPT4ge1xuICAgIGlmIChjaGFubmVsSGFzRmllbGQoZW5jb2RpbmcsIGNoYW5uZWwpKSB7XG4gICAgICBjb25zdCBjaGFubmVsRGVmID0gZW5jb2RpbmdbY2hhbm5lbF07XG4gICAgICBpZiAoaXNBcnJheShjaGFubmVsRGVmKSkge1xuICAgICAgICByZXR1cm4gc29tZShjaGFubmVsRGVmLCAoZmllbGREZWYpID0+ICEhZmllbGREZWYuYWdncmVnYXRlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGZpZWxkRGVmID0gZ2V0RmllbGREZWYoY2hhbm5lbERlZik7XG4gICAgICAgIHJldHVybiBmaWVsZERlZiAmJiAhIWZpZWxkRGVmLmFnZ3JlZ2F0ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZUVuY29kaW5nKGVuY29kaW5nOiBFbmNvZGluZzxzdHJpbmc+LCBtYXJrOiBNYXJrKTogRW5jb2Rpbmc8c3RyaW5nPiB7XG4gICByZXR1cm4ga2V5cyhlbmNvZGluZykucmVkdWNlKChub3JtYWxpemVkRW5jb2Rpbmc6IEVuY29kaW5nPHN0cmluZz4sIGNoYW5uZWw6IENoYW5uZWwgfCBzdHJpbmcpID0+IHtcbiAgICBpZiAoIWlzQ2hhbm5lbChjaGFubmVsKSkge1xuICAgICAgLy8gRHJvcCBpbnZhbGlkIGNoYW5uZWxcbiAgICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLmludmFsaWRFbmNvZGluZ0NoYW5uZWwoY2hhbm5lbCkpO1xuICAgICAgcmV0dXJuIG5vcm1hbGl6ZWRFbmNvZGluZztcbiAgICB9XG5cbiAgICBpZiAoIXN1cHBvcnRNYXJrKGNoYW5uZWwsIG1hcmspKSB7XG4gICAgICAvLyBEcm9wIHVuc3VwcG9ydGVkIGNoYW5uZWxcblxuICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuaW5jb21wYXRpYmxlQ2hhbm5lbChjaGFubmVsLCBtYXJrKSk7XG4gICAgICByZXR1cm4gbm9ybWFsaXplZEVuY29kaW5nO1xuICAgIH1cblxuICAgIC8vIERyb3AgbGluZSdzIHNpemUgaWYgdGhlIGZpZWxkIGlzIGFnZ3JlZ2F0ZWQuXG4gICAgaWYgKGNoYW5uZWwgPT09ICdzaXplJyAmJiBtYXJrID09PSAnbGluZScpIHtcbiAgICAgIGNvbnN0IGZpZWxkRGVmID0gZ2V0RmllbGREZWYoZW5jb2RpbmdbY2hhbm5lbF0pO1xuICAgICAgaWYgKGZpZWxkRGVmICYmIGZpZWxkRGVmLmFnZ3JlZ2F0ZSkge1xuICAgICAgICBsb2cud2Fybihsb2cubWVzc2FnZS5MSU5FX1dJVEhfVkFSWUlOR19TSVpFKTtcbiAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZWRFbmNvZGluZztcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBEcm9wIGNvbG9yIGlmIGVpdGhlciBmaWxsIG9yIHN0cm9rZSBpcyBzcGVjaWZpZWRcbiAgICAgaWYgKGNoYW5uZWwgPT09ICdjb2xvcicgJiYgKCdmaWxsJyBpbiBlbmNvZGluZyB8fCAnc3Ryb2tlJyBpbiBlbmNvZGluZykgKSB7XG4gICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuZHJvcHBpbmdDb2xvcignZW5jb2RpbmcnLCB7ZmlsbDogJ2ZpbGwnIGluIGVuY29kaW5nLCBzdHJva2U6ICdzdHJva2UnIGluIGVuY29kaW5nfSkpO1xuICAgICAgIHJldHVybiBub3JtYWxpemVkRW5jb2Rpbmc7XG4gICAgfVxuXG4gICAgY29uc3QgY2hhbm5lbERlZiA9IGVuY29kaW5nW2NoYW5uZWxdO1xuICAgIGlmIChcbiAgICAgIGNoYW5uZWwgPT09ICdkZXRhaWwnIHx8XG4gICAgICAoY2hhbm5lbCA9PT0gJ29yZGVyJyAmJiAhaXNBcnJheShjaGFubmVsRGVmKSAmJiAhaXNWYWx1ZURlZihjaGFubmVsRGVmKSkgfHxcbiAgICAgIChjaGFubmVsID09PSAndG9vbHRpcCcgJiYgaXNBcnJheShjaGFubmVsRGVmKSlcbiAgICApIHtcbiAgICAgIGlmIChjaGFubmVsRGVmKSB7XG4gICAgICAgIC8vIEFycmF5IG9mIGZpZWxkRGVmcyBmb3IgZGV0YWlsIGNoYW5uZWwgKG9yIHByb2R1Y3Rpb24gcnVsZSlcbiAgICAgICAgbm9ybWFsaXplZEVuY29kaW5nW2NoYW5uZWxdID0gKGlzQXJyYXkoY2hhbm5lbERlZikgPyBjaGFubmVsRGVmIDogW2NoYW5uZWxEZWZdKVxuICAgICAgICAgIC5yZWR1Y2UoKGRlZnM6IEZpZWxkRGVmPHN0cmluZz5bXSwgZmllbGREZWY6IEZpZWxkRGVmPHN0cmluZz4pID0+IHtcbiAgICAgICAgICAgIGlmICghaXNGaWVsZERlZihmaWVsZERlZikpIHtcbiAgICAgICAgICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuZW1wdHlGaWVsZERlZihmaWVsZERlZiwgY2hhbm5lbCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZGVmcy5wdXNoKG5vcm1hbGl6ZUZpZWxkRGVmKGZpZWxkRGVmLCBjaGFubmVsKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZGVmcztcbiAgICAgICAgICB9LCBbXSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcblxuICAgICAgY29uc3QgZmllbGREZWYgPSBnZXRGaWVsZERlZihlbmNvZGluZ1tjaGFubmVsXSk7XG4gICAgICBpZiAoZmllbGREZWYgJiYgY29udGFpbnMoW1R5cGUuTEFUSVRVREUsIFR5cGUuTE9OR0lUVURFXSwgZmllbGREZWYudHlwZSkpIHtcbiAgICAgICAgY29uc3Qge1tjaGFubmVsXTogXywgLi4ubmV3RW5jb2Rpbmd9ID0gbm9ybWFsaXplZEVuY29kaW5nO1xuICAgICAgICBjb25zdCBuZXdDaGFubmVsID0gY2hhbm5lbCA9PT0gJ3gnID8gJ2xvbmdpdHVkZScgOlxuICAgICAgICAgIGNoYW5uZWwgPT09ICd5JyA/ICdsYXRpdHVkZScgOlxuICAgICAgICAgIGNoYW5uZWwgPT09ICd4MicgPyAnbG9uZ2l0dWRlMicgOlxuICAgICAgICAgIGNoYW5uZWwgPT09ICd5MicgPyAnbGF0aXR1ZGUyJyA6IHVuZGVmaW5lZDtcbiAgICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UubGF0TG9uZ0RlcHJlY2F0ZWQoY2hhbm5lbCwgZmllbGREZWYudHlwZSwgbmV3Q2hhbm5lbCkpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLm5ld0VuY29kaW5nLFxuICAgICAgICAgIFtuZXdDaGFubmVsXToge1xuICAgICAgICAgICAgLi4ubm9ybWFsaXplKGZpZWxkRGVmIGFzIGFueSwgY2hhbm5lbCksXG4gICAgICAgICAgICB0eXBlOiAncXVhbnRpdGF0aXZlJ1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFpc0ZpZWxkRGVmKGNoYW5uZWxEZWYpICYmICFpc1ZhbHVlRGVmKGNoYW5uZWxEZWYpICYmICFpc0NvbmRpdGlvbmFsRGVmKGNoYW5uZWxEZWYpKSB7XG4gICAgICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLmVtcHR5RmllbGREZWYoY2hhbm5lbERlZiwgY2hhbm5lbCkpO1xuICAgICAgICByZXR1cm4gbm9ybWFsaXplZEVuY29kaW5nO1xuICAgICAgfVxuICAgICAgbm9ybWFsaXplZEVuY29kaW5nW2NoYW5uZWxdID0gbm9ybWFsaXplKGNoYW5uZWxEZWYgYXMgQ2hhbm5lbERlZjxzdHJpbmc+LCBjaGFubmVsKTtcbiAgICB9XG4gICAgcmV0dXJuIG5vcm1hbGl6ZWRFbmNvZGluZztcbiAgfSwge30pO1xufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBpc1JhbmdlZChlbmNvZGluZzogRW5jb2RpbmdXaXRoRmFjZXQ8YW55Pikge1xuICByZXR1cm4gZW5jb2RpbmcgJiYgKCghIWVuY29kaW5nLnggJiYgISFlbmNvZGluZy54MikgfHwgKCEhZW5jb2RpbmcueSAmJiAhIWVuY29kaW5nLnkyKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaWVsZERlZnMoZW5jb2Rpbmc6IEVuY29kaW5nV2l0aEZhY2V0PEZpZWxkPik6IEZpZWxkRGVmPEZpZWxkPltdIHtcbiAgY29uc3QgYXJyOiBGaWVsZERlZjxGaWVsZD5bXSA9IFtdO1xuICBDSEFOTkVMUy5mb3JFYWNoKGZ1bmN0aW9uKGNoYW5uZWwpIHtcbiAgICBpZiAoY2hhbm5lbEhhc0ZpZWxkKGVuY29kaW5nLCBjaGFubmVsKSkge1xuICAgICAgY29uc3QgY2hhbm5lbERlZiA9IGVuY29kaW5nW2NoYW5uZWxdO1xuICAgICAgKGlzQXJyYXkoY2hhbm5lbERlZikgPyBjaGFubmVsRGVmIDogW2NoYW5uZWxEZWZdKS5mb3JFYWNoKChkZWYpID0+IHtcbiAgICAgICAgaWYgKGlzRmllbGREZWYoZGVmKSkge1xuICAgICAgICAgIGFyci5wdXNoKGRlZik7XG4gICAgICAgIH0gZWxzZSBpZiAoaGFzQ29uZGl0aW9uYWxGaWVsZERlZihkZWYpKSB7XG4gICAgICAgICAgYXJyLnB1c2goZGVmLmNvbmRpdGlvbik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBhcnI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmb3JFYWNoKG1hcHBpbmc6IGFueSxcbiAgICBmOiAoZmQ6IEZpZWxkRGVmPHN0cmluZz4sIGM6IENoYW5uZWwpID0+IHZvaWQsXG4gICAgdGhpc0FyZz86IGFueSkge1xuICBpZiAoIW1hcHBpbmcpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBmb3IgKGNvbnN0IGNoYW5uZWwgb2Yga2V5cyhtYXBwaW5nKSkge1xuICAgIGlmIChpc0FycmF5KG1hcHBpbmdbY2hhbm5lbF0pKSB7XG4gICAgICBtYXBwaW5nW2NoYW5uZWxdLmZvckVhY2goZnVuY3Rpb24oY2hhbm5lbERlZjogQ2hhbm5lbERlZjxzdHJpbmc+KSB7XG4gICAgICAgIGYuY2FsbCh0aGlzQXJnLCBjaGFubmVsRGVmLCBjaGFubmVsKTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBmLmNhbGwodGhpc0FyZywgbWFwcGluZ1tjaGFubmVsXSwgY2hhbm5lbCk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZWR1Y2U8VCwgVSBleHRlbmRzIHtbayBpbiBDaGFubmVsXT86IGFueX0+KG1hcHBpbmc6IFUsXG4gICAgZjogKGFjYzogYW55LCBmZDogRmllbGREZWY8c3RyaW5nPiwgYzogQ2hhbm5lbCkgPT4gVSxcbiAgICBpbml0OiBULCB0aGlzQXJnPzogYW55KSB7XG4gIGlmICghbWFwcGluZykge1xuICAgIHJldHVybiBpbml0O1xuICB9XG5cbiAgcmV0dXJuIGtleXMobWFwcGluZykucmVkdWNlKChyLCBjaGFubmVsKSA9PiB7XG4gICAgY29uc3QgbWFwID0gbWFwcGluZ1tjaGFubmVsXTtcbiAgICBpZiAoaXNBcnJheShtYXApKSB7XG4gICAgICByZXR1cm4gbWFwLnJlZHVjZSgocjE6IFQsIGNoYW5uZWxEZWY6IENoYW5uZWxEZWY8c3RyaW5nPikgPT4ge1xuICAgICAgICByZXR1cm4gZi5jYWxsKHRoaXNBcmcsIHIxLCBjaGFubmVsRGVmLCBjaGFubmVsKTtcbiAgICAgIH0sIHIpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZi5jYWxsKHRoaXNBcmcsIHIsIG1hcCwgY2hhbm5lbCk7XG4gICAgfVxuICB9LCBpbml0KTtcbn1cbiJdfQ==","export function getMarkSpecificConfigMixins(markSpecificConfig, channel) {\n    var _a;\n    var value = markSpecificConfig[channel];\n    return value !== undefined ? (_a = {}, _a[channel] = { value: value }, _a) : {};\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tbW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvbXBvc2l0ZW1hcmsvY29tbW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUdBLE1BQU0sc0NBQXNDLGtCQUE4QixFQUFFLE9BQTJCOztJQUNyRyxJQUFNLEtBQUssR0FBRyxrQkFBa0IsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUMxQyxPQUFPLEtBQUssS0FBSyxTQUFTLENBQUMsQ0FBQyxXQUFFLEdBQUMsT0FBTyxJQUFHLEVBQUMsS0FBSyxPQUFBLEVBQUMsTUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDO0FBQ3pELENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge05vblBvc2l0aW9uQ2hhbm5lbH0gZnJvbSAnLi4vY2hhbm5lbCc7XG5pbXBvcnQge01hcmtDb25maWd9IGZyb20gJy4uL21hcmsnO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWFya1NwZWNpZmljQ29uZmlnTWl4aW5zKG1hcmtTcGVjaWZpY0NvbmZpZzogTWFya0NvbmZpZywgY2hhbm5lbDogTm9uUG9zaXRpb25DaGFubmVsKSB7XG4gIGNvbnN0IHZhbHVlID0gbWFya1NwZWNpZmljQ29uZmlnW2NoYW5uZWxdO1xuICByZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZCA/IHtbY2hhbm5lbF06IHt2YWx1ZX19IDoge307XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { isNumber } from 'vega-util';\nimport { reduce } from '../encoding';\nimport { forEach } from './../encoding';\nimport { isContinuous, isFieldDef, vgField } from './../fielddef';\nimport * as log from './../log';\nimport { getMarkSpecificConfigMixins } from './common';\nexport var BOXPLOT = 'box-plot';\nexport function isBoxPlotDef(mark) {\n    return !!mark['type'];\n}\nexport var BOXPLOT_STYLES = ['boxWhisker', 'box', 'boxMid'];\nexport var VL_ONLY_BOXPLOT_CONFIG_PROPERTY_INDEX = {\n    box: ['size', 'color', 'extent'],\n    boxWhisker: ['color'],\n    boxMid: ['color']\n};\nvar supportedChannels = ['x', 'y', 'color', 'detail', 'opacity', 'size'];\nexport function filterUnsupportedChannels(spec) {\n    return tslib_1.__assign({}, spec, { encoding: reduce(spec.encoding, function (newEncoding, fieldDef, channel) {\n            if (supportedChannels.indexOf(channel) > -1) {\n                newEncoding[channel] = fieldDef;\n            }\n            else {\n                log.warn(log.message.incompatibleChannel(channel, BOXPLOT));\n            }\n            return newEncoding;\n        }, {}) });\n}\nexport function normalizeBoxPlot(spec, config) {\n    var _a, _b, _c, _d;\n    spec = filterUnsupportedChannels(spec);\n    // TODO: use selection\n    var mark = spec.mark, encoding = spec.encoding, selection = spec.selection, _p = spec.projection, outerSpec = tslib_1.__rest(spec, [\"mark\", \"encoding\", \"selection\", \"projection\"]);\n    var kIQRScalar = undefined;\n    if (isNumber(config.box.extent)) {\n        kIQRScalar = config.box.extent;\n    }\n    if (isBoxPlotDef(mark)) {\n        if (mark.extent) {\n            if (mark.extent === 'min-max') {\n                kIQRScalar = undefined;\n            }\n        }\n    }\n    var orient = boxOrient(spec);\n    var _e = boxParams(spec, orient, kIQRScalar), transform = _e.transform, continuousAxisChannelDef = _e.continuousAxisChannelDef, continuousAxis = _e.continuousAxis, encodingWithoutContinuousAxis = _e.encodingWithoutContinuousAxis;\n    var color = encodingWithoutContinuousAxis.color, size = encodingWithoutContinuousAxis.size, encodingWithoutSizeColorAndContinuousAxis = tslib_1.__rest(encodingWithoutContinuousAxis, [\"color\", \"size\"]);\n    // Size encoding or the default config.box.size is applied to box and boxMid\n    var sizeMixins = size ? { size: size } : getMarkSpecificConfigMixins(config.box, 'size');\n    var continuousAxisScaleAndAxis = {};\n    if (continuousAxisChannelDef.scale) {\n        continuousAxisScaleAndAxis['scale'] = continuousAxisChannelDef.scale;\n    }\n    if (continuousAxisChannelDef.axis) {\n        continuousAxisScaleAndAxis['axis'] = continuousAxisChannelDef.axis;\n    }\n    return tslib_1.__assign({}, outerSpec, { transform: transform, layer: [\n            {\n                mark: {\n                    type: 'rule',\n                    style: 'boxWhisker'\n                },\n                encoding: tslib_1.__assign((_a = {}, _a[continuousAxis] = tslib_1.__assign({ field: 'lower_whisker_' + continuousAxisChannelDef.field, type: continuousAxisChannelDef.type }, continuousAxisScaleAndAxis), _a[continuousAxis + '2'] = {\n                    field: 'lower_box_' + continuousAxisChannelDef.field,\n                    type: continuousAxisChannelDef.type\n                }, _a), encodingWithoutSizeColorAndContinuousAxis, getMarkSpecificConfigMixins(config.boxWhisker, 'color'))\n            }, {\n                mark: {\n                    type: 'rule',\n                    style: 'boxWhisker'\n                },\n                encoding: tslib_1.__assign((_b = {}, _b[continuousAxis] = {\n                    field: 'upper_box_' + continuousAxisChannelDef.field,\n                    type: continuousAxisChannelDef.type\n                }, _b[continuousAxis + '2'] = {\n                    field: 'upper_whisker_' + continuousAxisChannelDef.field,\n                    type: continuousAxisChannelDef.type\n                }, _b), encodingWithoutSizeColorAndContinuousAxis, getMarkSpecificConfigMixins(config.boxWhisker, 'color'))\n            },\n            tslib_1.__assign({}, (selection ? { selection: selection } : {}), { mark: {\n                    type: 'bar',\n                    style: 'box'\n                }, encoding: tslib_1.__assign((_c = {}, _c[continuousAxis] = {\n                    field: 'lower_box_' + continuousAxisChannelDef.field,\n                    type: continuousAxisChannelDef.type\n                }, _c[continuousAxis + '2'] = {\n                    field: 'upper_box_' + continuousAxisChannelDef.field,\n                    type: continuousAxisChannelDef.type\n                }, _c), encodingWithoutContinuousAxis, (encodingWithoutContinuousAxis.color ? {} : getMarkSpecificConfigMixins(config.box, 'color')), sizeMixins) }),\n            {\n                mark: {\n                    type: 'tick',\n                    style: 'boxMid'\n                },\n                encoding: tslib_1.__assign((_d = {}, _d[continuousAxis] = {\n                    field: 'mid_box_' + continuousAxisChannelDef.field,\n                    type: continuousAxisChannelDef.type\n                }, _d), encodingWithoutSizeColorAndContinuousAxis, getMarkSpecificConfigMixins(config.boxMid, 'color'), sizeMixins)\n            }\n        ] });\n}\nfunction boxOrient(spec) {\n    var mark = spec.mark, encoding = spec.encoding, _p = spec.projection, _outerSpec = tslib_1.__rest(spec, [\"mark\", \"encoding\", \"projection\"]);\n    if (isFieldDef(encoding.x) && isContinuous(encoding.x)) {\n        // x is continuous\n        if (isFieldDef(encoding.y) && isContinuous(encoding.y)) {\n            // both x and y are continuous\n            if (encoding.x.aggregate === undefined && encoding.y.aggregate === BOXPLOT) {\n                return 'vertical';\n            }\n            else if (encoding.y.aggregate === undefined && encoding.x.aggregate === BOXPLOT) {\n                return 'horizontal';\n            }\n            else if (encoding.x.aggregate === BOXPLOT && encoding.y.aggregate === BOXPLOT) {\n                throw new Error('Both x and y cannot have aggregate');\n            }\n            else {\n                if (isBoxPlotDef(mark) && mark.orient) {\n                    return mark.orient;\n                }\n                // default orientation = vertical\n                return 'vertical';\n            }\n        }\n        // x is continuous but y is not\n        return 'horizontal';\n    }\n    else if (isFieldDef(encoding.y) && isContinuous(encoding.y)) {\n        // y is continuous but x is not\n        return 'vertical';\n    }\n    else {\n        // Neither x nor y is continuous.\n        throw new Error('Need a valid continuous axis for boxplots');\n    }\n}\nfunction boxContinousAxis(spec, orient) {\n    var mark = spec.mark, encoding = spec.encoding, _p = spec.projection, _outerSpec = tslib_1.__rest(spec, [\"mark\", \"encoding\", \"projection\"]);\n    var continuousAxisChannelDef;\n    var continuousAxis;\n    if (orient === 'vertical') {\n        continuousAxis = 'y';\n        continuousAxisChannelDef = encoding.y; // Safe to cast because if y is not continuous fielddef, the orient would not be vertical.\n    }\n    else {\n        continuousAxis = 'x';\n        continuousAxisChannelDef = encoding.x; // Safe to cast because if x is not continuous fielddef, the orient would not be horizontal.\n    }\n    if (continuousAxisChannelDef && continuousAxisChannelDef.aggregate) {\n        var aggregate = continuousAxisChannelDef.aggregate, continuousAxisWithoutAggregate = tslib_1.__rest(continuousAxisChannelDef, [\"aggregate\"]);\n        if (aggregate !== BOXPLOT) {\n            log.warn(\"Continuous axis should not have customized aggregation function \" + aggregate);\n        }\n        continuousAxisChannelDef = continuousAxisWithoutAggregate;\n    }\n    return {\n        continuousAxisChannelDef: continuousAxisChannelDef,\n        continuousAxis: continuousAxis\n    };\n}\nfunction boxParams(spec, orient, kIQRScalar) {\n    var _a = boxContinousAxis(spec, orient), continuousAxisChannelDef = _a.continuousAxisChannelDef, continuousAxis = _a.continuousAxis;\n    var encoding = spec.encoding;\n    var isMinMax = kIQRScalar === undefined;\n    var aggregate = [\n        {\n            op: 'q1',\n            field: continuousAxisChannelDef.field,\n            as: 'lower_box_' + continuousAxisChannelDef.field\n        },\n        {\n            op: 'q3',\n            field: continuousAxisChannelDef.field,\n            as: 'upper_box_' + continuousAxisChannelDef.field\n        },\n        {\n            op: 'median',\n            field: continuousAxisChannelDef.field,\n            as: 'mid_box_' + continuousAxisChannelDef.field\n        }\n    ];\n    var postAggregateCalculates = [];\n    aggregate.push({\n        op: 'min',\n        field: continuousAxisChannelDef.field,\n        as: (isMinMax ? 'lower_whisker_' : 'min_') + continuousAxisChannelDef.field\n    });\n    aggregate.push({\n        op: 'max',\n        field: continuousAxisChannelDef.field,\n        as: (isMinMax ? 'upper_whisker_' : 'max_') + continuousAxisChannelDef.field\n    });\n    if (!isMinMax) {\n        postAggregateCalculates = [\n            {\n                calculate: \"datum.upper_box_\" + continuousAxisChannelDef.field + \" - datum.lower_box_\" + continuousAxisChannelDef.field,\n                as: 'iqr_' + continuousAxisChannelDef.field\n            },\n            {\n                calculate: \"min(datum.upper_box_\" + continuousAxisChannelDef.field + \" + datum.iqr_\" + continuousAxisChannelDef.field + \" * \" + kIQRScalar + \", datum.max_\" + continuousAxisChannelDef.field + \")\",\n                as: 'upper_whisker_' + continuousAxisChannelDef.field\n            },\n            {\n                calculate: \"max(datum.lower_box_\" + continuousAxisChannelDef.field + \" - datum.iqr_\" + continuousAxisChannelDef.field + \" * \" + kIQRScalar + \", datum.min_\" + continuousAxisChannelDef.field + \")\",\n                as: 'lower_whisker_' + continuousAxisChannelDef.field\n            }\n        ];\n    }\n    var groupby = [];\n    var bins = [];\n    var timeUnits = [];\n    var encodingWithoutContinuousAxis = {};\n    forEach(encoding, function (channelDef, channel) {\n        if (channel === continuousAxis) {\n            // Skip continuous axis as we already handle it separately\n            return;\n        }\n        if (isFieldDef(channelDef)) {\n            if (channelDef.aggregate && channelDef.aggregate !== BOXPLOT) {\n                aggregate.push({\n                    op: channelDef.aggregate,\n                    field: channelDef.field,\n                    as: vgField(channelDef)\n                });\n            }\n            else if (channelDef.aggregate === undefined) {\n                var transformedField = vgField(channelDef);\n                // Add bin or timeUnit transform if applicable\n                var bin = channelDef.bin;\n                if (bin) {\n                    var field = channelDef.field;\n                    bins.push({ bin: bin, field: field, as: transformedField });\n                }\n                else if (channelDef.timeUnit) {\n                    var timeUnit = channelDef.timeUnit, field = channelDef.field;\n                    timeUnits.push({ timeUnit: timeUnit, field: field, as: transformedField });\n                }\n                groupby.push(transformedField);\n            }\n            // now the field should refer to post-transformed field instead\n            encodingWithoutContinuousAxis[channel] = {\n                field: vgField(channelDef),\n                type: channelDef.type\n            };\n        }\n        else {\n            // For value def, just copy\n            encodingWithoutContinuousAxis[channel] = encoding[channel];\n        }\n    });\n    return {\n        transform: [].concat(bins, timeUnits, [{ aggregate: aggregate, groupby: groupby }], postAggregateCalculates),\n        continuousAxisChannelDef: continuousAxisChannelDef,\n        continuousAxis: continuousAxis,\n        encodingWithoutContinuousAxis: encodingWithoutContinuousAxis\n    };\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYm94cGxvdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb3NpdGVtYXJrL2JveHBsb3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBQyxRQUFRLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFHbkMsT0FBTyxFQUFDLE1BQU0sRUFBQyxNQUFNLGFBQWEsQ0FBQztBQUVuQyxPQUFPLEVBQVcsT0FBTyxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQ2hELE9BQU8sRUFBa0IsWUFBWSxFQUFFLFVBQVUsRUFBb0IsT0FBTyxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQ25HLE9BQU8sS0FBSyxHQUFHLE1BQU0sVUFBVSxDQUFDO0FBSWhDLE9BQU8sRUFBQywyQkFBMkIsRUFBQyxNQUFNLFVBQVUsQ0FBQztBQUdyRCxNQUFNLENBQUMsSUFBTSxPQUFPLEdBQWUsVUFBVSxDQUFDO0FBMEI5QyxNQUFNLHVCQUF1QixJQUEwQjtJQUNyRCxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDeEIsQ0FBQztBQUVELE1BQU0sQ0FBQyxJQUFNLGNBQWMsR0FBbUIsQ0FBQyxZQUFZLEVBQUUsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0FBOEI5RSxNQUFNLENBQUMsSUFBTSxxQ0FBcUMsR0FFOUM7SUFDRixHQUFHLEVBQUUsQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLFFBQVEsQ0FBQztJQUNoQyxVQUFVLEVBQUUsQ0FBQyxPQUFPLENBQUM7SUFDckIsTUFBTSxFQUFFLENBQUMsT0FBTyxDQUFDO0NBQ2xCLENBQUM7QUFFRixJQUFNLGlCQUFpQixHQUFjLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxNQUFNLENBQUMsQ0FBQztBQUN0RixNQUFNLG9DQUFvQyxJQUE2RDtJQUNyRyw0QkFDSyxJQUFJLElBQ1AsUUFBUSxFQUFFLE1BQU0sQ0FBQyxJ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QUFDLEVBQ3RCLHVCQUF1QixDQUN4QjtRQUNELHdCQUF3QiwwQkFBQTtRQUN4QixjQUFjLGdCQUFBO1FBQ2QsNkJBQTZCLCtCQUFBO0tBQzlCLENBQUM7QUFDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtpc051bWJlcn0gZnJvbSAndmVnYS11dGlsJztcbmltcG9ydCB7Q2hhbm5lbH0gZnJvbSAnLi4vY2hhbm5lbCc7XG5pbXBvcnQge0NvbmZpZ30gZnJvbSAnLi4vY29uZmlnJztcbmltcG9ydCB7cmVkdWNlfSBmcm9tICcuLi9lbmNvZGluZyc7XG5pbXBvcnQge0FnZ3JlZ2F0ZWRGaWVsZERlZiwgQmluVHJhbnNmb3JtLCBDYWxjdWxhdGVUcmFuc2Zvcm0sIFRpbWVVbml0VHJhbnNmb3JtfSBmcm9tICcuLi90cmFuc2Zvcm0nO1xuaW1wb3J0IHtFbmNvZGluZywgZm9yRWFjaH0gZnJvbSAnLi8uLi9lbmNvZGluZyc7XG5pbXBvcnQge0ZpZWxkLCBGaWVsZERlZiwgaXNDb250aW51b3VzLCBpc0ZpZWxkRGVmLCBQb3NpdGlvbkZpZWxkRGVmLCB2Z0ZpZWxkfSBmcm9tICcuLy4uL2ZpZWxkZGVmJztcbmltcG9ydCAqIGFzIGxvZyBmcm9tICcuLy4uL2xvZyc7XG5pbXBvcnQge01hcmtDb25maWd9IGZyb20gJy4vLi4vbWFyayc7XG5pbXBvcnQge0dlbmVyaWNVbml0U3BlYywgTm9ybWFsaXplZExheWVyU3BlY30gZnJvbSAnLi8uLi9zcGVjJztcbmltcG9ydCB7T3JpZW50fSBmcm9tICcuLy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7Z2V0TWFya1NwZWNpZmljQ29uZmlnTWl4aW5zfSBmcm9tICcuL2NvbW1vbic7XG5cblxuZXhwb3J0IGNvbnN0IEJPWFBMT1Q6ICdib3gtcGxvdCcgPSAnYm94LXBsb3QnO1xuZXhwb3J0IHR5cGUgQk9YUExPVCA9IHR5cGVvZiBCT1hQTE9UO1xuZXhwb3J0IHR5cGUgQm94UGxvdFN0eWxlID0gJ2JveFdoaXNrZXInIHwgJ2JveCcgfCAnYm94TWlkJztcblxuXG5leHBvcnQgaW50ZXJmYWNlIEJveFBsb3REZWYge1xuICAvKipcbiAgICogVHlwZSBvZiB0aGUgbWFyay4gIEZvciBib3ggcGxvdHMsIHRoaXMgc2hvdWxkIGFsd2F5cyBiZSBgXCJib3gtcGxvdFwiYC5cbiAgICogW2JveHBsb3RdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvY29tcG9zaXRlbWFyay5odG1sI2JveHBsb3QpXG4gICAqL1xuICB0eXBlOiBCT1hQTE9UO1xuXG4gIC8qKlxuICAgKiBPcmllbnRhdGlvbiBvZiB0aGUgYm94IHBsb3QuICBUaGlzIGlzIG5vcm1hbGx5IGF1dG9tYXRpY2FsbHkgZGV0ZXJtaW5lZCwgYnV0IGNhbiBiZSBzcGVjaWZpZWQgd2hlbiB0aGUgb3JpZW50YXRpb24gaXMgYW1iaWd1b3VzIGFuZCBjYW5ub3QgYmUgYXV0b21hdGljYWxseSBkZXRlcm1pbmVkLlxuICAgKi9cbiAgb3JpZW50PzogT3JpZW50O1xuXG4gIC8qKlxuICAgKiBFeHRlbnQgaXMgdXNlZCB0byBkZXRlcm1pbmUgd2hlcmUgdGhlIHdoaXNrZXJzIGV4dGVuZCB0by4gVGhlIG9wdGlvbnMgYXJlXG4gICAqIC0gYFwibWluLW1heFwiOiBtaW4gYW5kIG1heCBhcmUgdGhlIGxvd2VyIGFuZCB1cHBlciB3aGlza2VycyByZXNwZWN0aXZlbHkuXG4gICAqIC0gIEEgc2NhbGFyIChpbnRlZ2VyIG9yIGZsb2F0aW5nIHBvaW50IG51bWJlcikgdGhhdCB3aWxsIGJlIG11bHRpcGxpZWQgYnkgdGhlIElRUiBhbmQgdGhlIHByb2R1Y3Qgd2lsbCBiZSBhZGRlZCB0byB0aGUgdGhpcmQgcXVhcnRpbGUgdG8gZ2V0IHRoZSB1cHBlciB3aGlza2VyIGFuZCBzdWJ0cmFjdGVkIGZyb20gdGhlIGZpcnN0IHF1YXJ0aWxlIHRvIGdldCB0aGUgbG93ZXIgd2hpc2tlci5cbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBcIjEuNVwiYC5cbiAgICovXG4gIGV4dGVudD86ICdtaW4tbWF4JyB8IG51bWJlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQm94UGxvdERlZihtYXJrOiBCT1hQTE9UIHwgQm94UGxvdERlZik6IG1hcmsgaXMgQm94UGxvdERlZiB7XG4gIHJldHVybiAhIW1hcmtbJ3R5cGUnXTtcbn1cblxuZXhwb3J0IGNvbnN0IEJPWFBMT1RfU1RZTEVTOiBCb3hQbG90U3R5bGVbXSA9IFsnYm94V2hpc2tlcicsICdib3gnLCAnYm94TWlkJ107XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm94UGxvdENvbmZpZyBleHRlbmRzIE1hcmtDb25maWcge1xuICAvKiogU2l6ZSBvZiB0aGUgYm94IGFuZCBtaWQgdGljayBvZiBhIGJveCBwbG90ICovXG4gIHNpemU/OiBudW1iZXI7XG4gIC8qKiBUaGUgZGVmYXVsdCBleHRlbnQsIHdoaWNoIGlzIHVzZWQgdG8gZGV0ZXJtaW5lIHdoZXJlIHRoZSB3aGlza2VycyBleHRlbmQgdG8uIFRoZSBvcHRpb25zIGFyZVxuICAgKiAtIGBcIm1pbi1tYXhcIjogbWluIGFuZCBtYXggYXJlIHRoZSBsb3dlciBhbmQgdXBwZXIgd2hpc2tlcnMgcmVzcGVjdGl2ZWx5LlxuICAgKiAtIGBcIm51bWJlclwiOiBBIHNjYWxhciAoaW50ZWdlciBvciBmbG9hdGluZyBwb2ludCBudW1iZXIpIHRoYXQgd2lsbCBiZSBtdWx0aXBsaWVkIGJ5IHRoZSBJUVIgYW5kIHRoZSBwcm9kdWN0IHdpbGwgYmUgYWRkZWQgdG8gdGhlIHRoaXJkIHF1YXJ0aWxlIHRvIGdldCB0aGUgdXBwZXIgd2hpc2tlciBhbmQgc3VidHJhY3RlZCBmcm9tIHRoZSBmaXJzdCBxdWFydGlsZSB0byBnZXQgdGhlIGxvd2VyIHdoaXNrZXIuXG4gICAqL1xuICBleHRlbnQ/OiAnbWluLW1heCcgfCBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm94UGxvdENvbmZpZ01peGlucyB7XG4gIC8qKlxuICAgKiBCb3ggQ29uZmlnXG4gICAqIEBoaWRlXG4gICAqL1xuICBib3g/OiBCb3hQbG90Q29uZmlnO1xuXG4gIC8qKlxuICAgKiBAaGlkZVxuICAgKi9cbiAgYm94V2hpc2tlcj86IE1hcmtDb25maWc7XG5cbiAgLyoqXG4gICAqIEBoaWRlXG4gICAqL1xuICBib3hNaWQ/OiBNYXJrQ29uZmlnO1xufVxuXG5leHBvcnQgY29uc3QgVkxfT05MWV9CT1hQTE9UX0NPTkZJR19QUk9QRVJUWV9JTkRFWDoge1xuICBbayBpbiBrZXlvZiBCb3hQbG90Q29uZmlnTWl4aW5zXT86IChrZXlvZiBCb3hQbG90Q29uZmlnTWl4aW5zW2tdKVtdXG59ID0ge1xuICBib3g6IFsnc2l6ZScsICdjb2xvcicsICdleHRlbnQnXSxcbiAgYm94V2hpc2tlcjogWydjb2xvciddLFxuICBib3hNaWQ6IFsnY29sb3InXVxufTtcblxuY29uc3Qgc3VwcG9ydGVkQ2hhbm5lbHM6IENoYW5uZWxbXSA9IFsneCcsICd5JywgJ2NvbG9yJywgJ2RldGFpbCcsICdvcGFjaXR5JywgJ3NpemUnXTtcbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJVbnN1cHBvcnRlZENoYW5uZWxzKHNwZWM6IEdlbmVyaWNVbml0U3BlYzxFbmNvZGluZzxzdHJpbmc+LCBCT1hQTE9UIHwgQm94UGxvdERlZj4pOiBHZW5lcmljVW5pdFNwZWM8RW5jb2Rpbmc8c3RyaW5nPiwgQk9YUExPVCB8IEJveFBsb3REZWY+IHtcbiAgcmV0dXJuIHtcbiAgICAuLi5zcGVjLFxuICAgIGVuY29kaW5nOiByZWR1Y2Uoc3BlYy5lbmNvZGluZywgKG5ld0VuY29kaW5nLCBmaWVsZERlZiwgY2hhbm5lbCkgPT4ge1xuICAgICAgaWYgKHN1cHBvcnRlZENoYW5uZWxzLmluZGV4T2YoY2hhbm5lbCkgPiAtMSkge1xuICAgICAgICBuZXdFbmNvZGluZ1tjaGFubmVsXSA9IGZpZWxkRGVmO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuaW5jb21wYXRpYmxlQ2hhbm5lbChjaGFubmVsLCBCT1hQTE9UKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV3RW5jb2Rpbmc7XG4gICAgfSwge30pLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbm9ybWFsaXplQm94UGxvdChzcGVjOiBHZW5lcmljVW5pdFNwZWM8RW5jb2Rpbmc8c3RyaW5nPiwgQk9YUExPVCB8IEJveFBsb3REZWY+LCBjb25maWc6IENvbmZpZyk6IE5vcm1hbGl6ZWRMYXllclNwZWMge1xuICBzcGVjID0gZmlsdGVyVW5zdXBwb3J0ZWRDaGFubmVscyhzcGVjKTtcbiAgLy8gVE9ETzogdXNlIHNlbGVjdGlvblxuICBjb25zdCB7bWFyaywgZW5jb2RpbmcsIHNlbGVjdGlvbiwgcHJvamVjdGlvbjogX3AsIC4uLm91dGVyU3BlY30gPSBzcGVjO1xuXG4gIGxldCBrSVFSU2NhbGFyOiBudW1iZXIgPSB1bmRlZmluZWQ7XG4gIGlmIChpc051bWJlcihjb25maWcuYm94LmV4dGVudCkpIHtcbiAgICBrSVFSU2NhbGFyID0gY29uZmlnLmJveC5leHRlbnQ7XG4gIH1cblxuICBpZiAoaXNCb3hQbG90RGVmKG1hcmspKSB7XG4gICAgaWYgKG1hcmsuZXh0ZW50KSB7XG4gICAgICBpZihtYXJrLmV4dGVudCA9PT0gJ21pbi1tYXgnKSB7XG4gICAgICAgIGtJUVJTY2FsYXIgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgY29uc3Qgb3JpZW50OiBPcmllbnQgPSBib3hPcmllbnQoc3BlYyk7XG4gIGNvbnN0IHt0cmFuc2Zvcm0sIGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZiwgY29udGludW91c0F4aXMsIGVuY29kaW5nV2l0aG91dENvbnRpbnVvdXNBeGlzfSA9IGJveFBhcmFtcyhzcGVjLCBvcmllbnQsIGtJUVJTY2FsYXIpO1xuXG4gIGNvbnN0IHtjb2xvciwgc2l6ZSwgLi4uZW5jb2RpbmdXaXRob3V0U2l6ZUNvbG9yQW5kQ29udGludW91c0F4aXN9ID0gZW5jb2RpbmdXaXRob3V0Q29udGludW91c0F4aXM7XG5cbiAgLy8gU2l6ZSBlbmNvZGluZyBvciB0aGUgZGVmYXVsdCBjb25maWcuYm94LnNpemUgaXMgYXBwbGllZCB0byBib3ggYW5kIGJveE1pZFxuICBjb25zdCBzaXplTWl4aW5zID0gc2l6ZSA/IHtzaXplfSA6IGdldE1hcmtTcGVjaWZpY0NvbmZpZ01peGlucyhjb25maWcuYm94LCAnc2l6ZScpO1xuXG4gIGNvbnN0IGNvbnRpbnVvdXNBeGlzU2NhbGVBbmRBeGlzID0ge307XG4gIGlmIChjb250aW51b3VzQXhpc0NoYW5uZWxEZWYuc2NhbGUpIHtcbiAgICBjb250aW51b3VzQXhpc1NjYWxlQW5kQXhpc1snc2NhbGUnXSA9IGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi5zY2FsZTtcbiAgfVxuICBpZiAoY29udGludW91c0F4aXNDaGFubmVsRGVmLmF4aXMpIHtcbiAgICBjb250aW51b3VzQXhpc1NjYWxlQW5kQXhpc1snYXhpcyddID0gY29udGludW91c0F4aXNDaGFubmVsRGVmLmF4aXM7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIC4uLm91dGVyU3BlYyxcbiAgICB0cmFuc2Zvcm0sXG4gICAgbGF5ZXI6IFtcbiAgICAgIHsgLy8gbG93ZXIgd2hpc2tlclxuICAgICAgICBtYXJrOiB7XG4gICAgICAgICAgdHlwZTogJ3J1bGUnLFxuICAgICAgICAgIHN0eWxlOiAnYm94V2hpc2tlcidcbiAgICAgICAgfSxcbiAgICAgICAgZW5jb2Rpbmc6IHtcbiAgICAgICAgICBbY29udGludW91c0F4aXNdOiB7XG4gICAgICAgICAgICBmaWVsZDogJ2xvd2VyX3doaXNrZXJfJyArIGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi5maWVsZCxcbiAgICAgICAgICAgIHR5cGU6IGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi50eXBlLFxuICAgICAgICAgICAgLi4uY29udGludW91c0F4aXNTY2FsZUFuZEF4aXNcbiAgICAgICAgICB9LFxuICAgICAgICAgIFtjb250aW51b3VzQXhpcyArICcyJ106IHtcbiAgICAgICAgICAgIGZpZWxkOiAnbG93ZXJfYm94XycgKyBjb250aW51b3VzQXhpc0NoYW5uZWxEZWYuZmllbGQsXG4gICAgICAgICAgICB0eXBlOiBjb250aW51b3VzQXhpc0NoYW5uZWxEZWYudHlwZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgLi4uZW5jb2RpbmdXaXRob3V0U2l6ZUNvbG9yQW5kQ29udGludW91c0F4aXMsXG4gICAgICAgICAgLi4uZ2V0TWFya1NwZWNpZmljQ29uZmlnTWl4aW5zKGNvbmZpZy5ib3hXaGlza2VyLCAnY29sb3InKVxuICAgICAgICB9XG4gICAgICB9LCB7IC8vIHVwcGVyIHdoaXNrZXJcbiAgICAgICAgbWFyazoge1xuICAgICAgICAgIHR5cGU6ICdydWxlJyxcbiAgICAgICAgICBzdHlsZTogJ2JveFdoaXNrZXInXG4gICAgICAgIH0sXG4gICAgICAgIGVuY29kaW5nOiB7XG4gICAgICAgICAgW2NvbnRpbnVvdXNBeGlzXToge1xuICAgICAgICAgICAgZmllbGQ6ICd1cHBlcl9ib3hfJyArIGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi5maWVsZCxcbiAgICAgICAgICAgIHR5cGU6IGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi50eXBlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBbY29udGludW91c0F4aXMgKyAnMiddOiB7XG4gICAgICAgICAgICBmaWVsZDogJ3VwcGVyX3doaXNrZXJfJyArIGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi5maWVsZCxcbiAgICAgICAgICAgIHR5cGU6IGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi50eXBlXG4gICAgICAgICAgfSxcbiAgICAgICAgICAuLi5lbmNvZGluZ1dpdGhvdXRTaXplQ29sb3JBbmRDb250aW51b3VzQXhpcyxcbiAgICAgICAgICAuLi5nZXRNYXJrU3BlY2lmaWNDb25maWdNaXhpbnMoY29uZmlnLmJveFdoaXNrZXIsICdjb2xvcicpXG4gICAgICAgIH1cbiAgICAgIH0sIHsgLy8gYm94IChxMSB0byBxMylcbiAgICAgICAgLi4uKHNlbGVjdGlvbiA/IHtzZWxlY3Rpb259IDoge30pLFxuICAgICAgICBtYXJrOiB7XG4gICAgICAgICAgdHlwZTogJ2JhcicsXG4gICAgICAgICAgc3R5bGU6ICdib3gnXG4gICAgICAgIH0sXG4gICAgICAgIGVuY29kaW5nOiB7XG4gICAgICAgICAgW2NvbnRpbnVvdXNBeGlzXToge1xuICAgICAgICAgICAgZmllbGQ6ICdsb3dlcl9ib3hfJyArIGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi5maWVsZCxcbiAgICAgICAgICAgIHR5cGU6IGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi50eXBlXG4gICAgICAgICAgfSxcbiAgICAgICAgICBbY29udGludW91c0F4aXMgKyAnMiddOiB7XG4gICAgICAgICAgICBmaWVsZDogJ3VwcGVyX2JveF8nICsgY29udGludW91c0F4aXNDaGFubmVsRGVmLmZpZWxkLFxuICAgICAgICAgICAgdHlwZTogY29udGludW91c0F4aXNDaGFubmVsRGVmLnR5cGVcbiAgICAgICAgICB9LFxuICAgICAgICAgIC4uLmVuY29kaW5nV2l0aG91dENvbnRpbnVvdXNBeGlzLFxuICAgICAgICAgIC4uLihlbmNvZGluZ1dpdGhvdXRDb250aW51b3VzQXhpcy5jb2xvciA/IHt9IDogZ2V0TWFya1NwZWNpZmljQ29uZmlnTWl4aW5zKGNvbmZpZy5ib3gsICdjb2xvcicpKSxcbiAgICAgICAgICAuLi5zaXplTWl4aW5zLFxuICAgICAgICB9XG4gICAgICB9LCB7IC8vIG1pZCB0aWNrXG4gICAgICAgIG1hcms6IHtcbiAgICAgICAgICB0eXBlOiAndGljaycsXG4gICAgICAgICAgc3R5bGU6ICdib3hNaWQnXG4gICAgICAgIH0sXG4gICAgICAgIGVuY29kaW5nOiB7XG4gICAgICAgICAgW2NvbnRpbnVvdXNBeGlzXToge1xuICAgICAgICAgICAgZmllbGQ6ICdtaWRfYm94XycgKyBjb250aW51b3VzQXhpc0NoYW5uZWxEZWYuZmllbGQsXG4gICAgICAgICAgICB0eXBlOiBjb250aW51b3VzQXhpc0NoYW5uZWxEZWYudHlwZVxuICAgICAgICAgIH0sXG4gICAgICAgICAgLi4uZW5jb2RpbmdXaXRob3V0U2l6ZUNvbG9yQW5kQ29udGludW91c0F4aXMsXG4gICAgICAgICAgLi4uZ2V0TWFya1NwZWNpZmljQ29uZmlnTWl4aW5zKGNvbmZpZy5ib3hNaWQsICdjb2xvcicpLFxuICAgICAgICAgIC4uLnNpemVNaXhpbnMsXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBdXG4gIH07XG59XG5cbmZ1bmN0aW9uIGJveE9yaWVudChzcGVjOiBHZW5lcmljVW5pdFNwZWM8RW5jb2Rpbmc8RmllbGQ+LCBCT1hQTE9UIHwgQm94UGxvdERlZj4pOiBPcmllbnQge1xuICBjb25zdCB7bWFyazogbWFyaywgZW5jb2Rpbmc6IGVuY29kaW5nLCBwcm9qZWN0aW9uOiBfcCwgLi4uX291dGVyU3BlY30gPSBzcGVjO1xuXG4gIGlmIChpc0ZpZWxkRGVmKGVuY29kaW5nLngpICYmIGlzQ29udGludW91cyhlbmNvZGluZy54KSkge1xuICAgIC8vIHggaXMgY29udGludW91c1xuICAgIGlmIChpc0ZpZWxkRGVmKGVuY29kaW5nLnkpICYmIGlzQ29udGludW91cyhlbmNvZGluZy55KSkge1xuICAgICAgLy8gYm90aCB4IGFuZCB5IGFyZSBjb250aW51b3VzXG4gICAgICBpZiAoZW5jb2RpbmcueC5hZ2dyZWdhdGUgPT09IHVuZGVmaW5lZCAmJiBlbmNvZGluZy55LmFnZ3JlZ2F0ZSA9PT0gQk9YUExPVCkge1xuICAgICAgICByZXR1cm4gJ3ZlcnRpY2FsJztcbiAgICAgIH0gZWxzZSBpZiAoZW5jb2RpbmcueS5hZ2dyZWdhdGUgPT09IHVuZGVmaW5lZCAmJiBlbmNvZGluZy54LmFnZ3JlZ2F0ZSA9PT0gQk9YUExPVCkge1xuICAgICAgICByZXR1cm4gJ2hvcml6b250YWwnO1xuICAgICAgfSBlbHNlIGlmIChlbmNvZGluZy54LmFnZ3JlZ2F0ZSA9PT0gQk9YUExPVCAmJiBlbmNvZGluZy55LmFnZ3JlZ2F0ZSA9PT0gQk9YUExPVCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0JvdGggeCBhbmQgeSBjYW5ub3QgaGF2ZSBhZ2dyZWdhdGUnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChpc0JveFBsb3REZWYobWFyaykgJiYgbWFyay5vcmllbnQpIHtcbiAgICAgICAgICByZXR1cm4gbWFyay5vcmllbnQ7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBkZWZhdWx0IG9yaWVudGF0aW9uID0gdmVydGljYWxcbiAgICAgICAgcmV0dXJuICd2ZXJ0aWNhbCc7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8geCBpcyBjb250aW51b3VzIGJ1dCB5IGlzIG5vdFxuICAgIHJldHVybiAnaG9yaXpvbnRhbCc7XG4gIH0gZWxzZSBpZiAoaXNGaWVsZERlZihlbmNvZGluZy55KSAmJiBpc0NvbnRpbnVvdXMoZW5jb2RpbmcueSkpIHtcbiAgICAvLyB5IGlzIGNvbnRpbnVvdXMgYnV0IHggaXMgbm90XG4gICAgcmV0dXJuICd2ZXJ0aWNhbCc7XG4gIH0gZWxzZSB7XG4gICAgLy8gTmVpdGhlciB4IG5vciB5IGlzIGNvbnRpbnVvdXMuXG4gICAgdGhyb3cgbmV3IEVycm9yKCdOZWVkIGEgdmFsaWQgY29udGludW91cyBheGlzIGZvciBib3hwbG90cycpO1xuICB9XG59XG5cblxuZnVuY3Rpb24gYm94Q29udGlub3VzQXhpcyhzcGVjOiBHZW5lcmljVW5pdFNwZWM8RW5jb2Rpbmc8c3RyaW5nPiwgQk9YUExPVCB8IEJveFBsb3REZWY+LCBvcmllbnQ6IE9yaWVudCkge1xuICBjb25zdCB7bWFyazogbWFyaywgZW5jb2Rpbmc6IGVuY29kaW5nLCBwcm9qZWN0aW9uOiBfcCwgLi4uX291dGVyU3BlY30gPSBzcGVjO1xuXG4gIGxldCBjb250aW51b3VzQXhpc0NoYW5uZWxEZWY6IFBvc2l0aW9uRmllbGREZWY8c3RyaW5nPjtcbiAgbGV0IGNvbnRpbnVvdXNBeGlzOiAneCcgfCAneSc7XG5cbiAgaWYgKG9yaWVudCA9PT0gJ3ZlcnRpY2FsJykge1xuICAgIGNvbnRpbnVvdXNBeGlzID0gJ3knO1xuICAgIGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZiA9IGVuY29kaW5nLnkgYXMgRmllbGREZWY8c3RyaW5nPjsgLy8gU2FmZSB0byBjYXN0IGJlY2F1c2UgaWYgeSBpcyBub3QgY29udGludW91cyBmaWVsZGRlZiwgdGhlIG9yaWVudCB3b3VsZCBub3QgYmUgdmVydGljYWwuXG4gIH0gZWxzZSB7XG4gICAgY29udGludW91c0F4aXMgPSAneCc7XG4gICAgY29udGludW91c0F4aXNDaGFubmVsRGVmID0gZW5jb2RpbmcueCBhcyBGaWVsZERlZjxzdHJpbmc+OyAvLyBTYWZlIHRvIGNhc3QgYmVjYXVzZSBpZiB4IGlzIG5vdCBjb250aW51b3VzIGZpZWxkZGVmLCB0aGUgb3JpZW50IHdvdWxkIG5vdCBiZSBob3Jpem9udGFsLlxuICB9XG5cbiAgaWYgKGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZiAmJiBjb250aW51b3VzQXhpc0NoYW5uZWxEZWYuYWdncmVnYXRlKSB7XG4gICAgY29uc3Qge2FnZ3JlZ2F0ZSwgLi4uY29udGludW91c0F4aXNXaXRob3V0QWdncmVnYXRlfSA9IGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZjtcbiAgICBpZiAoYWdncmVnYXRlICE9PSBCT1hQTE9UKSB7XG4gICAgICBsb2cud2FybihgQ29udGludW91cyBheGlzIHNob3VsZCBub3QgaGF2ZSBjdXN0b21pemVkIGFnZ3JlZ2F0aW9uIGZ1bmN0aW9uICR7YWdncmVnYXRlfWApO1xuICAgIH1cbiAgICBjb250aW51b3VzQXhpc0NoYW5uZWxEZWYgPSBjb250aW51b3VzQXhpc1dpdGhvdXRBZ2dyZWdhdGU7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZixcbiAgICBjb250aW51b3VzQXhpc1xuICB9O1xufVxuXG5mdW5jdGlvbiBib3hQYXJhbXMoc3BlYzogR2VuZXJpY1VuaXRTcGVjPEVuY29kaW5nPHN0cmluZz4sIEJPWFBMT1QgfCBCb3hQbG90RGVmPiwgb3JpZW50OiBPcmllbnQsIGtJUVJTY2FsYXI6ICdtaW4tbWF4JyB8IG51bWJlcikge1xuXG4gIGNvbnN0IHtjb250aW51b3VzQXhpc0NoYW5uZWxEZWYsIGNvbnRpbnVvdXNBeGlzfSA9IGJveENvbnRpbm91c0F4aXMoc3BlYywgb3JpZW50KTtcbiAgY29uc3QgZW5jb2RpbmcgPSBzcGVjLmVuY29kaW5nO1xuXG4gIGNvbnN0IGlzTWluTWF4ID0ga0lRUlNjYWxhciA9PT0gdW5kZWZpbmVkO1xuICBjb25zdCBhZ2dyZWdhdGU6IEFnZ3JlZ2F0ZWRGaWVsZERlZltdID0gW1xuICAgIHtcbiAgICAgIG9wOiAncTEnLFxuICAgICAgZmllbGQ6IGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi5maWVsZCxcbiAgICAgIGFzOiAnbG93ZXJfYm94XycgKyBjb250aW51b3VzQXhpc0NoYW5uZWxEZWYuZmllbGRcbiAgICB9LFxuICAgIHtcbiAgICAgIG9wOiAncTMnLFxuICAgICAgZmllbGQ6IGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi5maWVsZCxcbiAgICAgIGFzOiAndXBwZXJfYm94XycgKyBjb250aW51b3VzQXhpc0NoYW5uZWxEZWYuZmllbGRcbiAgICB9LFxuICAgIHtcbiAgICAgIG9wOiAnbWVkaWFuJyxcbiAgICAgIGZpZWxkOiBjb250aW51b3VzQXhpc0NoYW5uZWxEZWYuZmllbGQsXG4gICAgICBhczogJ21pZF9ib3hfJyArIGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi5maWVsZFxuICAgIH1cbiAgXTtcbiAgbGV0IHBvc3RBZ2dyZWdhdGVDYWxjdWxhdGVzOiBDYWxjdWxhdGVUcmFuc2Zvcm1bXSA9IFtdO1xuXG4gIGFnZ3JlZ2F0ZS5wdXNoKHtcbiAgICBvcDogJ21pbicsXG4gICAgZmllbGQ6IGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi5maWVsZCxcbiAgICBhczogKGlzTWluTWF4ID8gJ2xvd2VyX3doaXNrZXJfJyA6ICdtaW5fJykgKyBjb250aW51b3VzQXhpc0NoYW5uZWxEZWYuZmllbGRcbiAgfSk7XG4gIGFnZ3JlZ2F0ZS5wdXNoKHtcbiAgICBvcDogJ21heCcsXG4gICAgZmllbGQ6IGNvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi5maWVsZCxcbiAgICBhczogIChpc01pbk1heCA/ICd1cHBlcl93aGlza2VyXycgOiAnbWF4XycpICsgY29udGludW91c0F4aXNDaGFubmVsRGVmLmZpZWxkXG4gIH0pO1xuXG4gIGlmICghaXNNaW5NYXgpIHtcbiAgICBwb3N0QWdncmVnYXRlQ2FsY3VsYXRlcyA9IFtcbiAgICAgIHtcbiAgICAgICAgY2FsY3VsYXRlOiBgZGF0dW0udXBwZXJfYm94XyR7Y29udGludW91c0F4aXNDaGFubmVsRGVmLmZpZWxkfSAtIGRhdHVtLmxvd2VyX2JveF8ke2NvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi5maWVsZH1gLFxuICAgICAgICBhczogJ2lxcl8nICsgY29udGludW91c0F4aXNDaGFubmVsRGVmLmZpZWxkXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBjYWxjdWxhdGU6IGBtaW4oZGF0dW0udXBwZXJfYm94XyR7Y29udGludW91c0F4aXNDaGFubmVsRGVmLmZpZWxkfSArIGRhdHVtLmlxcl8ke2NvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi5maWVsZH0gKiAke2tJUVJTY2FsYXJ9LCBkYXR1bS5tYXhfJHtjb250aW51b3VzQXhpc0NoYW5uZWxEZWYuZmllbGR9KWAsXG4gICAgICAgIGFzOiAndXBwZXJfd2hpc2tlcl8nICsgY29udGludW91c0F4aXNDaGFubmVsRGVmLmZpZWxkXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBjYWxjdWxhdGU6IGBtYXgoZGF0dW0ubG93ZXJfYm94XyR7Y29udGludW91c0F4aXNDaGFubmVsRGVmLmZpZWxkfSAtIGRhdHVtLmlxcl8ke2NvbnRpbnVvdXNBeGlzQ2hhbm5lbERlZi5maWVsZH0gKiAke2tJUVJTY2FsYXJ9LCBkYXR1bS5taW5fJHtjb250aW51b3VzQXhpc0NoYW5uZWxEZWYuZmllbGR9KWAsXG4gICAgICAgIGFzOiAnbG93ZXJfd2hpc2tlcl8nICsgY29udGludW91c0F4aXNDaGFubmVsRGVmLmZpZWxkXG4gICAgICB9XG4gICAgXTtcbiAgfVxuXG4gIGNvbnN0IGdyb3VwYnk6IHN0cmluZ1tdID0gW107XG4gIGNvbnN0IGJpbnM6IEJpblRyYW5zZm9ybVtdID0gW107XG4gIGNvbnN0IHRpbWVVbml0czogVGltZVVuaXRUcmFuc2Zvcm1bXSA9IFtdO1xuXG4gIGNvbnN0IGVuY29kaW5nV2l0aG91dENvbnRpbnVvdXNBeGlzOiBFbmNvZGluZzxzdHJpbmc+ID0ge307XG4gIGZvckVhY2goZW5jb2RpbmcsIChjaGFubmVsRGVmLCBjaGFubmVsKSA9PiB7XG4gICAgaWYgKGNoYW5uZWwgPT09IGNvbnRpbnVvdXNBeGlzKSB7XG4gICAgICAvLyBTa2lwIGNvbnRpbnVvdXMgYXhpcyBhcyB3ZSBhbHJlYWR5IGhhbmRsZSBpdCBzZXBhcmF0ZWx5XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChpc0ZpZWxkRGVmKGNoYW5uZWxEZWYpKSB7XG4gICAgICBpZiAoY2hhbm5lbERlZi5hZ2dyZWdhdGUgJiYgY2hhbm5lbERlZi5hZ2dyZWdhdGUgIT09IEJPWFBMT1QpIHtcbiAgICAgICAgYWdncmVnYXRlLnB1c2goe1xuICAgICAgICAgIG9wOiBjaGFubmVsRGVmLmFnZ3JlZ2F0ZSxcbiAgICAgICAgICBmaWVsZDogY2hhbm5lbERlZi5maWVsZCxcbiAgICAgICAgICBhczogdmdGaWVsZChjaGFubmVsRGVmKVxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSBpZiAoY2hhbm5lbERlZi5hZ2dyZWdhdGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb25zdCB0cmFuc2Zvcm1lZEZpZWxkID0gdmdGaWVsZChjaGFubmVsRGVmKTtcblxuICAgICAgICAvLyBBZGQgYmluIG9yIHRpbWVVbml0IHRyYW5zZm9ybSBpZiBhcHBsaWNhYmxlXG4gICAgICAgIGNvbnN0IGJpbiA9IGNoYW5uZWxEZWYuYmluO1xuICAgICAgICBpZiAoYmluKSB7XG4gICAgICAgICAgY29uc3Qge2ZpZWxkfSA9IGNoYW5uZWxEZWY7XG4gICAgICAgICAgYmlucy5wdXNoKHtiaW4sIGZpZWxkLCBhczogdHJhbnNmb3JtZWRGaWVsZH0pO1xuICAgICAgICB9IGVsc2UgaWYgKGNoYW5uZWxEZWYudGltZVVuaXQpIHtcbiAgICAgICAgICBjb25zdCB7dGltZVVuaXQsIGZpZWxkfSA9IGNoYW5uZWxEZWY7XG4gICAgICAgICAgdGltZVVuaXRzLnB1c2goe3RpbWVVbml0LCBmaWVsZCwgYXM6IHRyYW5zZm9ybWVkRmllbGR9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdyb3VwYnkucHVzaCh0cmFuc2Zvcm1lZEZpZWxkKTtcbiAgICAgIH1cbiAgICAgIC8vIG5vdyB0aGUgZmllbGQgc2hvdWxkIHJlZmVyIHRvIHBvc3QtdHJhbnNmb3JtZWQgZmllbGQgaW5zdGVhZFxuICAgICAgZW5jb2RpbmdXaXRob3V0Q29udGludW91c0F4aXNbY2hhbm5lbF0gPSB7XG4gICAgICAgIGZpZWxkOiB2Z0ZpZWxkKGNoYW5uZWxEZWYpLFxuICAgICAgICB0eXBlOiBjaGFubmVsRGVmLnR5cGVcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEZvciB2YWx1ZSBkZWYsIGp1c3QgY29weVxuICAgICAgZW5jb2RpbmdXaXRob3V0Q29udGludW91c0F4aXNbY2hhbm5lbF0gPSBlbmNvZGluZ1tjaGFubmVsXTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgdHJhbnNmb3JtOiBbXS5jb25jYXQoXG4gICAgICBiaW5zLFxuICAgICAgdGltZVVuaXRzLFxuICAgICAgW3thZ2dyZWdhdGUsIGdyb3VwYnl9XSxcbiAgICAgIHBvc3RBZ2dyZWdhdGVDYWxjdWxhdGVzXG4gICAgKSxcbiAgICBjb250aW51b3VzQXhpc0NoYW5uZWxEZWYsXG4gICAgY29udGludW91c0F4aXMsXG4gICAgZW5jb2RpbmdXaXRob3V0Q29udGludW91c0F4aXNcbiAgfTtcbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nexport var ERRORBAR = 'error-bar';\nexport function normalizeErrorBar(spec) {\n    // TODO: use selection\n    var _m = spec.mark, _sel = spec.selection, _p = spec.projection, encoding = spec.encoding, outerSpec = tslib_1.__rest(spec, [\"mark\", \"selection\", \"projection\", \"encoding\"]);\n    var _s = encoding.size, encodingWithoutSize = tslib_1.__rest(encoding, [\"size\"]);\n    var _x2 = encoding.x2, _y2 = encoding.y2, encodingWithoutX2Y2 = tslib_1.__rest(encoding, [\"x2\", \"y2\"]);\n    var _x = encodingWithoutX2Y2.x, _y = encodingWithoutX2Y2.y, encodingWithoutX_X2_Y_Y2 = tslib_1.__rest(encodingWithoutX2Y2, [\"x\", \"y\"]);\n    if (!encoding.x2 && !encoding.y2) {\n        throw new Error('Neither x2 or y2 provided');\n    }\n    return tslib_1.__assign({}, outerSpec, { layer: [\n            {\n                mark: 'rule',\n                encoding: encodingWithoutSize\n            }, {\n                mark: 'tick',\n                encoding: encodingWithoutX2Y2\n            }, {\n                mark: 'tick',\n                encoding: encoding.x2 ? tslib_1.__assign({ x: encoding.x2, y: encoding.y }, encodingWithoutX_X2_Y_Y2) : tslib_1.__assign({ x: encoding.x, y: encoding.y2 }, encodingWithoutX_X2_Y_Y2)\n            }\n        ] });\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXJyb3JiYXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29tcG9zaXRlbWFyay9lcnJvcmJhci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBS0EsTUFBTSxDQUFDLElBQU0sUUFBUSxHQUFnQixXQUFXLENBQUM7QUFHakQsTUFBTSw0QkFBNEIsSUFBZ0Q7SUFDaEYsc0JBQXNCO0lBQ2YsSUFBQSxjQUFRLEVBQUUscUJBQWUsRUFBRSxvQkFBYyxFQUFFLHdCQUFRLEVBQUUsaUZBQVksQ0FBUztJQUMxRSxJQUFBLGtCQUFRLEVBQUUsd0RBQXNCLENBQWE7SUFDN0MsSUFBQSxpQkFBTyxFQUFFLGlCQUFPLEVBQUUsNERBQXNCLENBQWE7SUFDckQsSUFBQSwwQkFBSyxFQUFFLDBCQUFLLEVBQUUsMEVBQTJCLENBQXdCO0lBRXhFLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsRUFBRTtRQUNoQyxNQUFNLElBQUksS0FBSyxDQUFDLDJCQUEyQixDQUFDLENBQUM7S0FDOUM7SUFFRCw0QkFDSyxTQUFTLElBQ1osS0FBSyxFQUFFO1lBQ0w7Z0JBQ0UsSUFBSSxFQUFFLE1BQU07Z0JBQ1osUUFBUSxFQUFFLG1CQUFtQjthQUM5QixFQUFDO2dCQUNBLElBQUksRUFBRSxNQUFNO2dCQUNaLFFBQVEsRUFBRSxtQkFBbUI7YUFDOUIsRUFBRTtnQkFDRCxJQUFJLEVBQUUsTUFBTTtnQkFDWixRQUFRLEVBQUUsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDLG9CQUNyQixDQUFDLEVBQUUsUUFBUSxDQUFDLEVBQUUsRUFDZCxDQUFDLEVBQUUsUUFBUSxDQUFDLENBQUMsSUFDVix3QkFBd0IsRUFDM0IsQ0FBQyxvQkFDRCxDQUFDLEVBQUUsUUFBUSxDQUFDLENBQUMsRUFDYixDQUFDLEVBQUUsUUFBUSxDQUFDLEVBQUUsSUFDWCx3QkFBd0IsQ0FDNUI7YUFDRjtTQUNGLElBQ0Q7QUFDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtGaWVsZH0gZnJvbSAnLi4vZmllbGRkZWYnO1xuaW1wb3J0IHtFbmNvZGluZ30gZnJvbSAnLi8uLi9lbmNvZGluZyc7XG5pbXBvcnQge0dlbmVyaWNVbml0U3BlYywgTm9ybWFsaXplZExheWVyU3BlY30gZnJvbSAnLi8uLi9zcGVjJztcblxuXG5leHBvcnQgY29uc3QgRVJST1JCQVI6ICdlcnJvci1iYXInID0gJ2Vycm9yLWJhcic7XG5leHBvcnQgdHlwZSBFUlJPUkJBUiA9IHR5cGVvZiBFUlJPUkJBUjtcblxuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZUVycm9yQmFyKHNwZWM6IEdlbmVyaWNVbml0U3BlYzxFbmNvZGluZzxGaWVsZD4sIEVSUk9SQkFSPik6IE5vcm1hbGl6ZWRMYXllclNwZWMge1xuICAvLyBUT0RPOiB1c2Ugc2VsZWN0aW9uXG4gIGNvbnN0IHttYXJrOiBfbSwgc2VsZWN0aW9uOiBfc2VsLCBwcm9qZWN0aW9uOiBfcCwgZW5jb2RpbmcsIC4uLm91dGVyU3BlY30gPSBzcGVjO1xuICBjb25zdCB7c2l6ZTogX3MsIC4uLmVuY29kaW5nV2l0aG91dFNpemV9ID0gZW5jb2Rpbmc7XG4gIGNvbnN0IHt4MjogX3gyLCB5MjogX3kyLCAuLi5lbmNvZGluZ1dpdGhvdXRYMlkyfSA9IGVuY29kaW5nO1xuICBjb25zdCB7eDogX3gsIHk6IF95LCAuLi5lbmNvZGluZ1dpdGhvdXRYX1gyX1lfWTJ9ID0gZW5jb2RpbmdXaXRob3V0WDJZMjtcblxuICBpZiAoIWVuY29kaW5nLngyICYmICFlbmNvZGluZy55Mikge1xuICAgIHRocm93IG5ldyBFcnJvcignTmVpdGhlciB4MiBvciB5MiBwcm92aWRlZCcpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICAuLi5vdXRlclNwZWMsXG4gICAgbGF5ZXI6IFtcbiAgICAgIHtcbiAgICAgICAgbWFyazogJ3J1bGUnLFxuICAgICAgICBlbmNvZGluZzogZW5jb2RpbmdXaXRob3V0U2l6ZVxuICAgICAgfSx7IC8vIExvd2VyIHRpY2tcbiAgICAgICAgbWFyazogJ3RpY2snLFxuICAgICAgICBlbmNvZGluZzogZW5jb2RpbmdXaXRob3V0WDJZMlxuICAgICAgfSwgeyAvLyBVcHBlciB0aWNrXG4gICAgICAgIG1hcms6ICd0aWNrJyxcbiAgICAgICAgZW5jb2Rpbmc6IGVuY29kaW5nLngyID8ge1xuICAgICAgICAgIHg6IGVuY29kaW5nLngyLFxuICAgICAgICAgIHk6IGVuY29kaW5nLnksXG4gICAgICAgICAgLi4uZW5jb2RpbmdXaXRob3V0WF9YMl9ZX1kyXG4gICAgICAgIH0gOiB7XG4gICAgICAgICAgeDogZW5jb2RpbmcueCxcbiAgICAgICAgICB5OiBlbmNvZGluZy55MixcbiAgICAgICAgICAuLi5lbmNvZGluZ1dpdGhvdXRYX1gyX1lfWTJcbiAgICAgICAgfVxuICAgICAgfVxuICAgIF1cbiAgfTtcbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { isMarkDef } from './../mark';\nimport { BOXPLOT, normalizeBoxPlot, VL_ONLY_BOXPLOT_CONFIG_PROPERTY_INDEX } from './boxplot';\nimport { ERRORBAR, normalizeErrorBar } from './errorbar';\n// This package import below makes the generated .d.ts file compatible with\n// Typescript 2.7 so that libraries requiring us can use Typedoc (which\n// currently is limited to Typescript 2.7). This comment and import can be\n// removed when Typedoc is updated to Typescript 2.9 or later. See\n// https://github.com/vega/vega-lite/issues/3862 for more details.\nimport * as boxplot from './boxplot';\n/**\n * Registry index for all composite mark's normalizer\n */\nvar normalizerRegistry = {};\nexport function add(mark, normalizer) {\n    normalizerRegistry[mark] = normalizer;\n}\nexport function remove(mark) {\n    delete normalizerRegistry[mark];\n}\nexport var COMPOSITE_MARK_STYLES = boxplot.BOXPLOT_STYLES;\nexport var VL_ONLY_COMPOSITE_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX = tslib_1.__assign({}, VL_ONLY_BOXPLOT_CONFIG_PROPERTY_INDEX);\nadd(BOXPLOT, normalizeBoxPlot);\nadd(ERRORBAR, normalizeErrorBar);\n/**\n * Transform a unit spec with composite mark into a normal layer spec.\n */\nexport function normalize(\n// This GenericUnitSpec has any as Encoding because unit specs with composite mark can have additional encoding channels.\nspec, config) {\n    var mark = isMarkDef(spec.mark) ? spec.mark.type : spec.mark;\n    var normalizer = normalizerRegistry[mark];\n    if (normalizer) {\n        return normalizer(spec, config);\n    }\n    throw new Error(\"Invalid mark type \\\"\" + mark + \"\\\"\");\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29tcG9zaXRlbWFyay9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQ0EsT0FBTyxFQUFVLFNBQVMsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUU3QyxPQUFPLEVBQUMsT0FBTyxFQUFtQyxnQkFBZ0IsRUFBRSxxQ0FBcUMsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUM1SCxPQUFPLEVBQUMsUUFBUSxFQUFFLGlCQUFpQixFQUFDLE1BQU0sWUFBWSxDQUFDO0FBRXZELDJFQUEyRTtBQUMzRSx1RUFBdUU7QUFDdkUsMEVBQTBFO0FBQzFFLGtFQUFrRTtBQUNsRSxrRUFBa0U7QUFDbEUsT0FBTyxLQUFLLE9BQU8sTUFBTSxXQUFXLENBQUM7QUFLckM7O0dBRUc7QUFDSCxJQUFNLGtCQUFrQixHQUFxQyxFQUFFLENBQUM7QUFFaEUsTUFBTSxjQUFjLElBQVksRUFBRSxVQUEwQjtJQUMxRCxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsR0FBRyxVQUFVLENBQUM7QUFDeEMsQ0FBQztBQUVELE1BQU0saUJBQWlCLElBQVk7SUFDakMsT0FBTyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNsQyxDQUFDO0FBUUQsTUFBTSxDQUFDLElBQU0scUJBQXFCLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQztBQUs1RCxNQUFNLENBQUMsSUFBTSxxREFBcUQsd0JBQzdELHFDQUFxQyxDQUN6QyxDQUFDO0FBRUYsR0FBRyxDQUFDLE9BQU8sRUFBRSxnQkFBZ0IsQ0FBQyxDQUFDO0FBQy9CLEdBQUcsQ0FBQyxRQUFRLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztBQUVqQzs7R0FFRztBQUNILE1BQU07QUFDRix5SEFBeUg7QUFDekgsSUFBbUMsRUFDbkMsTUFBYztJQUdoQixJQUFNLElBQUksR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztJQUMvRCxJQUFNLFVBQVUsR0FBRyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUM1QyxJQUFJLFVBQVUsRUFBRTtRQUNkLE9BQU8sVUFBVSxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsQ0FBQztLQUNqQztJQUVELE1BQU0sSUFBSSxLQUFLLENBQUMseUJBQXNCLElBQUksT0FBRyxDQUFDLENBQUM7QUFDakQsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29uZmlnfSBmcm9tICcuLy4uL2NvbmZpZyc7XG5pbXBvcnQge0FueU1hcmssIGlzTWFya0RlZn0gZnJvbSAnLi8uLi9tYXJrJztcbmltcG9ydCB7R2VuZXJpY1VuaXRTcGVjLCBOb3JtYWxpemVkTGF5ZXJTcGVjfSBmcm9tICcuLy4uL3NwZWMnO1xuaW1wb3J0IHtCT1hQTE9ULCBCb3hQbG90Q29uZmlnTWl4aW5zLCBCb3hQbG90RGVmLCBub3JtYWxpemVCb3hQbG90LCBWTF9PTkxZX0JPWFBMT1RfQ09ORklHX1BST1BFUlRZX0lOREVYfSBmcm9tICcuL2JveHBsb3QnO1xuaW1wb3J0IHtFUlJPUkJBUiwgbm9ybWFsaXplRXJyb3JCYXJ9IGZyb20gJy4vZXJyb3JiYXInO1xuXG4vLyBUaGlzIHBhY2thZ2UgaW1wb3J0IGJlbG93IG1ha2VzIHRoZSBnZW5lcmF0ZWQgLmQudHMgZmlsZSBjb21wYXRpYmxlIHdpdGhcbi8vIFR5cGVzY3JpcHQgMi43IHNvIHRoYXQgbGlicmFyaWVzIHJlcXVpcmluZyB1cyBjYW4gdXNlIFR5cGVkb2MgKHdoaWNoXG4vLyBjdXJyZW50bHkgaXMgbGltaXRlZCB0byBUeXBlc2NyaXB0IDIuNykuIFRoaXMgY29tbWVudCBhbmQgaW1wb3J0IGNhbiBiZVxuLy8gcmVtb3ZlZCB3aGVuIFR5cGVkb2MgaXMgdXBkYXRlZCB0byBUeXBlc2NyaXB0IDIuOSBvciBsYXRlci4gU2VlXG4vLyBodHRwczovL2dpdGh1Yi5jb20vdmVnYS92ZWdhLWxpdGUvaXNzdWVzLzM4NjIgZm9yIG1vcmUgZGV0YWlscy5cbmltcG9ydCAqIGFzIGJveHBsb3QgZnJvbSAnLi9ib3hwbG90JztcblxuZXhwb3J0IHtCb3hQbG90Q29uZmlnfSBmcm9tICcuL2JveHBsb3QnO1xuZXhwb3J0IHR5cGUgVW5pdE5vcm1hbGl6ZXIgPSAoc3BlYzogR2VuZXJpY1VuaXRTcGVjPGFueSwgYW55PiwgY29uZmlnOiBDb25maWcpPT4gTm9ybWFsaXplZExheWVyU3BlYztcblxuLyoqXG4gKiBSZWdpc3RyeSBpbmRleCBmb3IgYWxsIGNvbXBvc2l0ZSBtYXJrJ3Mgbm9ybWFsaXplclxuICovXG5jb25zdCBub3JtYWxpemVyUmVnaXN0cnk6IHtbbWFyazogc3RyaW5nXTogVW5pdE5vcm1hbGl6ZXJ9ID0ge307XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGQobWFyazogc3RyaW5nLCBub3JtYWxpemVyOiBVbml0Tm9ybWFsaXplcikge1xuICBub3JtYWxpemVyUmVnaXN0cnlbbWFya10gPSBub3JtYWxpemVyO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlKG1hcms6IHN0cmluZykge1xuICBkZWxldGUgbm9ybWFsaXplclJlZ2lzdHJ5W21hcmtdO1xufVxuXG5leHBvcnQgdHlwZSBDb21wb3NpdGVNYXJrID0gQk9YUExPVCB8IEVSUk9SQkFSO1xuXG5leHBvcnQgdHlwZSBDb21wb3NpdGVNYXJrRGVmID0gQm94UGxvdERlZjtcblxuZXhwb3J0IHR5cGUgQ29tcG9zaXRlQWdncmVnYXRlID0gQk9YUExPVDtcblxuZXhwb3J0IGNvbnN0IENPTVBPU0lURV9NQVJLX1NUWUxFUyA9IGJveHBsb3QuQk9YUExPVF9TVFlMRVM7XG5leHBvcnQgdHlwZSBDb21wb3NpdGVNYXJrU3R5bGUgPSB0eXBlb2YgQ09NUE9TSVRFX01BUktfU1RZTEVTWzBdO1xuXG5leHBvcnQgaW50ZXJmYWNlIENvbXBvc2l0ZU1hcmtDb25maWdNaXhpbnMgZXh0ZW5kcyBCb3hQbG90Q29uZmlnTWl4aW5zIHt9XG5cbmV4cG9ydCBjb25zdCBWTF9PTkxZX0NPTVBPU0lURV9NQVJLX1NQRUNJRklDX0NPTkZJR19QUk9QRVJUWV9JTkRFWCA9IHtcbiAgLi4uVkxfT05MWV9CT1hQTE9UX0NPTkZJR19QUk9QRVJUWV9JTkRFWFxufTtcblxuYWRkKEJPWFBMT1QsIG5vcm1hbGl6ZUJveFBsb3QpO1xuYWRkKEVSUk9SQkFSLCBub3JtYWxpemVFcnJvckJhcik7XG5cbi8qKlxuICogVHJhbnNmb3JtIGEgdW5pdCBzcGVjIHdpdGggY29tcG9zaXRlIG1hcmsgaW50byBhIG5vcm1hbCBsYXllciBzcGVjLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbm9ybWFsaXplKFxuICAgIC8vIFRoaXMgR2VuZXJpY1VuaXRTcGVjIGhhcyBhbnkgYXMgRW5jb2RpbmcgYmVjYXVzZSB1bml0IHNwZWNzIHdpdGggY29tcG9zaXRlIG1hcmsgY2FuIGhhdmUgYWRkaXRpb25hbCBlbmNvZGluZyBjaGFubmVscy5cbiAgICBzcGVjOiBHZW5lcmljVW5pdFNwZWM8YW55LCBBbnlNYXJrPixcbiAgICBjb25maWc6IENvbmZpZ1xuICApOiBOb3JtYWxpemVkTGF5ZXJTcGVjIHtcblxuICBjb25zdCBtYXJrID0gaXNNYXJrRGVmKHNwZWMubWFyaykgPyBzcGVjLm1hcmsudHlwZSA6IHNwZWMubWFyaztcbiAgY29uc3Qgbm9ybWFsaXplciA9IG5vcm1hbGl6ZXJSZWdpc3RyeVttYXJrXTtcbiAgaWYgKG5vcm1hbGl6ZXIpIHtcbiAgICByZXR1cm4gbm9ybWFsaXplcihzcGVjLCBjb25maWcpO1xuICB9XG5cbiAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIG1hcmsgdHlwZSBcIiR7bWFya31cImApO1xufVxuIl19","export var VL_ONLY_GUIDE_CONFIG = ['shortTimeLabels'];\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3VpZGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvZ3VpZGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBMkNBLE1BQU0sQ0FBQyxJQUFNLG9CQUFvQixHQUFnQyxDQUFDLGlCQUFpQixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NvbmRpdGlvblZhbHVlRGVmTWl4aW5zLCBWYWx1ZURlZn0gZnJvbSAnLi9maWVsZGRlZic7XG5pbXBvcnQge1ZnRW5jb2RlQ2hhbm5lbH0gZnJvbSAnLi92ZWdhLnNjaGVtYSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGl0bGVNaXhpbnMge1xuICAvKipcbiAgICogQSB0aXRsZSBmb3IgdGhlIGZpZWxkLiBJZiBgbnVsbGAsIHRoZSB0aXRsZSB3aWxsIGJlIHJlbW92ZWQuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyAgZGVyaXZlZCBmcm9tIHRoZSBmaWVsZCdzIG5hbWUgYW5kIHRyYW5zZm9ybWF0aW9uIGZ1bmN0aW9uIChgYWdncmVnYXRlYCwgYGJpbmAgYW5kIGB0aW1lVW5pdGApLiAgSWYgdGhlIGZpZWxkIGhhcyBhbiBhZ2dyZWdhdGUgZnVuY3Rpb24sIHRoZSBmdW5jdGlvbiBpcyBkaXNwbGF5ZWQgYXMgcGFydCBvZiB0aGUgdGl0bGUgKGUuZy4sIGBcIlN1bSBvZiBQcm9maXRcImApLiBJZiB0aGUgZmllbGQgaXMgYmlubmVkIG9yIGhhcyBhIHRpbWUgdW5pdCBhcHBsaWVkLCB0aGUgYXBwbGllZCBmdW5jdGlvbiBpcyBzaG93biBpbiBwYXJlbnRoZXNlcyAoZS5nLiwgYFwiUHJvZml0IChiaW5uZWQpXCJgLCBgXCJUcmFuc2FjdGlvbiBEYXRlICh5ZWFyLW1vbnRoKVwiYCkuICBPdGhlcndpc2UsIHRoZSB0aXRsZSBpcyBzaW1wbHkgdGhlIGZpZWxkIG5hbWUuXG4gICAqXG4gICAqIF9fTm90ZXNfXzpcbiAgICpcbiAgICogMSkgWW91IGNhbiBjdXN0b21pemUgdGhlIGRlZmF1bHQgZmllbGQgdGl0bGUgZm9ybWF0IGJ5IHByb3ZpZGluZyB0aGUgW2BmaWVsZFRpdGxlYCBwcm9wZXJ0eSBpbiB0aGUgW2NvbmZpZ10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9jb25maWcuaHRtbCkgb3IgW2BmaWVsZFRpdGxlYCBmdW5jdGlvbiB2aWEgdGhlIGBjb21waWxlYCBmdW5jdGlvbidzIG9wdGlvbnNdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvY29tcGlsZS5odG1sI2ZpZWxkLXRpdGxlKS5cbiAgICpcbiAgICogMikgSWYgYm90aCBmaWVsZCBkZWZpbml0aW9uJ3MgYHRpdGxlYCBhbmQgYXhpcywgaGVhZGVyLCBvciBsZWdlbmQgYHRpdGxlYCBhcmUgZGVmaW5lZCwgYXhpcy9oZWFkZXIvbGVnZW5kIHRpdGxlIHdpbGwgYmUgdXNlZC5cbiAgICovXG4gIHRpdGxlPzogc3RyaW5nIHwgbnVsbDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBHdWlkZSBleHRlbmRzIFRpdGxlTWl4aW5zIHtcbiAgLyoqXG4gICAqIFRoZSBmb3JtYXR0aW5nIHBhdHRlcm4gZm9yIGxhYmVscy4gVGhpcyBpcyBEMydzIFtudW1iZXIgZm9ybWF0IHBhdHRlcm5dKGh0dHBzOi8vZ2l0aHViLmNvbS9kMy9kMy1mb3JtYXQjbG9jYWxlX2Zvcm1hdCkgZm9yIHF1YW50aXRhdGl2ZSBmaWVsZHMgYW5kIEQzJ3MgW3RpbWUgZm9ybWF0IHBhdHRlcm5dKGh0dHBzOi8vZ2l0aHViLmNvbS9kMy9kMy10aW1lLWZvcm1hdCNsb2NhbGVfZm9ybWF0KSBmb3IgdGltZSBmaWVsZC5cbiAgICpcbiAgICogU2VlIHRoZSBbZm9ybWF0IGRvY3VtZW50YXRpb25dKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvZm9ybWF0Lmh0bWwpIGZvciBtb3JlIGluZm9ybWF0aW9uLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gIGRlcml2ZWQgZnJvbSBbbnVtYmVyRm9ybWF0XShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL2NvbmZpZy5odG1sI2Zvcm1hdCkgY29uZmlnIGZvciBxdWFudGl0YXRpdmUgZmllbGRzIGFuZCBmcm9tIFt0aW1lRm9ybWF0XShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL2NvbmZpZy5odG1sI2Zvcm1hdCkgY29uZmlnIGZvciB0ZW1wb3JhbCBmaWVsZHMuXG4gICAqL1xuICBmb3JtYXQ/OiBzdHJpbmc7XG59XG5leHBvcnQgaW50ZXJmYWNlIFZsT25seUd1aWRlQ29uZmlnIHtcblxuICAvKipcbiAgICogV2hldGhlciBtb250aCBuYW1lcyBhbmQgd2Vla2RheSBuYW1lcyBzaG91bGQgYmUgYWJicmV2aWF0ZWQuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyAgYGZhbHNlYFxuICAgKi9cbiAgc2hvcnRUaW1lTGFiZWxzPzogYm9vbGVhbjtcbn1cblxuXG5leHBvcnQgdHlwZSBHdWlkZUVuY29kaW5nRW50cnkgPSB7XG4gIFtrIGluIFZnRW5jb2RlQ2hhbm5lbF0/OiBWYWx1ZURlZiAmIENvbmRpdGlvblZhbHVlRGVmTWl4aW5zO1xufTtcblxuZXhwb3J0IGNvbnN0IFZMX09OTFlfR1VJREVfQ09ORklHOiAoa2V5b2YgVmxPbmx5R3VpZGVDb25maWcpW10gPSBbJ3Nob3J0VGltZUxhYmVscyddO1xuIl19","import * as tslib_1 from \"tslib\";\nimport { flagKeys } from './util';\nexport var defaultLegendConfig = {};\nvar COMMON_LEGEND_PROPERTY_INDEX = {\n    entryPadding: 1,\n    format: 1,\n    offset: 1,\n    orient: 1,\n    padding: 1,\n    tickCount: 1,\n    title: 1,\n    type: 1,\n    values: 1,\n    zindex: 1\n};\nvar VG_LEGEND_PROPERTY_INDEX = tslib_1.__assign({}, COMMON_LEGEND_PROPERTY_INDEX, { \n    // channel scales\n    opacity: 1, shape: 1, stroke: 1, fill: 1, size: 1, \n    // encode\n    encode: 1 });\nexport var LEGEND_PROPERTIES = flagKeys(COMMON_LEGEND_PROPERTY_INDEX);\nexport var VG_LEGEND_PROPERTIES = flagKeys(VG_LEGEND_PROPERTY_INDEX);\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGVnZW5kLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2xlZ2VuZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBRUEsT0FBTyxFQUFPLFFBQVEsRUFBQyxNQUFNLFFBQVEsQ0FBQztBQXdFdEMsTUFBTSxDQUFDLElBQU0sbUJBQW1CLEdBQWlCLEVBQUUsQ0FBQztBQUVwRCxJQUFNLDRCQUE0QixHQUFvQztJQUNwRSxZQUFZLEVBQUUsQ0FBQztJQUNmLE1BQU0sRUFBRSxDQUFDO0lBQ1QsTUFBTSxFQUFFLENBQUM7SUFDVCxNQUFNLEVBQUUsQ0FBQztJQUNULE9BQU8sRUFBRSxDQUFDO0lBQ1YsU0FBUyxFQUFFLENBQUM7SUFDWixLQUFLLEVBQUUsQ0FBQztJQUNSLElBQUksRUFBRSxDQUFDO0lBQ1AsTUFBTSxFQUFFLENBQUM7SUFDVCxNQUFNLEVBQUUsQ0FBQztDQUNWLENBQUM7QUFFRixJQUFNLHdCQUF3Qix3QkFDekIsNEJBQTRCO0lBQy9CLGlCQUFpQjtJQUNqQixPQUFPLEVBQUUsQ0FBQyxFQUNWLEtBQUssRUFBRSxDQUFDLEVBQ1IsTUFBTSxFQUFFLENBQUMsRUFDVCxJQUFJLEVBQUUsQ0FBQyxFQUNQLElBQUksRUFBRSxDQUFDO0lBQ1AsU0FBUztJQUNULE1BQU0sRUFBRSxDQUFDLEdBQ1YsQ0FBQztBQUVGLE1BQU0sQ0FBQyxJQUFNLGlCQUFpQixHQUFHLFFBQVEsQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO0FBRXhFLE1BQU0sQ0FBQyxJQUFNLG9CQUFvQixHQUFHLFFBQVEsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtEYXRlVGltZX0gZnJvbSAnLi9kYXRldGltZSc7XG5pbXBvcnQge0d1aWRlLCBHdWlkZUVuY29kaW5nRW50cnksIFZsT25seUd1aWRlQ29uZmlnfSBmcm9tICcuL2d1aWRlJztcbmltcG9ydCB7RmxhZywgZmxhZ0tleXN9IGZyb20gJy4vdXRpbCc7XG5pbXBvcnQge1ZnTGVnZW5kLCBWZ0xlZ2VuZEJhc2UsIFZnTGVnZW5kQ29uZmlnfSBmcm9tICcuL3ZlZ2Euc2NoZW1hJztcblxuXG5leHBvcnQgaW50ZXJmYWNlIExlZ2VuZENvbmZpZyBleHRlbmRzIFZnTGVnZW5kQ29uZmlnLCBWbE9ubHlHdWlkZUNvbmZpZyB7fVxuXG4vKipcbiAqIFByb3BlcnRpZXMgb2YgYSBsZWdlbmQgb3IgYm9vbGVhbiBmbGFnIGZvciBkZXRlcm1pbmluZyB3aGV0aGVyIHRvIHNob3cgaXQuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTGVnZW5kIGV4dGVuZHMgVmdMZWdlbmRCYXNlLCBHdWlkZSB7XG4gIC8qKlxuICAgKiBNYXJrIGRlZmluaXRpb25zIGZvciBjdXN0b20gbGVnZW5kIGVuY29kaW5nLlxuICAgKlxuICAgKiBAaGlkZVxuICAgKi9cbiAgZW5jb2Rpbmc/OiBMZWdlbmRFbmNvZGluZztcblxuICAvKipcbiAgICogVGhlIGRlc2lyZWQgbnVtYmVyIG9mIHRpY2sgdmFsdWVzIGZvciBxdWFudGl0YXRpdmUgbGVnZW5kcy5cbiAgICovXG4gIHRpY2tDb3VudD86IG51bWJlcjtcblxuICAvKipcbiAgICogRXhwbGljaXRseSBzZXQgdGhlIHZpc2libGUgbGVnZW5kIHZhbHVlcy5cbiAgICovXG4gIHZhbHVlcz86IG51bWJlcltdIHwgc3RyaW5nW10gfCBEYXRlVGltZVtdO1xuXG4gIC8qKlxuICAgKiBUaGUgdHlwZSBvZiB0aGUgbGVnZW5kLiBVc2UgYFwic3ltYm9sXCJgIHRvIGNyZWF0ZSBhIGRpc2NyZXRlIGxlZ2VuZCBhbmQgYFwiZ3JhZGllbnRcImAgZm9yIGEgY29udGludW91cyBjb2xvciBncmFkaWVudC5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBcImdyYWRpZW50XCJgIGZvciBub24tYmlubmVkIHF1YW50aXRhdGl2ZSBmaWVsZHMgYW5kIHRlbXBvcmFsIGZpZWxkczsgYFwic3ltYm9sXCJgIG90aGVyd2lzZS5cbiAgICovXG4gIHR5cGU/OiAnc3ltYm9sJyB8ICdncmFkaWVudCc7XG5cbiAgLyoqXG4gICAqIEEgbm9uLXBvc2l0aXZlIGludGVnZXIgaW5kaWNhdGluZyB6LWluZGV4IG9mIHRoZSBsZWdlbmQuXG4gICAqIElmIHppbmRleCBpcyAwLCBsZWdlbmQgc2hvdWxkIGJlIGRyYXduIGJlaGluZCBhbGwgY2hhcnQgZWxlbWVudHMuXG4gICAqIFRvIHB1dCB0aGVtIGluIGZyb250LCB1c2UgemluZGV4ID0gMS5cbiAgICogQFRKUy10eXBlIGludGVnZXJcbiAgICogQG1pbmltdW0gMFxuICAgKi9cbiAgemluZGV4PzogbnVtYmVyO1xufVxuXG5leHBvcnQgdHlwZSBMZWdlbmRFbmNvZGluZyA9IHtcbiAgLyoqXG4gICAqIEN1c3RvbSBlbmNvZGluZyBmb3IgdGhlIGxlZ2VuZCBjb250YWluZXIuXG4gICAqIFRoaXMgY2FuIGJlIHVzZWZ1bCBmb3IgY3JlYXRpbmcgbGVnZW5kIHdpdGggY3VzdG9tIHgsIHkgcG9zaXRpb24uXG4gICAqL1xuICBsZWdlbmQ/OiBHdWlkZUVuY29kaW5nRW50cnk7XG5cbiAgLyoqXG4gICAqIEN1c3RvbSBlbmNvZGluZyBmb3IgdGhlIGxlZ2VuZCB0aXRsZSB0ZXh0IG1hcmsuXG4gICAqL1xuICB0aXRsZT86IEd1aWRlRW5jb2RpbmdFbnRyeTtcblxuICAvKipcbiAgICogQ3VzdG9tIGVuY29kaW5nIGZvciBsZWdlbmQgbGFiZWwgdGV4dCBtYXJrcy5cbiAgICovXG4gIGxhYmVscz86IEd1aWRlRW5jb2RpbmdFbnRyeTtcblxuICAvKipcbiAgICogQ3VzdG9tIGVuY29kaW5nIGZvciBsZWdlbmQgc3ltYm9sIG1hcmtzLlxuICAgKi9cbiAgc3ltYm9scz86IEd1aWRlRW5jb2RpbmdFbnRyeTtcblxuICAvKipcbiAgICogQ3VzdG9tIGVuY29kaW5nIGZvciBsZWdlbmQgZ3JhZGllbnQgZmlsbGVkIHJlY3QgbWFya3MuXG4gICAqL1xuICBncmFkaWVudD86IEd1aWRlRW5jb2RpbmdFbnRyeTtcbn07XG5cbmV4cG9ydCBjb25zdCBkZWZhdWx0TGVnZW5kQ29uZmlnOiBMZWdlbmRDb25maWcgPSB7fTtcblxuY29uc3QgQ09NTU9OX0xFR0VORF9QUk9QRVJUWV9JTkRFWDogRmxhZzxrZXlvZiAoVmdMZWdlbmQgfCBMZWdlbmQpPiA9IHtcbiAgZW50cnlQYWRkaW5nOiAxLFxuICBmb3JtYXQ6IDEsXG4gIG9mZnNldDogMSxcbiAgb3JpZW50OiAxLFxuICBwYWRkaW5nOiAxLFxuICB0aWNrQ291bnQ6IDEsXG4gIHRpdGxlOiAxLFxuICB0eXBlOiAxLFxuICB2YWx1ZXM6IDEsXG4gIHppbmRleDogMVxufTtcblxuY29uc3QgVkdfTEVHRU5EX1BST1BFUlRZX0lOREVYOiBGbGFnPGtleW9mIFZnTGVnZW5kPiA9IHtcbiAgLi4uQ09NTU9OX0xFR0VORF9QUk9QRVJUWV9JTkRFWCxcbiAgLy8gY2hhbm5lbCBzY2FsZXNcbiAgb3BhY2l0eTogMSxcbiAgc2hhcGU6IDEsXG4gIHN0cm9rZTogMSxcbiAgZmlsbDogMSxcbiAgc2l6ZTogMSxcbiAgLy8gZW5jb2RlXG4gIGVuY29kZTogMVxufTtcblxuZXhwb3J0IGNvbnN0IExFR0VORF9QUk9QRVJUSUVTID0gZmxhZ0tleXMoQ09NTU9OX0xFR0VORF9QUk9QRVJUWV9JTkRFWCk7XG5cbmV4cG9ydCBjb25zdCBWR19MRUdFTkRfUFJPUEVSVElFUyA9IGZsYWdLZXlzKFZHX0xFR0VORF9QUk9QRVJUWV9JTkRFWCk7XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { toSet } from 'vega-util';\nimport { Channel, CHANNELS, isColorChannel } from './channel';\nimport * as log from './log';\nimport { Type, TYPE_INDEX } from './type';\nimport { contains, flagKeys, keys } from './util';\nexport var ScaleType;\n(function (ScaleType) {\n    // Continuous - Quantitative\n    ScaleType.LINEAR = 'linear';\n    ScaleType.BIN_LINEAR = 'bin-linear';\n    ScaleType.LOG = 'log';\n    ScaleType.POW = 'pow';\n    ScaleType.SQRT = 'sqrt';\n    // Continuous - Time\n    ScaleType.TIME = 'time';\n    ScaleType.UTC = 'utc';\n    // sequential\n    ScaleType.SEQUENTIAL = 'sequential';\n    // Quantile, Quantize, threshold\n    ScaleType.QUANTILE = 'quantile';\n    ScaleType.QUANTIZE = 'quantize';\n    ScaleType.THRESHOLD = 'threshold';\n    ScaleType.ORDINAL = 'ordinal';\n    ScaleType.BIN_ORDINAL = 'bin-ordinal';\n    ScaleType.POINT = 'point';\n    ScaleType.BAND = 'band';\n})(ScaleType || (ScaleType = {}));\n/**\n * Index for scale categories -- only scale of the same categories can be merged together.\n * Current implementation is trying to be conservative and avoid merging scale type that might not work together\n */\nvar SCALE_CATEGORY_INDEX = {\n    linear: 'numeric',\n    log: 'numeric',\n    pow: 'numeric',\n    sqrt: 'numeric',\n    'bin-linear': 'bin-linear',\n    time: 'time',\n    utc: 'time',\n    sequential: 'sequential',\n    ordinal: 'ordinal',\n    'bin-ordinal': 'bin-ordinal',\n    point: 'ordinal-position',\n    band: 'ordinal-position'\n};\nexport var SCALE_TYPES = keys(SCALE_CATEGORY_INDEX);\n/**\n * Whether the two given scale types can be merged together.\n */\nexport function scaleCompatible(scaleType1, scaleType2) {\n    var scaleCategory1 = SCALE_CATEGORY_INDEX[scaleType1];\n    var scaleCategory2 = SCALE_CATEGORY_INDEX[scaleType2];\n    return scaleCategory1 === scaleCategory2 ||\n        (scaleCategory1 === 'ordinal-position' && scaleCategory2 === 'time') ||\n        (scaleCategory2 === 'ordinal-position' && scaleCategory1 === 'time');\n}\n/**\n * Index for scale precedence -- high score = higher priority for merging.\n */\nvar SCALE_PRECEDENCE_INDEX = {\n    // numeric\n    linear: 0,\n    log: 1,\n    pow: 1,\n    sqrt: 1,\n    // time\n    time: 0,\n    utc: 0,\n    // ordinal-position -- these have higher precedence than continuous scales as they support more types of data\n    point: 10,\n    band: 11,\n    // non grouped types\n    'bin-linear': 0,\n    sequential: 0,\n    ordinal: 0,\n    'bin-ordinal': 0,\n};\n/**\n * Return scale categories -- only scale of the same categories can be merged together.\n */\nexport function scaleTypePrecedence(scaleType) {\n    return SCALE_PRECEDENCE_INDEX[scaleType];\n}\nexport var CONTINUOUS_TO_CONTINUOUS_SCALES = ['linear', 'bin-linear', 'log', 'pow', 'sqrt', 'time', 'utc'];\nvar CONTINUOUS_TO_CONTINUOUS_INDEX = toSet(CONTINUOUS_TO_CONTINUOUS_SCALES);\nexport var CONTINUOUS_DOMAIN_SCALES = CONTINUOUS_TO_CONTINUOUS_SCALES.concat(['sequential' /* TODO add 'quantile', 'quantize', 'threshold'*/]);\nvar CONTINUOUS_DOMAIN_INDEX = toSet(CONTINUOUS_DOMAIN_SCALES);\nexport var DISCRETE_DOMAIN_SCALES = ['ordinal', 'bin-ordinal', 'point', 'band'];\nvar DISCRETE_DOMAIN_INDEX = toSet(DISCRETE_DOMAIN_SCALES);\nvar BIN_SCALES_INDEX = toSet(['bin-linear', 'bin-ordinal']);\nexport var TIME_SCALE_TYPES = ['time', 'utc'];\nexport function hasDiscreteDomain(type) {\n    return type in DISCRETE_DOMAIN_INDEX;\n}\nexport function isBinScale(type) {\n    return type in BIN_SCALES_INDEX;\n}\nexport function hasContinuousDomain(type) {\n    return type in CONTINUOUS_DOMAIN_INDEX;\n}\nexport function isContinuousToContinuous(type) {\n    return type in CONTINUOUS_TO_CONTINUOUS_INDEX;\n}\nexport var defaultScaleConfig = {\n    textXRangeStep: 90,\n    rangeStep: 21,\n    pointPadding: 0.5,\n    bandPaddingInner: 0.1,\n    facetSpacing: 16,\n    minBandSize: 2,\n    minFontSize: 8,\n    maxFontSize: 40,\n    minOpacity: 0.3,\n    maxOpacity: 0.8,\n    // FIXME: revise if these *can* become ratios of rangeStep\n    minSize: 9,\n    minStrokeWidth: 1,\n    maxStrokeWidth: 4\n};\nexport function isExtendedScheme(scheme) {\n    return scheme && !!scheme['name'];\n}\nexport function isSelectionDomain(domain) {\n    return domain && domain['selection'];\n}\nvar SCALE_PROPERTY_INDEX = {\n    type: 1,\n    domain: 1,\n    range: 1,\n    rangeStep: 1,\n    scheme: 1,\n    // Other properties\n    reverse: 1,\n    round: 1,\n    // quantitative / time\n    clamp: 1,\n    nice: 1,\n    // quantitative\n    base: 1,\n    exponent: 1,\n    interpolate: 1,\n    zero: 1,\n    // band/point\n    padding: 1,\n    paddingInner: 1,\n    paddingOuter: 1\n};\nexport var SCALE_PROPERTIES = flagKeys(SCALE_PROPERTY_INDEX);\nvar type = SCALE_PROPERTY_INDEX.type, domain = SCALE_PROPERTY_INDEX.domain, range = SCALE_PROPERTY_INDEX.range, rangeStep = SCALE_PROPERTY_INDEX.rangeStep, scheme = SCALE_PROPERTY_INDEX.scheme, NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTY_INDEX = tslib_1.__rest(SCALE_PROPERTY_INDEX, [\"type\", \"domain\", \"range\", \"rangeStep\", \"scheme\"]);\nexport var NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES = flagKeys(NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTY_INDEX);\nexport var SCALE_TYPE_INDEX = generateScaleTypeIndex();\nexport function scaleTypeSupportProperty(scaleType, propName) {\n    switch (propName) {\n        case 'type':\n        case 'domain':\n        case 'reverse':\n        case 'range':\n            return true;\n        case 'scheme':\n            return contains(['sequential', 'ordinal', 'bin-ordinal', 'quantile', 'quantize'], scaleType);\n        case 'interpolate':\n            // FIXME(https://github.com/vega/vega-lite/issues/2902) how about ordinal?\n            return contains(['linear', 'bin-linear', 'pow', 'log', 'sqrt', 'utc', 'time'], scaleType);\n        case 'round':\n            return isContinuousToContinuous(scaleType) || scaleType === 'band' || scaleType === 'point';\n        case 'padding':\n            return isContinuousToContinuous(scaleType) || contains(['point', 'band'], scaleType);\n        case 'paddingOuter':\n        case 'rangeStep':\n            return contains(['point', 'band'], scaleType);\n        case 'paddingInner':\n            return scaleType === 'band';\n        case 'clamp':\n            return isContinuousToContinuous(scaleType) || scaleType === 'sequential';\n        case 'nice':\n            return isContinuousToContinuous(scaleType) || scaleType === 'sequential' || scaleType === 'quantize';\n        case 'exponent':\n            return scaleType === 'pow';\n        case 'base':\n            return scaleType === 'log';\n        case 'zero':\n            return hasContinuousDomain(scaleType) && !contains([\n                'log',\n                'time', 'utc',\n                'bin-linear',\n                'threshold',\n                'quantile' // quantile depends on distribution so zero does not matter\n            ], scaleType);\n    }\n    /* istanbul ignore next: should never reach here*/\n    throw new Error(\"Invalid scale property \" + propName + \".\");\n}\n/**\n * Returns undefined if the input channel supports the input scale property name\n */\nexport function channelScalePropertyIncompatability(channel, propName) {\n    switch (propName) {\n        case 'interpolate':\n        case 'scheme':\n            if (!isColorChannel(channel)) {\n                return log.message.cannotUseScalePropertyWithNonColor(channel);\n            }\n            return undefined;\n        case 'type':\n        case 'domain':\n        case 'range':\n        case 'base':\n        case 'exponent':\n        case 'nice':\n        case 'padding':\n        case 'paddingInner':\n        case 'paddingOuter':\n        case 'rangeStep':\n        case 'reverse':\n        case 'round':\n        case 'clamp':\n        case 'zero':\n            return undefined; // GOOD!\n    }\n    /* istanbul ignore next: it should never reach here */\n    throw new Error(\"Invalid scale property \\\"\" + propName + \"\\\".\");\n}\nexport function scaleTypeSupportDataType(specifiedType, fieldDefType, bin) {\n    if (contains([Type.ORDINAL, Type.NOMINAL], fieldDefType)) {\n        return specifiedType === undefined || hasDiscreteDomain(specifiedType);\n    }\n    else if (fieldDefType === Type.TEMPORAL) {\n        return contains([ScaleType.TIME, ScaleType.UTC, ScaleType.SEQUENTIAL, undefined], specifiedType);\n    }\n    else if (fieldDefType === Type.QUANTITATIVE) {\n        if (bin) {\n            return contains([ScaleType.BIN_LINEAR, ScaleType.BIN_ORDINAL, ScaleType.LINEAR], specifiedType);\n        }\n        return contains([ScaleType.LOG, ScaleType.POW, ScaleType.SQRT, ScaleType.QUANTILE, ScaleType.QUANTIZE, ScaleType.LINEAR, ScaleType.SEQUENTIAL, undefined], specifiedType);\n    }\n    return true;\n}\nexport function channelSupportScaleType(channel, scaleType) {\n    switch (channel) {\n        case Channel.X:\n        case Channel.Y:\n        case Channel.SIZE: // TODO: size and opacity can support ordinal with more modification\n        case Channel.OPACITY:\n            // Although it generally doesn't make sense to use band with size and opacity,\n            // it can also work since we use band: 0.5 to get midpoint.\n            return isContinuousToContinuous(scaleType) || contains(['band', 'point'], scaleType);\n        case Channel.COLOR:\n        case Channel.FILL:\n        case Channel.STROKE:\n            return scaleType !== 'band'; // band does not make sense with color\n        case Channel.SHAPE:\n            return scaleType === 'ordinal'; // shape = lookup only\n    }\n    /* istanbul ignore next: it should never reach here */\n    return false;\n}\nexport function getSupportedScaleType(channel, fieldDefType, bin) {\n    return SCALE_TYPE_INDEX[generateScaleTypeIndexKey(channel, fieldDefType, bin)];\n}\n// generates ScaleTypeIndex where keys are encoding channels and values are list of valid ScaleTypes\nfunction generateScaleTypeIndex() {\n    var index = {};\n    for (var _i = 0, CHANNELS_1 = CHANNELS; _i < CHANNELS_1.length; _i++) {\n        var channel = CHANNELS_1[_i];\n        for (var _a = 0, _b = keys(TYPE_INDEX); _a < _b.length; _a++) {\n            var fieldDefType = _b[_a];\n            for (var _c = 0, SCALE_TYPES_1 = SCALE_TYPES; _c < SCALE_TYPES_1.length; _c++) {\n                var scaleType = SCALE_TYPES_1[_c];\n                for (var _d = 0, _e = [false, true]; _d < _e.length; _d++) {\n                    var bin = _e[_d];\n                    var key = generateScaleTypeIndexKey(channel, fieldDefType, bin);\n                    if (channelSupportScaleType(channel, scaleType) && scaleTypeSupportDataType(scaleType, fieldDefType, bin)) {\n                        index[key] = index[key] || [];\n                        index[key].push(scaleType);\n                    }\n                }\n            }\n        }\n    }\n    return index;\n}\nfunction generateScaleTypeIndexKey(channel, fieldDefType, bin) {\n    var key = channel + '_' + fieldDefType;\n    return bin ? key + '_bin' : key;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NhbGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvc2NhbGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBQyxLQUFLLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFFaEMsT0FBTyxFQUFDLE9BQU8sRUFBRSxRQUFRLEVBQUUsY0FBYyxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBRTVELE9BQU8sS0FBSyxHQUFHLE1BQU0sT0FBTyxDQUFDO0FBQzdCLE9BQU8sRUFBQyxJQUFJLEVBQUUsVUFBVSxFQUFDLE1BQU0sUUFBUSxDQUFDO0FBQ3hDLE9BQU8sRUFBQyxRQUFRLEVBQVEsUUFBUSxFQUFFLElBQUksRUFBQyxNQUFNLFFBQVEsQ0FBQztBQUd0RCxNQUFNLEtBQVcsU0FBUyxDQXNCekI7QUF0QkQsV0FBaUIsU0FBUztJQUN4Qiw0QkFBNEI7SUFDZixnQkFBTSxHQUFhLFFBQVEsQ0FBQztJQUM1QixvQkFBVSxHQUFpQixZQUFZLENBQUM7SUFDeEMsYUFBRyxHQUFVLEtBQUssQ0FBQztJQUNuQixhQUFHLEdBQVUsS0FBSyxDQUFDO0lBQ25CLGNBQUksR0FBVyxNQUFNLENBQUM7SUFDbkMsb0JBQW9CO0lBQ1AsY0FBSSxHQUFXLE1BQU0sQ0FBQztJQUN0QixhQUFHLEdBQVUsS0FBSyxDQUFDO0lBQ2hDLGFBQWE7SUFDQSxvQkFBVSxHQUFpQixZQUFZLENBQUM7SUFFckQsZ0NBQWdDO0lBQ25CLGtCQUFRLEdBQWUsVUFBVSxDQUFDO0lBQ2xDLGtCQUFRLEdBQWUsVUFBVSxDQUFDO0lBQ2xDLG1CQUFTLEdBQWdCLFdBQVcsQ0FBQztJQUVyQyxpQkFBTyxHQUFjLFNBQVMsQ0FBQztJQUMvQixxQkFBVyxHQUFrQixhQUFhLENBQUM7SUFDM0MsZUFBSyxHQUFZLE9BQU8sQ0FBQztJQUN6QixjQUFJLEdBQVcsTUFBTSxDQUFDO0FBQ3JDLENBQUMsRUF0QmdCLFNBQVMsS0FBVCxTQUFTLFFBc0J6QjtBQVVEOzs7R0FHRztB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LEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDO0FBQ2xDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge3RvU2V0fSBmcm9tICd2ZWdhLXV0aWwnO1xuaW1wb3J0IHtCaW5QYXJhbXN9IGZyb20gJy4vYmluJztcbmltcG9ydCB7Q2hhbm5lbCwgQ0hBTk5FTFMsIGlzQ29sb3JDaGFubmVsfSBmcm9tICcuL2NoYW5uZWwnO1xuaW1wb3J0IHtEYXRlVGltZX0gZnJvbSAnLi9kYXRldGltZSc7XG5pbXBvcnQgKiBhcyBsb2cgZnJvbSAnLi9sb2cnO1xuaW1wb3J0IHtUeXBlLCBUWVBFX0lOREVYfSBmcm9tICcuL3R5cGUnO1xuaW1wb3J0IHtjb250YWlucywgRmxhZywgZmxhZ0tleXMsIGtleXN9IGZyb20gJy4vdXRpbCc7XG5pbXBvcnQge1NjYWxlSW50ZXJwb2xhdGUsIFNjYWxlSW50ZXJwb2xhdGVQYXJhbXN9IGZyb20gJy4vdmVnYS5zY2hlbWEnO1xuXG5leHBvcnQgbmFtZXNwYWNlIFNjYWxlVHlwZSB7XG4gIC8vIENvbnRpbnVvdXMgLSBRdWFudGl0YXRpdmVcbiAgZXhwb3J0IGNvbnN0IExJTkVBUjogJ2xpbmVhcicgPSAnbGluZWFyJztcbiAgZXhwb3J0IGNvbnN0IEJJTl9MSU5FQVI6ICdiaW4tbGluZWFyJyA9ICdiaW4tbGluZWFyJztcbiAgZXhwb3J0IGNvbnN0IExPRzogJ2xvZycgPSAnbG9nJztcbiAgZXhwb3J0IGNvbnN0IFBPVzogJ3BvdycgPSAncG93JztcbiAgZXhwb3J0IGNvbnN0IFNRUlQ6ICdzcXJ0JyA9ICdzcXJ0JztcbiAgLy8gQ29udGludW91cyAtIFRpbWVcbiAgZXhwb3J0IGNvbnN0IFRJTUU6ICd0aW1lJyA9ICd0aW1lJztcbiAgZXhwb3J0IGNvbnN0IFVUQzogJ3V0YycgPSAndXRjJztcbiAgLy8gc2VxdWVudGlhbFxuICBleHBvcnQgY29uc3QgU0VRVUVOVElBTDogJ3NlcXVlbnRpYWwnID0gJ3NlcXVlbnRpYWwnO1xuXG4gIC8vIFF1YW50aWxlLCBRdWFudGl6ZSwgdGhyZXNob2xkXG4gIGV4cG9ydCBjb25zdCBRVUFOVElMRTogJ3F1YW50aWxlJyA9ICdxdWFudGlsZSc7XG4gIGV4cG9ydCBjb25zdCBRVUFOVElaRTogJ3F1YW50aXplJyA9ICdxdWFudGl6ZSc7XG4gIGV4cG9ydCBjb25zdCBUSFJFU0hPTEQ6ICd0aHJlc2hvbGQnID0gJ3RocmVzaG9sZCc7XG5cbiAgZXhwb3J0IGNvbnN0IE9SRElOQUw6ICdvcmRpbmFsJyA9ICdvcmRpbmFsJztcbiAgZXhwb3J0IGNvbnN0IEJJTl9PUkRJTkFMOiAnYmluLW9yZGluYWwnID0gJ2Jpbi1vcmRpbmFsJztcbiAgZXhwb3J0IGNvbnN0IFBPSU5UOiAncG9pbnQnID0gJ3BvaW50JztcbiAgZXhwb3J0IGNvbnN0IEJBTkQ6ICdiYW5kJyA9ICdiYW5kJztcbn1cblxuZXhwb3J0IHR5cGUgU2NhbGVUeXBlID0gdHlwZW9mIFNjYWxlVHlwZS5MSU5FQVIgfCB0eXBlb2YgU2NhbGVUeXBlLkJJTl9MSU5FQVIgfFxuICB0eXBlb2YgU2NhbGVUeXBlLkxPRyB8IHR5cGVvZiBTY2FsZVR5cGUuUE9XIHwgdHlwZW9mIFNjYWxlVHlwZS5TUVJUIHxcbiAgdHlwZW9mIFNjYWxlVHlwZS5USU1FIHwgdHlwZW9mIFNjYWxlVHlwZS5VVEMgfFxuICAvLyBUT0RPOiBhZGQgJ3F1YW50aXplJywgJ3F1YW50aWxlJywgJ3RocmVzaG9sZCcgYmFjayB3aGVuIHdlIHJlYWxseSBzdXBwb3J0IHRoZW1cbiAgdHlwZW9mIFNjYWxlVHlwZS5TRVFVRU5USUFMIHwgLy8gdHlwZW9mIFNjYWxlVHlwZS5RVUFOVElMRSB8IHR5cGVvZiBTY2FsZVR5cGUuUVVBTlRJWkUgfCB0eXBlb2YgU2NhbGVUeXBlLlRIUkVTSE9MRCB8XG4gIHR5cGVvZiBTY2FsZVR5cGUuT1JESU5BTCB8IHR5cGVvZiBTY2FsZVR5cGUuQklOX09SRElOQUwgfCB0eXBlb2YgU2NhbGVUeXBlLlBPSU5UIHwgdHlwZW9mIFNjYWxlVHlwZS5CQU5EO1xuXG5cbi8qKlxuICogSW5kZXggZm9yIHNjYWxlIGNhdGVnb3JpZXMgLS0gb25seSBzY2FsZSBvZiB0aGUgc2FtZSBjYXRlZ29yaWVzIGNhbiBiZSBtZXJnZWQgdG9nZXRoZXIuXG4gKiBDdXJyZW50IGltcGxlbWVudGF0aW9uIGlzIHRyeWluZyB0byBiZSBjb25zZXJ2YXRpdmUgYW5kIGF2b2lkIG1lcmdpbmcgc2NhbGUgdHlwZSB0aGF0IG1pZ2h0IG5vdCB3b3JrIHRvZ2V0aGVyXG4gKi9cbmNvbnN0IFNDQUxFX0NBVEVHT1JZX0lOREVYOiB7XG4gIC8vIFVzaW5nIE1hcHBlZCBUeXBlIHRvIGRlY2xhcmUgdHlwZSAoaHR0cHM6Ly93d3cudHlwZXNjcmlwdGxhbmcub3JnL2RvY3MvaGFuZGJvb2svYWR2YW5jZWQtdHlwZXMuaHRtbCNtYXBwZWQtdHlwZXMpXG4gIFtrIGluIFNjYWxlVHlwZV06IFNjYWxlVHlwZSB8ICdudW1lcmljJyB8ICdvcmRpbmFsLXBvc2l0aW9uJ1xufSA9IHtcbiAgbGluZWFyOiAnbnVtZXJpYycsXG4gIGxvZzogJ251bWVyaWMnLFxuICBwb3c6ICdudW1lcmljJyxcbiAgc3FydDogJ251bWVyaWMnLFxuICAnYmluLWxpbmVhcic6ICdiaW4tbGluZWFyJywgLy8gVE9ETzogc2hvdWxkIGJpbi1saW5lYXIgc3VwcG9ydCBtZXJnaW5nIHdpdGggb3RoZXJcbiAgdGltZTogJ3RpbWUnLFxuICB1dGM6ICd0aW1lJyxcbiAgc2VxdWVudGlhbDogJ3NlcXVlbnRpYWwnLFxuICBvcmRpbmFsOiAnb3JkaW5hbCcsXG4gICdiaW4tb3JkaW5hbCc6ICdiaW4tb3JkaW5hbCcsIC8vIFRPRE86IHNob3VsZCBiaW4tb3JkaW5hbCBzdXBwb3J0IG1lcmdpbmcgd2l0aCBvdGhlclxuICBwb2ludDogJ29yZGluYWwtcG9zaXRpb24nLFxuICBiYW5kOiAnb3JkaW5hbC1wb3NpdGlvbidcbn07XG5cbmV4cG9ydCBjb25zdCBTQ0FMRV9UWVBFUyA9IGtleXMoU0NBTEVfQ0FURUdPUllfSU5ERVgpIGFzIFNjYWxlVHlwZVtdO1xuXG4vKipcbiAqIFdoZXRoZXIgdGhlIHR3byBnaXZlbiBzY2FsZSB0eXBlcyBjYW4gYmUgbWVyZ2VkIHRvZ2V0aGVyLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc2NhbGVDb21wYXRpYmxlKHNjYWxlVHlwZTE6IFNjYWxlVHlwZSwgc2NhbGVUeXBlMjogU2NhbGVUeXBlKSB7XG4gIGNvbnN0IHNjYWxlQ2F0ZWdvcnkxID0gU0NBTEVfQ0FURUdPUllfSU5ERVhbc2NhbGVUeXBlMV07XG4gIGNvbnN0IHNjYWxlQ2F0ZWdvcnkyID0gU0NBTEVfQ0FURUdPUllfSU5ERVhbc2NhbGVUeXBlMl07XG4gIHJldHVybiBzY2FsZUNhdGVnb3J5MSA9PT0gc2NhbGVDYXRlZ29yeTIgfHxcbiAgICAoc2NhbGVDYXRlZ29yeTEgPT09ICdvcmRpbmFsLXBvc2l0aW9uJyAmJiBzY2FsZUNhdGVnb3J5MiA9PT0gJ3RpbWUnKSB8fFxuICAgIChzY2FsZUNhdGVnb3J5MiA9PT0gJ29yZGluYWwtcG9zaXRpb24nICYmIHNjYWxlQ2F0ZWdvcnkxID09PSAndGltZScpO1xufVxuXG4vKipcbiAqIEluZGV4IGZvciBzY2FsZSBwcmVjZWRlbmNlIC0tIGhpZ2ggc2NvcmUgPSBoaWdoZXIgcHJpb3JpdHkgZm9yIG1lcmdpbmcuXG4gKi9cbmNvbnN0IFNDQUxFX1BSRUNFREVOQ0VfSU5ERVg6IHtcbiAgLy8gVXNpbmcgTWFwcGVkIFR5cGUgdG8gZGVjbGFyZSB0eXBlIChodHRwczovL3d3dy50eXBlc2NyaXB0bGFuZy5vcmcvZG9jcy9oYW5kYm9vay9hZHZhbmNlZC10eXBlcy5odG1sI21hcHBlZC10eXBlcylcbiAgW2sgaW4gU2NhbGVUeXBlXTogbnVtYmVyXG59ID0ge1xuICAvLyBudW1lcmljXG4gIGxpbmVhcjogMCxcbiAgbG9nOiAxLFxuICBwb3c6IDEsXG4gIHNxcnQ6IDEsXG4gIC8vIHRpbWVcbiAgdGltZTogMCxcbiAgdXRjOiAwLFxuICAvLyBvcmRpbmFsLXBvc2l0aW9uIC0tIHRoZXNlIGhhdmUgaGlnaGVyIHByZWNlZGVuY2UgdGhhbiBjb250aW51b3VzIHNjYWxlcyBhcyB0aGV5IHN1cHBvcnQgbW9yZSB0eXBlcyBvZiBkYXRhXG4gIHBvaW50OiAxMCxcbiAgYmFuZDogMTEsIC8vIGJhbmQgaGFzIGhpZ2hlciBwcmVjZWRlbmNlIGFzIGl0IGlzIGJldHRlciBmb3IgaW50ZXJhY3Rpb25cbiAgLy8gbm9uIGdyb3VwZWQgdHlwZXNcbiAgJ2Jpbi1saW5lYXInOiAwLFxuICBzZXF1ZW50aWFsOiAwLFxuICBvcmRpbmFsOiAwLFxuICAnYmluLW9yZGluYWwnOiAwLFxufTtcblxuLyoqXG4gKiBSZXR1cm4gc2NhbGUgY2F0ZWdvcmllcyAtLSBvbmx5IHNjYWxlIG9mIHRoZSBzYW1lIGNhdGVnb3JpZXMgY2FuIGJlIG1lcmdlZCB0b2dldGhlci5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNjYWxlVHlwZVByZWNlZGVuY2Uoc2NhbGVUeXBlOiBTY2FsZVR5cGUpOiBudW1iZXIge1xuICByZXR1cm4gU0NBTEVfUFJFQ0VERU5DRV9JTkRFWFtzY2FsZVR5cGVdO1xufVxuXG5leHBvcnQgY29uc3QgQ09OVElOVU9VU19UT19DT05USU5VT1VTX1NDQUxFUzogU2NhbGVUeXBlW10gPSBbJ2xpbmVhcicsICdiaW4tbGluZWFyJywgJ2xvZycsICdwb3cnLCAnc3FydCcsICd0aW1lJywgJ3V0YyddO1xuY29uc3QgQ09OVElOVU9VU19UT19DT05USU5VT1VTX0lOREVYID0gdG9TZXQoQ09OVElOVU9VU19UT19DT05USU5VT1VTX1NDQUxFUyk7XG5cbmV4cG9ydCBjb25zdCBDT05USU5VT1VTX0RPTUFJTl9TQ0FMRVM6IFNjYWxlVHlwZVtdID0gQ09OVElOVU9VU19UT19DT05USU5VT1VTX1NDQUxFUy5jb25jYXQoWydzZXF1ZW50aWFsJyAvKiBUT0RPIGFkZCAncXVhbnRpbGUnLCAncXVhbnRpemUnLCAndGhyZXNob2xkJyovXSk7XG5jb25zdCBDT05USU5VT1VTX0RPTUFJTl9JTkRFWCA9IHRvU2V0KENPTlRJTlVPVVNfRE9NQUlOX1NDQUxFUyk7XG5cbmV4cG9ydCBjb25zdCBESVNDUkVURV9ET01BSU5fU0NBTEVTOiBTY2FsZVR5cGVbXSA9IFsnb3JkaW5hbCcsICdiaW4tb3JkaW5hbCcsICdwb2ludCcsICdiYW5kJ107XG5jb25zdCBESVNDUkVURV9ET01BSU5fSU5ERVggPSB0b1NldChESVNDUkVURV9ET01BSU5fU0NBTEVTKTtcblxuY29uc3QgQklOX1NDQUxFU19JTkRFWCA9IHRvU2V0KFsnYmluLWxpbmVhcicsICdiaW4tb3JkaW5hbCddKTtcblxuZXhwb3J0IGNvbnN0IFRJTUVfU0NBTEVfVFlQRVM6IFNjYWxlVHlwZVtdID0gWyd0aW1lJywgJ3V0YyddO1xuXG5leHBvcnQgZnVuY3Rpb24gaGFzRGlzY3JldGVEb21haW4odHlwZTogU2NhbGVUeXBlKTogdHlwZSBpcyAnb3JkaW5hbCcgfCAnYmluLW9yZGluYWwnIHwgJ3BvaW50JyB8ICdiYW5kJyB7XG4gIHJldHVybiB0eXBlIGluIERJU0NSRVRFX0RPTUFJTl9JTkRFWDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQmluU2NhbGUodHlwZTogU2NhbGVUeXBlKTogdHlwZSBpcyAnYmluLWxpbmVhcicgfCAnYmluLW9yZGluYWwnIHtcbiAgcmV0dXJuIHR5cGUgaW4gQklOX1NDQUxFU19JTkRFWDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhc0NvbnRpbnVvdXNEb21haW4odHlwZTogU2NhbGVUeXBlKTpcbiAgdHlwZSBpcyAnbGluZWFyJyB8ICdsb2cnIHwgJ3BvdycgfCAnc3FydCcgfCAndGltZScgfCAndXRjJ3xcbiAgICAgICAgICAnc2VxdWVudGlhbCcgLyogVE9ETyBhZGQgfCAncXVhbnRpbGUnIHwgJ3F1YW50aXplJyB8ICd0aHJlc2hvbGQnICovIHtcbiAgcmV0dXJuIHR5cGUgaW4gQ09OVElOVU9VU19ET01BSU5fSU5ERVg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NvbnRpbnVvdXNUb0NvbnRpbnVvdXModHlwZTogU2NhbGVUeXBlKTogdHlwZSBpcyAnbGluZWFyJyB8ICdiaW4tbGluZWFyJyB8ICdsb2cnIHwgJ3BvdycgfCAnc3FydCcgfCAndGltZScgfCAndXRjJyB7XG4gIHJldHVybiB0eXBlIGluIENPTlRJTlVPVVNfVE9fQ09OVElOVU9VU19JTkRFWDtcbn1cblxuZXhwb3J0IHR5cGUgTmljZVRpbWUgPSAnc2Vjb25kJyB8ICdtaW51dGUnIHwgJ2hvdXInIHwgJ2RheScgfCAnd2VlaycgfCAnbW9udGgnIHwgJ3llYXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNjYWxlQ29uZmlnIHtcbiAgLyoqXG4gICAqIElmIHRydWUsIHJvdW5kcyBudW1lcmljIG91dHB1dCB2YWx1ZXMgdG8gaW50ZWdlcnMuXG4gICAqIFRoaXMgY2FuIGJlIGhlbHBmdWwgZm9yIHNuYXBwaW5nIHRvIHRoZSBwaXhlbCBncmlkLlxuICAgKiAoT25seSBhdmFpbGFibGUgZm9yIGB4YCwgYHlgLCBhbmQgYHNpemVgIHNjYWxlcy4pXG4gICAqL1xuICByb3VuZD86IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIElmIHRydWUsIHZhbHVlcyB0aGF0IGV4Y2VlZCB0aGUgZGF0YSBkb21haW4gYXJlIGNsYW1wZWQgdG8gZWl0aGVyIHRoZSBtaW5pbXVtIG9yIG1heGltdW0gcmFuZ2UgdmFsdWVcbiAgICovXG4gIGNsYW1wPzogYm9vbGVhbjtcbiAgLyoqXG4gICAqICBEZWZhdWx0IHJhbmdlIHN0ZXAgZm9yIGB4YCBiYW5kIGFuZCBwb2ludCBzY2FsZXMgb2YgdGV4dCBtYXJrcy5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGA5MGBcbiAgICpcbiAgICogIEBtaW5pbXVtIDBcbiAgICovXG4gIHRleHRYUmFuZ2VTdGVwPzogbnVtYmVyOyAvLyBGSVhNRTogY29uc2lkZXIgaWYgd2Ugd2lsbCByZW5hbWUgdGhpcyBcInRhYmxlQ29sdW1uV2lkdGhcIlxuXG4gIC8qKlxuICAgKiBEZWZhdWx0IHJhbmdlIHN0ZXAgZm9yIGJhbmQgYW5kIHBvaW50IHNjYWxlcyBvZiAoMSkgdGhlIGB5YCBjaGFubmVsXG4gICAqIGFuZCAoMikgdGhlIGB4YCBjaGFubmVsIHdoZW4gdGhlIG1hcmsgaXMgbm90IGB0ZXh0YC5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGAyMWBcbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKi9cbiAgcmFuZ2VTdGVwPzogbnVtYmVyIHwgbnVsbDtcblxuICAvKipcbiAgICogRGVmYXVsdCBpbm5lciBwYWRkaW5nIGZvciBgeGAgYW5kIGB5YCBiYW5kLW9yZGluYWwgc2NhbGVzLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDAuMWBcbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKiBAbWF4aW11bSAxXG4gICAqL1xuICBiYW5kUGFkZGluZ0lubmVyPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG91dGVyIHBhZGRpbmcgZm9yIGB4YCBhbmQgYHlgIGJhbmQtb3JkaW5hbCBzY2FsZXMuXG4gICAqIElmIG5vdCBzcGVjaWZpZWQsIGJ5IGRlZmF1bHQsIGJhbmQgc2NhbGUncyBwYWRkaW5nT3V0ZXIgaXMgcGFkZGluZ0lubmVyLzIuXG4gICAqIEBtaW5pbXVtIDBcbiAgICogQG1heGltdW0gMVxuICAgKi9cbiAgYmFuZFBhZGRpbmdPdXRlcj86IG51bWJlcjtcblxuICAvKipcbiAgICogRGVmYXVsdCBwYWRkaW5nIGZvciBjb250aW51b3VzIHNjYWxlcy5cbiAgICpcbiAgICogX19EZWZhdWx0Ol9fIGA1YCBmb3IgY29udGludW91cyB4LXNjYWxlIG9mIGEgdmVydGljYWwgYmFyIGFuZCBjb250aW51b3VzIHktc2NhbGUgb2YgYSBob3Jpem9udGFsIGJhci47IGAwYCBvdGhlcndpc2UuXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIGNvbnRpbnVvdXNQYWRkaW5nPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG91dGVyIHBhZGRpbmcgZm9yIGB4YCBhbmQgYHlgIHBvaW50LW9yZGluYWwgc2NhbGVzLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDAuNWBcbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKiBAbWF4aW11bSAxXG4gICAqL1xuICBwb2ludFBhZGRpbmc/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFVzZSB0aGUgc291cmNlIGRhdGEgcmFuZ2UgYmVmb3JlIGFnZ3JlZ2F0aW9uIGFzIHNjYWxlIGRvbWFpbiBpbnN0ZWFkIG9mIGFnZ3JlZ2F0ZWQgZGF0YSBmb3IgYWdncmVnYXRlIGF4aXMuXG4gICAqXG4gICAqIFRoaXMgaXMgZXF1aXZhbGVudCB0byBzZXR0aW5nIGBkb21haW5gIHRvIGBcInVuYWdncmVnYXRlXCJgIGZvciBhZ2dyZWdhdGVkIF9xdWFudGl0YXRpdmVfIGZpZWxkcyBieSBkZWZhdWx0LlxuICAgKlxuICAgKiBUaGlzIHByb3BlcnR5IG9ubHkgd29ya3Mgd2l0aCBhZ2dyZWdhdGUgZnVuY3Rpb25zIHRoYXQgcHJvZHVjZSB2YWx1ZXMgd2l0aGluIHRoZSByYXcgZGF0YSBkb21haW4gKGBcIm1lYW5cImAsIGBcImF2ZXJhZ2VcImAsIGBcIm1lZGlhblwiYCwgYFwicTFcImAsIGBcInEzXCJgLCBgXCJtaW5cImAsIGBcIm1heFwiYCkuIEZvciBvdGhlciBhZ2dyZWdhdGlvbnMgdGhhdCBwcm9kdWNlIHZhbHVlcyBvdXRzaWRlIG9mIHRoZSByYXcgZGF0YSBkb21haW4gKGUuZy4gYFwiY291bnRcImAsIGBcInN1bVwiYCksIHRoaXMgcHJvcGVydHkgaXMgaWdub3JlZC5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBmYWxzZWBcbiAgICovXG4gIHVzZVVuYWdncmVnYXRlZERvbWFpbj86IGJvb2xlYW47XG5cbiAgLy8gbmljZSBzaG91bGQgZGVwZW5kcyBvbiB0eXBlIChxdWFudGl0YXRpdmUgb3IgdGVtcG9yYWwpLCBzb1xuICAvLyBsZXQncyBub3QgbWFrZSBhIGNvbmZpZy5cblxuICAvLyBDb25maWdzIGZvciBSYW5nZVxuXG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCBtYXggdmFsdWUgZm9yIG1hcHBpbmcgcXVhbnRpdGF0aXZlIGZpZWxkcyB0byBiYXIncyBzaXplL2JhbmRTaXplLlxuICAgKlxuICAgKiBJZiB1bmRlZmluZWQgKGRlZmF1bHQpLCB3ZSB3aWxsIHVzZSB0aGUgc2NhbGUncyBgcmFuZ2VTdGVwYCAtIDEuXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIG1heEJhbmRTaXplPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCBtaW4gdmFsdWUgZm9yIG1hcHBpbmcgcXVhbnRpdGF0aXZlIGZpZWxkcyB0byBiYXIgYW5kIHRpY2sncyBzaXplL2JhbmRTaXplIHNjYWxlIHdpdGggemVybz1mYWxzZS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGAyYFxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBtaW5CYW5kU2l6ZT86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIGRlZmF1bHQgbWF4IHZhbHVlIGZvciBtYXBwaW5nIHF1YW50aXRhdGl2ZSBmaWVsZHMgdG8gdGV4dCdzIHNpemUvZm9udFNpemUuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgNDBgXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIG1heEZvbnRTaXplPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCBtaW4gdmFsdWUgZm9yIG1hcHBpbmcgcXVhbnRpdGF0aXZlIGZpZWxkcyB0byB0aWNrJ3Mgc2l6ZS9mb250U2l6ZSBzY2FsZSB3aXRoIHplcm89ZmFsc2VcbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGA4YFxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBtaW5Gb250U2l6ZT86IG51bWJlcjtcblxuICAvKipcbiAgICogRGVmYXVsdCBtaW5pbXVtIG9wYWNpdHkgZm9yIG1hcHBpbmcgYSBmaWVsZCB0byBvcGFjaXR5LlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDAuM2BcbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKiBAbWF4aW11bSAxXG4gICAqL1xuICBtaW5PcGFjaXR5PzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG1heCBvcGFjaXR5IGZvciBtYXBwaW5nIGEgZmllbGQgdG8gb3BhY2l0eS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGAwLjhgXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICogQG1heGltdW0gMVxuICAgKi9cbiAgbWF4T3BhY2l0eT86IG51bWJlcjtcblxuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG1pbmltdW0gdmFsdWUgZm9yIHBvaW50IHNpemUgc2NhbGUgd2l0aCB6ZXJvPWZhbHNlLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDlgXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIG1pblNpemU/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIERlZmF1bHQgbWF4IHZhbHVlIGZvciBwb2ludCBzaXplIHNjYWxlLlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBtYXhTaXplPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG1pbmltdW0gc3Ryb2tlV2lkdGggZm9yIHRoZSBzY2FsZSBvZiBzdHJva2VXaWR0aCBmb3IgcnVsZSBhbmQgbGluZSBtYXJrcyBhbmQgb2Ygc2l6ZSBmb3IgdHJhaWwgbWFya3Mgd2l0aCB6ZXJvPWZhbHNlLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDFgXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIG1pblN0cm9rZVdpZHRoPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IG1heCBzdHJva2VXaWR0aCBmb3IgdGhlIHNjYWxlIG9mIHN0cm9rZVdpZHRoIGZvciBydWxlIGFuZCBsaW5lIG1hcmtzIGFuZCBvZiBzaXplIGZvciB0cmFpbCBtYXJrcy5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGA0YFxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBtYXhTdHJva2VXaWR0aD86IG51bWJlcjtcbn1cblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRTY2FsZUNvbmZpZyA9IHtcbiAgdGV4dFhSYW5nZVN0ZXA6IDkwLFxuICByYW5nZVN0ZXA6IDIxLFxuICBwb2ludFBhZGRpbmc6IDAuNSxcbiAgYmFuZFBhZGRpbmdJbm5lcjogMC4xLFxuICBmYWNldFNwYWNpbmc6IDE2LFxuXG4gIG1pbkJhbmRTaXplOiAyLFxuXG4gIG1pbkZvbnRTaXplOiA4LFxuICBtYXhGb250U2l6ZTogNDAsXG5cbiAgbWluT3BhY2l0eTogMC4zLFxuICBtYXhPcGFjaXR5OiAwLjgsXG5cbiAgLy8gRklYTUU6IHJldmlzZSBpZiB0aGVzZSAqY2FuKiBiZWNvbWUgcmF0aW9zIG9mIHJhbmdlU3RlcFxuICBtaW5TaXplOiA5LCAvLyBQb2ludCBzaXplIGlzIGFyZWEuIEZvciBzcXVhcmUgcG9pbnQsIDkgPSAzIHBpeGVsIF4gMiwgbm90IHRvbyBzbWFsbCFcblxuICBtaW5TdHJva2VXaWR0aDogMSxcbiAgbWF4U3Ryb2tlV2lkdGg6IDRcbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2NoZW1lUGFyYW1zIHtcbiAgLyoqXG4gICAqIEEgY29sb3Igc2NoZW1lIG5hbWUgZm9yIHNlcXVlbnRpYWwvb3JkaW5hbCBzY2FsZXMgKGUuZy4sIGBcImNhdGVnb3J5MTBcImAgb3IgYFwidmlyaWRpc1wiYCkuXG4gICAqXG4gICAqIEZvciB0aGUgZnVsbCBsaXN0IG9mIHN1cHBvcnRlZCBzY2hlbWVzLCBwbGVhc2UgcmVmZXIgdG8gdGhlIFtWZWdhIFNjaGVtZV0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhL2RvY3Mvc2NoZW1lcy8jcmVmZXJlbmNlKSByZWZlcmVuY2UuXG4gICAqL1xuICBuYW1lOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEZvciBzZXF1ZW50aWFsIGFuZCBkaXZlcmdpbmcgc2NoZW1lcyBvbmx5LCBkZXRlcm1pbmVzIHRoZSBleHRlbnQgb2YgdGhlIGNvbG9yIHJhbmdlIHRvIHVzZS4gRm9yIGV4YW1wbGUgYFswLjIsIDFdYCB3aWxsIHJlc2NhbGUgdGhlIGNvbG9yIHNjaGVtZSBzdWNoIHRoYXQgY29sb3IgdmFsdWVzIGluIHRoZSByYW5nZSBfWzAsIDAuMilfIGFyZSBleGNsdWRlZCBmcm9tIHRoZSBzY2hlbWUuXG4gICAqL1xuICBleHRlbnQ/OiBudW1iZXJbXTtcblxuICAvKipcbiAgICogVGhlIG51bWJlciBvZiBjb2xvcnMgdG8gdXNlIGluIHRoZSBzY2hlbWUuIFRoaXMgY2FuIGJlIHVzZWZ1bCBmb3Igc2NhbGUgdHlwZXMgc3VjaCBhcyBgXCJxdWFudGl6ZVwiYCwgd2hpY2ggdXNlIHRoZSBsZW5ndGggb2YgdGhlIHNjYWxlIHJhbmdlIHRvIGRldGVybWluZSB0aGUgbnVtYmVyIG9mIGRpc2NyZXRlIGJpbnMgZm9yIHRoZSBzY2FsZSBkb21haW4uXG4gICAqXG4gICAqIEBoaWRlXG4gICAqL1xuICBjb3VudD86IG51bWJlcjtcbn1cblxuZXhwb3J0IHR5cGUgU2VsZWN0aW9uRG9tYWluID0ge1xuICAvKipcbiAgICogVGhlIG5hbWUgb2YgYSBzZWxlY3Rpb24uXG4gICAqL1xuICBzZWxlY3Rpb246IHN0cmluZyxcbiAgLyoqXG4gICAqIFRoZSBmaWVsZCBuYW1lIHRvIGV4dHJhY3Qgc2VsZWN0ZWQgdmFsdWVzIGZvciwgd2hlbiBhIHNlbGVjdGlvbiBpcyBbcHJvamVjdGVkXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3Byb2plY3QuaHRtbClcbiAgICogb3ZlciBtdWx0aXBsZSBmaWVsZHMgb3IgZW5jb2RpbmdzLlxuICAgKi9cbiAgZmllbGQ/OiBzdHJpbmdcbn0gfCB7XG4gIC8qKlxuICAgKiBUaGUgbmFtZSBvZiBhIHNlbGVjdGlvbi5cbiAgICovXG4gIHNlbGVjdGlvbjogc3RyaW5nLFxuICAvKipcbiAgICogVGhlIGVuY29kaW5nIGNoYW5uZWwgdG8gZXh0cmFjdCBzZWxlY3RlZCB2YWx1ZXMgZm9yLCB3aGVuIGEgc2VsZWN0aW9uIGlzIFtwcm9qZWN0ZWRdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvcHJvamVjdC5odG1sKVxuICAgKiBvdmVyIG11bHRpcGxlIGZpZWxkcyBvciBlbmNvZGluZ3MuXG4gICAqL1xuICBlbmNvZGluZz86IHN0cmluZ1xufTtcblxuZXhwb3J0IHR5cGUgRG9tYWluID0gbnVtYmVyW10gfCBzdHJpbmdbXSB8IGJvb2xlYW5bXSB8IERhdGVUaW1lW10gfCAndW5hZ2dyZWdhdGVkJyB8IFNlbGVjdGlvbkRvbWFpbjtcbmV4cG9ydCB0eXBlIFNjaGVtZSA9IHN0cmluZyB8IFNjaGVtZVBhcmFtcztcblxuZXhwb3J0IHR5cGUgUmFuZ2UgPSBudW1iZXJbXSB8IHN0cmluZ1tdIHwgc3RyaW5nO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNFeHRlbmRlZFNjaGVtZShzY2hlbWU6IHN0cmluZyB8IFNjaGVtZVBhcmFtcyk6IHNjaGVtZSBpcyBTY2hlbWVQYXJhbXMge1xuICByZXR1cm4gc2NoZW1lICYmICEhc2NoZW1lWyduYW1lJ107XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1NlbGVjdGlvbkRvbWFpbihkb21haW46IERvbWFpbik6IGRvbWFpbiBpcyBTZWxlY3Rpb25Eb21haW4ge1xuICByZXR1cm4gZG9tYWluICYmIGRvbWFpblsnc2VsZWN0aW9uJ107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2NhbGUge1xuICAvKipcbiAgICogVGhlIHR5cGUgb2Ygc2NhbGUuICBWZWdhLUxpdGUgc3VwcG9ydHMgdGhlIGZvbGxvd2luZyBjYXRlZ29yaWVzIG9mIHNjYWxlIHR5cGVzOlxuICAgKlxuICAgKiAxKSBbKipDb250aW51b3VzIFNjYWxlcyoqXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjY29udGludW91cykgLS0gbWFwcGluZyBjb250aW51b3VzIGRvbWFpbnMgdG8gY29udGludW91cyBvdXRwdXQgcmFuZ2VzIChbYFwibGluZWFyXCJgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjbGluZWFyKSwgW2BcInBvd1wiYF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI3BvdyksIFtgXCJzcXJ0XCJgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjc3FydCksIFtgXCJsb2dcImBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNsb2cpLCBbYFwidGltZVwiYF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI3RpbWUpLCBbYFwidXRjXCJgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjdXRjKSwgW2BcInNlcXVlbnRpYWxcImBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNzZXF1ZW50aWFsKSkuXG4gICAqXG4gICAqIDIpIFsqKkRpc2NyZXRlIFNjYWxlcyoqXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjZGlzY3JldGUpIC0tIG1hcHBpbmcgZGlzY3JldGUgZG9tYWlucyB0byBkaXNjcmV0ZSAoW2BcIm9yZGluYWxcImBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNvcmRpbmFsKSkgb3IgY29udGludW91cyAoW2BcImJhbmRcImBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNiYW5kKSBhbmQgW2BcInBvaW50XCJgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjcG9pbnQpKSBvdXRwdXQgcmFuZ2VzLlxuICAgKlxuICAgKiAzKSBbKipEaXNjcmV0aXppbmcgU2NhbGVzKipdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNkaXNjcmV0aXppbmcpIC0tIG1hcHBpbmcgY29udGludW91cyBkb21haW5zIHRvIGRpc2NyZXRlIG91dHB1dCByYW5nZXMgKFtgXCJiaW4tbGluZWFyXCJgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjYmluLWxpbmVhcikgYW5kIFtgXCJiaW4tb3JkaW5hbFwiYF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI2Jpbi1vcmRpbmFsKSkuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBwbGVhc2Ugc2VlIHRoZSBbc2NhbGUgdHlwZSB0YWJsZV0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI3R5cGUpLlxuICAgKi9cbiAgdHlwZT86IFNjYWxlVHlwZTtcblxuICAvKipcbiAgICogQ3VzdG9taXplZCBkb21haW4gdmFsdWVzLlxuICAgKlxuICAgKiBGb3IgX3F1YW50aXRhdGl2ZV8gZmllbGRzLCBgZG9tYWluYCBjYW4gdGFrZSB0aGUgZm9ybSBvZiBhIHR3by1lbGVtZW50IGFycmF5IHdpdGggbWluaW11bSBhbmQgbWF4aW11bSB2YWx1ZXMuICBbUGllY2V3aXNlIHNjYWxlc10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI3BpZWNld2lzZSkgY2FuIGJlIGNyZWF0ZWQgYnkgcHJvdmlkaW5nIGEgYGRvbWFpbmAgd2l0aCBtb3JlIHRoYW4gdHdvIGVudHJpZXMuXG4gICAqIElmIHRoZSBpbnB1dCBmaWVsZCBpcyBhZ2dyZWdhdGVkLCBgZG9tYWluYCBjYW4gYWxzbyBiZSBhIHN0cmluZyB2YWx1ZSBgXCJ1bmFnZ3JlZ2F0ZWRcImAsIGluZGljYXRpbmcgdGhhdCB0aGUgZG9tYWluIHNob3VsZCBpbmNsdWRlIHRoZSByYXcgZGF0YSB2YWx1ZXMgcHJpb3IgdG8gdGhlIGFnZ3JlZ2F0aW9uLlxuICAgKlxuICAgKiBGb3IgX3RlbXBvcmFsXyBmaWVsZHMsIGBkb21haW5gIGNhbiBiZSBhIHR3by1lbGVtZW50IGFycmF5IG1pbmltdW0gYW5kIG1heGltdW0gdmFsdWVzLCBpbiB0aGUgZm9ybSBvZiBlaXRoZXIgdGltZXN0YW1wcyBvciB0aGUgW0RhdGVUaW1lIGRlZmluaXRpb24gb2JqZWN0c10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy90eXBlcy5odG1sI2RhdGV0aW1lKS5cbiAgICpcbiAgICogRm9yIF9vcmRpbmFsXyBhbmQgX25vbWluYWxfIGZpZWxkcywgYGRvbWFpbmAgY2FuIGJlIGFuIGFycmF5IHRoYXQgbGlzdHMgdmFsaWQgaW5wdXQgdmFsdWVzLlxuICAgKlxuICAgKiBUaGUgYHNlbGVjdGlvbmAgcHJvcGVydHkgY2FuIGJlIHVzZWQgdG8gW2ludGVyYWN0aXZlbHkgZGV0ZXJtaW5lXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NlbGVjdGlvbi5odG1sI3NjYWxlLWRvbWFpbnMpIHRoZSBzY2FsZSBkb21haW4uXG4gICAqL1xuICBkb21haW4/OiBudW1iZXJbXSB8IHN0cmluZ1tdIHwgYm9vbGVhbltdIHwgRGF0ZVRpbWVbXSB8ICd1bmFnZ3JlZ2F0ZWQnIHwgU2VsZWN0aW9uRG9tYWluO1xuXG5cbiAgLy8gSGlkZSBiZWNhdXNlIHdlIG1pZ2h0IG5vdCByZWFsbHkgbmVlZCB0aGlzLlxuICAvKipcbiAgICogSWYgdHJ1ZSwgcmV2ZXJzZXMgdGhlIG9yZGVyIG9mIHRoZSBzY2FsZSByYW5nZS5cbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBmYWxzZWAuXG4gICAqXG4gICAqIEBoaWRlXG4gICAqL1xuICByZXZlcnNlPzogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhlIHJhbmdlIG9mIHRoZSBzY2FsZS4gT25lIG9mOlxuICAgKlxuICAgKiAtIEEgc3RyaW5nIGluZGljYXRpbmcgYSBbcHJlLWRlZmluZWQgbmFtZWQgc2NhbGUgcmFuZ2VdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNyYW5nZS1jb25maWcpIChlLmcuLCBleGFtcGxlLCBgXCJzeW1ib2xcImAsIG9yIGBcImRpdmVyZ2luZ1wiYCkuXG4gICAqXG4gICAqIC0gRm9yIFtjb250aW51b3VzIHNjYWxlc10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI2NvbnRpbnVvdXMpLCB0d28tZWxlbWVudCBhcnJheSBpbmRpY2F0aW5nICBtaW5pbXVtIGFuZCBtYXhpbXVtIHZhbHVlcywgb3IgYW4gYXJyYXkgd2l0aCBtb3JlIHRoYW4gdHdvIGVudHJpZXMgZm9yIHNwZWNpZnlpbmcgYSBbcGllY2V3aXNlIHNjYWxlXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjcGllY2V3aXNlKS5cbiAgICpcbiAgICogLSBGb3IgW2Rpc2NyZXRlXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjZGlzY3JldGUpIGFuZCBbZGlzY3JldGl6aW5nXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjZGlzY3JldGl6aW5nKSBzY2FsZXMsIGFuIGFycmF5IG9mIGRlc2lyZWQgb3V0cHV0IHZhbHVlcy5cbiAgICpcbiAgICogX19Ob3RlczpfX1xuICAgKlxuICAgKiAxKSBGb3IgW3NlcXVlbnRpYWxdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNzZXF1ZW50aWFsKSwgW29yZGluYWxdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNvcmRpbmFsKSwgYW5kIGRpc2NyZXRpemluZyBjb2xvciBzY2FsZXMsIHlvdSBjYW4gYWxzbyBzcGVjaWZ5IGEgY29sb3IgW2BzY2hlbWVgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjc2NoZW1lKSBpbnN0ZWFkIG9mIGByYW5nZWAuXG4gICAqXG4gICAqIDIpIEFueSBkaXJlY3RseSBzcGVjaWZpZWQgYHJhbmdlYCBmb3IgYHhgIGFuZCBgeWAgY2hhbm5lbHMgd2lsbCBiZSBpZ25vcmVkLiBSYW5nZSBjYW4gYmUgY3VzdG9taXplZCB2aWEgdGhlIHZpZXcncyBjb3JyZXNwb25kaW5nIFtzaXplXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NpemUuaHRtbCkgKGB3aWR0aGAgYW5kIGBoZWlnaHRgKSBvciB2aWEgW3JhbmdlIHN0ZXBzIGFuZCBwYWRkaW5ncyBwcm9wZXJ0aWVzXSgjcmFuZ2Utc3RlcCkgZm9yIFtiYW5kXSgjYmFuZCkgYW5kIFtwb2ludF0oI3BvaW50KSBzY2FsZXMuXG4gICAqL1xuICByYW5nZT86IG51bWJlcltdIHwgc3RyaW5nW10gfCBzdHJpbmc7XG5cbiAgLy8gb3JkaW5hbFxuICAvKipcbiAgICogVGhlIGRpc3RhbmNlIGJldHdlZW4gdGhlIHN0YXJ0cyBvZiBhZGphY2VudCBiYW5kcyBvciBwb2ludHMgaW4gW2JhbmRdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNiYW5kKSBhbmQgW3BvaW50XShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjcG9pbnQpIHNjYWxlcy5cbiAgICpcbiAgICogSWYgYHJhbmdlU3RlcGAgaXMgYG51bGxgIG9yIGlmIHRoZSB2aWV3IGNvbnRhaW5zIHRoZSBzY2FsZSdzIGNvcnJlc3BvbmRpbmcgW3NpemVdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2l6ZS5odG1sKSAoYHdpZHRoYCBmb3IgYHhgIHNjYWxlcyBhbmQgYGhlaWdodGAgZm9yIGB5YCBzY2FsZXMpLCBgcmFuZ2VTdGVwYCB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgZGV0ZXJtaW5lZCB0byBmaXQgdGhlIHNpemUgb2YgdGhlIHZpZXcuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyAgZGVyaXZlZCB0aGUgW3NjYWxlIGNvbmZpZ10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9jb25maWcuaHRtbCNzY2FsZS1jb25maWcpJ3MgYHRleHRYUmFuZ2VTdGVwYCAoYDkwYCBieSBkZWZhdWx0KSBmb3IgeC1zY2FsZXMgb2YgYHRleHRgIG1hcmtzIGFuZCBgcmFuZ2VTdGVwYCAoYDIxYCBieSBkZWZhdWx0KSBmb3IgeC1zY2FsZXMgb2Ygb3RoZXIgbWFya3MgYW5kIHktc2NhbGVzLlxuICAgKlxuICAgKiBfX1dhcm5pbmdfXzogSWYgYHJhbmdlU3RlcGAgaXMgYG51bGxgIGFuZCB0aGUgY2FyZGluYWxpdHkgb2YgdGhlIHNjYWxlJ3MgZG9tYWluIGlzIGhpZ2hlciB0aGFuIGB3aWR0aGAgb3IgYGhlaWdodGAsIHRoZSByYW5nZVN0ZXAgbWlnaHQgYmVjb21lIGxlc3MgdGhhbiBvbmUgcGl4ZWwgYW5kIHRoZSBtYXJrIG1pZ2h0IG5vdCBhcHBlYXIgY29ycmVjdGx5LlxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICByYW5nZVN0ZXA/OiBudW1iZXIgfCBudWxsO1xuXG4gIC8qKlxuICAgKiBBIHN0cmluZyBpbmRpY2F0aW5nIGEgY29sb3IgW3NjaGVtZV0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI3NjaGVtZSkgbmFtZSAoZS5nLiwgYFwiY2F0ZWdvcnkxMFwiYCBvciBgXCJ2aXJpZGlzXCJgKSBvciBhIFtzY2hlbWUgcGFyYW1ldGVyIG9iamVjdF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI3NjaGVtZS1wYXJhbXMpLlxuICAgKlxuICAgKiBEaXNjcmV0ZSBjb2xvciBzY2hlbWVzIG1heSBiZSB1c2VkIHdpdGggW2Rpc2NyZXRlXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjZGlzY3JldGUpIG9yIFtkaXNjcmV0aXppbmddKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNkaXNjcmV0aXppbmcpIHNjYWxlcy4gQ29udGludW91cyBjb2xvciBzY2hlbWVzIGFyZSBpbnRlbmRlZCBmb3IgdXNlIHdpdGggW3NlcXVlbnRpYWxdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGVzLmh0bWwjc2VxdWVudGlhbCkgc2NhbGVzLlxuICAgKlxuICAgKiBGb3IgdGhlIGZ1bGwgbGlzdCBvZiBzdXBwb3J0ZWQgc2NoZW1lcywgcGxlYXNlIHJlZmVyIHRvIHRoZSBbVmVnYSBTY2hlbWVdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS9kb2NzL3NjaGVtZXMvI3JlZmVyZW5jZSkgcmVmZXJlbmNlLlxuICAgKi9cbiAgc2NoZW1lPzogc3RyaW5nIHwgU2NoZW1lUGFyYW1zO1xuXG4gIC8qKlxuICAgKiBJZiBgdHJ1ZWAsIHJvdW5kcyBudW1lcmljIG91dHB1dCB2YWx1ZXMgdG8gaW50ZWdlcnMuIFRoaXMgY2FuIGJlIGhlbHBmdWwgZm9yIHNuYXBwaW5nIHRvIHRoZSBwaXhlbCBncmlkLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYGZhbHNlYC5cbiAgICovXG4gIHJvdW5kPzogYm9vbGVhbjtcblxuICAvKipcbiAgICogRm9yIF9bY29udGludW91c10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI2NvbnRpbnVvdXMpXyBzY2FsZXMsIGV4cGFuZHMgdGhlIHNjYWxlIGRvbWFpbiB0byBhY2NvbW1vZGF0ZSB0aGUgc3BlY2lmaWVkIG51bWJlciBvZiBwaXhlbHMgb24gZWFjaCBvZiB0aGUgc2NhbGUgcmFuZ2UuIFRoZSBzY2FsZSByYW5nZSBtdXN0IHJlcHJlc2VudCBwaXhlbHMgZm9yIHRoaXMgcGFyYW1ldGVyIHRvIGZ1bmN0aW9uIGFzIGludGVuZGVkLiBQYWRkaW5nIGFkanVzdG1lbnQgaXMgcGVyZm9ybWVkwqBwcmlvcsKgdG8gYWxsIG90aGVyIGFkanVzdG1lbnRzLCBpbmNsdWRpbmcgdGhlIGVmZmVjdHMgb2YgdGhlwqB6ZXJvLMKgbmljZSzCoGRvbWFpbk1pbiwgYW5kwqBkb21haW5NYXjCoHByb3BlcnRpZXMuXG4gICAqXG4gICAqIEZvciBfW2JhbmRdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNiYW5kKV8gc2NhbGVzLCBzaG9ydGN1dCBmb3Igc2V0dGluZyBgcGFkZGluZ0lubmVyYCBhbmQgYHBhZGRpbmdPdXRlcmAgdG8gdGhlIHNhbWUgdmFsdWUuXG4gICAqXG4gICAqIEZvciBfW3BvaW50XShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjcG9pbnQpXyBzY2FsZXMsIGFsaWFzIGZvciBgcGFkZGluZ091dGVyYC5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIEZvciBfY29udGludW91c18gc2NhbGVzLCBkZXJpdmVkIGZyb20gdGhlIFtzY2FsZSBjb25maWddKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNjb25maWcpJ3MgYGNvbnRpbnVvdXNQYWRkaW5nYC5cbiAgICogRm9yIF9iYW5kIGFuZCBwb2ludF8gc2NhbGVzLCBzZWUgYHBhZGRpbmdJbm5lcmAgYW5kIGBwYWRkaW5nT3V0ZXJgLlxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBwYWRkaW5nPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgaW5uZXIgcGFkZGluZyAoc3BhY2luZykgd2l0aGluIGVhY2ggYmFuZCBzdGVwIG9mIGJhbmQgc2NhbGVzLCBhcyBhIGZyYWN0aW9uIG9mIHRoZSBzdGVwIHNpemUuIFRoaXMgdmFsdWUgbXVzdCBsaWUgaW4gdGhlIHJhbmdlIFswLDFdLlxuICAgKlxuICAgKiBGb3IgcG9pbnQgc2NhbGUsIHRoaXMgcHJvcGVydHkgaXMgaW52YWxpZCBhcyBwb2ludCBzY2FsZXMgZG8gbm90IGhhdmUgaW50ZXJuYWwgYmFuZCB3aWR0aHMgKG9ubHkgc3RlcCBzaXplcyBiZXR3ZWVuIGJhbmRzKS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGRlcml2ZWQgZnJvbSB0aGUgW3NjYWxlIGNvbmZpZ10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI2NvbmZpZykncyBgYmFuZFBhZGRpbmdJbm5lcmAuXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICogQG1heGltdW0gMVxuICAgKi9cbiAgcGFkZGluZ0lubmVyPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgb3V0ZXIgcGFkZGluZyAoc3BhY2luZykgYXQgdGhlIGVuZHMgb2YgdGhlIHJhbmdlIG9mIGJhbmQgYW5kIHBvaW50IHNjYWxlcyxcbiAgICogYXMgYSBmcmFjdGlvbiBvZiB0aGUgc3RlcCBzaXplLiBUaGlzIHZhbHVlIG11c3QgbGllIGluIHRoZSByYW5nZSBbMCwxXS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGRlcml2ZWQgZnJvbSB0aGUgW3NjYWxlIGNvbmZpZ10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI2NvbmZpZykncyBgYmFuZFBhZGRpbmdPdXRlcmAgZm9yIGJhbmQgc2NhbGVzIGFuZCBgcG9pbnRQYWRkaW5nYCBmb3IgcG9pbnQgc2NhbGVzLlxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqIEBtYXhpbXVtIDFcbiAgICovXG4gIHBhZGRpbmdPdXRlcj86IG51bWJlcjtcblxuICAvLyB0eXBpY2FsXG4gIC8qKlxuICAgKiBJZiBgdHJ1ZWAsIHZhbHVlcyB0aGF0IGV4Y2VlZCB0aGUgZGF0YSBkb21haW4gYXJlIGNsYW1wZWQgdG8gZWl0aGVyIHRoZSBtaW5pbXVtIG9yIG1heGltdW0gcmFuZ2UgdmFsdWVcbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGRlcml2ZWQgZnJvbSB0aGUgW3NjYWxlIGNvbmZpZ10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9jb25maWcuaHRtbCNzY2FsZS1jb25maWcpJ3MgYGNsYW1wYCAoYHRydWVgIGJ5IGRlZmF1bHQpLlxuICAgKi9cbiAgY2xhbXA/OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBFeHRlbmRpbmcgdGhlIGRvbWFpbiBzbyB0aGF0IGl0IHN0YXJ0cyBhbmQgZW5kcyBvbiBuaWNlIHJvdW5kIHZhbHVlcy4gVGhpcyBtZXRob2QgdHlwaWNhbGx5IG1vZGlmaWVzIHRoZSBzY2FsZeKAmXMgZG9tYWluLCBhbmQgbWF5IG9ubHkgZXh0ZW5kIHRoZSBib3VuZHMgdG8gdGhlIG5lYXJlc3Qgcm91bmQgdmFsdWUuIE5pY2luZyBpcyB1c2VmdWwgaWYgdGhlIGRvbWFpbiBpcyBjb21wdXRlZCBmcm9tIGRhdGEgYW5kIG1heSBiZSBpcnJlZ3VsYXIuIEZvciBleGFtcGxlLCBmb3IgYSBkb21haW4gb2YgX1swLjIwMTQ3OeKApiwgMC45OTY2NznigKZdXywgYSBuaWNlIGRvbWFpbiBtaWdodCBiZSBfWzAuMiwgMS4wXV8uXG4gICAqXG4gICAqIEZvciBxdWFudGl0YXRpdmUgc2NhbGVzIHN1Y2ggYXMgbGluZWFyLCBgbmljZWAgY2FuIGJlIGVpdGhlciBhIGJvb2xlYW4gZmxhZyBvciBhIG51bWJlci4gSWYgYG5pY2VgIGlzIGEgbnVtYmVyLCBpdCB3aWxsIHJlcHJlc2VudCBhIGRlc2lyZWQgdGljayBjb3VudC4gVGhpcyBhbGxvd3MgZ3JlYXRlciBjb250cm9sIG92ZXIgdGhlIHN0ZXAgc2l6ZSB1c2VkIHRvIGV4dGVuZCB0aGUgYm91bmRzLCBndWFyYW50ZWVpbmcgdGhhdCB0aGUgcmV0dXJuZWQgdGlja3Mgd2lsbCBleGFjdGx5IGNvdmVyIHRoZSBkb21haW4uXG4gICAqXG4gICAqIEZvciB0ZW1wb3JhbCBmaWVsZHMgd2l0aCB0aW1lIGFuZCB1dGMgc2NhbGVzLCB0aGUgYG5pY2VgIHZhbHVlIGNhbiBiZSBhIHN0cmluZyBpbmRpY2F0aW5nIHRoZSBkZXNpcmVkIHRpbWUgaW50ZXJ2YWwuIExlZ2FsIHZhbHVlcyBhcmUgYFwibWlsbGlzZWNvbmRcImAsIGBcInNlY29uZFwiYCwgYFwibWludXRlXCJgLCBgXCJob3VyXCJgLCBgXCJkYXlcImAsIGBcIndlZWtcImAsIGBcIm1vbnRoXCJgLCBhbmQgYFwieWVhclwiYC4gQWx0ZXJuYXRpdmVseSwgYHRpbWVgIGFuZCBgdXRjYCBzY2FsZXMgY2FuIGFjY2VwdCBhbiBvYmplY3QtdmFsdWVkIGludGVydmFsIHNwZWNpZmllciBvZiB0aGUgZm9ybSBge1wiaW50ZXJ2YWxcIjogXCJtb250aFwiLCBcInN0ZXBcIjogM31gLCB3aGljaCBpbmNsdWRlcyBhIGRlc2lyZWQgbnVtYmVyIG9mIGludGVydmFsIHN0ZXBzLiBIZXJlLCB0aGUgZG9tYWluIHdvdWxkIHNuYXAgdG8gcXVhcnRlciAoSmFuLCBBcHIsIEp1bCwgT2N0KSBib3VuZGFyaWVzLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYHRydWVgIGZvciB1bmJpbm5lZCBfcXVhbnRpdGF0aXZlXyBmaWVsZHM7IGBmYWxzZWAgb3RoZXJ3aXNlLlxuICAgKlxuICAgKi9cbiAgbmljZT86IGJvb2xlYW4gfCBudW1iZXIgfCBOaWNlVGltZSB8IHtpbnRlcnZhbDogc3RyaW5nLCBzdGVwOiBudW1iZXJ9O1xuXG4gIC8qKlxuICAgKiBUaGUgbG9nYXJpdGhtIGJhc2Ugb2YgdGhlIGBsb2dgIHNjYWxlIChkZWZhdWx0IGAxMGApLlxuICAgKi9cbiAgYmFzZT86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIGV4cG9uZW50IG9mIHRoZSBgcG93YCBzY2FsZS5cbiAgICovXG4gIGV4cG9uZW50PzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBJZiBgdHJ1ZWAsIGVuc3VyZXMgdGhhdCBhIHplcm8gYmFzZWxpbmUgdmFsdWUgaXMgaW5jbHVkZWQgaW4gdGhlIHNjYWxlIGRvbWFpbi5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGB0cnVlYCBmb3IgeCBhbmQgeSBjaGFubmVscyBpZiB0aGUgcXVhbnRpdGF0aXZlIGZpZWxkIGlzIG5vdCBiaW5uZWQgYW5kIG5vIGN1c3RvbSBgZG9tYWluYCBpcyBwcm92aWRlZDsgYGZhbHNlYCBvdGhlcndpc2UuXG4gICAqXG4gICAqIF9fTm90ZTpfXyBMb2csIHRpbWUsIGFuZCB1dGMgc2NhbGVzIGRvIG5vdCBzdXBwb3J0IGB6ZXJvYC5cbiAgICovXG4gIHplcm8/OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGUgaW50ZXJwb2xhdGlvbiBtZXRob2QgZm9yIHJhbmdlIHZhbHVlcy4gQnkgZGVmYXVsdCwgYSBnZW5lcmFsIGludGVycG9sYXRvciBmb3IgbnVtYmVycywgZGF0ZXMsIHN0cmluZ3MgYW5kIGNvbG9ycyAoaW4gUkdCIHNwYWNlKSBpcyB1c2VkLiBGb3IgY29sb3IgcmFuZ2VzLCB0aGlzIHByb3BlcnR5IGFsbG93cyBpbnRlcnBvbGF0aW9uIGluIGFsdGVybmF0aXZlIGNvbG9yIHNwYWNlcy4gTGVnYWwgdmFsdWVzIGluY2x1ZGUgYHJnYmAsIGBoc2xgLCBgaHNsLWxvbmdgLCBgbGFiYCwgYGhjbGAsIGBoY2wtbG9uZ2AsIGBjdWJlaGVsaXhgIGFuZCBgY3ViZWhlbGl4LWxvbmdgICgnLWxvbmcnIHZhcmlhbnRzIHVzZSBsb25nZXIgcGF0aHMgaW4gcG9sYXIgY29vcmRpbmF0ZSBzcGFjZXMpLiBJZiBvYmplY3QtdmFsdWVkLCB0aGlzIHByb3BlcnR5IGFjY2VwdHMgYW4gb2JqZWN0IHdpdGggYSBzdHJpbmctdmFsdWVkIF90eXBlXyBwcm9wZXJ0eSBhbmQgYW4gb3B0aW9uYWwgbnVtZXJpYyBfZ2FtbWFfIHByb3BlcnR5IGFwcGxpY2FibGUgdG8gcmdiIGFuZCBjdWJlaGVsaXggaW50ZXJwb2xhdG9ycy4gRm9yIG1vcmUsIHNlZSB0aGUgW2QzLWludGVycG9sYXRlIGRvY3VtZW50YXRpb25dKGh0dHBzOi8vZ2l0aHViLmNvbS9kMy9kMy1pbnRlcnBvbGF0ZSkuXG4gICAqXG4gICAqIF9fTm90ZTpfXyBTZXF1ZW50aWFsIHNjYWxlcyBkbyBub3Qgc3VwcG9ydCBgaW50ZXJwb2xhdGVgIGFzIHRoZXkgaGF2ZSBhIGZpeGVkIGludGVycG9sYXRvci4gIFNpbmNlIFZlZ2EtTGl0ZSB1c2VzIHNlcXVlbnRpYWwgc2NhbGVzIGZvciBxdWFudGl0YXRpdmUgZmllbGRzIGJ5IGRlZmF1bHQsIHlvdSBoYXZlIHRvIHNldCB0aGUgc2NhbGUgYHR5cGVgIHRvIG90aGVyIHF1YW50aXRhdGl2ZSBzY2FsZSB0eXBlIHN1Y2ggYXMgYFwibGluZWFyXCJgIHRvIGN1c3RvbWl6ZSBgaW50ZXJwb2xhdGVgLlxuICAgKi9cbiAgaW50ZXJwb2xhdGU/OiBTY2FsZUludGVycG9sYXRlIHwgU2NhbGVJbnRlcnBvbGF0ZVBhcmFtcztcbn1cblxuY29uc3QgU0NBTEVfUFJPUEVSVFlfSU5ERVg6IEZsYWc8a2V5b2YgU2NhbGU+ID0ge1xuICB0eXBlOiAxLFxuICBkb21haW46IDEsXG4gIHJhbmdlOiAxLFxuICByYW5nZVN0ZXA6IDEsXG4gIHNjaGVtZTogMSxcbiAgLy8gT3RoZXIgcHJvcGVydGllc1xuICByZXZlcnNlOiAxLFxuICByb3VuZDogMSxcbiAgLy8gcXVhbnRpdGF0aXZlIC8gdGltZVxuICBjbGFtcDogMSxcbiAgbmljZTogMSxcbiAgLy8gcXVhbnRpdGF0aXZlXG4gIGJhc2U6IDEsXG4gIGV4cG9uZW50OiAxLFxuICBpbnRlcnBvbGF0ZTogMSxcbiAgemVybzogMSwgLy8gemVybyBkZXBlbmRzIG9uIGRvbWFpblxuICAvLyBiYW5kL3BvaW50XG4gIHBhZGRpbmc6IDEsXG4gIHBhZGRpbmdJbm5lcjogMSxcbiAgcGFkZGluZ091dGVyOiAxXG59O1xuXG5leHBvcnQgY29uc3QgU0NBTEVfUFJPUEVSVElFUyA9IGZsYWdLZXlzKFNDQUxFX1BST1BFUlRZX0lOREVYKTtcblxuY29uc3Qge3R5cGUsIGRvbWFpbiwgcmFuZ2UsIHJhbmdlU3RlcCwgc2NoZW1lLCAuLi5OT05fVFlQRV9ET01BSU5fUkFOR0VfVkVHQV9TQ0FMRV9QUk9QRVJUWV9JTkRFWH0gPSBTQ0FMRV9QUk9QRVJUWV9JTkRFWDtcblxuZXhwb3J0IGNvbnN0IE5PTl9UWVBFX0RPTUFJTl9SQU5HRV9WRUdBX1NDQUxFX1BST1BFUlRJRVMgPSBmbGFnS2V5cyhOT05fVFlQRV9ET01BSU5fUkFOR0VfVkVHQV9TQ0FMRV9QUk9QRVJUWV9JTkRFWCk7XG5cbmV4cG9ydCBjb25zdCBTQ0FMRV9UWVBFX0lOREVYID0gZ2VuZXJhdGVTY2FsZVR5cGVJbmRleCgpO1xuXG5leHBvcnQgZnVuY3Rpb24gc2NhbGVUeXBlU3VwcG9ydFByb3BlcnR5KHNjYWxlVHlwZTogU2NhbGVUeXBlLCBwcm9wTmFtZToga2V5b2YgU2NhbGUpIHtcbiAgc3dpdGNoIChwcm9wTmFtZSkge1xuICAgIGNhc2UgJ3R5cGUnOlxuICAgIGNhc2UgJ2RvbWFpbic6XG4gICAgY2FzZSAncmV2ZXJzZSc6XG4gICAgY2FzZSAncmFuZ2UnOlxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgY2FzZSAnc2NoZW1lJzpcbiAgICAgIHJldHVybiBjb250YWlucyhbJ3NlcXVlbnRpYWwnLCAnb3JkaW5hbCcsICdiaW4tb3JkaW5hbCcsICdxdWFudGlsZScsICdxdWFudGl6ZSddLCBzY2FsZVR5cGUpO1xuICAgIGNhc2UgJ2ludGVycG9sYXRlJzpcbiAgICAgIC8vIEZJWE1FKGh0dHBzOi8vZ2l0aHViLmNvbS92ZWdhL3ZlZ2EtbGl0ZS9pc3N1ZXMvMjkwMikgaG93IGFib3V0IG9yZGluYWw/XG4gICAgICByZXR1cm4gY29udGFpbnMoWydsaW5lYXInLCAnYmluLWxpbmVhcicsICdwb3cnLCAnbG9nJywgJ3NxcnQnLCAndXRjJywgJ3RpbWUnXSwgc2NhbGVUeXBlKTtcbiAgICBjYXNlICdyb3VuZCc6XG4gICAgICByZXR1cm4gaXNDb250aW51b3VzVG9Db250aW51b3VzKHNjYWxlVHlwZSkgfHwgc2NhbGVUeXBlID09PSAnYmFuZCcgfHwgc2NhbGVUeXBlID09PSAncG9pbnQnO1xuICAgIGNhc2UgJ3BhZGRpbmcnOlxuICAgICAgcmV0dXJuIGlzQ29udGludW91c1RvQ29udGludW91cyhzY2FsZVR5cGUpIHx8IGNvbnRhaW5zKFsncG9pbnQnLCAnYmFuZCddLCBzY2FsZVR5cGUpO1xuICAgIGNhc2UgJ3BhZGRpbmdPdXRlcic6XG4gICAgY2FzZSAncmFuZ2VTdGVwJzpcbiAgICAgIHJldHVybiBjb250YWlucyhbJ3BvaW50JywgJ2JhbmQnXSwgc2NhbGVUeXBlKTtcbiAgICBjYXNlICdwYWRkaW5nSW5uZXInOlxuICAgICAgcmV0dXJuIHNjYWxlVHlwZSA9PT0gJ2JhbmQnO1xuICAgIGNhc2UgJ2NsYW1wJzpcbiAgICAgIHJldHVybiBpc0NvbnRpbnVvdXNUb0NvbnRpbnVvdXMoc2NhbGVUeXBlKSB8fCBzY2FsZVR5cGUgPT09ICdzZXF1ZW50aWFsJztcbiAgICBjYXNlICduaWNlJzpcbiAgICAgIHJldHVybiBpc0NvbnRpbnVvdXNUb0NvbnRpbnVvdXMoc2NhbGVUeXBlKSB8fCBzY2FsZVR5cGUgPT09ICdzZXF1ZW50aWFsJyB8fCBzY2FsZVR5cGUgYXMgYW55ID09PSAncXVhbnRpemUnO1xuICAgIGNhc2UgJ2V4cG9uZW50JzpcbiAgICAgIHJldHVybiBzY2FsZVR5cGUgPT09ICdwb3cnO1xuICAgIGNhc2UgJ2Jhc2UnOlxuICAgICAgcmV0dXJuIHNjYWxlVHlwZSA9PT0gJ2xvZyc7XG4gICAgY2FzZSAnemVybyc6XG4gICAgICByZXR1cm4gaGFzQ29udGludW91c0RvbWFpbihzY2FsZVR5cGUpICYmICFjb250YWlucyhbXG4gICAgICAgICdsb2cnLCAgLy8gbG9nIHNjYWxlIGNhbm5vdCBoYXZlIHplcm8gdmFsdWVcbiAgICAgICAgJ3RpbWUnLCAndXRjJywgLy8gemVybyBpcyBub3QgbWVhbmluZ2Z1bCBmb3IgdGltZVxuICAgICAgICAnYmluLWxpbmVhcicsIC8vIGJpbm5pbmcgc2hvdWxkIG5vdCBhdXRvbWF0aWNhbGx5IGFkZCB6ZXJvXG4gICAgICAgICd0aHJlc2hvbGQnLCAvLyB0aHJlc2hvbGQgcmVxdWlyZXMgY3VzdG9tIGRvbWFpbiBzbyB6ZXJvIGRvZXMgbm90IG1hdHRlclxuICAgICAgICAncXVhbnRpbGUnIC8vIHF1YW50aWxlIGRlcGVuZHMgb24gZGlzdHJpYnV0aW9uIHNvIHplcm8gZG9lcyBub3QgbWF0dGVyXG4gICAgICBdLCBzY2FsZVR5cGUpO1xuICB9XG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBzaG91bGQgbmV2ZXIgcmVhY2ggaGVyZSovXG4gIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBzY2FsZSBwcm9wZXJ0eSAke3Byb3BOYW1lfS5gKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHVuZGVmaW5lZCBpZiB0aGUgaW5wdXQgY2hhbm5lbCBzdXBwb3J0cyB0aGUgaW5wdXQgc2NhbGUgcHJvcGVydHkgbmFtZVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2hhbm5lbFNjYWxlUHJvcGVydHlJbmNvbXBhdGFiaWxpdHkoY2hhbm5lbDogQ2hhbm5lbCwgcHJvcE5hbWU6IGtleW9mIFNjYWxlKTogc3RyaW5nIHtcbiAgc3dpdGNoIChwcm9wTmFtZSkge1xuICAgIGNhc2UgJ2ludGVycG9sYXRlJzpcbiAgICBjYXNlICdzY2hlbWUnOlxuICAgICAgaWYgKCFpc0NvbG9yQ2hhbm5lbChjaGFubmVsKSkge1xuICAgICAgICByZXR1cm4gbG9nLm1lc3NhZ2UuY2Fubm90VXNlU2NhbGVQcm9wZXJ0eVdpdGhOb25Db2xvcihjaGFubmVsKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgY2FzZSAndHlwZSc6XG4gICAgY2FzZSAnZG9tYWluJzpcbiAgICBjYXNlICdyYW5nZSc6XG4gICAgY2FzZSAnYmFzZSc6XG4gICAgY2FzZSAnZXhwb25lbnQnOlxuICAgIGNhc2UgJ25pY2UnOlxuICAgIGNhc2UgJ3BhZGRpbmcnOlxuICAgIGNhc2UgJ3BhZGRpbmdJbm5lcic6XG4gICAgY2FzZSAncGFkZGluZ091dGVyJzpcbiAgICBjYXNlICdyYW5nZVN0ZXAnOlxuICAgIGNhc2UgJ3JldmVyc2UnOlxuICAgIGNhc2UgJ3JvdW5kJzpcbiAgICBjYXNlICdjbGFtcCc6XG4gICAgY2FzZSAnemVybyc6XG4gICAgICByZXR1cm4gdW5kZWZpbmVkOyAvLyBHT09EIVxuICB9XG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBpdCBzaG91bGQgbmV2ZXIgcmVhY2ggaGVyZSAqL1xuICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgc2NhbGUgcHJvcGVydHkgXCIke3Byb3BOYW1lfVwiLmApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2NhbGVUeXBlU3VwcG9ydERhdGFUeXBlKHNwZWNpZmllZFR5cGU6IFNjYWxlVHlwZSwgZmllbGREZWZUeXBlOiBUeXBlLCBiaW46IGJvb2xlYW58QmluUGFyYW1zKTpib29sZWFuIHtcbiAgaWYgKGNvbnRhaW5zKFtUeXBlLk9SRElOQUwsIFR5cGUuTk9NSU5BTF0sIGZpZWxkRGVmVHlwZSkpIHtcbiAgICByZXR1cm4gc3BlY2lmaWVkVHlwZSA9PT0gdW5kZWZpbmVkIHx8IGhhc0Rpc2NyZXRlRG9tYWluKHNwZWNpZmllZFR5cGUpO1xuICB9IGVsc2UgaWYgKGZpZWxkRGVmVHlwZSA9PT0gVHlwZS5URU1QT1JBTCkge1xuICAgIHJldHVybiBjb250YWlucyhbU2NhbGVUeXBlLlRJTUUsIFNjYWxlVHlwZS5VVEMsIFNjYWxlVHlwZS5TRVFVRU5USUFMLCB1bmRlZmluZWRdLCBzcGVjaWZpZWRUeXBlKTtcbiAgfSBlbHNlIGlmIChmaWVsZERlZlR5cGUgPT09IFR5cGUuUVVBTlRJVEFUSVZFKSB7XG4gICAgaWYgKGJpbikge1xuICAgICAgcmV0dXJuIGNvbnRhaW5zKFtTY2FsZVR5cGUuQklOX0xJTkVBUiwgU2NhbGVUeXBlLkJJTl9PUkRJTkFMLCBTY2FsZVR5cGUuTElORUFSXSwgc3BlY2lmaWVkVHlwZSk7XG4gICAgfVxuICAgIHJldHVybiBjb250YWlucyhbU2NhbGVUeXBlLkxPRywgU2NhbGVUeXBlLlBPVywgU2NhbGVUeXBlLlNRUlQsIFNjYWxlVHlwZS5RVUFOVElMRSwgU2NhbGVUeXBlLlFVQU5USVpFLCBTY2FsZVR5cGUuTElORUFSLCBTY2FsZVR5cGUuU0VRVUVOVElBTCwgdW5kZWZpbmVkXSwgc3BlY2lmaWVkVHlwZSk7XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNoYW5uZWxTdXBwb3J0U2NhbGVUeXBlKGNoYW5uZWw6IENoYW5uZWwsIHNjYWxlVHlwZTogU2NhbGVUeXBlKTogYm9vbGVhbiB7XG4gIHN3aXRjaCAoY2hhbm5lbCkge1xuICAgIGNhc2UgQ2hhbm5lbC5YOlxuICAgIGNhc2UgQ2hhbm5lbC5ZOlxuICAgIGNhc2UgQ2hhbm5lbC5TSVpFOiAvLyBUT0RPOiBzaXplIGFuZCBvcGFjaXR5IGNhbiBzdXBwb3J0IG9yZGluYWwgd2l0aCBtb3JlIG1vZGlmaWNhdGlvblxuICAgIGNhc2UgQ2hhbm5lbC5PUEFDSVRZOlxuICAgICAgLy8gQWx0aG91Z2ggaXQgZ2VuZXJhbGx5IGRvZXNuJ3QgbWFrZSBzZW5zZSB0byB1c2UgYmFuZCB3aXRoIHNpemUgYW5kIG9wYWNpdHksXG4gICAgICAvLyBpdCBjYW4gYWxzbyB3b3JrIHNpbmNlIHdlIHVzZSBiYW5kOiAwLjUgdG8gZ2V0IG1pZHBvaW50LlxuICAgICAgcmV0dXJuIGlzQ29udGludW91c1RvQ29udGludW91cyhzY2FsZVR5cGUpIHx8IGNvbnRhaW5zKFsnYmFuZCcsICdwb2ludCddLCBzY2FsZVR5cGUpO1xuXG4gICAgY2FzZSBDaGFubmVsLkNPTE9SOlxuICAgIGNhc2UgQ2hhbm5lbC5GSUxMOlxuICAgIGNhc2UgQ2hhbm5lbC5TVFJPS0U6XG4gICAgICByZXR1cm4gc2NhbGVUeXBlICE9PSAnYmFuZCc7ICAgIC8vIGJhbmQgZG9lcyBub3QgbWFrZSBzZW5zZSB3aXRoIGNvbG9yXG5cbiAgICBjYXNlIENoYW5uZWwuU0hBUEU6XG4gICAgICByZXR1cm4gc2NhbGVUeXBlID09PSAnb3JkaW5hbCc7IC8vIHNoYXBlID0gbG9va3VwIG9ubHlcbiAgfVxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dDogaXQgc2hvdWxkIG5ldmVyIHJlYWNoIGhlcmUgKi9cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3VwcG9ydGVkU2NhbGVUeXBlKGNoYW5uZWw6IENoYW5uZWwsIGZpZWxkRGVmVHlwZTogVHlwZSwgYmluPzogYm9vbGVhbikge1xuICByZXR1cm4gU0NBTEVfVFlQRV9JTkRFWFtnZW5lcmF0ZVNjYWxlVHlwZUluZGV4S2V5KGNoYW5uZWwsIGZpZWxkRGVmVHlwZSwgYmluKV07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2NhbGVUeXBlSW5kZXgge1xuICBbY2hhbm5lbDogc3RyaW5nXTogU2NhbGVUeXBlW107XG59XG5cbi8vIGdlbmVyYXRlcyBTY2FsZVR5cGVJbmRleCB3aGVyZSBrZXlzIGFyZSBlbmNvZGluZyBjaGFubmVscyBhbmQgdmFsdWVzIGFyZSBsaXN0IG9mIHZhbGlkIFNjYWxlVHlwZXNcbmZ1bmN0aW9uIGdlbmVyYXRlU2NhbGVUeXBlSW5kZXgoKSB7XG4gIGNvbnN0IGluZGV4OiBTY2FsZVR5cGVJbmRleCA9IHt9O1xuICBmb3IgKGNvbnN0IGNoYW5uZWwgb2YgQ0hBTk5FTFMpIHtcbiAgICBmb3IgKGNvbnN0IGZpZWxkRGVmVHlwZSBvZiBrZXlzKFRZUEVfSU5ERVgpKSB7XG4gICAgICBmb3IgKGNvbnN0IHNjYWxlVHlwZSBvZiBTQ0FMRV9UWVBFUykge1xuICAgICAgICBmb3IgKGNvbnN0IGJpbiBvZiBbZmFsc2UsIHRydWVdKSB7XG4gICAgICAgICAgY29uc3Qga2V5ID0gZ2VuZXJhdGVTY2FsZVR5cGVJbmRleEtleShjaGFubmVsLCBmaWVsZERlZlR5cGUsIGJpbik7XG4gICAgICAgICAgaWYgKGNoYW5uZWxTdXBwb3J0U2NhbGVUeXBlKGNoYW5uZWwsIHNjYWxlVHlwZSkgJiYgc2NhbGVUeXBlU3VwcG9ydERhdGFUeXBlKHNjYWxlVHlwZSwgZmllbGREZWZUeXBlLCBiaW4pKSB7XG4gICAgICAgICAgICBpbmRleFtrZXldID0gaW5kZXhba2V5XSB8fCBbXTtcbiAgICAgICAgICAgIGluZGV4W2tleV0ucHVzaChzY2FsZVR5cGUpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gaW5kZXg7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlU2NhbGVUeXBlSW5kZXhLZXkoY2hhbm5lbDogQ2hhbm5lbCwgZmllbGREZWZUeXBlOiBUeXBlLCBiaW46IGJvb2xlYW4pIHtcbiAgY29uc3Qga2V5ID0gY2hhbm5lbCArICdfJyArIGZpZWxkRGVmVHlwZTtcbiAgcmV0dXJuIGJpbiA/IGtleSArICdfYmluJyA6IGtleTtcbn1cbiJdfQ==","export var SELECTION_ID = '_vgsid_';\nexport var defaultConfig = {\n    single: {\n        on: 'click',\n        fields: [SELECTION_ID],\n        resolve: 'global',\n        empty: 'all'\n    },\n    multi: {\n        on: 'click',\n        fields: [SELECTION_ID],\n        toggle: 'event.shiftKey',\n        resolve: 'global',\n        empty: 'all'\n    },\n    interval: {\n        on: '[mousedown, window:mouseup] > window:mousemove!',\n        encodings: ['x', 'y'],\n        translate: '[mousedown, window:mouseup] > window:mousemove!',\n        zoom: 'wheel!',\n        mark: { fill: '#333', fillOpacity: 0.125, stroke: 'white' },\n        resolve: 'global'\n    }\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VsZWN0aW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3NlbGVjdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQSxNQUFNLENBQUMsSUFBTSxZQUFZLEdBQUcsU0FBUyxDQUFDO0FBMk10QyxNQUFNLENBQUMsSUFBTSxhQUFhLEdBQW1CO0lBQzNDLE1BQU0sRUFBRTtRQUNOLEVBQUUsRUFBRSxPQUFPO1FBQ1gsTUFBTSxFQUFFLENBQUMsWUFBWSxDQUFDO1FBQ3RCLE9BQU8sRUFBRSxRQUFRO1FBQ2pCLEtBQUssRUFBRSxLQUFLO0tBQ2I7SUFDRCxLQUFLLEVBQUU7UUFDTCxFQUFFLEVBQUUsT0FBTztRQUNYLE1BQU0sRUFBRSxDQUFDLFlBQVksQ0FBQztRQUN0QixNQUFNLEVBQUUsZ0JBQWdCO1FBQ3hCLE9BQU8sRUFBRSxRQUFRO1FBQ2pCLEtBQUssRUFBRSxLQUFLO0tBQ2I7SUFDRCxRQUFRLEVBQUU7UUFDUixFQUFFLEVBQUUsaURBQWlEO1FBQ3JELFNBQVMsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDckIsU0FBUyxFQUFFLGlEQUFpRDtRQUM1RCxJQUFJLEVBQUUsUUFBUTtRQUNkLElBQUksRUFBRSxFQUFDLElBQUksRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFDO1FBQ3pELE9BQU8sRUFBRSxRQUFRO0tBQ2xCO0NBQ0YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7U2luZ2xlRGVmQ2hhbm5lbH0gZnJvbSAnLi9jaGFubmVsJztcbmltcG9ydCB7VmdCaW5kaW5nLCBWZ0V2ZW50U3RyZWFtfSBmcm9tICcuL3ZlZ2Euc2NoZW1hJztcblxuZXhwb3J0IGNvbnN0IFNFTEVDVElPTl9JRCA9ICdfdmdzaWRfJztcbmV4cG9ydCB0eXBlIFNlbGVjdGlvblR5cGUgPSAnc2luZ2xlJyB8ICdtdWx0aScgfCAnaW50ZXJ2YWwnO1xuZXhwb3J0IHR5cGUgU2VsZWN0aW9uUmVzb2x1dGlvbiA9ICdnbG9iYWwnIHwgJ3VuaW9uJyB8ICdpbnRlcnNlY3QnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEJhc2VTZWxlY3Rpb25EZWYge1xuICAvKipcbiAgICogQSBbVmVnYSBldmVudCBzdHJlYW1dKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS9kb2NzL2V2ZW50LXN0cmVhbXMvKSAob2JqZWN0IG9yIHNlbGVjdG9yKSB0aGF0IHRyaWdnZXJzIHRoZSBzZWxlY3Rpb24uXG4gICAqIEZvciBpbnRlcnZhbCBzZWxlY3Rpb25zLCB0aGUgZXZlbnQgc3RyZWFtIG11c3Qgc3BlY2lmeSBhIFtzdGFydCBhbmQgZW5kXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EvZG9jcy9ldmVudC1zdHJlYW1zLyNiZXR3ZWVuLWZpbHRlcnMpLlxuICAgKi9cbiAgb24/OiBWZ0V2ZW50U3RyZWFtO1xuICAvKipcbiAgICogV2l0aCBsYXllcmVkIGFuZCBtdWx0aS12aWV3IGRpc3BsYXlzLCBhIHN0cmF0ZWd5IHRoYXQgZGV0ZXJtaW5lcyBob3dcbiAgICogc2VsZWN0aW9ucycgZGF0YSBxdWVyaWVzIGFyZSByZXNvbHZlZCB3aGVuIGFwcGxpZWQgaW4gYSBmaWx0ZXIgdHJhbnNmb3JtLFxuICAgKiBjb25kaXRpb25hbCBlbmNvZGluZyBydWxlLCBvciBzY2FsZSBkb21haW4uXG4gICAqXG4gICAqL1xuICByZXNvbHZlPzogU2VsZWN0aW9uUmVzb2x1dGlvbjtcblxuICAvLyBUT0RPKGh0dHBzOi8vZ2l0aHViLmNvbS92ZWdhL3ZlZ2EtbGl0ZS9pc3N1ZXMvMjU5NikuXG4gIC8vIHByZWRpY2F0ZT86IHN0cmluZztcbiAgLy8gZG9tYWluPzogU2VsZWN0aW9uRG9tYWluO1xuXG4gIC8vIFRyYW5zZm9ybXNcblxuICAvKipcbiAgICogQW4gYXJyYXkgb2YgZW5jb2RpbmcgY2hhbm5lbHMuIFRoZSBjb3JyZXNwb25kaW5nIGRhdGEgZmllbGQgdmFsdWVzXG4gICAqIG11c3QgbWF0Y2ggZm9yIGEgZGF0YSB0dXBsZSB0byBmYWxsIHdpdGhpbiB0aGUgc2VsZWN0aW9uLlxuICAgKi9cbiAgZW5jb2RpbmdzPzogU2luZ2xlRGVmQ2hhbm5lbFtdO1xuXG4gIC8qKlxuICAgKiBBbiBhcnJheSBvZiBmaWVsZCBuYW1lcyB3aG9zZSB2YWx1ZXMgbXVzdCBtYXRjaCBmb3IgYSBkYXRhIHR1cGxlIHRvXG4gICAqIGZhbGwgd2l0aGluIHRoZSBzZWxlY3Rpb24uXG4gICAqL1xuICBmaWVsZHM/OiBzdHJpbmdbXTtcblxuICAvKipcbiAgICogQnkgZGVmYXVsdCwgYWxsIGRhdGEgdmFsdWVzIGFyZSBjb25zaWRlcmVkIHRvIGxpZSB3aXRoaW4gYW4gZW1wdHkgc2VsZWN0aW9uLlxuICAgKiBXaGVuIHNldCB0byBgbm9uZWAsIGVtcHR5IHNlbGVjdGlvbnMgY29udGFpbiBubyBkYXRhIHZhbHVlcy5cbiAgICovXG4gIGVtcHR5PzogJ2FsbCcgfCAnbm9uZSc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2luZ2xlU2VsZWN0aW9uQ29uZmlnIGV4dGVuZHMgQmFzZVNlbGVjdGlvbkRlZiB7XG4gIC8qKlxuICAgKiBFc3RhYmxpc2ggYSB0d28td2F5IGJpbmRpbmcgYmV0d2VlbiBhIHNpbmdsZSBzZWxlY3Rpb24gYW5kIGlucHV0IGVsZW1lbnRzXG4gICAqIChhbHNvIGtub3duIGFzIGR5bmFtaWMgcXVlcnkgd2lkZ2V0cykuIEEgYmluZGluZyB0YWtlcyB0aGUgZm9ybSBvZlxuICAgKiBWZWdhJ3MgW2lucHV0IGVsZW1lbnQgYmluZGluZyBkZWZpbml0aW9uXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EvZG9jcy9zaWduYWxzLyNiaW5kKVxuICAgKiBvciBjYW4gYmUgYSBtYXBwaW5nIGJldHdlZW4gcHJvamVjdGVkIGZpZWxkL2VuY29kaW5ncyBhbmQgYmluZGluZyBkZWZpbml0aW9ucy5cbiAgICpcbiAgICogU2VlIHRoZSBbYmluZCB0cmFuc2Zvcm1dKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvYmluZC5odG1sKSBkb2N1bWVudGF0aW9uIGZvciBtb3JlIGluZm9ybWF0aW9uLlxuICAgKi9cbiAgYmluZD86IFZnQmluZGluZyB8IHtba2V5OiBzdHJpbmddOiBWZ0JpbmRpbmd9O1xuXG4gIC8qKlxuICAgKiBXaGVuIHRydWUsIGFuIGludmlzaWJsZSB2b3Jvbm9pIGRpYWdyYW0gaXMgY29tcHV0ZWQgdG8gYWNjZWxlcmF0ZSBkaXNjcmV0ZVxuICAgKiBzZWxlY3Rpb24uIFRoZSBkYXRhIHZhbHVlIF9uZWFyZXN0XyB0aGUgbW91c2UgY3Vyc29yIGlzIGFkZGVkIHRvIHRoZSBzZWxlY3Rpb24uXG4gICAqXG4gICAqIFNlZSB0aGUgW25lYXJlc3QgdHJhbnNmb3JtXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL25lYXJlc3QuaHRtbCkgZG9jdW1lbnRhdGlvbiBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cbiAgICovXG4gIG5lYXJlc3Q/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE11bHRpU2VsZWN0aW9uQ29uZmlnIGV4dGVuZHMgQmFzZVNlbGVjdGlvbkRlZiB7XG4gIC8qKlxuICAgKiBDb250cm9scyB3aGV0aGVyIGRhdGEgdmFsdWVzIHNob3VsZCBiZSB0b2dnbGVkIG9yIG9ubHkgZXZlciBpbnNlcnRlZCBpbnRvXG4gICAqIG11bHRpIHNlbGVjdGlvbnMuIENhbiBiZSBgdHJ1ZWAsIGBmYWxzZWAgKGZvciBpbnNlcnRpb24gb25seSksIG9yIGFcbiAgICogW1ZlZ2EgZXhwcmVzc2lvbl0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhL2RvY3MvZXhwcmVzc2lvbnMvKS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGB0cnVlYCwgd2hpY2ggY29ycmVzcG9uZHMgdG8gYGV2ZW50LnNoaWZ0S2V5YCAoaS5lLixcbiAgICogZGF0YSB2YWx1ZXMgYXJlIHRvZ2dsZWQgd2hlbiBhIHVzZXIgaW50ZXJhY3RzIHdpdGggdGhlIHNoaWZ0LWtleSBwcmVzc2VkKS5cbiAgICpcbiAgICogU2VlIHRoZSBbdG9nZ2xlIHRyYW5zZm9ybV0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy90b2dnbGUuaHRtbCkgZG9jdW1lbnRhdGlvbiBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cbiAgICovXG4gIHRvZ2dsZT86IHN0cmluZyB8IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFdoZW4gdHJ1ZSwgYW4gaW52aXNpYmxlIHZvcm9ub2kgZGlhZ3JhbSBpcyBjb21wdXRlZCB0byBhY2NlbGVyYXRlIGRpc2NyZXRlXG4gICAqIHNlbGVjdGlvbi4gVGhlIGRhdGEgdmFsdWUgX25lYXJlc3RfIHRoZSBtb3VzZSBjdXJzb3IgaXMgYWRkZWQgdG8gdGhlIHNlbGVjdGlvbi5cbiAgICpcbiAgICogU2VlIHRoZSBbbmVhcmVzdCB0cmFuc2Zvcm1dKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvbmVhcmVzdC5odG1sKSBkb2N1bWVudGF0aW9uIGZvciBtb3JlIGluZm9ybWF0aW9uLlxuICAgKi9cbiAgbmVhcmVzdD86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQnJ1c2hDb25maWcge1xuICAvKipcbiAgICogVGhlIGZpbGwgY29sb3Igb2YgdGhlIGludGVydmFsIG1hcmsuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgIzMzMzMzM2BcbiAgICpcbiAgICovXG4gIGZpbGw/OiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgZmlsbCBvcGFjaXR5IG9mIHRoZSBpbnRlcnZhbCBtYXJrIChhIHZhbHVlIGJldHdlZW4gMCBhbmQgMSkuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgMC4xMjVgXG4gICAqL1xuICBmaWxsT3BhY2l0eT86IG51bWJlcjtcbiAgLyoqXG4gICAqIFRoZSBzdHJva2UgY29sb3Igb2YgdGhlIGludGVydmFsIG1hcmsuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgI2ZmZmZmZmBcbiAgICovXG4gIHN0cm9rZT86IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSBzdHJva2Ugb3BhY2l0eSBvZiB0aGUgaW50ZXJ2YWwgbWFyayAoYSB2YWx1ZSBiZXR3ZWVuIDAgYW5kIDEpLlxuICAgKi9cbiAgc3Ryb2tlT3BhY2l0eT86IG51bWJlcjtcbiAgLyoqXG4gICAqIFRoZSBzdHJva2Ugd2lkdGggb2YgdGhlIGludGVydmFsIG1hcmsuXG4gICAqL1xuICBzdHJva2VXaWR0aD86IG51bWJlcjtcbiAgLyoqXG4gICAqIEFuIGFycmF5IG9mIGFsdGVybmF0aW5nIHN0cm9rZSBhbmQgc3BhY2UgbGVuZ3RocyxcbiAgICogZm9yIGNyZWF0aW5nIGRhc2hlZCBvciBkb3R0ZWQgbGluZXMuXG4gICAqL1xuICBzdHJva2VEYXNoPzogbnVtYmVyW107XG4gIC8qKlxuICAgKiBUaGUgb2Zmc2V0IChpbiBwaXhlbHMpIHdpdGggd2hpY2ggdG8gYmVnaW4gZHJhd2luZyB0aGUgc3Ryb2tlIGRhc2ggYXJyYXkuXG4gICAqL1xuICBzdHJva2VEYXNoT2Zmc2V0PzogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEludGVydmFsU2VsZWN0aW9uQ29uZmlnIGV4dGVuZHMgQmFzZVNlbGVjdGlvbkRlZiB7XG4gIC8qKlxuICAgKiBXaGVuIHRydXRoeSwgYWxsb3dzIGEgdXNlciB0byBpbnRlcmFjdGl2ZWx5IG1vdmUgYW4gaW50ZXJ2YWwgc2VsZWN0aW9uXG4gICAqIGJhY2stYW5kLWZvcnRoLiBDYW4gYmUgYHRydWVgLCBgZmFsc2VgICh0byBkaXNhYmxlIHBhbm5pbmcpLCBvciBhXG4gICAqIFtWZWdhIGV2ZW50IHN0cmVhbSBkZWZpbml0aW9uXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EvZG9jcy9ldmVudC1zdHJlYW1zLylcbiAgICogd2hpY2ggbXVzdCBpbmNsdWRlIGEgc3RhcnQgYW5kIGVuZCBldmVudCB0byB0cmlnZ2VyIGNvbnRpbnVvdXMgcGFubmluZy5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGB0cnVlYCwgd2hpY2ggY29ycmVzcG9uZHMgdG9cbiAgICogYFttb3VzZWRvd24sIHdpbmRvdzptb3VzZXVwXSA+IHdpbmRvdzptb3VzZW1vdmUhYCB3aGljaCBjb3JyZXNwb25kcyB0b1xuICAgKiBjbGlja3MgYW5kIGRyYWdnaW5nIHdpdGhpbiBhbiBpbnRlcnZhbCBzZWxlY3Rpb24gdG8gcmVwb3NpdGlvbiBpdC5cbiAgICovXG4gIHRyYW5zbGF0ZT86IHN0cmluZyB8IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFdoZW4gdHJ1dGh5LCBhbGxvd3MgYSB1c2VyIHRvIGludGVyYWN0aXZlbHkgcmVzaXplIGFuIGludGVydmFsIHNlbGVjdGlvbi5cbiAgICogQ2FuIGJlIGB0cnVlYCwgYGZhbHNlYCAodG8gZGlzYWJsZSB6b29taW5nKSwgb3IgYSBbVmVnYSBldmVudCBzdHJlYW1cbiAgICogZGVmaW5pdGlvbl0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhL2RvY3MvZXZlbnQtc3RyZWFtcy8pLiBDdXJyZW50bHksXG4gICAqIG9ubHkgYHdoZWVsYCBldmVudHMgYXJlIHN1cHBvcnRlZC5cbiAgICpcbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGB0cnVlYCwgd2hpY2ggY29ycmVzcG9uZHMgdG8gYHdoZWVsIWAuXG4gICAqL1xuICB6b29tPzogc3RyaW5nIHwgYm9vbGVhbjtcblxuICAvKipcbiAgICogRXN0YWJsaXNoZXMgYSB0d28td2F5IGJpbmRpbmcgYmV0d2VlbiB0aGUgaW50ZXJ2YWwgc2VsZWN0aW9uIGFuZCB0aGUgc2NhbGVzXG4gICAqIHVzZWQgd2l0aGluIHRoZSBzYW1lIHZpZXcuIFRoaXMgYWxsb3dzIGEgdXNlciB0byBpbnRlcmFjdGl2ZWx5IHBhbiBhbmRcbiAgICogem9vbSB0aGUgdmlldy5cbiAgICovXG4gIGJpbmQ/OiAnc2NhbGVzJztcblxuICAvKipcbiAgICogQW4gaW50ZXJ2YWwgc2VsZWN0aW9uIGFsc28gYWRkcyBhIHJlY3RhbmdsZSBtYXJrIHRvIGRlcGljdCB0aGVcbiAgICogZXh0ZW50cyBvZiB0aGUgaW50ZXJ2YWwuIFRoZSBgbWFya2AgcHJvcGVydHkgY2FuIGJlIHVzZWQgdG8gY3VzdG9taXplIHRoZVxuICAgKiBhcHBlYXJhbmNlIG9mIHRoZSBtYXJrLlxuICAgKi9cbiAgbWFyaz86IEJydXNoQ29uZmlnO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNpbmdsZVNlbGVjdGlvbiBleHRlbmRzIFNpbmdsZVNlbGVjdGlvbkNvbmZpZyB7XG4gIHR5cGU6ICdzaW5nbGUnO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE11bHRpU2VsZWN0aW9uIGV4dGVuZHMgTXVsdGlTZWxlY3Rpb25Db25maWcge1xuICB0eXBlOiAnbXVsdGknO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEludGVydmFsU2VsZWN0aW9uIGV4dGVuZHMgSW50ZXJ2YWxTZWxlY3Rpb25Db25maWcge1xuICB0eXBlOiAnaW50ZXJ2YWwnO1xufVxuXG5leHBvcnQgdHlwZSBTZWxlY3Rpb25EZWYgPSBTaW5nbGVTZWxlY3Rpb24gfCBNdWx0aVNlbGVjdGlvbiB8IEludGVydmFsU2VsZWN0aW9uO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNlbGVjdGlvbkNvbmZpZyB7XG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCBkZWZpbml0aW9uIGZvciBhIFtgc2luZ2xlYF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zZWxlY3Rpb24uaHRtbCN0eXBlKSBzZWxlY3Rpb24uIEFsbCBwcm9wZXJ0aWVzIGFuZCB0cmFuc2Zvcm1hdGlvbnNcbiAgICogIGZvciBhIHNpbmdsZSBzZWxlY3Rpb24gZGVmaW5pdGlvbiAoZXhjZXB0IGB0eXBlYCkgbWF5IGJlIHNwZWNpZmllZCBoZXJlLlxuICAgKlxuICAgKiBGb3IgaW5zdGFuY2UsIHNldHRpbmcgYHNpbmdsZWAgdG8gYHtcIm9uXCI6IFwiZGJsY2xpY2tcIn1gIHBvcHVsYXRlcyBzaW5nbGUgc2VsZWN0aW9ucyBvbiBkb3VibGUtY2xpY2sgYnkgZGVmYXVsdC5cbiAgICovXG4gIHNpbmdsZT86IFNpbmdsZVNlbGVjdGlvbkNvbmZpZztcbiAgLyoqXG4gICAqIFRoZSBkZWZhdWx0IGRlZmluaXRpb24gZm9yIGEgW2BtdWx0aWBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2VsZWN0aW9uLmh0bWwjdHlwZSkgc2VsZWN0aW9uLiBBbGwgcHJvcGVydGllcyBhbmQgdHJhbnNmb3JtYXRpb25zXG4gICAqIGZvciBhIG11bHRpIHNlbGVjdGlvbiBkZWZpbml0aW9uIChleGNlcHQgYHR5cGVgKSBtYXkgYmUgc3BlY2lmaWVkIGhlcmUuXG4gICAqXG4gICAqIEZvciBpbnN0YW5jZSwgc2V0dGluZyBgbXVsdGlgIHRvIGB7XCJ0b2dnbGVcIjogXCJldmVudC5hbHRLZXlcIn1gIGFkZHMgYWRkaXRpb25hbCB2YWx1ZXMgdG9cbiAgICogbXVsdGkgc2VsZWN0aW9ucyB3aGVuIGNsaWNraW5nIHdpdGggdGhlIGFsdC1rZXkgcHJlc3NlZCBieSBkZWZhdWx0LlxuICAgKi9cbiAgbXVsdGk/OiBNdWx0aVNlbGVjdGlvbkNvbmZpZztcbiAgLyoqXG4gICAqIFRoZSBkZWZhdWx0IGRlZmluaXRpb24gZm9yIGFuIFtgaW50ZXJ2YWxgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NlbGVjdGlvbi5odG1sI3R5cGUpIHNlbGVjdGlvbi4gQWxsIHByb3BlcnRpZXMgYW5kIHRyYW5zZm9ybWF0aW9uc1xuICAgKiBmb3IgYW4gaW50ZXJ2YWwgc2VsZWN0aW9uIGRlZmluaXRpb24gKGV4Y2VwdCBgdHlwZWApIG1heSBiZSBzcGVjaWZpZWQgaGVyZS5cbiAgICpcbiAgICogRm9yIGluc3RhbmNlLCBzZXR0aW5nIGBpbnRlcnZhbGAgdG8gYHtcInRyYW5zbGF0ZVwiOiBmYWxzZX1gIGRpc2FibGVzIHRoZSBhYmlsaXR5IHRvIG1vdmVcbiAgICogaW50ZXJ2YWwgc2VsZWN0aW9ucyBieSBkZWZhdWx0LlxuICAgKi9cbiAgaW50ZXJ2YWw/OiBJbnRlcnZhbFNlbGVjdGlvbkNvbmZpZztcbn1cblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRDb25maWc6U2VsZWN0aW9uQ29uZmlnID0ge1xuICBzaW5nbGU6IHtcbiAgICBvbjogJ2NsaWNrJyxcbiAgICBmaWVsZHM6IFtTRUxFQ1RJT05fSURdLFxuICAgIHJlc29sdmU6ICdnbG9iYWwnLFxuICAgIGVtcHR5OiAnYWxsJ1xuICB9LFxuICBtdWx0aToge1xuICAgIG9uOiAnY2xpY2snLFxuICAgIGZpZWxkczogW1NFTEVDVElPTl9JRF0sXG4gICAgdG9nZ2xlOiAnZXZlbnQuc2hpZnRLZXknLFxuICAgIHJlc29sdmU6ICdnbG9iYWwnLFxuICAgIGVtcHR5OiAnYWxsJ1xuICB9LFxuICBpbnRlcnZhbDoge1xuICAgIG9uOiAnW21vdXNlZG93biwgd2luZG93Om1vdXNldXBdID4gd2luZG93Om1vdXNlbW92ZSEnLFxuICAgIGVuY29kaW5nczogWyd4JywgJ3knXSxcbiAgICB0cmFuc2xhdGU6ICdbbW91c2Vkb3duLCB3aW5kb3c6bW91c2V1cF0gPiB3aW5kb3c6bW91c2Vtb3ZlIScsXG4gICAgem9vbTogJ3doZWVsIScsXG4gICAgbWFyazoge2ZpbGw6ICcjMzMzJywgZmlsbE9wYWNpdHk6IDAuMTI1LCBzdHJva2U6ICd3aGl0ZSd9LFxuICAgIHJlc29sdmU6ICdnbG9iYWwnXG4gIH1cbn07XG4iXX0=","import * as tslib_1 from \"tslib\";\nexport function extractTitleConfig(titleConfig) {\n    var \n    // These are non-mark title config that need to be hardcoded\n    anchor = titleConfig.anchor, offset = titleConfig.offset, orient = titleConfig.orient, \n    // color needs to be redirect to fill\n    color = titleConfig.color, \n    // The rest are mark config.\n    titleMarkConfig = tslib_1.__rest(titleConfig, [\"anchor\", \"offset\", \"orient\", \"color\"]);\n    var mark = tslib_1.__assign({}, titleMarkConfig, color ? { fill: color } : {});\n    var nonMark = tslib_1.__assign({}, anchor ? { anchor: anchor } : {}, offset ? { offset: offset } : {}, orient ? { orient: orient } : {});\n    return { mark: mark, nonMark: nonMark };\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGl0bGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdGl0bGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQXdDQSxNQUFNLDZCQUE2QixXQUEwQjtJQU16RDtJQURBLDREQUE0RDtJQUM1RCwyQkFBTSxFQUFFLDJCQUFNLEVBQUUsMkJBQU07SUFDdEIscUNBQXFDO0lBQ3JDLHlCQUFLO0lBQ0wsNEJBQTRCO0lBQzVCLHNGQUFrQixDQUNKO0lBRWhCLElBQU0sSUFBSSx3QkFDTCxlQUFlLEVBQ2YsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFDLElBQUksRUFBRSxLQUFLLEVBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUM5QixDQUFDO0lBRUYsSUFBTSxPQUFPLHdCQUNSLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBQyxNQUFNLFFBQUEsRUFBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQ3RCLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBQyxNQUFNLFFBQUEsRUFBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQ3RCLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBQyxNQUFNLFFBQUEsRUFBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQzFCLENBQUM7SUFFRixPQUFPLEVBQUMsSUFBSSxNQUFBLEVBQUUsT0FBTyxTQUFBLEVBQUMsQ0FBQztBQUN6QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtBbmNob3IsIFRpdGxlT3JpZW50LCBWZ01hcmtDb25maWcsIFZnVGl0bGVDb25maWd9IGZyb20gJy4vdmVnYS5zY2hlbWEnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFRpdGxlQmFzZSB7XG4gIC8qKlxuICAgKiBUaGUgb3JpZW50YXRpb24gb2YgdGhlIHRpdGxlIHJlbGF0aXZlIHRvIHRoZSBjaGFydC4gT25lIG9mIGBcInRvcFwiYCAodGhlIGRlZmF1bHQpLCBgXCJib3R0b21cImAsIGBcImxlZnRcImAsIG9yIGBcInJpZ2h0XCJgLlxuICAgKi9cbiAgb3JpZW50PzogVGl0bGVPcmllbnQ7XG5cbiAgLyoqXG4gICAqIFRoZSBhbmNob3IgcG9zaXRpb24gZm9yIHBsYWNpbmcgdGhlIHRpdGxlLiBPbmUgb2YgYFwic3RhcnRcImAsIGBcIm1pZGRsZVwiYCwgb3IgYFwiZW5kXCJgLiBGb3IgZXhhbXBsZSwgd2l0aCBhbiBvcmllbnRhdGlvbiBvZiB0b3AgdGhlc2UgYW5jaG9yIHBvc2l0aW9ucyBtYXAgdG8gYSBsZWZ0LSwgY2VudGVyLSwgb3IgcmlnaHQtYWxpZ25lZCB0aXRsZS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBcIm1pZGRsZVwiYCBmb3IgW3NpbmdsZV0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zcGVjLmh0bWwpIGFuZCBbbGF5ZXJlZF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9sYXllci5odG1sKSB2aWV3cy5cbiAgICogYFwic3RhcnRcImAgZm9yIG90aGVyIGNvbXBvc2l0ZSB2aWV3cy5cbiAgICpcbiAgICogX19Ob3RlOl9fIFtGb3Igbm93XShodHRwczovL2dpdGh1Yi5jb20vdmVnYS92ZWdhLWxpdGUvaXNzdWVzLzI4NzUpLCBgYW5jaG9yYCBpcyBvbmx5IGN1c3RvbWl6YWJsZSBvbmx5IGZvciBbc2luZ2xlXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NwZWMuaHRtbCkgYW5kIFtsYXllcmVkXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL2xheWVyLmh0bWwpIHZpZXdzLiAgRm9yIG90aGVyIGNvbXBvc2l0ZSB2aWV3cywgYGFuY2hvcmAgaXMgYWx3YXlzIGBcInN0YXJ0XCJgLlxuICAgKi9cbiAgYW5jaG9yPzogQW5jaG9yO1xuXG4gIC8qKlxuICAgKiBUaGUgb3J0aG9nb25hbCBvZmZzZXQgaW4gcGl4ZWxzIGJ5IHdoaWNoIHRvIGRpc3BsYWNlIHRoZSB0aXRsZSBmcm9tIGl0cyBwb3NpdGlvbiBhbG9uZyB0aGUgZWRnZSBvZiB0aGUgY2hhcnQuXG4gICAqL1xuICBvZmZzZXQ/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIEEgW21hcmsgc3R5bGUgcHJvcGVydHldKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvY29uZmlnLmh0bWwjc3R5bGUpIHRvIGFwcGx5IHRvIHRoZSB0aXRsZSB0ZXh0IG1hcmsuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgXCJncm91cC10aXRsZVwiYC5cbiAgICovXG4gIHN0eWxlPzogc3RyaW5nIHwgc3RyaW5nW107XG5cbiAgLy8gVE9ETzogbmFtZSwgZW5jb2RlLCBpbnRlcmFjdGl2ZSwgemluZGV4XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGl0bGVQYXJhbXMgZXh0ZW5kcyBUaXRsZUJhc2Uge1xuICAvKipcbiAgICogVGhlIHRpdGxlIHRleHQuXG4gICAqL1xuICB0ZXh0OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBleHRyYWN0VGl0bGVDb25maWcodGl0bGVDb25maWc6IFZnVGl0bGVDb25maWcpOiB7XG4gIG1hcms6IFZnTWFya0NvbmZpZyxcbiAgbm9uTWFyazogVGl0bGVCYXNlXG59IHtcbiAgY29uc3Qge1xuICAgIC8vIFRoZXNlIGFyZSBub24tbWFyayB0aXRsZSBjb25maWcgdGhhdCBuZWVkIHRvIGJlIGhhcmRjb2RlZFxuICAgIGFuY2hvciwgb2Zmc2V0LCBvcmllbnQsXG4gICAgLy8gY29sb3IgbmVlZHMgdG8gYmUgcmVkaXJlY3QgdG8gZmlsbFxuICAgIGNvbG9yLFxuICAgIC8vIFRoZSByZXN0IGFyZSBtYXJrIGNvbmZpZy5cbiAgICAuLi50aXRsZU1hcmtDb25maWdcbiAgfSA9IHRpdGxlQ29uZmlnO1xuXG4gIGNvbnN0IG1hcms6IFZnTWFya0NvbmZpZyA9IHtcbiAgICAuLi50aXRsZU1hcmtDb25maWcsXG4gICAgLi4uY29sb3IgPyB7ZmlsbDogY29sb3J9IDoge31cbiAgfTtcblxuICBjb25zdCBub25NYXJrOiBUaXRsZUJhc2UgPSB7XG4gICAgLi4uYW5jaG9yID8ge2FuY2hvcn0gOiB7fSxcbiAgICAuLi5vZmZzZXQgPyB7b2Zmc2V0fSA6IHt9LFxuICAgIC4uLm9yaWVudCA/IHtvcmllbnR9IDoge31cbiAgfTtcblxuICByZXR1cm4ge21hcmssIG5vbk1hcmt9O1xufVxuIl19","import * as tslib_1 from \"tslib\";\nimport { isObject } from 'vega-util';\nimport { COMPOSITE_MARK_STYLES } from './compositemark';\nimport { VL_ONLY_COMPOSITE_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX } from './compositemark/index';\nimport { VL_ONLY_GUIDE_CONFIG } from './guide';\nimport { defaultLegendConfig } from './legend';\nimport { PRIMITIVE_MARKS, VL_ONLY_MARK_CONFIG_PROPERTIES, VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX } from './mark';\nimport * as mark from './mark';\nimport { defaultScaleConfig } from './scale';\nimport { defaultConfig as defaultSelectionConfig } from './selection';\nimport { extractTitleConfig } from './title';\nimport { duplicate, keys, mergeDeep } from './util';\nexport var defaultViewConfig = {\n    width: 200,\n    height: 200\n};\nexport var defaultConfig = {\n    padding: 5,\n    timeFormat: '',\n    countTitle: 'Number of Records',\n    invalidValues: 'filter',\n    view: defaultViewConfig,\n    mark: mark.defaultMarkConfig,\n    area: {},\n    bar: mark.defaultBarConfig,\n    circle: {},\n    geoshape: {},\n    line: {},\n    point: {},\n    rect: {},\n    rule: { color: 'black' },\n    square: {},\n    text: { color: 'black' },\n    tick: mark.defaultTickConfig,\n    trail: {},\n    box: { size: 14, extent: 1.5 },\n    boxWhisker: {},\n    boxMid: { color: 'white' },\n    scale: defaultScaleConfig,\n    projection: {},\n    axis: {},\n    axisX: {},\n    axisY: { minExtent: 30 },\n    axisLeft: {},\n    axisRight: {},\n    axisTop: {},\n    axisBottom: {},\n    axisBand: {},\n    legend: defaultLegendConfig,\n    selection: defaultSelectionConfig,\n    style: {},\n    title: {},\n};\nexport function initConfig(config) {\n    return mergeDeep(duplicate(defaultConfig), config);\n}\nvar MARK_STYLES = ['view'].concat(PRIMITIVE_MARKS, COMPOSITE_MARK_STYLES);\nvar VL_ONLY_CONFIG_PROPERTIES = [\n    'padding', 'numberFormat', 'timeFormat', 'countTitle',\n    'stack', 'scale', 'selection', 'invalidValues',\n    'overlay' // FIXME: Redesign and unhide this\n];\nvar VL_ONLY_ALL_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX = tslib_1.__assign({ view: ['width', 'height'] }, VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX, VL_ONLY_COMPOSITE_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX);\nexport function stripAndRedirectConfig(config) {\n    config = duplicate(config);\n    for (var _i = 0, VL_ONLY_CONFIG_PROPERTIES_1 = VL_ONLY_CONFIG_PROPERTIES; _i < VL_ONLY_CONFIG_PROPERTIES_1.length; _i++) {\n        var prop = VL_ONLY_CONFIG_PROPERTIES_1[_i];\n        delete config[prop];\n    }\n    // Remove Vega-Lite only axis/legend config\n    if (config.axis) {\n        for (var _a = 0, VL_ONLY_GUIDE_CONFIG_1 = VL_ONLY_GUIDE_CONFIG; _a < VL_ONLY_GUIDE_CONFIG_1.length; _a++) {\n            var prop = VL_ONLY_GUIDE_CONFIG_1[_a];\n            delete config.axis[prop];\n        }\n    }\n    if (config.legend) {\n        for (var _b = 0, VL_ONLY_GUIDE_CONFIG_2 = VL_ONLY_GUIDE_CONFIG; _b < VL_ONLY_GUIDE_CONFIG_2.length; _b++) {\n            var prop = VL_ONLY_GUIDE_CONFIG_2[_b];\n            delete config.legend[prop];\n        }\n    }\n    // Remove Vega-Lite only generic mark config\n    if (config.mark) {\n        for (var _c = 0, VL_ONLY_MARK_CONFIG_PROPERTIES_1 = VL_ONLY_MARK_CONFIG_PROPERTIES; _c < VL_ONLY_MARK_CONFIG_PROPERTIES_1.length; _c++) {\n            var prop = VL_ONLY_MARK_CONFIG_PROPERTIES_1[_c];\n            delete config.mark[prop];\n        }\n    }\n    for (var _d = 0, MARK_STYLES_1 = MARK_STYLES; _d < MARK_STYLES_1.length; _d++) {\n        var markType = MARK_STYLES_1[_d];\n        // Remove Vega-Lite-only mark config\n        for (var _e = 0, VL_ONLY_MARK_CONFIG_PROPERTIES_2 = VL_ONLY_MARK_CONFIG_PROPERTIES; _e < VL_ONLY_MARK_CONFIG_PROPERTIES_2.length; _e++) {\n            var prop = VL_ONLY_MARK_CONFIG_PROPERTIES_2[_e];\n            delete config[markType][prop];\n        }\n        // Remove Vega-Lite only mark-specific config\n        var vlOnlyMarkSpecificConfigs = VL_ONLY_ALL_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX[markType];\n        if (vlOnlyMarkSpecificConfigs) {\n            for (var _f = 0, vlOnlyMarkSpecificConfigs_1 = vlOnlyMarkSpecificConfigs; _f < vlOnlyMarkSpecificConfigs_1.length; _f++) {\n                var prop = vlOnlyMarkSpecificConfigs_1[_f];\n                delete config[markType][prop];\n            }\n        }\n        // Redirect mark config to config.style so that mark config only affect its own mark type\n        // without affecting other marks that share the same underlying Vega marks.\n        // For example, config.rect should not affect bar marks.\n        redirectConfig(config, markType);\n    }\n    // Redirect config.title -- so that title config do not\n    // affect header labels, which also uses `title` directive to implement.\n    redirectConfig(config, 'title', 'group-title');\n    // Remove empty config objects\n    for (var prop in config) {\n        if (isObject(config[prop]) && keys(config[prop]).length === 0) {\n            delete config[prop];\n        }\n    }\n    return keys(config).length > 0 ? config : undefined;\n}\nfunction redirectConfig(config, prop, toProp) {\n    var propConfig = prop === 'title' ? extractTitleConfig(config.title).mark : config[prop];\n    if (prop === 'view') {\n        toProp = 'cell'; // View's default style is \"cell\"\n    }\n    var style = tslib_1.__assign({}, propConfig, config.style[prop]);\n    // set config.style if it is not an empty object\n    if (keys(style).length > 0) {\n        config.style[toProp || prop] = style;\n    }\n    delete config[prop];\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlnLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2NvbmZpZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFDLFFBQVEsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUVuQyxPQUFPLEVBQUMscUJBQXFCLEVBQUMsTUFBTSxpQkFBaUIsQ0FBQztBQUN0RCxPQUFPLEVBQWdELHFEQUFxRCxFQUFDLE1BQU0sdUJBQXVCLENBQUM7QUFDM0ksT0FBTyxFQUFDLG9CQUFvQixFQUFDLE1BQU0sU0FBUyxDQUFDO0FBQzdDLE9BQU8sRUFBQyxtQkFBbUIsRUFBZSxNQUFNLFVBQVUsQ0FBQztBQUMzRCxPQUFPLEVBQXlCLGVBQWUsRUFBRSw4QkFBOEIsRUFBRSwyQ0FBMkMsRUFBQyxNQUFNLFFBQVEsQ0FBQztBQUM1SSxPQUFPLEtBQUssSUFBSSxNQUFNLFFBQVEsQ0FBQztBQUUvQixPQUFPLEVBQUMsa0JBQWtCLEVBQWMsTUFBTSxTQUFTLENBQUM7QUFDeEQsT0FBTyxFQUFDLGFBQWEsSUFBSSxzQkFBc0IsRUFBa0IsTUFBTSxhQUFhLENBQUM7QUFFckYsT0FBTyxFQUFDLGtCQUFrQixFQUFDLE1BQU0sU0FBUyxDQUFDO0FBRTNDLE9BQU8sRUFBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBQyxNQUFNLFFBQVEsQ0FBQztBQW9GbEQsTUFBTSxDQUFDLElBQU0saUJBQWlCLEdBQWU7SUFDM0MsS0FBSyxFQUFFLEdBQUc7SUFDVixNQUFNLEVBQUUsR0FBRztDQUNaLENBQUM7QUE0SEYsTUFBTSxDQUFDLElBQU0sYUFBYSxHQUFXO0lBQ25DLE9BQU8sRUFBRSxDQUFDO0lBQ1YsVUFBVSxFQUFFLEVBQUU7SUFDZCxVQUFVLEVBQUUsbUJBQW1CO0lBRS9CLGFBQWEsRUFBRSxRQUFRO0lBRXZCLElBQUksRUFBRSxpQkFBaUI7SUFFdkIsSUFBSSxFQUFFLElBQUksQ0FBQyxpQkFBaUI7SUFDNUIsSUFBSSxFQUFFLEVB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LENBQUMsTUFBTSxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7QUFDdEQsQ0FBQztBQUVELHdCQUF3QixNQUFjLEVBQUUsSUFBa0QsRUFBRSxNQUFlO0lBQ3pHLElBQU0sVUFBVSxHQUFpQixJQUFJLEtBQUssT0FBTyxDQUFDLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7SUFFekcsSUFBSSxJQUFJLEtBQUssTUFBTSxFQUFFO1FBQ25CLE1BQU0sR0FBRyxNQUFNLENBQUMsQ0FBQyxpQ0FBaUM7S0FDbkQ7SUFFRCxJQUFNLEtBQUssd0JBQ04sVUFBVSxFQUNWLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQ3RCLENBQUM7SUFDRixnREFBZ0Q7SUFDaEQsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtRQUMxQixNQUFNLENBQUMsS0FBSyxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsR0FBRyxLQUFLLENBQUM7S0FDdEM7SUFDRCxPQUFPLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUN0QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtpc09iamVjdH0gZnJvbSAndmVnYS11dGlsJztcbmltcG9ydCB7QXhpc0NvbmZpZ01peGluc30gZnJvbSAnLi9heGlzJztcbmltcG9ydCB7Q09NUE9TSVRFX01BUktfU1RZTEVTfSBmcm9tICcuL2NvbXBvc2l0ZW1hcmsnO1xuaW1wb3J0IHtDb21wb3NpdGVNYXJrQ29uZmlnTWl4aW5zLCBDb21wb3NpdGVNYXJrU3R5bGUsIFZMX09OTFlfQ09NUE9TSVRFX01BUktfU1BFQ0lGSUNfQ09ORklHX1BST1BFUlRZX0lOREVYfSBmcm9tICcuL2NvbXBvc2l0ZW1hcmsvaW5kZXgnO1xuaW1wb3J0IHtWTF9PTkxZX0dVSURFX0NPTkZJR30gZnJvbSAnLi9ndWlkZSc7XG5pbXBvcnQge2RlZmF1bHRMZWdlbmRDb25maWcsIExlZ2VuZENvbmZpZ30gZnJvbSAnLi9sZWdlbmQnO1xuaW1wb3J0IHtNYXJrLCBNYXJrQ29uZmlnTWl4aW5zLCBQUklNSVRJVkVfTUFSS1MsIFZMX09OTFlfTUFSS19DT05GSUdfUFJPUEVSVElFUywgVkxfT05MWV9NQVJLX1NQRUNJRklDX0NPTkZJR19QUk9QRVJUWV9JTkRFWH0gZnJvbSAnLi9tYXJrJztcbmltcG9ydCAqIGFzIG1hcmsgZnJvbSAnLi9tYXJrJztcbmltcG9ydCB7UHJvamVjdGlvbkNvbmZpZ30gZnJvbSAnLi9wcm9qZWN0aW9uJztcbmltcG9ydCB7ZGVmYXVsdFNjYWxlQ29uZmlnLCBTY2FsZUNvbmZpZ30gZnJvbSAnLi9zY2FsZSc7XG5pbXBvcnQge2RlZmF1bHRDb25maWcgYXMgZGVmYXVsdFNlbGVjdGlvbkNvbmZpZywgU2VsZWN0aW9uQ29uZmlnfSBmcm9tICcuL3NlbGVjdGlvbic7XG5pbXBvcnQge1N0YWNrT2Zmc2V0fSBmcm9tICcuL3N0YWNrJztcbmltcG9ydCB7ZXh0cmFjdFRpdGxlQ29uZmlnfSBmcm9tICcuL3RpdGxlJztcbmltcG9ydCB7VG9wTGV2ZWxQcm9wZXJ0aWVzfSBmcm9tICcuL3RvcGxldmVscHJvcHMnO1xuaW1wb3J0IHtkdXBsaWNhdGUsIGtleXMsIG1lcmdlRGVlcH0gZnJvbSAnLi91dGlsJztcbmltcG9ydCB7VmdNYXJrQ29uZmlnLCBWZ1NjaGVtZSwgVmdUaXRsZUNvbmZpZ30gZnJvbSAnLi92ZWdhLnNjaGVtYSc7XG5cblxuZXhwb3J0IGludGVyZmFjZSBWaWV3Q29uZmlnIHtcbiAgLyoqXG4gICAqIFRoZSBkZWZhdWx0IHdpZHRoIG9mIHRoZSBzaW5nbGUgcGxvdCBvciBlYWNoIHBsb3QgaW4gYSB0cmVsbGlzIHBsb3Qgd2hlbiB0aGUgdmlzdWFsaXphdGlvbiBoYXMgYSBjb250aW51b3VzIChub24tb3JkaW5hbCkgeC1zY2FsZSBvciBvcmRpbmFsIHgtc2NhbGUgd2l0aCBgcmFuZ2VTdGVwYCA9IGBudWxsYC5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGAyMDBgXG4gICAqXG4gICAqL1xuICB3aWR0aD86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIGRlZmF1bHQgaGVpZ2h0IG9mIHRoZSBzaW5nbGUgcGxvdCBvciBlYWNoIHBsb3QgaW4gYSB0cmVsbGlzIHBsb3Qgd2hlbiB0aGUgdmlzdWFsaXphdGlvbiBoYXMgYSBjb250aW51b3VzIChub24tb3JkaW5hbCkgeS1zY2FsZSB3aXRoIGByYW5nZVN0ZXBgID0gYG51bGxgLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDIwMGBcbiAgICpcbiAgICovXG4gIGhlaWdodD86IG51bWJlcjtcblxuICAvKipcbiAgICogV2hldGhlciB0aGUgdmlldyBzaG91bGQgYmUgY2xpcHBlZC5cbiAgICovXG4gIGNsaXA/OiBib29sZWFuO1xuXG4gIC8vIEZJTExfU1RST0tFX0NPTkZJR1xuICAvKipcbiAgICogVGhlIGZpbGwgY29sb3IuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyAobm9uZSlcbiAgICpcbiAgICovXG4gIGZpbGw/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBmaWxsIG9wYWNpdHkgKHZhbHVlIGJldHdlZW4gWzAsMV0pLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gKG5vbmUpXG4gICAqXG4gICAqL1xuICBmaWxsT3BhY2l0eT86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIHN0cm9rZSBjb2xvci5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIChub25lKVxuICAgKlxuICAgKi9cbiAgc3Ryb2tlPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgc3Ryb2tlIG9wYWNpdHkgKHZhbHVlIGJldHdlZW4gWzAsMV0pLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gKG5vbmUpXG4gICAqXG4gICAqL1xuICBzdHJva2VPcGFjaXR5PzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgc3Ryb2tlIHdpZHRoLCBpbiBwaXhlbHMuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyAobm9uZSlcbiAgICpcbiAgICovXG4gIHN0cm9rZVdpZHRoPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBBbiBhcnJheSBvZiBhbHRlcm5hdGluZyBzdHJva2UsIHNwYWNlIGxlbmd0aHMgZm9yIGNyZWF0aW5nIGRhc2hlZCBvciBkb3R0ZWQgbGluZXMuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyAobm9uZSlcbiAgICpcbiAgICovXG4gIHN0cm9rZURhc2g/OiBudW1iZXJbXTtcblxuICAvKipcbiAgICogVGhlIG9mZnNldCAoaW4gcGl4ZWxzKSBpbnRvIHdoaWNoIHRvIGJlZ2luIGRyYXdpbmcgd2l0aCB0aGUgc3Ryb2tlIGRhc2ggYXJyYXkuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyAobm9uZSlcbiAgICpcbiAgICovXG4gIHN0cm9rZURhc2hPZmZzZXQ/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBjb25zdCBkZWZhdWx0Vmlld0NvbmZpZzogVmlld0NvbmZpZyA9IHtcbiAgd2lkdGg6IDIwMCxcbiAgaGVpZ2h0OiAyMDBcbn07XG5cbmV4cG9ydCB0eXBlIFJhbmdlQ29uZmlnVmFsdWUgPSAobnVtYmVyfHN0cmluZylbXSB8IFZnU2NoZW1lIHwge3N0ZXA6IG51bWJlcn07XG5cbmV4cG9ydCB0eXBlIFJhbmdlQ29uZmlnID0gUmFuZ2VDb25maWdQcm9wcyAmIHtbbmFtZTogc3RyaW5nXTogUmFuZ2VDb25maWdWYWx1ZX07XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmFuZ2VDb25maWdQcm9wcyB7XG4gIC8qKlxuICAgKiBEZWZhdWx0IHJhbmdlIGZvciBfbm9taW5hbF8gKGNhdGVnb3JpY2FsKSBmaWVsZHMuXG4gICAqL1xuICBjYXRlZ29yeT86IHN0cmluZ1tdIHwgVmdTY2hlbWU7XG5cbiAgLyoqXG4gICAqIERlZmF1bHQgcmFuZ2UgZm9yIGRpdmVyZ2luZyBfcXVhbnRpdGF0aXZlXyBmaWVsZHMuXG4gICAqL1xuICBkaXZlcmdpbmc/OiBzdHJpbmdbXSB8IFZnU2NoZW1lO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IHJhbmdlIGZvciBfcXVhbnRpdGF0aXZlXyBoZWF0bWFwcy5cbiAgICovXG4gIGhlYXRtYXA/OiBzdHJpbmdbXSB8IFZnU2NoZW1lO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IHJhbmdlIGZvciBfb3JkaW5hbF8gZmllbGRzLlxuICAgKi9cbiAgb3JkaW5hbD86IHN0cmluZ1tdIHwgVmdTY2hlbWU7XG5cbiAgLyoqXG4gICAqIERlZmF1bHQgcmFuZ2UgZm9yIF9xdWFudGl0YXRpdmVfIGFuZCBfdGVtcG9yYWxfIGZpZWxkcy5cbiAgICovXG4gIHJhbXA/OiBzdHJpbmdbXSB8IFZnU2NoZW1lO1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IHJhbmdlIHBhbGV0dGUgZm9yIHRoZSBgc2hhcGVgIGNoYW5uZWwuXG4gICAqL1xuICBzeW1ib2w/OiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWTE9ubHlDb25maWcge1xuICAvKipcbiAgICogRGVmYXVsdCBheGlzIGFuZCBsZWdlbmQgdGl0bGUgZm9yIGNvdW50IGZpZWxkcy5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGAnTnVtYmVyIG9mIFJlY29yZHMnYC5cbiAgICpcbiAgICogQHR5cGUge3N0cmluZ31cbiAgICovXG4gIGNvdW50VGl0bGU/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIERlZmluZXMgaG93IFZlZ2EtTGl0ZSBzaG91bGQgaGFuZGxlIGludmFsaWQgdmFsdWVzIChgbnVsbGAgYW5kIGBOYU5gKS5cbiAgICogLSBJZiBzZXQgdG8gYFwiZmlsdGVyXCJgIChkZWZhdWx0KSwgYWxsIGRhdGEgaXRlbXMgd2l0aCBudWxsIHZhbHVlcyB3aWxsIGJlIHNraXBwZWQgKGZvciBsaW5lLCB0cmFpbCwgYW5kIGFyZWEgbWFya3MpIG9yIGZpbHRlcmVkIChmb3Igb3RoZXIgbWFya3MpLlxuICAgKiAtIElmIGBudWxsYCwgYWxsIGRhdGEgaXRlbXMgYXJlIGluY2x1ZGVkLiBJbiB0aGlzIGNhc2UsIGludmFsaWQgdmFsdWVzIHdpbGwgYmUgaW50ZXJwcmV0ZWQgYXMgemVyb2VzLlxuICAgKi9cbiAgaW52YWxpZFZhbHVlcz86ICdmaWx0ZXInIHwgbnVsbDtcblxuICAvKipcbiAgICogRGVmaW5lcyBob3cgVmVnYS1MaXRlIGdlbmVyYXRlcyB0aXRsZSBmb3IgZmllbGRzLiAgVGhlcmUgYXJlIHRocmVlIHBvc3NpYmxlIHN0eWxlczpcbiAgICogLSBgXCJ2ZXJiYWxcImAgKERlZmF1bHQpIC0gZGlzcGxheXMgZnVuY3Rpb24gaW4gYSB2ZXJiYWwgc3R5bGUgKGUuZy4sIFwiU3VtIG9mIGZpZWxkXCIsIFwiWWVhci1tb250aCBvZiBkYXRlXCIsIFwiZmllbGQgKGJpbm5lZClcIikuXG4gICAqIC0gYFwiZnVuY3Rpb25cImAgLSBkaXNwbGF5cyBmdW5jdGlvbiB1c2luZyBwYXJlbnRoZXNlcyBhbmQgY2FwaXRhbGl6ZWQgdGV4dHMgKGUuZy4sIFwiU1VNKGZpZWxkKVwiLCBcIllFQVJNT05USChkYXRlKVwiLCBcIkJJTihmaWVsZClcIikuXG4gICAqIC0gYFwicGxhaW5cImAgLSBkaXNwbGF5cyBvbmx5IHRoZSBmaWVsZCBuYW1lIHdpdGhvdXQgZnVuY3Rpb25zIChlLmcuLCBcImZpZWxkXCIsIFwiZGF0ZVwiLCBcImZpZWxkXCIpLlxuICAgKi9cbiAgZmllbGRUaXRsZT86ICd2ZXJiYWwnIHwgJ2Z1bmN0aW9uYWwnIHwgJ3BsYWluJztcblxuICAvKipcbiAgICogRDMgTnVtYmVyIGZvcm1hdCBmb3IgYXhpcyBsYWJlbHMgYW5kIHRleHQgdGFibGVzLiBGb3IgZXhhbXBsZSBcInNcIiBmb3IgU0kgdW5pdHMuIFVzZSBbRDMncyBudW1iZXIgZm9ybWF0IHBhdHRlcm5dKGh0dHBzOi8vZ2l0aHViLmNvbS9kMy9kMy1mb3JtYXQjbG9jYWxlX2Zvcm1hdCkuXG4gICAqL1xuICBudW1iZXJGb3JtYXQ/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIERlZmF1bHQgZGF0ZXRpbWUgZm9ybWF0IGZvciBheGlzIGFuZCBsZWdlbmQgbGFiZWxzLiBUaGUgZm9ybWF0IGNhbiBiZSBzZXQgZGlyZWN0bHkgb24gZWFjaCBheGlzIGFuZCBsZWdlbmQuIFVzZSBbRDMncyB0aW1lIGZvcm1hdCBwYXR0ZXJuXShodHRwczovL2dpdGh1Yi5jb20vZDMvZDMtdGltZS1mb3JtYXQjbG9jYWxlX2Zvcm1hdCkuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgJydgIChUaGUgZm9ybWF0IHdpbGwgYmUgYXV0b21hdGljYWxseSBkZXRlcm1pbmVkKS5cbiAgICpcbiAgICovXG4gIHRpbWVGb3JtYXQ/OiBzdHJpbmc7XG5cblxuICAvKiogRGVmYXVsdCBwcm9wZXJ0aWVzIGZvciBbc2luZ2xlIHZpZXcgcGxvdHNdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc3BlYy5odG1sI3NpbmdsZSkuICovXG4gIHZpZXc/OiBWaWV3Q29uZmlnO1xuXG4gIC8qKlxuICAgKiBTY2FsZSBjb25maWd1cmF0aW9uIGRldGVybWluZXMgZGVmYXVsdCBwcm9wZXJ0aWVzIGZvciBhbGwgW3NjYWxlc10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sKS4gRm9yIGEgZnVsbCBsaXN0IG9mIHNjYWxlIGNvbmZpZ3VyYXRpb24gb3B0aW9ucywgcGxlYXNlIHNlZSB0aGUgW2NvcnJlc3BvbmRpbmcgc2VjdGlvbiBvZiB0aGUgc2NhbGUgZG9jdW1lbnRhdGlvbl0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI2NvbmZpZykuXG4gICAqL1xuICBzY2FsZT86IFNjYWxlQ29uZmlnO1xuXG4gIC8qKiBBbiBvYmplY3QgaGFzaCBmb3IgZGVmaW5pbmcgZGVmYXVsdCBwcm9wZXJ0aWVzIGZvciBlYWNoIHR5cGUgb2Ygc2VsZWN0aW9ucy4gKi9cbiAgc2VsZWN0aW9uPzogU2VsZWN0aW9uQ29uZmlnO1xuXG4gIC8qKiBEZWZhdWx0IHN0YWNrIG9mZnNldCBmb3Igc3RhY2thYmxlIG1hcmsuICovXG4gIHN0YWNrPzogU3RhY2tPZmZzZXQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3R5bGVDb25maWdJbmRleCB7XG4gIFtzdHlsZTogc3RyaW5nXTogVmdNYXJrQ29uZmlnO1xufVxuXG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29uZmlnIGV4dGVuZHMgVG9wTGV2ZWxQcm9wZXJ0aWVzLCBWTE9ubHlDb25maWcsIE1hcmtDb25maWdNaXhpbnMsIENvbXBvc2l0ZU1hcmtDb25maWdNaXhpbnMsIEF4aXNDb25maWdNaXhpbnMge1xuXG4gIC8qKlxuICAgKiBBbiBvYmplY3QgaGFzaCB0aGF0IGRlZmluZXMgZGVmYXVsdCByYW5nZSBhcnJheXMgb3Igc2NoZW1lcyBmb3IgdXNpbmcgd2l0aCBzY2FsZXMuXG4gICAqIEZvciBhIGZ1bGwgbGlzdCBvZiBzY2FsZSByYW5nZSBjb25maWd1cmF0aW9uIG9wdGlvbnMsIHBsZWFzZSBzZWUgdGhlIFtjb3JyZXNwb25kaW5nIHNlY3Rpb24gb2YgdGhlIHNjYWxlIGRvY3VtZW50YXRpb25dKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNjb25maWcpLlxuICAgKi9cbiAgcmFuZ2U/OiBSYW5nZUNvbmZpZztcblxuICAvKipcbiAgICogTGVnZW5kIGNvbmZpZ3VyYXRpb24sIHdoaWNoIGRldGVybWluZXMgZGVmYXVsdCBwcm9wZXJ0aWVzIGZvciBhbGwgW2xlZ2VuZHNdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvbGVnZW5kLmh0bWwpLiBGb3IgYSBmdWxsIGxpc3Qgb2YgbGVnZW5kIGNvbmZpZ3VyYXRpb24gb3B0aW9ucywgcGxlYXNlIHNlZSB0aGUgW2NvcnJlc3BvbmRpbmcgc2VjdGlvbiBvZiBpbiB0aGUgbGVnZW5kIGRvY3VtZW50YXRpb25dKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvbGVnZW5kLmh0bWwjY29uZmlnKS5cbiAgICovXG4gIGxlZ2VuZD86IExlZ2VuZENvbmZpZztcblxuICAvKipcbiAgICogVGl0bGUgY29uZmlndXJhdGlvbiwgd2hpY2ggZGV0ZXJtaW5lcyBkZWZhdWx0IHByb3BlcnRpZXMgZm9yIGFsbCBbdGl0bGVzXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3RpdGxlLmh0bWwpLiBGb3IgYSBmdWxsIGxpc3Qgb2YgdGl0bGUgY29uZmlndXJhdGlvbiBvcHRpb25zLCBwbGVhc2Ugc2VlIHRoZSBbY29ycmVzcG9uZGluZyBzZWN0aW9uIG9mIHRoZSB0aXRsZSBkb2N1bWVudGF0aW9uXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3RpdGxlLmh0bWwjY29uZmlnKS5cbiAgICovXG4gIHRpdGxlPzogVmdUaXRsZUNvbmZpZztcblxuICAvKipcbiAgICogUHJvamVjdGlvbiBjb25maWd1cmF0aW9uLCB3aGljaCBkZXRlcm1pbmVzIGRlZmF1bHQgcHJvcGVydGllcyBmb3IgYWxsIFtwcm9qZWN0aW9uc10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9wcm9qZWN0aW9uLmh0bWwpLiBGb3IgYSBmdWxsIGxpc3Qgb2YgcHJvamVjdGlvbiBjb25maWd1cmF0aW9uIG9wdGlvbnMsIHBsZWFzZSBzZWUgdGhlIFtjb3JyZXNwb25kaW5nIHNlY3Rpb24gb2YgdGhlIHByb2plY3Rpb24gZG9jdW1lbnRhdGlvbl0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9wcm9qZWN0aW9uLmh0bWwjY29uZmlnKS5cbiAgICovXG4gIHByb2plY3Rpb24/OiBQcm9qZWN0aW9uQ29uZmlnO1xuXG4gIC8qKiBBbiBvYmplY3QgaGFzaCB0aGF0IGRlZmluZXMga2V5LXZhbHVlIG1hcHBpbmdzIHRvIGRldGVybWluZSBkZWZhdWx0IHByb3BlcnRpZXMgZm9yIG1hcmtzIHdpdGggYSBnaXZlbiBbc3R5bGVdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvbWFyay5odG1sI21hcmstZGVmKS4gIFRoZSBrZXlzIHJlcHJlc2VudCBzdHlsZXMgbmFtZXM7IHRoZSB2YWx1ZXMgaGF2ZSB0byBiZSB2YWxpZCBbbWFyayBjb25maWd1cmF0aW9uIG9iamVjdHNdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvbWFyay5odG1sI2NvbmZpZykuICAqL1xuICBzdHlsZT86IFN0eWxlQ29uZmlnSW5kZXg7XG59XG5cbmV4cG9ydCBjb25zdCBkZWZhdWx0Q29uZmlnOiBDb25maWcgPSB7XG4gIHBhZGRpbmc6IDUsXG4gIHRpbWVGb3JtYXQ6ICcnLFxuICBjb3VudFRpdGxlOiAnTnVtYmVyIG9mIFJlY29yZHMnLFxuXG4gIGludmFsaWRWYWx1ZXM6ICdmaWx0ZXInLFxuXG4gIHZpZXc6IGRlZmF1bHRWaWV3Q29uZmlnLFxuXG4gIG1hcms6IG1hcmsuZGVmYXVsdE1hcmtDb25maWcsXG4gIGFyZWE6IHt9LFxuICBiYXI6IG1hcmsuZGVmYXVsdEJhckNvbmZpZyxcbiAgY2lyY2xlOiB7fSxcbiAgZ2Vvc2hhcGU6IHt9LFxuICBsaW5lOiB7fSxcbiAgcG9pbnQ6IHt9LFxuICByZWN0OiB7fSxcbiAgcnVsZToge2NvbG9yOiAnYmxhY2snfSwgLy8gTmVlZCB0aGlzIHRvIG92ZXJyaWRlIGRlZmF1bHQgY29sb3IgaW4gbWFyayBjb25maWdcbiAgc3F1YXJlOiB7fSxcbiAgdGV4dDoge2NvbG9yOiAnYmxhY2snfSwgLy8gTmVlZCB0aGlzIHRvIG92ZXJyaWRlIGRlZmF1bHQgY29sb3IgaW4gbWFyayBjb25maWdcbiAgdGljazogbWFyay5kZWZhdWx0VGlja0NvbmZpZyxcbiAgdHJhaWw6IHt9LFxuXG4gIGJveDoge3NpemU6IDE0LCBleHRlbnQ6IDEuNX0sXG4gIGJveFdoaXNrZXI6IHt9LFxuICBib3hNaWQ6IHtjb2xvcjogJ3doaXRlJ30sXG5cbiAgc2NhbGU6IGRlZmF1bHRTY2FsZUNvbmZpZyxcbiAgcHJvamVjdGlvbjoge30sXG4gIGF4aXM6IHt9LFxuICBheGlzWDoge30sXG4gIGF4aXNZOiB7bWluRXh0ZW50OiAzMH0sXG4gIGF4aXNMZWZ0OiB7fSxcbiAgYXhpc1JpZ2h0OiB7fSxcbiAgYXhpc1RvcDoge30sXG4gIGF4aXNCb3R0b206IHt9LFxuICBheGlzQmFuZDoge30sXG4gIGxlZ2VuZDogZGVmYXVsdExlZ2VuZENvbmZpZyxcblxuICBzZWxlY3Rpb246IGRlZmF1bHRTZWxlY3Rpb25Db25maWcsXG4gIHN0eWxlOiB7fSxcblxuICB0aXRsZToge30sXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gaW5pdENvbmZpZyhjb25maWc6IENvbmZpZykge1xuICByZXR1cm4gbWVyZ2VEZWVwKGR1cGxpY2F0ZShkZWZhdWx0Q29uZmlnKSwgY29uZmlnKTtcbn1cblxuY29uc3QgTUFSS19TVFlMRVMgPSBbJ3ZpZXcnXS5jb25jYXQoUFJJTUlUSVZFX01BUktTLCBDT01QT1NJVEVfTUFSS19TVFlMRVMpIGFzICgndmlldycgfCBNYXJrIHwgQ29tcG9zaXRlTWFya1N0eWxlKVtdO1xuXG5cbmNvbnN0IFZMX09OTFlfQ09ORklHX1BST1BFUlRJRVM6IChrZXlvZiBDb25maWcpW10gPSBbXG4gICdwYWRkaW5nJywgJ251bWJlckZvcm1hdCcsICd0aW1lRm9ybWF0JywgJ2NvdW50VGl0bGUnLFxuICAnc3RhY2snLCAnc2NhbGUnLCAnc2VsZWN0aW9uJywgJ2ludmFsaWRWYWx1ZXMnLFxuICAnb3ZlcmxheScgYXMga2V5b2YgQ29uZmlnIC8vIEZJWE1FOiBSZWRlc2lnbiBhbmQgdW5oaWRlIHRoaXNcbl07XG5cbmNvbnN0IFZMX09OTFlfQUxMX01BUktfU1BFQ0lGSUNfQ09ORklHX1BST1BFUlRZX0lOREVYID0ge1xuICB2aWV3OiBbJ3dpZHRoJywgJ2hlaWdodCddLFxuICAuLi5WTF9PTkxZX01BUktfU1BFQ0lGSUNfQ09ORklHX1BST1BFUlRZX0lOREVYLFxuICAuLi5WTF9PTkxZX0NPTVBPU0lURV9NQVJLX1NQRUNJRklDX0NPTkZJR19QUk9QRVJUWV9JTkRFWFxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHN0cmlwQW5kUmVkaXJlY3RDb25maWcoY29uZmlnOiBDb25maWcpIHtcbiAgY29uZmlnID0gZHVwbGljYXRlKGNvbmZpZyk7XG5cbiAgZm9yIChjb25zdCBwcm9wIG9mIFZMX09OTFlfQ09ORklHX1BST1BFUlRJRVMpIHtcbiAgICBkZWxldGUgY29uZmlnW3Byb3BdO1xuICB9XG5cbiAgLy8gUmVtb3ZlIFZlZ2EtTGl0ZSBvbmx5IGF4aXMvbGVnZW5kIGNvbmZpZ1xuICBpZiAoY29uZmlnLmF4aXMpIHtcbiAgICBmb3IgKGNvbnN0IHByb3Agb2YgVkxfT05MWV9HVUlERV9DT05GSUcpIHtcbiAgICAgIGRlbGV0ZSBjb25maWcuYXhpc1twcm9wXTtcbiAgICB9XG4gIH1cbiAgaWYgKGNvbmZpZy5sZWdlbmQpIHtcbiAgICBmb3IgKGNvbnN0IHByb3Agb2YgVkxfT05MWV9HVUlERV9DT05GSUcpIHtcbiAgICAgIGRlbGV0ZSBjb25maWcubGVnZW5kW3Byb3BdO1xuICAgIH1cbiAgfVxuXG4gIC8vIFJlbW92ZSBWZWdhLUxpdGUgb25seSBnZW5lcmljIG1hcmsgY29uZmlnXG4gIGlmIChjb25maWcubWFyaykge1xuICAgIGZvciAoY29uc3QgcHJvcCBvZiBWTF9PTkxZX01BUktfQ09ORklHX1BST1BFUlRJRVMpIHtcbiAgICAgIGRlbGV0ZSBjb25maWcubWFya1twcm9wXTtcbiAgICB9XG4gIH1cblxuICBmb3IgKGNvbnN0IG1hcmtUeXBlIG9mIE1BUktfU1RZTEVTKSB7XG4gICAgLy8gUmVtb3ZlIFZlZ2EtTGl0ZS1vbmx5IG1hcmsgY29uZmlnXG4gICAgZm9yIChjb25zdCBwcm9wIG9mIFZMX09OTFlfTUFSS19DT05GSUdfUFJPUEVSVElFUykge1xuICAgICAgZGVsZXRlIGNvbmZpZ1ttYXJrVHlwZV1bcHJvcF07XG4gICAgfVxuXG4gICAgLy8gUmVtb3ZlIFZlZ2EtTGl0ZSBvbmx5IG1hcmstc3BlY2lmaWMgY29uZmlnXG4gICAgY29uc3QgdmxPbmx5TWFya1NwZWNpZmljQ29uZmlncyA9IFZMX09OTFlfQUxMX01BUktfU1BFQ0lGSUNfQ09ORklHX1BST1BFUlRZX0lOREVYW21hcmtUeXBlXTtcbiAgICBpZiAodmxPbmx5TWFya1NwZWNpZmljQ29uZmlncykge1xuICAgICAgZm9yIChjb25zdCBwcm9wIG9mIHZsT25seU1hcmtTcGVjaWZpY0NvbmZpZ3MpIHtcbiAgICAgICAgZGVsZXRlIGNvbmZpZ1ttYXJrVHlwZV1bcHJvcF07XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gUmVkaXJlY3QgbWFyayBjb25maWcgdG8gY29uZmlnLnN0eWxlIHNvIHRoYXQgbWFyayBjb25maWcgb25seSBhZmZlY3QgaXRzIG93biBtYXJrIHR5cGVcbiAgICAvLyB3aXRob3V0IGFmZmVjdGluZyBvdGhlciBtYXJrcyB0aGF0IHNoYXJlIHRoZSBzYW1lIHVuZGVybHlpbmcgVmVnYSBtYXJrcy5cbiAgICAvLyBGb3IgZXhhbXBsZSwgY29uZmlnLnJlY3Qgc2hvdWxkIG5vdCBhZmZlY3QgYmFyIG1hcmtzLlxuICAgIHJlZGlyZWN0Q29uZmlnKGNvbmZpZywgbWFya1R5cGUpO1xuICB9XG5cbiAgLy8gUmVkaXJlY3QgY29uZmlnLnRpdGxlIC0tIHNvIHRoYXQgdGl0bGUgY29uZmlnIGRvIG5vdFxuICAvLyBhZmZlY3QgaGVhZGVyIGxhYmVscywgd2hpY2ggYWxzbyB1c2VzIGB0aXRsZWAgZGlyZWN0aXZlIHRvIGltcGxlbWVudC5cbiAgcmVkaXJlY3RDb25maWcoY29uZmlnLCAndGl0bGUnLCAnZ3JvdXAtdGl0bGUnKTtcblxuICAvLyBSZW1vdmUgZW1wdHkgY29uZmlnIG9iamVjdHNcbiAgZm9yIChjb25zdCBwcm9wIGluIGNvbmZpZykge1xuICAgIGlmIChpc09iamVjdChjb25maWdbcHJvcF0pICYmIGtleXMoY29uZmlnW3Byb3BdKS5sZW5ndGggPT09IDApIHtcbiAgICAgIGRlbGV0ZSBjb25maWdbcHJvcF07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGtleXMoY29uZmlnKS5sZW5ndGggPiAwID8gY29uZmlnIDogdW5kZWZpbmVkO1xufVxuXG5mdW5jdGlvbiByZWRpcmVjdENvbmZpZyhjb25maWc6IENvbmZpZywgcHJvcDogTWFyayB8IENvbXBvc2l0ZU1hcmtTdHlsZSB8ICd0aXRsZScgfCAndmlldycsIHRvUHJvcD86IHN0cmluZykge1xuICBjb25zdCBwcm9wQ29uZmlnOiBWZ01hcmtDb25maWcgPSBwcm9wID09PSAndGl0bGUnID8gZXh0cmFjdFRpdGxlQ29uZmlnKGNvbmZpZy50aXRsZSkubWFyayA6IGNvbmZpZ1twcm9wXTtcblxuICBpZiAocHJvcCA9PT0gJ3ZpZXcnKSB7XG4gICAgdG9Qcm9wID0gJ2NlbGwnOyAvLyBWaWV3J3MgZGVmYXVsdCBzdHlsZSBpcyBcImNlbGxcIlxuICB9XG5cbiAgY29uc3Qgc3R5bGU6IFZnTWFya0NvbmZpZyA9IHtcbiAgICAuLi5wcm9wQ29uZmlnLFxuICAgIC4uLmNvbmZpZy5zdHlsZVtwcm9wXVxuICB9O1xuICAvLyBzZXQgY29uZmlnLnN0eWxlIGlmIGl0IGlzIG5vdCBhbiBlbXB0eSBvYmplY3RcbiAgaWYgKGtleXMoc3R5bGUpLmxlbmd0aCA+IDApIHtcbiAgICBjb25maWcuc3R5bGVbdG9Qcm9wIHx8IHByb3BdID0gc3R5bGU7XG4gIH1cbiAgZGVsZXRlIGNvbmZpZ1twcm9wXTtcbn1cbiJdfQ==","import { isArray } from 'vega-util';\nimport { SUM_OPS } from './aggregate';\nimport { NONPOSITION_CHANNELS, X, X2, Y2 } from './channel';\nimport { channelHasField } from './encoding';\nimport { getFieldDef, isFieldDef, isStringFieldDef, vgField } from './fielddef';\nimport * as log from './log';\nimport { AREA, BAR, CIRCLE, isMarkDef, isPathMark, LINE, POINT, RULE, SQUARE, TEXT, TICK } from './mark';\nimport { ScaleType } from './scale';\nimport { contains } from './util';\nvar STACK_OFFSET_INDEX = {\n    zero: 1,\n    center: 1,\n    normalize: 1\n};\nexport function isStackOffset(s) {\n    return !!STACK_OFFSET_INDEX[s];\n}\nexport var STACKABLE_MARKS = [BAR, AREA, RULE, POINT, CIRCLE, SQUARE, LINE, TEXT, TICK];\nexport var STACK_BY_DEFAULT_MARKS = [BAR, AREA];\nfunction potentialStackedChannel(encoding) {\n    var xDef = encoding.x;\n    var yDef = encoding.y;\n    if (isFieldDef(xDef) && isFieldDef(yDef)) {\n        if (xDef.type === 'quantitative' && yDef.type === 'quantitative') {\n            if (xDef.stack) {\n                return 'x';\n            }\n            else if (yDef.stack) {\n                return 'y';\n            }\n            // if there is no explicit stacking, only apply stack if there is only one aggregate for x or y\n            if ((!!xDef.aggregate) !== (!!yDef.aggregate)) {\n                return xDef.aggregate ? 'x' : 'y';\n            }\n        }\n        else if (xDef.type === 'quantitative') {\n            return 'x';\n        }\n        else if (yDef.type === 'quantitative') {\n            return 'y';\n        }\n    }\n    else if (isFieldDef(xDef) && xDef.type === 'quantitative') {\n        return 'x';\n    }\n    else if (isFieldDef(yDef) && yDef.type === 'quantitative') {\n        return 'y';\n    }\n    return undefined;\n}\n// Note: CompassQL uses this method and only pass in required properties of each argument object.\n// If required properties change, make sure to update CompassQL.\nexport function stack(m, encoding, stackConfig) {\n    var mark = isMarkDef(m) ? m.type : m;\n    // Should have stackable mark\n    if (!contains(STACKABLE_MARKS, mark)) {\n        return null;\n    }\n    var fieldChannel = potentialStackedChannel(encoding);\n    if (!fieldChannel) {\n        return null;\n    }\n    var stackedFieldDef = encoding[fieldChannel];\n    var stackedField = isStringFieldDef(stackedFieldDef) ? vgField(stackedFieldDef, {}) : undefined;\n    var dimensionChannel = fieldChannel === 'x' ? 'y' : 'x';\n    var dimensionDef = encoding[dimensionChannel];\n    var dimensionField = isStringFieldDef(dimensionDef) ? vgField(dimensionDef, {}) : undefined;\n    // Should have grouping level of detail that is different from the dimension field\n    var stackBy = NONPOSITION_CHANNELS.reduce(function (sc, channel) {\n        if (channelHasField(encoding, channel)) {\n            var channelDef = encoding[channel];\n            (isArray(channelDef) ? channelDef : [channelDef]).forEach(function (cDef) {\n                var fieldDef = getFieldDef(cDef);\n                if (fieldDef.aggregate) {\n                    return;\n                }\n                // Check whether the channel's field is identical to x/y's field or if the channel is a repeat\n                var f = isStringFieldDef(fieldDef) ? vgField(fieldDef, {}) : undefined;\n                if (\n                // if fielddef is a repeat, just include it in the stack by\n                !f ||\n                    // otherwise, the field must be different from x and y fields.\n                    (f !== dimensionField && f !== stackedField)) {\n                    sc.push({ channel: channel, fieldDef: fieldDef });\n                }\n            });\n        }\n        return sc;\n    }, []);\n    if (stackBy.length === 0) {\n        return null;\n    }\n    // Automatically determine offset\n    var offset = undefined;\n    if (stackedFieldDef.stack !== undefined) {\n        offset = stackedFieldDef.stack;\n    }\n    else if (contains(STACK_BY_DEFAULT_MARKS, mark)) {\n        // Bar and Area with sum ops are automatically stacked by default\n        offset = stackConfig === undefined ? 'zero' : stackConfig;\n    }\n    else {\n        offset = stackConfig;\n    }\n    if (!offset || !isStackOffset(offset)) {\n        return null;\n    }\n    // warn when stacking non-linear\n    if (stackedFieldDef.scale && stackedFieldDef.scale.type && stackedFieldDef.scale.type !== ScaleType.LINEAR) {\n        log.warn(log.message.cannotStackNonLinearScale(stackedFieldDef.scale.type));\n    }\n    // Check if it is a ranged mark\n    if (channelHasField(encoding, fieldChannel === X ? X2 : Y2)) {\n        log.warn(log.message.cannotStackRangedMark(fieldChannel));\n        return null;\n    }\n    // Warn if stacking summative aggregate\n    if (stackedFieldDef.aggregate && !contains(SUM_OPS, stackedFieldDef.aggregate)) {\n        log.warn(log.message.stackNonSummativeAggregate(stackedFieldDef.aggregate));\n    }\n    return {\n        groupbyChannel: dimensionDef ? dimensionChannel : undefined,\n        fieldChannel: fieldChannel,\n        impute: isPathMark(mark),\n        stackBy: stackBy,\n        offset: offset\n    };\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhY2suanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvc3RhY2sudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUNsQyxPQUFPLEVBQUMsT0FBTyxFQUFDLE1BQU0sYUFBYSxDQUFDO0FBQ3BDLE9BQU8sRUFBQyxvQkFBb0IsRUFBc0IsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDOUUsT0FBTyxFQUFDLGVBQWUsRUFBVyxNQUFNLFlBQVksQ0FBQztBQUNyRCxPQUFPLEVBQWtCLFdBQVcsRUFBRSxVQUFVLEVBQUUsZ0JBQWdCLEVBQW9CLE9BQU8sRUFBQyxNQUFNLFlBQVksQ0FBQztBQUNqSCxPQUFPLEtBQUssR0FBRyxNQUFNLE9BQU8sQ0FBQztBQUM3QixPQUFPLEVBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBRSxJQUFJLEVBQWlCLEtBQUssRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUMsTUFBTSxRQUFRLENBQUM7QUFDdEgsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLFNBQVMsQ0FBQztBQUNsQyxPQUFPLEVBQUMsUUFBUSxFQUFPLE1BQU0sUUFBUSxDQUFDO0FBS3RDLElBQU0sa0JBQWtCLEdBQXNCO0lBQzVDLElBQUksRUFBRSxDQUFDO0lBQ1AsTUFBTSxFQUFFLENBQUM7SUFDVCxTQUFTLEVBQUUsQ0FBQztDQUNiLENBQUM7QUFFRixNQUFNLHdCQUF3QixDQUFTO0lBQ3JDLE9BQU8sQ0FBQyxDQUFDLGtCQUFrQixDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2pDLENBQUM7QUEwQkQsTUFBTSxDQUFDLElBQU0sZUFBZSxHQUFHLENBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxNQUFN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QUNMLGNBQWMsRUFBRSxZQUFZLENBQUMsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLENBQUMsQ0FBQyxTQUFTO1FBQzNELFlBQVksY0FBQTtRQUNaLE1BQU0sRUFBRSxVQUFVLENBQUMsSUFBSSxDQUFDO1FBQ3hCLE9BQU8sU0FBQTtRQUNQLE1BQU0sUUFBQTtLQUNQLENBQUM7QUFDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtpc0FycmF5fSBmcm9tICd2ZWdhLXV0aWwnO1xuaW1wb3J0IHtTVU1fT1BTfSBmcm9tICcuL2FnZ3JlZ2F0ZSc7XG5pbXBvcnQge05PTlBPU0lUSU9OX0NIQU5ORUxTLCBOb25Qb3NpdGlvbkNoYW5uZWwsIFgsIFgyLCBZMn0gZnJvbSAnLi9jaGFubmVsJztcbmltcG9ydCB7Y2hhbm5lbEhhc0ZpZWxkLCBFbmNvZGluZ30gZnJvbSAnLi9lbmNvZGluZyc7XG5pbXBvcnQge0ZpZWxkLCBGaWVsZERlZiwgZ2V0RmllbGREZWYsIGlzRmllbGREZWYsIGlzU3RyaW5nRmllbGREZWYsIFBvc2l0aW9uRmllbGREZWYsIHZnRmllbGR9IGZyb20gJy4vZmllbGRkZWYnO1xuaW1wb3J0ICogYXMgbG9nIGZyb20gJy4vbG9nJztcbmltcG9ydCB7QVJFQSwgQkFSLCBDSVJDTEUsIGlzTWFya0RlZiwgaXNQYXRoTWFyaywgTElORSwgTWFyaywgTWFya0RlZiwgUE9JTlQsIFJVTEUsIFNRVUFSRSwgVEVYVCwgVElDS30gZnJvbSAnLi9tYXJrJztcbmltcG9ydCB7U2NhbGVUeXBlfSBmcm9tICcuL3NjYWxlJztcbmltcG9ydCB7Y29udGFpbnMsIEZsYWd9IGZyb20gJy4vdXRpbCc7XG5cblxuZXhwb3J0IHR5cGUgU3RhY2tPZmZzZXQgPSAnemVybycgfCAnY2VudGVyJyB8ICdub3JtYWxpemUnO1xuXG5jb25zdCBTVEFDS19PRkZTRVRfSU5ERVg6IEZsYWc8U3RhY2tPZmZzZXQ+ID0ge1xuICB6ZXJvOiAxLFxuICBjZW50ZXI6IDEsXG4gIG5vcm1hbGl6ZTogMVxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGlzU3RhY2tPZmZzZXQoczogc3RyaW5nKTogcyBpcyBTdGFja09mZnNldCB7XG4gIHJldHVybiAhIVNUQUNLX09GRlNFVF9JTkRFWFtzXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdGFja1Byb3BlcnRpZXMge1xuICAvKiogRGltZW5zaW9uIGF4aXMgb2YgdGhlIHN0YWNrLiAqL1xuICBncm91cGJ5Q2hhbm5lbDogJ3gnIHwgJ3knO1xuXG4gIC8qKiBNZWFzdXJlIGF4aXMgb2YgdGhlIHN0YWNrLiAqL1xuICBmaWVsZENoYW5uZWw6ICd4JyB8ICd5JztcblxuICAvKiogU3RhY2stYnkgZmllbGRzIGUuZy4sIGNvbG9yLCBkZXRhaWwgKi9cbiAgc3RhY2tCeToge1xuICAgIGZpZWxkRGVmOiBGaWVsZERlZjxzdHJpbmc+LFxuICAgIGNoYW5uZWw6IE5vblBvc2l0aW9uQ2hhbm5lbFxuICB9W107XG5cbiAgLyoqXG4gICAqIFNlZSBgXCJzdGFja1wiYCBwcm9wZXJ0eSBvZiBQb3NpdGlvbiBGaWVsZCBEZWYuXG4gICAqL1xuICBvZmZzZXQ6IFN0YWNrT2Zmc2V0O1xuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoaXMgc3RhY2sgd2lsbCBwcm9kdWNlIGltcHV0ZSB0cmFuc2Zvcm1cbiAgICovXG4gIGltcHV0ZTogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNvbnN0IFNUQUNLQUJMRV9NQVJLUyA9IFtCQVIsIEFSRUEsIFJVTEUsIFBPSU5ULCBDSVJDTEUsIFNRVUFSRSwgTElORSwgVEVYVCwgVElDS107XG5leHBvcnQgY29uc3QgU1RBQ0tfQllfREVGQVVMVF9NQVJLUyA9IFtCQVIsIEFSRUFdO1xuXG5cbmZ1bmN0aW9uIHBvdGVudGlhbFN0YWNrZWRDaGFubmVsKGVuY29kaW5nOiBFbmNvZGluZzxGaWVsZD4pOiAneCcgfCAneScgfCB1bmRlZmluZWQge1xuICBjb25zdCB4RGVmID0gZW5jb2RpbmcueDtcbiAgY29uc3QgeURlZiA9IGVuY29kaW5nLnk7XG5cbiAgaWYgKGlzRmllbGREZWYoeERlZikgJiYgaXNGaWVsZERlZih5RGVmKSkge1xuICAgIGlmICh4RGVmLnR5cGUgPT09ICdxdWFudGl0YXRpdmUnICYmIHlEZWYudHlwZSA9PT0gJ3F1YW50aXRhdGl2ZScpIHtcbiAgICAgIGlmICh4RGVmLnN0YWNrKSB7XG4gICAgICAgIHJldHVybiAneCc7XG4gICAgICB9IGVsc2UgaWYgKHlEZWYuc3RhY2spIHtcbiAgICAgICAgcmV0dXJuICd5JztcbiAgICAgIH1cbiAgICAgIC8vIGlmIHRoZXJlIGlzIG5vIGV4cGxpY2l0IHN0YWNraW5nLCBvbmx5IGFwcGx5IHN0YWNrIGlmIHRoZXJlIGlzIG9ubHkgb25lIGFnZ3JlZ2F0ZSBmb3IgeCBvciB5XG4gICAgICBpZiAoKCEheERlZi5hZ2dyZWdhdGUpICE9PSAoISF5RGVmLmFnZ3JlZ2F0ZSkpIHtcbiAgICAgICAgcmV0dXJuIHhEZWYuYWdncmVnYXRlID8gJ3gnIDogJ3knO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoeERlZi50eXBlID09PSAncXVhbnRpdGF0aXZlJykge1xuICAgICAgcmV0dXJuICd4JztcbiAgICB9IGVsc2UgaWYgKHlEZWYudHlwZSA9PT0gJ3F1YW50aXRhdGl2ZScpIHtcbiAgICAgIHJldHVybiAneSc7XG4gICAgfVxuICB9IGVsc2UgaWYgKGlzRmllbGREZWYoeERlZikgJiYgeERlZi50eXBlID09PSAncXVhbnRpdGF0aXZlJykge1xuICAgIHJldHVybiAneCc7XG4gIH0gZWxzZSBpZiAoaXNGaWVsZERlZih5RGVmKSAmJiB5RGVmLnR5cGUgPT09ICdxdWFudGl0YXRpdmUnKSB7XG4gICAgcmV0dXJuICd5JztcbiAgfVxuICByZXR1cm4gdW5kZWZpbmVkO1xufVxuXG4vLyBOb3RlOiBDb21wYXNzUUwgdXNlcyB0aGlzIG1ldGhvZCBhbmQgb25seSBwYXNzIGluIHJlcXVpcmVkIHByb3BlcnRpZXMgb2YgZWFjaCBhcmd1bWVudCBvYmplY3QuXG4vLyBJZiByZXF1aXJlZCBwcm9wZXJ0aWVzIGNoYW5nZSwgbWFrZSBzdXJlIHRvIHVwZGF0ZSBDb21wYXNzUUwuXG5leHBvcnQgZnVuY3Rpb24gc3RhY2sobTogTWFyayB8IE1hcmtEZWYsIGVuY29kaW5nOiBFbmNvZGluZzxGaWVsZD4sIHN0YWNrQ29uZmlnOiBTdGFja09mZnNldCk6IFN0YWNrUHJvcGVydGllcyB7XG4gIGNvbnN0IG1hcmsgPSBpc01hcmtEZWYobSkgPyBtLnR5cGUgOiBtO1xuICAvLyBTaG91bGQgaGF2ZSBzdGFja2FibGUgbWFya1xuICBpZiAoIWNvbnRhaW5zKFNUQUNLQUJMRV9NQVJLUywgbWFyaykpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGNvbnN0IGZpZWxkQ2hhbm5lbCA9IHBvdGVudGlhbFN0YWNrZWRDaGFubmVsKGVuY29kaW5nKTtcbiAgaWYgKCFmaWVsZENoYW5uZWwpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGNvbnN0IHN0YWNrZWRGaWVsZERlZiA9IGVuY29kaW5nW2ZpZWxkQ2hhbm5lbF0gYXMgUG9zaXRpb25GaWVsZERlZjxzdHJpbmc+O1xuICBjb25zdCBzdGFja2VkRmllbGQgPSBpc1N0cmluZ0ZpZWxkRGVmKHN0YWNrZWRGaWVsZERlZikgPyB2Z0ZpZWxkKHN0YWNrZWRGaWVsZERlZiwge30pIDogdW5kZWZpbmVkO1xuXG4gIGNvbnN0IGRpbWVuc2lvbkNoYW5uZWwgPSBmaWVsZENoYW5uZWwgPT09ICd4JyA/ICd5JyA6ICd4JztcbiAgY29uc3QgZGltZW5zaW9uRGVmID0gZW5jb2RpbmdbZGltZW5zaW9uQ2hhbm5lbF07XG4gIGNvbnN0IGRpbWVuc2lvbkZpZWxkID0gaXNTdHJpbmdGaWVsZERlZihkaW1lbnNpb25EZWYpID8gdmdGaWVsZChkaW1lbnNpb25EZWYsIHt9KSA6IHVuZGVmaW5lZDtcblxuICAvLyBTaG91bGQgaGF2ZSBncm91cGluZyBsZXZlbCBvZiBkZXRhaWwgdGhhdCBpcyBkaWZmZXJlbnQgZnJvbSB0aGUgZGltZW5zaW9uIGZpZWxkXG4gIGNvbnN0IHN0YWNrQnkgPSBOT05QT1NJVElPTl9DSEFOTkVMUy5yZWR1Y2UoKHNjLCBjaGFubmVsKSA9PiB7XG4gICAgaWYgKGNoYW5uZWxIYXNGaWVsZChlbmNvZGluZywgY2hhbm5lbCkpIHtcbiAgICAgIGNvbnN0IGNoYW5uZWxEZWYgPSBlbmNvZGluZ1tjaGFubmVsXTtcbiAgICAgIChpc0FycmF5KGNoYW5uZWxEZWYpID8gY2hhbm5lbERlZiA6IFtjaGFubmVsRGVmXSkuZm9yRWFjaCgoY0RlZikgPT4ge1xuICAgICAgICBjb25zdCBmaWVsZERlZiA9IGdldEZpZWxkRGVmKGNEZWYpO1xuICAgICAgICBpZiAoZmllbGREZWYuYWdncmVnYXRlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hlY2sgd2hldGhlciB0aGUgY2hhbm5lbCdzIGZpZWxkIGlzIGlkZW50aWNhbCB0byB4L3kncyBmaWVsZCBvciBpZiB0aGUgY2hhbm5lbCBpcyBhIHJlcGVhdFxuICAgICAgICBjb25zdCBmID0gaXNTdHJpbmdGaWVsZERlZihmaWVsZERlZikgPyB2Z0ZpZWxkKGZpZWxkRGVmLCB7fSkgOiB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAvLyBpZiBmaWVsZGRlZiBpcyBhIHJlcGVhdCwganVzdCBpbmNsdWRlIGl0IGluIHRoZSBzdGFjayBieVxuICAgICAgICAgICFmIHx8XG4gICAgICAgICAgLy8gb3RoZXJ3aXNlLCB0aGUgZmllbGQgbXVzdCBiZSBkaWZmZXJlbnQgZnJvbSB4IGFuZCB5IGZpZWxkcy5cbiAgICAgICAgICAoZiAhPT0gZGltZW5zaW9uRmllbGQgJiYgZiAhPT0gc3RhY2tlZEZpZWxkKVxuICAgICAgICApIHtcbiAgICAgICAgICBzYy5wdXNoKHtjaGFubmVsLCBmaWVsZERlZn0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHNjO1xuICB9LCBbXSk7XG5cbiAgaWYgKHN0YWNrQnkubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvLyBBdXRvbWF0aWNhbGx5IGRldGVybWluZSBvZmZzZXRcbiAgbGV0IG9mZnNldDogU3RhY2tPZmZzZXQgPSB1bmRlZmluZWQ7XG4gIGlmIChzdGFja2VkRmllbGREZWYuc3RhY2sgIT09IHVuZGVmaW5lZCkge1xuICAgIG9mZnNldCA9IHN0YWNrZWRGaWVsZERlZi5zdGFjaztcbiAgfSBlbHNlIGlmIChjb250YWlucyhTVEFDS19CWV9ERUZBVUxUX01BUktTLCBtYXJrKSkge1xuICAgIC8vIEJhciBhbmQgQXJlYSB3aXRoIHN1bSBvcHMgYXJlIGF1dG9tYXRpY2FsbHkgc3RhY2tlZCBieSBkZWZhdWx0XG4gICAgb2Zmc2V0ID0gc3RhY2tDb25maWcgPT09IHVuZGVmaW5lZCA/ICd6ZXJvJyA6IHN0YWNrQ29uZmlnO1xuICB9IGVsc2Uge1xuICAgIG9mZnNldCA9IHN0YWNrQ29uZmlnO1xuICB9XG5cbiAgaWYgKCFvZmZzZXQgfHwgIWlzU3RhY2tPZmZzZXQob2Zmc2V0KSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgLy8gd2FybiB3aGVuIHN0YWNraW5nIG5vbi1saW5lYXJcbiAgaWYgKHN0YWNrZWRGaWVsZERlZi5zY2FsZSAmJiBzdGFja2VkRmllbGREZWYuc2NhbGUudHlwZSAmJiBzdGFja2VkRmllbGREZWYuc2NhbGUudHlwZSAhPT0gU2NhbGVUeXBlLkxJTkVBUikge1xuICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLmNhbm5vdFN0YWNrTm9uTGluZWFyU2NhbGUoc3RhY2tlZEZpZWxkRGVmLnNjYWxlLnR5cGUpKTtcbiAgfVxuXG4gIC8vIENoZWNrIGlmIGl0IGlzIGEgcmFuZ2VkIG1hcmtcbiAgaWYgKGNoYW5uZWxIYXNGaWVsZChlbmNvZGluZywgZmllbGRDaGFubmVsID09PSBYID8gWDIgOiBZMikpIHtcbiAgICBsb2cud2Fybihsb2cubWVzc2FnZS5jYW5ub3RTdGFja1JhbmdlZE1hcmsoZmllbGRDaGFubmVsKSk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvLyBXYXJuIGlmIHN0YWNraW5nIHN1bW1hdGl2ZSBhZ2dyZWdhdGVcbiAgaWYgKHN0YWNrZWRGaWVsZERlZi5hZ2dyZWdhdGUgJiYgIWNvbnRhaW5zKFNVTV9PUFMsIHN0YWNrZWRGaWVsZERlZi5hZ2dyZWdhdGUpKSB7XG4gICAgbG9nLndhcm4obG9nLm1lc3NhZ2Uuc3RhY2tOb25TdW1tYXRpdmVBZ2dyZWdhdGUoc3RhY2tlZEZpZWxkRGVmLmFnZ3JlZ2F0ZSkpO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBncm91cGJ5Q2hhbm5lbDogZGltZW5zaW9uRGVmID8gZGltZW5zaW9uQ2hhbm5lbCA6IHVuZGVmaW5lZCxcbiAgICBmaWVsZENoYW5uZWwsXG4gICAgaW1wdXRlOiBpc1BhdGhNYXJrKG1hcmspLFxuICAgIHN0YWNrQnksXG4gICAgb2Zmc2V0XG4gIH07XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { isObject } from 'vega-util';\nimport { COLUMN, ROW, X, X2, Y, Y2 } from './channel';\nimport * as compositeMark from './compositemark';\nimport { channelHasField, isRanged } from './encoding';\nimport * as vlEncoding from './encoding';\nimport * as log from './log';\nimport { isMarkDef, isPathMark, isPrimitiveMark } from './mark';\nimport { stack } from './stack';\nimport { duplicate, hash, keys, omit, vals } from './util';\n/* Custom type guards */\nexport function isFacetSpec(spec) {\n    return spec['facet'] !== undefined;\n}\nexport function isUnitSpec(spec) {\n    return !!spec['mark'];\n}\nexport function isLayerSpec(spec) {\n    return spec['layer'] !== undefined;\n}\nexport function isRepeatSpec(spec) {\n    return spec['repeat'] !== undefined;\n}\nexport function isConcatSpec(spec) {\n    return isVConcatSpec(spec) || isHConcatSpec(spec);\n}\nexport function isVConcatSpec(spec) {\n    return spec['vconcat'] !== undefined;\n}\nexport function isHConcatSpec(spec) {\n    return spec['hconcat'] !== undefined;\n}\n/**\n * Decompose extended unit specs into composition of pure unit specs.\n */\n// TODO: consider moving this to another file.  Maybe vl.spec.normalize or vl.normalize\nexport function normalize(spec, config) {\n    if (isFacetSpec(spec)) {\n        return normalizeFacet(spec, config);\n    }\n    if (isLayerSpec(spec)) {\n        return normalizeLayer(spec, config);\n    }\n    if (isRepeatSpec(spec)) {\n        return normalizeRepeat(spec, config);\n    }\n    if (isVConcatSpec(spec)) {\n        return normalizeVConcat(spec, config);\n    }\n    if (isHConcatSpec(spec)) {\n        return normalizeHConcat(spec, config);\n    }\n    if (isUnitSpec(spec)) {\n        var hasRow = channelHasField(spec.encoding, ROW);\n        var hasColumn = channelHasField(spec.encoding, COLUMN);\n        if (hasRow || hasColumn) {\n            return normalizeFacetedUnit(spec, config);\n        }\n        return normalizeNonFacetUnit(spec, config);\n    }\n    throw new Error(log.message.INVALID_SPEC);\n}\nfunction normalizeFacet(spec, config) {\n    var subspec = spec.spec, rest = tslib_1.__rest(spec, [\"spec\"]);\n    return tslib_1.__assign({}, rest, { \n        // TODO: remove \"any\" once we support all facet listed in https://github.com/vega/vega-lite/issues/2760\n        spec: normalize(subspec, config) });\n}\nfunction mergeEncoding(opt) {\n    var parentEncoding = opt.parentEncoding, encoding = opt.encoding;\n    if (parentEncoding && encoding) {\n        var overriden = keys(parentEncoding).reduce(function (o, key) {\n            if (encoding[key]) {\n                o.push(key);\n            }\n            return o;\n        }, []);\n        if (overriden.length > 0) {\n            log.warn(log.message.encodingOverridden(overriden));\n        }\n    }\n    var merged = tslib_1.__assign({}, (parentEncoding || {}), (encoding || {}));\n    return keys(merged).length > 0 ? merged : undefined;\n}\nfunction mergeProjection(opt) {\n    var parentProjection = opt.parentProjection, projection = opt.projection;\n    if (parentProjection && projection) {\n        log.warn(log.message.projectionOverridden({ parentProjection: parentProjection, projection: projection }));\n    }\n    return projection || parentProjection;\n}\nfunction normalizeLayer(spec, config, parentEncoding, parentProjection) {\n    var layer = spec.layer, encoding = spec.encoding, projection = spec.projection, rest = tslib_1.__rest(spec, [\"layer\", \"encoding\", \"projection\"]);\n    var mergedEncoding = mergeEncoding({ parentEncoding: parentEncoding, encoding: encoding });\n    var mergedProjection = mergeProjection({ parentProjection: parentProjection, projection: projection });\n    return tslib_1.__assign({}, rest, { layer: layer.map(function (subspec) {\n            if (isLayerSpec(subspec)) {\n                return normalizeLayer(subspec, config, mergedEncoding, mergedProjection);\n            }\n            return normalizeNonFacetUnit(subspec, config, mergedEncoding, mergedProjection);\n        }) });\n}\nfunction normalizeRepeat(spec, config) {\n    var subspec = spec.spec, rest = tslib_1.__rest(spec, [\"spec\"]);\n    return tslib_1.__assign({}, rest, { spec: normalize(subspec, config) });\n}\nfunction normalizeVConcat(spec, config) {\n    var vconcat = spec.vconcat, rest = tslib_1.__rest(spec, [\"vconcat\"]);\n    return tslib_1.__assign({}, rest, { vconcat: vconcat.map(function (subspec) { return normalize(subspec, config); }) });\n}\nfunction normalizeHConcat(spec, config) {\n    var hconcat = spec.hconcat, rest = tslib_1.__rest(spec, [\"hconcat\"]);\n    return tslib_1.__assign({}, rest, { hconcat: hconcat.map(function (subspec) { return normalize(subspec, config); }) });\n}\nfunction normalizeFacetedUnit(spec, config) {\n    // New encoding in the inside spec should not contain row / column\n    // as row/column should be moved to facet\n    var _a = spec.encoding, row = _a.row, column = _a.column, encoding = tslib_1.__rest(_a, [\"row\", \"column\"]);\n    // Mark and encoding should be moved into the inner spec\n    var mark = spec.mark, width = spec.width, projection = spec.projection, height = spec.height, selection = spec.selection, _ = spec.encoding, outerSpec = tslib_1.__rest(spec, [\"mark\", \"width\", \"projection\", \"height\", \"selection\", \"encoding\"]);\n    return tslib_1.__assign({}, outerSpec, { facet: tslib_1.__assign({}, (row ? { row: row } : {}), (column ? { column: column } : {})), spec: normalizeNonFacetUnit(tslib_1.__assign({}, (projection ? { projection: projection } : {}), { mark: mark }, (width ? { width: width } : {}), (height ? { height: height } : {}), { encoding: encoding }, (selection ? { selection: selection } : {})), config) });\n}\nfunction isNonFacetUnitSpecWithPrimitiveMark(spec) {\n    return isPrimitiveMark(spec.mark);\n}\nfunction getPointOverlay(markDef, markConfig, encoding) {\n    if (markDef.point === 'transparent') {\n        return { opacity: 0 };\n    }\n    else if (markDef.point) { // truthy : true or object\n        return isObject(markDef.point) ? markDef.point : {};\n    }\n    else if (markDef.point !== undefined) { // false or null\n        return null;\n    }\n    else { // undefined (not disabled)\n        if (markConfig.point || encoding.shape) {\n            // enable point overlay if config[mark].point is truthy or if encoding.shape is provided\n            return isObject(markConfig.point) ? markConfig.point : {};\n        }\n        // markDef.point is defined as falsy\n        return null;\n    }\n}\nfunction getLineOverlay(markDef, markConfig) {\n    if (markDef.line) { // true or object\n        return markDef.line === true ? {} : markDef.line;\n    }\n    else if (markDef.line !== undefined) { // false or null\n        return null;\n    }\n    else { // undefined (not disabled)\n        if (markConfig.line) {\n            // enable line overlay if config[mark].line is truthy\n            return markConfig.line === true ? {} : markConfig.line;\n        }\n        // markDef.point is defined as falsy\n        return null;\n    }\n}\nfunction normalizeNonFacetUnit(spec, config, parentEncoding, parentProjection) {\n    var encoding = spec.encoding, projection = spec.projection;\n    var mark = isMarkDef(spec.mark) ? spec.mark.type : spec.mark;\n    // merge parent encoding / projection first\n    if (parentEncoding || parentProjection) {\n        var mergedProjection = mergeProjection({ parentProjection: parentProjection, projection: projection });\n        var mergedEncoding = mergeEncoding({ parentEncoding: parentEncoding, encoding: encoding });\n        return normalizeNonFacetUnit(tslib_1.__assign({}, spec, (mergedProjection ? { projection: mergedProjection } : {}), (mergedEncoding ? { encoding: mergedEncoding } : {})), config);\n    }\n    if (isNonFacetUnitSpecWithPrimitiveMark(spec)) {\n        // TODO: thoroughly test\n        if (isRanged(encoding)) {\n            return normalizeRangedUnit(spec);\n        }\n        if (mark === 'line' && (encoding.x2 || encoding.y2)) {\n            log.warn(log.message.lineWithRange(!!encoding.x2, !!encoding.y2));\n            return normalizeNonFacetUnit(tslib_1.__assign({ mark: 'rule' }, spec), config, parentEncoding, parentProjection);\n        }\n        if (isPathMark(mark)) {\n            return normalizePathOverlay(spec, config);\n        }\n        return spec; // Nothing to normalize\n    }\n    else {\n        return compositeMark.normalize(spec, config);\n    }\n}\nfunction normalizeRangedUnit(spec) {\n    var hasX = channelHasField(spec.encoding, X);\n    var hasY = channelHasField(spec.encoding, Y);\n    var hasX2 = channelHasField(spec.encoding, X2);\n    var hasY2 = channelHasField(spec.encoding, Y2);\n    if ((hasX2 && !hasX) || (hasY2 && !hasY)) {\n        var normalizedSpec = duplicate(spec);\n        if (hasX2 && !hasX) {\n            normalizedSpec.encoding.x = normalizedSpec.encoding.x2;\n            delete normalizedSpec.encoding.x2;\n        }\n        if (hasY2 && !hasY) {\n            normalizedSpec.encoding.y = normalizedSpec.encoding.y2;\n            delete normalizedSpec.encoding.y2;\n        }\n        return normalizedSpec;\n    }\n    return spec;\n}\nfunction dropLineAndPoint(markDef) {\n    var _point = markDef.point, _line = markDef.line, mark = tslib_1.__rest(markDef, [\"point\", \"line\"]);\n    return keys(mark).length > 1 ? mark : mark.type;\n}\nfunction normalizePathOverlay(spec, config) {\n    var _a;\n    if (config === void 0) { config = {}; }\n    // _ is used to denote a dropped property of the unit spec\n    // which should not be carried over to the layer spec\n    var selection = spec.selection, projection = spec.projection, encoding = spec.encoding, mark = spec.mark, outerSpec = tslib_1.__rest(spec, [\"selection\", \"projection\", \"encoding\", \"mark\"]);\n    var markDef = isMarkDef(mark) ? mark : { type: mark };\n    var pointOverlay = getPointOverlay(markDef, config[markDef.type], encoding);\n    var lineOverlay = markDef.type === 'area' && getLineOverlay(markDef, config[markDef.type]);\n    if (!pointOverlay && !lineOverlay) {\n        return tslib_1.__assign({}, spec, { \n            // Do not include point / line overlay in the normalize spec\n            mark: dropLineAndPoint(markDef) });\n    }\n    var layer = [tslib_1.__assign({}, (selection ? { selection: selection } : {}), { \n            // Do not include point / line overlay in the normalize spec\n            mark: dropLineAndPoint(tslib_1.__assign({}, markDef, (markDef.type === 'area' ? { opacity: 0.7 } : {}))), \n            // drop shape from encoding as this might be used to trigger point overlay\n            encoding: omit(encoding, ['shape']) })];\n    // FIXME: disable tooltip for the line layer if tooltip is not group-by field.\n    // FIXME: determine rules for applying selections.\n    // Need to copy stack config to overlayed layer\n    var stackProps = stack(markDef, encoding, config ? config.stack : undefined);\n    var overlayEncoding = encoding;\n    if (stackProps) {\n        var stackFieldChannel = stackProps.fieldChannel, offset = stackProps.offset;\n        overlayEncoding = tslib_1.__assign({}, encoding, (_a = {}, _a[stackFieldChannel] = tslib_1.__assign({}, encoding[stackFieldChannel], (offset ? { stack: offset } : {})), _a));\n    }\n    if (lineOverlay) {\n        var interpolate = markDef.interpolate;\n        layer.push(tslib_1.__assign({}, (projection ? { projection: projection } : {}), { mark: tslib_1.__assign({ type: 'line' }, lineOverlay, (interpolate ? { interpolate: interpolate } : {})), encoding: overlayEncoding }));\n    }\n    if (pointOverlay) {\n        layer.push(tslib_1.__assign({}, (projection ? { projection: projection } : {}), { mark: tslib_1.__assign({ type: 'point', opacity: 1, filled: true }, pointOverlay), encoding: overlayEncoding }));\n    }\n    return tslib_1.__assign({}, outerSpec, { layer: layer });\n}\n// TODO: add vl.spec.validate & move stuff from vl.validate to here\n/* Accumulate non-duplicate fieldDefs in a dictionary */\nfunction accumulate(dict, defs) {\n    defs.forEach(function (fieldDef) {\n        // Consider only pure fieldDef properties (ignoring scale, axis, legend)\n        var pureFieldDef = ['field', 'type', 'value', 'timeUnit', 'bin', 'aggregate'].reduce(function (f, key) {\n            if (fieldDef[key] !== undefined) {\n                f[key] = fieldDef[key];\n            }\n            return f;\n        }, {});\n        var key = hash(pureFieldDef);\n        dict[key] = dict[key] || fieldDef;\n    });\n    return dict;\n}\n/* Recursively get fieldDefs from a spec, returns a dictionary of fieldDefs */\nfunction fieldDefIndex(spec, dict) {\n    if (dict === void 0) { dict = {}; }\n    // FIXME(https://github.com/vega/vega-lite/issues/2207): Support fieldDefIndex for repeat\n    if (isLayerSpec(spec)) {\n        spec.layer.forEach(function (layer) {\n            if (isUnitSpec(layer)) {\n                accumulate(dict, vlEncoding.fieldDefs(layer.encoding));\n            }\n            else {\n                fieldDefIndex(layer, dict);\n            }\n        });\n    }\n    else if (isFacetSpec(spec)) {\n        accumulate(dict, vlEncoding.fieldDefs(spec.facet));\n        fieldDefIndex(spec.spec, dict);\n    }\n    else if (isRepeatSpec(spec)) {\n        fieldDefIndex(spec.spec, dict);\n    }\n    else if (isConcatSpec(spec)) {\n        var childSpec = isVConcatSpec(spec) ? spec.vconcat : spec.hconcat;\n        childSpec.forEach(function (child) { return fieldDefIndex(child, dict); });\n    }\n    else { // Unit Spec\n        accumulate(dict, vlEncoding.fieldDefs(spec.encoding));\n    }\n    return dict;\n}\n/* Returns all non-duplicate fieldDefs in a spec in a flat array */\nexport function fieldDefs(spec) {\n    return vals(fieldDefIndex(spec));\n}\nexport function isStacked(spec, config) {\n    config = config || spec.config;\n    if (isPrimitiveMark(spec.mark)) {\n        return stack(spec.mark, spec.encoding, config ? config.stack : undefined) !== null;\n    }\n    return false;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3BlYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zcGVjLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUMsUUFBUSxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBQ25DLE9BQU8sRUFBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUNwRCxPQUFPLEtBQUssYUFBYSxNQUFNLGlCQUFpQixDQUFDO0FBR2pELE9BQU8sRUFBQyxlQUFlLEVBQStCLFFBQVEsRUFBQyxNQUFNLFlBQVksQ0FBQztBQUNsRixPQUFPLEtBQUssVUFBVSxNQUFNLFlBQVksQ0FBQztBQUd6QyxPQUFPLEtBQUssR0FBRyxNQUFNLE9BQU8sQ0FBQztBQUM3QixPQUFPLEVBQXNCLFNBQVMsRUFBRSxVQUFVLEVBQUUsZUFBZSxFQUF3QyxNQUFNLFFBQVEsQ0FBQztBQUsxSCxPQUFPLEVBQUMsS0FBSyxFQUFDLE1BQU0sU0FBUyxDQUFDO0FBSTlCLE9BQU8sRUFBTyxTQUFTLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFDLE1BQU0sUUFBUSxDQUFDO0FBbVAvRCx3QkFBd0I7QUFHeEIsTUFBTSxzQkFBc0IsSUFBYztJQUN4QyxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxTQUFTLENBQUM7QUFDckMsQ0FBQztBQUVELE1BQU0scUJBQXFCLElBQWM7SUFDdkMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3hCLENBQUM7QUFFRCxNQUFNLHNCQUFzQixJQUFjO0lBQ3hDLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLFNBQVMsQ0FBQztBQUNyQyxDQUFDO0FBRUQsTUFBTSx1QkFBdUIsSUFBYztJQUN6QyxPQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxTQUFTLENBQUM7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LENBQUMsQ0FBQyxDQUFDO0FBQ25DLENBQUM7QUFFRCxNQUFNLG9CQUFvQixJQUF3QyxFQUFFLE1BQWU7SUFDakYsTUFBTSxHQUFHLE1BQU0sSUFBSSxJQUFJLENBQUMsTUFBTSxDQUFDO0lBQy9CLElBQUksZUFBZSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRTtRQUM5QixPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQzdCLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUNsQyxLQUFLLElBQUksQ0FBQztLQUNsQjtJQUNELE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7aXNPYmplY3R9IGZyb20gJ3ZlZ2EtdXRpbCc7XG5pbXBvcnQge0NPTFVNTiwgUk9XLCBYLCBYMiwgWSwgWTJ9IGZyb20gJy4vY2hhbm5lbCc7XG5pbXBvcnQgKiBhcyBjb21wb3NpdGVNYXJrIGZyb20gJy4vY29tcG9zaXRlbWFyayc7XG5pbXBvcnQge0NvbmZpZ30gZnJvbSAnLi9jb25maWcnO1xuaW1wb3J0IHtEYXRhfSBmcm9tICcuL2RhdGEnO1xuaW1wb3J0IHtjaGFubmVsSGFzRmllbGQsIEVuY29kaW5nLCBFbmNvZGluZ1dpdGhGYWNldCwgaXNSYW5nZWR9IGZyb20gJy4vZW5jb2RpbmcnO1xuaW1wb3J0ICogYXMgdmxFbmNvZGluZyBmcm9tICcuL2VuY29kaW5nJztcbmltcG9ydCB7RmFjZXRNYXBwaW5nfSBmcm9tICcuL2ZhY2V0JztcbmltcG9ydCB7RmllbGQsIEZpZWxkRGVmLCBSZXBlYXRSZWZ9IGZyb20gJy4vZmllbGRkZWYnO1xuaW1wb3J0ICogYXMgbG9nIGZyb20gJy4vbG9nJztcbmltcG9ydCB7QW55TWFyaywgQXJlYUNvbmZpZywgaXNNYXJrRGVmLCBpc1BhdGhNYXJrLCBpc1ByaW1pdGl2ZU1hcmssIExpbmVDb25maWcsIE1hcmssIE1hcmtDb25maWcsIE1hcmtEZWZ9IGZyb20gJy4vbWFyayc7XG5pbXBvcnQge1Byb2plY3Rpb259IGZyb20gJy4vcHJvamVjdGlvbic7XG5pbXBvcnQge1JlcGVhdH0gZnJvbSAnLi9yZXBlYXQnO1xuaW1wb3J0IHtSZXNvbHZlfSBmcm9tICcuL3Jlc29sdmUnO1xuaW1wb3J0IHtTZWxlY3Rpb25EZWZ9IGZyb20gJy4vc2VsZWN0aW9uJztcbmltcG9ydCB7c3RhY2t9IGZyb20gJy4vc3RhY2snO1xuaW1wb3J0IHtUaXRsZVBhcmFtc30gZnJvbSAnLi90aXRsZSc7XG5pbXBvcnQge1RvcExldmVsUHJvcGVydGllc30gZnJvbSAnLi90b3BsZXZlbHByb3BzJztcbmltcG9ydCB7VHJhbnNmb3JtfSBmcm9tICcuL3RyYW5zZm9ybSc7XG5pbXBvcnQge0RpY3QsIGR1cGxpY2F0ZSwgaGFzaCwga2V5cywgb21pdCwgdmFsc30gZnJvbSAnLi91dGlsJztcblxuXG5leHBvcnQgdHlwZSBUb3BMZXZlbDxTIGV4dGVuZHMgQmFzZVNwZWM+ID0gUyAmIFRvcExldmVsUHJvcGVydGllcyAmIHtcbiAgLyoqXG4gICAqIFVSTCB0byBbSlNPTiBzY2hlbWFdKGh0dHA6Ly9qc29uLXNjaGVtYS5vcmcvKSBmb3IgYSBWZWdhLUxpdGUgc3BlY2lmaWNhdGlvbi4gVW5sZXNzIHlvdSBoYXZlIGEgcmVhc29uIHRvIGNoYW5nZSB0aGlzLCB1c2UgYGh0dHBzOi8vdmVnYS5naXRodWIuaW8vc2NoZW1hL3ZlZ2EtbGl0ZS92Mi5qc29uYC4gU2V0dGluZyB0aGUgYCRzY2hlbWFgIHByb3BlcnR5IGFsbG93cyBhdXRvbWF0aWMgdmFsaWRhdGlvbiBhbmQgYXV0b2NvbXBsZXRlIGluIGVkaXRvcnMgdGhhdCBzdXBwb3J0IEpTT04gc2NoZW1hLlxuICAgKiBAZm9ybWF0IHVyaVxuICAgKi9cbiAgJHNjaGVtYT86IHN0cmluZztcblxuICAvKipcbiAgICogVmVnYS1MaXRlIGNvbmZpZ3VyYXRpb24gb2JqZWN0LiAgVGhpcyBwcm9wZXJ0eSBjYW4gb25seSBiZSBkZWZpbmVkIGF0IHRoZSB0b3AtbGV2ZWwgb2YgYSBzcGVjaWZpY2F0aW9uLlxuICAgKi9cbiAgY29uZmlnPzogQ29uZmlnO1xufTtcblxuZXhwb3J0IHR5cGUgQmFzZVNwZWMgPSBQYXJ0aWFsPERhdGFNaXhpbnM+ICYge1xuICAvKipcbiAgICogVGl0bGUgZm9yIHRoZSBwbG90LlxuICAgKi9cbiAgdGl0bGU/OiBzdHJpbmcgfCBUaXRsZVBhcmFtcztcblxuICAvKipcbiAgICogTmFtZSBvZiB0aGUgdmlzdWFsaXphdGlvbiBmb3IgbGF0ZXIgcmVmZXJlbmNlLlxuICAgKi9cbiAgbmFtZT86IHN0cmluZztcblxuICAvKipcbiAgICogRGVzY3JpcHRpb24gb2YgdGhpcyBtYXJrIGZvciBjb21tZW50aW5nIHB1cnBvc2UuXG4gICAqL1xuICBkZXNjcmlwdGlvbj86IHN0cmluZztcblxuICAvKipcbiAgICogQW4gb2JqZWN0IGRlc2NyaWJpbmcgdGhlIGRhdGEgc291cmNlXG4gICAqL1xuICBkYXRhPzogRGF0YTtcblxuICAvKipcbiAgICogQW4gYXJyYXkgb2YgZGF0YSB0cmFuc2Zvcm1hdGlvbnMgc3VjaCBhcyBmaWx0ZXIgYW5kIG5ldyBmaWVsZCBjYWxjdWxhdGlvbi5cbiAgICovXG4gIHRyYW5zZm9ybT86IFRyYW5zZm9ybVtdO1xufTtcblxuZXhwb3J0IHR5cGUgRGF0YU1peGlucyA9IHtcbiAgLyoqXG4gICAqIEFuIG9iamVjdCBkZXNjcmliaW5nIHRoZSBkYXRhIHNvdXJjZVxuICAgKi9cbiAgZGF0YTogRGF0YTtcbn07XG5cblxuLy8gVE9ETyhodHRwczovL2dpdGh1Yi5jb20vdmVnYS92ZWdhLWxpdGUvaXNzdWVzLzI1MDMpOiBNYWtlIHRoaXMgZ2VuZXJpYyBzbyB3ZSBjYW4gc3VwcG9ydCBzb21lIGZvcm0gb2YgdG9wLWRvd24gc2l6aW5nLlxuZXhwb3J0IGludGVyZmFjZSBMYXlvdXRTaXplTWl4aW5zIHtcbiAgLyoqXG4gICAqIFRoZSB3aWR0aCBvZiBhIHZpc3VhbGl6YXRpb24uXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBUaGlzIHdpbGwgYmUgZGV0ZXJtaW5lZCBieSB0aGUgZm9sbG93aW5nIHJ1bGVzOlxuICAgKlxuICAgKiAtIElmIGEgdmlldydzIFtgYXV0b3NpemVgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NpemUuaHRtbCNhdXRvc2l6ZSkgdHlwZSBpcyBgXCJmaXRcImAgb3IgaXRzIHgtY2hhbm5lbCBoYXMgYSBbY29udGludW91cyBzY2FsZV0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI2NvbnRpbnVvdXMpLCB0aGUgd2lkdGggd2lsbCBiZSB0aGUgdmFsdWUgb2YgW2Bjb25maWcudmlldy53aWR0aGBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc3BlYy5odG1sI2NvbmZpZykuXG4gICAqIC0gRm9yIHgtYXhpcyB3aXRoIGEgYmFuZCBvciBwb2ludCBzY2FsZTogaWYgW2ByYW5nZVN0ZXBgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjYmFuZCkgaXMgYSBudW1lcmljIHZhbHVlIG9yIHVuc3BlY2lmaWVkLCB0aGUgd2lkdGggaXMgW2RldGVybWluZWQgYnkgdGhlIHJhbmdlIHN0ZXAsIHBhZGRpbmdzLCBhbmQgdGhlIGNhcmRpbmFsaXR5IG9mIHRoZSBmaWVsZCBtYXBwZWQgdG8geC1jaGFubmVsXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjYmFuZCkuICAgT3RoZXJ3aXNlLCBpZiB0aGUgYHJhbmdlU3RlcGAgaXMgYG51bGxgLCB0aGUgd2lkdGggd2lsbCBiZSB0aGUgdmFsdWUgb2YgW2Bjb25maWcudmlldy53aWR0aGBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc3BlYy5odG1sI2NvbmZpZykuXG4gICAqIC0gSWYgbm8gZmllbGQgaXMgbWFwcGVkIHRvIGB4YCBjaGFubmVsLCB0aGUgYHdpZHRoYCB3aWxsIGJlIHRoZSB2YWx1ZSBvZiBbYGNvbmZpZy5zY2FsZS50ZXh0WFJhbmdlU3RlcGBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2l6ZS5odG1sI2RlZmF1bHQtd2lkdGgtYW5kLWhlaWdodCkgZm9yIGB0ZXh0YCBtYXJrIGFuZCB0aGUgdmFsdWUgb2YgYHJhbmdlU3RlcGAgZm9yIG90aGVyIG1hcmtzLlxuICAgKlxuICAgKiBfX05vdGU6X18gRm9yIHBsb3RzIHdpdGggW2Byb3dgIGFuZCBgY29sdW1uYCBjaGFubmVsc10oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9lbmNvZGluZy5odG1sI2ZhY2V0KSwgdGhpcyByZXByZXNlbnRzIHRoZSB3aWR0aCBvZiBhIHNpbmdsZSB2aWV3LlxuICAgKlxuICAgKiBfX1NlZSBhbHNvOl9fIFRoZSBkb2N1bWVudGF0aW9uIGZvciBbd2lkdGggYW5kIGhlaWdodF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zaXplLmh0bWwpIGNvbnRhaW5zIG1vcmUgZXhhbXBsZXMuXG4gICAqL1xuICB3aWR0aD86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIGhlaWdodCBvZiBhIHZpc3VhbGl6YXRpb24uXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfX1xuICAgKiAtIElmIGEgdmlldydzIFtgYXV0b3NpemVgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NpemUuaHRtbCNhdXRvc2l6ZSkgdHlwZSBpcyBgXCJmaXRcImAgb3IgaXRzIHktY2hhbm5lbCBoYXMgYSBbY29udGludW91cyBzY2FsZV0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zY2FsZS5odG1sI2NvbnRpbnVvdXMpLCB0aGUgaGVpZ2h0IHdpbGwgYmUgdGhlIHZhbHVlIG9mIFtgY29uZmlnLnZpZXcuaGVpZ2h0YF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zcGVjLmh0bWwjY29uZmlnKS5cbiAgICogLSBGb3IgeS1heGlzIHdpdGggYSBiYW5kIG9yIHBvaW50IHNjYWxlOiBpZiBbYHJhbmdlU3RlcGBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2NhbGUuaHRtbCNiYW5kKSBpcyBhIG51bWVyaWMgdmFsdWUgb3IgdW5zcGVjaWZpZWQsIHRoZSBoZWlnaHQgaXMgW2RldGVybWluZWQgYnkgdGhlIHJhbmdlIHN0ZXAsIHBhZGRpbmdzLCBhbmQgdGhlIGNhcmRpbmFsaXR5IG9mIHRoZSBmaWVsZCBtYXBwZWQgdG8geS1jaGFubmVsXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjYmFuZCkuIE90aGVyd2lzZSwgaWYgdGhlIGByYW5nZVN0ZXBgIGlzIGBudWxsYCwgdGhlIGhlaWdodCB3aWxsIGJlIHRoZSB2YWx1ZSBvZiBbYGNvbmZpZy52aWV3LmhlaWdodGBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc3BlYy5odG1sI2NvbmZpZykuXG4gICAqIC0gSWYgbm8gZmllbGQgaXMgbWFwcGVkIHRvIGB5YCBjaGFubmVsLCB0aGUgYGhlaWdodGAgd2lsbCBiZSB0aGUgdmFsdWUgb2YgYHJhbmdlU3RlcGAuXG4gICAqXG4gICAqIF9fTm90ZV9fOiBGb3IgcGxvdHMgd2l0aCBbYHJvd2AgYW5kIGBjb2x1bW5gIGNoYW5uZWxzXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL2VuY29kaW5nLmh0bWwjZmFjZXQpLCB0aGlzIHJlcHJlc2VudHMgdGhlIGhlaWdodCBvZiBhIHNpbmdsZSB2aWV3LlxuICAgKlxuICAgKiBfX1NlZSBhbHNvOl9fIFRoZSBkb2N1bWVudGF0aW9uIGZvciBbd2lkdGggYW5kIGhlaWdodF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zaXplLmh0bWwpIGNvbnRhaW5zIG1vcmUgZXhhbXBsZXMuXG4gICAqL1xuICBoZWlnaHQ/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgR2VuZXJpY1VuaXRTcGVjPEUgZXh0ZW5kcyBFbmNvZGluZzxhbnk+LCBNPiBleHRlbmRzIEJhc2VTcGVjLCBMYXlvdXRTaXplTWl4aW5zIHtcblxuICAvKipcbiAgICogQSBzdHJpbmcgZGVzY3JpYmluZyB0aGUgbWFyayB0eXBlIChvbmUgb2YgYFwiYmFyXCJgLCBgXCJjaXJjbGVcImAsIGBcInNxdWFyZVwiYCwgYFwidGlja1wiYCwgYFwibGluZVwiYCxcbiAgICogYFwiYXJlYVwiYCwgYFwicG9pbnRcImAsIGBcInJ1bGVcImAsIGBcImdlb3NoYXBlXCJgLCBhbmQgYFwidGV4dFwiYCkgb3IgYSBbbWFyayBkZWZpbml0aW9uIG9iamVjdF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9tYXJrLmh0bWwjbWFyay1kZWYpLlxuICAgKi9cbiAgbWFyazogTTtcblxuICAvKipcbiAgICogQSBrZXktdmFsdWUgbWFwcGluZyBiZXR3ZWVuIGVuY29kaW5nIGNoYW5uZWxzIGFuZCBkZWZpbml0aW9uIG9mIGZpZWxkcy5cbiAgICovXG4gIGVuY29kaW5nPzogRTtcblxuXG4gIC8qKlxuICAgKiBBbiBvYmplY3QgZGVmaW5pbmcgcHJvcGVydGllcyBvZiBnZW9ncmFwaGljIHByb2plY3Rpb24sIHdoaWNoIHdpbGwgYmUgYXBwbGllZCB0byBgc2hhcGVgIHBhdGggZm9yIGBcImdlb3NoYXBlXCJgIG1hcmtzXG4gICAqIGFuZCB0byBgbGF0aXR1ZGVgIGFuZCBgXCJsb25naXR1ZGVcImAgY2hhbm5lbHMgZm9yIG90aGVyIG1hcmtzLlxuICAgKi9cbiAgcHJvamVjdGlvbj86IFByb2plY3Rpb247XG5cbiAgLyoqXG4gICAqIEEga2V5LXZhbHVlIG1hcHBpbmcgYmV0d2VlbiBzZWxlY3Rpb24gbmFtZXMgYW5kIGRlZmluaXRpb25zLlxuICAgKi9cbiAgc2VsZWN0aW9uPzoge1tuYW1lOiBzdHJpbmddOiBTZWxlY3Rpb25EZWZ9O1xufVxuXG5leHBvcnQgdHlwZSBOb3JtYWxpemVkVW5pdFNwZWMgPSBHZW5lcmljVW5pdFNwZWM8RW5jb2Rpbmc8c3RyaW5nIHwgUmVwZWF0UmVmPiwgTWFyayB8IE1hcmtEZWY+O1xuXG4vKipcbiAqIFVuaXQgc3BlYyB0aGF0IGNhbiBoYXZlIGEgY29tcG9zaXRlIG1hcmsuXG4gKi9cbmV4cG9ydCB0eXBlIENvbXBvc2l0ZVVuaXRTcGVjID0gR2VuZXJpY1VuaXRTcGVjPEVuY29kaW5nPHN0cmluZyB8IFJlcGVhdFJlZj4sIEFueU1hcms+O1xuXG4vKipcbiAqIFVuaXQgc3BlYyB0aGF0IGNhbiBoYXZlIGEgY29tcG9zaXRlIG1hcmsgYW5kIHJvdyBvciBjb2x1bW4gY2hhbm5lbHMuXG4gKi9cbmV4cG9ydCB0eXBlIEZhY2V0ZWRDb21wb3NpdGVVbml0U3BlYyA9IEdlbmVyaWNVbml0U3BlYzxFbmNvZGluZ1dpdGhGYWNldDxzdHJpbmcgfCBSZXBlYXRSZWY+LCBBbnlNYXJrPjtcblxuZXhwb3J0IGludGVyZmFjZSBHZW5lcmljTGF5ZXJTcGVjPFUgZXh0ZW5kcyBHZW5lcmljVW5pdFNwZWM8YW55LCBhbnk+PiBleHRlbmRzIEJhc2VTcGVjLCBMYXlvdXRTaXplTWl4aW5zIHtcbiAgLyoqXG4gICAqIExheWVyIG9yIHNpbmdsZSB2aWV3IHNwZWNpZmljYXRpb25zIHRvIGJlIGxheWVyZWQuXG4gICAqXG4gICAqIF9fTm90ZV9fOiBTcGVjaWZpY2F0aW9ucyBpbnNpZGUgYGxheWVyYCBjYW5ub3QgdXNlIGByb3dgIGFuZCBgY29sdW1uYCBjaGFubmVscyBhcyBsYXllcmluZyBmYWNldCBzcGVjaWZpY2F0aW9ucyBpcyBub3QgYWxsb3dlZC5cbiAgICovXG4gIGxheWVyOiAoR2VuZXJpY0xheWVyU3BlYzxVPiB8IFUpW107XG5cbiAgLyoqXG4gICAqIFNjYWxlLCBheGlzLCBhbmQgbGVnZW5kIHJlc29sdXRpb25zIGZvciBsYXllcnMuXG4gICAqL1xuICByZXNvbHZlPzogUmVzb2x2ZTtcbn1cblxuLyoqXG4gKiBMYXllciBTcGVjIHdpdGggZW5jb2RpbmcgYW5kIHByb2plY3Rpb25cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBFeHRlbmRlZExheWVyU3BlYyBleHRlbmRzIEdlbmVyaWNMYXllclNwZWM8Q29tcG9zaXRlVW5pdFNwZWM+IHtcbiAgLyoqXG4gICAqIEEgc2hhcmVkIGtleS12YWx1ZSBtYXBwaW5nIGJldHdlZW4gZW5jb2RpbmcgY2hhbm5lbHMgYW5kIGRlZmluaXRpb24gb2YgZmllbGRzIGluIHRoZSB1bmRlcmx5aW5nIGxheWVycy5cbiAgICovXG4gIGVuY29kaW5nPzogRW5jb2Rpbmc8c3RyaW5nIHwgUmVwZWF0UmVmPjtcblxuXG4gIC8qKlxuICAgKiBBbiBvYmplY3QgZGVmaW5pbmcgcHJvcGVydGllcyBvZiB0aGUgZ2VvZ3JhcGhpYyBwcm9qZWN0aW9uIHNoYXJlZCBieSB1bmRlcmx5aW5nIGxheWVycy5cbiAgICovXG4gIHByb2plY3Rpb24/OiBQcm9qZWN0aW9uO1xufVxuXG5leHBvcnQgdHlwZSBOb3JtYWxpemVkTGF5ZXJTcGVjID0gR2VuZXJpY0xheWVyU3BlYzxOb3JtYWxpemVkVW5pdFNwZWM+O1xuXG5cbmV4cG9ydCBpbnRlcmZhY2UgR2VuZXJpY0ZhY2V0U3BlYzxcbiAgVSBleHRlbmRzIEdlbmVyaWNVbml0U3BlYzxhbnksIGFueT4sXG4gIEwgZXh0ZW5kcyBHZW5lcmljTGF5ZXJTcGVjPGFueT5cbiAgPiBleHRlbmRzIEJhc2VTcGVjIHtcbiAgLyoqXG4gICAqIEFuIG9iamVjdCB0aGF0IGRlc2NyaWJlcyBtYXBwaW5ncyBiZXR3ZWVuIGByb3dgIGFuZCBgY29sdW1uYCBjaGFubmVscyBhbmQgdGhlaXIgZmllbGQgZGVmaW5pdGlvbnMuXG4gICAqL1xuICBmYWNldDogRmFjZXRNYXBwaW5nPHN0cmluZyB8IFJlcGVhdFJlZj47XG5cbiAgLyoqXG4gICAqIEEgc3BlY2lmaWNhdGlvbiBvZiB0aGUgdmlldyB0aGF0IGdldHMgZmFjZXRlZC5cbiAgICovXG4gIHNwZWM6IEwgfCBVO1xuICAvLyBUT0RPOiByZXBsYWNlIHRoaXMgd2l0aCBHZW5lcmljU3BlYzxVPiBvbmNlIHdlIHN1cHBvcnQgYWxsIGNhc2VzO1xuXG4gIC8qKlxuICAgKiBTY2FsZSwgYXhpcywgYW5kIGxlZ2VuZCByZXNvbHV0aW9ucyBmb3IgZmFjZXRzLlxuICAgKi9cbiAgcmVzb2x2ZT86IFJlc29sdmU7XG59XG5cbmV4cG9ydCB0eXBlIE5vcm1hbGl6ZWRGYWNldFNwZWMgPSBHZW5lcmljRmFjZXRTcGVjPE5vcm1hbGl6ZWRVbml0U3BlYywgTm9ybWFsaXplZExheWVyU3BlYz47XG5cbmV4cG9ydCBpbnRlcmZhY2UgR2VuZXJpY1JlcGVhdFNwZWM8XG4gIFUgZXh0ZW5kcyBHZW5lcmljVW5pdFNwZWM8YW55LCBhbnk+LFxuICBMIGV4dGVuZHMgR2VuZXJpY0xheWVyU3BlYzxhbnk+XG4+IGV4dGVuZHMgQmFzZVNwZWMge1xuICAvKipcbiAgICogQW4gb2JqZWN0IHRoYXQgZGVzY3JpYmVzIHdoYXQgZmllbGRzIHNob3VsZCBiZSByZXBlYXRlZCBpbnRvIHZpZXdzIHRoYXQgYXJlIGxhaWQgb3V0IGFzIGEgYHJvd2Agb3IgYGNvbHVtbmAuXG4gICAqL1xuICByZXBlYXQ6IFJlcGVhdDtcblxuICBzcGVjOiBHZW5lcmljU3BlYzxVLCBMPjtcblxuICAvKipcbiAgICogU2NhbGUgYW5kIGxlZ2VuZCByZXNvbHV0aW9ucyBmb3IgcmVwZWF0ZWQgY2hhcnRzLlxuICAgKi9cbiAgcmVzb2x2ZT86IFJlc29sdmU7XG59XG5cbmV4cG9ydCB0eXBlIE5vcm1hbGl6ZWRSZXBlYXRTcGVjID0gR2VuZXJpY1JlcGVhdFNwZWM8Tm9ybWFsaXplZFVuaXRTcGVjLCBOb3JtYWxpemVkTGF5ZXJTcGVjPjtcblxuZXhwb3J0IGludGVyZmFjZSBHZW5lcmljVkNvbmNhdFNwZWM8XG4gIFUgZXh0ZW5kcyBHZW5lcmljVW5pdFNwZWM8YW55LCBhbnk+LFxuICBMIGV4dGVuZHMgR2VuZXJpY0xheWVyU3BlYzxhbnk+XG4+IGV4dGVuZHMgQmFzZVNwZWMge1xuICAvKipcbiAgICogQSBsaXN0IG9mIHZpZXdzIHRoYXQgc2hvdWxkIGJlIGNvbmNhdGVuYXRlZCBhbmQgcHV0IGludG8gYSBjb2x1bW4uXG4gICAqL1xuICB2Y29uY2F0OiAoR2VuZXJpY1NwZWM8VSwgTD4pW107XG5cbiAgLyoqXG4gICAqIFNjYWxlLCBheGlzLCBhbmQgbGVnZW5kIHJlc29sdXRpb25zIGZvciB2ZXJ0aWNhbGx5IGNvbmNhdGVuYXRlZCBjaGFydHMuXG4gICAqL1xuICByZXNvbHZlPzogUmVzb2x2ZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBHZW5lcmljSENvbmNhdFNwZWM8XG4gIFUgZXh0ZW5kcyBHZW5lcmljVW5pdFNwZWM8YW55LCBhbnk+LFxuICBMIGV4dGVuZHMgR2VuZXJpY0xheWVyU3BlYzxhbnk+XG4+IGV4dGVuZHMgQmFzZVNwZWMge1xuICAvKipcbiAgICogQSBsaXN0IG9mIHZpZXdzIHRoYXQgc2hvdWxkIGJlIGNvbmNhdGVuYXRlZCBhbmQgcHV0IGludG8gYSByb3cuXG4gICAqL1xuICBoY29uY2F0OiAoR2VuZXJpY1NwZWM8VSwgTD4pW107XG5cbiAgLyoqXG4gICAqIFNjYWxlLCBheGlzLCBhbmQgbGVnZW5kIHJlc29sdXRpb25zIGZvciBob3Jpem9udGFsbHkgY29uY2F0ZW5hdGVkIGNoYXJ0cy5cbiAgICovXG4gIHJlc29sdmU/OiBSZXNvbHZlO1xufVxuXG5leHBvcnQgdHlwZSBOb3JtYWxpemVkQ29uY2F0U3BlYyA9XG4gIEdlbmVyaWNWQ29uY2F0U3BlYzxOb3JtYWxpemVkVW5pdFNwZWMsIE5vcm1hbGl6ZWRMYXllclNwZWM+IHwgR2VuZXJpY0hDb25jYXRTcGVjPE5vcm1hbGl6ZWRVbml0U3BlYywgTm9ybWFsaXplZExheWVyU3BlYz47XG5cbmV4cG9ydCB0eXBlIEdlbmVyaWNTcGVjPFxuICBVIGV4dGVuZHMgR2VuZXJpY1VuaXRTcGVjPGFueSwgYW55PixcbiAgTCBleHRlbmRzIEdlbmVyaWNMYXllclNwZWM8YW55PlxuPiA9IFUgfCBMIHwgR2VuZXJpY0ZhY2V0U3BlYzxVLCBMPiB8IEdlbmVyaWNSZXBlYXRTcGVjPFUsIEw+IHxcbiAgR2VuZXJpY1ZDb25jYXRTcGVjPFUsIEw+IHxHZW5lcmljSENvbmNhdFNwZWM8VSwgTD47XG5cbmV4cG9ydCB0eXBlIE5vcm1hbGl6ZWRTcGVjID0gR2VuZXJpY1NwZWM8Tm9ybWFsaXplZFVuaXRTcGVjLCBOb3JtYWxpemVkTGF5ZXJTcGVjPjtcblxuZXhwb3J0IHR5cGUgVG9wTGV2ZWxGYWNldGVkVW5pdFNwZWMgPSBUb3BMZXZlbDxGYWNldGVkQ29tcG9zaXRlVW5pdFNwZWM+ICYgRGF0YU1peGlucztcbmV4cG9ydCB0eXBlIFRvcExldmVsRmFjZXRTcGVjID0gVG9wTGV2ZWw8R2VuZXJpY0ZhY2V0U3BlYzxDb21wb3NpdGVVbml0U3BlYywgRXh0ZW5kZWRMYXllclNwZWM+PiAmIERhdGFNaXhpbnM7XG5cbmV4cG9ydCB0eXBlIFRvcExldmVsU3BlYyA9IFRvcExldmVsRmFjZXRlZFVuaXRTcGVjIHwgVG9wTGV2ZWxGYWNldFNwZWMgfCBUb3BMZXZlbDxFeHRlbmRlZExheWVyU3BlYz4gfFxuVG9wTGV2ZWw8R2VuZXJpY1JlcGVhdFNwZWM8Q29tcG9zaXRlVW5pdFNwZWMsIEV4dGVuZGVkTGF5ZXJTcGVjPj4gfCBUb3BMZXZlbDxHZW5lcmljVkNvbmNhdFNwZWM8Q29tcG9zaXRlVW5pdFNwZWMsIEV4dGVuZGVkTGF5ZXJTcGVjPj4gfCBUb3BMZXZlbDxHZW5lcmljSENvbmNhdFNwZWM8Q29tcG9zaXRlVW5pdFNwZWMsIEV4dGVuZGVkTGF5ZXJTcGVjPj47XG5cbi8qIEN1c3RvbSB0eXBlIGd1YXJkcyAqL1xuXG5cbmV4cG9ydCBmdW5jdGlvbiBpc0ZhY2V0U3BlYyhzcGVjOiBCYXNlU3BlYyk6IHNwZWMgaXMgR2VuZXJpY0ZhY2V0U3BlYzxhbnksIGFueT4ge1xuICByZXR1cm4gc3BlY1snZmFjZXQnXSAhPT0gdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNVbml0U3BlYyhzcGVjOiBCYXNlU3BlYyk6IHNwZWMgaXMgRmFjZXRlZENvbXBvc2l0ZVVuaXRTcGVjIHwgTm9ybWFsaXplZFVuaXRTcGVjIHtcbiAgcmV0dXJuICEhc3BlY1snbWFyayddO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNMYXllclNwZWMoc3BlYzogQmFzZVNwZWMpOiBzcGVjIGlzIEdlbmVyaWNMYXllclNwZWM8YW55PiB7XG4gIHJldHVybiBzcGVjWydsYXllciddICE9PSB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1JlcGVhdFNwZWMoc3BlYzogQmFzZVNwZWMpOiBzcGVjIGlzIEdlbmVyaWNSZXBlYXRTcGVjPGFueSwgYW55PiB7XG4gIHJldHVybiBzcGVjWydyZXBlYXQnXSAhPT0gdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNDb25jYXRTcGVjKHNwZWM6IEJhc2VTcGVjKTpcbiAgc3BlYyBpcyBHZW5lcmljVkNvbmNhdFNwZWM8YW55LCBhbnk+IHxcbiAgICBHZW5lcmljSENvbmNhdFNwZWM8YW55LCBhbnk+IHtcbiAgcmV0dXJuIGlzVkNvbmNhdFNwZWMoc3BlYykgfHwgaXNIQ29uY2F0U3BlYyhzcGVjKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVkNvbmNhdFNwZWMoc3BlYzogQmFzZVNwZWMpOiBzcGVjIGlzIEdlbmVyaWNWQ29uY2F0U3BlYzxhbnksIGFueT4ge1xuICByZXR1cm4gc3BlY1sndmNvbmNhdCddICE9PSB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0hDb25jYXRTcGVjKHNwZWM6IEJhc2VTcGVjKTogc3BlYyBpcyBHZW5lcmljSENvbmNhdFNwZWM8YW55LCBhbnk+IHtcbiAgcmV0dXJuIHNwZWNbJ2hjb25jYXQnXSAhPT0gdW5kZWZpbmVkO1xufVxuXG4vKipcbiAqIERlY29tcG9zZSBleHRlbmRlZCB1bml0IHNwZWNzIGludG8gY29tcG9zaXRpb24gb2YgcHVyZSB1bml0IHNwZWNzLlxuICovXG4vLyBUT0RPOiBjb25zaWRlciBtb3ZpbmcgdGhpcyB0byBhbm90aGVyIGZpbGUuICBNYXliZSB2bC5zcGVjLm5vcm1hbGl6ZSBvciB2bC5ub3JtYWxpemVcbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemUoc3BlYzogVG9wTGV2ZWxTcGVjIHwgR2VuZXJpY1NwZWM8Q29tcG9zaXRlVW5pdFNwZWMsIEV4dGVuZGVkTGF5ZXJTcGVjPiB8IEZhY2V0ZWRDb21wb3NpdGVVbml0U3BlYywgY29uZmlnOiBDb25maWcpOiBOb3JtYWxpemVkU3BlYyB7XG4gIGlmIChpc0ZhY2V0U3BlYyhzcGVjKSkge1xuICAgIHJldHVybiBub3JtYWxpemVGYWNldChzcGVjLCBjb25maWcpO1xuICB9XG4gIGlmIChpc0xheWVyU3BlYyhzcGVjKSkge1xuICAgIHJldHVybiBub3JtYWxpemVMYXllcihzcGVjLCBjb25maWcpO1xuICB9XG4gIGlmIChpc1JlcGVhdFNwZWMoc3BlYykpIHtcbiAgICByZXR1cm4gbm9ybWFsaXplUmVwZWF0KHNwZWMsIGNvbmZpZyk7XG4gIH1cbiAgaWYgKGlzVkNvbmNhdFNwZWMoc3BlYykpIHtcbiAgICByZXR1cm4gbm9ybWFsaXplVkNvbmNhdChzcGVjLCBjb25maWcpO1xuICB9XG4gIGlmIChpc0hDb25jYXRTcGVjKHNwZWMpKSB7XG4gICAgcmV0dXJuIG5vcm1hbGl6ZUhDb25jYXQoc3BlYywgY29uZmlnKTtcbiAgfVxuICBpZiAoaXNVbml0U3BlYyhzcGVjKSkge1xuICAgIGNvbnN0IGhhc1JvdyA9IGNoYW5uZWxIYXNGaWVsZChzcGVjLmVuY29kaW5nLCBST1cpO1xuICAgIGNvbnN0IGhhc0NvbHVtbiA9IGNoYW5uZWxIYXNGaWVsZChzcGVjLmVuY29kaW5nLCBDT0xVTU4pO1xuXG4gICAgaWYgKGhhc1JvdyB8fCBoYXNDb2x1bW4pIHtcbiAgICAgIHJldHVybiBub3JtYWxpemVGYWNldGVkVW5pdChzcGVjLCBjb25maWcpO1xuICAgIH1cbiAgICByZXR1cm4gbm9ybWFsaXplTm9uRmFjZXRVbml0KHNwZWMsIGNvbmZpZyk7XG4gIH1cbiAgdGhyb3cgbmV3IEVycm9yKGxvZy5tZXNzYWdlLklOVkFMSURfU1BFQyk7XG59XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZUZhY2V0KHNwZWM6IEdlbmVyaWNGYWNldFNwZWM8Q29tcG9zaXRlVW5pdFNwZWMsIEV4dGVuZGVkTGF5ZXJTcGVjPiwgY29uZmlnOiBDb25maWcpOiBOb3JtYWxpemVkRmFjZXRTcGVjIHtcbiAgY29uc3Qge3NwZWM6IHN1YnNwZWMsIC4uLnJlc3R9ID0gc3BlYztcbiAgcmV0dXJuIHtcbiAgICAuLi5yZXN0LFxuICAgIC8vIFRPRE86IHJlbW92ZSBcImFueVwiIG9uY2Ugd2Ugc3VwcG9ydCBhbGwgZmFjZXQgbGlzdGVkIGluIGh0dHBzOi8vZ2l0aHViLmNvbS92ZWdhL3ZlZ2EtbGl0ZS9pc3N1ZXMvMjc2MFxuICAgIHNwZWM6IG5vcm1hbGl6ZShzdWJzcGVjLCBjb25maWcpIGFzIGFueVxuICB9O1xufVxuXG5mdW5jdGlvbiBtZXJnZUVuY29kaW5nKG9wdDoge3BhcmVudEVuY29kaW5nOiBFbmNvZGluZzxhbnk+LCBlbmNvZGluZzogRW5jb2Rpbmc8YW55Pn0pOiBFbmNvZGluZzxhbnk+IHtcbiAgY29uc3Qge3BhcmVudEVuY29kaW5nLCBlbmNvZGluZ30gPSBvcHQ7XG4gIGlmIChwYXJlbnRFbmNvZGluZyAmJiBlbmNvZGluZykge1xuICAgIGNvbnN0IG92ZXJyaWRlbiA9IGtleXMocGFyZW50RW5jb2RpbmcpLnJlZHVjZSgobywga2V5KSA9PiB7XG4gICAgICBpZiAoZW5jb2Rpbmdba2V5XSkge1xuICAgICAgICBvLnB1c2goa2V5KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBvO1xuICAgIH0sIFtdKTtcblxuICAgIGlmIChvdmVycmlkZW4ubGVuZ3RoID4gMCkge1xuICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuZW5jb2RpbmdPdmVycmlkZGVuKG92ZXJyaWRlbikpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IG1lcmdlZCA9IHtcbiAgICAuLi4ocGFyZW50RW5jb2RpbmcgfHwge30pLFxuICAgIC4uLihlbmNvZGluZyB8fCB7fSlcbiAgfTtcbiAgcmV0dXJuIGtleXMobWVyZ2VkKS5sZW5ndGggPiAwID8gbWVyZ2VkIDogdW5kZWZpbmVkO1xufVxuXG5mdW5jdGlvbiBtZXJnZVByb2plY3Rpb24ob3B0OiB7cGFyZW50UHJvamVjdGlvbjogUHJvamVjdGlvbiwgcHJvamVjdGlvbjogUHJvamVjdGlvbn0pIHtcbiAgY29uc3Qge3BhcmVudFByb2plY3Rpb24sIHByb2plY3Rpb259ID0gb3B0O1xuICBpZiAocGFyZW50UHJvamVjdGlvbiAmJiBwcm9qZWN0aW9uKSB7XG4gICAgbG9nLndhcm4obG9nLm1lc3NhZ2UucHJvamVjdGlvbk92ZXJyaWRkZW4oe3BhcmVudFByb2plY3Rpb24sIHByb2plY3Rpb259KSk7XG4gIH1cbiAgcmV0dXJuIHByb2plY3Rpb24gfHwgcGFyZW50UHJvamVjdGlvbjtcbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplTGF5ZXIoXG4gIHNwZWM6IEV4dGVuZGVkTGF5ZXJTcGVjLFxuICBjb25maWc6IENvbmZpZyxcbiAgcGFyZW50RW5jb2Rpbmc/OiBFbmNvZGluZzxzdHJpbmcgfCBSZXBlYXRSZWY+LFxuICBwYXJlbnRQcm9qZWN0aW9uPzogUHJvamVjdGlvblxuKTogTm9ybWFsaXplZExheWVyU3BlYyB7XG4gIGNvbnN0IHtsYXllciwgZW5jb2RpbmcsIHByb2plY3Rpb24sIC4uLnJlc3R9ID0gc3BlYztcbiAgY29uc3QgbWVyZ2VkRW5jb2RpbmcgPSBtZXJnZUVuY29kaW5nKHtwYXJlbnRFbmNvZGluZywgZW5jb2Rpbmd9KTtcbiAgY29uc3QgbWVyZ2VkUHJvamVjdGlvbiA9IG1lcmdlUHJvamVjdGlvbih7cGFyZW50UHJvamVjdGlvbiwgcHJvamVjdGlvbn0pO1xuICByZXR1cm4ge1xuICAgIC4uLnJlc3QsXG4gICAgbGF5ZXI6IGxheWVyLm1hcCgoc3Vic3BlYykgPT4ge1xuICAgICAgaWYgKGlzTGF5ZXJTcGVjKHN1YnNwZWMpKSB7XG4gICAgICAgIHJldHVybiBub3JtYWxpemVMYXllcihzdWJzcGVjLCBjb25maWcsIG1lcmdlZEVuY29kaW5nLCBtZXJnZWRQcm9qZWN0aW9uKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBub3JtYWxpemVOb25GYWNldFVuaXQoc3Vic3BlYywgY29uZmlnLCBtZXJnZWRFbmNvZGluZywgbWVyZ2VkUHJvamVjdGlvbik7XG4gICAgfSlcbiAgfTtcbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplUmVwZWF0KHNwZWM6IEdlbmVyaWNSZXBlYXRTcGVjPENvbXBvc2l0ZVVuaXRTcGVjLCBFeHRlbmRlZExheWVyU3BlYz4sIGNvbmZpZzogQ29uZmlnKTogTm9ybWFsaXplZFJlcGVhdFNwZWMge1xuICBjb25zdCB7c3BlYzogc3Vic3BlYywgLi4ucmVzdH0gPSBzcGVjO1xuICByZXR1cm4ge1xuICAgIC4uLnJlc3QsXG4gICAgc3BlYzogbm9ybWFsaXplKHN1YnNwZWMsIGNvbmZpZylcbiAgfTtcbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplVkNvbmNhdChzcGVjOiBHZW5lcmljVkNvbmNhdFNwZWM8Q29tcG9zaXRlVW5pdFNwZWMsIEV4dGVuZGVkTGF5ZXJTcGVjPiwgY29uZmlnOiBDb25maWcpOiBOb3JtYWxpemVkQ29uY2F0U3BlYyB7XG4gIGNvbnN0IHt2Y29uY2F0OiB2Y29uY2F0LCAuLi5yZXN0fSA9IHNwZWM7XG4gIHJldHVybiB7XG4gICAgLi4ucmVzdCxcbiAgICB2Y29uY2F0OiB2Y29uY2F0Lm1hcCgoc3Vic3BlYykgPT4gbm9ybWFsaXplKHN1YnNwZWMsIGNvbmZpZykpXG4gIH07XG59XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZUhDb25jYXQoc3BlYzogR2VuZXJpY0hDb25jYXRTcGVjPENvbXBvc2l0ZVVuaXRTcGVjLCBFeHRlbmRlZExheWVyU3BlYz4sIGNvbmZpZzogQ29uZmlnKTogTm9ybWFsaXplZENvbmNhdFNwZWMge1xuICBjb25zdCB7aGNvbmNhdDogaGNvbmNhdCwgLi4ucmVzdH0gPSBzcGVjO1xuICByZXR1cm4ge1xuICAgIC4uLnJlc3QsXG4gICAgaGNvbmNhdDogaGNvbmNhdC5tYXAoKHN1YnNwZWMpID0+IG5vcm1hbGl6ZShzdWJzcGVjLCBjb25maWcpKVxuICB9O1xufVxuXG5mdW5jdGlvbiBub3JtYWxpemVGYWNldGVkVW5pdChzcGVjOiBGYWNldGVkQ29tcG9zaXRlVW5pdFNwZWMsIGNvbmZpZzogQ29uZmlnKTogTm9ybWFsaXplZEZhY2V0U3BlYyB7XG4gIC8vIE5ldyBlbmNvZGluZyBpbiB0aGUgaW5zaWRlIHNwZWMgc2hvdWxkIG5vdCBjb250YWluIHJvdyAvIGNvbHVtblxuICAvLyBhcyByb3cvY29sdW1uIHNob3VsZCBiZSBtb3ZlZCB0byBmYWNldFxuICBjb25zdCB7cm93OiByb3csIGNvbHVtbjogY29sdW1uLCAuLi5lbmNvZGluZ30gPSBzcGVjLmVuY29kaW5nO1xuXG4gIC8vIE1hcmsgYW5kIGVuY29kaW5nIHNob3VsZCBiZSBtb3ZlZCBpbnRvIHRoZSBpbm5lciBzcGVjXG4gIGNvbnN0IHttYXJrLCB3aWR0aCwgcHJvamVjdGlvbiwgaGVpZ2h0LCBzZWxlY3Rpb24sIGVuY29kaW5nOiBfLCAuLi5vdXRlclNwZWN9ID0gc3BlYztcblxuICByZXR1cm4ge1xuICAgIC4uLm91dGVyU3BlYyxcbiAgICBmYWNldDoge1xuICAgICAgLi4uKHJvdyA/IHtyb3d9IDoge30pLFxuICAgICAgLi4uKGNvbHVtbiA/IHtjb2x1bW59OiB7fSksXG4gICAgfSxcbiAgICBzcGVjOiBub3JtYWxpemVOb25GYWNldFVuaXQoe1xuICAgICAgLi4uKHByb2plY3Rpb24gPyB7cHJvamVjdGlvbn0gOiB7fSksXG4gICAgICBtYXJrLFxuICAgICAgLi4uKHdpZHRoID8ge3dpZHRofSA6IHt9KSxcbiAgICAgIC4uLihoZWlnaHQgPyB7aGVpZ2h0fSA6IHt9KSxcbiAgICAgIGVuY29kaW5nLFxuICAgICAgLi4uKHNlbGVjdGlvbiA/IHtzZWxlY3Rpb259IDoge30pXG4gICAgfSwgY29uZmlnKVxuICB9O1xufVxuXG5mdW5jdGlvbiBpc05vbkZhY2V0VW5pdFNwZWNXaXRoUHJpbWl0aXZlTWFyayhzcGVjOiBHZW5lcmljVW5pdFNwZWM8RW5jb2Rpbmc8RmllbGQ+LCBBbnlNYXJrPik6XG4gIHNwZWMgaXMgR2VuZXJpY1VuaXRTcGVjPEVuY29kaW5nPEZpZWxkPiwgTWFyaz4ge1xuICAgIHJldHVybiBpc1ByaW1pdGl2ZU1hcmsoc3BlYy5tYXJrKTtcbn1cblxuZnVuY3Rpb24gZ2V0UG9pbnRPdmVybGF5KG1hcmtEZWY6IE1hcmtEZWYsIG1hcmtDb25maWc6IExpbmVDb25maWcsIGVuY29kaW5nOiBFbmNvZGluZzxGaWVsZD4pOiBNYXJrQ29uZmlnIHtcbiAgaWYgKG1hcmtEZWYucG9pbnQgPT09ICd0cmFuc3BhcmVudCcpIHtcbiAgICByZXR1cm4ge29wYWNpdHk6IDB9O1xuICB9IGVsc2UgaWYgKG1hcmtEZWYucG9pbnQpIHsgLy8gdHJ1dGh5IDogdHJ1ZSBvciBvYmplY3RcbiAgICByZXR1cm4gaXNPYmplY3QobWFya0RlZi5wb2ludCkgPyBtYXJrRGVmLnBvaW50IDoge307XG4gIH0gZWxzZSBpZiAobWFya0RlZi5wb2ludCAhPT0gdW5kZWZpbmVkKSB7IC8vIGZhbHNlIG9yIG51bGxcbiAgICByZXR1cm4gbnVsbDtcbiAgfSBlbHNlIHsgLy8gdW5kZWZpbmVkIChub3QgZGlzYWJsZWQpXG4gICAgaWYgKG1hcmtDb25maWcucG9pbnQgfHwgZW5jb2Rpbmcuc2hhcGUpIHtcbiAgICAgIC8vIGVuYWJsZSBwb2ludCBvdmVybGF5IGlmIGNvbmZpZ1ttYXJrXS5wb2ludCBpcyB0cnV0aHkgb3IgaWYgZW5jb2Rpbmcuc2hhcGUgaXMgcHJvdmlkZWRcbiAgICAgIHJldHVybiBpc09iamVjdChtYXJrQ29uZmlnLnBvaW50KSA/IG1hcmtDb25maWcucG9pbnQgOiB7fTtcbiAgICB9XG4gICAgLy8gbWFya0RlZi5wb2ludCBpcyBkZWZpbmVkIGFzIGZhbHN5XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0TGluZU92ZXJsYXkobWFya0RlZjogTWFya0RlZiwgbWFya0NvbmZpZzogQXJlYUNvbmZpZyk6IE1hcmtDb25maWcge1xuICBpZiAobWFya0RlZi5saW5lKSB7IC8vIHRydWUgb3Igb2JqZWN0XG4gICAgcmV0dXJuIG1hcmtEZWYubGluZSA9PT0gdHJ1ZSA/IHt9IDogbWFya0RlZi5saW5lO1xuICB9IGVsc2UgaWYgKG1hcmtEZWYubGluZSAhPT0gdW5kZWZpbmVkKSB7IC8vIGZhbHNlIG9yIG51bGxcbiAgICByZXR1cm4gbnVsbDtcbiAgfSBlbHNlIHsgLy8gdW5kZWZpbmVkIChub3QgZGlzYWJsZWQpXG4gICAgaWYgKG1hcmtDb25maWcubGluZSkge1xuICAgICAgLy8gZW5hYmxlIGxpbmUgb3ZlcmxheSBpZiBjb25maWdbbWFya10ubGluZSBpcyB0cnV0aHlcbiAgICAgIHJldHVybiBtYXJrQ29uZmlnLmxpbmUgPT09IHRydWUgPyB7fSA6IG1hcmtDb25maWcubGluZTtcbiAgICB9XG4gICAgLy8gbWFya0RlZi5wb2ludCBpcyBkZWZpbmVkIGFzIGZhbHN5XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplTm9uRmFjZXRVbml0KFxuICBzcGVjOiBHZW5lcmljVW5pdFNwZWM8RW5jb2Rpbmc8RmllbGQ+LCBBbnlNYXJrPiwgY29uZmlnOiBDb25maWcsXG4gIHBhcmVudEVuY29kaW5nPzogRW5jb2Rpbmc8c3RyaW5nIHwgUmVwZWF0UmVmPiwgcGFyZW50UHJvamVjdGlvbj86IFByb2plY3Rpb25cbik6IE5vcm1hbGl6ZWRVbml0U3BlYyB8IE5vcm1hbGl6ZWRMYXllclNwZWMge1xuICBjb25zdCB7ZW5jb2RpbmcsIHByb2plY3Rpb259ID0gc3BlYztcbiAgY29uc3QgbWFyayA9IGlzTWFya0RlZihzcGVjLm1hcmspID8gc3BlYy5tYXJrLnR5cGUgOiBzcGVjLm1hcms7XG5cblxuICAvLyBtZXJnZSBwYXJlbnQgZW5jb2RpbmcgLyBwcm9qZWN0aW9uIGZpcnN0XG4gIGlmIChwYXJlbnRFbmNvZGluZyB8fCBwYXJlbnRQcm9qZWN0aW9uKSB7XG4gICAgY29uc3QgbWVyZ2VkUHJvamVjdGlvbiA9IG1lcmdlUHJvamVjdGlvbih7cGFyZW50UHJvamVjdGlvbiwgcHJvamVjdGlvbn0pO1xuICAgIGNvbnN0IG1lcmdlZEVuY29kaW5nID0gbWVyZ2VFbmNvZGluZyh7cGFyZW50RW5jb2RpbmcsIGVuY29kaW5nfSk7XG4gICAgcmV0dXJuIG5vcm1hbGl6ZU5vbkZhY2V0VW5pdCh7XG4gICAgICAuLi5zcGVjLFxuICAgICAgLi4uKG1lcmdlZFByb2plY3Rpb24gPyB7cHJvamVjdGlvbjogbWVyZ2VkUHJvamVjdGlvbn0gOiB7fSksXG4gICAgICAuLi4obWVyZ2VkRW5jb2RpbmcgPyB7ZW5jb2Rpbmc6IG1lcmdlZEVuY29kaW5nfSA6IHt9KSxcbiAgICB9LCBjb25maWcpO1xuICB9XG5cbiAgaWYgKGlzTm9uRmFjZXRVbml0U3BlY1dpdGhQcmltaXRpdmVNYXJrKHNwZWMpKSB7XG4gICAgLy8gVE9ETzogdGhvcm91Z2hseSB0ZXN0XG4gICAgaWYgKGlzUmFuZ2VkKGVuY29kaW5nKSkge1xuICAgICAgcmV0dXJuIG5vcm1hbGl6ZVJhbmdlZFVuaXQoc3BlYyk7XG4gICAgfVxuXG4gICAgaWYgKG1hcmsgPT09ICdsaW5lJyAmJiAoZW5jb2RpbmcueDIgfHwgZW5jb2RpbmcueTIpKSB7XG4gICAgICBsb2cud2Fybihsb2cubWVzc2FnZS5saW5lV2l0aFJhbmdlKCEhZW5jb2RpbmcueDIsICEhZW5jb2RpbmcueTIpKTtcblxuICAgICAgcmV0dXJuIG5vcm1hbGl6ZU5vbkZhY2V0VW5pdCh7XG4gICAgICAgIG1hcms6ICdydWxlJyxcbiAgICAgICAgLi4uc3BlY1xuICAgICAgfSwgY29uZmlnLCBwYXJlbnRFbmNvZGluZywgcGFyZW50UHJvamVjdGlvbik7XG4gICAgfVxuXG4gICAgaWYgKGlzUGF0aE1hcmsobWFyaykpIHtcbiAgICAgIHJldHVybiBub3JtYWxpemVQYXRoT3ZlcmxheShzcGVjLCBjb25maWcpO1xuICAgIH1cblxuICAgIHJldHVybiBzcGVjOyAvLyBOb3RoaW5nIHRvIG5vcm1hbGl6ZVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBjb21wb3NpdGVNYXJrLm5vcm1hbGl6ZShzcGVjLCBjb25maWcpO1xuICB9XG59XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZVJhbmdlZFVuaXQoc3BlYzogTm9ybWFsaXplZFVuaXRTcGVjKSB7XG4gIGNvbnN0IGhhc1ggPSBjaGFubmVsSGFzRmllbGQoc3BlYy5lbmNvZGluZywgWCk7XG4gIGNvbnN0IGhhc1kgPSBjaGFubmVsSGFzRmllbGQoc3BlYy5lbmNvZGluZywgWSk7XG4gIGNvbnN0IGhhc1gyID0gY2hhbm5lbEhhc0ZpZWxkKHNwZWMuZW5jb2RpbmcsIFgyKTtcbiAgY29uc3QgaGFzWTIgPSBjaGFubmVsSGFzRmllbGQoc3BlYy5lbmNvZGluZywgWTIpO1xuICBpZiAoKGhhc1gyICYmICFoYXNYKSB8fCAoaGFzWTIgJiYgIWhhc1kpKSB7XG4gICAgY29uc3Qgbm9ybWFsaXplZFNwZWMgPSBkdXBsaWNhdGUoc3BlYyk7XG4gICAgaWYgKGhhc1gyICYmICFoYXNYKSB7XG4gICAgICBub3JtYWxpemVkU3BlYy5lbmNvZGluZy54ID0gbm9ybWFsaXplZFNwZWMuZW5jb2RpbmcueDI7XG4gICAgICBkZWxldGUgbm9ybWFsaXplZFNwZWMuZW5jb2RpbmcueDI7XG4gICAgfVxuICAgIGlmIChoYXNZMiAmJiAhaGFzWSkge1xuICAgICAgbm9ybWFsaXplZFNwZWMuZW5jb2RpbmcueSA9IG5vcm1hbGl6ZWRTcGVjLmVuY29kaW5nLnkyO1xuICAgICAgZGVsZXRlIG5vcm1hbGl6ZWRTcGVjLmVuY29kaW5nLnkyO1xuICAgIH1cblxuICAgIHJldHVybiBub3JtYWxpemVkU3BlYztcbiAgfVxuICByZXR1cm4gc3BlYztcbn1cblxuZnVuY3Rpb24gZHJvcExpbmVBbmRQb2ludChtYXJrRGVmOiBNYXJrRGVmKTogTWFya0RlZiB8IE1hcmsge1xuICBjb25zdCB7cG9pbnQ6IF9wb2ludCwgbGluZTogX2xpbmUsIC4uLm1hcmt9ID0gbWFya0RlZjtcblxuICByZXR1cm4ga2V5cyhtYXJrKS5sZW5ndGggPiAxID8gbWFyayA6IG1hcmsudHlwZTtcbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplUGF0aE92ZXJsYXkoc3BlYzogTm9ybWFsaXplZFVuaXRTcGVjLCBjb25maWc6IENvbmZpZyA9IHt9KTogTm9ybWFsaXplZExheWVyU3BlYyB8IE5vcm1hbGl6ZWRVbml0U3BlYyB7XG5cbiAgLy8gXyBpcyB1c2VkIHRvIGRlbm90ZSBhIGRyb3BwZWQgcHJvcGVydHkgb2YgdGhlIHVuaXQgc3BlY1xuICAvLyB3aGljaCBzaG91bGQgbm90IGJlIGNhcnJpZWQgb3ZlciB0byB0aGUgbGF5ZXIgc3BlY1xuICBjb25zdCB7c2VsZWN0aW9uLCBwcm9qZWN0aW9uLCBlbmNvZGluZywgbWFyaywgLi4ub3V0ZXJTcGVjfSA9IHNwZWM7XG4gIGNvbnN0IG1hcmtEZWYgPSBpc01hcmtEZWYobWFyaykgPyBtYXJrIDoge3R5cGU6IG1hcmt9O1xuXG4gIGNvbnN0IHBvaW50T3ZlcmxheSA9IGdldFBvaW50T3ZlcmxheShtYXJrRGVmLCBjb25maWdbbWFya0RlZi50eXBlXSwgZW5jb2RpbmcpO1xuICBjb25zdCBsaW5lT3ZlcmxheSA9IG1hcmtEZWYudHlwZSA9PT0gJ2FyZWEnICYmIGdldExpbmVPdmVybGF5KG1hcmtEZWYsIGNvbmZpZ1ttYXJrRGVmLnR5cGVdKTtcblxuICBpZiAoIXBvaW50T3ZlcmxheSAmJiAhbGluZU92ZXJsYXkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgLi4uc3BlYyxcbiAgICAgIC8vIERvIG5vdCBpbmNsdWRlIHBvaW50IC8gbGluZSBvdmVybGF5IGluIHRoZSBub3JtYWxpemUgc3BlY1xuICAgICAgbWFyazogZHJvcExpbmVBbmRQb2ludChtYXJrRGVmKVxuICAgIH07XG4gIH1cblxuICBjb25zdCBsYXllcjogTm9ybWFsaXplZFVuaXRTcGVjW10gPSBbe1xuICAgIC4uLihzZWxlY3Rpb24gPyB7c2VsZWN0aW9ufSA6IHt9KSxcbiAgICAvLyBEbyBub3QgaW5jbHVkZSBwb2ludCAvIGxpbmUgb3ZlcmxheSBpbiB0aGUgbm9ybWFsaXplIHNwZWNcbiAgICBtYXJrOiBkcm9wTGluZUFuZFBvaW50KHtcbiAgICAgIC4uLm1hcmtEZWYsXG4gICAgICAvLyBtYWtlIGFyZWEgbWFyayB0cmFuc2x1Y2VudCBieSBkZWZhdWx0XG4gICAgICAvLyBUT0RPOiBleHRyYWN0IHRoaXMgMC43IHRvIGJlIHNoYXJlZCB3aXRoIGRlZmF1bHQgb3BhY2l0eSBmb3IgcG9pbnQvdGljay8uLi5cbiAgICAgIC4uLihtYXJrRGVmLnR5cGUgPT09ICdhcmVhJyA/IHtvcGFjaXR5OiAwLjd9IDoge30pLFxuICAgIH0pLFxuICAgIC8vIGRyb3Agc2hhcGUgZnJvbSBlbmNvZGluZyBhcyB0aGlzIG1pZ2h0IGJlIHVzZWQgdG8gdHJpZ2dlciBwb2ludCBvdmVybGF5XG4gICAgZW5jb2Rpbmc6IG9taXQoZW5jb2RpbmcsIFsnc2hhcGUnXSlcbiAgfV07XG5cbiAgLy8gRklYTUU6IGRpc2FibGUgdG9vbHRpcCBmb3IgdGhlIGxpbmUgbGF5ZXIgaWYgdG9vbHRpcCBpcyBub3QgZ3JvdXAtYnkgZmllbGQuXG4gIC8vIEZJWE1FOiBkZXRlcm1pbmUgcnVsZXMgZm9yIGFwcGx5aW5nIHNlbGVjdGlvbnMuXG5cbiAgLy8gTmVlZCB0byBjb3B5IHN0YWNrIGNvbmZpZyB0byBvdmVybGF5ZWQgbGF5ZXJcbiAgY29uc3Qgc3RhY2tQcm9wcyA9IHN0YWNrKG1hcmtEZWYsIGVuY29kaW5nLCBjb25maWcgPyBjb25maWcuc3RhY2sgOiB1bmRlZmluZWQpO1xuXG4gIGxldCBvdmVybGF5RW5jb2RpbmcgPSBlbmNvZGluZztcbiAgaWYgKHN0YWNrUHJvcHMpIHtcbiAgICBjb25zdCB7ZmllbGRDaGFubmVsOiBzdGFja0ZpZWxkQ2hhbm5lbCwgb2Zmc2V0fSA9IHN0YWNrUHJvcHM7XG4gICAgb3ZlcmxheUVuY29kaW5nID0ge1xuICAgICAgLi4uZW5jb2RpbmcsXG4gICAgICBbc3RhY2tGaWVsZENoYW5uZWxdOiB7XG4gICAgICAgIC4uLmVuY29kaW5nW3N0YWNrRmllbGRDaGFubmVsXSxcbiAgICAgICAgLi4uKG9mZnNldCA/IHtzdGFjazogb2Zmc2V0fSA6IHt9KVxuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBpZiAobGluZU92ZXJsYXkpIHtcbiAgICBjb25zdCB7aW50ZXJwb2xhdGV9ID0gbWFya0RlZjtcbiAgICBsYXllci5wdXNoKHtcbiAgICAgIC4uLihwcm9qZWN0aW9uID8ge3Byb2plY3Rpb259IDoge30pLFxuICAgICAgbWFyazoge1xuICAgICAgICB0eXBlOiAnbGluZScsXG4gICAgICAgIC4uLmxpbmVPdmVybGF5LFxuICAgICAgICAuLi4oaW50ZXJwb2xhdGUgPyB7aW50ZXJwb2xhdGV9IDoge30pXG4gICAgICB9LFxuICAgICAgZW5jb2Rpbmc6IG92ZXJsYXlFbmNvZGluZ1xuICAgIH0pO1xuICB9XG4gIGlmIChwb2ludE92ZXJsYXkpIHtcbiAgICBsYXllci5wdXNoKHtcbiAgICAgIC4uLihwcm9qZWN0aW9uID8ge3Byb2plY3Rpb259IDoge30pLFxuICAgICAgbWFyazoge1xuICAgICAgICB0eXBlOiAncG9pbnQnLFxuICAgICAgICBvcGFjaXR5OiAxLFxuICAgICAgICBmaWxsZWQ6IHRydWUsXG4gICAgICAgIC4uLnBvaW50T3ZlcmxheVxuICAgICAgfSxcbiAgICAgIGVuY29kaW5nOiBvdmVybGF5RW5jb2RpbmdcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgLi4ub3V0ZXJTcGVjLFxuICAgIGxheWVyXG4gIH07XG59XG5cbi8vIFRPRE86IGFkZCB2bC5zcGVjLnZhbGlkYXRlICYgbW92ZSBzdHVmZiBmcm9tIHZsLnZhbGlkYXRlIHRvIGhlcmVcblxuLyogQWNjdW11bGF0ZSBub24tZHVwbGljYXRlIGZpZWxkRGVmcyBpbiBhIGRpY3Rpb25hcnkgKi9cbmZ1bmN0aW9uIGFjY3VtdWxhdGUoZGljdDogYW55LCBkZWZzOiBGaWVsZERlZjxGaWVsZD5bXSk6IGFueSB7XG4gIGRlZnMuZm9yRWFjaChmdW5jdGlvbihmaWVsZERlZikge1xuICAgIC8vIENvbnNpZGVyIG9ubHkgcHVyZSBmaWVsZERlZiBwcm9wZXJ0aWVzIChpZ25vcmluZyBzY2FsZSwgYXhpcywgbGVnZW5kKVxuICAgIGNvbnN0IHB1cmVGaWVsZERlZiA9IFsnZmllbGQnLCAndHlwZScsICd2YWx1ZScsICd0aW1lVW5pdCcsICdiaW4nLCAnYWdncmVnYXRlJ10ucmVkdWNlKChmLCBrZXkpID0+IHtcbiAgICAgIGlmIChmaWVsZERlZltrZXldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZltrZXldID0gZmllbGREZWZba2V5XTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmO1xuICAgIH0sIHt9KTtcbiAgICBjb25zdCBrZXkgPSBoYXNoKHB1cmVGaWVsZERlZik7XG4gICAgZGljdFtrZXldID0gZGljdFtrZXldIHx8IGZpZWxkRGVmO1xuICB9KTtcbiAgcmV0dXJuIGRpY3Q7XG59XG5cbi8qIFJlY3Vyc2l2ZWx5IGdldCBmaWVsZERlZnMgZnJvbSBhIHNwZWMsIHJldHVybnMgYSBkaWN0aW9uYXJ5IG9mIGZpZWxkRGVmcyAqL1xuZnVuY3Rpb24gZmllbGREZWZJbmRleDxUPihzcGVjOiBHZW5lcmljU3BlYzxhbnksIGFueT4sIGRpY3Q6IERpY3Q8RmllbGREZWY8VD4+ID0ge30pOiBEaWN0PEZpZWxkRGVmPFQ+PiB7XG4gIC8vIEZJWE1FKGh0dHBzOi8vZ2l0aHViLmNvbS92ZWdhL3ZlZ2EtbGl0ZS9pc3N1ZXMvMjIwNyk6IFN1cHBvcnQgZmllbGREZWZJbmRleCBmb3IgcmVwZWF0XG4gIGlmIChpc0xheWVyU3BlYyhzcGVjKSkge1xuICAgIHNwZWMubGF5ZXIuZm9yRWFjaChsYXllciA9PiB7XG4gICAgICBpZiAoaXNVbml0U3BlYyhsYXllcikpIHtcbiAgICAgICAgYWNjdW11bGF0ZShkaWN0LCB2bEVuY29kaW5nLmZpZWxkRGVmcyhsYXllci5lbmNvZGluZykpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZmllbGREZWZJbmRleChsYXllciwgZGljdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0gZWxzZSBpZiAoaXNGYWNldFNwZWMoc3BlYykpIHtcbiAgICBhY2N1bXVsYXRlKGRpY3QsIHZsRW5jb2RpbmcuZmllbGREZWZzKHNwZWMuZmFjZXQpKTtcbiAgICBmaWVsZERlZkluZGV4KHNwZWMuc3BlYywgZGljdCk7XG4gIH0gZWxzZSBpZiAoaXNSZXBlYXRTcGVjKHNwZWMpKSB7XG4gICAgZmllbGREZWZJbmRleChzcGVjLnNwZWMsIGRpY3QpO1xuICB9IGVsc2UgaWYgKGlzQ29uY2F0U3BlYyhzcGVjKSkge1xuICAgIGNvbnN0IGNoaWxkU3BlYyA9IGlzVkNvbmNhdFNwZWMoc3BlYykgPyBzcGVjLnZjb25jYXQgOiBzcGVjLmhjb25jYXQ7XG4gICAgY2hpbGRTcGVjLmZvckVhY2goY2hpbGQgPT4gZmllbGREZWZJbmRleChjaGlsZCwgZGljdCkpO1xuICB9IGVsc2UgeyAvLyBVbml0IFNwZWNcbiAgICBhY2N1bXVsYXRlKGRpY3QsIHZsRW5jb2RpbmcuZmllbGREZWZzKHNwZWMuZW5jb2RpbmcpKTtcbiAgfVxuICByZXR1cm4gZGljdDtcbn1cblxuLyogUmV0dXJucyBhbGwgbm9uLWR1cGxpY2F0ZSBmaWVsZERlZnMgaW4gYSBzcGVjIGluIGEgZmxhdCBhcnJheSAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZpZWxkRGVmcyhzcGVjOiBHZW5lcmljU3BlYzxhbnksIGFueT4pOiBGaWVsZERlZjxhbnk+W10ge1xuICByZXR1cm4gdmFscyhmaWVsZERlZkluZGV4KHNwZWMpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU3RhY2tlZChzcGVjOiBUb3BMZXZlbDxGYWNldGVkQ29tcG9zaXRlVW5pdFNwZWM+LCBjb25maWc/OiBDb25maWcpOiBib29sZWFuIHtcbiAgY29uZmlnID0gY29uZmlnIHx8IHNwZWMuY29uZmlnO1xuICBpZiAoaXNQcmltaXRpdmVNYXJrKHNwZWMubWFyaykpIHtcbiAgICByZXR1cm4gc3RhY2soc3BlYy5tYXJrLCBzcGVjLmVuY29kaW5nLFxuICAgICAgICAgICAgY29uZmlnID8gY29uZmlnLnN0YWNrIDogdW5kZWZpbmVkXG4gICAgICAgICAgKSAhPT0gbnVsbDtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { isString } from 'vega-util';\nimport * as log from './log';\nfunction _normalizeAutoSize(autosize) {\n    return isString(autosize) ? { type: autosize } : autosize || {};\n}\nexport function normalizeAutoSize(topLevelAutosize, configAutosize, isUnitOrLayer) {\n    if (isUnitOrLayer === void 0) { isUnitOrLayer = true; }\n    var autosize = tslib_1.__assign({ type: 'pad' }, _normalizeAutoSize(configAutosize), _normalizeAutoSize(topLevelAutosize));\n    if (autosize.type === 'fit') {\n        if (!isUnitOrLayer) {\n            log.warn(log.message.FIT_NON_SINGLE);\n            autosize.type = 'pad';\n        }\n    }\n    return autosize;\n}\nvar TOP_LEVEL_PROPERTIES = [\n    'background', 'padding', 'datasets'\n    // We do not include \"autosize\" here as it is supported by only unit and layer specs and thus need to be normalized\n];\nexport function extractTopLevelProperties(t) {\n    return TOP_LEVEL_PROPERTIES.reduce(function (o, p) {\n        if (t && t[p] !== undefined) {\n            o[p] = t[p];\n        }\n        return o;\n    }, {});\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9wbGV2ZWxwcm9wcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90b3BsZXZlbHByb3BzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUMsUUFBUSxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBR25DLE9BQU8sS0FBSyxHQUFHLE1BQU0sT0FBTyxDQUFDO0FBbUU3Qiw0QkFBNEIsUUFBdUM7SUFDakUsT0FBTyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUMsSUFBSSxFQUFFLFFBQVEsRUFBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLElBQUksRUFBRSxDQUFDO0FBQ2hFLENBQUM7QUFFRCxNQUFNLDRCQUE0QixnQkFBK0MsRUFBRSxjQUE2QyxFQUFFLGFBQTZCO0lBQTdCLDhCQUFBLEVBQUEsb0JBQTZCO0lBQzdKLElBQU0sUUFBUSxzQkFDWixJQUFJLEVBQUUsS0FBSyxJQUNSLGtCQUFrQixDQUFDLGNBQWMsQ0FBQyxFQUNsQyxrQkFBa0IsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUN4QyxDQUFDO0lBRUYsSUFBSSxRQUFRLENBQUMsSUFBSSxLQUFLLEtBQUssRUFBRTtRQUMzQixJQUFJLENBQUMsYUFBYSxFQUFFO1lBQ2xCLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxjQUFjLENBQUMsQ0FBQztZQUNyQyxRQUFRLENBQUMsSUFBSSxHQUFHLEtBQUssQ0FBQztTQUN2QjtLQUNGO0lBRUQsT0FBTyxRQUFRLENBQUM7QUFDbEIsQ0FBQztBQUVELElBQU0sb0JBQW9CLEdBQWlDO0lBQ3pELFlBQVksRUFBRSxTQUFTLEVBQUUsVUFBVTtJQUNuQyxtSEFBbUg7Q0FDcEgsQ0FBQztBQUVGLE1BQU0sb0NBQWtFLENBQUk7SUFDMUUsT0FBTyxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsVUFBQyxDQUFDLEVBQUUsQ0FBQztRQUN0QyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssU0FBUyxFQUFFO1lBQzNCLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDYjtRQUNELE9BQU8sQ0FBQyxDQUFDO0lBQ1gsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBQ1QsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7aXNTdHJpbmd9IGZyb20gJ3ZlZ2EtdXRpbCc7XG5cbmltcG9ydCB7SW5saW5lRGF0YXNldH0gZnJvbSAnLi9kYXRhJztcbmltcG9ydCAqIGFzIGxvZyBmcm9tICcuL2xvZyc7XG5pbXBvcnQge0RpY3R9IGZyb20gJy4vdXRpbCc7XG5cbi8qKlxuICogQG1pbmltdW0gMFxuICovXG5leHBvcnQgdHlwZSBQYWRkaW5nID0gbnVtYmVyIHwge3RvcD86IG51bWJlciwgYm90dG9tPzogbnVtYmVyLCBsZWZ0PzogbnVtYmVyLCByaWdodD86IG51bWJlcn07XG5cbmV4cG9ydCB0eXBlIERhdGFzZXRzID0gRGljdDxJbmxpbmVEYXRhc2V0PjtcblxuZXhwb3J0IGludGVyZmFjZSBUb3BMZXZlbFByb3BlcnRpZXMge1xuICAvKipcbiAgICogQ1NTIGNvbG9yIHByb3BlcnR5IHRvIHVzZSBhcyB0aGUgYmFja2dyb3VuZCBvZiB2aXN1YWxpemF0aW9uLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gbm9uZSAodHJhbnNwYXJlbnQpXG4gICAqL1xuICBiYWNrZ3JvdW5kPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCB2aXN1YWxpemF0aW9uIHBhZGRpbmcsIGluIHBpeGVscywgZnJvbSB0aGUgZWRnZSBvZiB0aGUgdmlzdWFsaXphdGlvbiBjYW52YXMgdG8gdGhlIGRhdGEgcmVjdGFuZ2xlLiAgSWYgYSBudW1iZXIsIHNwZWNpZmllcyBwYWRkaW5nIGZvciBhbGwgc2lkZXMuXG4gICAqIElmIGFuIG9iamVjdCwgdGhlIHZhbHVlIHNob3VsZCBoYXZlIHRoZSBmb3JtYXQgYHtcImxlZnRcIjogNSwgXCJ0b3BcIjogNSwgXCJyaWdodFwiOiA1LCBcImJvdHRvbVwiOiA1fWAgdG8gc3BlY2lmeSBwYWRkaW5nIGZvciBlYWNoIHNpZGUgb2YgdGhlIHZpc3VhbGl6YXRpb24uXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZV9fOiBgNWBcbiAgICovXG4gIHBhZGRpbmc/OiBQYWRkaW5nO1xuXG4gIC8qKlxuICAgKiBTZXRzIGhvdyB0aGUgdmlzdWFsaXphdGlvbiBzaXplIHNob3VsZCBiZSBkZXRlcm1pbmVkLiBJZiBhIHN0cmluZywgc2hvdWxkIGJlIG9uZSBvZiBgXCJwYWRcImAsIGBcImZpdFwiYCBvciBgXCJub25lXCJgLlxuICAgKiBPYmplY3QgdmFsdWVzIGNhbiBhZGRpdGlvbmFsbHkgc3BlY2lmeSBwYXJhbWV0ZXJzIGZvciBjb250ZW50IHNpemluZyBhbmQgYXV0b21hdGljIHJlc2l6aW5nLlxuICAgKiBgXCJmaXRcImAgaXMgb25seSBzdXBwb3J0ZWQgZm9yIHNpbmdsZSBhbmQgbGF5ZXJlZCB2aWV3cyB0aGF0IGRvbid0IHVzZSBgcmFuZ2VTdGVwYC5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlX186IGBwYWRgXG4gICAqL1xuICBhdXRvc2l6ZT86IEF1dG9zaXplVHlwZSB8IEF1dG9TaXplUGFyYW1zO1xuXG4gIC8qKlxuICAgKiBBIGdsb2JhbCBkYXRhIHN0b3JlIGZvciBuYW1lZCBkYXRhc2V0cy4gVGhpcyBpcyBhIG1hcHBpbmcgZnJvbSBuYW1lcyB0byBpbmxpbmUgZGF0YXNldHMuXG4gICAqIFRoaXMgY2FuIGJlIGFuIGFycmF5IG9mIG9iamVjdHMgb3IgcHJpbWl0aXZlIHZhbHVlcyBvciBhIHN0cmluZy4gQXJyYXlzIG9mIHByaW1pdGl2ZSB2YWx1ZXMgYXJlIGluZ2VzdGVkIGFzIG9iamVjdHMgd2l0aCBhIGBkYXRhYCBwcm9wZXJ0eS5cbiAgICovXG4gIGRhdGFzZXRzPzogRGF0YXNldHM7XG59XG5cbmV4cG9ydCB0eXBlIEF1dG9zaXplVHlwZSA9ICdwYWQnIHwgJ2ZpdCcgfCAnbm9uZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXV0b1NpemVQYXJhbXMge1xuICAvKipcbiAgICogVGhlIHNpemluZyBmb3JtYXQgdHlwZS4gT25lIG9mIGBcInBhZFwiYCwgYFwiZml0XCJgIG9yIGBcIm5vbmVcImAuIFNlZSB0aGUgW2F1dG9zaXplIHR5cGVdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvc2l6ZS5odG1sI2F1dG9zaXplKSBkb2N1bWVudGF0aW9uIGZvciBkZXNjcmlwdGlvbnMgb2YgZWFjaC5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlX186IGBcInBhZFwiYFxuICAgKi9cbiAgdHlwZT86IEF1dG9zaXplVHlwZTtcblxuICAvKipcbiAgICogQSBib29sZWFuIGZsYWcgaW5kaWNhdGluZyBpZiBhdXRvc2l6ZSBsYXlvdXQgc2hvdWxkIGJlIHJlLWNhbGN1bGF0ZWQgb24gZXZlcnkgdmlldyB1cGRhdGUuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZV9fOiBgZmFsc2VgXG4gICAqL1xuICByZXNpemU/OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIGhvdyBzaXplIGNhbGN1bGF0aW9uIHNob3VsZCBiZSBwZXJmb3JtZWQsIG9uZSBvZiBgXCJjb250ZW50XCJgIG9yIGBcInBhZGRpbmdcImAuIFRoZSBkZWZhdWx0IHNldHRpbmcgKGBcImNvbnRlbnRcImApIGludGVycHJldHMgdGhlIHdpZHRoIGFuZCBoZWlnaHQgc2V0dGluZ3MgYXMgdGhlIGRhdGEgcmVjdGFuZ2xlIChwbG90dGluZykgZGltZW5zaW9ucywgdG8gd2hpY2ggcGFkZGluZyBpcyB0aGVuIGFkZGVkLiBJbiBjb250cmFzdCwgdGhlIGBcInBhZGRpbmdcImAgc2V0dGluZyBpbmNsdWRlcyB0aGUgcGFkZGluZyB3aXRoaW4gdGhlIHZpZXcgc2l6ZSBjYWxjdWxhdGlvbnMsIHN1Y2ggdGhhdCB0aGUgd2lkdGggYW5kIGhlaWdodCBzZXR0aW5ncyBpbmRpY2F0ZSB0aGUgKip0b3RhbCoqIGludGVuZGVkIHNpemUgb2YgdGhlIHZpZXcuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZV9fOiBgXCJjb250ZW50XCJgXG4gICAqL1xuICBjb250YWlucz86ICdjb250ZW50JyB8ICdwYWRkaW5nJztcbn1cblxuZnVuY3Rpb24gX25vcm1hbGl6ZUF1dG9TaXplKGF1dG9zaXplOiBBdXRvc2l6ZVR5cGUgfCBBdXRvU2l6ZVBhcmFtcykge1xuICByZXR1cm4gaXNTdHJpbmcoYXV0b3NpemUpID8ge3R5cGU6IGF1dG9zaXplfSA6IGF1dG9zaXplIHx8IHt9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbm9ybWFsaXplQXV0b1NpemUodG9wTGV2ZWxBdXRvc2l6ZTogQXV0b3NpemVUeXBlIHwgQXV0b1NpemVQYXJhbXMsIGNvbmZpZ0F1dG9zaXplOiBBdXRvc2l6ZVR5cGUgfCBBdXRvU2l6ZVBhcmFtcywgaXNVbml0T3JMYXllcjogYm9vbGVhbiA9IHRydWUpOiBBdXRvU2l6ZVBhcmFtcyB7XG4gIGNvbnN0IGF1dG9zaXplOiBBdXRvU2l6ZVBhcmFtcyA9IHtcbiAgICB0eXBlOiAncGFkJyxcbiAgICAuLi5fbm9ybWFsaXplQXV0b1NpemUoY29uZmlnQXV0b3NpemUpLFxuICAgIC4uLl9ub3JtYWxpemVBdXRvU2l6ZSh0b3BMZXZlbEF1dG9zaXplKVxuICB9O1xuXG4gIGlmIChhdXRvc2l6ZS50eXBlID09PSAnZml0Jykge1xuICAgIGlmICghaXNVbml0T3JMYXllcikge1xuICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuRklUX05PTl9TSU5HTEUpO1xuICAgICAgYXV0b3NpemUudHlwZSA9ICdwYWQnO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBhdXRvc2l6ZTtcbn1cblxuY29uc3QgVE9QX0xFVkVMX1BST1BFUlRJRVM6IChrZXlvZiBUb3BMZXZlbFByb3BlcnRpZXMpW10gPSBbXG4gICdiYWNrZ3JvdW5kJywgJ3BhZGRpbmcnLCAnZGF0YXNldHMnXG4gIC8vIFdlIGRvIG5vdCBpbmNsdWRlIFwiYXV0b3NpemVcIiBoZXJlIGFzIGl0IGlzIHN1cHBvcnRlZCBieSBvbmx5IHVuaXQgYW5kIGxheWVyIHNwZWNzIGFuZCB0aHVzIG5lZWQgdG8gYmUgbm9ybWFsaXplZFxuXTtcblxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RUb3BMZXZlbFByb3BlcnRpZXM8VCBleHRlbmRzIFRvcExldmVsUHJvcGVydGllcz4odDogVCkge1xuICByZXR1cm4gVE9QX0xFVkVMX1BST1BFUlRJRVMucmVkdWNlKChvLCBwKSA9PiB7XG4gICAgaWYgKHQgJiYgdFtwXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBvW3BdID0gdFtwXTtcbiAgICB9XG4gICAgcmV0dXJuIG87XG4gIH0sIHt9KTtcbn1cbiJdfQ==","export function isUrlData(data) {\n    return !!data['url'];\n}\nexport function isInlineData(data) {\n    return !!data['values'];\n}\nexport function isNamedData(data) {\n    return !!data['name'] && !isUrlData(data) && !isInlineData(data);\n}\nexport var MAIN = 'main';\nexport var RAW = 'raw';\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kYXRhLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQWdJQSxNQUFNLG9CQUFvQixJQUFxQztJQUM3RCxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDdkIsQ0FBQztBQUVELE1BQU0sdUJBQXVCLElBQXFDO0lBQ2hFLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUMxQixDQUFDO0FBRUQsTUFBTSxzQkFBc0IsSUFBbUI7SUFDN0MsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ25FLENBQUM7QUFJRCxNQUFNLENBQUMsSUFBTSxJQUFJLEdBQVcsTUFBTSxDQUFDO0FBQ25DLE1BQU0sQ0FBQyxJQUFNLEdBQUcsR0FBVSxLQUFLLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29uc3RhbnRzIGFuZCB1dGlsaXRpZXMgZm9yIGRhdGEuXG4gKi9cbmltcG9ydCB7VmdEYXRhfSBmcm9tICcuL3ZlZ2Euc2NoZW1hJztcblxuZXhwb3J0IGludGVyZmFjZSBQYXJzZSB7XG4gIFtmaWVsZDogc3RyaW5nXTogbnVsbCB8IHN0cmluZyB8ICdzdHJpbmcnIHwgJ2Jvb2xlYW4nIHwgJ2RhdGUnIHwgJ251bWJlcic7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGF0YUZvcm1hdEJhc2Uge1xuICAvKipcbiAgICogSWYgc2V0IHRvIGBcImF1dG9cImAgKHRoZSBkZWZhdWx0KSwgcGVyZm9ybSBhdXRvbWF0aWMgdHlwZSBpbmZlcmVuY2UgdG8gZGV0ZXJtaW5lIHRoZSBkZXNpcmVkIGRhdGEgdHlwZXMuXG4gICAqIElmIHNldCB0byBgbnVsbGAsIGRpc2FibGUgdHlwZSBpbmZlcmVuY2UgYmFzZWQgb24gdGhlIHNwZWMgYW5kIG9ubHkgdXNlIHR5cGUgaW5mZXJlbmNlIGJhc2VkIG9uIHRoZSBkYXRhLlxuICAgKiBBbHRlcm5hdGl2ZWx5LCBhIHBhcnNpbmcgZGlyZWN0aXZlIG9iamVjdCBjYW4gYmUgcHJvdmlkZWQgZm9yIGV4cGxpY2l0IGRhdGEgdHlwZXMuIEVhY2ggcHJvcGVydHkgb2YgdGhlIG9iamVjdCBjb3JyZXNwb25kcyB0byBhIGZpZWxkIG5hbWUsIGFuZCB0aGUgdmFsdWUgdG8gdGhlIGRlc2lyZWQgZGF0YSB0eXBlIChvbmUgb2YgYFwibnVtYmVyXCJgLCBgXCJib29sZWFuXCJgLCBgXCJkYXRlXCJgLCBvciBudWxsIChkbyBub3QgcGFyc2UgdGhlIGZpZWxkKSkuXG4gICAqIEZvciBleGFtcGxlLCBgXCJwYXJzZVwiOiB7XCJtb2RpZmllZF9vblwiOiBcImRhdGVcIn1gIHBhcnNlcyB0aGUgYG1vZGlmaWVkX29uYCBmaWVsZCBpbiBlYWNoIGlucHV0IHJlY29yZCBhIERhdGUgdmFsdWUuXG4gICAqXG4gICAqIEZvciBgXCJkYXRlXCJgLCB3ZSBwYXJzZSBkYXRhIGJhc2VkIHVzaW5nIEphdmFzY3JpcHQncyBbYERhdGUucGFyc2UoKWBdKGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0RhdGUvcGFyc2UpLlxuICAgKiBGb3IgU3BlY2lmaWMgZGF0ZSBmb3JtYXRzIGNhbiBiZSBwcm92aWRlZCAoZS5nLiwgYHtmb286ICdkYXRlOlwiJW0lZCVZXCInfWApLCB1c2luZyB0aGUgW2QzLXRpbWUtZm9ybWF0IHN5bnRheF0oaHR0cHM6Ly9naXRodWIuY29tL2QzL2QzLXRpbWUtZm9ybWF0I2xvY2FsZV9mb3JtYXQpLiBVVEMgZGF0ZSBmb3JtYXQgcGFyc2luZyBpcyBzdXBwb3J0ZWQgc2ltaWxhcmx5IChlLmcuLCBge2ZvbzogJ3V0YzpcIiVtJWQlWVwiJ31gKS4gU2VlIG1vcmUgYWJvdXQgW1VUQyB0aW1lXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3RpbWV1bml0Lmh0bWwjdXRjKVxuICAgKi9cbiAgcGFyc2U/OiAnYXV0bycgfCBQYXJzZSB8IG51bGw7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3N2RGF0YUZvcm1hdCBleHRlbmRzIERhdGFGb3JtYXRCYXNlIHtcbiAgLyoqXG4gICAqIFR5cGUgb2YgaW5wdXQgZGF0YTogYFwianNvblwiYCwgYFwiY3N2XCJgLCBgXCJ0c3ZcImAsIGBcImRzdlwiYC5cbiAgICogVGhlIGRlZmF1bHQgZm9ybWF0IHR5cGUgaXMgZGV0ZXJtaW5lZCBieSB0aGUgZXh0ZW5zaW9uIG9mIHRoZSBmaWxlIFVSTC5cbiAgICogSWYgbm8gZXh0ZW5zaW9uIGlzIGRldGVjdGVkLCBgXCJqc29uXCJgIHdpbGwgYmUgdXNlZCBieSBkZWZhdWx0LlxuICAgKi9cbiAgdHlwZT86ICdjc3YnIHwgJ3Rzdic7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRHN2RGF0YUZvcm1hdCBleHRlbmRzIERhdGFGb3JtYXRCYXNlIHtcbiAgLyoqXG4gICAqIFR5cGUgb2YgaW5wdXQgZGF0YTogYFwianNvblwiYCwgYFwiY3N2XCJgLCBgXCJ0c3ZcImAsIGBcImRzdlwiYC5cbiAgICogVGhlIGRlZmF1bHQgZm9ybWF0IHR5cGUgaXMgZGV0ZXJtaW5lZCBieSB0aGUgZXh0ZW5zaW9uIG9mIHRoZSBmaWxlIFVSTC5cbiAgICogSWYgbm8gZXh0ZW5zaW9uIGlzIGRldGVjdGVkLCBgXCJqc29uXCJgIHdpbGwgYmUgdXNlZCBieSBkZWZhdWx0LlxuICAgKi9cbiAgdHlwZT86ICdkc3YnO1xuXG4gIC8qKlxuICAgKiBUaGUgZGVsaW1pdGVyIGJldHdlZW4gcmVjb3Jkcy4gVGhlIGRlbGltaXRlciBtdXN0IGJlIGEgc2luZ2xlIGNoYXJhY3RlciAoaS5lLiwgYSBzaW5nbGUgMTYtYml0IGNvZGUgdW5pdCk7IHNvLCBBU0NJSSBkZWxpbWl0ZXJzIGFyZSBmaW5lLCBidXQgZW1vamkgZGVsaW1pdGVycyBhcmUgbm90LlxuICAgKlxuICAgKiBAbWluTGVuZ3RoIDFcbiAgICogQG1heExlbmd0aCAxXG4gICAqL1xuICBkZWxpbWl0ZXI6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBKc29uRGF0YUZvcm1hdCBleHRlbmRzIERhdGFGb3JtYXRCYXNlIHtcbiAgLyoqXG4gICAqIFR5cGUgb2YgaW5wdXQgZGF0YTogYFwianNvblwiYCwgYFwiY3N2XCJgLCBgXCJ0c3ZcImAsIGBcImRzdlwiYC5cbiAgICogVGhlIGRlZmF1bHQgZm9ybWF0IHR5cGUgaXMgZGV0ZXJtaW5lZCBieSB0aGUgZXh0ZW5zaW9uIG9mIHRoZSBmaWxlIFVSTC5cbiAgICogSWYgbm8gZXh0ZW5zaW9uIGlzIGRldGVjdGVkLCBgXCJqc29uXCJgIHdpbGwgYmUgdXNlZCBieSBkZWZhdWx0LlxuICAgKi9cbiAgdHlwZT86ICdqc29uJztcbiAgLyoqXG4gICAqIFRoZSBKU09OIHByb3BlcnR5IGNvbnRhaW5pbmcgdGhlIGRlc2lyZWQgZGF0YS5cbiAgICogVGhpcyBwYXJhbWV0ZXIgY2FuIGJlIHVzZWQgd2hlbiB0aGUgbG9hZGVkIEpTT04gZmlsZSBtYXkgaGF2ZSBzdXJyb3VuZGluZyBzdHJ1Y3R1cmUgb3IgbWV0YS1kYXRhLlxuICAgKiBGb3IgZXhhbXBsZSBgXCJwcm9wZXJ0eVwiOiBcInZhbHVlcy5mZWF0dXJlc1wiYCBpcyBlcXVpdmFsZW50IHRvIHJldHJpZXZpbmcgYGpzb24udmFsdWVzLmZlYXR1cmVzYFxuICAgKiBmcm9tIHRoZSBsb2FkZWQgSlNPTiBvYmplY3QuXG4gICAqL1xuICBwcm9wZXJ0eT86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUb3BvRGF0YUZvcm1hdCBleHRlbmRzIERhdGFGb3JtYXRCYXNlIHtcbiAgLyoqXG4gICAqIFR5cGUgb2YgaW5wdXQgZGF0YTogYFwianNvblwiYCwgYFwiY3N2XCJgLCBgXCJ0c3ZcImAsIGBcImRzdlwiYC5cbiAgICogVGhlIGRlZmF1bHQgZm9ybWF0IHR5cGUgaXMgZGV0ZXJtaW5lZCBieSB0aGUgZXh0ZW5zaW9uIG9mIHRoZSBmaWxlIFVSTC5cbiAgICogSWYgbm8gZXh0ZW5zaW9uIGlzIGRldGVjdGVkLCBgXCJqc29uXCJgIHdpbGwgYmUgdXNlZCBieSBkZWZhdWx0LlxuICAgKi9cbiAgdHlwZT86ICd0b3BvanNvbic7XG4gIC8qKlxuICAgKiBUaGUgbmFtZSBvZiB0aGUgVG9wb0pTT04gb2JqZWN0IHNldCB0byBjb252ZXJ0IHRvIGEgR2VvSlNPTiBmZWF0dXJlIGNvbGxlY3Rpb24uXG4gICAqIEZvciBleGFtcGxlLCBpbiBhIG1hcCBvZiB0aGUgd29ybGQsIHRoZXJlIG1heSBiZSBhbiBvYmplY3Qgc2V0IG5hbWVkIGBcImNvdW50cmllc1wiYC5cbiAgICogVXNpbmcgdGhlIGZlYXR1cmUgcHJvcGVydHksIHdlIGNhbiBleHRyYWN0IHRoaXMgc2V0IGFuZCBnZW5lcmF0ZSBhIEdlb0pTT04gZmVhdHVyZSBvYmplY3QgZm9yIGVhY2ggY291bnRyeS5cbiAgICovXG4gIGZlYXR1cmU/OiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgbmFtZSBvZiB0aGUgVG9wb0pTT04gb2JqZWN0IHNldCB0byBjb252ZXJ0IHRvIG1lc2guXG4gICAqIFNpbWlsYXIgdG8gdGhlIGBmZWF0dXJlYCBvcHRpb24sIGBtZXNoYCBleHRyYWN0cyBhIG5hbWVkIFRvcG9KU09OIG9iamVjdCBzZXQuXG4gICAqICBVbmxpa2UgdGhlIGBmZWF0dXJlYCBvcHRpb24sIHRoZSBjb3JyZXNwb25kaW5nIGdlbyBkYXRhIGlzIHJldHVybmVkIGFzIGEgc2luZ2xlLCB1bmlmaWVkIG1lc2ggaW5zdGFuY2UsIG5vdCBhcyBpbmRpdmlkdWFsIEdlb0pTT04gZmVhdHVyZXMuXG4gICAqIEV4dHJhY3RpbmcgYSBtZXNoIGlzIHVzZWZ1bCBmb3IgbW9yZSBlZmZpY2llbnRseSBkcmF3aW5nIGJvcmRlcnMgb3Igb3RoZXIgZ2VvZ3JhcGhpYyBlbGVtZW50cyB0aGF0IHlvdSBkbyBub3QgbmVlZCB0byBhc3NvY2lhdGUgd2l0aCBzcGVjaWZpYyByZWdpb25zIHN1Y2ggYXMgaW5kaXZpZHVhbCBjb3VudHJpZXMsIHN0YXRlcyBvciBjb3VudGllcy5cbiAgICovXG4gIG1lc2g/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCB0eXBlIERhdGFGb3JtYXQgPSBDc3ZEYXRhRm9ybWF0IHwgRHN2RGF0YUZvcm1hdCB8IEpzb25EYXRhRm9ybWF0IHwgVG9wb0RhdGFGb3JtYXQ7XG5cbmV4cG9ydCB0eXBlIERhdGFGb3JtYXRUeXBlID0gJ2pzb24nIHwgJ2NzdicgfCAndHN2JyB8ICdkc3YnIHwgJ3RvcG9qc29uJztcblxuZXhwb3J0IHR5cGUgRGF0YSA9IFVybERhdGEgfCBJbmxpbmVEYXRhIHwgTmFtZWREYXRhO1xuXG5leHBvcnQgdHlwZSBJbmxpbmVEYXRhc2V0ID0gbnVtYmVyW10gfCBzdHJpbmdbXSB8IGJvb2xlYW5bXSB8IG9iamVjdFtdIHwgc3RyaW5nIHwgb2JqZWN0O1xuXG5leHBvcnQgaW50ZXJmYWNlIERhdGFCYXNlIHtcbiAgLyoqXG4gICAqIEFuIG9iamVjdCB0aGF0IHNwZWNpZmllcyB0aGUgZm9ybWF0IGZvciBwYXJzaW5nIHRoZSBkYXRhLlxuICAgKi9cbiAgZm9ybWF0PzogRGF0YUZvcm1hdDtcbiAgLyoqXG4gICAqIFByb3ZpZGUgYSBwbGFjZWhvbGRlciBuYW1lIGFuZCBiaW5kIGRhdGEgYXQgcnVudGltZS5cbiAgICovXG4gIG5hbWU/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXJsRGF0YSBleHRlbmRzIERhdGFCYXNlIHtcbiAgLyoqXG4gICAqIEFuIFVSTCBmcm9tIHdoaWNoIHRvIGxvYWQgdGhlIGRhdGEgc2V0LiBVc2UgdGhlIGBmb3JtYXQudHlwZWAgcHJvcGVydHlcbiAgICogdG8gZW5zdXJlIHRoZSBsb2FkZWQgZGF0YSBpcyBjb3JyZWN0bHkgcGFyc2VkLlxuICAgKi9cbiAgdXJsOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5saW5lRGF0YSBleHRlbmRzIERhdGFCYXNlIHtcbiAgLyoqXG4gICAqIFRoZSBmdWxsIGRhdGEgc2V0LCBpbmNsdWRlZCBpbmxpbmUuIFRoaXMgY2FuIGJlIGFuIGFycmF5IG9mIG9iamVjdHMgb3IgcHJpbWl0aXZlIHZhbHVlcywgYW4gb2JqZWN0LCBvciBhIHN0cmluZy5cbiAgICogQXJyYXlzIG9mIHByaW1pdGl2ZSB2YWx1ZXMgYXJlIGluZ2VzdGVkIGFzIG9iamVjdHMgd2l0aCBhIGBkYXRhYCBwcm9wZXJ0eS4gU3RyaW5ncyBhcmUgcGFyc2VkIGFjY29yZGluZyB0byB0aGUgc3BlY2lmaWVkIGZvcm1hdCB0eXBlLlxuICAgKi9cbiAgdmFsdWVzOiBJbmxpbmVEYXRhc2V0O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE5hbWVkRGF0YSBleHRlbmRzIERhdGFCYXNlIHtcbiAgLyoqXG4gICAqIFByb3ZpZGUgYSBwbGFjZWhvbGRlciBuYW1lIGFuZCBiaW5kIGRhdGEgYXQgcnVudGltZS5cbiAgICovXG4gIG5hbWU6IHN0cmluZztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVXJsRGF0YShkYXRhOiBQYXJ0aWFsPERhdGE+IHwgUGFydGlhbDxWZ0RhdGE+KTogZGF0YSBpcyBVcmxEYXRhIHtcbiAgcmV0dXJuICEhZGF0YVsndXJsJ107XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0lubGluZURhdGEoZGF0YTogUGFydGlhbDxEYXRhPiB8IFBhcnRpYWw8VmdEYXRhPik6IGRhdGEgaXMgSW5saW5lRGF0YSB7XG4gIHJldHVybiAhIWRhdGFbJ3ZhbHVlcyddO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNOYW1lZERhdGEoZGF0YTogUGFydGlhbDxEYXRhPik6IGRhdGEgaXMgTmFtZWREYXRhIHtcbiAgcmV0dXJuICEhZGF0YVsnbmFtZSddICYmICFpc1VybERhdGEoZGF0YSkgJiYgIWlzSW5saW5lRGF0YShkYXRhKTtcbn1cblxuZXhwb3J0IHR5cGUgRGF0YVNvdXJjZVR5cGUgPSAncmF3JyB8ICdtYWluJyB8ICdyb3cnIHwgJ2NvbHVtbicgfCAnbG9va3VwJztcblxuZXhwb3J0IGNvbnN0IE1BSU46ICdtYWluJyA9ICdtYWluJztcbmV4cG9ydCBjb25zdCBSQVc6ICdyYXcnID0gJ3Jhdyc7XG4iXX0=","/**\n * Parse an event selector string.\n * Returns an array of event stream definitions.\n */\nexport default function(selector, source, marks) {\n  DEFAULT_SOURCE = source || VIEW;\n  MARKS = marks || DEFAULT_MARKS;\n  return parseMerge(selector.trim()).map(parseSelector);\n}\n\nvar VIEW    = 'view',\n    LBRACK  = '[',\n    RBRACK  = ']',\n    LBRACE  = '{',\n    RBRACE  = '}',\n    COLON   = ':',\n    COMMA   = ',',\n    NAME    = '@',\n    GT      = '>',\n    ILLEGAL = /[[\\]{}]/,\n    DEFAULT_SOURCE,\n    MARKS,\n    DEFAULT_MARKS = {\n      '*': 1,\n      arc: 1,\n      area: 1,\n      group: 1,\n      image: 1,\n      line: 1,\n      path: 1,\n      rect: 1,\n      rule: 1,\n      shape: 1,\n      symbol: 1,\n      text: 1,\n      trail: 1\n    };\n\nfunction isMarkType(type) {\n  return MARKS.hasOwnProperty(type);\n}\n\nfunction find(s, i, endChar, pushChar, popChar) {\n  var count = 0,\n      n = s.length,\n      c;\n  for (; i<n; ++i) {\n    c = s[i];\n    if (!count && c === endChar) return i;\n    else if (popChar && popChar.indexOf(c) >= 0) --count;\n    else if (pushChar && pushChar.indexOf(c) >= 0) ++count;\n  }\n  return i;\n}\n\nfunction parseMerge(s) {\n  var output = [],\n      start = 0,\n      n = s.length,\n      i = 0;\n\n  while (i < n) {\n    i = find(s, i, COMMA, LBRACK + LBRACE, RBRACK + RBRACE);\n    output.push(s.substring(start, i).trim());\n    start = ++i;\n  }\n\n  if (output.length === 0) {\n    throw 'Empty event selector: ' + s;\n  }\n  return output;\n}\n\nfunction parseSelector(s) {\n  return s[0] === '['\n    ? parseBetween(s)\n    : parseStream(s);\n}\n\nfunction parseBetween(s) {\n  var n = s.length,\n      i = 1,\n      b, stream;\n\n  i = find(s, i, RBRACK, LBRACK, RBRACK);\n  if (i === n) {\n    throw 'Empty between selector: ' + s;\n  }\n\n  b = parseMerge(s.substring(1, i));\n  if (b.length !== 2) {\n    throw 'Between selector must have two elements: ' + s;\n  }\n\n  s = s.slice(i + 1).trim();\n  if (s[0] !== GT) {\n    throw 'Expected \\'>\\' after between selector: ' + s;\n  }\n\n  b = b.map(parseSelector);\n\n  stream = parseSelector(s.slice(1).trim());\n  if (stream.between) {\n    return {\n      between: b,\n      stream: stream\n    };\n  } else {\n    stream.between = b;\n  }\n\n  return stream;\n}\n\nfunction parseStream(s) {\n  var stream = {source: DEFAULT_SOURCE},\n      source = [],\n      throttle = [0, 0],\n      markname = 0,\n      start = 0,\n      n = s.length,\n      i = 0, j,\n      filter;\n\n  // extract throttle from end\n  if (s[n-1] === RBRACE) {\n    i = s.lastIndexOf(LBRACE);\n    if (i >= 0) {\n      try {\n        throttle = parseThrottle(s.substring(i+1, n-1));\n      } catch (e) {\n        throw 'Invalid throttle specification: ' + s;\n      }\n      s = s.slice(0, i).trim();\n      n = s.length;\n    } else throw 'Unmatched right brace: ' + s;\n    i = 0;\n  }\n\n  if (!n) throw s;\n\n  // set name flag based on first char\n  if (s[0] === NAME) markname = ++i;\n\n  // extract first part of multi-part stream selector\n  j = find(s, i, COLON);\n  if (j < n) {\n    source.push(s.substring(start, j).trim());\n    start = i = ++j;\n  }\n\n  // extract remaining part of stream selector\n  i = find(s, i, LBRACK);\n  if (i === n) {\n    source.push(s.substring(start, n).trim());\n  } else {\n    source.push(s.substring(start, i).trim());\n    filter = [];\n    start = ++i;\n    if (start === n) throw 'Unmatched left bracket: ' + s;\n  }\n\n  // extract filters\n  while (i < n) {\n    i = find(s, i, RBRACK);\n    if (i === n) throw 'Unmatched left bracket: ' + s;\n    filter.push(s.substring(start, i).trim());\n    if (i < n-1 && s[++i] !== LBRACK) throw 'Expected left bracket: ' + s;\n    start = ++i;\n  }\n\n  // marshall event stream specification\n  if (!(n = source.length) || ILLEGAL.test(source[n-1])) {\n    throw 'Invalid event selector: ' + s;\n  }\n\n  if (n > 1) {\n    stream.type = source[1];\n    if (markname) {\n      stream.markname = source[0].slice(1);\n    } else if (isMarkType(source[0])) {\n      stream.marktype = source[0];\n    } else {\n      stream.source = source[0];\n    }\n  } else {\n    stream.type = source[0];\n  }\n  if (stream.type.slice(-1) === '!') {\n    stream.consume = true;\n    stream.type = stream.type.slice(0, -1)\n  }\n  if (filter != null) stream.filter = filter;\n  if (throttle[0]) stream.throttle = throttle[0];\n  if (throttle[1]) stream.debounce = throttle[1];\n\n  return stream;\n}\n\nfunction parseThrottle(s) {\n  var a = s.split(COMMA);\n  if (!s.length || a.length > 2) throw s;\n  return a.map(function(_) {\n    var x = +_;\n    if (x !== x) throw s;\n    return x;\n  });\n}\n","import { isArray } from 'vega-util';\nimport { flagKeys } from './util';\nexport function isVgSignalRef(o) {\n    return !!o['signal'];\n}\nexport function isVgRangeStep(range) {\n    return !!range['step'];\n}\nexport function isDataRefUnionedDomain(domain) {\n    if (!isArray(domain)) {\n        return 'fields' in domain && !('data' in domain);\n    }\n    return false;\n}\nexport function isFieldRefUnionDomain(domain) {\n    if (!isArray(domain)) {\n        return 'fields' in domain && 'data' in domain;\n    }\n    return false;\n}\nexport function isDataRefDomain(domain) {\n    if (!isArray(domain)) {\n        return 'field' in domain && 'data' in domain;\n    }\n    return false;\n}\nexport function isSignalRefDomain(domain) {\n    if (!isArray(domain)) {\n        return 'signal' in domain;\n    }\n    return false;\n}\nvar VG_MARK_CONFIG_INDEX = {\n    opacity: 1,\n    fill: 1,\n    fillOpacity: 1,\n    stroke: 1,\n    strokeCap: 1,\n    strokeWidth: 1,\n    strokeOpacity: 1,\n    strokeDash: 1,\n    strokeDashOffset: 1,\n    size: 1,\n    shape: 1,\n    interpolate: 1,\n    tension: 1,\n    orient: 1,\n    align: 1,\n    baseline: 1,\n    text: 1,\n    limit: 1,\n    dx: 1,\n    dy: 1,\n    radius: 1,\n    theta: 1,\n    angle: 1,\n    font: 1,\n    fontSize: 1,\n    fontWeight: 1,\n    fontStyle: 1,\n    cursor: 1,\n    href: 1,\n};\nexport var VG_MARK_CONFIGS = flagKeys(VG_MARK_CONFIG_INDEX);\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVnYS5zY2hlbWEuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdmVnYS5zY2hlbWEudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLFdBQVcsQ0FBQztBQU1sQyxPQUFPLEVBQU8sUUFBUSxFQUFDLE1BQU0sUUFBUSxDQUFDO0FBZ0R0QyxNQUFNLHdCQUF3QixDQUFNO0lBQ2xDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUN2QixDQUFDO0FBbUNELE1BQU0sd0JBQXdCLEtBQWM7SUFDMUMsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3pCLENBQUM7QUErSEQsTUFBTSxpQ0FBaUMsTUFBZ0I7SUFDckQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFBRTtRQUNwQixPQUFPLFFBQVEsSUFBSSxNQUFNLElBQUksQ0FBQyxDQUFDLE1BQU0sSUFBSSxNQUFNLENBQUMsQ0FBQztLQUNsRDtJQUNELE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQUVELE1BQU0sZ0NBQWdDLE1BQWdCO0lBQ3BELElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQUU7UUFDcEIsT0FBTyxRQUFRLElBQUksTUFBTSxJQUFJLE1BQU0sSUFBSSxNQUFNLENBQUM7S0FDL0M7SUFDRCxPQUFPLEtBQUssQ0FBQztBQUNmLENBQUM7QUFFRCxNQUFNLDBCQUEwQixNQUFnQjtJQUM5QyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxFQUFFO1FBQ25CLE9BQU8sT0FBTyxJQUFJLE1BQU0sSUFBSSxNQUFNLElBQUksTUFBTSxDQUFDO0tBQy9DO0lBQ0QsT0FBTyxLQUFLLENBQUM7QUFDZixDQUFDO0FBRUQsTUFBTSw0QkFBNEIsTUFBZ0I7SUFDaEQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFBRTtRQUNwQixPQUFPLFFBQVEsSUFBSSxNQUFNLENBQUM7S0FDM0I7SUFDRCxPQUFPLEtBQUssQ0FBQztBQUNmLENBQUM7QUFzNkJELElBQU0sb0JBQW9CLEdBQTZCO0lBQ3JELE9BQU8sRUFBRSxDQUFDO0lBQ1YsSUFBSSxFQUFFLENBQUM7SUFDUCxXQUFXLEVBQUUsQ0FBQztJQUNkLE1BQU0sRUFBRSxDQUFDO0lBQ1QsU0FBUyxFQUFFLENBQUM7SUFDWixXQUFXLEVBQUUsQ0FBQztJQUNkLGFBQWEsRUFBRSxDQUFDO0lBQ2hCLFVBQVUsRUFBRSxDQUFDO0lBQ2IsZ0JBQWdCLEVBQUUsQ0FBQztJQUNuQixJQUFJLEVBQUUsQ0FBQztJQUNQLEtBQUssRUFBRSxDQUFDO0lBQ1IsV0FBVyxFQUFFLENBQUM7SUFDZCxPQUFPLEVBQUUsQ0FBQztJQUNWLE1BQU0sRUFBRSxDQUFDO0lBQ1QsS0FBSyxFQUFFLENBQUM7SUFDUixRQUFRLEVBQUUsQ0FBQztJQUNYLElBQUksRUFBRSxDQUFDO0lBQ1AsS0FBSyxFQUFFLENBQUM7SUFDUixFQUFFLEVBQUUsQ0FBQztJQUNMLEVBQUUsRUFBRSxDQUFDO0lBQ0wsTUFBTSxFQUFFLENBQUM7SUFDVCxLQUFLLEVBQUUsQ0FBQztJQUNSLEtBQUssRUFBRSxDQUFDO0lBQ1IsSUFBSSxFQUFFLENBQUM7SUFDUCxRQUFRLEVBQUUsQ0FBQztJQUNYLFVBQVUsRUFBRSxDQUFDO0lBQ2IsU0FBUyxFQUFFLENBQUM7SUFDWixNQUFNLEVBQUUsQ0FBQztJQUNULElBQUksRUFBRSxDQUFDO0NBWVIsQ0FBQztBQUVGLE1BQU0sQ0FBQyxJQUFNLGVBQWUsR0FBRyxRQUFRLENBQUMsb0JBQW9CLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7QWdncmVnYXRlT3B9IGZyb20gJ3ZlZ2EnO1xuaW1wb3J0IHtpc0FycmF5fSBmcm9tICd2ZWdhLXV0aWwnO1xuaW1wb3J0IHtCYXNlQmlufSBmcm9tICcuL2Jpbic7XG5pbXBvcnQge05pY2VUaW1lLCBTY2FsZVR5cGV9IGZyb20gJy4vc2NhbGUnO1xuaW1wb3J0IHtTb3J0T3JkZXJ9IGZyb20gJy4vc29ydCc7XG5pbXBvcnQge1N0YWNrT2Zmc2V0fSBmcm9tICcuL3N0YWNrJztcbmltcG9ydCB7V2luZG93T25seU9wfSBmcm9tICcuL3RyYW5zZm9ybSc7XG5pbXBvcnQge0ZsYWcsIGZsYWdLZXlzfSBmcm9tICcuL3V0aWwnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFZnRGF0YSB7XG4gIG5hbWU6IHN0cmluZztcbiAgc291cmNlPzogc3RyaW5nO1xuICB2YWx1ZXM/OiBhbnk7XG4gIGZvcm1hdD86IHtcbiAgICB0eXBlPzogc3RyaW5nO1xuICAgIHBhcnNlPzogc3RyaW5nIHwgb2JqZWN0O1xuICAgIHByb3BlcnR5Pzogc3RyaW5nO1xuICAgIGZlYXR1cmU/OiBzdHJpbmc7XG4gICAgbWVzaD86IHN0cmluZztcbiAgfTtcbiAgdXJsPzogc3RyaW5nO1xuICB0cmFuc2Zvcm0/OiBWZ1RyYW5zZm9ybVtdO1xufVxuXG5cbmV4cG9ydCBpbnRlcmZhY2UgVmdQYXJlbnRSZWYge1xuICBwYXJlbnQ6IHN0cmluZztcbn1cblxuZXhwb3J0IHR5cGUgVmdGaWVsZFJlZiA9IHN0cmluZyB8IFZnUGFyZW50UmVmIHwgVmdQYXJlbnRSZWZbXTtcblxuZXhwb3J0IHR5cGUgVmdTb3J0RmllbGQgPSB0cnVlIHwge1xuICBmaWVsZD86IFZnRmllbGRSZWYsXG4gIG9wOiBBZ2dyZWdhdGVPcCxcbiAgb3JkZXI/OiBTb3J0T3JkZXJcbn07XG5cbi8qKlxuICogVW5pb25lZCBkb21haW5zIGNhbiBvbmx5IGJlIHNvcnRlZCBieSBjb3VudCBhZ2dyZWdhdGUuXG4gKi9cbmV4cG9ydCB0eXBlIFZnVW5pb25Tb3J0RmllbGQgPSB0cnVlIHwge1xuICBvcDogJ2NvdW50J1xuICBvcmRlcj86IFNvcnRPcmRlclxufTtcblxuZXhwb3J0IGludGVyZmFjZSBWZ0RhdGFSZWYge1xuICBkYXRhOiBzdHJpbmc7XG4gIGZpZWxkOiBWZ0ZpZWxkUmVmO1xuICBzb3J0PzogVmdTb3J0RmllbGQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmdTaWduYWxSZWYge1xuICBzaWduYWw6IHN0cmluZztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVmdTaWduYWxSZWYobzogYW55KTogbyBpcyBWZ1NpZ25hbFJlZiB7XG4gIHJldHVybiAhIW9bJ3NpZ25hbCddO1xufVxuXG5leHBvcnQgdHlwZSBWZ0V2ZW50U3RyZWFtID0gYW55O1xuXG4vLyBUT0RPOiBhZGQgdHlwZSBvZiB2YWx1ZSAoTWFrZSBpdCBWZ1ZhbHVlUmVmPFQ+IHt2YWx1ZT86VCAuLi59KVxuZXhwb3J0IGludGVyZmFjZSBWZ1ZhbHVlUmVmIHtcbiAgdmFsdWU/OiBudW1iZXIgfCBzdHJpbmcgfCBib29sZWFuO1xuICBmaWVsZD86IHN0cmluZyB8IHtcbiAgICBkYXR1bT86IHN0cmluZyxcbiAgICBncm91cD86IHN0cmluZyxcbiAgICBwYXJlbnQ/OiBzdHJpbmdcbiAgfTtcbiAgc2lnbmFsPzogc3RyaW5nO1xuICBzY2FsZT86IHN0cmluZzsgLy8gVE9ETzogb2JqZWN0XG4gIG11bHQ/OiBudW1iZXI7XG4gIG9mZnNldD86IG51bWJlciB8IFZnVmFsdWVSZWY7XG4gIGJhbmQ/OiBib29sZWFuIHwgbnVtYmVyIHwgVmdWYWx1ZVJlZjtcbn1cblxuLy8gVE9ETzogYWRkIHZnIHByZWZpeFxuZXhwb3J0IGludGVyZmFjZSBEYXRhUmVmVW5pb25Eb21haW4ge1xuICBmaWVsZHM6IChhbnlbXSB8IFZnRGF0YVJlZiB8IFZnU2lnbmFsUmVmKVtdO1xuICBzb3J0PzogVmdVbmlvblNvcnRGaWVsZDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWZ0ZpZWxkUmVmVW5pb25Eb21haW4ge1xuICBkYXRhOiBzdHJpbmc7XG4gIGZpZWxkczogVmdGaWVsZFJlZltdO1xuICBzb3J0PzogVmdVbmlvblNvcnRGaWVsZDtcbn1cblxuZXhwb3J0IHR5cGUgVmdTY2hlbWUgPSB7c2NoZW1lOiBzdHJpbmcsIGV4dGVudD86IG51bWJlcltdLCBjb3VudD86IG51bWJlcn07XG5leHBvcnQgdHlwZSBWZ1JhbmdlID0gc3RyaW5nIHwgVmdEYXRhUmVmIHwgKG51bWJlcnxzdHJpbmd8VmdEYXRhUmVmfFZnU2lnbmFsUmVmKVtdIHwgVmdTY2hlbWUgfCBWZ1JhbmdlU3RlcDtcblxuZXhwb3J0IHR5cGUgVmdSYW5nZVN0ZXAgPSB7c3RlcDogbnVtYmVyIHwgVmdTaWduYWxSZWZ9O1xuZXhwb3J0IGZ1bmN0aW9uIGlzVmdSYW5nZVN0ZXAocmFuZ2U6IFZnUmFuZ2UpOiByYW5nZSBpcyBWZ1JhbmdlU3RlcCB7XG4gIHJldHVybiAhIXJhbmdlWydzdGVwJ107XG59XG5cbi8vIERvbWFpbnMgdGhhdCBhcmUgbm90IGEgdW5pb24gb2YgZG9tYWluc1xuZXhwb3J0IHR5cGUgVmdOb25VbmlvbkRvbWFpbiA9IGFueVtdIHwgVmdEYXRhUmVmIHwgVmdTaWduYWxSZWY7XG5leHBvcnQgdHlwZSBWZ0RvbWFpbiA9IFZnTm9uVW5pb25Eb21haW4gfCBEYXRhUmVmVW5pb25Eb21haW4gfCBWZ0ZpZWxkUmVmVW5pb25Eb21haW47XG5cbmV4cG9ydCB0eXBlIFZnTWFya0dyb3VwID0gYW55O1xuXG5leHBvcnQgdHlwZSBWZ1Byb2plY3Rpb25UeXBlID0gJ2FsYmVycycgfCAnYWxiZXJzVXNhJyB8ICdhemltdXRoYWxFcXVhbEFyZWEnIHwgJ2F6aW11dGhhbEVxdWlkaXN0YW50JyB8ICdjb25pY0NvbmZvcm1hbCcgfCAnY29uaWNFcXVhbEFyZWEnIHwgJ2NvbmljRXF1aWRpc3RhbnQnIHwgJ2VxdWlyZWN0YW5ndWxhcicgfCAnZ25vbW9uaWMnIHwgJ21lcmNhdG9yJyB8ICdvcnRob2dyYXBoaWMnIHwgJ3N0ZXJlb2dyYXBoaWMnIHwgJ3RyYW5zdmVyc2VNZXJjYXRvcic7XG5cblxuZXhwb3J0IHR5cGUgVmdQcm9qZWN0aW9uID0ge1xuICAvKlxuICAgKiBUaGUgbmFtZSBvZiB0aGUgcHJvamVjdGlvbi5cbiAgICovXG4gIG5hbWU6IHN0cmluZztcbiAgLypcbiAgICogVGhlIHR5cGUgb2YgdGhlIHByb2plY3Rpb24uXG4gICAqL1xuICB0eXBlPzogVmdQcm9qZWN0aW9uVHlwZTtcbiAgLypcbiAgICogVGhlIGNsaXAgYW5nbGUgb2YgdGhlIHByb2plY3Rpb24uXG4gICAqL1xuICBjbGlwQW5nbGU/OiBudW1iZXI7XG4gIC8qXG4gICAqIFNldHMgdGhlIHByb2plY3Rpb27igJlzIHZpZXdwb3J0IGNsaXAgZXh0ZW50IHRvIHRoZSBzcGVjaWZpZWQgYm91bmRzIGluIHBpeGVsc1xuICAgKi9cbiAgY2xpcEV4dGVudD86IG51bWJlcltdW107XG4gIC8qXG4gICAqIFNldHMgdGhlIHByb2plY3Rpb27igJlzIHNjYWxlIGZhY3RvciB0byB0aGUgc3BlY2lmaWVkIHZhbHVlXG4gICAqL1xuICBzY2FsZT86IG51bWJlcjtcbiAgLypcbiAgICogVGhlIHRyYW5zbGF0aW9uIG9mIHRoZSBwcm9qZWN0aW9uLlxuICAgKi9cbiAgdHJhbnNsYXRlPzogbnVtYmVyW107XG4gIC8qXG4gICAqIFRoZSBjZW50ZXIgb2YgdGhlIHByb2plY3Rpb24uXG4gICAqL1xuICBjZW50ZXI/OiBudW1iZXJbXTtcbiAgLyoqXG4gICAqIFRoZSByb3RhdGlvbiBvZiB0aGUgcHJvamVjdGlvbi5cbiAgICovXG4gIHJvdGF0ZT86IG51bWJlcltdO1xuICAvKlxuICAgKiBUaGUgZGVzaXJlZCBwcmVjaXNpb24gb2YgdGhlIHByb2plY3Rpb24uXG4gICAqL1xuICBwcmVjaXNpb24/OiBTdHJpbmc7XG4gIC8qXG4gICAqIEdlb0pTT04gZGF0YSB0byB3aGljaCB0aGUgcHJvamVjdGlvbiBzaG91bGQgYXR0ZW1wdCB0byBhdXRvbWF0aWNhbGx5IGZpdCB0aGUgdHJhbnNsYXRlIGFuZCBzY2FsZSBwYXJhbWV0ZXJzLi5cbiAgICovXG4gIGZpdD86IFZnU2lnbmFsUmVmIHwgT2JqZWN0IHwgYW55W107XG4gIC8qXG4gICAqIFVzZWQgaW4gY29uanVuY3Rpb24gd2l0aCBmaXQsIHByb3ZpZGVzIHRoZSBwaXhlbCBhcmVhIHRvIHdoaWNoIHRoZSBwcm9qZWN0aW9uIHNob3VsZCBiZSBhdXRvbWF0aWNhbGx5IGZpdC5cbiAgICovXG4gIGV4dGVudD86IFZnU2lnbmFsUmVmIHwgbnVtYmVyW11bXTtcbiAgLypcbiAgICogVXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIGZpdCwgcHJvdmlkZXMgdGhlIHdpZHRoIGFuZCBoZWlnaHQgaW4gcGl4ZWxzIG9mIHRoZSBhcmVhIHRvIHdoaWNoIHRoZSBwcm9qZWN0aW9uIHNob3VsZCBiZSBhdXRvbWF0aWNhbGx5IGZpdC5cbiAgICovXG4gIHNpemU/OiBWZ1NpZ25hbFJlZiB8IChudW1iZXIgfCBWZ1NpZ25hbFJlZilbXTtcblxuICAvKiBUaGUgZm9sbG93aW5nIHByb3BlcnRpZXMgYXJlIGFsbCBzdXBwb3J0ZWQgZm9yIHNwZWNpZmljIHR5cGVzIG9mIHByb2plY3Rpb25zLiBDb25zdWx0IHRoZSBkMy1nZW8tcHJvamVjdGlvbiBsaWJyYXJ5IGZvciBtb3JlIGluZm9ybWF0aW9uOiBodHRwczovL2dpdGh1Yi5jb20vZDMvZDMtZ2VvLXByb2plY3Rpb24gKi9cbiAgY29lZmZpY2llbnQ/OiBudW1iZXI7XG4gIGRpc3RhbmNlPzogbnVtYmVyO1xuICBmcmFjdGlvbj86IG51bWJlcjtcbiAgbG9iZXM/OiBudW1iZXI7XG4gIHBhcmFsbGVsPzogbnVtYmVyO1xuICByYWRpdXM/OiBudW1iZXI7XG4gIHJhdGlvPzogbnVtYmVyO1xuICBzcGFjaW5nPzogbnVtYmVyO1xuICB0aWx0PzogbnVtYmVyO1xufTtcblxuZXhwb3J0IGludGVyZmFjZSBWZ1NjYWxlIHtcbiAgbmFtZTogc3RyaW5nO1xuICB0eXBlOiBTY2FsZVR5cGU7XG4gIGRvbWFpbjogVmdEb21haW47XG4gIGRvbWFpblJhdz86IFZnU2lnbmFsUmVmO1xuICByYW5nZTogVmdSYW5nZTtcblxuICBjbGFtcD86IGJvb2xlYW47XG4gIGJhc2U/OiBudW1iZXI7XG4gIGV4cG9uZW50PzogbnVtYmVyO1xuICBpbnRlcnBvbGF0ZT86IFNjYWxlSW50ZXJwb2xhdGUgfCBTY2FsZUludGVycG9sYXRlUGFyYW1zO1xuICBuaWNlPzogYm9vbGVhbiB8IG51bWJlciB8IE5pY2VUaW1lIHwge2ludGVydmFsOiBzdHJpbmcsIHN0ZXA6IG51bWJlcn07XG4gIHBhZGRpbmc/OiBudW1iZXI7XG4gIHBhZGRpbmdJbm5lcj86IG51bWJlcjtcbiAgcGFkZGluZ091dGVyPzogbnVtYmVyO1xuICByZXZlcnNlPzogYm9vbGVhbjtcbiAgcm91bmQ/OiBib29sZWFuO1xuICB6ZXJvPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IHR5cGUgU2NhbGVJbnRlcnBvbGF0ZSA9ICdyZ2InfCAnbGFiJyB8ICdoY2wnIHwgJ2hzbCcgfCAnaHNsLWxvbmcnIHwgJ2hjbC1sb25nJyB8ICdjdWJlaGVsaXgnIHwgJ2N1YmVoZWxpeC1sb25nJztcblxuZXhwb3J0IGludGVyZmFjZSBTY2FsZUludGVycG9sYXRlUGFyYW1zIHtcbiAgdHlwZTogJ3JnYicgfCAnY3ViZWhlbGl4JyB8ICdjdWJlaGVsaXgtbG9uZyc7XG4gIGdhbW1hPzogbnVtYmVyO1xufVxuXG5leHBvcnQgdHlwZSBWZ0xheW91dEFsaWduID0gJ25vbmUnIHwgJ2VhY2gnIHwgJ2FsbCc7XG5cbmV4cG9ydCB0eXBlIFJvd0NvbDxUPiA9IHtcbiAgcm93PzogVCxcbiAgY29sdW1uPzogVFxufTtcblxuZXhwb3J0IGludGVyZmFjZSBWZ0xheW91dCB7XG4gIHBhZGRpbmc6IG51bWJlciB8IFJvd0NvbDxudW1iZXI+O1xuICBoZWFkZXJCYW5kPzogbnVtYmVyIHwgUm93Q29sPG51bWJlcj47XG4gIGZvb3RlckJhbmQ/OiBudW1iZXIgfCBSb3dDb2w8bnVtYmVyPjtcbiAgb2Zmc2V0OiBudW1iZXIgfCB7XG4gICAgcm93SGVhZGVyOiBudW1iZXIsXG4gICAgcm93Rm9vdGVyOiBudW1iZXIsXG4gICAgcm93VGl0bGU6IG51bWJlcixcbiAgICBjb2x1bW5IZWFkZXI6IG51bWJlcixcbiAgICBjb2x1bW5Gb290ZXI6IG51bWJlcixcbiAgICBjb2x1bW5UaXRsZTogbnVtYmVyXG4gIH07XG4gIGJvdW5kczogJ2Z1bGwnIHwgJ2ZsdXNoJztcbiAgY29sdW1ucz86IG51bWJlciB8IHtzaWduYWw6IHN0cmluZ307XG4gIGFsaWduPzogVmdMYXlvdXRBbGlnbiB8IHtcbiAgICByb3c6IFZnTGF5b3V0QWxpZ24sXG4gICAgY29sdW1uOiBWZ0xheW91dEFsaWduXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0RhdGFSZWZVbmlvbmVkRG9tYWluKGRvbWFpbjogVmdEb21haW4pOiBkb21haW4gaXMgRGF0YVJlZlVuaW9uRG9tYWluIHtcbiAgaWYgKCFpc0FycmF5KGRvbWFpbikpIHtcbiAgICByZXR1cm4gJ2ZpZWxkcycgaW4gZG9tYWluICYmICEoJ2RhdGEnIGluIGRvbWFpbik7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNGaWVsZFJlZlVuaW9uRG9tYWluKGRvbWFpbjogVmdEb21haW4pOiBkb21haW4gaXMgVmdGaWVsZFJlZlVuaW9uRG9tYWluIHtcbiAgaWYgKCFpc0FycmF5KGRvbWFpbikpIHtcbiAgICByZXR1cm4gJ2ZpZWxkcycgaW4gZG9tYWluICYmICdkYXRhJyBpbiBkb21haW47XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNEYXRhUmVmRG9tYWluKGRvbWFpbjogVmdEb21haW4pOiBkb21haW4gaXMgVmdEYXRhUmVmIHtcbiAgaWYgKCFpc0FycmF5KGRvbWFpbikpIHtcbiAgICAgcmV0dXJuICdmaWVsZCcgaW4gZG9tYWluICYmICdkYXRhJyBpbiBkb21haW47XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNTaWduYWxSZWZEb21haW4oZG9tYWluOiBWZ0RvbWFpbik6IGRvbWFpbiBpcyBWZ1NpZ25hbFJlZiB7XG4gIGlmICghaXNBcnJheShkb21haW4pKSB7XG4gICAgcmV0dXJuICdzaWduYWwnIGluIGRvbWFpbjtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmdFdmVudEhhbmRsZXIge1xuICBldmVudHM6IHN0cmluZ1tdIHwgVmdTaWduYWxSZWY7XG4gIHVwZGF0ZT86IHN0cmluZztcbiAgZW5jb2RlPzogc3RyaW5nO1xuICBmb3JjZT86IGJvb2xlYW47XG4gIGJldHdlZW4/OiBhbnlbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWZ1NpZ25hbCB7XG4gIG5hbWU6IHN0cmluZztcbiAgYmluZD86IHN0cmluZztcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gIG9uPzogVmdFdmVudEhhbmRsZXJbXTtcbiAgdXBkYXRlPzogc3RyaW5nO1xuICByZWFjdD86IGJvb2xlYW47XG4gIHZhbHVlPzogc3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbiB8IHt9IHwgVmdTaWduYWxSZWY7XG4gIC8vIG9ubHkgZm9yIG5lc3RlZCBzaWduYWxzXG4gIHB1c2g/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCB0eXBlIFZnRW5jb2RlQ2hhbm5lbCA9ICd4J3wneDInfCd4Yyd8J3dpZHRoJ3wneSd8J3kyJ3wneWMnfCdoZWlnaHQnfCdvcGFjaXR5J3wnZmlsbCd8J2ZpbGxPcGFjaXR5J3wnc3Ryb2tlJ3wnc3Ryb2tlV2lkdGgnfCdzdHJva2VDYXAnfCdzdHJva2VPcGFjaXR5J3wnc3Ryb2tlRGFzaCd8J3N0cm9rZURhc2hPZmZzZXQnfCdjdXJzb3InfCdjbGlwJ3wnc2l6ZSd8J3NoYXBlJ3wncGF0aCd8J2lubmVyUmFkaXVzJ3wnb3V0ZXJSYWRpdXMnfCdzdGFydEFuZ2xlJ3wnZW5kQW5nbGUnfCdpbnRlcnBvbGF0ZSd8J3RlbnNpb24nfCdvcmllbnQnfCd1cmwnfCdhbGlnbid8J2Jhc2VsaW5lJ3wndGV4dCd8J2Rpcid8J2VsbGlwc2lzJ3wnbGltaXQnfCdkeCd8J2R5J3wncmFkaXVzJ3wndGhldGEnfCdhbmdsZSd8J2ZvbnQnfCdmb250U2l6ZSd8J2ZvbnRXZWlnaHQnfCdmb250U3R5bGUnfCd0b29sdGlwJ3wnaHJlZid8J2N1cnNvcid8J2RlZmluZWQnO1xuZXhwb3J0IHR5cGUgVmdFbmNvZGVFbnRyeSA9IHtcbiAgW2sgaW4gVmdFbmNvZGVDaGFubmVsXT86IFZnVmFsdWVSZWYgfCAoVmdWYWx1ZVJlZiAmIHt0ZXN0Pzogc3RyaW5nfSlbXTtcbn07XG5cblxuLy8gVE9ETzogbWFrZSBleHBvcnQgaW50ZXJmYWNlIFZnRW5jb2RlRW50cnkge1xuLy8gICB4PzogVmdWYWx1ZVJlZjxudW1iZXI+XG4vLyAgIHk/OiBWZ1ZhbHVlUmVmPG51bWJlcj5cbi8vICAuLi5cbi8vICAgY29sb3I/OiBWZ1ZhbHVlUmVmPHN0cmluZz5cbi8vICAuLi5cbi8vIH1cblxuZXhwb3J0IHR5cGUgQXhpc09yaWVudCA9ICd0b3AnIHwgJ3JpZ2h0JyB8ICdsZWZ0JyB8ICdib3R0b20nO1xuXG5leHBvcnQgaW50ZXJmYWNlIFZnQXhpcyB7XG4gIHNjYWxlOiBzdHJpbmc7XG4gIGRvbWFpbj86IGJvb2xlYW47XG4gIGZvcm1hdD86IHN0cmluZztcbiAgZ3JpZD86IGJvb2xlYW47XG4gIGdyaWRTY2FsZT86IHN0cmluZztcblxuICBsYWJlbHM/OiBib29sZWFuO1xuXG4gIGxhYmVsQm91bmQ/OiBib29sZWFuIHwgbnVtYmVyO1xuICBsYWJlbEZsdXNoPzogYm9vbGVhbiB8IG51bWJlcjtcbiAgbGFiZWxQYWRkaW5nPzogbnVtYmVyO1xuICBsYWJlbE92ZXJsYXA/OiBib29sZWFuIHwgJ3Bhcml0eScgfCAnZ3JlZWR5JztcbiAgbWF4RXh0ZW50PzogbnVtYmVyO1xuICBtaW5FeHRlbnQ/OiBudW1iZXI7XG4gIG9mZnNldD86IG51bWJlcjtcbiAgb3JpZW50PzogQXhpc09yaWVudDtcbiAgcG9zaXRpb24/OiBudW1iZXI7XG5cbiAgdGlja3M/OiBib29sZWFuO1xuICB0aWNrQ291bnQ/OiBudW1iZXI7XG4gIHRpY2tTaXplPzogbnVtYmVyO1xuXG4gIHRpdGxlPzogc3RyaW5nO1xuICB0aXRsZVBhZGRpbmc/OiBudW1iZXI7XG5cbiAgdmFsdWVzPzogYW55W10gfCBWZ1NpZ25hbFJlZjtcbiAgemluZGV4PzogbnVtYmVyO1xuXG4gIGVuY29kZT86IFZnQXhpc0VuY29kZTtcbn1cblxuZXhwb3J0IHR5cGUgTGVnZW5kVHlwZSA9ICdzeW1ib2wnIHwgJ2dyYWRpZW50JztcblxuZXhwb3J0IGludGVyZmFjZSBWZ0xlZ2VuZCB7XG4gIGZpbGw/OiBzdHJpbmc7XG4gIHN0cm9rZT86IHN0cmluZztcbiAgc2l6ZT86IHN0cmluZztcbiAgc2hhcGU/OiBzdHJpbmc7XG4gIG9wYWNpdHk/OiBzdHJpbmc7XG5cbiAgZW50cnlQYWRkaW5nPzogbnVtYmVyO1xuICBmb3JtYXQ/OiBzdHJpbmc7XG5cbiAgb2Zmc2V0PzogbnVtYmVyO1xuICBvcmllbnQ/OiBMZWdlbmRPcmllbnQ7XG4gIHBhZGRpbmc/OiBudW1iZXI7XG5cbiAgdGlja0NvdW50PzogbnVtYmVyO1xuICB0aXRsZT86IHN0cmluZztcbiAgdHlwZT86IExlZ2VuZFR5cGU7XG4gIHZhbHVlcz86IGFueVtdIHwgVmdTaWduYWxSZWY7XG4gIHppbmRleD86IG51bWJlcjtcblxuICBlbmNvZGU/OiBWZ0xlZ2VuZEVuY29kZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWZ0JpblRyYW5zZm9ybSBleHRlbmRzIEJhc2VCaW4ge1xuICB0eXBlOiAnYmluJztcbiAgZXh0ZW50PzogbnVtYmVyW10gfCB7c2lnbmFsOiBzdHJpbmd9O1xuICBmaWVsZDogc3RyaW5nO1xuICBhczogc3RyaW5nW107XG4gIHNpZ25hbD86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWZ0V4dGVudFRyYW5zZm9ybSB7XG4gIHR5cGU6ICdleHRlbnQnO1xuICBmaWVsZDogc3RyaW5nO1xuICBzaWduYWw6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWZ0Zvcm11bGFUcmFuc2Zvcm0ge1xuICB0eXBlOiAnZm9ybXVsYSc7XG4gIGFzOiBzdHJpbmc7XG4gIGV4cHI6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWZ0ZpbHRlclRyYW5zZm9ybSB7XG4gIHR5cGU6ICdmaWx0ZXInO1xuICBleHByOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmdBZ2dyZWdhdGVUcmFuc2Zvcm0ge1xuICB0eXBlOiAnYWdncmVnYXRlJztcbiAgZ3JvdXBieT86IFZnRmllbGRSZWZbXTtcbiAgZmllbGRzPzogVmdGaWVsZFJlZltdO1xuICBvcHM/OiBBZ2dyZWdhdGVPcFtdO1xuICBhcz86IHN0cmluZ1tdO1xuICBjcm9zcz86IGJvb2xlYW47XG4gIGRyb3A/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZnQ29sbGVjdFRyYW5zZm9ybSB7XG4gIHR5cGU6ICdjb2xsZWN0JztcbiAgc29ydDogVmdTb3J0O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZnTG9va3VwVHJhbnNmb3JtIHtcbiAgdHlwZTogJ2xvb2t1cCc7XG4gIGZyb206IHN0cmluZztcbiAga2V5OiBzdHJpbmc7XG4gIGZpZWxkczogc3RyaW5nW107XG4gIHZhbHVlcz86IHN0cmluZ1tdO1xuICBhcz86IHN0cmluZ1tdO1xuICBkZWZhdWx0Pzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZnU3RhY2tUcmFuc2Zvcm0ge1xuICB0eXBlOiAnc3RhY2snO1xuICBvZmZzZXQ/OiBTdGFja09mZnNldDtcbiAgZ3JvdXBieTogc3RyaW5nW107XG4gIGZpZWxkOiBzdHJpbmc7XG4gIHNvcnQ6IFZnU29ydDtcbiAgYXM6IHN0cmluZ1tdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZnSWRlbnRpZmllclRyYW5zZm9ybSB7XG4gIHR5cGU6ICdpZGVudGlmaWVyJztcbiAgYXM6IHN0cmluZztcbn1cblxuZXhwb3J0IHR5cGUgVmdUcmFuc2Zvcm0gPSBWZ0JpblRyYW5zZm9ybSB8IFZnRXh0ZW50VHJhbnNmb3JtIHwgVmdGb3JtdWxhVHJhbnNmb3JtIHwgVmdBZ2dyZWdhdGVUcmFuc2Zvcm0gfCBWZ0ZpbHRlclRyYW5zZm9ybSB8IFZnSW1wdXRlVHJhbnNmb3JtIHwgVmdTdGFja1RyYW5zZm9ybSB8IFZnQ29sbGVjdFRyYW5zZm9ybSB8IFZnTG9va3VwVHJhbnNmb3JtIHwgVmdJZGVudGlmaWVyVHJhbnNmb3JtIHwgVmdHZW9Qb2ludFRyYW5zZm9ybSB8IFZnR2VvSlNPTlRyYW5zZm9ybSB8IFZnR2VvSlNPTlRyYW5zZm9ybSB8IFZnV2luZG93VHJhbnNmb3JtO1xuXG5leHBvcnQgaW50ZXJmYWNlIFZnR2VvUG9pbnRUcmFuc2Zvcm0ge1xuICB0eXBlOiAnZ2VvcG9pbnQnO1xuICBwcm9qZWN0aW9uOiBzdHJpbmc7IC8vIHByb2plY3Rpb24gbmFtZVxuICBmaWVsZHM6IFZnRmllbGRSZWZbXTtcbiAgYXM/OiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWZ0dlb1NoYXBlVHJhbnNmb3JtIHtcbiAgdHlwZTogJ2dlb3NoYXBlJztcbiAgcHJvamVjdGlvbjogc3RyaW5nOyAvLyBwcm9qZWN0aW9uIG5hbWVcbiAgZmllbGQ/OiBWZ0ZpZWxkUmVmO1xuICBhcz86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWZ0dlb0pTT05UcmFuc2Zvcm0ge1xuICB0eXBlOiAnZ2VvanNvbic7XG4gIGZpZWxkcz86IFZnRmllbGRSZWZbXTtcbiAgZ2VvanNvbj86IFZnRmllbGRSZWY7XG4gIHNpZ25hbDogc3RyaW5nO1xufVxuXG5leHBvcnQgdHlwZSBWZ1Bvc3RFbmNvZGluZ1RyYW5zZm9ybSA9IFZnR2VvU2hhcGVUcmFuc2Zvcm07XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmdBeGlzRW5jb2RlIHtcbiAgdGlja3M/OiBWZ0d1aWRlRW5jb2RlO1xuICBsYWJlbHM/OiBWZ0d1aWRlRW5jb2RlO1xuICB0aXRsZT86IFZnR3VpZGVFbmNvZGU7XG4gIGdyaWQ/OiBWZ0d1aWRlRW5jb2RlO1xuICBkb21haW4/OiBWZ0d1aWRlRW5jb2RlO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZnTGVnZW5kRW5jb2RlIHtcbiAgdGl0bGU/OiBWZ0d1aWRlRW5jb2RlO1xuICBsYWJlbHM/OiBWZ0d1aWRlRW5jb2RlO1xuICBsZWdlbmQ/OiBWZ0d1aWRlRW5jb2RlO1xuICBzeW1ib2xzPzogVmdHdWlkZUVuY29kZTtcbiAgZ3JhZGllbnQ/OiBWZ0d1aWRlRW5jb2RlO1xufVxuXG5leHBvcnQgdHlwZSBWZ0d1aWRlRW5jb2RlID0gYW55OyAvLyBUT0RPOiByZXBsYWNlIHRoaXMgKFNlZSBndWlkZUVuY29kZSBpbiBWZWdhIFNjaGVtYSlcblxuZXhwb3J0IHR5cGUgVmdTb3J0ID0ge1xuICBmaWVsZDogc3RyaW5nO1xuICBvcmRlcj86IFZnQ29tcGFyYXRvck9yZGVyO1xufSB8IHtcbiAgZmllbGQ6IHN0cmluZ1tdO1xuICBvcmRlcj86IChWZ0NvbXBhcmF0b3JPcmRlcilbXTtcbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmdJbXB1dGVUcmFuc2Zvcm0ge1xuICB0eXBlOiAnaW1wdXRlJztcbiAgZ3JvdXBieT86IHN0cmluZ1tdO1xuICBmaWVsZDogc3RyaW5nO1xuICBrZXk6IHN0cmluZztcbiAga2V5dmFscz86IHN0cmluZ1tdO1xuICBtZXRob2Q/OiAndmFsdWUnIHwgJ21lZGlhbicgfCAnbWF4JyB8ICdtaW4nIHwgJ21lYW4nO1xuICB2YWx1ZT86IGFueTtcbn1cblxuZXhwb3J0IHR5cGUgVmdDaGVja2JveEJpbmRpbmcgPSB7XG4gIGlucHV0OiAnY2hlY2tib3gnO1xuICBlbGVtZW50Pzogc3RyaW5nO1xufTtcblxuZXhwb3J0IHR5cGUgVmdSYWRpb0JpbmRpbmcgPSB7XG4gIGlucHV0OiAncmFkaW8nO1xuICBvcHRpb25zOiBzdHJpbmdbXTtcbiAgZWxlbWVudD86IHN0cmluZztcbn07XG5cbmV4cG9ydCB0eXBlIFZnU2VsZWN0QmluZGluZyA9IHtcbiAgaW5wdXQ6ICdzZWxlY3QnO1xuICBvcHRpb25zOiBzdHJpbmdbXTtcbiAgZWxlbWVudD86IHN0cmluZztcbn07XG5cbmV4cG9ydCB0eXBlIFZnUmFuZ2VCaW5kaW5nID0ge1xuICBpbnB1dDogJ3JhbmdlJztcbiAgbWluPzogbnVtYmVyO1xuICBtYXg/OiBudW1iZXI7XG4gIHN0ZXA/OiBudW1iZXI7XG4gIGVsZW1lbnQ/OiBzdHJpbmc7XG59O1xuXG5leHBvcnQgdHlwZSBWZ0dlbmVyaWNCaW5kaW5nID0ge1xuICBpbnB1dDogc3RyaW5nO1xuICBlbGVtZW50Pzogc3RyaW5nO1xufTtcblxuZXhwb3J0IHR5cGUgVmdCaW5kaW5nID0gVmdDaGVja2JveEJpbmRpbmcgfCBWZ1JhZGlvQmluZGluZyB8XG4gIFZnU2VsZWN0QmluZGluZyB8IFZnUmFuZ2VCaW5kaW5nIHwgVmdHZW5lcmljQmluZGluZztcblxuXG4vKipcbiAqIEJhc2Ugb2JqZWN0IGZvciBWZWdhJ3MgQXhpcyBhbmQgQXhpcyBDb25maWcuXG4gKiBBbGwgb2YgdGhlc2UgcHJvcGVydGllcyBhcmUgYm90aCBwcm9wZXJ0aWVzIG9mIFZlZ2EncyBBeGlzIGFuZCBBeGlzIENvbmZpZy5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBWZ0F4aXNCYXNlIHtcbiAgLyoqXG4gICAqIEEgYm9vbGVhbiBmbGFnIGluZGljYXRpbmcgaWYgdGhlIGRvbWFpbiAodGhlIGF4aXMgYmFzZWxpbmUpIHNob3VsZCBiZSBpbmNsdWRlZCBhcyBwYXJ0IG9mIHRoZSBheGlzLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYHRydWVgXG4gICAqL1xuICBkb21haW4/OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBBIGJvb2xlYW4gZmxhZyBpbmRpY2F0aW5nIGlmIGdyaWQgbGluZXMgc2hvdWxkIGJlIGluY2x1ZGVkIGFzIHBhcnQgb2YgdGhlIGF4aXNcbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGB0cnVlYCBmb3IgW2NvbnRpbnVvdXMgc2NhbGVzXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NjYWxlLmh0bWwjY29udGludW91cykgdGhhdCBhcmUgbm90IGJpbm5lZDsgb3RoZXJ3aXNlLCBgZmFsc2VgLlxuICAgKi9cbiAgZ3JpZD86IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIEEgYm9vbGVhbiBmbGFnIGluZGljYXRpbmcgaWYgbGFiZWxzIHNob3VsZCBiZSBpbmNsdWRlZCBhcyBwYXJ0IG9mIHRoZSBheGlzLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gIGB0cnVlYC5cbiAgICovXG4gIGxhYmVscz86IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIEluZGljYXRlcyBpZiBsYWJlbHMgc2hvdWxkIGJlIGhpZGRlbiBpZiB0aGV5IGV4Y2VlZCB0aGUgYXhpcyByYW5nZS4gSWbCoGBmYWxzZcKgYCh0aGUgZGVmYXVsdCkgbm8gYm91bmRzIG92ZXJsYXAgYW5hbHlzaXMgaXMgcGVyZm9ybWVkLiBJZsKgYHRydWVgLCBsYWJlbHMgd2lsbCBiZSBoaWRkZW4gaWYgdGhleSBleGNlZWQgdGhlIGF4aXMgcmFuZ2UgYnkgbW9yZSB0aGFuIDEgcGl4ZWwuIElmIHRoaXMgcHJvcGVydHkgaXMgYSBudW1iZXIsIGl0IHNwZWNpZmllcyB0aGUgcGl4ZWwgdG9sZXJhbmNlOiB0aGUgbWF4aW11bSBhbW91bnQgYnkgd2hpY2ggYSBsYWJlbCBib3VuZGluZyBib3ggbWF5IGV4Y2VlZCB0aGUgYXhpcyByYW5nZS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBmYWxzZWAuXG4gICAqL1xuICBsYWJlbEJvdW5kPzogYm9vbGVhbiB8IG51bWJlcjtcblxuICAvKipcbiAgICogSW5kaWNhdGVzIGlmIHRoZSBmaXJzdCBhbmQgbGFzdCBheGlzIGxhYmVscyBzaG91bGQgYmUgYWxpZ25lZCBmbHVzaCB3aXRoIHRoZSBzY2FsZSByYW5nZS4gRmx1c2ggYWxpZ25tZW50IGZvciBhIGhvcml6b250YWwgYXhpcyB3aWxsIGxlZnQtYWxpZ24gdGhlIGZpcnN0IGxhYmVsIGFuZCByaWdodC1hbGlnbiB0aGUgbGFzdCBsYWJlbC4gRm9yIHZlcnRpY2FsIGF4ZXMsIGJvdHRvbSBhbmQgdG9wIHRleHQgYmFzZWxpbmVzIGFyZSBhcHBsaWVkIGluc3RlYWQuIElmIHRoaXMgcHJvcGVydHkgaXMgYSBudW1iZXIsIGl0IGFsc28gaW5kaWNhdGVzIHRoZSBudW1iZXIgb2YgcGl4ZWxzIGJ5IHdoaWNoIHRvIG9mZnNldCB0aGUgZmlyc3QgYW5kIGxhc3QgbGFiZWxzOyBmb3IgZXhhbXBsZSwgYSB2YWx1ZSBvZiAyIHdpbGwgZmx1c2gtYWxpZ24gdGhlIGZpcnN0IGFuZCBsYXN0IGxhYmVscyBhbmQgYWxzbyBwdXNoIHRoZW0gMiBwaXhlbHMgb3V0d2FyZCBmcm9tIHRoZSBjZW50ZXIgb2YgdGhlIGF4aXMuIFRoZSBhZGRpdGlvbmFsIGFkanVzdG1lbnQgY2FuIHNvbWV0aW1lcyBoZWxwIHRoZSBsYWJlbHMgYmV0dGVyIHZpc3VhbGx5IGdyb3VwIHdpdGggY29ycmVzcG9uZGluZyBheGlzIHRpY2tzLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYHRydWVgIGZvciBheGlzIG9mIGEgY29udGludW91cyB4LXNjYWxlLiBPdGhlcndpc2UsIGBmYWxzZWAuXG4gICAqL1xuICBsYWJlbEZsdXNoPzogYm9vbGVhbiB8IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIHN0cmF0ZWd5IHRvIHVzZSBmb3IgcmVzb2x2aW5nIG92ZXJsYXAgb2YgYXhpcyBsYWJlbHMuIElmIGBmYWxzZWAgKHRoZSBkZWZhdWx0KSwgbm8gb3ZlcmxhcCByZWR1Y3Rpb24gaXMgYXR0ZW1wdGVkLiBJZiBzZXQgdG8gYHRydWVgIG9yIGBcInBhcml0eVwiYCwgYSBzdHJhdGVneSBvZiByZW1vdmluZyBldmVyeSBvdGhlciBsYWJlbCBpcyB1c2VkICh0aGlzIHdvcmtzIHdlbGwgZm9yIHN0YW5kYXJkIGxpbmVhciBheGVzKS4gSWYgc2V0IHRvIGBcImdyZWVkeVwiYCwgYSBsaW5lYXIgc2NhbiBvZiB0aGUgbGFiZWxzIGlzIHBlcmZvcm1lZCwgcmVtb3ZpbmcgYW55IGxhYmVscyB0aGF0IG92ZXJsYXBzIHdpdGggdGhlIGxhc3QgdmlzaWJsZSBsYWJlbCAodGhpcyBvZnRlbiB3b3JrcyBiZXR0ZXIgZm9yIGxvZy1zY2FsZWQgYXhlcykuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgdHJ1ZWAgZm9yIG5vbi1ub21pbmFsIGZpZWxkcyB3aXRoIG5vbi1sb2cgc2NhbGVzOyBgXCJncmVlZHlcImAgZm9yIGxvZyBzY2FsZXM7IG90aGVyd2lzZSBgZmFsc2VgLlxuICAgKi9cbiAgbGFiZWxPdmVybGFwPzogYm9vbGVhbiB8ICdwYXJpdHknIHwgJ2dyZWVkeSc7XG5cbiAgLyoqXG4gICAqIFRoZSBwYWRkaW5nLCBpbiBwaXhlbHMsIGJldHdlZW4gYXhpcyBhbmQgdGV4dCBsYWJlbHMuXG4gICAqL1xuICBsYWJlbFBhZGRpbmc/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIEJvb2xlYW4gdmFsdWUgdGhhdCBkZXRlcm1pbmVzIHdoZXRoZXIgdGhlIGF4aXMgc2hvdWxkIGluY2x1ZGUgdGlja3MuXG4gICAqL1xuICB0aWNrcz86IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFRoZSBzaXplIGluIHBpeGVscyBvZiBheGlzIHRpY2tzLlxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICB0aWNrU2l6ZT86IG51bWJlcjtcblxuICAvKipcbiAgICogTWF4IGxlbmd0aCBmb3IgYXhpcyB0aXRsZSBpZiB0aGUgdGl0bGUgaXMgYXV0b21hdGljYWxseSBnZW5lcmF0ZWQgZnJvbSB0aGUgZmllbGQncyBkZXNjcmlwdGlvbi5cbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYHVuZGVmaW5lZGAuXG4gICAqL1xuICB0aXRsZU1heExlbmd0aD86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIHBhZGRpbmcsIGluIHBpeGVscywgYmV0d2VlbiB0aXRsZSBhbmQgYXhpcy5cbiAgICovXG4gIHRpdGxlUGFkZGluZz86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIG1pbmltdW0gZXh0ZW50IGluIHBpeGVscyB0aGF0IGF4aXMgdGlja3MgYW5kIGxhYmVscyBzaG91bGQgdXNlLiBUaGlzIGRldGVybWluZXMgYSBtaW5pbXVtIG9mZnNldCB2YWx1ZSBmb3IgYXhpcyB0aXRsZXMuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgMzBgIGZvciB5LWF4aXM7IGB1bmRlZmluZWRgIGZvciB4LWF4aXMuXG4gICAqL1xuICBtaW5FeHRlbnQ/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBtYXhpbXVtIGV4dGVudCBpbiBwaXhlbHMgdGhhdCBheGlzIHRpY2tzIGFuZCBsYWJlbHMgc2hvdWxkIHVzZS4gVGhpcyBkZXRlcm1pbmVzIGEgbWF4aW11bSBvZmZzZXQgdmFsdWUgZm9yIGF4aXMgdGl0bGVzLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYHVuZGVmaW5lZGAuXG4gICAqL1xuICBtYXhFeHRlbnQ/OiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmdBeGlzQ29uZmlnIGV4dGVuZHMgVmdBeGlzQmFzZSB7XG4gIC8qKlxuICAgKiBBbiBpbnRlcnBvbGF0aW9uIGZyYWN0aW9uIGluZGljYXRpbmcgd2hlcmUsIGZvciBgYmFuZGAgc2NhbGVzLCBheGlzIHRpY2tzIHNob3VsZCBiZSBwb3NpdGlvbmVkLiBBIHZhbHVlIG9mIGAwYCBwbGFjZXMgdGlja3MgYXQgdGhlIGxlZnQgZWRnZSBvZiB0aGVpciBiYW5kcy4gQSB2YWx1ZSBvZiBgMC41YCBwbGFjZXMgdGlja3MgaW4gdGhlIG1pZGRsZSBvZiB0aGVpciBiYW5kcy5cbiAgICovXG4gIGJhbmRQb3NpdGlvbj86IG51bWJlcjtcbiAgLyoqXG4gICAqIFN0cm9rZSB3aWR0aCBvZiBheGlzIGRvbWFpbiBsaW5lXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyAgKG5vbmUsIHVzaW5nIFZlZ2EgZGVmYXVsdCkuXG4gICAqL1xuICBkb21haW5XaWR0aD86IG51bWJlcjtcblxuICAvKipcbiAgICogQ29sb3Igb2YgYXhpcyBkb21haW4gbGluZS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fICAobm9uZSwgdXNpbmcgVmVnYSBkZWZhdWx0KS5cbiAgICovXG4gIGRvbWFpbkNvbG9yPzogc3RyaW5nO1xuXG4gIC8vIC0tLS0tLS0tLS0gR3JpZCAtLS0tLS0tLS0tXG4gIC8qKlxuICAgKiBDb2xvciBvZiBncmlkbGluZXMuXG4gICAqL1xuICBncmlkQ29sb3I/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBvZmZzZXQgKGluIHBpeGVscykgaW50byB3aGljaCB0byBiZWdpbiBkcmF3aW5nIHdpdGggdGhlIGdyaWQgZGFzaCBhcnJheS5cbiAgICovXG4gIGdyaWREYXNoPzogbnVtYmVyW107XG5cbiAgLyoqXG4gICAqIFRoZSBzdHJva2Ugb3BhY2l0eSBvZiBncmlkICh2YWx1ZSBiZXR3ZWVuIFswLDFdKVxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gKGAxYCBieSBkZWZhdWx0KVxuICAgKiBAbWluaW11bSAwXG4gICAqIEBtYXhpbXVtIDFcbiAgICovXG4gIGdyaWRPcGFjaXR5PzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgZ3JpZCB3aWR0aCwgaW4gcGl4ZWxzLlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBncmlkV2lkdGg/OiBudW1iZXI7XG5cbiAgLy8gLS0tLS0tLS0tLSBUaWNrcyAtLS0tLS0tLS0tXG4gIC8qKlxuICAgKiBUaGUgY29sb3Igb2YgdGhlIGF4aXMncyB0aWNrLlxuICAgKi9cbiAgdGlja0NvbG9yPzogc3RyaW5nO1xuXG5cbiAgLyoqXG4gICAqIFRoZSByb3RhdGlvbiBhbmdsZSBvZiB0aGUgYXhpcyBsYWJlbHMuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgLTkwYCBmb3Igbm9taW5hbCBhbmQgb3JkaW5hbCBmaWVsZHM7IGAwYCBvdGhlcndpc2UuXG4gICAqXG4gICAqIEBtaW5pbXVtIC0zNjBcbiAgICogQG1heGltdW0gMzYwXG4gICAqL1xuICBsYWJlbEFuZ2xlPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgY29sb3Igb2YgdGhlIHRpY2sgbGFiZWwsIGNhbiBiZSBpbiBoZXggY29sb3IgY29kZSBvciByZWd1bGFyIGNvbG9yIG5hbWUuXG4gICAqL1xuICBsYWJlbENvbG9yPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgZm9udCBvZiB0aGUgdGljayBsYWJlbC5cbiAgICovXG4gIGxhYmVsRm9udD86IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIGZvbnQgc2l6ZSBvZiB0aGUgbGFiZWwsIGluIHBpeGVscy5cbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKi9cbiAgbGFiZWxGb250U2l6ZT86IG51bWJlcjtcblxuICAvKipcbiAgICogTWF4aW11bSBhbGxvd2VkIHBpeGVsIHdpZHRoIG9mIGF4aXMgdGljayBsYWJlbHMuXG4gICAqL1xuICBsYWJlbExpbWl0PzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBCb29sZWFuIGZsYWcgaW5kaWNhdGluZyBpZiBwaXhlbCBwb3NpdGlvbiB2YWx1ZXMgc2hvdWxkIGJlIHJvdW5kZWQgdG8gdGhlIG5lYXJlc3QgaW50ZWdlci5cbiAgICovXG4gIHRpY2tSb3VuZD86IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFRoZSB3aWR0aCwgaW4gcGl4ZWxzLCBvZiB0aWNrcy5cbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKi9cbiAgdGlja1dpZHRoPzogbnVtYmVyO1xuXG4gIC8vIC0tLS0tLS0tLS0gVGl0bGUgLS0tLS0tLS0tLVxuXG4gIC8qKlxuICAgKiBIb3Jpem9udGFsIHRleHQgYWxpZ25tZW50IG9mIGF4aXMgdGl0bGVzLlxuICAgKi9cbiAgdGl0bGVBbGlnbj86IHN0cmluZztcblxuICAvKipcbiAgICogQW5nbGUgaW4gZGVncmVlcyBvZiBheGlzIHRpdGxlcy5cbiAgICovXG4gIHRpdGxlQW5nbGU/OiBudW1iZXI7XG4gIC8qKlxuICAgKiBWZXJ0aWNhbCB0ZXh0IGJhc2VsaW5lIGZvciBheGlzIHRpdGxlcy5cbiAgICovXG4gIHRpdGxlQmFzZWxpbmU/OiBzdHJpbmc7XG4gIC8qKlxuICAgKiBDb2xvciBvZiB0aGUgdGl0bGUsIGNhbiBiZSBpbiBoZXggY29sb3IgY29kZSBvciByZWd1bGFyIGNvbG9yIG5hbWUuXG4gICAqL1xuICB0aXRsZUNvbG9yPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBGb250IG9mIHRoZSB0aXRsZS4gKGUuZy4sIGBcIkhlbHZldGljYSBOZXVlXCJgKS5cbiAgICovXG4gIHRpdGxlRm9udD86IHN0cmluZztcblxuICAvKipcbiAgICogRm9udCBzaXplIG9mIHRoZSB0aXRsZS5cbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKi9cbiAgdGl0bGVGb250U2l6ZT86IG51bWJlcjtcblxuICAvKipcbiAgICogRm9udCB3ZWlnaHQgb2YgdGhlIHRpdGxlLlxuICAgKiBUaGlzIGNhbiBiZSBlaXRoZXIgYSBzdHJpbmcgKGUuZyBgXCJib2xkXCJgLCBgXCJub3JtYWxcImApIG9yIGEgbnVtYmVyIChgMTAwYCwgYDIwMGAsIGAzMDBgLCAuLi4sIGA5MDBgIHdoZXJlIGBcIm5vcm1hbFwiYCA9IGA0MDBgIGFuZCBgXCJib2xkXCJgID0gYDcwMGApLlxuICAgKi9cbiAgdGl0bGVGb250V2VpZ2h0PzogRm9udFdlaWdodDtcblxuICAvKipcbiAgICogTWF4aW11bSBhbGxvd2VkIHBpeGVsIHdpZHRoIG9mIGF4aXMgdGl0bGVzLlxuICAgKi9cbiAgdGl0bGVMaW1pdD86IG51bWJlcjtcblxuICAvKipcbiAgICogWC1jb29yZGluYXRlIG9mIHRoZSBheGlzIHRpdGxlIHJlbGF0aXZlIHRvIHRoZSBheGlzIGdyb3VwLlxuICAgKi9cbiAgdGl0bGVYPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBZLWNvb3JkaW5hdGUgb2YgdGhlIGF4aXMgdGl0bGUgcmVsYXRpdmUgdG8gdGhlIGF4aXMgZ3JvdXAuXG4gICAqL1xuICB0aXRsZVk/OiBudW1iZXI7XG59XG5cbmV4cG9ydCB0eXBlIExlZ2VuZE9yaWVudCA9ICdsZWZ0JyB8ICdyaWdodCcgfCAndG9wLWxlZnQnIHwgJ3RvcC1yaWdodCcgfCAnYm90dG9tLWxlZnQnIHwgJ2JvdHRvbS1yaWdodCcgfCAnbm9uZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmdMZWdlbmRCYXNlIHtcbiAgLyoqXG4gICAqIFBhZGRpbmcgKGluIHBpeGVscykgYmV0d2VlbiBsZWdlbmQgZW50cmllcyBpbiBhIHN5bWJvbCBsZWdlbmQuXG4gICAqL1xuICBlbnRyeVBhZGRpbmc/OiBudW1iZXI7XG5cblxuICAvKipcbiAgICogVGhlIG9yaWVudGF0aW9uIG9mIHRoZSBsZWdlbmQsIHdoaWNoIGRldGVybWluZXMgaG93IHRoZSBsZWdlbmQgaXMgcG9zaXRpb25lZCB3aXRoaW4gdGhlIHNjZW5lLiBPbmUgb2YgXCJsZWZ0XCIsIFwicmlnaHRcIiwgXCJ0b3AtbGVmdFwiLCBcInRvcC1yaWdodFwiLCBcImJvdHRvbS1sZWZ0XCIsIFwiYm90dG9tLXJpZ2h0XCIsIFwibm9uZVwiLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYFwicmlnaHRcImBcbiAgICovXG4gIG9yaWVudD86IExlZ2VuZE9yaWVudDtcblxuICAvKipcbiAgICogVGhlIG9mZnNldCwgaW4gcGl4ZWxzLCBieSB3aGljaCB0byBkaXNwbGFjZSB0aGUgbGVnZW5kIGZyb20gdGhlIGVkZ2Ugb2YgdGhlIGVuY2xvc2luZyBncm91cCBvciBkYXRhIHJlY3RhbmdsZS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fICBgMGBcbiAgICovXG4gIG9mZnNldD86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIHBhZGRpbmcsIGluIHBpeGVscywgYmV0d2VlbiB0aGUgbGVnZW5kIGFuZCBheGlzLlxuICAgKi9cbiAgcGFkZGluZz86IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBWZ0xlZ2VuZENvbmZpZyBleHRlbmRzIFZnTGVnZW5kQmFzZSB7XG5cbiAgLyoqXG4gICAqIENvcm5lciByYWRpdXMgZm9yIHRoZSBmdWxsIGxlZ2VuZC5cbiAgICovXG4gIGNvcm5lclJhZGl1cz86IG51bWJlcjtcblxuICAvKipcbiAgICogQmFja2dyb3VuZCBmaWxsIGNvbG9yIGZvciB0aGUgZnVsbCBsZWdlbmQuXG4gICAqL1xuICBmaWxsQ29sb3I/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEJvcmRlciBzdHJva2UgY29sb3IgZm9yIHRoZSBmdWxsIGxlZ2VuZC5cbiAgICovXG4gIHN0cm9rZUNvbG9yPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBCb3JkZXIgc3Ryb2tlIGRhc2ggcGF0dGVybiBmb3IgdGhlIGZ1bGwgbGVnZW5kLlxuICAgKi9cbiAgc3Ryb2tlRGFzaD86IG51bWJlcltdO1xuXG4gIC8qKlxuICAgKiBCb3JkZXIgc3Ryb2tlIHdpZHRoIGZvciB0aGUgZnVsbCBsZWdlbmQuXG4gICAqL1xuICBzdHJva2VXaWR0aD86IG51bWJlcjtcbiAgLy8gLS0tLS0tLS0tLSBHcmFkaWVudCAtLS0tLS0tLS0tXG4gIC8qKlxuICAgKiBUaGUgY29sb3Igb2YgdGhlIGdyYWRpZW50IHN0cm9rZSwgY2FuIGJlIGluIGhleCBjb2xvciBjb2RlIG9yIHJlZ3VsYXIgY29sb3IgbmFtZS5cbiAgICovXG4gIGdyYWRpZW50U3Ryb2tlQ29sb3I/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSB3aWR0aCBvZiB0aGUgZ3JhZGllbnQgc3Ryb2tlLCBpbiBwaXhlbHMuXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIGdyYWRpZW50U3Ryb2tlV2lkdGg/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBoZWlnaHQgb2YgdGhlIGdyYWRpZW50LCBpbiBwaXhlbHMuXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIGdyYWRpZW50SGVpZ2h0PzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUZXh0IGJhc2VsaW5lIGZvciBjb2xvciByYW1wIGdyYWRpZW50IGxhYmVscy5cbiAgICovXG4gIGdyYWRpZW50TGFiZWxCYXNlbGluZT86IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIG1heGltdW0gYWxsb3dlZCBsZW5ndGggaW4gcGl4ZWxzIG9mIGNvbG9yIHJhbXAgZ3JhZGllbnQgbGFiZWxzLlxuICAgKi9cbiAgZ3JhZGllbnRMYWJlbExpbWl0PzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBWZXJ0aWNhbCBvZmZzZXQgaW4gcGl4ZWxzIGZvciBjb2xvciByYW1wIGdyYWRpZW50IGxhYmVscy5cbiAgICovXG4gIGdyYWRpZW50TGFiZWxPZmZzZXQ/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSB3aWR0aCBvZiB0aGUgZ3JhZGllbnQsIGluIHBpeGVscy5cbiAgICogQG1pbmltdW0gMFxuICAgKi9cbiAgZ3JhZGllbnRXaWR0aD86IG51bWJlcjtcblxuICAvLyAtLS0tLS0tLS0tIExhYmVsIC0tLS0tLS0tLS1cbiAgLyoqXG4gICAqIFRoZSBhbGlnbm1lbnQgb2YgdGhlIGxlZ2VuZCBsYWJlbCwgY2FuIGJlIGxlZnQsIG1pZGRsZSBvciByaWdodC5cbiAgICovXG4gIGxhYmVsQWxpZ24/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBwb3NpdGlvbiBvZiB0aGUgYmFzZWxpbmUgb2YgbGVnZW5kIGxhYmVsLCBjYW4gYmUgdG9wLCBtaWRkbGUgb3IgYm90dG9tLlxuICAgKi9cbiAgbGFiZWxCYXNlbGluZT86IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIGNvbG9yIG9mIHRoZSBsZWdlbmQgbGFiZWwsIGNhbiBiZSBpbiBoZXggY29sb3IgY29kZSBvciByZWd1bGFyIGNvbG9yIG5hbWUuXG4gICAqL1xuICBsYWJlbENvbG9yPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgZm9udCBvZiB0aGUgbGVnZW5kIGxhYmVsLlxuICAgKi9cbiAgbGFiZWxGb250Pzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgZm9udCBzaXplIG9mIGxlZ2VuZCBsYWJlbC5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGAxMGAuXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIGxhYmVsRm9udFNpemU/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIE1heGltdW0gYWxsb3dlZCBwaXhlbCB3aWR0aCBvZiBheGlzIHRpY2sgbGFiZWxzLlxuICAgKi9cbiAgbGFiZWxMaW1pdD86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIG9mZnNldCBvZiB0aGUgbGVnZW5kIGxhYmVsLlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBsYWJlbE9mZnNldD86IG51bWJlcjtcblxuICAvLyAtLS0tLS0tLS0tIFN5bWJvbHMgLS0tLS0tLS0tLVxuICAvKipcbiAgICogVGhlIGNvbG9yIG9mIHRoZSBsZWdlbmQgc3ltYm9sLFxuICAgKi9cbiAgc3ltYm9sQ29sb3I/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIERlZmF1bHQgc2hhcGUgdHlwZSAoc3VjaCBhcyBcImNpcmNsZVwiKSBmb3IgbGVnZW5kIHN5bWJvbHMuXG4gICAqL1xuICBzeW1ib2xUeXBlPzogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgc2l6ZSBvZiB0aGUgbGVnZW5kIHN5bWJvbCwgaW4gcGl4ZWxzLlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBzeW1ib2xTaXplPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgd2lkdGggb2YgdGhlIHN5bWJvbCdzIHN0cm9rZS5cbiAgICogQG1pbmltdW0gMFxuICAgKi9cbiAgc3ltYm9sU3Ryb2tlV2lkdGg/OiBudW1iZXI7XG5cbiAgLy8gLS0tLS0tLS0tLSBUaXRsZSAtLS0tLS0tLS0tXG4gIC8qKlxuICAgKiBIb3Jpem9udGFsIHRleHQgYWxpZ25tZW50IGZvciBsZWdlbmQgdGl0bGVzLlxuICAgKi9cbiAgdGl0bGVBbGlnbj86IHN0cmluZztcblxuICAgLyoqXG4gICAgKiBWZXJ0aWNhbCB0ZXh0IGJhc2VsaW5lIGZvciBsZWdlbmQgdGl0bGVzLlxuICAgICovXG4gIHRpdGxlQmFzZWxpbmU/OiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgY29sb3Igb2YgdGhlIGxlZ2VuZCB0aXRsZSwgY2FuIGJlIGluIGhleCBjb2xvciBjb2RlIG9yIHJlZ3VsYXIgY29sb3IgbmFtZS5cbiAgICovXG4gIHRpdGxlQ29sb3I/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBmb250IG9mIHRoZSBsZWdlbmQgdGl0bGUuXG4gICAqL1xuICB0aXRsZUZvbnQ/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBmb250IHNpemUgb2YgdGhlIGxlZ2VuZCB0aXRsZS5cbiAgICovXG4gIHRpdGxlRm9udFNpemU/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBmb250IHdlaWdodCBvZiB0aGUgbGVnZW5kIHRpdGxlLlxuICAgKiBUaGlzIGNhbiBiZSBlaXRoZXIgYSBzdHJpbmcgKGUuZyBgXCJib2xkXCJgLCBgXCJub3JtYWxcImApIG9yIGEgbnVtYmVyIChgMTAwYCwgYDIwMGAsIGAzMDBgLCAuLi4sIGA5MDBgIHdoZXJlIGBcIm5vcm1hbFwiYCA9IGA0MDBgIGFuZCBgXCJib2xkXCJgID0gYDcwMGApLlxuICAgKi9cbiAgdGl0bGVGb250V2VpZ2h0PzogRm9udFdlaWdodDtcblxuICAvKipcbiAgICogTWF4aW11bSBhbGxvd2VkIHBpeGVsIHdpZHRoIG9mIGF4aXMgdGl0bGVzLlxuICAgKi9cbiAgdGl0bGVMaW1pdD86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIHBhZGRpbmcsIGluIHBpeGVscywgYmV0d2VlbiB0aXRsZSBhbmQgbGVnZW5kLlxuICAgKi9cbiAgdGl0bGVQYWRkaW5nPzogbnVtYmVyO1xufVxuXG5leHBvcnQgdHlwZSBGb250U3R5bGUgPSAnbm9ybWFsJyB8ICdpdGFsaWMnO1xuXG5leHBvcnQgdHlwZSBGb250V2VpZ2h0U3RyaW5nID0gJ25vcm1hbCcgfCAnYm9sZCc7XG4vKipcbiAqIEBUSlMtdHlwZSBpbnRlZ2VyXG4gKiBAbWluaW11bSAxMDBcbiAqIEBtYXhpbXVtIDkwMFxuICovXG5leHBvcnQgdHlwZSBGb250V2VpZ2h0TnVtYmVyID0gbnVtYmVyO1xuZXhwb3J0IHR5cGUgRm9udFdlaWdodCA9IEZvbnRXZWlnaHRTdHJpbmcgfCBGb250V2VpZ2h0TnVtYmVyO1xuZXhwb3J0IHR5cGUgSG9yaXpvbnRhbEFsaWduID0gJ2xlZnQnIHwgJ3JpZ2h0JyB8ICdjZW50ZXInO1xuZXhwb3J0IHR5cGUgSW50ZXJwb2xhdGUgPSAnbGluZWFyJyB8ICdsaW5lYXItY2xvc2VkJyB8XG4gICdzdGVwJyB8ICdzdGVwLWJlZm9yZScgfCAnc3RlcC1hZnRlcicgfFxuICAnYmFzaXMnIHwgJ2Jhc2lzLW9wZW4nIHwgJ2Jhc2lzLWNsb3NlZCcgfFxuICAnY2FyZGluYWwnIHwgJ2NhcmRpbmFsLW9wZW4nIHwgJ2NhcmRpbmFsLWNsb3NlZCcgfFxuICAnYnVuZGxlJyB8ICdtb25vdG9uZSc7XG5leHBvcnQgdHlwZSBPcmllbnQgPSAnaG9yaXpvbnRhbCcgfCAndmVydGljYWwnO1xuZXhwb3J0IHR5cGUgVmVydGljYWxBbGlnbiA9ICd0b3AnIHwgJ21pZGRsZScgfCAnYm90dG9tJztcblxuZXhwb3J0IGludGVyZmFjZSBWZ01hcmtDb25maWcge1xuXG4gIC8qKlxuICAgKiBEZWZhdWx0IEZpbGwgQ29sb3IuICBUaGlzIGhhcyBoaWdoZXIgcHJlY2VkZW5jZSB0aGFuIGBjb25maWcuY29sb3JgXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyAoTm9uZSlcbiAgICpcbiAgICovXG4gIGZpbGw/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIERlZmF1bHQgU3Ryb2tlIENvbG9yLiAgVGhpcyBoYXMgaGlnaGVyIHByZWNlZGVuY2UgdGhhbiBgY29uZmlnLmNvbG9yYFxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gKE5vbmUpXG4gICAqXG4gICAqL1xuICBzdHJva2U/OiBzdHJpbmc7XG5cbiAgLy8gLS0tLS0tLS0tLSBPcGFjaXR5IC0tLS0tLS0tLS1cbiAgLyoqXG4gICAqIFRoZSBvdmVyYWxsIG9wYWNpdHkgKHZhbHVlIGJldHdlZW4gWzAsMV0pLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDAuN2AgZm9yIG5vbi1hZ2dyZWdhdGUgcGxvdHMgd2l0aCBgcG9pbnRgLCBgdGlja2AsIGBjaXJjbGVgLCBvciBgc3F1YXJlYCBtYXJrcyBvciBsYXllcmVkIGBiYXJgIGNoYXJ0cyBhbmQgYDFgIG90aGVyd2lzZS5cbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKiBAbWF4aW11bSAxXG4gICAqL1xuICBvcGFjaXR5PzogbnVtYmVyO1xuXG5cbiAgLyoqXG4gICAqIFRoZSBmaWxsIG9wYWNpdHkgKHZhbHVlIGJldHdlZW4gWzAsMV0pLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYDFgXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICogQG1heGltdW0gMVxuICAgKi9cbiAgZmlsbE9wYWNpdHk/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBzdHJva2Ugb3BhY2l0eSAodmFsdWUgYmV0d2VlbiBbMCwxXSkuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgMWBcbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKiBAbWF4aW11bSAxXG4gICAqL1xuICBzdHJva2VPcGFjaXR5PzogbnVtYmVyO1xuXG4gIC8vIC0tLS0tLS0tLS0gU3Ryb2tlIFN0eWxlIC0tLS0tLS0tLS1cbiAgLyoqXG4gICAqIFRoZSBzdHJva2Ugd2lkdGgsIGluIHBpeGVscy5cbiAgICpcbiAgICogQG1pbmltdW0gMFxuICAgKi9cbiAgc3Ryb2tlV2lkdGg/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBzdHJva2UgY2FwIGZvciBsaW5lIGVuZGluZyBzdHlsZS4gT25lIG9mIGBcImJ1dHRcImAsIGBcInJvdW5kXCJgLCBvciBgXCJzcXVhcmVcImAuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgXCJzcXVhcmVcImBcbiAgICovXG4gIHN0cm9rZUNhcD86ICdidXR0JyB8ICdyb3VuZCcgfCAnc3F1YXJlJztcblxuICAvKipcbiAgICogQW4gYXJyYXkgb2YgYWx0ZXJuYXRpbmcgc3Ryb2tlLCBzcGFjZSBsZW5ndGhzIGZvciBjcmVhdGluZyBkYXNoZWQgb3IgZG90dGVkIGxpbmVzLlxuICAgKi9cbiAgc3Ryb2tlRGFzaD86IG51bWJlcltdO1xuXG4gIC8qKlxuICAgKiBUaGUgb2Zmc2V0IChpbiBwaXhlbHMpIGludG8gd2hpY2ggdG8gYmVnaW4gZHJhd2luZyB3aXRoIHRoZSBzdHJva2UgZGFzaCBhcnJheS5cbiAgICovXG4gIHN0cm9rZURhc2hPZmZzZXQ/OiBudW1iZXI7XG5cbiAgLy8gLS0tLS0tLS0tLSBPcmllbnRhdGlvbjogQmFyLCBUaWNrLCBMaW5lLCBBcmVhIC0tLS0tLS0tLS1cbiAgLyoqXG4gICAqIFRoZSBvcmllbnRhdGlvbiBvZiBhIG5vbi1zdGFja2VkIGJhciwgdGljaywgYXJlYSwgYW5kIGxpbmUgY2hhcnRzLlxuICAgKiBUaGUgdmFsdWUgaXMgZWl0aGVyIGhvcml6b250YWwgKGRlZmF1bHQpIG9yIHZlcnRpY2FsLlxuICAgKiAtIEZvciBiYXIsIHJ1bGUgYW5kIHRpY2ssIHRoaXMgZGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBzaXplIG9mIHRoZSBiYXIgYW5kIHRpY2tcbiAgICogc2hvdWxkIGJlIGFwcGxpZWQgdG8geCBvciB5IGRpbWVuc2lvbi5cbiAgICogLSBGb3IgYXJlYSwgdGhpcyBwcm9wZXJ0eSBkZXRlcm1pbmVzIHRoZSBvcmllbnQgcHJvcGVydHkgb2YgdGhlIFZlZ2Egb3V0cHV0LlxuICAgKiAtIEZvciBsaW5lIGFuZCB0cmFpbCBtYXJrcywgdGhpcyBwcm9wZXJ0eSBkZXRlcm1pbmVzIHRoZSBzb3J0IG9yZGVyIG9mIHRoZSBwb2ludHMgaW4gdGhlIGxpbmVcbiAgICogaWYgYGNvbmZpZy5zb3J0TGluZUJ5YCBpcyBub3Qgc3BlY2lmaWVkLlxuICAgKiBGb3Igc3RhY2tlZCBjaGFydHMsIHRoaXMgaXMgYWx3YXlzIGRldGVybWluZWQgYnkgdGhlIG9yaWVudGF0aW9uIG9mIHRoZSBzdGFjaztcbiAgICogdGhlcmVmb3JlIGV4cGxpY2l0bHkgc3BlY2lmaWVkIHZhbHVlIHdpbGwgYmUgaWdub3JlZC5cbiAgICovXG4gIG9yaWVudD86IE9yaWVudDtcblxuICAvLyAtLS0tLS0tLS0tIEludGVycG9sYXRpb246IExpbmUgLyBhcmVhIC0tLS0tLS0tLS1cbiAgLyoqXG4gICAqIFRoZSBsaW5lIGludGVycG9sYXRpb24gbWV0aG9kIHRvIHVzZSBmb3IgbGluZSBhbmQgYXJlYSBtYXJrcy4gT25lIG9mIHRoZSBmb2xsb3dpbmc6XG4gICAqIC0gYFwibGluZWFyXCJgOiBwaWVjZXdpc2UgbGluZWFyIHNlZ21lbnRzLCBhcyBpbiBhIHBvbHlsaW5lLlxuICAgKiAtIGBcImxpbmVhci1jbG9zZWRcImA6IGNsb3NlIHRoZSBsaW5lYXIgc2VnbWVudHMgdG8gZm9ybSBhIHBvbHlnb24uXG4gICAqIC0gYFwic3RlcFwiYDogYWx0ZXJuYXRlIGJldHdlZW4gaG9yaXpvbnRhbCBhbmQgdmVydGljYWwgc2VnbWVudHMsIGFzIGluIGEgc3RlcCBmdW5jdGlvbi5cbiAgICogLSBgXCJzdGVwLWJlZm9yZVwiYDogYWx0ZXJuYXRlIGJldHdlZW4gdmVydGljYWwgYW5kIGhvcml6b250YWwgc2VnbWVudHMsIGFzIGluIGEgc3RlcCBmdW5jdGlvbi5cbiAgICogLSBgXCJzdGVwLWFmdGVyXCJgOiBhbHRlcm5hdGUgYmV0d2VlbiBob3Jpem9udGFsIGFuZCB2ZXJ0aWNhbCBzZWdtZW50cywgYXMgaW4gYSBzdGVwIGZ1bmN0aW9uLlxuICAgKiAtIGBcImJhc2lzXCJgOiBhIEItc3BsaW5lLCB3aXRoIGNvbnRyb2wgcG9pbnQgZHVwbGljYXRpb24gb24gdGhlIGVuZHMuXG4gICAqIC0gYFwiYmFzaXMtb3BlblwiYDogYW4gb3BlbiBCLXNwbGluZTsgbWF5IG5vdCBpbnRlcnNlY3QgdGhlIHN0YXJ0IG9yIGVuZC5cbiAgICogLSBgXCJiYXNpcy1jbG9zZWRcImA6IGEgY2xvc2VkIEItc3BsaW5lLCBhcyBpbiBhIGxvb3AuXG4gICAqIC0gYFwiY2FyZGluYWxcImA6IGEgQ2FyZGluYWwgc3BsaW5lLCB3aXRoIGNvbnRyb2wgcG9pbnQgZHVwbGljYXRpb24gb24gdGhlIGVuZHMuXG4gICAqIC0gYFwiY2FyZGluYWwtb3BlblwiYDogYW4gb3BlbiBDYXJkaW5hbCBzcGxpbmU7IG1heSBub3QgaW50ZXJzZWN0IHRoZSBzdGFydCBvciBlbmQsIGJ1dCB3aWxsIGludGVyc2VjdCBvdGhlciBjb250cm9sIHBvaW50cy5cbiAgICogLSBgXCJjYXJkaW5hbC1jbG9zZWRcImA6IGEgY2xvc2VkIENhcmRpbmFsIHNwbGluZSwgYXMgaW4gYSBsb29wLlxuICAgKiAtIGBcImJ1bmRsZVwiYDogZXF1aXZhbGVudCB0byBiYXNpcywgZXhjZXB0IHRoZSB0ZW5zaW9uIHBhcmFtZXRlciBpcyB1c2VkIHRvIHN0cmFpZ2h0ZW4gdGhlIHNwbGluZS5cbiAgICogLSBgXCJtb25vdG9uZVwiYDogY3ViaWMgaW50ZXJwb2xhdGlvbiB0aGF0IHByZXNlcnZlcyBtb25vdG9uaWNpdHkgaW4geS5cbiAgICovXG4gIGludGVycG9sYXRlPzogSW50ZXJwb2xhdGU7XG4gIC8qKlxuICAgKiBEZXBlbmRpbmcgb24gdGhlIGludGVycG9sYXRpb24gdHlwZSwgc2V0cyB0aGUgdGVuc2lvbiBwYXJhbWV0ZXIgKGZvciBsaW5lIGFuZCBhcmVhIG1hcmtzKS5cbiAgICogQG1pbmltdW0gMFxuICAgKiBAbWF4aW11bSAxXG4gICAqL1xuICB0ZW5zaW9uPzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgZGVmYXVsdCBzeW1ib2wgc2hhcGUgdG8gdXNlLiBPbmUgb2Y6IGBcImNpcmNsZVwiYCAoZGVmYXVsdCksIGBcInNxdWFyZVwiYCwgYFwiY3Jvc3NcImAsIGBcImRpYW1vbmRcImAsIGBcInRyaWFuZ2xlLXVwXCJgLCBvciBgXCJ0cmlhbmdsZS1kb3duXCJgLCBvciBhIGN1c3RvbSBTVkcgcGF0aC5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBcImNpcmNsZVwiYFxuICAgKlxuICAgKi9cbiAgc2hhcGU/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBwaXhlbCBhcmVhIGVhY2ggdGhlIHBvaW50L2NpcmNsZS9zcXVhcmUuXG4gICAqIEZvciBleGFtcGxlOiBpbiB0aGUgY2FzZSBvZiBjaXJjbGVzLCB0aGUgcmFkaXVzIGlzIGRldGVybWluZWQgaW4gcGFydCBieSB0aGUgc3F1YXJlIHJvb3Qgb2YgdGhlIHNpemUgdmFsdWUuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgMzBgXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIHNpemU/OiBudW1iZXI7XG5cbiAgLy8gVGV4dCAvIExhYmVsIE1hcmsgQ29uZmlnXG5cbiAgLyoqXG4gICAqIFRoZSBob3Jpem9udGFsIGFsaWdubWVudCBvZiB0aGUgdGV4dC4gT25lIG9mIGBcImxlZnRcImAsIGBcInJpZ2h0XCJgLCBgXCJjZW50ZXJcImAuXG4gICAqL1xuICBhbGlnbj86IEhvcml6b250YWxBbGlnbjtcblxuICAvKipcbiAgICogVGhlIHJvdGF0aW9uIGFuZ2xlIG9mIHRoZSB0ZXh0LCBpbiBkZWdyZWVzLlxuICAgKiBAbWluaW11bSAwXG4gICAqIEBtYXhpbXVtIDM2MFxuICAgKi9cbiAgYW5nbGU/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSB2ZXJ0aWNhbCBhbGlnbm1lbnQgb2YgdGhlIHRleHQuIE9uZSBvZiBgXCJ0b3BcImAsIGBcIm1pZGRsZVwiYCwgYFwiYm90dG9tXCJgLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYFwibWlkZGxlXCJgXG4gICAqXG4gICAqL1xuICBiYXNlbGluZT86IFZlcnRpY2FsQWxpZ247XG5cbiAgLyoqXG4gICAqIFRoZSBob3Jpem9udGFsIG9mZnNldCwgaW4gcGl4ZWxzLCBiZXR3ZWVuIHRoZSB0ZXh0IGxhYmVsIGFuZCBpdHMgYW5jaG9yIHBvaW50LiBUaGUgb2Zmc2V0IGlzIGFwcGxpZWQgYWZ0ZXIgcm90YXRpb24gYnkgdGhlIF9hbmdsZV8gcHJvcGVydHkuXG4gICAqL1xuICBkeD86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIHZlcnRpY2FsIG9mZnNldCwgaW4gcGl4ZWxzLCBiZXR3ZWVuIHRoZSB0ZXh0IGxhYmVsIGFuZCBpdHMgYW5jaG9yIHBvaW50LiBUaGUgb2Zmc2V0IGlzIGFwcGxpZWQgYWZ0ZXIgcm90YXRpb24gYnkgdGhlIF9hbmdsZV8gcHJvcGVydHkuXG4gICAqL1xuICBkeT86IG51bWJlcjtcblxuICAvKipcbiAgICogUG9sYXIgY29vcmRpbmF0ZSByYWRpYWwgb2Zmc2V0LCBpbiBwaXhlbHMsIG9mIHRoZSB0ZXh0IGxhYmVsIGZyb20gdGhlIG9yaWdpbiBkZXRlcm1pbmVkIGJ5IHRoZSBgeGAgYW5kIGB5YCBwcm9wZXJ0aWVzLlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICByYWRpdXM/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBtYXhpbXVtIGxlbmd0aCBvZiB0aGUgdGV4dCBtYXJrIGluIHBpeGVscyAoZGVmYXVsdCAwLCBpbmRpY2F0aW5nIG5vIGxpbWl0KS4gVGhlIHRleHQgdmFsdWUgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IHRydW5jYXRlZCBpZiB0aGUgcmVuZGVyZWQgc2l6ZSBleGNlZWRzIHRoZSBsaW1pdC5cbiAgICovXG4gIGxpbWl0PzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBQb2xhciBjb29yZGluYXRlIGFuZ2xlLCBpbiByYWRpYW5zLCBvZiB0aGUgdGV4dCBsYWJlbCBmcm9tIHRoZSBvcmlnaW4gZGV0ZXJtaW5lZCBieSB0aGUgYHhgIGFuZCBgeWAgcHJvcGVydGllcy4gVmFsdWVzIGZvciBgdGhldGFgIGZvbGxvdyB0aGUgc2FtZSBjb252ZW50aW9uIG9mIGBhcmNgIG1hcmsgYHN0YXJ0QW5nbGVgIGFuZCBgZW5kQW5nbGVgIHByb3BlcnRpZXM6IGFuZ2xlcyBhcmUgbWVhc3VyZWQgaW4gcmFkaWFucywgd2l0aCBgMGAgaW5kaWNhdGluZyBcIm5vcnRoXCIuXG4gICAqL1xuICB0aGV0YT86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIHR5cGVmYWNlIHRvIHNldCB0aGUgdGV4dCBpbiAoZS5nLiwgYFwiSGVsdmV0aWNhIE5ldWVcImApLlxuICAgKi9cbiAgZm9udD86IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIGZvbnQgc2l6ZSwgaW4gcGl4ZWxzLlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBmb250U2l6ZT86IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIGZvbnQgc3R5bGUgKGUuZy4sIGBcIml0YWxpY1wiYCkuXG4gICAqL1xuICBmb250U3R5bGU/OiBGb250U3R5bGU7XG4gIC8qKlxuICAgKiBUaGUgZm9udCB3ZWlnaHQuXG4gICAqIFRoaXMgY2FuIGJlIGVpdGhlciBhIHN0cmluZyAoZS5nIGBcImJvbGRcImAsIGBcIm5vcm1hbFwiYCkgb3IgYSBudW1iZXIgKGAxMDBgLCBgMjAwYCwgYDMwMGAsIC4uLiwgYDkwMGAgd2hlcmUgYFwibm9ybWFsXCJgID0gYDQwMGAgYW5kIGBcImJvbGRcImAgPSBgNzAwYCkuXG4gICAqL1xuICBmb250V2VpZ2h0PzogRm9udFdlaWdodDtcblxuICAvKipcbiAgICogUGxhY2Vob2xkZXIgdGV4dCBpZiB0aGUgYHRleHRgIGNoYW5uZWwgaXMgbm90IHNwZWNpZmllZFxuICAgKi9cbiAgdGV4dD86IHN0cmluZztcblxuICAvKipcbiAgICogQSBVUkwgdG8gbG9hZCB1cG9uIG1vdXNlIGNsaWNrLiBJZiBkZWZpbmVkLCB0aGUgbWFyayBhY3RzIGFzIGEgaHlwZXJsaW5rLlxuICAgKlxuICAgKiBAZm9ybWF0IHVyaVxuICAgKi9cbiAgaHJlZj86IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIG1vdXNlIGN1cnNvciB1c2VkIG92ZXIgdGhlIG1hcmsuIEFueSB2YWxpZCBbQ1NTIGN1cnNvciB0eXBlXShodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9DU1MvY3Vyc29yI1ZhbHVlcykgY2FuIGJlIHVzZWQuXG4gICAqL1xuICBjdXJzb3I/OiAnYXV0bycgfCAnZGVmYXVsdCcgfCAnbm9uZScgfCAnY29udGV4dC1tZW51JyB8ICdoZWxwJyB8ICdwb2ludGVyJyB8ICdwcm9ncmVzcycgfCAnd2FpdCcgfCAnY2VsbCcgfCAnY3Jvc3NoYWlyJyB8ICd0ZXh0JyB8ICd2ZXJ0aWNhbC10ZXh0JyB8ICdhbGlhcycgfCAnY29weScgfCAnbW92ZScgfCAnbm8tZHJvcCcgfCAnbm90LWFsbG93ZWQnIHwgJ2UtcmVzaXplJyB8ICduLXJlc2l6ZScgfCAnbmUtcmVzaXplJyB8ICdudy1yZXNpemUnIHwgJ3MtcmVzaXplJyB8ICdzZS1yZXNpemUnIHwgJ3N3LXJlc2l6ZScgfCAndy1yZXNpemUnIHwgJ2V3LXJlc2l6ZScgfCAnbnMtcmVzaXplJyB8ICduZXN3LXJlc2l6ZScgfCAnbndzZS1yZXNpemUnIHwgJ2NvbC1yZXNpemUnIHwgJ3Jvdy1yZXNpemUnIHwgJ2FsbC1zY3JvbGwnIHwgJ3pvb20taW4nIHwgJ3pvb20tb3V0JyB8ICdncmFiJyB8ICdncmFiYmluZyc7XG59XG5cbmNvbnN0IFZHX01BUktfQ09ORklHX0lOREVYOiBGbGFnPGtleW9mIFZnTWFya0NvbmZpZz4gPSB7XG4gIG9wYWNpdHk6IDEsXG4gIGZpbGw6IDEsXG4gIGZpbGxPcGFjaXR5OiAxLFxuICBzdHJva2U6IDEsXG4gIHN0cm9rZUNhcDogMSxcbiAgc3Ryb2tlV2lkdGg6IDEsXG4gIHN0cm9rZU9wYWNpdHk6IDEsXG4gIHN0cm9rZURhc2g6IDEsXG4gIHN0cm9rZURhc2hPZmZzZXQ6IDEsXG4gIHNpemU6IDEsXG4gIHNoYXBlOiAxLFxuICBpbnRlcnBvbGF0ZTogMSxcbiAgdGVuc2lvbjogMSxcbiAgb3JpZW50OiAxLFxuICBhbGlnbjogMSxcbiAgYmFzZWxpbmU6IDEsXG4gIHRleHQ6IDEsXG4gIGxpbWl0OiAxLFxuICBkeDogMSxcbiAgZHk6IDEsXG4gIHJhZGl1czogMSxcbiAgdGhldGE6IDEsXG4gIGFuZ2xlOiAxLFxuICBmb250OiAxLFxuICBmb250U2l6ZTogMSxcbiAgZm9udFdlaWdodDogMSxcbiAgZm9udFN0eWxlOiAxLFxuICBjdXJzb3I6IDEsXG4gIGhyZWY6IDEsXG4gIC8vIGNvbW1lbnRlZCBiZWxvdyBhcmUgdmcgY2hhbm5lbCB0aGF0IGRvIG5vdCBoYXZlIG1hcmsgY29uZmlnLlxuICAvLyAneCd8J3gyJ3wneGMnfCd3aWR0aCd8J3knfCd5Mid8J3ljJ3wnaGVpZ2h0J1xuICAvLyBjbGlwOiAxLFxuICAvLyBkaXI6IDEsXG4gIC8vIGVsbGlwc2lzOiAxLFxuICAvLyBlbmRBbmdsZTogMSxcbiAgLy8gaW5uZXJSYWRpdXM6IDEsXG4gIC8vIG91dGVyUmFkaXVzOiAxLFxuICAvLyBwYXRoOiAxLFxuICAvLyBzdGFydEFuZ2xlOiAxLFxuICAvLyB1cmw6IDEsXG59O1xuXG5leHBvcnQgY29uc3QgVkdfTUFSS19DT05GSUdTID0gZmxhZ0tleXMoVkdfTUFSS19DT05GSUdfSU5ERVgpO1xuXG5leHBvcnQgdHlwZSBBbmNob3IgPSAnc3RhcnQnIHwgJ21pZGRsZScgfCAnZW5kJztcblxuZXhwb3J0IGludGVyZmFjZSBWZ1RpdGxlIHtcbiAgLyoqXG4gICAqIFRoZSB0aXRsZSB0ZXh0LlxuICAgKi9cbiAgdGV4dDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgb3JpZW50YXRpb24gb2YgdGhlIHRpdGxlIHJlbGF0aXZlIHRvIHRoZSBjaGFydC4gT25lIG9mIGBcInRvcFwiYCAodGhlIGRlZmF1bHQpLCBgXCJib3R0b21cImAsIGBcImxlZnRcImAsIG9yIGBcInJpZ2h0XCJgLlxuICAgKi9cbiAgb3JpZW50PzogVGl0bGVPcmllbnQ7XG5cbiAgLyoqXG4gICAqIFRoZSBhbmNob3IgcG9zaXRpb24gZm9yIHBsYWNpbmcgdGhlIHRpdGxlLiBPbmUgb2YgYFwic3RhcnRcImAsIGBcIm1pZGRsZVwiYCAodGhlIGRlZmF1bHQpLCBvciBgXCJlbmRcImAuIEZvciBleGFtcGxlLCB3aXRoIGFuIG9yaWVudGF0aW9uIG9mIHRvcCB0aGVzZSBhbmNob3IgcG9zaXRpb25zIG1hcCB0byBhIGxlZnQtLCBjZW50ZXItLCBvciByaWdodC1hbGlnbmVkIHRpdGxlLlxuICAgKi9cbiAgYW5jaG9yPzogQW5jaG9yO1xuXG4gIC8qKlxuICAgKiBUaGUgb3J0aG9nb25hbCBvZmZzZXQgaW4gcGl4ZWxzIGJ5IHdoaWNoIHRvIGRpc3BsYWNlIHRoZSB0aXRsZSBmcm9tIGl0cyBwb3NpdGlvbiBhbG9uZyB0aGUgZWRnZSBvZiB0aGUgY2hhcnQuXG4gICAqL1xuICBvZmZzZXQ/OiBudW1iZXI7XG5cbiAgc3R5bGU/OiBzdHJpbmcgfCBzdHJpbmdbXTtcblxuICAvLyBUT0RPOiBuYW1lLCBlbmNvZGUsIGludGVyYWN0aXZlLCB6aW5kZXhcbn1cblxuZXhwb3J0IHR5cGUgVGl0bGVPcmllbnQgPSAndG9wJyB8ICdib3R0b20nIHwgJ2xlZnQnIHwgJ3JpZ2h0JztcblxuZXhwb3J0IGludGVyZmFjZSBWZ1RpdGxlQ29uZmlnIHtcbiAgLyoqXG4gICAqIFRoZSBhbmNob3IgcG9zaXRpb24gZm9yIHBsYWNpbmcgdGhlIHRpdGxlLiBPbmUgb2YgYFwic3RhcnRcImAsIGBcIm1pZGRsZVwiYCwgb3IgYFwiZW5kXCJgLiBGb3IgZXhhbXBsZSwgd2l0aCBhbiBvcmllbnRhdGlvbiBvZiB0b3AgdGhlc2UgYW5jaG9yIHBvc2l0aW9ucyBtYXAgdG8gYSBsZWZ0LSwgY2VudGVyLSwgb3IgcmlnaHQtYWxpZ25lZCB0aXRsZS5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBcIm1pZGRsZVwiYCBmb3IgW3NpbmdsZV0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9zcGVjLmh0bWwpIGFuZCBbbGF5ZXJlZF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9sYXllci5odG1sKSB2aWV3cy5cbiAgICogYFwic3RhcnRcImAgZm9yIG90aGVyIGNvbXBvc2l0ZSB2aWV3cy5cbiAgICpcbiAgICogX19Ob3RlOl9fIFtGb3Igbm93XShodHRwczovL2dpdGh1Yi5jb20vdmVnYS92ZWdhLWxpdGUvaXNzdWVzLzI4NzUpLCBgYW5jaG9yYCBpcyBvbmx5IGN1c3RvbWl6YWJsZSBvbmx5IGZvciBbc2luZ2xlXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3NwZWMuaHRtbCkgYW5kIFtsYXllcmVkXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL2xheWVyLmh0bWwpIHZpZXdzLiAgRm9yIG90aGVyIGNvbXBvc2l0ZSB2aWV3cywgYGFuY2hvcmAgaXMgYWx3YXlzIGBcInN0YXJ0XCJgLlxuICAgKi9cbiAgYW5jaG9yPzogQW5jaG9yO1xuICAvKipcbiAgICogQW5nbGUgaW4gZGVncmVlcyBvZiB0aXRsZSB0ZXh0LlxuICAgKi9cbiAgYW5nbGU/Olx0bnVtYmVyO1xuICAvKipcbiAgICogVmVydGljYWwgdGV4dCBiYXNlbGluZSBmb3IgdGl0bGUgdGV4dC5cbiAgICovXG4gIGJhc2VsaW5lPzogVmVydGljYWxBbGlnbjtcbiAgLyoqXG4gICAqIFRleHQgY29sb3IgZm9yIHRpdGxlIHRleHQuXG4gICAqL1xuICBjb2xvcj86XHRzdHJpbmc7XG4gIC8qKlxuICAgKiBGb250IG5hbWUgZm9yIHRpdGxlIHRleHQuXG4gICAqL1xuICBmb250PzpcdHN0cmluZztcbiAgLyoqXG4gICAqIEZvbnQgc2l6ZSBpbiBwaXhlbHMgZm9yIHRpdGxlIHRleHQuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgMTBgLlxuICAgKlxuICAgKiBAbWluaW11bSAwXG4gICAqL1xuICBmb250U2l6ZT86XHRudW1iZXI7XG4gIC8qKlxuICAgKiBGb250IHdlaWdodCBmb3IgdGl0bGUgdGV4dC5cbiAgICogVGhpcyBjYW4gYmUgZWl0aGVyIGEgc3RyaW5nIChlLmcgYFwiYm9sZFwiYCwgYFwibm9ybWFsXCJgKSBvciBhIG51bWJlciAoYDEwMGAsIGAyMDBgLCBgMzAwYCwgLi4uLCBgOTAwYCB3aGVyZSBgXCJub3JtYWxcImAgPSBgNDAwYCBhbmQgYFwiYm9sZFwiYCA9IGA3MDBgKS5cbiAgICovXG4gIGZvbnRXZWlnaHQ/OiBGb250V2VpZ2h0O1xuICAvKipcbiAgICogVGhlIG1heGltdW0gYWxsb3dlZCBsZW5ndGggaW4gcGl4ZWxzIG9mIGxlZ2VuZCBsYWJlbHMuXG4gICAqXG4gICAqIEBtaW5pbXVtIDBcbiAgICovXG4gIGxpbWl0PzpcdG51bWJlcjtcbiAgLyoqXG4gICAqIE9mZnNldCBpbiBwaXhlbHMgb2YgdGhlIHRpdGxlIGZyb20gdGhlIGNoYXJ0IGJvZHkgYW5kIGF4ZXMuXG4gICAqL1xuICBvZmZzZXQ/Olx0bnVtYmVyO1xuICAvKipcbiAgICogRGVmYXVsdCB0aXRsZSBvcmllbnRhdGlvbiAoXCJ0b3BcIiwgXCJib3R0b21cIiwgXCJsZWZ0XCIsIG9yIFwicmlnaHRcIilcbiAgICovXG4gIG9yaWVudD86IFRpdGxlT3JpZW50O1xufVxuXG5leHBvcnQgdHlwZSBWZ0NvbXBhcmF0b3JPcmRlciA9ICdhc2NlbmRpbmcnIHwgJ2Rlc2NlbmRpbmcnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFZnQ29tcGFyYXRvciB7XG4gIGZpZWxkPzogc3RyaW5nIHwgc3RyaW5nW107XG4gIG9yZGVyPzogVmdDb21wYXJhdG9yT3JkZXIgfCBWZ0NvbXBhcmF0b3JPcmRlcltdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZnV2luZG93VHJhbnNmb3JtIHtcbiAgdHlwZTogJ3dpbmRvdyc7XG4gIHBhcmFtcz86IE51bWJlcltdO1xuICBhcz86IHN0cmluZ1tdO1xuICBvcHM/OiAoQWdncmVnYXRlT3AgfCBXaW5kb3dPbmx5T3ApW107XG4gIGZpZWxkcz86IHN0cmluZ1tdO1xuICBmcmFtZT86IE51bWJlcltdO1xuICBpZ25vcmVQZWVycz86IEJvb2xlYW47XG4gIGdyb3VwYnk/OiBzdHJpbmdbXTtcbiAgc29ydD86IFZnQ29tcGFyYXRvcjtcbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { isArray } from 'vega-util';\nimport { AXIS_PARTS, AXIS_PROPERTY_TYPE } from '../../axis';\nimport { title as fieldDefTitle } from '../../fielddef';\nimport { keys } from '../../util';\nfunction assembleTitle(title, config) {\n    if (isArray(title)) {\n        return title.map(function (fieldDef) { return fieldDefTitle(fieldDef, config); }).join(', ');\n    }\n    return title;\n}\nexport function assembleAxis(axisCmpt, kind, config, opt) {\n    if (opt === void 0) { opt = { header: false }; }\n    var _a = axisCmpt.combine(), orient = _a.orient, scale = _a.scale, title = _a.title, zindex = _a.zindex, axis = tslib_1.__rest(_a, [\"orient\", \"scale\", \"title\", \"zindex\"]);\n    // Remove properties that are not valid for this kind of axis\n    keys(axis).forEach(function (key) {\n        var propType = AXIS_PROPERTY_TYPE[key];\n        if (propType && propType !== kind && propType !== 'both') {\n            delete axis[key];\n        }\n    });\n    if (kind === 'grid') {\n        if (!axis.grid) {\n            return undefined;\n        }\n        // Remove unnecessary encode block\n        if (axis.encode) {\n            // Only need to keep encode block for grid\n            var grid = axis.encode.grid;\n            axis.encode = tslib_1.__assign({}, (grid ? { grid: grid } : {}));\n            if (keys(axis.encode).length === 0) {\n                delete axis.encode;\n            }\n        }\n        return tslib_1.__assign({ scale: scale,\n            orient: orient }, axis, { domain: false, labels: false, \n            // Always set min/maxExtent to 0 to ensure that `config.axis*.minExtent` and `config.axis*.maxExtent`\n            // would not affect gridAxis\n            maxExtent: 0, minExtent: 0, ticks: false, zindex: zindex !== undefined ? zindex : 0 // put grid behind marks by default\n         });\n    }\n    else { // kind === 'main'\n        if (!opt.header && axisCmpt.mainExtracted) {\n            // if mainExtracted has been extracted to a separate facet\n            return undefined;\n        }\n        // Remove unnecessary encode block\n        if (axis.encode) {\n            for (var _i = 0, AXIS_PARTS_1 = AXIS_PARTS; _i < AXIS_PARTS_1.length; _i++) {\n                var part = AXIS_PARTS_1[_i];\n                if (!axisCmpt.hasAxisPart(part)) {\n                    delete axis.encode[part];\n                }\n            }\n            if (keys(axis.encode).length === 0) {\n                delete axis.encode;\n            }\n        }\n        var titleString = assembleTitle(title, config);\n        return tslib_1.__assign({ scale: scale,\n            orient: orient, grid: false }, (titleString ? { title: titleString } : {}), axis, { zindex: zindex !== undefined ? zindex : 1 // put axis line above marks by default\n         });\n    }\n}\nexport function assembleAxes(axisComponents, config) {\n    var _a = axisComponents.x, x = _a === void 0 ? [] : _a, _b = axisComponents.y, y = _b === void 0 ? [] : _b;\n    return x.map(function (a) { return assembleAxis(a, 'main', config); }).concat(x.map(function (a) { return assembleAxis(a, 'grid', config); }), y.map(function (a) { return assembleAxis(a, 'main', config); }), y.map(function (a) { return assembleAxis(a, 'grid', config); })).filter(function (a) { return a; }); // filter undefined\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXNzZW1ibGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9heGlzL2Fzc2VtYmxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUMsT0FBTyxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBRWxDLE9BQU8sRUFBQyxVQUFVLEVBQUUsa0JBQWtCLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFFMUQsT0FBTyxFQUFlLEtBQUssSUFBSSxhQUFhLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUNwRSxPQUFPLEVBQUMsSUFBSSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBSWhDLHVCQUF1QixLQUFzQyxFQUFFLE1BQWM7SUFDM0UsSUFBSSxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUU7UUFDbEIsT0FBTyxLQUFLLENBQUMsR0FBRyxDQUFDLFVBQUEsUUFBUSxJQUFJLE9BQUEsYUFBYSxDQUFDLFFBQVEsRUFBRSxNQUFNLENBQUMsRUFBL0IsQ0FBK0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUMxRTtJQUNELE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQUVELE1BQU0sdUJBQ0osUUFBdUIsRUFDdkIsSUFBcUIsRUFDckIsTUFBYyxFQUNkLEdBRW1CO0lBRm5CLG9CQUFBLEVBQUEsUUFFSyxNQUFNLEVBQUUsS0FBSyxFQUFDO0lBRW5CLElBQU0sdUJBQTRELEVBQTNELGtCQUFNLEVBQUUsZ0JBQUssRUFBRSxnQkFBSyxFQUFFLGtCQUFNLEVBQUUsaUVBQTZCLENBQUM7SUFFbkUsNkRBQTZEO0lBQzdELElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBQyxHQUFHO1FBQ3JCLElBQU0sUUFBUSxHQUFHLGtCQUFrQixDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3pDLElBQUksUUFBUSxJQUFJLFFBQVEsS0FBSyxJQUFJLElBQUksUUFBUSxLQUFLLE1BQU0sRUFBRTtZQUN4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LElBQUksT0FBQSxZQUFZLENBQUMsQ0FBQyxFQUFFLE1BQU0sRUFBRSxNQUFNLENBQUMsRUFBL0IsQ0FBK0IsQ0FBQyxFQUMzQyxDQUFDLENBQUMsR0FBRyxDQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsWUFBWSxDQUFDLENBQUMsRUFBRSxNQUFNLEVBQUUsTUFBTSxDQUFDLEVBQS9CLENBQStCLENBQUMsRUFDOUMsTUFBTSxDQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxFQUFELENBQUMsQ0FBQyxDQUFDLENBQUMsbUJBQW1CO0FBQ3ZDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2lzQXJyYXl9IGZyb20gJ3ZlZ2EtdXRpbCc7XG5cbmltcG9ydCB7QVhJU19QQVJUUywgQVhJU19QUk9QRVJUWV9UWVBFfSBmcm9tICcuLi8uLi9heGlzJztcbmltcG9ydCB7Q29uZmlnfSBmcm9tICcuLi8uLi9jb25maWcnO1xuaW1wb3J0IHtGaWVsZERlZkJhc2UsIHRpdGxlIGFzIGZpZWxkRGVmVGl0bGV9IGZyb20gJy4uLy4uL2ZpZWxkZGVmJztcbmltcG9ydCB7a2V5c30gZnJvbSAnLi4vLi4vdXRpbCc7XG5pbXBvcnQge1ZnQXhpc30gZnJvbSAnLi4vLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtBeGlzQ29tcG9uZW50LCBBeGlzQ29tcG9uZW50SW5kZXh9IGZyb20gJy4vY29tcG9uZW50JztcblxuZnVuY3Rpb24gYXNzZW1ibGVUaXRsZSh0aXRsZTogc3RyaW5nIHwgRmllbGREZWZCYXNlPHN0cmluZz5bXSwgY29uZmlnOiBDb25maWcpIHtcbiAgaWYgKGlzQXJyYXkodGl0bGUpKSB7XG4gICAgcmV0dXJuIHRpdGxlLm1hcChmaWVsZERlZiA9PiBmaWVsZERlZlRpdGxlKGZpZWxkRGVmLCBjb25maWcpKS5qb2luKCcsICcpO1xuICB9XG4gIHJldHVybiB0aXRsZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VtYmxlQXhpcyhcbiAgYXhpc0NtcHQ6IEF4aXNDb21wb25lbnQsXG4gIGtpbmQ6ICdtYWluJyB8ICdncmlkJyxcbiAgY29uZmlnOiBDb25maWcsXG4gIG9wdDoge1xuICAgIGhlYWRlcjogYm9vbGVhbiAvLyB3aGV0aGVyIHRoaXMgaXMgY2FsbGVkIHZpYSBhIGhlYWRlclxuICB9ID0ge2hlYWRlcjogZmFsc2V9XG4pOiBWZ0F4aXMge1xuICBjb25zdCB7b3JpZW50LCBzY2FsZSwgdGl0bGUsIHppbmRleCwgLi4uYXhpc30gPSBheGlzQ21wdC5jb21iaW5lKCk7XG5cbiAgLy8gUmVtb3ZlIHByb3BlcnRpZXMgdGhhdCBhcmUgbm90IHZhbGlkIGZvciB0aGlzIGtpbmQgb2YgYXhpc1xuICBrZXlzKGF4aXMpLmZvckVhY2goKGtleSkgPT4ge1xuICAgIGNvbnN0IHByb3BUeXBlID0gQVhJU19QUk9QRVJUWV9UWVBFW2tleV07XG4gICAgaWYgKHByb3BUeXBlICYmIHByb3BUeXBlICE9PSBraW5kICYmIHByb3BUeXBlICE9PSAnYm90aCcpIHtcbiAgICAgIGRlbGV0ZSBheGlzW2tleV07XG4gICAgfVxuICB9KTtcblxuICBpZiAoa2luZCA9PT0gJ2dyaWQnKSB7XG4gICAgaWYgKCFheGlzLmdyaWQpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgLy8gUmVtb3ZlIHVubmVjZXNzYXJ5IGVuY29kZSBibG9ja1xuICAgIGlmIChheGlzLmVuY29kZSkge1xuICAgICAgLy8gT25seSBuZWVkIHRvIGtlZXAgZW5jb2RlIGJsb2NrIGZvciBncmlkXG4gICAgICBjb25zdCB7Z3JpZH0gPSBheGlzLmVuY29kZTtcbiAgICAgIGF4aXMuZW5jb2RlID0ge1xuICAgICAgICAuLi4oZ3JpZCA/IHtncmlkfSA6IHt9KVxuICAgICAgfTtcblxuICAgICAgaWYgKGtleXMoYXhpcy5lbmNvZGUpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBkZWxldGUgYXhpcy5lbmNvZGU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHNjYWxlLFxuICAgICAgb3JpZW50LFxuICAgICAgLi4uYXhpcyxcbiAgICAgIGRvbWFpbjogZmFsc2UsXG4gICAgICBsYWJlbHM6IGZhbHNlLFxuXG4gICAgICAvLyBBbHdheXMgc2V0IG1pbi9tYXhFeHRlbnQgdG8gMCB0byBlbnN1cmUgdGhhdCBgY29uZmlnLmF4aXMqLm1pbkV4dGVudGAgYW5kIGBjb25maWcuYXhpcyoubWF4RXh0ZW50YFxuICAgICAgLy8gd291bGQgbm90IGFmZmVjdCBncmlkQXhpc1xuICAgICAgbWF4RXh0ZW50OiAwLFxuICAgICAgbWluRXh0ZW50OiAwLFxuICAgICAgdGlja3M6IGZhbHNlLFxuICAgICAgemluZGV4OiB6aW5kZXggIT09IHVuZGVmaW5lZCA/IHppbmRleCA6IDAgLy8gcHV0IGdyaWQgYmVoaW5kIG1hcmtzIGJ5IGRlZmF1bHRcbiAgICB9O1xuICB9IGVsc2UgeyAvLyBraW5kID09PSAnbWFpbidcblxuICAgIGlmICghb3B0LmhlYWRlciAmJiBheGlzQ21wdC5tYWluRXh0cmFjdGVkKSB7XG4gICAgICAvLyBpZiBtYWluRXh0cmFjdGVkIGhhcyBiZWVuIGV4dHJhY3RlZCB0byBhIHNlcGFyYXRlIGZhY2V0XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIC8vIFJlbW92ZSB1bm5lY2Vzc2FyeSBlbmNvZGUgYmxvY2tcbiAgICBpZiAoYXhpcy5lbmNvZGUpIHtcbiAgICAgIGZvciAoY29uc3QgcGFydCBvZiBBWElTX1BBUlRTKSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAhYXhpc0NtcHQuaGFzQXhpc1BhcnQocGFydClcbiAgICAgICAgKSB7XG4gICAgICAgICAgZGVsZXRlIGF4aXMuZW5jb2RlW3BhcnRdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoa2V5cyhheGlzLmVuY29kZSkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGRlbGV0ZSBheGlzLmVuY29kZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCB0aXRsZVN0cmluZyA9IGFzc2VtYmxlVGl0bGUodGl0bGUsIGNvbmZpZyk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc2NhbGUsXG4gICAgICBvcmllbnQsXG4gICAgICBncmlkOiBmYWxzZSxcbiAgICAgIC4uLih0aXRsZVN0cmluZyA/IHt0aXRsZTogdGl0bGVTdHJpbmd9IDoge30pLFxuICAgICAgLi4uYXhpcyxcbiAgICAgIHppbmRleDogemluZGV4ICE9PSB1bmRlZmluZWQgPyB6aW5kZXggOiAxIC8vIHB1dCBheGlzIGxpbmUgYWJvdmUgbWFya3MgYnkgZGVmYXVsdFxuICAgIH07XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VtYmxlQXhlcyhheGlzQ29tcG9uZW50czogQXhpc0NvbXBvbmVudEluZGV4LCBjb25maWc6IENvbmZpZyk6IFZnQXhpc1tdIHtcbiAgY29uc3Qge3g9W10sIHk9W119ID0gYXhpc0NvbXBvbmVudHM7XG4gIHJldHVybiBbXG4gICAgLi4ueC5tYXAoYSA9PiBhc3NlbWJsZUF4aXMoYSwgJ21haW4nLCBjb25maWcpKSxcbiAgICAuLi54Lm1hcChhID0+IGFzc2VtYmxlQXhpcyhhLCAnZ3JpZCcsIGNvbmZpZykpLFxuICAgIC4uLnkubWFwKGEgPT4gYXNzZW1ibGVBeGlzKGEsICdtYWluJywgY29uZmlnKSksXG4gICAgLi4ueS5tYXAoYSA9PiBhc3NlbWJsZUF4aXMoYSwgJ2dyaWQnLCBjb25maWcpKVxuICBdLmZpbHRlcihhID0+IGEpOyAvLyBmaWx0ZXIgdW5kZWZpbmVkXG59XG4iXX0=","import * as tslib_1 from \"tslib\";\n/**\n * Utility files for producing Vega ValueRef for marks\n */\nimport { isArray, isString } from 'vega-util';\nimport { X, Y } from '../../channel';\nimport { isFieldDef, isValueDef, vgField, } from '../../fielddef';\nimport * as log from '../../log';\nimport { hasDiscreteDomain, ScaleType } from '../../scale';\nimport { QUANTITATIVE } from '../../type';\nimport { contains, some } from '../../util';\nimport { binRequiresRange, formatSignalRef } from '../common';\n// TODO: we need to find a way to refactor these so that scaleName is a part of scale\n// but that's complicated.  For now, this is a huge step moving forward.\n/**\n * @return Vega ValueRef for stackable x or y\n */\nexport function stackable(channel, channelDef, scaleName, scale, stack, defaultRef) {\n    if (isFieldDef(channelDef) && stack && channel === stack.fieldChannel) {\n        // x or y use stack_end so that stacked line's point mark use stack_end too.\n        return fieldRef(channelDef, scaleName, { suffix: 'end' });\n    }\n    return midPoint(channel, channelDef, scaleName, scale, stack, defaultRef);\n}\n/**\n * @return Vega ValueRef for stackable x2 or y2\n */\nexport function stackable2(channel, aFieldDef, a2fieldDef, scaleName, scale, stack, defaultRef) {\n    if (isFieldDef(aFieldDef) && stack &&\n        // If fieldChannel is X and channel is X2 (or Y and Y2)\n        channel.charAt(0) === stack.fieldChannel.charAt(0)) {\n        return fieldRef(aFieldDef, scaleName, { suffix: 'start' });\n    }\n    return midPoint(channel, a2fieldDef, scaleName, scale, stack, defaultRef);\n}\nexport function getOffset(channel, markDef) {\n    var offsetChannel = channel + 'Offset';\n    // TODO: in the future read from encoding channel too\n    var markDefOffsetValue = markDef[offsetChannel];\n    if (markDefOffsetValue) {\n        return markDefOffsetValue;\n    }\n    return undefined;\n}\n/**\n * Value Ref for binned fields\n */\nexport function bin(fieldDef, scaleName, side, offset) {\n    var binSuffix = side === 'start' ? undefined : 'end';\n    return fieldRef(fieldDef, scaleName, { binSuffix: binSuffix }, offset ? { offset: offset } : {});\n}\nexport function fieldRef(fieldDef, scaleName, opt, mixins) {\n    var ref = tslib_1.__assign({}, (scaleName ? { scale: scaleName } : {}), { field: vgField(fieldDef, opt) });\n    if (mixins) {\n        return tslib_1.__assign({}, ref, mixins);\n    }\n    return ref;\n}\nexport function bandRef(scaleName, band) {\n    if (band === void 0) { band = true; }\n    return {\n        scale: scaleName,\n        band: band\n    };\n}\n/**\n * Signal that returns the middle of a bin. Should only be used with x and y.\n */\nfunction binMidSignal(fieldDef, scaleName) {\n    return {\n        signal: \"(\" +\n            (\"scale(\\\"\" + scaleName + \"\\\", \" + vgField(fieldDef, { expr: 'datum' }) + \")\") +\n            \" + \" +\n            (\"scale(\\\"\" + scaleName + \"\\\", \" + vgField(fieldDef, { binSuffix: 'end', expr: 'datum' }) + \")\") +\n            \")/2\"\n    };\n}\n/**\n * @returns {VgValueRef} Value Ref for xc / yc or mid point for other channels.\n */\nexport function midPoint(channel, channelDef, scaleName, scale, stack, defaultRef) {\n    // TODO: datum support\n    if (channelDef) {\n        /* istanbul ignore else */\n        if (isFieldDef(channelDef)) {\n            if (channelDef.bin) {\n                // Use middle only for x an y to place marks in the center between start and end of the bin range.\n                // We do not use the mid point for other channels (e.g. size) so that properties of legends and marks match.\n                if (contains([X, Y], channel) && channelDef.type === QUANTITATIVE) {\n                    if (stack && stack.impute) {\n                        // For stack, we computed bin_mid so we can impute.\n                        return fieldRef(channelDef, scaleName, { binSuffix: 'mid' });\n                    }\n                    // For non-stack, we can just calculate bin mid on the fly using signal.\n                    return binMidSignal(channelDef, scaleName);\n                }\n                return fieldRef(channelDef, scaleName, binRequiresRange(channelDef, channel) ? { binSuffix: 'range' } : {});\n            }\n            if (scale) {\n                var scaleType = scale.get('type');\n                if (hasDiscreteDomain(scaleType)) {\n                    if (scaleType === 'band') {\n                        // For band, to get mid point, need to offset by half of the band\n                        return fieldRef(channelDef, scaleName, { binSuffix: 'range' }, { band: 0.5 });\n                    }\n                    return fieldRef(channelDef, scaleName, { binSuffix: 'range' });\n                }\n            }\n            return fieldRef(channelDef, scaleName, {}); // no need for bin suffix\n        }\n        else if (isValueDef(channelDef)) {\n            var value = channelDef.value;\n            if (contains(['x', 'x2'], channel) && value === 'width') {\n                return { field: { group: 'width' } };\n            }\n            else if (contains(['y', 'y2'], channel) && value === 'height') {\n                return { field: { group: 'height' } };\n            }\n            return { value: value };\n        }\n        // If channelDef is neither field def or value def, it's a condition-only def.\n        // In such case, we will use default ref.\n    }\n    return defaultRef;\n}\nexport function text(textDef, config) {\n    // text\n    if (textDef) {\n        if (isFieldDef(textDef)) {\n            return formatSignalRef(textDef, textDef.format, 'datum', config);\n        }\n        else if (isValueDef(textDef)) {\n            return { value: textDef.value };\n        }\n    }\n    return undefined;\n}\nexport function mid(sizeRef) {\n    return tslib_1.__assign({}, sizeRef, { mult: 0.5 });\n}\n/**\n * Whether the scale definitely includes zero in the domain\n */\nfunction domainDefinitelyIncludeZero(scale) {\n    if (scale.get('zero') !== false) {\n        return true;\n    }\n    var domains = scale.domains;\n    if (isArray(domains)) {\n        return some(domains, function (d) { return isArray(d) && d.length === 2 && d[0] <= 0 && d[1] >= 0; });\n    }\n    return false;\n}\nexport function getDefaultRef(defaultRef, channel, scaleName, scale, mark) {\n    if (isString(defaultRef)) {\n        if (scaleName) {\n            var scaleType = scale.get('type');\n            if (contains([ScaleType.LOG, ScaleType.TIME, ScaleType.UTC], scaleType)) {\n                // Log scales cannot have zero.\n                // Zero in time scale is arbitrary, and does not affect ratio.\n                // (Time is an interval level of measurement, not ratio).\n                // See https://en.wikipedia.org/wiki/Level_of_measurement for more info.\n                if (mark === 'bar' || mark === 'area') {\n                    log.warn(log.message.nonZeroScaleUsedWithLengthMark(mark, channel, { scaleType: scaleType }));\n                }\n            }\n            else {\n                if (domainDefinitelyIncludeZero(scale)) {\n                    return {\n                        scale: scaleName,\n                        value: 0\n                    };\n                }\n                if (mark === 'bar' || mark === 'area') {\n                    log.warn(log.message.nonZeroScaleUsedWithLengthMark(mark, channel, { zeroFalse: scale.explicit.zero === false }));\n                }\n            }\n        }\n        if (defaultRef === 'zeroOrMin') {\n            return channel === 'x' ? { value: 0 } : { field: { group: 'height' } };\n        }\n        else { // zeroOrMax\n            return channel === 'x' ? { field: { group: 'width' } } : { value: 0 };\n        }\n    }\n    return defaultRef;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsdWVyZWYuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9tYXJrL3ZhbHVlcmVmLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRztBQUNILE9BQU8sRUFBQyxPQUFPLEVBQUUsUUFBUSxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBRTVDLE9BQU8sRUFBVSxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBRTVDLE9BQU8sRUFLTCxVQUFVLEVBQ1YsVUFBVSxFQUVWLE9BQU8sR0FDUixNQUFNLGdCQUFnQixDQUFDO0FBQ3hCLE9BQU8sS0FBSyxHQUFHLE1BQU0sV0FBVyxDQUFDO0FBRWpDLE9BQU8sRUFBQyxpQkFBaUIsRUFBRSxTQUFTLEVBQUMsTUFBTSxhQUFhLENBQUM7QUFFekQsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLFlBQVksQ0FBQztBQUN4QyxPQUFPLEVBQUMsUUFBUSxFQUFFLElBQUksRUFBQyxNQUFNLFlBQVksQ0FBQztBQUUxQyxPQUFPLEVBQUMsZ0JBQWdCLEVBQUUsZUFBZSxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBSTVELHFGQUFxRjtBQUNyRix3RUFBd0U7QUFFeEU7O0dBRUc7QUFDSCxNQUFNLG9CQUFvQixPQUFrQixFQUFFLFVBQThCLEVBQUUsU0FBaUIsRUFBRSxLQUFxQixFQUNsSCxLQUFzQixFQUFFLFVBQXNCO0lBQ2hELElBQUksVUFBVSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEtBQUssSUFBSSxPQUFPLEtBQUssS0FBSyxDQUFDLFlBQVksRUFBRTtRQUNyRSw0RUFBNEU7UUFDNUUsT0FBTyxRQUFRLENBQUMsVUFBVSxFQUFFLFNBQVMsRUFBRSxFQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUMsQ0FBQyxDQUFDO0tBQ3pEO0lBQ0QsT0FBTyxRQUFRLENBQUMsT0FBTyxFQUFFLFVBQVUsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxVQUFV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QyxPQUFPLENBQUMsOEJBQThCLENBQUMsSUFBSSxFQUFFLE9BQU8sRUFBRSxFQUFDLFNBQVMsV0FBQSxFQUFDLENBQUMsQ0FBQyxDQUFDO2lCQUNsRjthQUNGO2lCQUFNO2dCQUNMLElBQUksMkJBQTJCLENBQUMsS0FBSyxDQUFDLEVBQUU7b0JBQ3RDLE9BQU87d0JBQ0wsS0FBSyxFQUFFLFNBQVM7d0JBQ2hCLEtBQUssRUFBRSxDQUFDO3FCQUNULENBQUM7aUJBQ0g7Z0JBQ0QsSUFBSSxJQUFJLEtBQUssS0FBSyxJQUFJLElBQUksS0FBSyxNQUFNLEVBQUU7b0JBQ3JDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyw4QkFBOEIsQ0FDakQsSUFBSSxFQUFFLE9BQU8sRUFBRSxFQUFDLFNBQVMsRUFBRSxLQUFLLENBQUMsUUFBUSxDQUFDLElBQUksS0FBSyxLQUFLLEVBQUMsQ0FDMUQsQ0FBQyxDQUFDO2lCQUNKO2FBQ0Y7U0FDRjtRQUVELElBQUksVUFBVSxLQUFLLFdBQVcsRUFBRTtZQUM5QixPQUFPLE9BQU8sS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUMsS0FBSyxFQUFFLENBQUMsRUFBQyxDQUFDLENBQUMsQ0FBQyxFQUFDLEtBQUssRUFBRSxFQUFDLEtBQUssRUFBRSxRQUFRLEVBQUMsRUFBQyxDQUFDO1NBQ2xFO2FBQU0sRUFBRSxZQUFZO1lBQ25CLE9BQU8sT0FBTyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBQyxLQUFLLEVBQUUsRUFBQyxLQUFLLEVBQUUsT0FBTyxFQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUMsRUFBQyxLQUFLLEVBQUUsQ0FBQyxFQUFDLENBQUM7U0FDakU7S0FDRjtJQUNELE9BQU8sVUFBVSxDQUFDO0FBQ3BCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFV0aWxpdHkgZmlsZXMgZm9yIHByb2R1Y2luZyBWZWdhIFZhbHVlUmVmIGZvciBtYXJrc1xuICovXG5pbXBvcnQge2lzQXJyYXksIGlzU3RyaW5nfSBmcm9tICd2ZWdhLXV0aWwnO1xuXG5pbXBvcnQge0NoYW5uZWwsIFgsIFl9IGZyb20gJy4uLy4uL2NoYW5uZWwnO1xuaW1wb3J0IHtDb25maWd9IGZyb20gJy4uLy4uL2NvbmZpZyc7XG5pbXBvcnQge1xuICBDaGFubmVsRGVmLFxuICBDaGFubmVsRGVmV2l0aENvbmRpdGlvbixcbiAgRmllbGREZWYsXG4gIEZpZWxkUmVmT3B0aW9uLFxuICBpc0ZpZWxkRGVmLFxuICBpc1ZhbHVlRGVmLFxuICBUZXh0RmllbGREZWYsXG4gIHZnRmllbGQsXG59IGZyb20gJy4uLy4uL2ZpZWxkZGVmJztcbmltcG9ydCAqIGFzIGxvZyBmcm9tICcuLi8uLi9sb2cnO1xuaW1wb3J0IHtNYXJrLCBNYXJrRGVmfSBmcm9tICcuLi8uLi9tYXJrJztcbmltcG9ydCB7aGFzRGlzY3JldGVEb21haW4sIFNjYWxlVHlwZX0gZnJvbSAnLi4vLi4vc2NhbGUnO1xuaW1wb3J0IHtTdGFja1Byb3BlcnRpZXN9IGZyb20gJy4uLy4uL3N0YWNrJztcbmltcG9ydCB7UVVBTlRJVEFUSVZFfSBmcm9tICcuLi8uLi90eXBlJztcbmltcG9ydCB7Y29udGFpbnMsIHNvbWV9IGZyb20gJy4uLy4uL3V0aWwnO1xuaW1wb3J0IHtWZ1NpZ25hbFJlZiwgVmdWYWx1ZVJlZn0gZnJvbSAnLi4vLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtiaW5SZXF1aXJlc1JhbmdlLCBmb3JtYXRTaWduYWxSZWZ9IGZyb20gJy4uL2NvbW1vbic7XG5pbXBvcnQge1NjYWxlQ29tcG9uZW50fSBmcm9tICcuLi9zY2FsZS9jb21wb25lbnQnO1xuXG5cbi8vIFRPRE86IHdlIG5lZWQgdG8gZmluZCBhIHdheSB0byByZWZhY3RvciB0aGVzZSBzbyB0aGF0IHNjYWxlTmFtZSBpcyBhIHBhcnQgb2Ygc2NhbGVcbi8vIGJ1dCB0aGF0J3MgY29tcGxpY2F0ZWQuICBGb3Igbm93LCB0aGlzIGlzIGEgaHVnZSBzdGVwIG1vdmluZyBmb3J3YXJkLlxuXG4vKipcbiAqIEByZXR1cm4gVmVnYSBWYWx1ZVJlZiBmb3Igc3RhY2thYmxlIHggb3IgeVxuICovXG5leHBvcnQgZnVuY3Rpb24gc3RhY2thYmxlKGNoYW5uZWw6ICd4JyB8ICd5JywgY2hhbm5lbERlZjogQ2hhbm5lbERlZjxzdHJpbmc+LCBzY2FsZU5hbWU6IHN0cmluZywgc2NhbGU6IFNjYWxlQ29tcG9uZW50LFxuICAgIHN0YWNrOiBTdGFja1Byb3BlcnRpZXMsIGRlZmF1bHRSZWY6IFZnVmFsdWVSZWYpOiBWZ1ZhbHVlUmVmIHtcbiAgaWYgKGlzRmllbGREZWYoY2hhbm5lbERlZikgJiYgc3RhY2sgJiYgY2hhbm5lbCA9PT0gc3RhY2suZmllbGRDaGFubmVsKSB7XG4gICAgLy8geCBvciB5IHVzZSBzdGFja19lbmQgc28gdGhhdCBzdGFja2VkIGxpbmUncyBwb2ludCBtYXJrIHVzZSBzdGFja19lbmQgdG9vLlxuICAgIHJldHVybiBmaWVsZFJlZihjaGFubmVsRGVmLCBzY2FsZU5hbWUsIHtzdWZmaXg6ICdlbmQnfSk7XG4gIH1cbiAgcmV0dXJuIG1pZFBvaW50KGNoYW5uZWwsIGNoYW5uZWxEZWYsIHNjYWxlTmFtZSwgc2NhbGUsIHN0YWNrLCBkZWZhdWx0UmVmKTtcbn1cblxuLyoqXG4gKiBAcmV0dXJuIFZlZ2EgVmFsdWVSZWYgZm9yIHN0YWNrYWJsZSB4MiBvciB5MlxuICovXG5leHBvcnQgZnVuY3Rpb24gc3RhY2thYmxlMihjaGFubmVsOiAneDInIHwgJ3kyJywgYUZpZWxkRGVmOiBDaGFubmVsRGVmPHN0cmluZz4sIGEyZmllbGREZWY6IENoYW5uZWxEZWY8c3RyaW5nPiwgc2NhbGVOYW1lOiBzdHJpbmcsIHNjYWxlOiBTY2FsZUNvbXBvbmVudCxcbiAgICBzdGFjazogU3RhY2tQcm9wZXJ0aWVzLCBkZWZhdWx0UmVmOiBWZ1ZhbHVlUmVmKTogVmdWYWx1ZVJlZiB7XG4gIGlmIChpc0ZpZWxkRGVmKGFGaWVsZERlZikgJiYgc3RhY2sgJiZcbiAgICAgIC8vIElmIGZpZWxkQ2hhbm5lbCBpcyBYIGFuZCBjaGFubmVsIGlzIFgyIChvciBZIGFuZCBZMilcbiAgICAgIGNoYW5uZWwuY2hhckF0KDApID09PSBzdGFjay5maWVsZENoYW5uZWwuY2hhckF0KDApXG4gICAgICApIHtcbiAgICByZXR1cm4gZmllbGRSZWYoYUZpZWxkRGVmLCBzY2FsZU5hbWUsIHtzdWZmaXg6ICdzdGFydCd9KTtcbiAgfVxuICByZXR1cm4gbWlkUG9pbnQoY2hhbm5lbCwgYTJmaWVsZERlZiwgc2NhbGVOYW1lLCBzY2FsZSwgc3RhY2ssIGRlZmF1bHRSZWYpO1xufVxuXG5cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE9mZnNldChjaGFubmVsOiAneCcgfCAneScgfCAneDInIHwgJ3kyJywgbWFya0RlZjogTWFya0RlZikge1xuICBjb25zdCBvZmZzZXRDaGFubmVsID0gY2hhbm5lbCArICdPZmZzZXQnO1xuICAvLyBUT0RPOiBpbiB0aGUgZnV0dXJlIHJlYWQgZnJvbSBlbmNvZGluZyBjaGFubmVsIHRvb1xuXG4gIGNvbnN0IG1hcmtEZWZPZmZzZXRWYWx1ZSA9IG1hcmtEZWZbb2Zmc2V0Q2hhbm5lbF07XG4gIGlmIChtYXJrRGVmT2Zmc2V0VmFsdWUpIHtcbiAgICByZXR1cm4gbWFya0RlZk9mZnNldFZhbHVlO1xuICB9XG5cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuLyoqXG4gKiBWYWx1ZSBSZWYgZm9yIGJpbm5lZCBmaWVsZHNcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJpbihmaWVsZERlZjogRmllbGREZWY8c3RyaW5nPiwgc2NhbGVOYW1lOiBzdHJpbmcsIHNpZGU6ICdzdGFydCcgfCAnZW5kJywgb2Zmc2V0PzogbnVtYmVyKSB7XG4gIGNvbnN0IGJpblN1ZmZpeCA9IHNpZGUgPT09ICdzdGFydCcgPyB1bmRlZmluZWQgOiAnZW5kJztcbiAgcmV0dXJuIGZpZWxkUmVmKGZpZWxkRGVmLCBzY2FsZU5hbWUsIHtiaW5TdWZmaXh9LCBvZmZzZXQgPyB7b2Zmc2V0fSA6IHt9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpZWxkUmVmKFxuICAgIGZpZWxkRGVmOiBGaWVsZERlZjxzdHJpbmc+LCBzY2FsZU5hbWU6IHN0cmluZywgb3B0OiBGaWVsZFJlZk9wdGlvbixcbiAgICBtaXhpbnM/OiB7b2Zmc2V0PzogbnVtYmVyIHwgVmdWYWx1ZVJlZiwgYmFuZD86IG51bWJlcnxib29sZWFufVxuICApOiBWZ1ZhbHVlUmVmIHtcblxuICBjb25zdCByZWY6IFZnVmFsdWVSZWYgPSB7XG4gICAgLi4uKHNjYWxlTmFtZSA/IHtzY2FsZTogc2NhbGVOYW1lfSA6IHt9KSxcbiAgICBmaWVsZDogdmdGaWVsZChmaWVsZERlZiwgb3B0KSxcbiAgfTtcblxuICBpZiAobWl4aW5zKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLnJlZixcbiAgICAgIC4uLm1peGluc1xuICAgIH07XG4gIH1cbiAgcmV0dXJuIHJlZjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJhbmRSZWYoc2NhbGVOYW1lOiBzdHJpbmcsIGJhbmQ6IG51bWJlcnxib29sZWFuID0gdHJ1ZSk6IFZnVmFsdWVSZWYge1xuICByZXR1cm4ge1xuICAgIHNjYWxlOiBzY2FsZU5hbWUsXG4gICAgYmFuZDogYmFuZFxuICB9O1xufVxuXG4vKipcbiAqIFNpZ25hbCB0aGF0IHJldHVybnMgdGhlIG1pZGRsZSBvZiBhIGJpbi4gU2hvdWxkIG9ubHkgYmUgdXNlZCB3aXRoIHggYW5kIHkuXG4gKi9cbmZ1bmN0aW9uIGJpbk1pZFNpZ25hbChmaWVsZERlZjogRmllbGREZWY8c3RyaW5nPiwgc2NhbGVOYW1lOiBzdHJpbmcpIHtcbiAgcmV0dXJuIHtcbiAgICBzaWduYWw6IGAoYCArXG4gICAgICBgc2NhbGUoXCIke3NjYWxlTmFtZX1cIiwgJHt2Z0ZpZWxkKGZpZWxkRGVmLCB7ZXhwcjogJ2RhdHVtJ30pfSlgICtcbiAgICAgIGAgKyBgICtcbiAgICAgIGBzY2FsZShcIiR7c2NhbGVOYW1lfVwiLCAke3ZnRmllbGQoZmllbGREZWYsIHtiaW5TdWZmaXg6ICdlbmQnLCBleHByOiAnZGF0dW0nfSl9KWArXG4gICAgYCkvMmBcbiAgfTtcbn1cblxuLyoqXG4gKiBAcmV0dXJucyB7VmdWYWx1ZVJlZn0gVmFsdWUgUmVmIGZvciB4YyAvIHljIG9yIG1pZCBwb2ludCBmb3Igb3RoZXIgY2hhbm5lbHMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBtaWRQb2ludChjaGFubmVsOiBDaGFubmVsLCBjaGFubmVsRGVmOiBDaGFubmVsRGVmPHN0cmluZz4sIHNjYWxlTmFtZTogc3RyaW5nLCBzY2FsZTogU2NhbGVDb21wb25lbnQsIHN0YWNrOiBTdGFja1Byb3BlcnRpZXMsIGRlZmF1bHRSZWY6IFZnVmFsdWVSZWYpOiBWZ1ZhbHVlUmVmIHtcbiAgLy8gVE9ETzogZGF0dW0gc3VwcG9ydFxuXG4gIGlmIChjaGFubmVsRGVmKSB7XG4gICAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi9cblxuICAgIGlmIChpc0ZpZWxkRGVmKGNoYW5uZWxEZWYpKSB7XG4gICAgICBpZiAoY2hhbm5lbERlZi5iaW4pIHtcbiAgICAgICAgLy8gVXNlIG1pZGRsZSBvbmx5IGZvciB4IGFuIHkgdG8gcGxhY2UgbWFya3MgaW4gdGhlIGNlbnRlciBiZXR3ZWVuIHN0YXJ0IGFuZCBlbmQgb2YgdGhlIGJpbiByYW5nZS5cbiAgICAgICAgLy8gV2UgZG8gbm90IHVzZSB0aGUgbWlkIHBvaW50IGZvciBvdGhlciBjaGFubmVscyAoZS5nLiBzaXplKSBzbyB0aGF0IHByb3BlcnRpZXMgb2YgbGVnZW5kcyBhbmQgbWFya3MgbWF0Y2guXG4gICAgICAgIGlmIChjb250YWlucyhbWCwgWV0sIGNoYW5uZWwpICYmIGNoYW5uZWxEZWYudHlwZSA9PT0gUVVBTlRJVEFUSVZFKSB7XG4gICAgICAgICAgaWYgKHN0YWNrICYmIHN0YWNrLmltcHV0ZSkge1xuICAgICAgICAgICAgLy8gRm9yIHN0YWNrLCB3ZSBjb21wdXRlZCBiaW5fbWlkIHNvIHdlIGNhbiBpbXB1dGUuXG4gICAgICAgICAgICByZXR1cm4gZmllbGRSZWYoY2hhbm5lbERlZiwgc2NhbGVOYW1lLCB7YmluU3VmZml4OiAnbWlkJ30pO1xuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBGb3Igbm9uLXN0YWNrLCB3ZSBjYW4ganVzdCBjYWxjdWxhdGUgYmluIG1pZCBvbiB0aGUgZmx5IHVzaW5nIHNpZ25hbC5cbiAgICAgICAgICByZXR1cm4gYmluTWlkU2lnbmFsKGNoYW5uZWxEZWYsIHNjYWxlTmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZpZWxkUmVmKGNoYW5uZWxEZWYsIHNjYWxlTmFtZSwgYmluUmVxdWlyZXNSYW5nZShjaGFubmVsRGVmLCBjaGFubmVsKSA/IHtiaW5TdWZmaXg6ICdyYW5nZSd9IDoge30pO1xuICAgICAgfVxuXG4gICAgICBpZiAoc2NhbGUpIHtcbiAgICAgICAgY29uc3Qgc2NhbGVUeXBlID0gc2NhbGUuZ2V0KCd0eXBlJyk7XG4gICAgICAgIGlmIChoYXNEaXNjcmV0ZURvbWFpbihzY2FsZVR5cGUpKSB7XG4gICAgICAgICAgaWYgKHNjYWxlVHlwZSA9PT0gJ2JhbmQnKSB7XG4gICAgICAgICAgICAvLyBGb3IgYmFuZCwgdG8gZ2V0IG1pZCBwb2ludCwgbmVlZCB0byBvZmZzZXQgYnkgaGFsZiBvZiB0aGUgYmFuZFxuICAgICAgICAgICAgcmV0dXJuIGZpZWxkUmVmKGNoYW5uZWxEZWYsIHNjYWxlTmFtZSwge2JpblN1ZmZpeDogJ3JhbmdlJ30sIHtiYW5kOiAwLjV9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGZpZWxkUmVmKGNoYW5uZWxEZWYsIHNjYWxlTmFtZSwge2JpblN1ZmZpeDogJ3JhbmdlJ30pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZmllbGRSZWYoY2hhbm5lbERlZiwgc2NhbGVOYW1lLCB7fSk7IC8vIG5vIG5lZWQgZm9yIGJpbiBzdWZmaXhcbiAgICB9IGVsc2UgaWYgKGlzVmFsdWVEZWYoY2hhbm5lbERlZikpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gY2hhbm5lbERlZi52YWx1ZTtcblxuICAgICAgaWYgKGNvbnRhaW5zKFsneCcsICd4MiddLCBjaGFubmVsKSAmJiB2YWx1ZSA9PT0gJ3dpZHRoJykge1xuICAgICAgICByZXR1cm4ge2ZpZWxkOiB7Z3JvdXA6ICd3aWR0aCd9fTtcbiAgICAgIH0gZWxzZSBpZiAoY29udGFpbnMoWyd5JywgJ3kyJ10sIGNoYW5uZWwpICYmIHZhbHVlID09PSAnaGVpZ2h0Jykge1xuICAgICAgICByZXR1cm4ge2ZpZWxkOiB7Z3JvdXA6ICdoZWlnaHQnfX07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7dmFsdWV9O1xuICAgIH1cblxuICAgIC8vIElmIGNoYW5uZWxEZWYgaXMgbmVpdGhlciBmaWVsZCBkZWYgb3IgdmFsdWUgZGVmLCBpdCdzIGEgY29uZGl0aW9uLW9ubHkgZGVmLlxuICAgIC8vIEluIHN1Y2ggY2FzZSwgd2Ugd2lsbCB1c2UgZGVmYXVsdCByZWYuXG4gIH1cblxuICByZXR1cm4gZGVmYXVsdFJlZjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRleHQodGV4dERlZjogQ2hhbm5lbERlZldpdGhDb25kaXRpb248VGV4dEZpZWxkRGVmPHN0cmluZz4+LCBjb25maWc6IENvbmZpZyk6IFZnVmFsdWVSZWYge1xuICAvLyB0ZXh0XG4gIGlmICh0ZXh0RGVmKSB7XG4gICAgaWYgKGlzRmllbGREZWYodGV4dERlZikpIHtcbiAgICAgIHJldHVybiBmb3JtYXRTaWduYWxSZWYodGV4dERlZiwgdGV4dERlZi5mb3JtYXQsICdkYXR1bScsIGNvbmZpZyk7XG4gICAgfSBlbHNlIGlmIChpc1ZhbHVlRGVmKHRleHREZWYpKSB7XG4gICAgICByZXR1cm4ge3ZhbHVlOiB0ZXh0RGVmLnZhbHVlfTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1pZChzaXplUmVmOiBWZ1NpZ25hbFJlZik6IFZnVmFsdWVSZWYge1xuICByZXR1cm4gey4uLnNpemVSZWYsIG11bHQ6IDAuNX07XG59XG5cbi8qKlxuICogV2hldGhlciB0aGUgc2NhbGUgZGVmaW5pdGVseSBpbmNsdWRlcyB6ZXJvIGluIHRoZSBkb21haW5cbiAqL1xuZnVuY3Rpb24gZG9tYWluRGVmaW5pdGVseUluY2x1ZGVaZXJvKHNjYWxlOiBTY2FsZUNvbXBvbmVudCkge1xuICBpZiAoc2NhbGUuZ2V0KCd6ZXJvJykgIT09IGZhbHNlKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgY29uc3QgZG9tYWlucyA9IHNjYWxlLmRvbWFpbnM7XG4gIGlmIChpc0FycmF5KGRvbWFpbnMpKSB7XG4gICAgcmV0dXJuIHNvbWUoZG9tYWlucywgKGQpID0+IGlzQXJyYXkoZCkgJiYgZC5sZW5ndGggPT09IDIgJiYgZFswXSA8PTAgJiYgZFsxXSA+PSAwKTtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXREZWZhdWx0UmVmKFxuICBkZWZhdWx0UmVmOiBWZ1ZhbHVlUmVmIHwgJ3plcm9Pck1pbicgfCAnemVyb09yTWF4JyxcbiAgY2hhbm5lbDogJ3gnIHwgJ3knLCBzY2FsZU5hbWU6IHN0cmluZywgc2NhbGU6IFNjYWxlQ29tcG9uZW50LCBtYXJrOiBNYXJrXG4pIHtcbiAgaWYgKGlzU3RyaW5nKGRlZmF1bHRSZWYpKSB7XG4gICAgaWYgKHNjYWxlTmFtZSkge1xuICAgICAgY29uc3Qgc2NhbGVUeXBlID0gc2NhbGUuZ2V0KCd0eXBlJyk7XG4gICAgICBpZiAoY29udGFpbnMoW1NjYWxlVHlwZS5MT0csIFNjYWxlVHlwZS5USU1FLCBTY2FsZVR5cGUuVVRDXSwgc2NhbGVUeXBlKSkge1xuICAgICAgICAvLyBMb2cgc2NhbGVzIGNhbm5vdCBoYXZlIHplcm8uXG4gICAgICAgIC8vIFplcm8gaW4gdGltZSBzY2FsZSBpcyBhcmJpdHJhcnksIGFuZCBkb2VzIG5vdCBhZmZlY3QgcmF0aW8uXG4gICAgICAgIC8vIChUaW1lIGlzIGFuIGludGVydmFsIGxldmVsIG9mIG1lYXN1cmVtZW50LCBub3QgcmF0aW8pLlxuICAgICAgICAvLyBTZWUgaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTGV2ZWxfb2ZfbWVhc3VyZW1lbnQgZm9yIG1vcmUgaW5mby5cbiAgICAgICAgaWYgKG1hcmsgPT09ICdiYXInIHx8IG1hcmsgPT09ICdhcmVhJykge1xuICAgICAgICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLm5vblplcm9TY2FsZVVzZWRXaXRoTGVuZ3RoTWFyayhtYXJrLCBjaGFubmVsLCB7c2NhbGVUeXBlfSkpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoZG9tYWluRGVmaW5pdGVseUluY2x1ZGVaZXJvKHNjYWxlKSkge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzY2FsZTogc2NhbGVOYW1lLFxuICAgICAgICAgICAgdmFsdWU6IDBcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGlmIChtYXJrID09PSAnYmFyJyB8fCBtYXJrID09PSAnYXJlYScpIHtcbiAgICAgICAgICBsb2cud2Fybihsb2cubWVzc2FnZS5ub25aZXJvU2NhbGVVc2VkV2l0aExlbmd0aE1hcmsoXG4gICAgICAgICAgICBtYXJrLCBjaGFubmVsLCB7emVyb0ZhbHNlOiBzY2FsZS5leHBsaWNpdC56ZXJvID09PSBmYWxzZX1cbiAgICAgICAgICApKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChkZWZhdWx0UmVmID09PSAnemVyb09yTWluJykge1xuICAgICAgcmV0dXJuIGNoYW5uZWwgPT09ICd4JyA/IHt2YWx1ZTogMH0gOiB7ZmllbGQ6IHtncm91cDogJ2hlaWdodCd9fTtcbiAgICB9IGVsc2UgeyAvLyB6ZXJvT3JNYXhcbiAgICAgIHJldHVybiBjaGFubmVsID09PSAneCcgPyB7ZmllbGQ6IHtncm91cDogJ3dpZHRoJ319IDoge3ZhbHVlOiAwfTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGRlZmF1bHRSZWY7XG59XG5cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { isArray } from 'vega-util';\nimport { getFieldDef, isConditionalSelection, isValueDef, vgField, } from '../../fielddef';\nimport * as log from '../../log';\nimport { expression } from '../../predicate';\nimport { hasContinuousDomain } from '../../scale';\nimport { contains } from '../../util';\nimport { VG_MARK_CONFIGS } from '../../vega.schema';\nimport { getMarkConfig } from '../common';\nimport { selectionPredicate } from '../selection/selection';\nimport * as ref from './valueref';\nexport function color(model, opt) {\n    var _a, _b;\n    if (opt === void 0) { opt = { valueOnly: false }; }\n    var markDef = model.markDef, encoding = model.encoding, config = model.config;\n    var filled = markDef.filled, markType = markDef.type;\n    var configValue = {\n        fill: getMarkConfig('fill', markDef, config),\n        stroke: getMarkConfig('stroke', markDef, config),\n        color: getMarkConfig('color', markDef, config)\n    };\n    var transparentIfNeeded = contains(['bar', 'point', 'circle', 'square', 'geoshape'], markType) ? 'transparent' : undefined;\n    var defaultValue = {\n        fill: markDef.fill || configValue.fill ||\n            // If there is no fill, always fill symbols, bar, geoshape\n            // with transparent fills https://github.com/vega/vega-lite/issues/1316\n            transparentIfNeeded,\n        stroke: markDef.stroke || configValue.stroke\n    };\n    var colorVgChannel = filled ? 'fill' : 'stroke';\n    var fillStrokeMarkDefAndConfig = tslib_1.__assign({}, (defaultValue.fill ? {\n        fill: { value: defaultValue.fill }\n    } : {}), (defaultValue.stroke ? {\n        stroke: { value: defaultValue.stroke }\n    } : {}));\n    if (encoding.fill || encoding.stroke) {\n        // ignore encoding.color, markDef.color, config.color\n        if (markDef.color) {\n            // warn for markDef.color  (no need to warn encoding.color as it will be dropped in normalized already)\n            log.warn(log.message.droppingColor('property', { fill: 'fill' in encoding, stroke: 'stroke' in encoding }));\n        }\n        return tslib_1.__assign({}, nonPosition('fill', model, { defaultValue: defaultValue.fill || transparentIfNeeded }), nonPosition('stroke', model, { defaultValue: defaultValue.stroke }));\n    }\n    else if (encoding.color) {\n        return tslib_1.__assign({}, fillStrokeMarkDefAndConfig, nonPosition('color', model, {\n            vgChannel: colorVgChannel,\n            // apply default fill/stroke first, then color config, then transparent if needed.\n            defaultValue: markDef[colorVgChannel] || markDef.color || configValue[colorVgChannel] || configValue.color || (filled ? transparentIfNeeded : undefined)\n        }));\n    }\n    else if (markDef.fill || markDef.stroke) {\n        // Ignore markDef.color, config.color\n        if (markDef.color) {\n            log.warn(log.message.droppingColor('property', { fill: 'fill' in markDef, stroke: 'stroke' in markDef }));\n        }\n        return fillStrokeMarkDefAndConfig;\n    }\n    else if (markDef.color) {\n        return tslib_1.__assign({}, fillStrokeMarkDefAndConfig, (_a = {}, _a[colorVgChannel] = { value: markDef.color }, _a));\n    }\n    else if (configValue.fill || configValue.stroke) {\n        // ignore config.color\n        return fillStrokeMarkDefAndConfig;\n    }\n    else if (configValue.color) {\n        return tslib_1.__assign({}, (transparentIfNeeded ? { fill: { value: 'transparent' } } : {}), (_b = {}, _b[colorVgChannel] = { value: configValue.color }, _b));\n    }\n    return {};\n}\nexport function baseEncodeEntry(model, ignore) {\n    return tslib_1.__assign({}, markDefProperties(model.markDef, ignore), color(model), nonPosition('opacity', model), tooltip(model), text(model, 'href'));\n}\nfunction markDefProperties(mark, ignore) {\n    return VG_MARK_CONFIGS.reduce(function (m, prop) {\n        if (mark[prop] !== undefined && ignore[prop] !== 'ignore') {\n            m[prop] = { value: mark[prop] };\n        }\n        return m;\n    }, {});\n}\nexport function valueIfDefined(prop, value) {\n    var _a;\n    if (value !== undefined) {\n        return _a = {}, _a[prop] = { value: value }, _a;\n    }\n    return undefined;\n}\nfunction validPredicate(vgRef) {\n    return vgRef + \" !== null && !isNaN(\" + vgRef + \")\";\n}\nexport function defined(model) {\n    if (model.config.invalidValues === 'filter') {\n        var fields = ['x', 'y'].map(function (channel) {\n            var scaleComponent = model.getScaleComponent(channel);\n            if (scaleComponent) {\n                var scaleType = scaleComponent.get('type');\n                // Discrete domain scales can handle invalid values, but continuous scales can't.\n                if (hasContinuousDomain(scaleType)) {\n                    return model.vgField(channel, { expr: 'datum' });\n                }\n            }\n            return undefined;\n        })\n            .filter(function (field) { return !!field; })\n            .map(validPredicate);\n        if (fields.length > 0) {\n            return {\n                defined: { signal: fields.join(' && ') }\n            };\n        }\n    }\n    return {};\n}\n/**\n * Return mixins for non-positional channels with scales.  (Text doesn't have scale.)\n */\nexport function nonPosition(channel, model, opt) {\n    if (opt === void 0) { opt = {}; }\n    var defaultValue = opt.defaultValue, vgChannel = opt.vgChannel;\n    var defaultRef = opt.defaultRef || (defaultValue !== undefined ? { value: defaultValue } : undefined);\n    var channelDef = model.encoding[channel];\n    return wrapCondition(model, channelDef, vgChannel || channel, function (cDef) {\n        return ref.midPoint(channel, cDef, model.scaleName(channel), model.getScaleComponent(channel), null, // No need to provide stack for non-position as it does not affect mid point\n        defaultRef);\n    });\n}\n/**\n * Return a mixin that include a Vega production rule for a Vega-Lite conditional channel definition.\n * or a simple mixin if channel def has no condition.\n */\nexport function wrapCondition(model, channelDef, vgChannel, refFn) {\n    var _a, _b;\n    var condition = channelDef && channelDef.condition;\n    var valueRef = refFn(channelDef);\n    if (condition) {\n        var conditions = isArray(condition) ? condition : [condition];\n        var vgConditions = conditions.map(function (c) {\n            var conditionValueRef = refFn(c);\n            var test = isConditionalSelection(c) ? selectionPredicate(model, c.selection) : expression(model, c.test);\n            return tslib_1.__assign({ test: test }, conditionValueRef);\n        });\n        return _a = {},\n            _a[vgChannel] = vgConditions.concat((valueRef !== undefined ? [valueRef] : [])),\n            _a;\n    }\n    else {\n        return valueRef !== undefined ? (_b = {}, _b[vgChannel] = valueRef, _b) : {};\n    }\n}\nexport function tooltip(model) {\n    var channel = 'tooltip';\n    var channelDef = model.encoding[channel];\n    if (isArray(channelDef)) {\n        var keyValues = channelDef.map(function (fieldDef) {\n            var key = fieldDef.title !== undefined ? fieldDef.title : vgField(fieldDef, { binSuffix: 'range' });\n            var value = ref.text(fieldDef, model.config).signal;\n            return \"\\\"\" + key + \"\\\": \" + value;\n        });\n        return { tooltip: { signal: \"{\" + keyValues.join(', ') + \"}\" } };\n    }\n    else {\n        // if not an array, behave just like text\n        return textCommon(model, channel, channelDef);\n    }\n}\nexport function text(model, channel) {\n    if (channel === void 0) { channel = 'text'; }\n    var channelDef = model.encoding[channel];\n    return textCommon(model, channel, channelDef);\n}\nfunction textCommon(model, channel, channelDef) {\n    return wrapCondition(model, channelDef, channel, function (cDef) { return ref.text(cDef, model.config); });\n}\nexport function bandPosition(fieldDef, channel, model) {\n    var _a, _b, _c;\n    var scaleName = model.scaleName(channel);\n    var sizeChannel = channel === 'x' ? 'width' : 'height';\n    if (model.encoding.size || model.markDef.size !== undefined) {\n        var orient = model.markDef.orient;\n        if (orient) {\n            var centeredBandPositionMixins = (_a = {},\n                // Use xc/yc and place the mark at the middle of the band\n                // This way we never have to deal with size's condition for x/y position.\n                _a[channel + 'c'] = ref.fieldRef(fieldDef, scaleName, {}, { band: 0.5 }),\n                _a);\n            if (getFieldDef(model.encoding.size)) {\n                return tslib_1.__assign({}, centeredBandPositionMixins, nonPosition('size', model, { vgChannel: sizeChannel }));\n            }\n            else if (isValueDef(model.encoding.size)) {\n                return tslib_1.__assign({}, centeredBandPositionMixins, nonPosition('size', model, { vgChannel: sizeChannel }));\n            }\n            else if (model.markDef.size !== undefined) {\n                return tslib_1.__assign({}, centeredBandPositionMixins, (_b = {}, _b[sizeChannel] = { value: model.markDef.size }, _b));\n            }\n        }\n        else {\n            log.warn(log.message.cannotApplySizeToNonOrientedMark(model.markDef.type));\n        }\n    }\n    return _c = {},\n        _c[channel] = ref.fieldRef(fieldDef, scaleName, { binSuffix: 'range' }),\n        _c[sizeChannel] = ref.bandRef(scaleName),\n        _c;\n}\nexport function centeredBandPosition(channel, model, defaultPosRef, defaultSizeRef) {\n    var centerChannel = channel === 'x' ? 'xc' : 'yc';\n    var sizeChannel = channel === 'x' ? 'width' : 'height';\n    return tslib_1.__assign({}, pointPosition(channel, model, defaultPosRef, centerChannel), nonPosition('size', model, { defaultRef: defaultSizeRef, vgChannel: sizeChannel }));\n}\nexport function binnedPosition(fieldDef, channel, scaleName, spacing, reverse) {\n    if (channel === 'x') {\n        return {\n            x2: ref.bin(fieldDef, scaleName, 'start', reverse ? 0 : spacing),\n            x: ref.bin(fieldDef, scaleName, 'end', reverse ? spacing : 0)\n        };\n    }\n    else {\n        return {\n            y2: ref.bin(fieldDef, scaleName, 'start', reverse ? spacing : 0),\n            y: ref.bin(fieldDef, scaleName, 'end', reverse ? 0 : spacing)\n        };\n    }\n}\n/**\n * Return mixins for point (non-band) position channels.\n */\nexport function pointPosition(channel, model, defaultRef, vgChannel) {\n    // TODO: refactor how refer to scale as discussed in https://github.com/vega/vega-lite/pull/1613\n    var _a;\n    var encoding = model.encoding, mark = model.mark, stack = model.stack;\n    var channelDef = encoding[channel];\n    var scaleName = model.scaleName(channel);\n    var scale = model.getScaleComponent(channel);\n    var offset = ref.getOffset(channel, model.markDef);\n    var valueRef = !channelDef && (encoding.latitude || encoding.longitude) ?\n        // use geopoint output if there are lat/long and there is no point position overriding lat/long.\n        { field: model.getName(channel) } : tslib_1.__assign({}, ref.stackable(channel, encoding[channel], scaleName, scale, stack, ref.getDefaultRef(defaultRef, channel, scaleName, scale, mark)), (offset ? { offset: offset } : {}));\n    return _a = {},\n        _a[vgChannel || channel] = valueRef,\n        _a;\n}\n/**\n * Return mixins for x2, y2.\n * If channel is not specified, return one channel based on orientation.\n */\nexport function pointPosition2(model, defaultRef, channel) {\n    var _a;\n    var encoding = model.encoding, mark = model.mark, stack = model.stack;\n    var baseChannel = channel === 'x2' ? 'x' : 'y';\n    var channelDef = encoding[baseChannel];\n    var scaleName = model.scaleName(baseChannel);\n    var scale = model.getScaleComponent(baseChannel);\n    var offset = ref.getOffset(channel, model.markDef);\n    var valueRef = !channelDef && (encoding.latitude || encoding.longitude) ?\n        // use geopoint output if there are lat2/long2 and there is no point position2 overriding lat2/long2.\n        { field: model.getName(channel) } : tslib_1.__assign({}, ref.stackable2(channel, channelDef, encoding[channel], scaleName, scale, stack, ref.getDefaultRef(defaultRef, baseChannel, scaleName, scale, mark)), (offset ? { offset: offset } : {}));\n    return _a = {}, _a[channel] = valueRef, _a;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWl4aW5zLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvbWFyay9taXhpbnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBQyxPQUFPLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFHbEMsT0FBTyxFQUlMLFdBQVcsRUFDWCxzQkFBc0IsRUFDdEIsVUFBVSxFQUdWLE9BQU8sR0FDUixNQUFNLGdCQUFnQixDQUFDO0FBQ3hCLE9BQU8sS0FBSyxHQUFHLE1BQU0sV0FBVyxDQUFDO0FBRWpDLE9BQU8sRUFBQyxVQUFVLEVBQUMsTUFBTSxpQkFBaUIsQ0FBQztBQUMzQyxPQUFPLEVBQUMsbUJBQW1CLEVBQUMsTUFBTSxhQUFhLENBQUM7QUFDaEQsT0FBTyxFQUFDLFFBQVEsRUFBQyxNQUFNLFlBQVksQ0FBQztBQUNwQyxPQUFPLEVBQUMsZUFBZSxFQUE0QixNQUFNLG1CQUFtQixDQUFDO0FBQzdFLE9BQU8sRUFBQyxhQUFhLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDeEMsT0FBTyxFQUFDLGtCQUFrQixFQUFDLE1BQU0sd0JBQXdCLENBQUM7QUFFMUQsT0FBTyxLQUFLLEdBQUcsTUFBTSxZQUFZLENBQUM7QUFFbEMsTUFBTSxnQkFBZ0IsS0FBZ0IsRUFBRSxHQUE4Qzs7SUFBOUMsb0JBQUEsRUFBQSxRQUE2QixTQUFTLEVBQUUsS0FBSyxFQUFDO0lBQzdFLElBQUEsdUJBQU8sRUFBRSx5QkFBUSxFQUFFLHFCQUFNLENBQVU7SUFDbkMsSUFBQSx1QkFBTSxFQUFFLHVCQUFjLENBQVk7SUFFekMsSUFBTSxXQUFXLEdBQUc7UUFDbEIsSUFBSSxFQUFFLGFBQWEsQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLE1BQU0sQ0FBQztRQUM1QyxNQUFNLEVBQUUsYUFBYSxDQUFDLFFBQVEsRUFBRSxPQUFPLEVBQUUsTUFBTSxDQUFDO1FBQ2hELEtBQUssRUFBRSxhQUFhLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLENBQUM7S0FDL0MsQ0FBQztJQUVGLElBQU0sbUJBQW1CLEdBQUcsUUFBUSxDQUFDLENBQUMsS0FBSyxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLFVBQVUsQ0FBQyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztJQUU3SCxJQUFNLFlBQVksR0FBRztRQUNuQixJQUFJLEVBQUUsT0FBTyxDQUFDLElBQUksSUFBSSxXQUFXLENBQUMsSUFBSTtZQUN0QywwREFBMEQ7WUFDMUQsdUVBQXVFO1lBQ3JFLG1CQUFtQjtRQUNyQixNQUFNLEVBQUUsT0FBTyxDQUFDLE1BQU0sSUFBSSxXQUFXLENBQUMsTUFBTTtLQUM3QyxDQUFDO0lBRUYsSUFBTSxjQUFjLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQztJQUVsRCxJQUFNLDBCQUEwQix3QkFDM0IsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUN0QixJQUFJLEVBQUUsRUFBQyxLQUFLLEVBQUUsWUFBWSxDQUFDLElBQUksRUFBQztLQUNqQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFDSixDQUFDLFlBQVksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1FBQ3hCLE1BQU0sRUFBRSxFQUFDLEtBQUssRUFBRSxZQUFZLENBQUMsTUFBTSxFQUFDO0tBQ3JDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUNSLENBQUM7SUFFRixJQUFJLFFBQVEsQ0FBQyxJQUFJLElBQUksUUFBUSxDQUFDLE1BQU0sRUFBRTtRQUNwQyxxREFBcUQ7UUFDckQsSUFBSSxPQUFPLENBQUMsS0FBSyxFQUFFO1lBQ2pCLHVHQUF1RztZQUN2RyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLFVBQVUsRUFBRSxFQUFDLElBQUksRUFBRSxNQUFNLElBQUksUUFBUSxFQUFFLE1BQU0sRUFBRSxRQUFRLElBQUksUUFBUSxFQUFDLENBQUMsQ0FBQyxDQUFDO1NBQzNHO1FBRUQsNEJBQ0ssV0FBVyxDQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsRUFBQyxZQUFZLEVBQUUsWUFBWSxDQUFDLElBQUksSUFBSSxtQkFBbUIsRUFBQyxDQUFDLEVBQ3BGLFdBQVcsQ0FBQyxRQUFRLEVBQUUsS0FBSyxFQUFFLEVBQUMsWUFBWSxFQUFFLFlBQVksQ0FBQyxNQUFNLEVBQUMsQ0FBQyxFQUNwRTtLQUNIO1NBQU0sSUFBSSxRQUFRLENBQUMsS0FBSyxFQUFFO1FBRXpCLDRCQUNLLDBCQUEwQixFQUUxQixXQUFXLENBQUMsT0FBTyxFQUFFLEtBQUssRUFBRTtZQUM3QixTQUFTLEVBQUUsY0FBYztZQUN6QixrRkFBa0Y7WUFDbEYsWUFBWSxFQUFFLE9BQU8sQ0FBQyxjQUFjLENBQUMsSUFBSSxPQUFPLENBQUMsS0FBSyxJQUFJLFdBQVcsQ0FBQyxjQUFjLENBQUMsSUFBSSxXQUFXLENBQUMsS0FBSyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO1NBQ3pKLENBQUMsRUFDRjtLQUNIO1NBQU0sSUFBSSxPQUFPLENBQUMsSUFBSSxJQUFJLE9BQU8sQ0FBQyxNQUFNLEVBQUU7UUFDekMscUNBQXFDO1FBQ3JDLElBQUksT0FBTyxDQUFDLEtBQUssRUFBRTtZQUNqQixHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLFVBQVUsRUFBRSxFQUFDLElBQUksRUFBRSxNQUFNLElBQUksT0FBTyxFQUFFLE1BQU0sRUFBRSxRQUFRLElBQUksT0FBTyxFQUFDLENBQUMsQ0FBQyxDQUFDO1NBQ3pHO1FBQ0QsT0FBTywwQkFBMEIsQ0FBQztLQUNuQztTQUFNLElBQUksT0FBTyxDQUFDLEtBQUssRUFBRTtRQUN4Qiw0QkFDSywwQkFBMEIsZUFHNUIsY0FBYyxJQUFHLEVBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxLQUFLLEVBQUMsT0FDeEM7S0FDSDtTQUFNLElBQUksV0FBVyxDQUFDLElBQUksSUFBSSxXQUFXLENBQUMsTUFBTSxFQUFFO1FBQ2pELHNCQUFzQjtRQUN0QixPQUFPLDBCQUEwQixDQUFDO0tBQ25DO1NBQU0sSUFBSSxXQUFXLENBQUMsS0FBSyxFQUFFO1FBQzVCLDRCQUNLLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDLEVBQUMsSUFBSSxFQUFFLEVBQUMsS0FBSyxFQUFFLGFBQWEsRUFBQyxFQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxlQUM3RCxjQUFjLElBQUcsRUFBQyxLQUFLLEVBQUUsV0FBVyxDQUFDLEtBQUssRUFBQyxPQUM1QztLQUNIO0lBQ0QsT0FBTyxFQUFFLENBQUM7QUFDWixDQUFDO0FBSUQsTUFBTSwwQkFBMEIsS0FBZ0IsRUFBRSxNQUFjO0lBQzlELDRCQUNLLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsTUFBTSxDQUFDLEVBQ3hDLEtBQUssQ0FBQyxLQUFLLENBQUMsRUFDWixXQUFXLENBQUMsU0FBUyxFQUFFLEtBQUssQ0FBQyxFQUM3QixPQUFPLENBQUMsS0FBSyxDQUFDLEVBQ2QsSUFBSSxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUMsRUFDdEI7QUFDSixDQUFDO0FBRUQsMkJBQTJCLElBQWEsRUFBRSxNQUFjO0lBQ3RELE9BQU8sZUFBZSxDQUFDLE1BQU0sQ0FBQyxVQUFDLENBQUMsRUFBRSxJQUFJO1FBQ3BDLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLFNBQVMsSUFBSSxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssUUFBUSxFQUFFO1lBQ3pELENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUMsQ0FBQztTQUMvQjtRQUNELE9BQU8sQ0FBQyxDQUFDO0lBQ1gsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBQ1QsQ0FBQztBQUVELE1BQU0seUJBQXlCLElBQVksRUFBRSxLQUFnQzs7SUFDM0UsSUFBSSxLQUFLLEtBQUssU0FBUyxFQUFFO1FBQ3ZCLGdCQUFRLEdBQUMsSUFBSSxJQUFHLEVBQUMsS0FBSyxFQUFFLEtBQUssRUFBQyxLQUFFO0tBQ2pDO0lBQ0QsT0FBTyxTQUFTLENBQUM7QUFDbkIsQ0FBQztBQUVELHdCQUF3QixLQUFhO0lBQ25DLE9BQVUsS0FBSyw0QkFBdUIsS0FBSyxNQUFHLENBQUM7QUFDakQsQ0FBQztBQUVELE1BQU0sa0JBQWtCLEtBQWdCO0lBQ3RDLElBQUksS0FBSyxDQUFDLE1BQU0sQ0FBQyxhQUFhLEtBQUssUUFBUSxFQUFFO1FBQzNDLElBQU0sTUFBTSxHQUFHLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxVQUFDLE9BQTZCO1lBQ3hELElBQU0sY0FBYyxHQUFHLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUN4RCxJQUFJLGNBQWMsRUFBRTtnQkFDbEIsSUFBTSxTQUFTLEdBQUcsY0FBYyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQztnQkFFN0MsaUZBQWlGO2dCQUNqRixJQUFJLG1CQUFtQixDQUFDLFNBQVMsQ0FBQyxFQUFFO29CQUNsQyxPQUFPLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLEVBQUMsSUFBSSxFQUFFLE9BQU8sRUFBQyxDQUFDLENBQUM7aUJBQ2hEO2FBQ0Y7WUFDRCxPQUFPLFNBQVMsQ0FBQztRQUNuQixDQUFDLENBQUM7YUFDRCxNQUFNLENBQUMsVUFBQSxLQUFLLElBQUksT0FBQSxDQUFDLENBQUMsS0FBSyxFQUFQLENBQU8sQ0FBQzthQUN4QixHQUFHLENBQUMsY0FBYyxDQUFDLENBQUM7UUFFdkIsSUFBSSxNQUFNLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtZQUNyQixPQUFPO2dCQUNMLE9BQU8sRUFBRSxFQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFDO2FBQ3ZDLENBQUM7U0FDSDtLQUNGO0lBRUQsT0FBTyxFQUFFLENBQUM7QUFDWixDQUFDO0FBRUQ7O0dBRUc7QUFDSCxNQUFNLHNCQUFzQixPQUE2QyxFQUFFLEtBQWdCLEVBQUUsR0FBaUc7SUFBakcsb0JBQUEsRUFBQSxRQUFpRztJQUNyTCxJQUFBLCtCQUFZLEVBQUUseUJBQVMsQ0FBUTtJQUN0QyxJQUFNLFVBQVUsR0FBRyxHQUFHLENBQUMsVUFBVSxJQUFJLENBQUMsWUFBWSxLQUFLLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBQyxLQUFLLEVBQUUsWUFBWSxFQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBRXRHLElBQU0sVUFBVSxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUM7SUFFM0MsT0FBTyxhQUFhLENBQUMsS0FBSyxFQUFFLFVBQVUsRUFBRSxTQUFTLElBQUksT0FBTyxFQUFFLFVBQUMsSUFBSTtRQUNqRSxPQUFPLEdBQUcsQ0FBQyxRQUFRLENBQ2pCLE9BQU8sRUFBRSxJQUFJLEVBQUUsS0FBSyxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsRUFDdkMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxFQUNoQyxJQUFJLEVBQUUsNEVBQTRFO1FBQ2xGLFVBQVUsQ0FDWCxDQUFDO0lBQ0osQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDO0FBRUQ7OztHQUdHO0FBQ0gsTUFBTSx3QkFDRixLQUFnQixFQUFFLFVBQThCLEVBQUUsU0FBaUIsRUFDbkUsS0FBK0M7O0lBRWpELElBQU0sU0FBUyxHQUFHLFVBQVUsSUFBSSxVQUFVLENBQUMsU0FBUyxDQUFDO0lBQ3JELElBQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUNuQyxJQUFJLFNBQVMsRUFBRTtRQUNiLElBQU0sVUFBVSxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ2hFLElBQU0sWUFBWSxHQUFHLFVBQVUsQ0FBQyxHQUFHLENBQUMsVUFBQyxDQUFDO1lBQ3BDLElBQU0saUJBQWlCLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ25DLElBQU0sSUFBSSxHQUFHLHNCQUFzQixDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUM1RywwQkFDRSxJQUFJLE1BQUEsSUFDRCxpQkFBaUIsRUFDcEI7UUFDSixDQUFDLENBQUMsQ0FBQztRQUNIO1lBQ0UsR0FBQyxTQUFTLElBQ0wsWUFBWSxRQUNaLENBQUMsUUFBUSxLQUFLLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQzlDO2VBQ0Q7S0FDSDtTQUFNO1FBQ0wsT0FBTyxRQUFRLEtBQUssU0FBUyxDQUFDLENBQUMsV0FBRSxHQUFDLFNBQVMsSUFBRyxRQUFRLE1BQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQztLQUM5RDtBQUNILENBQUM7QUFFRCxNQUFNLGtCQUFrQixLQUFnQjtJQUN0QyxJQUFNLE9BQU8sR0FBRyxTQUFTLENBQUM7SUFDMUIsSUFBTSxVQUFVLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUMzQyxJQUFJLE9BQU8sQ0FBQyxVQUFVLENBQUMsRUFBRTtRQUN2QixJQUFNLFNBQVMsR0FBRyxVQUFVLENBQUMsR0FBRyxDQUFDLFVBQUMsUUFBUTtZQUN4QyxJQUFNLEdBQUcsR0FBRyxRQUFRLENBQUMsS0FBSyxLQUFLLFNBQVMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxFQUFDLFNBQVMsRUFBRSxPQUFPLEVBQUMsQ0FBQyxDQUFDO1lBQ3BHLElBQU0sS0FBSyxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLENBQUM7WUFDdEQsT0FBTyxPQUFJLEdBQUcsWUFBTSxLQUFPLENBQUM7UUFDOUIsQ0FBQyxDQUFDLENBQUM7UUFDSCxPQUFPLEVBQUMsT0FBTyxFQUFFLEVBQUMsTUFBTSxFQUFFLE1BQUksU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsTUFBRyxFQUFDLEVBQUMsQ0FBQztLQUN6RDtTQUFNO1FBQ0wseUNBQXlDO1FBQ3pDLE9BQU8sVUFBVSxDQUFDLEtBQUssRUFBRSxPQUFPLEVBQUUsVUFBVSxDQUFDLENBQUM7S0FDL0M7QUFDSCxDQUFDO0FBRUQsTUFBTSxlQUFlLEtBQWdCLEVBQUUsT0FBaUM7SUFBakMsd0JBQUEsRUFBQSxnQkFBaUM7SUFDdEUsSUFBTSxVQUFVLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUMzQyxPQUFPLFVBQVUsQ0FBQyxLQUFLLEVBQUUsT0FBTyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0FBQ2hELENBQUM7QUFFRCxvQkFBb0IsS0FBZ0IsRUFBRSxPQUFvQyxFQUFFLFVBQXFHO0lBQy9LLE9BQU8sYUFBYSxDQUFDLEtBQUssRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLFVBQUMsSUFBSSxJQUFLLE9BQUEsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUE1QixDQUE0QixDQUFDLENBQUM7QUFDM0YsQ0FBQztBQUVELE1BQU0sdUJBQXVCLFFBQTBCLEVBQUUsT0FBZ0IsRUFBRSxLQUFnQjs7SUFDekYsSUFBTSxTQUFTLEdBQUcsS0FBSyxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUMzQyxJQUFNLFdBQVcsR0FBRyxPQUFPLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQztJQUV6RCxJQUFJLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBSSxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxLQUFLLFNBQVMsRUFBRTtRQUMzRCxJQUFNLE1BQU0sR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQztRQUNwQyxJQUFJLE1BQU0sRUFBRTtZQUNWLElBQU0sMEJBQTBCO2dCQUM5Qix5REFBeUQ7Z0JBQ3pELHlFQUF5RTtnQkFDekUsR0FBQyxPQUFPLEdBQUMsR0FBRyxJQUFHLEdBQUcsQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLFNBQVMsRUFBRSxFQUFFLEVBQUUsRUFBQyxJQUFJLEVBQUUsR0FBRyxFQUFDLENBQUM7bUJBQ2xFLENBQUM7WUFFRixJQUFJLFdBQVcsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFFO2dCQUNwQyw0QkFDSywwQkFBMEIsRUFDMUIsV0FBVyxDQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsRUFBQyxTQUFTLEVBQUUsV0FBVyxFQUFDLENBQUMsRUFDdkQ7YUFDSDtpQkFBTSxJQUFJLFVBQVUsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxFQUFFO2dCQUMxQyw0QkFDSywwQkFBMEIsRUFDMUIsV0FBVyxDQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsRUFBQyxTQUFTLEVBQUUsV0FBVyxFQUFDLENBQUMsRUFDdkQ7YUFDSDtpQkFBTSxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxLQUFLLFNBQVMsRUFBRTtnQkFDM0MsNEJBQ0ssMEJBQTBCLGVBQzVCLFdBQVcsSUFBRyxFQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksRUFBQyxPQUMxQzthQUNIO1NBQ0Y7YUFBTTtZQUNMLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxnQ0FBZ0MsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7U0FDNUU7S0FDRjtJQUNEO1FBQ0UsR0FBQyxPQUFPLElBQUcsR0FBRyxDQUFDLFFBQVEsQ0FBQyxRQUFRLEVBQUUsU0FBUyxFQUFFLEVBQUMsU0FBUyxFQUFFLE9BQU8sRUFBQyxDQUFDO1FBQ2xFLEdBQUMsV0FBVyxJQUFHLEdBQUcsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDO1dBQ3JDO0FBQ0osQ0FBQztBQUVELE1BQU0sK0JBQStCLE9BQWtCLEVBQUUsS0FBZ0IsRUFBRSxhQUF5QixFQUFFLGNBQTBCO0lBQzlILElBQU0sYUFBYSxHQUFnQixPQUFPLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUNqRSxJQUFNLFdBQVcsR0FBRyxPQUFPLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQztJQUN6RCw0QkFDSyxhQUFhLENBQUMsT0FBTyxFQUFFLEtBQUssRUFBRSxhQUFhLEVBQUUsYUFBYSxDQUFDLEVBQzNELFdBQVcsQ0FBQyxNQUFNLEVBQUUsS0FBSyxFQUFFLEVBQUMsVUFBVSxFQUFFLGNBQWMsRUFBRSxTQUFTLEVBQUUsV0FBVyxFQUFDLENBQUMsRUFDbkY7QUFDSixDQUFDO0FBRUQsTUFBTSx5QkFBeUIsUUFBMEIsRUFBRSxPQUFnQixFQUFFLFNBQWlCLEVBQUUsT0FBZSxFQUFFLE9BQWdCO0lBQy9ILElBQUksT0FBTyxLQUFLLEdBQUcsRUFBRTtRQUNuQixPQUFPO1lBQ0wsRUFBRSxFQUFFLEdBQUcsQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQztZQUNoRSxDQUFDLEVBQUUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQzlELENBQUM7S0FDSDtTQUFNO1FBQ0wsT0FBTztZQUNMLEVBQUUsRUFBRSxHQUFHLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBRSxTQUFTLEVBQUUsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDaEUsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQztTQUM5RCxDQUFDO0tBQ0g7QUFDSCxDQUFDO0FBR0Q7O0dBRUc7QUFDSCxNQUFNLHdCQUF3QixPQUFnQixFQUFFLEtBQWdCLEVBQUUsVUFBa0QsRUFBRSxTQUE2QjtJQUNqSixnR0FBZ0c7O0lBRXpGLElBQUEseUJBQVEsRUFBRSxpQkFBSSxFQUFFLG1CQUFLLENBQVU7SUFFdEMsSUFBTSxVQUFVLEdBQUcsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3JDLElBQU0sU0FBUyxHQUFHLEtBQUssQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDM0MsSUFBTSxLQUFLLEdBQUcsS0FBSyxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBRy9DLElBQU0sTUFBTSxHQUFHLEdBQUcsQ0FBQyxTQUFTLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUdyRCxJQUFNLFFBQVEsR0FBRyxDQUFDLFVBQVUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLElBQUksUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7UUFDekUsZ0dBQWdHO1FBQ2hHLEVBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUMsQ0FBQyxDQUFDLHNCQUU1QixHQUFHLENBQUMsU0FBUyxDQUFDLE9BQU8sRUFBRSxRQUFRLENBQUMsT0FBTyxDQUFDLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQ2xFLEdBQUcsQ0FBQyxhQUFhLENBQUMsVUFBVSxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUMvRCxFQUNDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFDLE1BQU0sUUFBQSxFQUFDLENBQUEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUMxQixDQUFDO0lBRUo7UUFDRSxHQUFDLFNBQVMsSUFBSSxPQUFPLElBQUcsUUFBUTtXQUNoQztBQUNKLENBQUM7QUFFRDs7O0dBR0c7QUFDSCxNQUFNLHlCQUF5QixLQUFnQixFQUFFLFVBQXFDLEVBQUUsT0FBb0I7O0lBQ25HLElBQUEseUJBQVEsRUFBRSxpQkFBSSxFQUFFLG1CQUFLLENBQVU7SUFFdEMsSUFBTSxXQUFXLEdBQUcsT0FBTyxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUM7SUFDakQsSUFBTSxVQUFVLEdBQUcsUUFBUSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ3pDLElBQU0sU0FBUyxHQUFHLEtBQUssQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDL0MsSUFBTSxLQUFLLEdBQUcsS0FBSyxDQUFDLGlCQUFpQixDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBRW5ELElBQU0sTUFBTSxHQUFHLEdBQUcsQ0FBQyxTQUFTLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUVyRCxJQUFNLFFBQVEsR0FBRyxDQUFDLFVBQVUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxRQUFRLElBQUksUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7UUFDekUscUdBQXFHO1FBQ3JHLEVBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUMsQ0FBQSxDQUFDLHNCQUUzQixHQUFHLENBQUMsVUFBVSxDQUFDLE9BQU8sRUFBRSxVQUFVLEVBQUUsUUFBUSxDQUFDLE9BQU8sQ0FBQyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUMvRSxHQUFHLENBQUMsYUFBYSxDQUFDLFVBQVUsRUFBRSxXQUFXLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FDbkUsRUFDRSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBQyxNQUFNLFFBQUEsRUFBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FDNUIsQ0FBQztJQUVKLGdCQUFRLEdBQUMsT0FBTyxJQUFHLFFBQVEsS0FBRTtBQUMvQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtpc0FycmF5fSBmcm9tICd2ZWdhLXV0aWwnO1xuXG5pbXBvcnQge05PTlBPU0lUSU9OX1NDQUxFX0NIQU5ORUxTLCBQb3NpdGlvblNjYWxlQ2hhbm5lbH0gZnJvbSAnLi4vLi4vY2hhbm5lbCc7XG5pbXBvcnQge1xuICBDaGFubmVsRGVmLFxuICBGaWVsZERlZixcbiAgRmllbGREZWZXaXRoQ29uZGl0aW9uLFxuICBnZXRGaWVsZERlZixcbiAgaXNDb25kaXRpb25hbFNlbGVjdGlvbixcbiAgaXNWYWx1ZURlZixcbiAgVGV4dEZpZWxkRGVmLFxuICBWYWx1ZURlZldpdGhDb25kaXRpb24sXG4gIHZnRmllbGQsXG59IGZyb20gJy4uLy4uL2ZpZWxkZGVmJztcbmltcG9ydCAqIGFzIGxvZyBmcm9tICcuLi8uLi9sb2cnO1xuaW1wb3J0IHtNYXJrRGVmfSBmcm9tICcuLi8uLi9tYXJrJztcbmltcG9ydCB7ZXhwcmVzc2lvbn0gZnJvbSAnLi4vLi4vcHJlZGljYXRlJztcbmltcG9ydCB7aGFzQ29udGludW91c0RvbWFpbn0gZnJvbSAnLi4vLi4vc2NhbGUnO1xuaW1wb3J0IHtjb250YWluc30gZnJvbSAnLi4vLi4vdXRpbCc7XG5pbXBvcnQge1ZHX01BUktfQ09ORklHUywgVmdFbmNvZGVFbnRyeSwgVmdWYWx1ZVJlZn0gZnJvbSAnLi4vLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtnZXRNYXJrQ29uZmlnfSBmcm9tICcuLi9jb21tb24nO1xuaW1wb3J0IHtzZWxlY3Rpb25QcmVkaWNhdGV9IGZyb20gJy4uL3NlbGVjdGlvbi9zZWxlY3Rpb24nO1xuaW1wb3J0IHtVbml0TW9kZWx9IGZyb20gJy4uL3VuaXQnO1xuaW1wb3J0ICogYXMgcmVmIGZyb20gJy4vdmFsdWVyZWYnO1xuXG5leHBvcnQgZnVuY3Rpb24gY29sb3IobW9kZWw6IFVuaXRNb2RlbCwgb3B0OiB7dmFsdWVPbmx5OiBib29sZWFufSA9IHt2YWx1ZU9ubHk6IGZhbHNlfSk6IFZnRW5jb2RlRW50cnkge1xuICBjb25zdCB7bWFya0RlZiwgZW5jb2RpbmcsIGNvbmZpZ30gPSBtb2RlbDtcbiAgY29uc3Qge2ZpbGxlZCwgdHlwZTogbWFya1R5cGV9ID0gbWFya0RlZjtcblxuICBjb25zdCBjb25maWdWYWx1ZSA9IHtcbiAgICBmaWxsOiBnZXRNYXJrQ29uZmlnKCdmaWxsJywgbWFya0RlZiwgY29uZmlnKSxcbiAgICBzdHJva2U6IGdldE1hcmtDb25maWcoJ3N0cm9rZScsIG1hcmtEZWYsIGNvbmZpZyksXG4gICAgY29sb3I6IGdldE1hcmtDb25maWcoJ2NvbG9yJywgbWFya0RlZiwgY29uZmlnKVxuICB9O1xuXG4gIGNvbnN0IHRyYW5zcGFyZW50SWZOZWVkZWQgPSBjb250YWlucyhbJ2JhcicsICdwb2ludCcsICdjaXJjbGUnLCAnc3F1YXJlJywgJ2dlb3NoYXBlJ10sIG1hcmtUeXBlKSA/ICd0cmFuc3BhcmVudCcgOiB1bmRlZmluZWQ7XG5cbiAgY29uc3QgZGVmYXVsdFZhbHVlID0ge1xuICAgIGZpbGw6IG1hcmtEZWYuZmlsbCB8fCBjb25maWdWYWx1ZS5maWxsIHx8XG4gICAgLy8gSWYgdGhlcmUgaXMgbm8gZmlsbCwgYWx3YXlzIGZpbGwgc3ltYm9scywgYmFyLCBnZW9zaGFwZVxuICAgIC8vIHdpdGggdHJhbnNwYXJlbnQgZmlsbHMgaHR0cHM6Ly9naXRodWIuY29tL3ZlZ2EvdmVnYS1saXRlL2lzc3Vlcy8xMzE2XG4gICAgICB0cmFuc3BhcmVudElmTmVlZGVkLFxuICAgIHN0cm9rZTogbWFya0RlZi5zdHJva2UgfHwgY29uZmlnVmFsdWUuc3Ryb2tlXG4gIH07XG5cbiAgY29uc3QgY29sb3JWZ0NoYW5uZWwgPSBmaWxsZWQgPyAnZmlsbCcgOiAnc3Ryb2tlJztcblxuICBjb25zdCBmaWxsU3Ryb2tlTWFya0RlZkFuZENvbmZpZzogVmdFbmNvZGVFbnRyeSA9IHtcbiAgICAuLi4oZGVmYXVsdFZhbHVlLmZpbGwgPyB7XG4gICAgICBmaWxsOiB7dmFsdWU6IGRlZmF1bHRWYWx1ZS5maWxsfVxuICAgIH0gOiB7fSksXG4gICAgLi4uKGRlZmF1bHRWYWx1ZS5zdHJva2UgPyB7XG4gICAgICBzdHJva2U6IHt2YWx1ZTogZGVmYXVsdFZhbHVlLnN0cm9rZX1cbiAgICB9IDoge30pLFxuICB9O1xuXG4gIGlmIChlbmNvZGluZy5maWxsIHx8IGVuY29kaW5nLnN0cm9rZSkge1xuICAgIC8vIGlnbm9yZSBlbmNvZGluZy5jb2xvciwgbWFya0RlZi5jb2xvciwgY29uZmlnLmNvbG9yXG4gICAgaWYgKG1hcmtEZWYuY29sb3IpIHtcbiAgICAgIC8vIHdhcm4gZm9yIG1hcmtEZWYuY29sb3IgIChubyBuZWVkIHRvIHdhcm4gZW5jb2RpbmcuY29sb3IgYXMgaXQgd2lsbCBiZSBkcm9wcGVkIGluIG5vcm1hbGl6ZWQgYWxyZWFkeSlcbiAgICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLmRyb3BwaW5nQ29sb3IoJ3Byb3BlcnR5Jywge2ZpbGw6ICdmaWxsJyBpbiBlbmNvZGluZywgc3Ryb2tlOiAnc3Ryb2tlJyBpbiBlbmNvZGluZ30pKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgLi4ubm9uUG9zaXRpb24oJ2ZpbGwnLCBtb2RlbCwge2RlZmF1bHRWYWx1ZTogZGVmYXVsdFZhbHVlLmZpbGwgfHwgdHJhbnNwYXJlbnRJZk5lZWRlZH0pLFxuICAgICAgLi4ubm9uUG9zaXRpb24oJ3N0cm9rZScsIG1vZGVsLCB7ZGVmYXVsdFZhbHVlOiBkZWZhdWx0VmFsdWUuc3Ryb2tlfSlcbiAgICB9O1xuICB9IGVsc2UgaWYgKGVuY29kaW5nLmNvbG9yKSB7XG5cbiAgICByZXR1cm4ge1xuICAgICAgLi4uZmlsbFN0cm9rZU1hcmtEZWZBbmRDb25maWcsXG4gICAgICAvLyBvdmVycmlkZSB0aGVtIHdpdGggZW5jb2RlZCBjb2xvciBmaWVsZFxuICAgICAgLi4ubm9uUG9zaXRpb24oJ2NvbG9yJywgbW9kZWwsIHtcbiAgICAgICAgdmdDaGFubmVsOiBjb2xvclZnQ2hhbm5lbCxcbiAgICAgICAgLy8gYXBwbHkgZGVmYXVsdCBmaWxsL3N0cm9rZSBmaXJzdCwgdGhlbiBjb2xvciBjb25maWcsIHRoZW4gdHJhbnNwYXJlbnQgaWYgbmVlZGVkLlxuICAgICAgICBkZWZhdWx0VmFsdWU6IG1hcmtEZWZbY29sb3JWZ0NoYW5uZWxdIHx8IG1hcmtEZWYuY29sb3IgfHwgY29uZmlnVmFsdWVbY29sb3JWZ0NoYW5uZWxdIHx8IGNvbmZpZ1ZhbHVlLmNvbG9yIHx8IChmaWxsZWQgPyB0cmFuc3BhcmVudElmTmVlZGVkIDogdW5kZWZpbmVkKVxuICAgICAgfSlcbiAgICB9O1xuICB9IGVsc2UgaWYgKG1hcmtEZWYuZmlsbCB8fCBtYXJrRGVmLnN0cm9rZSkge1xuICAgIC8vIElnbm9yZSBtYXJrRGVmLmNvbG9yLCBjb25maWcuY29sb3JcbiAgICBpZiAobWFya0RlZi5jb2xvcikge1xuICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuZHJvcHBpbmdDb2xvcigncHJvcGVydHknLCB7ZmlsbDogJ2ZpbGwnIGluIG1hcmtEZWYsIHN0cm9rZTogJ3N0cm9rZScgaW4gbWFya0RlZn0pKTtcbiAgICB9XG4gICAgcmV0dXJuIGZpbGxTdHJva2VNYXJrRGVmQW5kQ29uZmlnO1xuICB9IGVsc2UgaWYgKG1hcmtEZWYuY29sb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgLi4uZmlsbFN0cm9rZU1hcmtEZWZBbmRDb25maWcsIC8vIGluIHRoaXMgY2FzZSwgZmlsbFN0cm9rZU1hcmtEZWZBbmRDb25maWcgb25seSBpbmNsdWRlIGNvbmZpZ1xuXG4gICAgICAvLyBvdmVycmlkZSBjb25maWcgd2l0aCBtYXJrRGVmLmNvbG9yXG4gICAgICBbY29sb3JWZ0NoYW5uZWxdOiB7dmFsdWU6IG1hcmtEZWYuY29sb3J9XG4gICAgfTtcbiAgfSBlbHNlIGlmIChjb25maWdWYWx1ZS5maWxsIHx8IGNvbmZpZ1ZhbHVlLnN0cm9rZSkge1xuICAgIC8vIGlnbm9yZSBjb25maWcuY29sb3JcbiAgICByZXR1cm4gZmlsbFN0cm9rZU1hcmtEZWZBbmRDb25maWc7XG4gIH0gZWxzZSBpZiAoY29uZmlnVmFsdWUuY29sb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgLi4uKHRyYW5zcGFyZW50SWZOZWVkZWQgPyB7ZmlsbDoge3ZhbHVlOiAndHJhbnNwYXJlbnQnfX0gOiB7fSksXG4gICAgICBbY29sb3JWZ0NoYW5uZWxdOiB7dmFsdWU6IGNvbmZpZ1ZhbHVlLmNvbG9yfVxuICAgIH07XG4gIH1cbiAgcmV0dXJuIHt9O1xufVxuXG5leHBvcnQgdHlwZSBJZ25vcmUgPSBSZWNvcmQ8J3NpemUnIHwgJ29yaWVudCcsICdpZ25vcmUnIHwgJ2luY2x1ZGUnPjtcblxuZXhwb3J0IGZ1bmN0aW9uIGJhc2VFbmNvZGVFbnRyeShtb2RlbDogVW5pdE1vZGVsLCBpZ25vcmU6IElnbm9yZSkge1xuICByZXR1cm4ge1xuICAgIC4uLm1hcmtEZWZQcm9wZXJ0aWVzKG1vZGVsLm1hcmtEZWYsIGlnbm9yZSksXG4gICAgLi4uY29sb3IobW9kZWwpLFxuICAgIC4uLm5vblBvc2l0aW9uKCdvcGFjaXR5JywgbW9kZWwpLFxuICAgIC4uLnRvb2x0aXAobW9kZWwpLFxuICAgIC4uLnRleHQobW9kZWwsICdocmVmJylcbiAgfTtcbn1cblxuZnVuY3Rpb24gbWFya0RlZlByb3BlcnRpZXMobWFyazogTWFya0RlZiwgaWdub3JlOiBJZ25vcmUpIHtcbiAgcmV0dXJuIFZHX01BUktfQ09ORklHUy5yZWR1Y2UoKG0sIHByb3ApID0+IHtcbiAgICBpZiAobWFya1twcm9wXSAhPT0gdW5kZWZpbmVkICYmIGlnbm9yZVtwcm9wXSAhPT0gJ2lnbm9yZScpIHtcbiAgICAgIG1bcHJvcF0gPSB7dmFsdWU6IG1hcmtbcHJvcF19O1xuICAgIH1cbiAgICByZXR1cm4gbTtcbiAgfSwge30pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsdWVJZkRlZmluZWQocHJvcDogc3RyaW5nLCB2YWx1ZTogc3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbik6IFZnRW5jb2RlRW50cnkge1xuICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiB7W3Byb3BdOiB7dmFsdWU6IHZhbHVlfX07XG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuZnVuY3Rpb24gdmFsaWRQcmVkaWNhdGUodmdSZWY6IHN0cmluZykge1xuICByZXR1cm4gYCR7dmdSZWZ9ICE9PSBudWxsICYmICFpc05hTigke3ZnUmVmfSlgO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVmaW5lZChtb2RlbDogVW5pdE1vZGVsKTogVmdFbmNvZGVFbnRyeSB7XG4gIGlmIChtb2RlbC5jb25maWcuaW52YWxpZFZhbHVlcyA9PT0gJ2ZpbHRlcicpIHtcbiAgICBjb25zdCBmaWVsZHMgPSBbJ3gnLCAneSddLm1hcCgoY2hhbm5lbDogUG9zaXRpb25TY2FsZUNoYW5uZWwpID0+IHtcbiAgICAgICAgY29uc3Qgc2NhbGVDb21wb25lbnQgPSBtb2RlbC5nZXRTY2FsZUNvbXBvbmVudChjaGFubmVsKTtcbiAgICAgICAgaWYgKHNjYWxlQ29tcG9uZW50KSB7XG4gICAgICAgICAgY29uc3Qgc2NhbGVUeXBlID0gc2NhbGVDb21wb25lbnQuZ2V0KCd0eXBlJyk7XG5cbiAgICAgICAgICAvLyBEaXNjcmV0ZSBkb21haW4gc2NhbGVzIGNhbiBoYW5kbGUgaW52YWxpZCB2YWx1ZXMsIGJ1dCBjb250aW51b3VzIHNjYWxlcyBjYW4ndC5cbiAgICAgICAgICBpZiAoaGFzQ29udGludW91c0RvbWFpbihzY2FsZVR5cGUpKSB7XG4gICAgICAgICAgICByZXR1cm4gbW9kZWwudmdGaWVsZChjaGFubmVsLCB7ZXhwcjogJ2RhdHVtJ30pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgfSlcbiAgICAgIC5maWx0ZXIoZmllbGQgPT4gISFmaWVsZClcbiAgICAgIC5tYXAodmFsaWRQcmVkaWNhdGUpO1xuXG4gICAgaWYgKGZpZWxkcy5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBkZWZpbmVkOiB7c2lnbmFsOiBmaWVsZHMuam9pbignICYmICcpfVxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge307XG59XG5cbi8qKlxuICogUmV0dXJuIG1peGlucyBmb3Igbm9uLXBvc2l0aW9uYWwgY2hhbm5lbHMgd2l0aCBzY2FsZXMuICAoVGV4dCBkb2Vzbid0IGhhdmUgc2NhbGUuKVxuICovXG5leHBvcnQgZnVuY3Rpb24gbm9uUG9zaXRpb24oY2hhbm5lbDogdHlwZW9mIE5PTlBPU0lUSU9OX1NDQUxFX0NIQU5ORUxTWzBdLCBtb2RlbDogVW5pdE1vZGVsLCBvcHQ6IHtkZWZhdWx0VmFsdWU/OiBudW1iZXIgfCBzdHJpbmcgfCBib29sZWFuLCB2Z0NoYW5uZWw/OiBzdHJpbmcsIGRlZmF1bHRSZWY/OiBWZ1ZhbHVlUmVmfSA9IHt9KTogVmdFbmNvZGVFbnRyeSB7XG4gIGNvbnN0IHtkZWZhdWx0VmFsdWUsIHZnQ2hhbm5lbH0gPSBvcHQ7XG4gIGNvbnN0IGRlZmF1bHRSZWYgPSBvcHQuZGVmYXVsdFJlZiB8fCAoZGVmYXVsdFZhbHVlICE9PSB1bmRlZmluZWQgPyB7dmFsdWU6IGRlZmF1bHRWYWx1ZX0gOiB1bmRlZmluZWQpO1xuXG4gIGNvbnN0IGNoYW5uZWxEZWYgPSBtb2RlbC5lbmNvZGluZ1tjaGFubmVsXTtcblxuICByZXR1cm4gd3JhcENvbmRpdGlvbihtb2RlbCwgY2hhbm5lbERlZiwgdmdDaGFubmVsIHx8IGNoYW5uZWwsIChjRGVmKSA9PiB7XG4gICAgcmV0dXJuIHJlZi5taWRQb2ludChcbiAgICAgIGNoYW5uZWwsIGNEZWYsIG1vZGVsLnNjYWxlTmFtZShjaGFubmVsKSxcbiAgICAgIG1vZGVsLmdldFNjYWxlQ29tcG9uZW50KGNoYW5uZWwpLFxuICAgICAgbnVsbCwgLy8gTm8gbmVlZCB0byBwcm92aWRlIHN0YWNrIGZvciBub24tcG9zaXRpb24gYXMgaXQgZG9lcyBub3QgYWZmZWN0IG1pZCBwb2ludFxuICAgICAgZGVmYXVsdFJlZlxuICAgICk7XG4gIH0pO1xufVxuXG4vKipcbiAqIFJldHVybiBhIG1peGluIHRoYXQgaW5jbHVkZSBhIFZlZ2EgcHJvZHVjdGlvbiBydWxlIGZvciBhIFZlZ2EtTGl0ZSBjb25kaXRpb25hbCBjaGFubmVsIGRlZmluaXRpb24uXG4gKiBvciBhIHNpbXBsZSBtaXhpbiBpZiBjaGFubmVsIGRlZiBoYXMgbm8gY29uZGl0aW9uLlxuICovXG5leHBvcnQgZnVuY3Rpb24gd3JhcENvbmRpdGlvbihcbiAgICBtb2RlbDogVW5pdE1vZGVsLCBjaGFubmVsRGVmOiBDaGFubmVsRGVmPHN0cmluZz4sIHZnQ2hhbm5lbDogc3RyaW5nLFxuICAgIHJlZkZuOiAoY0RlZjogQ2hhbm5lbERlZjxzdHJpbmc+KSA9PiBWZ1ZhbHVlUmVmXG4gICk6IFZnRW5jb2RlRW50cnkge1xuICBjb25zdCBjb25kaXRpb24gPSBjaGFubmVsRGVmICYmIGNoYW5uZWxEZWYuY29uZGl0aW9uO1xuICBjb25zdCB2YWx1ZVJlZiA9IHJlZkZuKGNoYW5uZWxEZWYpO1xuICBpZiAoY29uZGl0aW9uKSB7XG4gICAgY29uc3QgY29uZGl0aW9ucyA9IGlzQXJyYXkoY29uZGl0aW9uKSA/IGNvbmRpdGlvbiA6IFtjb25kaXRpb25dO1xuICAgIGNvbnN0IHZnQ29uZGl0aW9ucyA9IGNvbmRpdGlvbnMubWFwKChjKSA9PiB7XG4gICAgICBjb25zdCBjb25kaXRpb25WYWx1ZVJlZiA9IHJlZkZuKGMpO1xuICAgICAgY29uc3QgdGVzdCA9IGlzQ29uZGl0aW9uYWxTZWxlY3Rpb24oYykgPyBzZWxlY3Rpb25QcmVkaWNhdGUobW9kZWwsIGMuc2VsZWN0aW9uKSA6IGV4cHJlc3Npb24obW9kZWwsIGMudGVzdCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0ZXN0LFxuICAgICAgICAuLi5jb25kaXRpb25WYWx1ZVJlZlxuICAgICAgfTtcbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgW3ZnQ2hhbm5lbF06IFtcbiAgICAgICAgLi4udmdDb25kaXRpb25zLFxuICAgICAgICAuLi4odmFsdWVSZWYgIT09IHVuZGVmaW5lZCA/IFt2YWx1ZVJlZl0gOiBbXSlcbiAgICAgIF1cbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB2YWx1ZVJlZiAhPT0gdW5kZWZpbmVkID8ge1t2Z0NoYW5uZWxdOiB2YWx1ZVJlZn0gOiB7fTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdG9vbHRpcChtb2RlbDogVW5pdE1vZGVsKSB7XG4gIGNvbnN0IGNoYW5uZWwgPSAndG9vbHRpcCc7XG4gIGNvbnN0IGNoYW5uZWxEZWYgPSBtb2RlbC5lbmNvZGluZ1tjaGFubmVsXTtcbiAgaWYgKGlzQXJyYXkoY2hhbm5lbERlZikpIHtcbiAgICBjb25zdCBrZXlWYWx1ZXMgPSBjaGFubmVsRGVmLm1hcCgoZmllbGREZWYpID0+IHtcbiAgICAgIGNvbnN0IGtleSA9IGZpZWxkRGVmLnRpdGxlICE9PSB1bmRlZmluZWQgPyBmaWVsZERlZi50aXRsZSA6IHZnRmllbGQoZmllbGREZWYsIHtiaW5TdWZmaXg6ICdyYW5nZSd9KTtcbiAgICAgIGNvbnN0IHZhbHVlID0gcmVmLnRleHQoZmllbGREZWYsIG1vZGVsLmNvbmZpZykuc2lnbmFsO1xuICAgICAgcmV0dXJuIGBcIiR7a2V5fVwiOiAke3ZhbHVlfWA7XG4gICAgfSk7XG4gICAgcmV0dXJuIHt0b29sdGlwOiB7c2lnbmFsOiBgeyR7a2V5VmFsdWVzLmpvaW4oJywgJyl9fWB9fTtcbiAgfSBlbHNlIHtcbiAgICAvLyBpZiBub3QgYW4gYXJyYXksIGJlaGF2ZSBqdXN0IGxpa2UgdGV4dFxuICAgIHJldHVybiB0ZXh0Q29tbW9uKG1vZGVsLCBjaGFubmVsLCBjaGFubmVsRGVmKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdGV4dChtb2RlbDogVW5pdE1vZGVsLCBjaGFubmVsOiAndGV4dCcgfCAnaHJlZicgPSAndGV4dCcpIHtcbiAgY29uc3QgY2hhbm5lbERlZiA9IG1vZGVsLmVuY29kaW5nW2NoYW5uZWxdO1xuICByZXR1cm4gdGV4dENvbW1vbihtb2RlbCwgY2hhbm5lbCwgY2hhbm5lbERlZik7XG59XG5cbmZ1bmN0aW9uIHRleHRDb21tb24obW9kZWw6IFVuaXRNb2RlbCwgY2hhbm5lbDogJ3RleHQnIHwgJ2hyZWYnIHwgJ3Rvb2x0aXAnLCBjaGFubmVsRGVmOiBGaWVsZERlZldpdGhDb25kaXRpb248VGV4dEZpZWxkRGVmPHN0cmluZz4+IHwgVmFsdWVEZWZXaXRoQ29uZGl0aW9uPFRleHRGaWVsZERlZjxzdHJpbmc+Pikge1xuICByZXR1cm4gd3JhcENvbmRpdGlvbihtb2RlbCwgY2hhbm5lbERlZiwgY2hhbm5lbCwgKGNEZWYpID0+IHJlZi50ZXh0KGNEZWYsIG1vZGVsLmNvbmZpZykpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYmFuZFBvc2l0aW9uKGZpZWxkRGVmOiBGaWVsZERlZjxzdHJpbmc+LCBjaGFubmVsOiAneCd8J3knLCBtb2RlbDogVW5pdE1vZGVsKSB7XG4gIGNvbnN0IHNjYWxlTmFtZSA9IG1vZGVsLnNjYWxlTmFtZShjaGFubmVsKTtcbiAgY29uc3Qgc2l6ZUNoYW5uZWwgPSBjaGFubmVsID09PSAneCcgPyAnd2lkdGgnIDogJ2hlaWdodCc7XG5cbiAgaWYgKG1vZGVsLmVuY29kaW5nLnNpemUgfHwgbW9kZWwubWFya0RlZi5zaXplICE9PSB1bmRlZmluZWQpIHtcbiAgICBjb25zdCBvcmllbnQgPSBtb2RlbC5tYXJrRGVmLm9yaWVudDtcbiAgICBpZiAob3JpZW50KSB7XG4gICAgICBjb25zdCBjZW50ZXJlZEJhbmRQb3NpdGlvbk1peGlucyA9IHtcbiAgICAgICAgLy8gVXNlIHhjL3ljIGFuZCBwbGFjZSB0aGUgbWFyayBhdCB0aGUgbWlkZGxlIG9mIHRoZSBiYW5kXG4gICAgICAgIC8vIFRoaXMgd2F5IHdlIG5ldmVyIGhhdmUgdG8gZGVhbCB3aXRoIHNpemUncyBjb25kaXRpb24gZm9yIHgveSBwb3NpdGlvbi5cbiAgICAgICAgW2NoYW5uZWwrJ2MnXTogcmVmLmZpZWxkUmVmKGZpZWxkRGVmLCBzY2FsZU5hbWUsIHt9LCB7YmFuZDogMC41fSlcbiAgICAgIH07XG5cbiAgICAgIGlmIChnZXRGaWVsZERlZihtb2RlbC5lbmNvZGluZy5zaXplKSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLmNlbnRlcmVkQmFuZFBvc2l0aW9uTWl4aW5zLFxuICAgICAgICAgIC4uLm5vblBvc2l0aW9uKCdzaXplJywgbW9kZWwsIHt2Z0NoYW5uZWw6IHNpemVDaGFubmVsfSlcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSBpZiAoaXNWYWx1ZURlZihtb2RlbC5lbmNvZGluZy5zaXplKSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLmNlbnRlcmVkQmFuZFBvc2l0aW9uTWl4aW5zLFxuICAgICAgICAgIC4uLm5vblBvc2l0aW9uKCdzaXplJywgbW9kZWwsIHt2Z0NoYW5uZWw6IHNpemVDaGFubmVsfSlcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSBpZiAobW9kZWwubWFya0RlZi5zaXplICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5jZW50ZXJlZEJhbmRQb3NpdGlvbk1peGlucyxcbiAgICAgICAgICBbc2l6ZUNoYW5uZWxdOiB7dmFsdWU6IG1vZGVsLm1hcmtEZWYuc2l6ZX1cbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuY2Fubm90QXBwbHlTaXplVG9Ob25PcmllbnRlZE1hcmsobW9kZWwubWFya0RlZi50eXBlKSk7XG4gICAgfVxuICB9XG4gIHJldHVybiB7XG4gICAgW2NoYW5uZWxdOiByZWYuZmllbGRSZWYoZmllbGREZWYsIHNjYWxlTmFtZSwge2JpblN1ZmZpeDogJ3JhbmdlJ30pLFxuICAgIFtzaXplQ2hhbm5lbF06IHJlZi5iYW5kUmVmKHNjYWxlTmFtZSlcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNlbnRlcmVkQmFuZFBvc2l0aW9uKGNoYW5uZWw6ICd4JyB8ICd5JywgbW9kZWw6IFVuaXRNb2RlbCwgZGVmYXVsdFBvc1JlZjogVmdWYWx1ZVJlZiwgZGVmYXVsdFNpemVSZWY6IFZnVmFsdWVSZWYpIHtcbiAgY29uc3QgY2VudGVyQ2hhbm5lbDogJ3hjJyB8ICd5YycgPSBjaGFubmVsID09PSAneCcgPyAneGMnIDogJ3ljJztcbiAgY29uc3Qgc2l6ZUNoYW5uZWwgPSBjaGFubmVsID09PSAneCcgPyAnd2lkdGgnIDogJ2hlaWdodCc7XG4gIHJldHVybiB7XG4gICAgLi4ucG9pbnRQb3NpdGlvbihjaGFubmVsLCBtb2RlbCwgZGVmYXVsdFBvc1JlZiwgY2VudGVyQ2hhbm5lbCksXG4gICAgLi4ubm9uUG9zaXRpb24oJ3NpemUnLCBtb2RlbCwge2RlZmF1bHRSZWY6IGRlZmF1bHRTaXplUmVmLCB2Z0NoYW5uZWw6IHNpemVDaGFubmVsfSlcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJpbm5lZFBvc2l0aW9uKGZpZWxkRGVmOiBGaWVsZERlZjxzdHJpbmc+LCBjaGFubmVsOiAneCd8J3knLCBzY2FsZU5hbWU6IHN0cmluZywgc3BhY2luZzogbnVtYmVyLCByZXZlcnNlOiBib29sZWFuKSB7XG4gIGlmIChjaGFubmVsID09PSAneCcpIHtcbiAgICByZXR1cm4ge1xuICAgICAgeDI6IHJlZi5iaW4oZmllbGREZWYsIHNjYWxlTmFtZSwgJ3N0YXJ0JywgcmV2ZXJzZSA/IDAgOiBzcGFjaW5nKSxcbiAgICAgIHg6IHJlZi5iaW4oZmllbGREZWYsIHNjYWxlTmFtZSwgJ2VuZCcsIHJldmVyc2UgPyBzcGFjaW5nIDogMClcbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB7XG4gICAgICB5MjogcmVmLmJpbihmaWVsZERlZiwgc2NhbGVOYW1lLCAnc3RhcnQnLCByZXZlcnNlID8gc3BhY2luZyA6IDApLFxuICAgICAgeTogcmVmLmJpbihmaWVsZERlZiwgc2NhbGVOYW1lLCAnZW5kJywgcmV2ZXJzZSA/IDAgOiBzcGFjaW5nKVxuICAgIH07XG4gIH1cbn1cblxuXG4vKipcbiAqIFJldHVybiBtaXhpbnMgZm9yIHBvaW50IChub24tYmFuZCkgcG9zaXRpb24gY2hhbm5lbHMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwb2ludFBvc2l0aW9uKGNoYW5uZWw6ICd4J3wneScsIG1vZGVsOiBVbml0TW9kZWwsIGRlZmF1bHRSZWY6IFZnVmFsdWVSZWYgfCAnemVyb09yTWluJyB8ICd6ZXJvT3JNYXgnLCB2Z0NoYW5uZWw/OiAneCd8J3knfCd4Yyd8J3ljJykge1xuICAvLyBUT0RPOiByZWZhY3RvciBob3cgcmVmZXIgdG8gc2NhbGUgYXMgZGlzY3Vzc2VkIGluIGh0dHBzOi8vZ2l0aHViLmNvbS92ZWdhL3ZlZ2EtbGl0ZS9wdWxsLzE2MTNcblxuICBjb25zdCB7ZW5jb2RpbmcsIG1hcmssIHN0YWNrfSA9IG1vZGVsO1xuXG4gIGNvbnN0IGNoYW5uZWxEZWYgPSBlbmNvZGluZ1tjaGFubmVsXTtcbiAgY29uc3Qgc2NhbGVOYW1lID0gbW9kZWwuc2NhbGVOYW1lKGNoYW5uZWwpO1xuICBjb25zdCBzY2FsZSA9IG1vZGVsLmdldFNjYWxlQ29tcG9uZW50KGNoYW5uZWwpO1xuXG5cbiAgY29uc3Qgb2Zmc2V0ID0gcmVmLmdldE9mZnNldChjaGFubmVsLCBtb2RlbC5tYXJrRGVmKTtcblxuXG4gIGNvbnN0IHZhbHVlUmVmID0gIWNoYW5uZWxEZWYgJiYgKGVuY29kaW5nLmxhdGl0dWRlIHx8IGVuY29kaW5nLmxvbmdpdHVkZSkgP1xuICAgIC8vIHVzZSBnZW9wb2ludCBvdXRwdXQgaWYgdGhlcmUgYXJlIGxhdC9sb25nIGFuZCB0aGVyZSBpcyBubyBwb2ludCBwb3NpdGlvbiBvdmVycmlkaW5nIGxhdC9sb25nLlxuICAgIHtmaWVsZDogbW9kZWwuZ2V0TmFtZShjaGFubmVsKX0gOlxuICAgIHtcbiAgICAgIC4uLnJlZi5zdGFja2FibGUoY2hhbm5lbCwgZW5jb2RpbmdbY2hhbm5lbF0sIHNjYWxlTmFtZSwgc2NhbGUsIHN0YWNrLFxuICAgICAgICByZWYuZ2V0RGVmYXVsdFJlZihkZWZhdWx0UmVmLCBjaGFubmVsLCBzY2FsZU5hbWUsIHNjYWxlLCBtYXJrKVxuICAgICAgKSxcbiAgICAgLi4uKG9mZnNldCA/IHtvZmZzZXR9OiB7fSlcbiAgICB9O1xuXG4gIHJldHVybiB7XG4gICAgW3ZnQ2hhbm5lbCB8fCBjaGFubmVsXTogdmFsdWVSZWZcbiAgfTtcbn1cblxuLyoqXG4gKiBSZXR1cm4gbWl4aW5zIGZvciB4MiwgeTIuXG4gKiBJZiBjaGFubmVsIGlzIG5vdCBzcGVjaWZpZWQsIHJldHVybiBvbmUgY2hhbm5lbCBiYXNlZCBvbiBvcmllbnRhdGlvbi5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBvaW50UG9zaXRpb24yKG1vZGVsOiBVbml0TW9kZWwsIGRlZmF1bHRSZWY6ICd6ZXJvT3JNaW4nIHwgJ3plcm9Pck1heCcsIGNoYW5uZWw6ICd4MicgfCAneTInKSB7XG4gIGNvbnN0IHtlbmNvZGluZywgbWFyaywgc3RhY2t9ID0gbW9kZWw7XG5cbiAgY29uc3QgYmFzZUNoYW5uZWwgPSBjaGFubmVsID09PSAneDInID8gJ3gnIDogJ3knO1xuICBjb25zdCBjaGFubmVsRGVmID0gZW5jb2RpbmdbYmFzZUNoYW5uZWxdO1xuICBjb25zdCBzY2FsZU5hbWUgPSBtb2RlbC5zY2FsZU5hbWUoYmFzZUNoYW5uZWwpO1xuICBjb25zdCBzY2FsZSA9IG1vZGVsLmdldFNjYWxlQ29tcG9uZW50KGJhc2VDaGFubmVsKTtcblxuICBjb25zdCBvZmZzZXQgPSByZWYuZ2V0T2Zmc2V0KGNoYW5uZWwsIG1vZGVsLm1hcmtEZWYpO1xuXG4gIGNvbnN0IHZhbHVlUmVmID0gIWNoYW5uZWxEZWYgJiYgKGVuY29kaW5nLmxhdGl0dWRlIHx8IGVuY29kaW5nLmxvbmdpdHVkZSkgP1xuICAgIC8vIHVzZSBnZW9wb2ludCBvdXRwdXQgaWYgdGhlcmUgYXJlIGxhdDIvbG9uZzIgYW5kIHRoZXJlIGlzIG5vIHBvaW50IHBvc2l0aW9uMiBvdmVycmlkaW5nIGxhdDIvbG9uZzIuXG4gICAge2ZpZWxkOiBtb2RlbC5nZXROYW1lKGNoYW5uZWwpfTpcbiAgICB7XG4gICAgICAuLi5yZWYuc3RhY2thYmxlMihjaGFubmVsLCBjaGFubmVsRGVmLCBlbmNvZGluZ1tjaGFubmVsXSwgc2NhbGVOYW1lLCBzY2FsZSwgc3RhY2ssXG4gICAgICAgIHJlZi5nZXREZWZhdWx0UmVmKGRlZmF1bHRSZWYsIGJhc2VDaGFubmVsLCBzY2FsZU5hbWUsIHNjYWxlLCBtYXJrKVxuICAgICAgKSxcbiAgICAgIC4uLihvZmZzZXQgPyB7b2Zmc2V0fSA6IHt9KVxuICAgIH07XG5cbiAgcmV0dXJuIHtbY2hhbm5lbF06IHZhbHVlUmVmfTtcbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { isArray } from 'vega-util';\nimport { isScaleChannel } from '../channel';\nimport { isScaleFieldDef, isTimeFieldDef, vgField } from '../fielddef';\nimport { ScaleType } from '../scale';\nimport { formatExpression } from '../timeunit';\nimport { QUANTITATIVE } from '../type';\nimport { contains, keys, stringify } from '../util';\nimport { wrapCondition } from './mark/mixins';\nexport function applyConfig(e, config, // TODO(#1842): consolidate MarkConfig | TextConfig?\npropsList) {\n    for (var _i = 0, propsList_1 = propsList; _i < propsList_1.length; _i++) {\n        var property = propsList_1[_i];\n        var value = config[property];\n        if (value !== undefined) {\n            e[property] = { value: value };\n        }\n    }\n    return e;\n}\nexport function applyMarkConfig(e, model, propsList) {\n    for (var _i = 0, propsList_2 = propsList; _i < propsList_2.length; _i++) {\n        var property = propsList_2[_i];\n        var value = getMarkConfig(property, model.markDef, model.config);\n        if (value !== undefined) {\n            e[property] = { value: value };\n        }\n    }\n    return e;\n}\nexport function getStyles(mark) {\n    return [].concat(mark.type, mark.style || []);\n}\n/**\n * Return property value from style or mark specific config property if exists.\n * Otherwise, return general mark specific config.\n */\nexport function getMarkConfig(prop, mark, config) {\n    // By default, read from mark config first!\n    var value = config.mark[prop];\n    // Then read mark specific config, which has higher precedence\n    var markSpecificConfig = config[mark.type];\n    if (markSpecificConfig[prop] !== undefined) {\n        value = markSpecificConfig[prop];\n    }\n    // Then read style config, which has even higher precedence.\n    var styles = getStyles(mark);\n    for (var _i = 0, styles_1 = styles; _i < styles_1.length; _i++) {\n        var style = styles_1[_i];\n        var styleConfig = config.style[style];\n        // MarkConfig extends VgMarkConfig so a prop may not be a valid property for style\n        // However here we also check if it is defined, so it is okay to cast here\n        var p = prop;\n        if (styleConfig && styleConfig[p] !== undefined) {\n            value = styleConfig[p];\n        }\n    }\n    return value;\n}\nexport function formatSignalRef(fieldDef, specifiedFormat, expr, config) {\n    var format = numberFormat(fieldDef, specifiedFormat, config);\n    if (fieldDef.bin) {\n        var startField = vgField(fieldDef, { expr: expr });\n        var endField = vgField(fieldDef, { expr: expr, binSuffix: 'end' });\n        return {\n            signal: binFormatExpression(startField, endField, format, config)\n        };\n    }\n    else if (fieldDef.type === 'quantitative') {\n        return {\n            signal: \"\" + formatExpr(vgField(fieldDef, { expr: expr, binSuffix: 'range' }), format)\n        };\n    }\n    else if (isTimeFieldDef(fieldDef)) {\n        var isUTCScale = isScaleFieldDef(fieldDef) && fieldDef['scale'] && fieldDef['scale'].type === ScaleType.UTC;\n        return {\n            signal: timeFormatExpression(vgField(fieldDef, { expr: expr }), fieldDef.timeUnit, specifiedFormat, config.text.shortTimeLabels, config.timeFormat, isUTCScale, true)\n        };\n    }\n    else {\n        return {\n            signal: \"''+\" + vgField(fieldDef, { expr: expr })\n        };\n    }\n}\nexport function getSpecifiedOrDefaultValue(specifiedValue, defaultValue) {\n    if (specifiedValue !== undefined) {\n        return specifiedValue;\n    }\n    return defaultValue;\n}\n/**\n * Returns number format for a fieldDef\n *\n * @param format explicitly specified format\n */\nexport function numberFormat(fieldDef, specifiedFormat, config) {\n    if (fieldDef.type === QUANTITATIVE) {\n        // add number format for quantitative type only\n        // Specified format in axis/legend has higher precedence than fieldDef.format\n        if (specifiedFormat) {\n            return specifiedFormat;\n        }\n        // TODO: need to make this work correctly for numeric ordinal / nominal type\n        return config.numberFormat;\n    }\n    return undefined;\n}\nfunction formatExpr(field, format) {\n    return \"format(\" + field + \", \\\"\" + (format || '') + \"\\\")\";\n}\nexport function numberFormatExpr(field, specifiedFormat, config) {\n    return formatExpr(field, specifiedFormat || config.numberFormat);\n}\nexport function binFormatExpression(startField, endField, format, config) {\n    return startField + \" === null || isNaN(\" + startField + \") ? \\\"null\\\" : \" + numberFormatExpr(startField, format, config) + \" + \\\" - \\\" + \" + numberFormatExpr(endField, format, config);\n}\n/**\n * Returns the time expression used for axis/legend labels or text mark for a temporal field\n */\nexport function timeFormatExpression(field, timeUnit, format, shortTimeLabels, timeFormatConfig, isUTCScale, alwaysReturn) {\n    if (alwaysReturn === void 0) { alwaysReturn = false; }\n    if (!timeUnit || format) {\n        // If there is not time unit, or if user explicitly specify format for axis/legend/text.\n        format = format || timeFormatConfig; // only use config.timeFormat if there is no timeUnit.\n        if (format || alwaysReturn) {\n            return (isUTCScale ? 'utc' : 'time') + \"Format(\" + field + \", '\" + format + \"')\";\n        }\n        else {\n            return undefined;\n        }\n    }\n    else {\n        return formatExpression(timeUnit, field, shortTimeLabels, isUTCScale);\n    }\n}\n/**\n * Return Vega sort parameters (tuple of field and order).\n */\nexport function sortParams(orderDef, fieldRefOption) {\n    return (isArray(orderDef) ? orderDef : [orderDef]).reduce(function (s, orderChannelDef) {\n        s.field.push(vgField(orderChannelDef, fieldRefOption));\n        s.order.push(orderChannelDef.sort || 'ascending');\n        return s;\n    }, { field: [], order: [] });\n}\nexport function mergeTitleFieldDefs(f1, f2) {\n    var merged = f1.slice();\n    f2.forEach(function (fdToMerge) {\n        for (var _i = 0, merged_1 = merged; _i < merged_1.length; _i++) {\n            var fieldDef1 = merged_1[_i];\n            // If already exists, no need to append to merged array\n            if (stringify(fieldDef1) === stringify(fdToMerge)) {\n                return;\n            }\n        }\n        merged.push(fdToMerge);\n    });\n    return merged;\n}\nexport function mergeTitle(title1, title2) {\n    return title1 === title2 ?\n        title1 : // if title is the same just use one of them\n        title1 + ', ' + title2; // join title with comma if different\n}\nexport function mergeTitleComponent(v1, v2) {\n    if (isArray(v1.value) && isArray(v2.value)) {\n        return {\n            explicit: v1.explicit,\n            value: mergeTitleFieldDefs(v1.value, v2.value)\n        };\n    }\n    else if (!isArray(v1.value) && !isArray(v2.value)) {\n        return {\n            explicit: v1.explicit,\n            value: mergeTitle(v1.value, v2.value)\n        };\n    }\n    /* istanbul ignore next: Condition should not happen -- only for warning in development. */\n    throw new Error('It should never reach here');\n}\n/**\n * Checks whether a fieldDef for a particular channel requires a computed bin range.\n */\nexport function binRequiresRange(fieldDef, channel) {\n    if (!fieldDef.bin) {\n        console.warn('Only use this method with binned field defs');\n        return false;\n    }\n    // We need the range only when the user explicitly forces a binned field to be use discrete scale. In this case, bin range is used in axis and legend labels.\n    // We could check whether the axis or legend exists (not disabled) but that seems overkill.\n    return isScaleChannel(channel) && contains(['ordinal', 'nominal'], fieldDef.type);\n}\nexport function guideEncodeEntry(encoding, model) {\n    return keys(encoding).reduce(function (encode, channel) {\n        var valueDef = encoding[channel];\n        return tslib_1.__assign({}, encode, wrapCondition(model, valueDef, channel, function (x) { return ({ value: x.value }); }));\n    }, {});\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tbW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvbXBpbGUvY29tbW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUMsT0FBTyxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBQ2xDLE9BQU8sRUFBVSxjQUFjLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFFbkQsT0FBTyxFQUF5QyxlQUFlLEVBQUUsY0FBYyxFQUEyQixPQUFPLEVBQUMsTUFBTSxhQUFhLENBQUM7QUFHdEksT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLFVBQVUsQ0FBQztBQUNuQyxPQUFPLEVBQUMsZ0JBQWdCLEVBQVcsTUFBTSxhQUFhLENBQUM7QUFDdkQsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLFNBQVMsQ0FBQztBQUNyQyxPQUFPLEVBQUMsUUFBUSxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUMsTUFBTSxTQUFTLENBQUM7QUFHbEQsT0FBTyxFQUFDLGFBQWEsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUs1QyxNQUFNLHNCQUFzQixDQUFnQixFQUN4QyxNQUE0QyxFQUFFLG9EQUFvRDtBQUNsRyxTQUFtQjtJQUNyQixLQUF1QixVQUFTLEVBQVQsdUJBQVMsRUFBVCx1QkFBUyxFQUFULElBQVMsRUFBRTtRQUE3QixJQUFNLFFBQVEsa0JBQUE7UUFDakIsSUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQy9CLElBQUksS0FBSyxLQUFLLFNBQVMsRUFBRTtZQUN2QixDQUFDLENBQUMsUUFBUSxDQUFDLEdBQUcsRUFBQyxLQUFLLEVBQUUsS0FBSyxFQUFDLENBQUM7U0FDOUI7S0FDRjtJQUNELE9BQU8sQ0FBQyxDQUFDO0FBQ1gsQ0FBQztBQUVELE1BQU0sMEJBQTBCLENBQWdCLEVBQUUsS0FBZ0IsRUFBRSxTQUErQjtJQUNqRyxLQUF1QixVQUFTLEVBQVQsdUJBQVMsRUFBVCx1QkFBUyxFQUFULElBQVMsRUFB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Q0osQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBQ1QsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7aXNBcnJheX0gZnJvbSAndmVnYS11dGlsJztcbmltcG9ydCB7Q2hhbm5lbCwgaXNTY2FsZUNoYW5uZWx9IGZyb20gJy4uL2NoYW5uZWwnO1xuaW1wb3J0IHtDb25maWcsIFZpZXdDb25maWd9IGZyb20gJy4uL2NvbmZpZyc7XG5pbXBvcnQge0ZpZWxkRGVmLCBGaWVsZERlZkJhc2UsIEZpZWxkUmVmT3B0aW9uLCBpc1NjYWxlRmllbGREZWYsIGlzVGltZUZpZWxkRGVmLCBPcmRlckZpZWxkRGVmLCBWYWx1ZURlZiwgdmdGaWVsZH0gZnJvbSAnLi4vZmllbGRkZWYnO1xuaW1wb3J0IHtHdWlkZUVuY29kaW5nRW50cnl9IGZyb20gJy4uL2d1aWRlJztcbmltcG9ydCB7TWFya0NvbmZpZywgTWFya0RlZiwgVGV4dENvbmZpZ30gZnJvbSAnLi4vbWFyayc7XG5pbXBvcnQge1NjYWxlVHlwZX0gZnJvbSAnLi4vc2NhbGUnO1xuaW1wb3J0IHtmb3JtYXRFeHByZXNzaW9uLCBUaW1lVW5pdH0gZnJvbSAnLi4vdGltZXVuaXQnO1xuaW1wb3J0IHtRVUFOVElUQVRJVkV9IGZyb20gJy4uL3R5cGUnO1xuaW1wb3J0IHtjb250YWlucywga2V5cywgc3RyaW5naWZ5fSBmcm9tICcuLi91dGlsJztcbmltcG9ydCB7VmdFbmNvZGVDaGFubmVsLCBWZ0VuY29kZUVudHJ5LCBWZ01hcmtDb25maWcsIFZnU29ydH0gZnJvbSAnLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtBeGlzQ29tcG9uZW50UHJvcHN9IGZyb20gJy4vYXhpcy9jb21wb25lbnQnO1xuaW1wb3J0IHt3cmFwQ29uZGl0aW9ufSBmcm9tICcuL21hcmsvbWl4aW5zJztcbmltcG9ydCB7RXhwbGljaXR9IGZyb20gJy4vc3BsaXQnO1xuaW1wb3J0IHtVbml0TW9kZWx9IGZyb20gJy4vdW5pdCc7XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5Q29uZmlnKGU6IFZnRW5jb2RlRW50cnksXG4gICAgY29uZmlnOiBWaWV3Q29uZmlnIHwgTWFya0NvbmZpZyB8IFRleHRDb25maWcsIC8vIFRPRE8oIzE4NDIpOiBjb25zb2xpZGF0ZSBNYXJrQ29uZmlnIHwgVGV4dENvbmZpZz9cbiAgICBwcm9wc0xpc3Q6IHN0cmluZ1tdKSB7XG4gIGZvciAoY29uc3QgcHJvcGVydHkgb2YgcHJvcHNMaXN0KSB7XG4gICAgY29uc3QgdmFsdWUgPSBjb25maWdbcHJvcGVydHldO1xuICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBlW3Byb3BlcnR5XSA9IHt2YWx1ZTogdmFsdWV9O1xuICAgIH1cbiAgfVxuICByZXR1cm4gZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5TWFya0NvbmZpZyhlOiBWZ0VuY29kZUVudHJ5LCBtb2RlbDogVW5pdE1vZGVsLCBwcm9wc0xpc3Q6IChrZXlvZiBNYXJrQ29uZmlnKVtdKSB7XG4gIGZvciAoY29uc3QgcHJvcGVydHkgb2YgcHJvcHNMaXN0KSB7XG4gICAgY29uc3QgdmFsdWUgPSBnZXRNYXJrQ29uZmlnKHByb3BlcnR5LCBtb2RlbC5tYXJrRGVmLCBtb2RlbC5jb25maWcpO1xuICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBlW3Byb3BlcnR5XSA9IHt2YWx1ZTogdmFsdWV9O1xuICAgIH1cbiAgfVxuICByZXR1cm4gZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFN0eWxlcyhtYXJrOiBNYXJrRGVmKTogc3RyaW5nW10ge1xuICByZXR1cm4gW10uY29uY2F0KG1hcmsudHlwZSwgbWFyay5zdHlsZSB8fCBbXSk7XG59XG5cbi8qKlxuICogUmV0dXJuIHByb3BlcnR5IHZhbHVlIGZyb20gc3R5bGUgb3IgbWFyayBzcGVjaWZpYyBjb25maWcgcHJvcGVydHkgaWYgZXhpc3RzLlxuICogT3RoZXJ3aXNlLCByZXR1cm4gZ2VuZXJhbCBtYXJrIHNwZWNpZmljIGNvbmZpZy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldE1hcmtDb25maWc8UCBleHRlbmRzIGtleW9mIE1hcmtDb25maWc+KHByb3A6IFAsIG1hcms6IE1hcmtEZWYsIGNvbmZpZzogQ29uZmlnKTogTWFya0NvbmZpZ1tQXSB7XG4gIC8vIEJ5IGRlZmF1bHQsIHJlYWQgZnJvbSBtYXJrIGNvbmZpZyBmaXJzdCFcbiAgbGV0IHZhbHVlID0gY29uZmlnLm1hcmtbcHJvcF07XG5cbiAgLy8gVGhlbiByZWFkIG1hcmsgc3BlY2lmaWMgY29uZmlnLCB3aGljaCBoYXMgaGlnaGVyIHByZWNlZGVuY2VcbiAgY29uc3QgbWFya1NwZWNpZmljQ29uZmlnID0gY29uZmlnW21hcmsudHlwZV07XG4gIGlmIChtYXJrU3BlY2lmaWNDb25maWdbcHJvcF0gIT09IHVuZGVmaW5lZCkge1xuICAgIHZhbHVlID0gbWFya1NwZWNpZmljQ29uZmlnW3Byb3BdO1xuICB9XG5cbiAgLy8gVGhlbiByZWFkIHN0eWxlIGNvbmZpZywgd2hpY2ggaGFzIGV2ZW4gaGlnaGVyIHByZWNlZGVuY2UuXG4gIGNvbnN0IHN0eWxlcyA9IGdldFN0eWxlcyhtYXJrKTtcbiAgZm9yIChjb25zdCBzdHlsZSBvZiBzdHlsZXMpIHtcbiAgICBjb25zdCBzdHlsZUNvbmZpZyA9IGNvbmZpZy5zdHlsZVtzdHlsZV07XG5cbiAgICAvLyBNYXJrQ29uZmlnIGV4dGVuZHMgVmdNYXJrQ29uZmlnIHNvIGEgcHJvcCBtYXkgbm90IGJlIGEgdmFsaWQgcHJvcGVydHkgZm9yIHN0eWxlXG4gICAgLy8gSG93ZXZlciBoZXJlIHdlIGFsc28gY2hlY2sgaWYgaXQgaXMgZGVmaW5lZCwgc28gaXQgaXMgb2theSB0byBjYXN0IGhlcmVcbiAgICBjb25zdCBwID0gcHJvcCBhcyBrZXlvZiBWZ01hcmtDb25maWc7XG4gICAgaWYgKHN0eWxlQ29uZmlnICYmIHN0eWxlQ29uZmlnW3BdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHZhbHVlID0gc3R5bGVDb25maWdbcF07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHZhbHVlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZm9ybWF0U2lnbmFsUmVmKGZpZWxkRGVmOiBGaWVsZERlZjxzdHJpbmc+LCBzcGVjaWZpZWRGb3JtYXQ6IHN0cmluZywgZXhwcjogJ2RhdHVtJyB8ICdwYXJlbnQnLCBjb25maWc6IENvbmZpZykge1xuICBjb25zdCBmb3JtYXQgPSBudW1iZXJGb3JtYXQoZmllbGREZWYsIHNwZWNpZmllZEZvcm1hdCwgY29uZmlnKTtcbiAgaWYgKGZpZWxkRGVmLmJpbikge1xuICAgIGNvbnN0IHN0YXJ0RmllbGQgPSB2Z0ZpZWxkKGZpZWxkRGVmLCB7ZXhwcn0pO1xuICAgIGNvbnN0IGVuZEZpZWxkID0gdmdGaWVsZChmaWVsZERlZiwge2V4cHIsIGJpblN1ZmZpeDogJ2VuZCd9KTtcbiAgICByZXR1cm4ge1xuICAgICAgc2lnbmFsOiBiaW5Gb3JtYXRFeHByZXNzaW9uKHN0YXJ0RmllbGQsIGVuZEZpZWxkLCBmb3JtYXQsIGNvbmZpZylcbiAgICB9O1xuICB9IGVsc2UgaWYgKGZpZWxkRGVmLnR5cGUgPT09ICdxdWFudGl0YXRpdmUnKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNpZ25hbDogYCR7Zm9ybWF0RXhwcih2Z0ZpZWxkKGZpZWxkRGVmLCB7ZXhwciwgYmluU3VmZml4OiAncmFuZ2UnfSksIGZvcm1hdCl9YFxuICAgIH07XG4gIH0gZWxzZSBpZiAoaXNUaW1lRmllbGREZWYoZmllbGREZWYpKSB7XG4gICAgY29uc3QgaXNVVENTY2FsZSA9IGlzU2NhbGVGaWVsZERlZihmaWVsZERlZikgJiYgZmllbGREZWZbJ3NjYWxlJ10gJiYgZmllbGREZWZbJ3NjYWxlJ10udHlwZSA9PT0gU2NhbGVUeXBlLlVUQztcbiAgICByZXR1cm4ge1xuICAgICAgc2lnbmFsOiB0aW1lRm9ybWF0RXhwcmVzc2lvbih2Z0ZpZWxkKGZpZWxkRGVmLCB7ZXhwcn0pLCBmaWVsZERlZi50aW1lVW5pdCwgc3BlY2lmaWVkRm9ybWF0LCBjb25maWcudGV4dC5zaG9ydFRpbWVMYWJlbHMsIGNvbmZpZy50aW1lRm9ybWF0LCBpc1VUQ1NjYWxlLCB0cnVlKVxuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNpZ25hbDogYCcnKyR7dmdGaWVsZChmaWVsZERlZiwge2V4cHJ9KX1gXG4gICAgfTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0U3BlY2lmaWVkT3JEZWZhdWx0VmFsdWU8VD4oc3BlY2lmaWVkVmFsdWU6IFQsIGRlZmF1bHRWYWx1ZTogVCB8IHtzaWduYWw6IHN0cmluZ30pIHtcbiAgaWYgKHNwZWNpZmllZFZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gc3BlY2lmaWVkVmFsdWU7XG4gIH1cbiAgcmV0dXJuIGRlZmF1bHRWYWx1ZTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIG51bWJlciBmb3JtYXQgZm9yIGEgZmllbGREZWZcbiAqXG4gKiBAcGFyYW0gZm9ybWF0IGV4cGxpY2l0bHkgc3BlY2lmaWVkIGZvcm1hdFxuICovXG5leHBvcnQgZnVuY3Rpb24gbnVtYmVyRm9ybWF0KGZpZWxkRGVmOiBGaWVsZERlZjxzdHJpbmc+LCBzcGVjaWZpZWRGb3JtYXQ6IHN0cmluZywgY29uZmlnOiBDb25maWcpIHtcbiAgaWYgKGZpZWxkRGVmLnR5cGUgPT09IFFVQU5USVRBVElWRSkge1xuICAgIC8vIGFkZCBudW1iZXIgZm9ybWF0IGZvciBxdWFudGl0YXRpdmUgdHlwZSBvbmx5XG5cbiAgICAvLyBTcGVjaWZpZWQgZm9ybWF0IGluIGF4aXMvbGVnZW5kIGhhcyBoaWdoZXIgcHJlY2VkZW5jZSB0aGFuIGZpZWxkRGVmLmZvcm1hdFxuICAgIGlmIChzcGVjaWZpZWRGb3JtYXQpIHtcbiAgICAgIHJldHVybiBzcGVjaWZpZWRGb3JtYXQ7XG4gICAgfVxuXG4gICAgLy8gVE9ETzogbmVlZCB0byBtYWtlIHRoaXMgd29yayBjb3JyZWN0bHkgZm9yIG51bWVyaWMgb3JkaW5hbCAvIG5vbWluYWwgdHlwZVxuICAgIHJldHVybiBjb25maWcubnVtYmVyRm9ybWF0O1xuICB9XG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG5cbmZ1bmN0aW9uIGZvcm1hdEV4cHIoZmllbGQ6IHN0cmluZywgZm9ybWF0OiBzdHJpbmcpIHtcbiAgcmV0dXJuIGBmb3JtYXQoJHtmaWVsZH0sIFwiJHtmb3JtYXQgfHwgJyd9XCIpYDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG51bWJlckZvcm1hdEV4cHIoZmllbGQ6IHN0cmluZywgc3BlY2lmaWVkRm9ybWF0OiBzdHJpbmcsIGNvbmZpZzogQ29uZmlnKSB7XG4gIHJldHVybiBmb3JtYXRFeHByKGZpZWxkLCBzcGVjaWZpZWRGb3JtYXQgfHwgY29uZmlnLm51bWJlckZvcm1hdCk7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGJpbkZvcm1hdEV4cHJlc3Npb24oc3RhcnRGaWVsZDogc3RyaW5nLCBlbmRGaWVsZDogc3RyaW5nLCBmb3JtYXQ6IHN0cmluZywgY29uZmlnOiBDb25maWcpIHtcbiAgcmV0dXJuIGAke3N0YXJ0RmllbGR9ID09PSBudWxsIHx8IGlzTmFOKCR7c3RhcnRGaWVsZH0pID8gXCJudWxsXCIgOiAke251bWJlckZvcm1hdEV4cHIoc3RhcnRGaWVsZCwgZm9ybWF0LCBjb25maWcpfSArIFwiIC0gXCIgKyAke251bWJlckZvcm1hdEV4cHIoZW5kRmllbGQsIGZvcm1hdCwgY29uZmlnKX1gO1xufVxuXG5cbi8qKlxuICogUmV0dXJucyB0aGUgdGltZSBleHByZXNzaW9uIHVzZWQgZm9yIGF4aXMvbGVnZW5kIGxhYmVscyBvciB0ZXh0IG1hcmsgZm9yIGEgdGVtcG9yYWwgZmllbGRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRpbWVGb3JtYXRFeHByZXNzaW9uKGZpZWxkOiBzdHJpbmcsIHRpbWVVbml0OiBUaW1lVW5pdCwgZm9ybWF0OiBzdHJpbmcsIHNob3J0VGltZUxhYmVsczogYm9vbGVhbiwgdGltZUZvcm1hdENvbmZpZzogc3RyaW5nLCBpc1VUQ1NjYWxlOiBib29sZWFuLCBhbHdheXNSZXR1cm46IGJvb2xlYW4gPSBmYWxzZSk6IHN0cmluZyB7XG4gIGlmICghdGltZVVuaXQgfHwgZm9ybWF0KSB7XG4gICAgLy8gSWYgdGhlcmUgaXMgbm90IHRpbWUgdW5pdCwgb3IgaWYgdXNlciBleHBsaWNpdGx5IHNwZWNpZnkgZm9ybWF0IGZvciBheGlzL2xlZ2VuZC90ZXh0LlxuICAgIGZvcm1hdCA9IGZvcm1hdCB8fCB0aW1lRm9ybWF0Q29uZmlnOyAvLyBvbmx5IHVzZSBjb25maWcudGltZUZvcm1hdCBpZiB0aGVyZSBpcyBubyB0aW1lVW5pdC5cblxuICAgIGlmIChmb3JtYXQgfHwgYWx3YXlzUmV0dXJuKSB7XG4gICAgICByZXR1cm4gYCR7aXNVVENTY2FsZSA/ICd1dGMnIDogJ3RpbWUnfUZvcm1hdCgke2ZpZWxkfSwgJyR7Zm9ybWF0fScpYDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGZvcm1hdEV4cHJlc3Npb24odGltZVVuaXQsIGZpZWxkLCBzaG9ydFRpbWVMYWJlbHMsIGlzVVRDU2NhbGUpO1xuICB9XG59XG5cbi8qKlxuICogUmV0dXJuIFZlZ2Egc29ydCBwYXJhbWV0ZXJzICh0dXBsZSBvZiBmaWVsZCBhbmQgb3JkZXIpLlxuICovXG5leHBvcnQgZnVuY3Rpb24gc29ydFBhcmFtcyhvcmRlckRlZjogT3JkZXJGaWVsZERlZjxzdHJpbmc+IHwgT3JkZXJGaWVsZERlZjxzdHJpbmc+W10sIGZpZWxkUmVmT3B0aW9uPzogRmllbGRSZWZPcHRpb24pOiBWZ1NvcnQge1xuICByZXR1cm4gKGlzQXJyYXkob3JkZXJEZWYpID8gb3JkZXJEZWYgOiBbb3JkZXJEZWZdKS5yZWR1Y2UoKHMsIG9yZGVyQ2hhbm5lbERlZikgPT4ge1xuICAgIHMuZmllbGQucHVzaCh2Z0ZpZWxkKG9yZGVyQ2hhbm5lbERlZiwgZmllbGRSZWZPcHRpb24pKTtcbiAgICBzLm9yZGVyLnB1c2gob3JkZXJDaGFubmVsRGVmLnNvcnQgfHwgJ2FzY2VuZGluZycpO1xuICAgIHJldHVybiBzO1xuICB9LCB7ZmllbGQ6W10sIG9yZGVyOiBbXX0pO1xufVxuXG5leHBvcnQgdHlwZSBBeGlzVGl0bGVDb21wb25lbnQgPSBBeGlzQ29tcG9uZW50UHJvcHNbJ3RpdGxlJ107XG5cbmV4cG9ydCBmdW5jdGlvbiBtZXJnZVRpdGxlRmllbGREZWZzKGYxOiBGaWVsZERlZkJhc2U8c3RyaW5nPltdLCBmMjogRmllbGREZWZCYXNlPHN0cmluZz5bXSkge1xuICBjb25zdCBtZXJnZWQgPSBbLi4uZjFdO1xuXG4gIGYyLmZvckVhY2goKGZkVG9NZXJnZSkgPT4ge1xuICAgIGZvciAoY29uc3QgZmllbGREZWYxIG9mIG1lcmdlZCkge1xuICAgICAgLy8gSWYgYWxyZWFkeSBleGlzdHMsIG5vIG5lZWQgdG8gYXBwZW5kIHRvIG1lcmdlZCBhcnJheVxuICAgICAgaWYgKHN0cmluZ2lmeShmaWVsZERlZjEpID09PSBzdHJpbmdpZnkoZmRUb01lcmdlKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICAgIG1lcmdlZC5wdXNoKGZkVG9NZXJnZSk7XG4gIH0pO1xuICByZXR1cm4gbWVyZ2VkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWVyZ2VUaXRsZSh0aXRsZTE6IHN0cmluZywgdGl0bGUyOiBzdHJpbmcpIHtcbiAgcmV0dXJuIHRpdGxlMSA9PT0gdGl0bGUyID9cbiAgICB0aXRsZTEgOiAvLyBpZiB0aXRsZSBpcyB0aGUgc2FtZSBqdXN0IHVzZSBvbmUgb2YgdGhlbVxuICAgIHRpdGxlMSArICcsICcgKyB0aXRsZTI7IC8vIGpvaW4gdGl0bGUgd2l0aCBjb21tYSBpZiBkaWZmZXJlbnRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1lcmdlVGl0bGVDb21wb25lbnQoXG4gIHYxOiBFeHBsaWNpdDxBeGlzVGl0bGVDb21wb25lbnQ+LCB2MjogRXhwbGljaXQ8QXhpc1RpdGxlQ29tcG9uZW50PlxuKSB7XG4gIGlmIChpc0FycmF5KHYxLnZhbHVlKSAmJiBpc0FycmF5KHYyLnZhbHVlKSkge1xuICAgIHJldHVybiB7XG4gICAgICBleHBsaWNpdDogdjEuZXhwbGljaXQsXG4gICAgICB2YWx1ZTogbWVyZ2VUaXRsZUZpZWxkRGVmcyh2MS52YWx1ZSwgdjIudmFsdWUpXG4gICAgfTtcbiAgfSBlbHNlIGlmICghaXNBcnJheSh2MS52YWx1ZSkgJiYgIWlzQXJyYXkodjIudmFsdWUpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGV4cGxpY2l0OiB2MS5leHBsaWNpdCwgLy8ga2VlcCB0aGUgb2xkIGV4cGxpY2l0XG4gICAgICB2YWx1ZTogbWVyZ2VUaXRsZSh2MS52YWx1ZSwgdjIudmFsdWUpXG4gICAgfTtcbiAgfVxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dDogQ29uZGl0aW9uIHNob3VsZCBub3QgaGFwcGVuIC0tIG9ubHkgZm9yIHdhcm5pbmcgaW4gZGV2ZWxvcG1lbnQuICovXG4gIHRocm93IG5ldyBFcnJvcignSXQgc2hvdWxkIG5ldmVyIHJlYWNoIGhlcmUnKTtcbn1cblxuLyoqXG4gKiBDaGVja3Mgd2hldGhlciBhIGZpZWxkRGVmIGZvciBhIHBhcnRpY3VsYXIgY2hhbm5lbCByZXF1aXJlcyBhIGNvbXB1dGVkIGJpbiByYW5nZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGJpblJlcXVpcmVzUmFuZ2UoZmllbGREZWY6IEZpZWxkRGVmPHN0cmluZz4sIGNoYW5uZWw6IENoYW5uZWwpIHtcbiAgaWYgKCFmaWVsZERlZi5iaW4pIHtcbiAgICBjb25zb2xlLndhcm4oJ09ubHkgdXNlIHRoaXMgbWV0aG9kIHdpdGggYmlubmVkIGZpZWxkIGRlZnMnKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvLyBXZSBuZWVkIHRoZSByYW5nZSBvbmx5IHdoZW4gdGhlIHVzZXIgZXhwbGljaXRseSBmb3JjZXMgYSBiaW5uZWQgZmllbGQgdG8gYmUgdXNlIGRpc2NyZXRlIHNjYWxlLiBJbiB0aGlzIGNhc2UsIGJpbiByYW5nZSBpcyB1c2VkIGluIGF4aXMgYW5kIGxlZ2VuZCBsYWJlbHMuXG4gIC8vIFdlIGNvdWxkIGNoZWNrIHdoZXRoZXIgdGhlIGF4aXMgb3IgbGVnZW5kIGV4aXN0cyAobm90IGRpc2FibGVkKSBidXQgdGhhdCBzZWVtcyBvdmVya2lsbC5cbiAgcmV0dXJuIGlzU2NhbGVDaGFubmVsKGNoYW5uZWwpICYmIGNvbnRhaW5zKFsnb3JkaW5hbCcsICdub21pbmFsJ10sIGZpZWxkRGVmLnR5cGUpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ3VpZGVFbmNvZGVFbnRyeShlbmNvZGluZzogR3VpZGVFbmNvZGluZ0VudHJ5LCBtb2RlbDogVW5pdE1vZGVsKSB7XG4gIHJldHVybiBrZXlzKGVuY29kaW5nKS5yZWR1Y2UoKGVuY29kZSwgY2hhbm5lbDogVmdFbmNvZGVDaGFubmVsKSA9PiB7XG4gICAgY29uc3QgdmFsdWVEZWYgPSBlbmNvZGluZ1tjaGFubmVsXTtcbiAgICByZXR1cm4ge1xuICAgICAgLi4uZW5jb2RlLFxuICAgICAgLi4ud3JhcENvbmRpdGlvbihtb2RlbCwgdmFsdWVEZWYsIGNoYW5uZWwsICh4OiBWYWx1ZURlZikgPT4gKHt2YWx1ZTogeC52YWx1ZX0pKVxuICAgIH07XG4gIH0sIHt9KTtcbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { vgField } from '../../fielddef';\nimport { keys } from '../../util';\nimport { formatSignalRef } from '../common';\nexport var HEADER_CHANNELS = ['row', 'column'];\nexport var HEADER_TYPES = ['header', 'footer'];\nexport function getHeaderType(orient) {\n    if (orient === 'top' || orient === 'left') {\n        return 'header';\n    }\n    return 'footer';\n}\nexport function getTitleGroup(model, channel) {\n    var title = model.component.layoutHeaders[channel].title;\n    var textOrient = channel === 'row' ? 'vertical' : undefined;\n    var update = tslib_1.__assign({ align: { value: 'center' }, text: { value: title } }, (textOrient === 'vertical' ? { angle: { value: 270 } } : {}));\n    return {\n        name: model.getName(channel + \"_title\"),\n        role: channel + \"-title\",\n        type: 'group',\n        marks: [tslib_1.__assign({ type: 'text', role: channel + \"-title-text\", style: 'guide-title' }, (keys(update).length > 0 ? { encode: { update: update } } : {}))]\n    };\n}\nexport function getHeaderGroups(model, channel) {\n    var layoutHeader = model.component.layoutHeaders[channel];\n    var groups = [];\n    for (var _i = 0, HEADER_TYPES_1 = HEADER_TYPES; _i < HEADER_TYPES_1.length; _i++) {\n        var headerType = HEADER_TYPES_1[_i];\n        if (layoutHeader[headerType]) {\n            for (var _a = 0, _b = layoutHeader[headerType]; _a < _b.length; _a++) {\n                var headerCmpt = _b[_a];\n                groups.push(getHeaderGroup(model, channel, headerType, layoutHeader, headerCmpt));\n            }\n        }\n    }\n    return groups;\n}\n// 0, (0,90), 90, (90, 180), 180, (180, 270), 270, (270, 0)\nexport function labelAlign(angle) {\n    // to keep angle in [0, 360)\n    angle = ((angle % 360) + 360) % 360;\n    if ((angle + 90) % 180 === 0) { // for 90 and 270\n        return {}; // default center\n    }\n    else if (angle < 90 || 270 < angle) {\n        return { align: { value: 'right' } };\n    }\n    else if (135 <= angle && angle < 225) {\n        return { align: { value: 'left' } };\n    }\n    return {};\n}\nexport function labelBaseline(angle) {\n    // to keep angle in [0, 360)\n    angle = ((angle % 360) + 360) % 360;\n    if (45 <= angle && angle <= 135) {\n        return { baseline: { value: 'top' } };\n    }\n    return {};\n}\nfunction getHeaderGroup(model, channel, headerType, layoutHeader, headerCmpt) {\n    var _a;\n    if (headerCmpt) {\n        var title = null;\n        var facetFieldDef = layoutHeader.facetFieldDef;\n        if (facetFieldDef && headerCmpt.labels) {\n            var _b = facetFieldDef.header, header = _b === void 0 ? {} : _b;\n            var format = header.format, labelAngle = header.labelAngle;\n            var update = tslib_1.__assign({}, (labelAngle !== undefined ? { angle: { value: labelAngle } } : {}), labelAlign(labelAngle), labelBaseline(labelAngle));\n            title = tslib_1.__assign({ text: formatSignalRef(facetFieldDef, format, 'parent', model.config), offset: 10, orient: channel === 'row' ? 'left' : 'top', style: 'guide-label' }, (keys(update).length > 0 ? { encode: { update: update } } : {}));\n        }\n        var axes = headerCmpt.axes;\n        var hasAxes = axes && axes.length > 0;\n        if (title || hasAxes) {\n            var sizeChannel = channel === 'row' ? 'height' : 'width';\n            return tslib_1.__assign({ name: model.getName(channel + \"_\" + headerType), type: 'group', role: channel + \"-\" + headerType }, (layoutHeader.facetFieldDef ? {\n                from: { data: model.getName(channel + '_domain') },\n                sort: {\n                    field: vgField(facetFieldDef, { expr: 'datum' }),\n                    order: facetFieldDef.sort || 'ascending'\n                }\n            } : {}), (title ? { title: title } : {}), (headerCmpt.sizeSignal ? {\n                encode: {\n                    update: (_a = {},\n                        _a[sizeChannel] = headerCmpt.sizeSignal,\n                        _a)\n                }\n            } : {}), (hasAxes ? { axes: axes } : {}));\n        }\n    }\n    return null;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVhZGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvbGF5b3V0L2hlYWRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBSUEsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ3ZDLE9BQU8sRUFBQyxJQUFJLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFFaEMsT0FBTyxFQUFDLGVBQWUsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUkxQyxNQUFNLENBQUMsSUFBTSxlQUFlLEdBQW9CLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0FBR2xFLE1BQU0sQ0FBQyxJQUFNLFlBQVksR0FBaUIsQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUM7QUF3Qy9ELE1BQU0sd0JBQXdCLE1BQWtCO0lBQzlDLElBQUksTUFBTSxLQUFLLEtBQUssSUFBSSxNQUFNLEtBQUssTUFBTSxFQUFFO1FBQ3pDLE9BQU8sUUFBUSxDQUFDO0tBQ2pCO0lBQ0QsT0FBTyxRQUFRLENBQUM7QUFDbEIsQ0FBQztBQUVELE1BQU0sd0JBQXdCLEtBQVksRUFBRSxPQUFzQjtJQUNoRSxJQUFNLEtBQUssR0FBRyxLQUFLLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxLQUFLLENBQUM7SUFDM0QsSUFBTSxVQUFVLEdBQUcsT0FBTyxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7SUFFOUQsSUFBTSxNQUFNLHNCQUNWLEtBQUssRUFBRSxFQUFDLEtBQUssRUFBRSxRQUFRLEVBQUMsRUFDeEIsSUFBSSxFQUFFLEVBQUMsS0FBSyxFQUFFLEtBQUssRUFBQyxJQUNqQixDQUFDLFVBQVUsS0FBSyxVQUFVLENBQUMsQ0FBQyxDQUFDLEVBQUMsS0FBSyxFQUFFLEVBQUMsS0FBSyxFQUFFLEdBQUcsRUFBQyxFQUFDLENBQUEsQ0FBQyxDQUFDLEVB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T0FBTyxTQUFJLFVBQVksSUFDN0IsQ0FBQyxZQUFZLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQztnQkFDL0IsSUFBSSxFQUFFLEVBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxHQUFHLFNBQVMsQ0FBQyxFQUFDO2dCQUNoRCxJQUFJLEVBQUU7b0JBQ0osS0FBSyxFQUFFLE9BQU8sQ0FBQyxhQUFhLEVBQUUsRUFBQyxJQUFJLEVBQUUsT0FBTyxFQUFDLENBQUM7b0JBQzlDLEtBQUssRUFBRSxhQUFhLENBQUMsSUFBSSxJQUFJLFdBQVc7aUJBQ3pDO2FBQ0YsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQ0osQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUMsS0FBSyxPQUFBLEVBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQ3RCLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7Z0JBQzFCLE1BQU0sRUFBRTtvQkFDTixNQUFNO3dCQUNKLEdBQUMsV0FBVyxJQUFHLFVBQVUsQ0FBQyxVQUFVOzJCQUNyQztpQkFDRjthQUNGLENBQUEsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUNILENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFDLElBQUksTUFBQSxFQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUMxQjtTQUNIO0tBQ0Y7SUFDRCxPQUFPLElBQUksQ0FBQztBQUNkLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFV0aWxpdHkgZm9yIGdlbmVyYXRpbmcgcm93IC8gY29sdW1uIGhlYWRlcnNcbiAqL1xuaW1wb3J0IHtGYWNldEZpZWxkRGVmfSBmcm9tICcuLi8uLi9mYWNldCc7XG5pbXBvcnQge3ZnRmllbGR9IGZyb20gJy4uLy4uL2ZpZWxkZGVmJztcbmltcG9ydCB7a2V5c30gZnJvbSAnLi4vLi4vdXRpbCc7XG5pbXBvcnQge0F4aXNPcmllbnQsIFZnQXhpcywgVmdNYXJrR3JvdXB9IGZyb20gJy4uLy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7Zm9ybWF0U2lnbmFsUmVmfSBmcm9tICcuLi9jb21tb24nO1xuaW1wb3J0IHtNb2RlbH0gZnJvbSAnLi4vbW9kZWwnO1xuXG5leHBvcnQgdHlwZSBIZWFkZXJDaGFubmVsID0gJ3JvdycgfCAnY29sdW1uJztcbmV4cG9ydCBjb25zdCBIRUFERVJfQ0hBTk5FTFM6IEhlYWRlckNoYW5uZWxbXSA9IFsncm93JywgJ2NvbHVtbiddO1xuXG5leHBvcnQgdHlwZSBIZWFkZXJUeXBlID0gJ2hlYWRlcicgfCAnZm9vdGVyJztcbmV4cG9ydCBjb25zdCBIRUFERVJfVFlQRVM6IEhlYWRlclR5cGVbXSA9IFsnaGVhZGVyJywgJ2Zvb3RlciddO1xuXG4vKipcbiAqIEEgY29tcG9uZW50IHRoYXQgcmVwcmVzZW50cyBhbGwgaGVhZGVyLCBmb290ZXJzIGFuZCB0aXRsZSBvZiBhIFZlZ2EgZ3JvdXAgd2l0aCBsYXlvdXQgZGlyZWN0aXZlLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIExheW91dEhlYWRlckNvbXBvbmVudCB7XG4gIHRpdGxlPzogc3RyaW5nO1xuXG4gIC8vIFRPRE86IHJlcGVhdCBhbmQgY29uY2F0IGNhbiBoYXZlIG11bHRpcGxlIGhlYWRlciAvIGZvb3Rlci5cbiAgLy8gTmVlZCB0byByZWRlc2lnbiB0aGlzIHBhcnQgYSBiaXQuXG5cbiAgZmFjZXRGaWVsZERlZj86IEZhY2V0RmllbGREZWY8c3RyaW5nPjtcblxuICAvKipcbiAgICogQW4gYXJyYXkgb2YgaGVhZGVyIGNvbXBvbmVudHMgZm9yIGhlYWRlcnMuXG4gICAqIEZvciBmYWNldCwgdGhlcmUgc2hvdWxkIGJlIG9ubHkgb25lIGhlYWRlciBjb21wb25lbnQsIHdoaWNoIGlzIGRhdGEtZHJpdmVuLlxuICAgKiBGb3IgcmVwZWF0IGFuZCBjb25jYXQsIHRoZXJlIGNhbiBiZSBtdWx0aXBsZSBoZWFkZXIgY29tcG9uZW50cyB0aGF0IGV4cGxpY2l0bHkgbGlzdCBkaWZmZXJlbnQgYXhlcy5cbiAgICovXG4gIGhlYWRlcj86IEhlYWRlckNvbXBvbmVudFtdO1xuXG4gIC8qKlxuICAgKiBBbiBhcnJheSBvZiBoZWFkZXIgY29tcG9uZW50cyBmb3IgZm9vdGVycy5cbiAgICogRm9yIGZhY2V0LCB0aGVyZSBzaG91bGQgYmUgb25seSBvbmUgaGVhZGVyIGNvbXBvbmVudCwgd2hpY2ggaXMgZGF0YS1kcml2ZW4uXG4gICAqIEZvciByZXBlYXQgYW5kIGNvbmNhdCwgdGhlcmUgY2FuIGJlIG11bHRpcGxlIGhlYWRlciBjb21wb25lbnRzIHRoYXQgZXhwbGljaXRseSBsaXN0IGRpZmZlcmVudCBheGVzLlxuICAgKi9cbiAgZm9vdGVyPzogSGVhZGVyQ29tcG9uZW50W107XG59XG5cbi8qKlxuICogQSBjb21wb25lbnQgdGhhdCByZXByZXNlbnRzIG9uZSBncm91cCBvZiByb3cvY29sdW1uLWhlYWRlci9mb290ZXIuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSGVhZGVyQ29tcG9uZW50IHtcblxuICBsYWJlbHM6IGJvb2xlYW47XG5cbiAgc2l6ZVNpZ25hbDoge3NpZ25hbDogc3RyaW5nfTtcblxuICBheGVzOiBWZ0F4aXNbXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEhlYWRlclR5cGUob3JpZW50OiBBeGlzT3JpZW50KSB7XG4gIGlmIChvcmllbnQgPT09ICd0b3AnIHx8IG9yaWVudCA9PT0gJ2xlZnQnKSB7XG4gICAgcmV0dXJuICdoZWFkZXInO1xuICB9XG4gIHJldHVybiAnZm9vdGVyJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRpdGxlR3JvdXAobW9kZWw6IE1vZGVsLCBjaGFubmVsOiBIZWFkZXJDaGFubmVsKSB7XG4gIGNvbnN0IHRpdGxlID0gbW9kZWwuY29tcG9uZW50LmxheW91dEhlYWRlcnNbY2hhbm5lbF0udGl0bGU7XG4gIGNvbnN0IHRleHRPcmllbnQgPSBjaGFubmVsID09PSAncm93JyA/ICd2ZXJ0aWNhbCcgOiB1bmRlZmluZWQ7XG5cbiAgY29uc3QgdXBkYXRlID0ge1xuICAgIGFsaWduOiB7dmFsdWU6ICdjZW50ZXInfSxcbiAgICB0ZXh0OiB7dmFsdWU6IHRpdGxlfSxcbiAgICAuLi4odGV4dE9yaWVudCA9PT0gJ3ZlcnRpY2FsJyA/IHthbmdsZToge3ZhbHVlOiAyNzB9fToge30pLFxuICAgIC8vIFRPRE8qaHR0cHM6Ly9naXRodWIuY29tL3ZlZ2EvdmVnYS1saXRlL2lzc3Vlcy8yNDQ2KTogYWRkIHRpdGxlKiBwcm9wZXJ0aWVzIChlLmcuLCB0aXRsZUFsaWduKVxuICAgIC8vIGFsc28gbWFrZSBzdXJlIHRoYXQgZ3VpZGUtdGl0bGUgY29uZmlnIG92ZXJyaWRlIHRoZXNlIFZlZ2EtbGl0ZSBkZWZhdWx0XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBuYW1lOiAgbW9kZWwuZ2V0TmFtZShgJHtjaGFubmVsfV90aXRsZWApLFxuICAgIHJvbGU6IGAke2NoYW5uZWx9LXRpdGxlYCxcbiAgICB0eXBlOiAnZ3JvdXAnLFxuICAgIG1hcmtzOiBbe1xuICAgICAgdHlwZTogJ3RleHQnLFxuICAgICAgcm9sZTogYCR7Y2hhbm5lbH0tdGl0bGUtdGV4dGAsXG4gICAgICBzdHlsZTogJ2d1aWRlLXRpdGxlJyxcbiAgICAgIC4uLihrZXlzKHVwZGF0ZSkubGVuZ3RoID4gMCA/IHtlbmNvZGU6IHt1cGRhdGV9fSA6IHt9KVxuICAgIH1dXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRIZWFkZXJHcm91cHMobW9kZWw6IE1vZGVsLCBjaGFubmVsOiBIZWFkZXJDaGFubmVsKTogVmdNYXJrR3JvdXBbXSB7XG4gIGNvbnN0IGxheW91dEhlYWRlciA9IG1vZGVsLmNvbXBvbmVudC5sYXlvdXRIZWFkZXJzW2NoYW5uZWxdO1xuICBjb25zdCBncm91cHMgPSBbXTtcbiAgZm9yIChjb25zdCBoZWFkZXJUeXBlIG9mIEhFQURFUl9UWVBFUykge1xuICAgIGlmIChsYXlvdXRIZWFkZXJbaGVhZGVyVHlwZV0pIHtcbiAgICAgIGZvciAoY29uc3QgaGVhZGVyQ21wdCBvZiBsYXlvdXRIZWFkZXJbaGVhZGVyVHlwZV0pIHtcbiAgICAgICAgZ3JvdXBzLnB1c2goZ2V0SGVhZGVyR3JvdXAobW9kZWwsIGNoYW5uZWwsIGhlYWRlclR5cGUsIGxheW91dEhlYWRlciwgaGVhZGVyQ21wdCkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gZ3JvdXBzO1xufVxuXG4vLyAwLCAoMCw5MCksIDkwLCAoOTAsIDE4MCksIDE4MCwgKDE4MCwgMjcwKSwgMjcwLCAoMjcwLCAwKVxuXG5leHBvcnQgZnVuY3Rpb24gbGFiZWxBbGlnbihhbmdsZTogbnVtYmVyKSB7XG4gIC8vIHRvIGtlZXAgYW5nbGUgaW4gWzAsIDM2MClcbiAgYW5nbGUgPSAoKGFuZ2xlICUgMzYwKSArIDM2MCkgJSAzNjA7XG4gIGlmICgoYW5nbGUgKyA5MCkgJSAxODAgPT09IDApIHsgIC8vIGZvciA5MCBhbmQgMjcwXG4gICAgcmV0dXJuIHt9OyAvLyBkZWZhdWx0IGNlbnRlclxuICB9IGVsc2UgaWYgKGFuZ2xlIDwgOTAgfHwgMjcwIDwgYW5nbGUpIHtcbiAgICByZXR1cm4ge2FsaWduOiB7dmFsdWU6ICdyaWdodCd9fTtcbiAgfSBlbHNlIGlmICgxMzUgPD0gYW5nbGUgJiYgYW5nbGUgPCAyMjUpIHtcbiAgICByZXR1cm4ge2FsaWduOiB7dmFsdWU6ICdsZWZ0J319O1xuICB9XG4gIHJldHVybiB7fTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxhYmVsQmFzZWxpbmUoYW5nbGU6IG51bWJlcikge1xuICAvLyB0byBrZWVwIGFuZ2xlIGluIFswLCAzNjApXG4gIGFuZ2xlID0gKChhbmdsZSAlIDM2MCkgKyAzNjApICUgMzYwO1xuICBpZiAoNDUgPD0gYW5nbGUgJiYgYW5nbGUgPD0gMTM1KSB7XG4gICAgcmV0dXJuIHtiYXNlbGluZToge3ZhbHVlOiAndG9wJ319O1xuICB9XG4gIHJldHVybiB7fTtcbn1cblxuZnVuY3Rpb24gZ2V0SGVhZGVyR3JvdXAobW9kZWw6IE1vZGVsLCBjaGFubmVsOiBIZWFkZXJDaGFubmVsLCBoZWFkZXJUeXBlOiBIZWFkZXJUeXBlLCBsYXlvdXRIZWFkZXI6IExheW91dEhlYWRlckNvbXBvbmVudCwgaGVhZGVyQ21wdDogSGVhZGVyQ29tcG9uZW50KSB7XG4gIGlmIChoZWFkZXJDbXB0KSB7XG4gICAgbGV0IHRpdGxlID0gbnVsbDtcbiAgICBjb25zdCB7ZmFjZXRGaWVsZERlZn0gPSBsYXlvdXRIZWFkZXI7XG4gICAgaWYgKGZhY2V0RmllbGREZWYgJiYgaGVhZGVyQ21wdC5sYWJlbHMpIHtcbiAgICAgIGNvbnN0IHtoZWFkZXIgPSB7fX0gPSBmYWNldEZpZWxkRGVmO1xuICAgICAgY29uc3Qge2Zvcm1hdCwgbGFiZWxBbmdsZX0gPSBoZWFkZXI7XG5cbiAgICAgIGNvbnN0IHVwZGF0ZSA9IHtcbiAgICAgICAgLi4uKFxuICAgICAgICAgIGxhYmVsQW5nbGUgIT09IHVuZGVmaW5lZCA/IHthbmdsZToge3ZhbHVlOiBsYWJlbEFuZ2xlfX0gOiB7fVxuICAgICAgICApLFxuICAgICAgICAuLi5sYWJlbEFsaWduKGxhYmVsQW5nbGUpLFxuICAgICAgICAuLi5sYWJlbEJhc2VsaW5lKGxhYmVsQW5nbGUpXG5cbiAgICAgIH07XG5cbiAgICAgIHRpdGxlID0ge1xuICAgICAgICB0ZXh0OiBmb3JtYXRTaWduYWxSZWYoZmFjZXRGaWVsZERlZiwgZm9ybWF0LCAncGFyZW50JywgbW9kZWwuY29uZmlnKSxcbiAgICAgICAgb2Zmc2V0OiAxMCxcbiAgICAgICAgb3JpZW50OiBjaGFubmVsID09PSAncm93JyA/ICdsZWZ0JyA6ICd0b3AnLFxuICAgICAgICBzdHlsZTogJ2d1aWRlLWxhYmVsJyxcbiAgICAgICAgLi4uKGtleXModXBkYXRlKS5sZW5ndGggPiAwID8ge2VuY29kZToge3VwZGF0ZX19IDoge30pXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IGF4ZXMgPSBoZWFkZXJDbXB0LmF4ZXM7XG5cbiAgICBjb25zdCBoYXNBeGVzID0gYXhlcyAmJiBheGVzLmxlbmd0aCA+IDA7XG4gICAgaWYgKHRpdGxlIHx8IGhhc0F4ZXMpIHtcbiAgICAgIGNvbnN0IHNpemVDaGFubmVsID0gY2hhbm5lbCA9PT0gJ3JvdycgPyAnaGVpZ2h0JyA6ICd3aWR0aCc7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIG5hbWU6IG1vZGVsLmdldE5hbWUoYCR7Y2hhbm5lbH1fJHtoZWFkZXJUeXBlfWApLFxuICAgICAgICB0eXBlOiAnZ3JvdXAnLFxuICAgICAgICByb2xlOiBgJHtjaGFubmVsfS0ke2hlYWRlclR5cGV9YCxcbiAgICAgICAgLi4uKGxheW91dEhlYWRlci5mYWNldEZpZWxkRGVmID8ge1xuICAgICAgICAgIGZyb206IHtkYXRhOiBtb2RlbC5nZXROYW1lKGNoYW5uZWwgKyAnX2RvbWFpbicpfSxcbiAgICAgICAgICBzb3J0OiB7XG4gICAgICAgICAgICBmaWVsZDogdmdGaWVsZChmYWNldEZpZWxkRGVmLCB7ZXhwcjogJ2RhdHVtJ30pLFxuICAgICAgICAgICAgb3JkZXI6IGZhY2V0RmllbGREZWYuc29ydCB8fCAnYXNjZW5kaW5nJ1xuICAgICAgICAgIH1cbiAgICAgICAgfSA6IHt9KSxcbiAgICAgICAgLi4uKHRpdGxlID8ge3RpdGxlfSA6IHt9KSxcbiAgICAgICAgLi4uKGhlYWRlckNtcHQuc2l6ZVNpZ25hbCA/IHtcbiAgICAgICAgICBlbmNvZGU6IHtcbiAgICAgICAgICAgIHVwZGF0ZToge1xuICAgICAgICAgICAgICBbc2l6ZUNoYW5uZWxdOiBoZWFkZXJDbXB0LnNpemVTaWduYWxcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH06IHt9KSxcbiAgICAgICAgLi4uKGhhc0F4ZXMgPyB7YXhlc30gOiB7fSlcbiAgICAgIH07XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuIl19","import { hasDiscreteDomain } from '../../scale';\nimport { isVgRangeStep } from '../../vega.schema';\nimport { isFacetModel } from '../model';\nexport function assembleLayoutSignals(model) {\n    return [].concat(sizeSignals(model, 'width'), sizeSignals(model, 'height'));\n}\nexport function sizeSignals(model, sizeType) {\n    var channel = sizeType === 'width' ? 'x' : 'y';\n    var size = model.component.layoutSize.get(sizeType);\n    if (!size || size === 'merged') {\n        return [];\n    }\n    // Read size signal name from name map, just in case it is the top-level size signal that got renamed.\n    var name = model.getSizeSignalRef(sizeType).signal;\n    if (size === 'range-step') {\n        var scaleComponent = model.getScaleComponent(channel);\n        if (scaleComponent) {\n            var type = scaleComponent.get('type');\n            var range = scaleComponent.get('range');\n            if (hasDiscreteDomain(type) && isVgRangeStep(range)) {\n                var scaleName = model.scaleName(channel);\n                if (isFacetModel(model.parent)) {\n                    // If parent is facet and this is an independent scale, return only signal signal\n                    // as the width/height will be calculated using the cardinality from\n                    // facet's aggregate rather than reading from scale domain\n                    var parentResolve = model.parent.component.resolve;\n                    if (parentResolve.scale[channel] === 'independent') {\n                        return [stepSignal(scaleName, range)];\n                    }\n                }\n                return [\n                    stepSignal(scaleName, range),\n                    {\n                        name: name,\n                        update: sizeExpr(scaleName, scaleComponent, \"domain('\" + scaleName + \"').length\")\n                    }\n                ];\n            }\n        }\n        /* istanbul ignore next: Condition should not happen -- only for warning in development. */\n        throw new Error('layout size is range step although there is no rangeStep.');\n    }\n    else {\n        return [{\n                name: name,\n                value: size\n            }];\n    }\n}\nfunction stepSignal(scaleName, range) {\n    return {\n        name: scaleName + '_step',\n        value: range.step,\n    };\n}\nexport function sizeExpr(scaleName, scaleComponent, cardinality) {\n    var type = scaleComponent.get('type');\n    var padding = scaleComponent.get('padding');\n    var paddingOuter = scaleComponent.get('paddingOuter');\n    paddingOuter = paddingOuter !== undefined ? paddingOuter : padding;\n    var paddingInner = scaleComponent.get('paddingInner');\n    paddingInner = type === 'band' ?\n        // only band has real paddingInner\n        (paddingInner !== undefined ? paddingInner : padding) :\n        // For point, as calculated in https://github.com/vega/vega-scale/blob/master/src/band.js#L128,\n        // it's equivalent to have paddingInner = 1 since there is only n-1 steps between n points.\n        1;\n    return \"bandspace(\" + cardinality + \", \" + paddingInner + \", \" + paddingOuter + \") * \" + scaleName + \"_step\";\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXNzZW1ibGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9sYXlvdXRzaXplL2Fzc2VtYmxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLGFBQWEsQ0FBQztBQUM5QyxPQUFPLEVBQUMsYUFBYSxFQUF3QixNQUFNLG1CQUFtQixDQUFDO0FBQ3ZFLE9BQU8sRUFBQyxZQUFZLEVBQVEsTUFBTSxVQUFVLENBQUM7QUFHN0MsTUFBTSxnQ0FBZ0MsS0FBWTtJQUNoRCxPQUFPLEVBQUUsQ0FBQyxNQUFNLENBQ2QsV0FBVyxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsRUFDM0IsV0FBVyxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FDN0IsQ0FBQztBQUNKLENBQUM7QUFFRCxNQUFNLHNCQUFzQixLQUFZLEVBQUUsUUFBNEI7SUFDcEUsSUFBTSxPQUFPLEdBQUcsUUFBUSxLQUFLLE9BQU8sQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUM7SUFDakQsSUFBTSxJQUFJLEdBQUcsS0FBSyxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ3RELElBQUksQ0FBQyxJQUFJLElBQUksSUFBSSxLQUFLLFFBQVEsRUFBRTtRQUM5QixPQUFPLEVBQUUsQ0FBQztLQUNYO0lBRUQsc0dBQXNHO0lBQ3RHLElBQU0sSUFBSSxHQUFHLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsQ0FBQyxNQUFNLENBQUM7SUFFckQsSUFBSSxJQUFJLEtBQUssWUFBWSxFQUFFO1FBQ3pCLElBQU0sY0FBYyxHQUFHLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUV4RCxJQUFJLGNBQWMsRUFBRTtZQUNsQixJQUFNLElBQUksR0FBRyxjQUFjLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ3hDLElBQU0sS0FBSyxHQUFHLGNBQWMsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7WUFFMUMsSUFBSSxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxhQUFhLENBQUMsS0FBSyxDQUFDLEVBQUU7Z0JBQ25ELElBQU0sU0FBUyxHQUFHLEtBQUssQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBRTNDLElBQUksWUFBWSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBRTtvQkFDOUIsaUZBQWlGO29CQUNqRixvRUFBb0U7b0JBQ3BFLDBEQUEwRDtvQkFDMUQsSUFBTSxhQUFhLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDO29CQUNyRCxJQUFJLGFBQWEsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEtBQUssYUFBYSxFQUFFO3dCQUNsRCxPQUFPLENBQUMsVUFBVSxDQUFDLFNBQVMsRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDO3FCQUN2QztpQkFDRjtnQkFFRCxPQUFPO29CQUNMLFVBQVUsQ0FBQyxTQUFTLEVBQUUsS0FBSyxDQUFDO29CQUM1Qjt3QkFDRSxJQUFJLE1BQUE7d0JBQ0osTUFBTSxFQUFFLFFBQVEsQ0FBQyxTQUFTLEVBQUUsY0FBYyxFQUFFLGFBQVcsU0FBUyxjQUFXLENBQUM7cUJBQzdFO2lCQUNGLENBQUM7YUFDSDtTQUNGO1FBQ0QsMkZBQTJGO1FBQzNGLE1BQU0sSUFBSSxLQUFLLENBQUMsMkRBQTJELENBQUMsQ0FBQztLQUM5RTtTQUFNO1FBQ0wsT0FBTyxDQUFDO2dCQUNOLElBQUksTUFBQTtnQkFDSixLQUFLLEVBQUUsSUFBSTthQUNaLENBQUMsQ0FBQztLQUNKO0FBQ0gsQ0FBQztBQUVELG9CQUFvQixTQUFpQixFQUFFLEtBQWtCO0lBQ3ZELE9BQU87UUFDTCxJQUFJLEVBQUUsU0FBUyxHQUFHLE9BQU87UUFDekIsS0FBSyxFQUFFLEtBQUssQ0FBQyxJQUFJO0tBQ2xCLENBQUM7QUFDSixDQUFDO0FBRUQsTUFBTSxtQkFBbUIsU0FBaUIsRUFBRSxjQUE4QixFQUFFLFdBQW1CO0lBQzdGLElBQU0sSUFBSSxHQUFHLGNBQWMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDeEMsSUFBTSxPQUFPLEdBQUcsY0FBYyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUM5QyxJQUFJLFlBQVksR0FBRyxjQUFjLENBQUMsR0FBRyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0lBQ3RELFlBQVksR0FBRyxZQUFZLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQztJQUVuRSxJQUFJLFlBQVksR0FBRyxjQUFjLENBQUMsR0FBRyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0lBQ3RELFlBQVksR0FBRyxJQUFJLEtBQUssTUFBTSxDQUFDLENBQUM7UUFDOUIsa0NBQWtDO1FBQ2xDLENBQUMsWUFBWSxLQUFLLFNBQVMsQ0FBQyxDQUFDLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBQ3ZELCtGQUErRjtRQUMvRiwyRkFBMkY7UUFDM0YsQ0FBQyxDQUFDO0lBQ0osT0FBTyxlQUFhLFdBQVcsVUFBSyxZQUFZLFVBQUssWUFBWSxZQUFPLFNBQVMsVUFBTyxDQUFDO0FBQzNGLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCB7aGFzRGlzY3JldGVEb21haW59IGZyb20gJy4uLy4uL3NjYWxlJztcbmltcG9ydCB7aXNWZ1JhbmdlU3RlcCwgVmdSYW5nZVN0ZXAsIFZnU2lnbmFsfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge2lzRmFjZXRNb2RlbCwgTW9kZWx9IGZyb20gJy4uL21vZGVsJztcbmltcG9ydCB7U2NhbGVDb21wb25lbnR9IGZyb20gJy4uL3NjYWxlL2NvbXBvbmVudCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBhc3NlbWJsZUxheW91dFNpZ25hbHMobW9kZWw6IE1vZGVsKTogVmdTaWduYWxbXSB7XG4gIHJldHVybiBbXS5jb25jYXQoXG4gICAgc2l6ZVNpZ25hbHMobW9kZWwsICd3aWR0aCcpLFxuICAgIHNpemVTaWduYWxzKG1vZGVsLCAnaGVpZ2h0JylcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNpemVTaWduYWxzKG1vZGVsOiBNb2RlbCwgc2l6ZVR5cGU6ICd3aWR0aCcgfCAnaGVpZ2h0Jyk6IFZnU2lnbmFsW10ge1xuICBjb25zdCBjaGFubmVsID0gc2l6ZVR5cGUgPT09ICd3aWR0aCcgPyAneCcgOiAneSc7XG4gIGNvbnN0IHNpemUgPSBtb2RlbC5jb21wb25lbnQubGF5b3V0U2l6ZS5nZXQoc2l6ZVR5cGUpO1xuICBpZiAoIXNpemUgfHwgc2l6ZSA9PT0gJ21lcmdlZCcpIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICAvLyBSZWFkIHNpemUgc2lnbmFsIG5hbWUgZnJvbSBuYW1lIG1hcCwganVzdCBpbiBjYXNlIGl0IGlzIHRoZSB0b3AtbGV2ZWwgc2l6ZSBzaWduYWwgdGhhdCBnb3QgcmVuYW1lZC5cbiAgY29uc3QgbmFtZSA9IG1vZGVsLmdldFNpemVTaWduYWxSZWYoc2l6ZVR5cGUpLnNpZ25hbDtcblxuICBpZiAoc2l6ZSA9PT0gJ3JhbmdlLXN0ZXAnKSB7XG4gICAgY29uc3Qgc2NhbGVDb21wb25lbnQgPSBtb2RlbC5nZXRTY2FsZUNvbXBvbmVudChjaGFubmVsKTtcblxuICAgIGlmIChzY2FsZUNvbXBvbmVudCkge1xuICAgICAgY29uc3QgdHlwZSA9IHNjYWxlQ29tcG9uZW50LmdldCgndHlwZScpO1xuICAgICAgY29uc3QgcmFuZ2UgPSBzY2FsZUNvbXBvbmVudC5nZXQoJ3JhbmdlJyk7XG5cbiAgICAgIGlmIChoYXNEaXNjcmV0ZURvbWFpbih0eXBlKSAmJiBpc1ZnUmFuZ2VTdGVwKHJhbmdlKSkge1xuICAgICAgICBjb25zdCBzY2FsZU5hbWUgPSBtb2RlbC5zY2FsZU5hbWUoY2hhbm5lbCk7XG5cbiAgICAgICAgaWYgKGlzRmFjZXRNb2RlbChtb2RlbC5wYXJlbnQpKSB7XG4gICAgICAgICAgLy8gSWYgcGFyZW50IGlzIGZhY2V0IGFuZCB0aGlzIGlzIGFuIGluZGVwZW5kZW50IHNjYWxlLCByZXR1cm4gb25seSBzaWduYWwgc2lnbmFsXG4gICAgICAgICAgLy8gYXMgdGhlIHdpZHRoL2hlaWdodCB3aWxsIGJlIGNhbGN1bGF0ZWQgdXNpbmcgdGhlIGNhcmRpbmFsaXR5IGZyb21cbiAgICAgICAgICAvLyBmYWNldCdzIGFnZ3JlZ2F0ZSByYXRoZXIgdGhhbiByZWFkaW5nIGZyb20gc2NhbGUgZG9tYWluXG4gICAgICAgICAgY29uc3QgcGFyZW50UmVzb2x2ZSA9IG1vZGVsLnBhcmVudC5jb21wb25lbnQucmVzb2x2ZTtcbiAgICAgICAgICBpZiAocGFyZW50UmVzb2x2ZS5zY2FsZVtjaGFubmVsXSA9PT0gJ2luZGVwZW5kZW50Jykge1xuICAgICAgICAgICAgcmV0dXJuIFtzdGVwU2lnbmFsKHNjYWxlTmFtZSwgcmFuZ2UpXTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgIHN0ZXBTaWduYWwoc2NhbGVOYW1lLCByYW5nZSksXG4gICAgICAgICAge1xuICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgIHVwZGF0ZTogc2l6ZUV4cHIoc2NhbGVOYW1lLCBzY2FsZUNvbXBvbmVudCwgYGRvbWFpbignJHtzY2FsZU5hbWV9JykubGVuZ3RoYClcbiAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgICB9XG4gICAgfVxuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBDb25kaXRpb24gc2hvdWxkIG5vdCBoYXBwZW4gLS0gb25seSBmb3Igd2FybmluZyBpbiBkZXZlbG9wbWVudC4gKi9cbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2xheW91dCBzaXplIGlzIHJhbmdlIHN0ZXAgYWx0aG91Z2ggdGhlcmUgaXMgbm8gcmFuZ2VTdGVwLicpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBbe1xuICAgICAgbmFtZSxcbiAgICAgIHZhbHVlOiBzaXplXG4gICAgfV07XG4gIH1cbn1cblxuZnVuY3Rpb24gc3RlcFNpZ25hbChzY2FsZU5hbWU6IHN0cmluZywgcmFuZ2U6IFZnUmFuZ2VTdGVwKTogVmdTaWduYWwge1xuICByZXR1cm4ge1xuICAgIG5hbWU6IHNjYWxlTmFtZSArICdfc3RlcCcsXG4gICAgdmFsdWU6IHJhbmdlLnN0ZXAsXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaXplRXhwcihzY2FsZU5hbWU6IHN0cmluZywgc2NhbGVDb21wb25lbnQ6IFNjYWxlQ29tcG9uZW50LCBjYXJkaW5hbGl0eTogc3RyaW5nKSB7XG4gIGNvbnN0IHR5cGUgPSBzY2FsZUNvbXBvbmVudC5nZXQoJ3R5cGUnKTtcbiAgY29uc3QgcGFkZGluZyA9IHNjYWxlQ29tcG9uZW50LmdldCgncGFkZGluZycpO1xuICBsZXQgcGFkZGluZ091dGVyID0gc2NhbGVDb21wb25lbnQuZ2V0KCdwYWRkaW5nT3V0ZXInKTtcbiAgcGFkZGluZ091dGVyID0gcGFkZGluZ091dGVyICE9PSB1bmRlZmluZWQgPyBwYWRkaW5nT3V0ZXIgOiBwYWRkaW5nO1xuXG4gIGxldCBwYWRkaW5nSW5uZXIgPSBzY2FsZUNvbXBvbmVudC5nZXQoJ3BhZGRpbmdJbm5lcicpO1xuICBwYWRkaW5nSW5uZXIgPSB0eXBlID09PSAnYmFuZCcgP1xuICAgIC8vIG9ubHkgYmFuZCBoYXMgcmVhbCBwYWRkaW5nSW5uZXJcbiAgICAocGFkZGluZ0lubmVyICE9PSB1bmRlZmluZWQgPyBwYWRkaW5nSW5uZXIgOiBwYWRkaW5nKSA6XG4gICAgLy8gRm9yIHBvaW50LCBhcyBjYWxjdWxhdGVkIGluIGh0dHBzOi8vZ2l0aHViLmNvbS92ZWdhL3ZlZ2Etc2NhbGUvYmxvYi9tYXN0ZXIvc3JjL2JhbmQuanMjTDEyOCxcbiAgICAvLyBpdCdzIGVxdWl2YWxlbnQgdG8gaGF2ZSBwYWRkaW5nSW5uZXIgPSAxIHNpbmNlIHRoZXJlIGlzIG9ubHkgbi0xIHN0ZXBzIGJldHdlZW4gbiBwb2ludHMuXG4gICAgMTtcbiAgcmV0dXJuIGBiYW5kc3BhY2UoJHtjYXJkaW5hbGl0eX0sICR7cGFkZGluZ0lubmVyfSwgJHtwYWRkaW5nT3V0ZXJ9KSAqICR7c2NhbGVOYW1lfV9zdGVwYDtcbn1cblxuXG4iXX0=","import { POSITION_SCALE_CHANNELS } from '../channel';\nimport * as log from '../log';\nimport { contains } from '../util';\nimport { isConcatModel, isFacetModel, isLayerModel, isRepeatModel } from './model';\nexport function defaultScaleResolve(channel, model) {\n    if (isLayerModel(model) || isFacetModel(model)) {\n        return 'shared';\n    }\n    else if (isConcatModel(model) || isRepeatModel(model)) {\n        return contains(POSITION_SCALE_CHANNELS, channel) ? 'independent' : 'shared';\n    }\n    /* istanbul ignore next: should never reach here. */\n    throw new Error('invalid model type for resolve');\n}\nexport function parseGuideResolve(resolve, channel) {\n    var channelScaleResolve = resolve.scale[channel];\n    var guide = contains(POSITION_SCALE_CHANNELS, channel) ? 'axis' : 'legend';\n    if (channelScaleResolve === 'independent') {\n        if (resolve[guide][channel] === 'shared') {\n            log.warn(log.message.independentScaleMeansIndependentGuide(channel));\n        }\n        return 'independent';\n    }\n    return resolve[guide][channel] || 'shared';\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzb2x2ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21waWxlL3Jlc29sdmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFDLHVCQUF1QixFQUFlLE1BQU0sWUFBWSxDQUFDO0FBQ2pFLE9BQU8sS0FBSyxHQUFHLE1BQU0sUUFBUSxDQUFDO0FBRTlCLE9BQU8sRUFBQyxRQUFRLEVBQUMsTUFBTSxTQUFTLENBQUM7QUFDakMsT0FBTyxFQUFDLGFBQWEsRUFBRSxZQUFZLEVBQUUsWUFBWSxFQUFFLGFBQWEsRUFBUSxNQUFNLFNBQVMsQ0FBQztBQUV4RixNQUFNLDhCQUE4QixPQUFxQixFQUFFLEtBQVk7SUFDckUsSUFBSSxZQUFZLENBQUMsS0FBSyxDQUFDLElBQUksWUFBWSxDQUFDLEtBQUssQ0FBQyxFQUFFO1FBQzlDLE9BQU8sUUFBUSxDQUFDO0tBQ2pCO1NBQU0sSUFBSSxhQUFhLENBQUMsS0FBSyxDQUFDLElBQUksYUFBYSxDQUFDLEtBQUssQ0FBQyxFQUFFO1FBQ3ZELE9BQU8sUUFBUSxDQUFDLHVCQUF1QixFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQztLQUM5RTtJQUNELG9EQUFvRDtJQUNwRCxNQUFNLElBQUksS0FBSyxDQUFDLGdDQUFnQyxDQUFDLENBQUM7QUFDcEQsQ0FBQztBQUVELE1BQU0sNEJBQTRCLE9BQWdCLEVBQUUsT0FBcUI7SUFDdkUsSUFBTSxtQkFBbUIsR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ25ELElBQU0sS0FBSyxHQUFHLFFBQVEsQ0FBQyx1QkFBdUIsRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUM7SUFFN0UsSUFBSSxtQkFBbUIsS0FBSyxhQUFhLEVBQUU7UUFDekMsSUFBSSxPQUFPLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssUUFBUSxFQUFFO1lBQ3hDLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxxQ0FBcUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1NBQ3RFO1FBQ0QsT0FBTyxhQUFhLENBQUM7S0FDdEI7SUFFRCxPQUFPLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxRQUFRLENBQUM7QUFDN0MsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7UE9TSVRJT05fU0NBTEVfQ0hBTk5FTFMsIFNjYWxlQ2hhbm5lbH0gZnJvbSAnLi4vY2hhbm5lbCc7XG5pbXBvcnQgKiBhcyBsb2cgZnJvbSAnLi4vbG9nJztcbmltcG9ydCB7UmVzb2x2ZSwgUmVzb2x2ZU1vZGV9IGZyb20gJy4uL3Jlc29sdmUnO1xuaW1wb3J0IHtjb250YWluc30gZnJvbSAnLi4vdXRpbCc7XG5pbXBvcnQge2lzQ29uY2F0TW9kZWwsIGlzRmFjZXRNb2RlbCwgaXNMYXllck1vZGVsLCBpc1JlcGVhdE1vZGVsLCBNb2RlbH0gZnJvbSAnLi9tb2RlbCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWZhdWx0U2NhbGVSZXNvbHZlKGNoYW5uZWw6IFNjYWxlQ2hhbm5lbCwgbW9kZWw6IE1vZGVsKTogUmVzb2x2ZU1vZGUge1xuICBpZiAoaXNMYXllck1vZGVsKG1vZGVsKSB8fCBpc0ZhY2V0TW9kZWwobW9kZWwpKSB7XG4gICAgcmV0dXJuICdzaGFyZWQnO1xuICB9IGVsc2UgaWYgKGlzQ29uY2F0TW9kZWwobW9kZWwpIHx8IGlzUmVwZWF0TW9kZWwobW9kZWwpKSB7XG4gICAgcmV0dXJuIGNvbnRhaW5zKFBPU0lUSU9OX1NDQUxFX0NIQU5ORUxTLCBjaGFubmVsKSA/ICdpbmRlcGVuZGVudCcgOiAnc2hhcmVkJztcbiAgfVxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dDogc2hvdWxkIG5ldmVyIHJlYWNoIGhlcmUuICovXG4gIHRocm93IG5ldyBFcnJvcignaW52YWxpZCBtb2RlbCB0eXBlIGZvciByZXNvbHZlJyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUd1aWRlUmVzb2x2ZShyZXNvbHZlOiBSZXNvbHZlLCBjaGFubmVsOiBTY2FsZUNoYW5uZWwpOiBSZXNvbHZlTW9kZSB7XG4gIGNvbnN0IGNoYW5uZWxTY2FsZVJlc29sdmUgPSByZXNvbHZlLnNjYWxlW2NoYW5uZWxdO1xuICBjb25zdCBndWlkZSA9IGNvbnRhaW5zKFBPU0lUSU9OX1NDQUxFX0NIQU5ORUxTLCBjaGFubmVsKSA/ICdheGlzJyA6ICdsZWdlbmQnO1xuXG4gIGlmIChjaGFubmVsU2NhbGVSZXNvbHZlID09PSAnaW5kZXBlbmRlbnQnKSB7XG4gICAgaWYgKHJlc29sdmVbZ3VpZGVdW2NoYW5uZWxdID09PSAnc2hhcmVkJykge1xuICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuaW5kZXBlbmRlbnRTY2FsZU1lYW5zSW5kZXBlbmRlbnRHdWlkZShjaGFubmVsKSk7XG4gICAgfVxuICAgIHJldHVybiAnaW5kZXBlbmRlbnQnO1xuICB9XG5cbiAgcmV0dXJuIHJlc29sdmVbZ3VpZGVdW2NoYW5uZWxdIHx8ICdzaGFyZWQnO1xufVxuIl19","import * as tslib_1 from \"tslib\";\nimport * as log from '../log';\nimport { duplicate, keys, stringify } from '../util';\n/**\n * Generic class for storing properties that are explicitly specified\n * and implicitly determined by the compiler.\n * This is important for scale/axis/legend merging as\n * we want to prioritize properties that users explicitly specified.\n */\nvar Split = /** @class */ (function () {\n    function Split(explicit, implicit) {\n        if (explicit === void 0) { explicit = {}; }\n        if (implicit === void 0) { implicit = {}; }\n        this.explicit = explicit;\n        this.implicit = implicit;\n    }\n    Split.prototype.clone = function () {\n        return new Split(duplicate(this.explicit), duplicate(this.implicit));\n    };\n    Split.prototype.combine = function () {\n        // FIXME remove \"as any\".\n        // Add \"as any\" to avoid an error \"Spread types may only be created from object types\".\n        return tslib_1.__assign({}, this.explicit, this.implicit);\n    };\n    Split.prototype.get = function (key) {\n        // Explicit has higher precedence\n        return this.explicit[key] !== undefined ? this.explicit[key] : this.implicit[key];\n    };\n    Split.prototype.getWithExplicit = function (key) {\n        // Explicit has higher precedence\n        if (this.explicit[key] !== undefined) {\n            return { explicit: true, value: this.explicit[key] };\n        }\n        else if (this.implicit[key] !== undefined) {\n            return { explicit: false, value: this.implicit[key] };\n        }\n        return { explicit: false, value: undefined };\n    };\n    Split.prototype.setWithExplicit = function (key, value) {\n        if (value.value !== undefined) {\n            this.set(key, value.value, value.explicit);\n        }\n    };\n    Split.prototype.set = function (key, value, explicit) {\n        delete this[explicit ? 'implicit' : 'explicit'][key];\n        this[explicit ? 'explicit' : 'implicit'][key] = value;\n        return this;\n    };\n    Split.prototype.copyKeyFromSplit = function (key, s) {\n        // Explicit has higher precedence\n        if (s.explicit[key] !== undefined) {\n            this.set(key, s.explicit[key], true);\n        }\n        else if (s.implicit[key] !== undefined) {\n            this.set(key, s.implicit[key], false);\n        }\n    };\n    Split.prototype.copyKeyFromObject = function (key, s) {\n        // Explicit has higher precedence\n        if (s[key] !== undefined) {\n            this.set(key, s[key], true);\n        }\n    };\n    /**\n     * Merge split object into this split object. Properties from the other split\n     * overwrite properties from this split.\n     */\n    Split.prototype.copyAll = function (other) {\n        for (var _i = 0, _a = keys(other.combine()); _i < _a.length; _i++) {\n            var key = _a[_i];\n            var val = other.getWithExplicit(key);\n            this.setWithExplicit(key, val);\n        }\n    };\n    return Split;\n}());\nexport { Split };\nexport function makeExplicit(value) {\n    return {\n        explicit: true,\n        value: value\n    };\n}\nexport function makeImplicit(value) {\n    return {\n        explicit: false,\n        value: value\n    };\n}\nexport function tieBreakByComparing(compare) {\n    return function (v1, v2, property, propertyOf) {\n        var diff = compare(v1.value, v2.value);\n        if (diff > 0) {\n            return v1;\n        }\n        else if (diff < 0) {\n            return v2;\n        }\n        return defaultTieBreaker(v1, v2, property, propertyOf);\n    };\n}\nexport function defaultTieBreaker(v1, v2, property, propertyOf) {\n    if (v1.explicit && v2.explicit) {\n        log.warn(log.message.mergeConflictingProperty(property, propertyOf, v1.value, v2.value));\n    }\n    // If equal score, prefer v1.\n    return v1;\n}\nexport function mergeValuesWithExplicit(v1, v2, property, propertyOf, tieBreaker) {\n    if (tieBreaker === void 0) { tieBreaker = defaultTieBreaker; }\n    if (v1 === undefined || v1.value === undefined) {\n        // For first run\n        return v2;\n    }\n    if (v1.explicit && !v2.explicit) {\n        return v1;\n    }\n    else if (v2.explicit && !v1.explicit) {\n        return v2;\n    }\n    else if (stringify(v1.value) === stringify(v2.value)) {\n        return v1;\n    }\n    else {\n        return tieBreaker(v1, v2, property, propertyOf);\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3BsaXQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29tcGlsZS9zcGxpdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxLQUFLLEdBQUcsTUFBTSxRQUFRLENBQUM7QUFDOUIsT0FBTyxFQUFDLFNBQVMsRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFDLE1BQU0sU0FBUyxDQUFDO0FBR25EOzs7OztHQUtHO0FBQ0g7SUFDRSxlQUNrQixRQUF5QixFQUN6QixRQUF5QjtRQUR6Qix5QkFBQSxFQUFBLGFBQXlCO1FBQ3pCLHlCQUFBLEVBQUEsYUFBeUI7UUFEekIsYUFBUSxHQUFSLFFBQVEsQ0FBaUI7UUFDekIsYUFBUSxHQUFSLFFBQVEsQ0FBaUI7SUFDeEMsQ0FBQztJQUVHLHFCQUFLLEdBQVo7UUFDRSxPQUFPLElBQUksS0FBSyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsU0FBUyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO0lBQ3ZFLENBQUM7SUFFTSx1QkFBTyxHQUFkO1FBQ0UseUJBQXlCO1FBQ3pCLHVGQUF1RjtRQUN2Riw0QkFDSyxJQUFJLENBQUMsUUFBZSxFQUNwQixJQUFJLENBQUMsUUFBZSxFQUN2QjtJQUNKLENBQUM7SUFFTSxtQkFBRyxHQUFWLFVBQThCLEdBQU07UUFDbEMsaUNBQWlDO1FBQ2pDLE9BQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDcEYsQ0FBQztJQUVNLCtCQUFlLEdBQXRCLFVBQTBDLEdBQU07UUFDOUMsaUNBQWlDO1FBQ2pDLElBQUksSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsS0FBSyxTQUFTLEVBQUU7WUFD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LEVBQUUsQ0FBQyxRQUFRLElBQUksQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFO1FBQ3RDLE9BQU8sRUFBRSxDQUFDO0tBQ1g7U0FBTSxJQUFJLFNBQVMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEtBQUssU0FBUyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsRUFBRTtRQUN0RCxPQUFPLEVBQUUsQ0FBQztLQUNYO1NBQU07UUFDTCxPQUFPLFVBQVUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLFFBQVEsRUFBRSxVQUFVLENBQUMsQ0FBQztLQUNqRDtBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBsb2cgZnJvbSAnLi4vbG9nJztcbmltcG9ydCB7ZHVwbGljYXRlLCBrZXlzLCBzdHJpbmdpZnl9IGZyb20gJy4uL3V0aWwnO1xuXG5cbi8qKlxuICogR2VuZXJpYyBjbGFzcyBmb3Igc3RvcmluZyBwcm9wZXJ0aWVzIHRoYXQgYXJlIGV4cGxpY2l0bHkgc3BlY2lmaWVkXG4gKiBhbmQgaW1wbGljaXRseSBkZXRlcm1pbmVkIGJ5IHRoZSBjb21waWxlci5cbiAqIFRoaXMgaXMgaW1wb3J0YW50IGZvciBzY2FsZS9heGlzL2xlZ2VuZCBtZXJnaW5nIGFzXG4gKiB3ZSB3YW50IHRvIHByaW9yaXRpemUgcHJvcGVydGllcyB0aGF0IHVzZXJzIGV4cGxpY2l0bHkgc3BlY2lmaWVkLlxuICovXG5leHBvcnQgY2xhc3MgU3BsaXQ8VCBleHRlbmRzIG9iamVjdD4ge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgcmVhZG9ubHkgZXhwbGljaXQ6IFBhcnRpYWw8VD4gPSB7fSxcbiAgICBwdWJsaWMgcmVhZG9ubHkgaW1wbGljaXQ6IFBhcnRpYWw8VD4gPSB7fVxuICApIHt9XG5cbiAgcHVibGljIGNsb25lKCkge1xuICAgIHJldHVybiBuZXcgU3BsaXQoZHVwbGljYXRlKHRoaXMuZXhwbGljaXQpLCBkdXBsaWNhdGUodGhpcy5pbXBsaWNpdCkpO1xuICB9XG5cbiAgcHVibGljIGNvbWJpbmUoKTogUGFydGlhbDxUPiB7XG4gICAgLy8gRklYTUUgcmVtb3ZlIFwiYXMgYW55XCIuXG4gICAgLy8gQWRkIFwiYXMgYW55XCIgdG8gYXZvaWQgYW4gZXJyb3IgXCJTcHJlYWQgdHlwZXMgbWF5IG9ubHkgYmUgY3JlYXRlZCBmcm9tIG9iamVjdCB0eXBlc1wiLlxuICAgIHJldHVybiB7XG4gICAgICAuLi50aGlzLmV4cGxpY2l0IGFzIGFueSwgLy8gRXhwbGljaXQgcHJvcGVydGllcyBjb21lcyBmaXJzdFxuICAgICAgLi4udGhpcy5pbXBsaWNpdCBhcyBhbnlcbiAgICB9O1xuICB9XG5cbiAgcHVibGljIGdldDxLIGV4dGVuZHMga2V5b2YgVD4oa2V5OiBLKTogVFtLXSB7XG4gICAgLy8gRXhwbGljaXQgaGFzIGhpZ2hlciBwcmVjZWRlbmNlXG4gICAgcmV0dXJuIHRoaXMuZXhwbGljaXRba2V5XSAhPT0gdW5kZWZpbmVkID8gdGhpcy5leHBsaWNpdFtrZXldIDogdGhpcy5pbXBsaWNpdFtrZXldO1xuICB9XG5cbiAgcHVibGljIGdldFdpdGhFeHBsaWNpdDxLIGV4dGVuZHMga2V5b2YgVD4oa2V5OiBLKTogRXhwbGljaXQ8VFtLXT4ge1xuICAgIC8vIEV4cGxpY2l0IGhhcyBoaWdoZXIgcHJlY2VkZW5jZVxuICAgIGlmICh0aGlzLmV4cGxpY2l0W2tleV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIHtleHBsaWNpdDogdHJ1ZSwgdmFsdWU6IHRoaXMuZXhwbGljaXRba2V5XX07XG4gICAgfSBlbHNlIGlmICh0aGlzLmltcGxpY2l0W2tleV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIHtleHBsaWNpdDogZmFsc2UsIHZhbHVlOiB0aGlzLmltcGxpY2l0W2tleV19O1xuICAgIH1cbiAgICByZXR1cm4ge2V4cGxpY2l0OiBmYWxzZSwgdmFsdWU6IHVuZGVmaW5lZH07XG4gIH1cblxuICBwdWJsaWMgc2V0V2l0aEV4cGxpY2l0PEsgZXh0ZW5kcyBrZXlvZiBUPihrZXk6IEssIHZhbHVlOiBFeHBsaWNpdDxUW0tdPikge1xuICAgIGlmICh2YWx1ZS52YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLnNldChrZXksIHZhbHVlLnZhbHVlLCB2YWx1ZS5leHBsaWNpdCk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHNldDxLIGV4dGVuZHMga2V5b2YgVD4oa2V5OiBLLCB2YWx1ZTogVFtLXSwgZXhwbGljaXQ6IGJvb2xlYW4pIHtcbiAgICBkZWxldGUgdGhpc1tleHBsaWNpdCA/ICdpbXBsaWNpdCcgOiAnZXhwbGljaXQnXVtrZXldO1xuICAgIHRoaXNbZXhwbGljaXQgPyAnZXhwbGljaXQnIDogJ2ltcGxpY2l0J11ba2V5XSA9IHZhbHVlO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgcHVibGljIGNvcHlLZXlGcm9tU3BsaXQ8UyBleHRlbmRzIFQ+KGtleToga2V5b2YgVCwgczogU3BsaXQ8Uz4pIHtcbiAgICAvLyBFeHBsaWNpdCBoYXMgaGlnaGVyIHByZWNlZGVuY2VcbiAgICBpZiAocy5leHBsaWNpdFtrZXldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuc2V0KGtleSwgcy5leHBsaWNpdFtrZXldLCB0cnVlKTtcbiAgICB9IGVsc2UgaWYgKHMuaW1wbGljaXRba2V5XSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLnNldChrZXksIHMuaW1wbGljaXRba2V5XSwgZmFsc2UpO1xuICAgIH1cbiAgfVxuICBwdWJsaWMgY29weUtleUZyb21PYmplY3Q8UyBleHRlbmRzIFBhcnRpYWw8VD4+KGtleToga2V5b2YgVCwgczogUykge1xuICAgIC8vIEV4cGxpY2l0IGhhcyBoaWdoZXIgcHJlY2VkZW5jZVxuICAgIGlmIChzW2tleV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgdGhpcy5zZXQoa2V5LCBzW2tleV0sIHRydWUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBNZXJnZSBzcGxpdCBvYmplY3QgaW50byB0aGlzIHNwbGl0IG9iamVjdC4gUHJvcGVydGllcyBmcm9tIHRoZSBvdGhlciBzcGxpdFxuICAgKiBvdmVyd3JpdGUgcHJvcGVydGllcyBmcm9tIHRoaXMgc3BsaXQuXG4gICAqL1xuICBwdWJsaWMgY29weUFsbChvdGhlcjogU3BsaXQ8VD4pIHtcbiAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKG90aGVyLmNvbWJpbmUoKSkpIHtcbiAgICAgIGNvbnN0IHZhbCA9IG90aGVyLmdldFdpdGhFeHBsaWNpdChrZXkpO1xuICAgICAgdGhpcy5zZXRXaXRoRXhwbGljaXQoa2V5LCB2YWwpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEV4cGxpY2l0PFQ+IHtcbiAgZXhwbGljaXQ6IGJvb2xlYW47XG4gIHZhbHVlOiBUO1xufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBtYWtlRXhwbGljaXQ8VD4odmFsdWU6IFQpOiBFeHBsaWNpdDxUPiB7XG4gIHJldHVybiB7XG4gICAgZXhwbGljaXQ6IHRydWUsXG4gICAgdmFsdWVcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1ha2VJbXBsaWNpdDxUPih2YWx1ZTogVCk6IEV4cGxpY2l0PFQ+IHtcbiAgcmV0dXJuIHtcbiAgICBleHBsaWNpdDogZmFsc2UsXG4gICAgdmFsdWVcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRpZUJyZWFrQnlDb21wYXJpbmc8UywgVD4oY29tcGFyZTogKHYxOiBULCB2MjogVCkgPT4gbnVtYmVyKSB7XG4gIHJldHVybiAodjE6IEV4cGxpY2l0PFQ+LCB2MjogRXhwbGljaXQ8VD4sIHByb3BlcnR5OiBrZXlvZiBTIHwgbmV2ZXIsIHByb3BlcnR5T2Y6IHN0cmluZyB8IG51bWJlciB8IHN5bWJvbCk6IEV4cGxpY2l0PFQ+ID0+IHtcbiAgICBjb25zdCBkaWZmID0gY29tcGFyZSh2MS52YWx1ZSwgdjIudmFsdWUpO1xuICAgIGlmIChkaWZmID4gMCkge1xuICAgICAgcmV0dXJuIHYxO1xuICAgIH0gZWxzZSBpZiAoZGlmZiA8IDApIHtcbiAgICAgIHJldHVybiB2MjtcbiAgICB9XG4gICAgcmV0dXJuIGRlZmF1bHRUaWVCcmVha2VyPFMsIFQ+KHYxLCB2MiwgcHJvcGVydHksIHByb3BlcnR5T2YpO1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVmYXVsdFRpZUJyZWFrZXI8UywgVD4odjE6IEV4cGxpY2l0PFQ+LCB2MjogRXhwbGljaXQ8VD4sIHByb3BlcnR5OiBrZXlvZiBTLCBwcm9wZXJ0eU9mOiBzdHJpbmcgfCBudW1iZXIgfCBzeW1ib2wpIHtcbiAgaWYgKHYxLmV4cGxpY2l0ICYmIHYyLmV4cGxpY2l0KSB7XG4gICAgbG9nLndhcm4obG9nLm1lc3NhZ2UubWVyZ2VDb25mbGljdGluZ1Byb3BlcnR5KHByb3BlcnR5LCBwcm9wZXJ0eU9mLCB2MS52YWx1ZSwgdjIudmFsdWUpKTtcbiAgfVxuICAvLyBJZiBlcXVhbCBzY29yZSwgcHJlZmVyIHYxLlxuICByZXR1cm4gdjE7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtZXJnZVZhbHVlc1dpdGhFeHBsaWNpdDxTLCBUPihcbiAgICB2MTogRXhwbGljaXQ8VD4sIHYyOiBFeHBsaWNpdDxUPixcbiAgICBwcm9wZXJ0eToga2V5b2YgUyxcbiAgICBwcm9wZXJ0eU9mOiAnc2NhbGUnIHwgJ2F4aXMnIHwgJ2xlZ2VuZCcgfCAnJyxcbiAgICB0aWVCcmVha2VyOiAodjE6IEV4cGxpY2l0PFQ+LCB2MjogRXhwbGljaXQ8VD4sIHByb3BlcnR5OiBrZXlvZiBTLCBwcm9wZXJ0eU9mOiBzdHJpbmcpID0+IEV4cGxpY2l0PFQ+ID0gZGVmYXVsdFRpZUJyZWFrZXJcbiAgKSB7XG4gIGlmICh2MSA9PT0gdW5kZWZpbmVkIHx8IHYxLnZhbHVlID09PSB1bmRlZmluZWQpIHtcbiAgICAvLyBGb3IgZmlyc3QgcnVuXG4gICAgcmV0dXJuIHYyO1xuICB9XG5cbiAgaWYgKHYxLmV4cGxpY2l0ICYmICF2Mi5leHBsaWNpdCkge1xuICAgIHJldHVybiB2MTtcbiAgfSBlbHNlIGlmICh2Mi5leHBsaWNpdCAmJiAhdjEuZXhwbGljaXQpIHtcbiAgICByZXR1cm4gdjI7XG4gIH0gZWxzZSBpZiAoc3RyaW5naWZ5KHYxLnZhbHVlKSA9PT0gc3RyaW5naWZ5KHYyLnZhbHVlKSkge1xuICAgIHJldHVybiB2MTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdGllQnJlYWtlcih2MSwgdjIsIHByb3BlcnR5LCBwcm9wZXJ0eU9mKTtcbiAgfVxufVxuIl19","import * as tslib_1 from \"tslib\";\nimport { Split } from '../split';\nvar LegendComponent = /** @class */ (function (_super) {\n    tslib_1.__extends(LegendComponent, _super);\n    function LegendComponent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return LegendComponent;\n}(Split));\nexport { LegendComponent };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvbGVnZW5kL2NvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBR0EsT0FBTyxFQUFDLEtBQUssRUFBQyxNQUFNLFVBQVUsQ0FBQztBQUcvQjtJQUFxQywyQ0FBZTtJQUFwRDs7SUFBc0QsQ0FBQztJQUFELHNCQUFDO0FBQUQsQ0FBQyxBQUF2RCxDQUFxQyxLQUFLLEdBQWEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0xlZ2VuZH0gZnJvbSAnLi4vLi4vL2xlZ2VuZCc7XG5pbXBvcnQge05vblBvc2l0aW9uU2NhbGVDaGFubmVsfSBmcm9tICcuLi8uLi9jaGFubmVsJztcbmltcG9ydCB7VmdMZWdlbmR9IGZyb20gJy4uLy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7U3BsaXR9IGZyb20gJy4uL3NwbGl0JztcblxuXG5leHBvcnQgY2xhc3MgTGVnZW5kQ29tcG9uZW50IGV4dGVuZHMgU3BsaXQ8VmdMZWdlbmQ+IHt9XG5cbi8vIFVzaW5nIE1hcHBlZCBUeXBlIHRvIGRlY2xhcmUgdHlwZSAoaHR0cHM6Ly93d3cudHlwZXNjcmlwdGxhbmcub3JnL2RvY3MvaGFuZGJvb2svYWR2YW5jZWQtdHlwZXMuaHRtbCNtYXBwZWQtdHlwZXMpXG5leHBvcnQgdHlwZSBMZWdlbmRDb21wb25lbnRJbmRleCA9IHtbUCBpbiBOb25Qb3NpdGlvblNjYWxlQ2hhbm5lbF0/OiBMZWdlbmRDb21wb25lbnR9O1xuXG5leHBvcnQgdHlwZSBMZWdlbmRJbmRleCA9IHtbUCBpbiBOb25Qb3NpdGlvblNjYWxlQ2hhbm5lbF0/OiBMZWdlbmR9O1xuIl19","import * as tslib_1 from \"tslib\";\nimport { isArray } from 'vega-util';\nimport { COLOR, OPACITY, SHAPE } from '../../channel';\nimport { hasConditionalValueDef, isTimeFieldDef, isValueDef, } from '../../fielddef';\nimport { AREA, BAR, CIRCLE, FILL_STROKE_CONFIG, GEOSHAPE, LINE, POINT, SQUARE, TEXT, TICK } from '../../mark';\nimport { ScaleType } from '../../scale';\nimport { keys } from '../../util';\nimport { applyMarkConfig, timeFormatExpression } from '../common';\nimport * as mixins from '../mark/mixins';\nexport function symbols(fieldDef, symbolsSpec, model, channel, type) {\n    if (type === 'gradient') {\n        return undefined;\n    }\n    var out = tslib_1.__assign({}, applyMarkConfig({}, model, FILL_STROKE_CONFIG), mixins.color(model));\n    switch (model.mark) {\n        case BAR:\n        case TICK:\n        case TEXT:\n            out.shape = { value: 'square' };\n            break;\n        case CIRCLE:\n        case SQUARE:\n            out.shape = { value: model.mark };\n            break;\n        case POINT:\n        case LINE:\n        case GEOSHAPE:\n        case AREA:\n            // use default circle\n            break;\n    }\n    var markDef = model.markDef, encoding = model.encoding;\n    var filled = markDef.filled;\n    if (out.fill) {\n        // for fill legend, we don't want any fill in symbol\n        if (channel === 'fill' || (filled && channel === COLOR)) {\n            delete out.fill;\n        }\n        else {\n            if (out.fill['field']) {\n                // For others, remove fill field\n                delete out.fill;\n            }\n            else if (isArray(out.fill)) {\n                var fill = getFirstConditionValue(encoding.fill || encoding.color) || markDef.fill || (filled && markDef.color);\n                if (fill) {\n                    out.fill = { value: fill };\n                }\n            }\n        }\n    }\n    if (out.stroke) {\n        if (channel === 'stroke' || (!filled && channel === COLOR)) {\n            delete out.stroke;\n        }\n        else {\n            if (out.stroke['field']) {\n                // For others, remove stroke field\n                delete out.stroke;\n            }\n            else if (isArray(out.stroke)) {\n                var stroke = getFirstConditionValue(encoding.stroke || encoding.color) || markDef.stroke || (!filled && markDef.color);\n                if (stroke) {\n                    out.stroke = { value: stroke };\n                }\n            }\n        }\n    }\n    if (out.fill && out.fill['value'] !== 'transparent' && !out.stroke) {\n        // for non color channel's legend, we need to override symbol stroke config from Vega config\n        out.stroke = { value: 'transparent' };\n    }\n    if (channel !== SHAPE) {\n        var shape = getFirstConditionValue(encoding.shape) || markDef.shape;\n        if (shape) {\n            out.shape = { value: shape };\n        }\n    }\n    if (channel !== OPACITY) {\n        var opacity = getMaxValue(encoding.opacity) || markDef.opacity;\n        if (opacity) { // only apply opacity if it is neither zero or undefined\n            out.opacity = { value: opacity };\n        }\n    }\n    out = tslib_1.__assign({}, out, symbolsSpec);\n    return keys(out).length > 0 ? out : undefined;\n}\nexport function gradient(fieldDef, gradientSpec, model, channel, type) {\n    var out = {};\n    if (type === 'gradient') {\n        var opacity = getMaxValue(model.encoding.opacity) || model.markDef.opacity;\n        if (opacity) { // only apply opacity if it is neither zero or undefined\n            out.opacity = { value: opacity };\n        }\n    }\n    out = tslib_1.__assign({}, out, gradientSpec);\n    return keys(out).length > 0 ? out : undefined;\n}\nexport function labels(fieldDef, labelsSpec, model, channel, type) {\n    var legend = model.legend(channel);\n    var config = model.config;\n    var out = {};\n    if (isTimeFieldDef(fieldDef)) {\n        var isUTCScale = model.getScaleComponent(channel).get('type') === ScaleType.UTC;\n        var expr = timeFormatExpression('datum.value', fieldDef.timeUnit, legend.format, config.legend.shortTimeLabels, config.timeFormat, isUTCScale);\n        labelsSpec = tslib_1.__assign({}, (expr ? { text: { signal: expr } } : {}), labelsSpec);\n    }\n    out = tslib_1.__assign({}, out, labelsSpec);\n    return keys(out).length > 0 ? out : undefined;\n}\nfunction getMaxValue(channelDef) {\n    return getConditionValue(channelDef, function (v, conditionalDef) { return Math.max(v, conditionalDef.value); });\n}\nfunction getFirstConditionValue(channelDef) {\n    return getConditionValue(channelDef, function (v, conditionalDef) { return v !== undefined ? v : conditionalDef.value; });\n}\nfunction getConditionValue(channelDef, reducer) {\n    if (hasConditionalValueDef(channelDef)) {\n        return (isArray(channelDef.condition) ? channelDef.condition : [channelDef.condition])\n            .reduce(reducer, channelDef.value);\n    }\n    else if (isValueDef(channelDef)) {\n        return channelDef.value;\n    }\n    return undefined;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW5jb2RlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvbGVnZW5kL2VuY29kZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUVsQyxPQUFPLEVBQVUsS0FBSyxFQUEyQixPQUFPLEVBQUUsS0FBSyxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQ3RGLE9BQU8sRUFJTCxzQkFBc0IsRUFDdEIsY0FBYyxFQUNkLFVBQVUsR0FJWCxNQUFNLGdCQUFnQixDQUFDO0FBQ3hCLE9BQU8sRUFBQyxJQUFJLEVBQUUsR0FBRyxFQUFFLE1BQU0sRUFBRSxrQkFBa0IsRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBQyxNQUFNLFlBQVksQ0FBQztBQUM1RyxPQUFPLEVBQUMsU0FBUyxFQUFDLE1BQU0sYUFBYSxDQUFDO0FBQ3RDLE9BQU8sRUFBQyxJQUFJLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFFaEMsT0FBTyxFQUFDLGVBQWUsRUFBRSxvQkFBb0IsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUNoRSxPQUFPLEtBQUssTUFBTSxNQUFNLGdCQUFnQixDQUFDO0FBR3pDLE1BQU0sa0JBQWtCLFFBQTBCLEVBQUUsV0FBZ0IsRUFBRSxLQUFnQixFQUFFLE9BQWdCLEVBQUUsSUFBZ0I7SUFDeEgsSUFBSSxJQUFJLEtBQUssVUFBVSxFQUFFO1FBQ3ZCLE9BQU8sU0FBUyxDQUFDO0tBQ2xCO0lBRUQsSUFBSSxHQUFHLHdCQUNGLGVBQWUsQ0FBQyxFQUFFLEVBQUUsS0FBSyxFQUFFLGtCQUFrQixDQUFDLEVBQzlDLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQ3ZCLENBQUM7SUFFRixRQUFRLEtBQUssQ0FBQyxJQUFJLEVBQUU7UUFDbEIsS0FBSyxHQUFHLENBQUM7UUFDVCxLQUFLLElBQUksQ0FBQztRQUNWLEtBQUssSUFBSTtZQUNQLEdBQUcsQ0FBQyxLQUFLLEdBQUcsRUFBQyxLQUFLLEVBQUUsUUFBUSxFQUFDLENBQUM7WUFDOUIsTUFBTTtRQUNSLEtBQUssTUFBTSxDQUFDO1FBQ1osS0FBSyxNQUFNO1lBQ1QsR0FBRyxDQUFDLEtBQUssR0FBRyxFQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsSUFBSSxFQUFDLENBQUM7WUFDaEMsTUFBTTtRQUNSLEtBQUssS0FBSyxDQUFDO1FBQ1gsS0FBSyxJQUFJLENBQUM7UUFDVixLQUFLLFFBQVEsQ0FBQztRQUNkLEtBQUssSUFBSTtZQUNQLHFCQUFxQjtZQUNyQixNQUFNO0tBQ1Q7SUFFTSxJQUFBLHVCQUFPLEVBQUUseUJBQVEsQ0FBVTtJQUNsQyxJQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDO0lBRTlCLElBQUksR0FBRyxDQUFDLElBQUksRUFBRTtRQUNaLG9EQUFvRDtRQUNwRCxJQUFJLE9BQU8sS0FBSyxNQUFNLElBQUksQ0FBQyxNQUFNLElBQUksT0FBTyxLQUFLLEtBQUssQ0FBQyxFQUFFO1lBQ3ZELE9BQU8sR0FBRyxDQUFDLElBQUksQ0FBQztTQUNqQjthQUFNO1lBQ0wsSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFO2dCQUNyQixnQ0FBZ0M7Z0JBQ2hDLE9BQU8sR0FBRyxDQUFDLElBQUksQ0FBQzthQUNqQjtpQkFBTSxJQUFJLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUU7Z0JBQzVCLElBQU0sSUFBSSxHQUFHLHNCQUFzQixDQUFDLFFBQVEsQ0FBQyxJQUFJLElBQUksUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLE9BQU8sQ0FBQyxJQUFJLElBQUksQ0FBQyxNQUFNLElBQUksT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUNsSCxJQUFJLElBQUksRUFBRTtvQkFDUixHQUFHLENBQUMsSUFBSSxHQUFHLEVBQUMsS0FBSyxFQUFFLElBQUksRUFBQyxDQUFDO2lCQUMxQjthQUNGO1NBQ0Y7S0FDRjtJQUVELElBQUksR0FBRyxDQUFDLE1BQU0sRUFBRTtRQUNkLElBQUksT0FBTyxLQUFLLFFBQVEsSUFBSSxDQUFDLENBQUMsTUFBTSxJQUFJLE9BQU8sS0FBSyxLQUFLLENBQUMsRUFBRTtZQUMxRCxPQUFPLEdBQUcsQ0FBQyxNQUFNLENBQUM7U0FDbkI7YUFBTTtZQUNMLElBQUksR0FBRyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsRUFBRTtnQkFDdkIsa0NBQWtDO2dCQUNsQyxPQUFPLEdBQUcsQ0FBQyxNQUFNLENBQUM7YUFDbkI7aUJBQU0sSUFBSSxPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxFQUFFO2dCQUM5QixJQUFNLE1BQU0sR0FBRyxzQkFBc0IsQ0FBQyxRQUFRLENBQUMsTUFBTSxJQUFJLFFBQVEsQ0FBQyxLQUFLLENBQUMsSUFBSSxPQUFPLENBQUMsTUFBTSxJQUFJLENBQUMsQ0FBQyxNQUFNLElBQUksT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUN6SCxJQUFJLE1BQU0sRUFBRTtvQkFDVixHQUFHLENBQUMsTUFBTSxHQUFHLEVBQUMsS0FBSyxFQUFFLE1BQU0sRUFBQyxDQUFDO2lCQUM5QjthQUNGO1NBQ0Y7S0FDRjtJQUVELElBQUksR0FBRyxDQUFDLElBQUksSUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLGFBQWEsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUU7UUFDbEUsNEZBQTRGO1FBQzVGLEdBQUcsQ0FBQyxNQUFNLEdBQUcsRUFBQyxLQUFLLEVBQUUsYUFBYSxFQUFDLENBQUM7S0FDckM7SUFFRCxJQUFJLE9BQU8sS0FBSyxLQUFLLEVBQUU7UUFDckIsSUFBTSxLQUFLLEdBQUcsc0JBQXNCLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFJLE9BQU8sQ0FBQyxLQUFLLENBQUM7UUFDdEUsSUFBSSxLQUFLLEVBQUU7WUFDVCxHQUFHLENBQUMsS0FBSyxHQUFHLEVBQUMsS0FBSyxFQUFFLEtBQUssRUFBQyxDQUFDO1NBQzVCO0tBQ0Y7SUFFRCxJQUFJLE9BQU8sS0FBSyxPQUFPLEVBQUU7UUFDdkIsSUFBTSxPQUFPLEdBQUcsV0FBVyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxPQUFPLENBQUMsT0FBTyxDQUFDO1FBQ2pFLElBQUksT0FBTyxFQUFFLEVBQUUsd0RBQXdEO1lBQ3JFLEdBQUcsQ0FBQyxPQUFPLEdBQUcsRUFBQyxLQUFLLEVBQUUsT0FBTyxFQUFDLENBQUM7U0FDaEM7S0FDRjtJQUVELEdBQUcsd0JBQU8sR0FBRyxFQUFLLFdBQVcsQ0FBQyxDQUFDO0lBRS9CLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO0FBQ2hELENBQUM7QUFFRCxNQUFNLG1CQUFtQixRQUEwQixFQUFFLFlBQWlCLEVBQUUsS0FBZ0IsRUFBRSxPQUFnQixFQUFFLElBQWdCO0lBQzFILElBQUksR0FBRyxHQUFRLEVBQUUsQ0FBQztJQUVsQixJQUFJLElBQUksS0FBSyxVQUFVLEVBQUU7UUFDdkIsSUFBTSxPQUFPLEdBQUcsV0FBVyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUM7UUFDN0UsSUFBSSxPQUFPLEVBQUUsRUFBRSx3REFBd0Q7WUFDckUsR0FBRyxDQUFDLE9BQU8sR0FBRyxFQUFDLEtBQUssRUFBRSxPQUFPLEVBQUMsQ0FBQztTQUNoQztLQUNGO0lBRUQsR0FBRyx3QkFBTyxHQUFHLEVBQUssWUFBWSxDQUFDLENBQUM7SUFDaEMsT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7QUFDaEQsQ0FBQztBQUVELE1BQU0saUJBQWlCLFFBQTBCLEVBQUUsVUFBZSxFQUFFLEtBQWdCLEVBQUUsT0FBZ0MsRUFBRSxJQUFnQjtJQUN0SSxJQUFNLE1BQU0sR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3JDLElBQU0sTUFBTSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUM7SUFFNUIsSUFBSSxHQUFHLEdBQVEsRUFBRSxDQUFDO0lBRWxCLElBQUksY0FBYyxDQUFDLFFBQVEsQ0FBQyxFQUFFO1FBQzVCLElBQU0sVUFBVSxHQUFHLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEtBQUssU0FBUyxDQUFDLEdBQUcsQ0FBQztRQUNsRixJQUFNLElBQUksR0FBRyxvQkFBb0IsQ0FBQyxhQUFhLEVBQUUsUUFBUSxDQUFDLFFBQVEsRUFBRSxNQUFNLENBQUMsTUFBTSxFQUFFLE1BQU0sQ0FBQyxNQUFNLENBQUMsZUFBZSxFQUFFLE1BQU0sQ0FBQyxVQUFVLEVBQUUsVUFBVSxDQUFDLENBQUM7UUFDakosVUFBVSx3QkFDTCxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBQyxJQUFJLEVBQUUsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQ3BDLFVBQVUsQ0FDZCxDQUFDO0tBQ0g7SUFFRCxHQUFHLHdCQUFPLEdBQUcsRUFBSyxVQUFVLENBQUMsQ0FBQztJQUU5QixPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztBQUNoRCxDQUFDO0FBRUQscUJBQXFCLFVBQTZHO0lBQ2hJLE9BQU8saUJBQWlCLENBQUMsVUFBVSxFQUNqQyxVQUFDLENBQVMsRUFBRSxjQUFjLElBQUssT0FBQSxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxjQUFjLENBQUMsS0FBWSxDQUFDLEVBQXhDLENBQXdDLENBQ3hFLENBQUM7QUFDSixDQUFDO0FBRUQsZ0NBQWdDLFVBQTZHO0lBQzNJLE9BQU8saUJBQWlCLENBQUMsVUFBVSxFQUNqQyxVQUFDLENBQVMsRUFBRSxjQUFjLElBQUssT0FBQSxDQUFDLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxLQUFLLEVBQTFDLENBQTBDLENBQzFFLENBQUM7QUFDSixDQUFDO0FBRUQsMkJBQ0UsVUFBNkcsRUFDN0csT0FBNkQ7SUFHN0QsSUFBSSxzQkFBc0IsQ0FBQyxVQUFVLENBQUMsRUFBRTtRQUN0QyxPQUFPLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUM7YUFDbkYsTUFBTSxDQUFDLE9BQU8sRUFBRSxVQUFVLENBQUMsS0FBWSxDQUFDLENBQUM7S0FDN0M7U0FBTSxJQUFJLFVBQVUsQ0FBQyxVQUFVLENBQUMsRUFBRTtRQUNqQyxPQUFPLFVBQVUsQ0FBQyxLQUFZLENBQUM7S0FDaEM7SUFDRCxPQUFPLFNBQVMsQ0FBQztBQUNuQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtpc0FycmF5fSBmcm9tICd2ZWdhLXV0aWwnO1xuXG5pbXBvcnQge0NoYW5uZWwsIENPTE9SLCBOb25Qb3NpdGlvblNjYWxlQ2hhbm5lbCwgT1BBQ0lUWSwgU0hBUEV9IGZyb20gJy4uLy4uL2NoYW5uZWwnO1xuaW1wb3J0IHtcbiAgQ29uZGl0aW9uYWwsXG4gIEZpZWxkRGVmLFxuICBGaWVsZERlZldpdGhDb25kaXRpb24sXG4gIGhhc0NvbmRpdGlvbmFsVmFsdWVEZWYsXG4gIGlzVGltZUZpZWxkRGVmLFxuICBpc1ZhbHVlRGVmLFxuICBNYXJrUHJvcEZpZWxkRGVmLFxuICBWYWx1ZURlZixcbiAgVmFsdWVEZWZXaXRoQ29uZGl0aW9uLFxufSBmcm9tICcuLi8uLi9maWVsZGRlZic7XG5pbXBvcnQge0FSRUEsIEJBUiwgQ0lSQ0xFLCBGSUxMX1NUUk9LRV9DT05GSUcsIEdFT1NIQVBFLCBMSU5FLCBQT0lOVCwgU1FVQVJFLCBURVhULCBUSUNLfSBmcm9tICcuLi8uLi9tYXJrJztcbmltcG9ydCB7U2NhbGVUeXBlfSBmcm9tICcuLi8uLi9zY2FsZSc7XG5pbXBvcnQge2tleXN9IGZyb20gJy4uLy4uL3V0aWwnO1xuaW1wb3J0IHtMZWdlbmRUeXBlLCBWZ0VuY29kZUVudHJ5fSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge2FwcGx5TWFya0NvbmZpZywgdGltZUZvcm1hdEV4cHJlc3Npb259IGZyb20gJy4uL2NvbW1vbic7XG5pbXBvcnQgKiBhcyBtaXhpbnMgZnJvbSAnLi4vbWFyay9taXhpbnMnO1xuaW1wb3J0IHtVbml0TW9kZWx9IGZyb20gJy4uL3VuaXQnO1xuXG5leHBvcnQgZnVuY3Rpb24gc3ltYm9scyhmaWVsZERlZjogRmllbGREZWY8c3RyaW5nPiwgc3ltYm9sc1NwZWM6IGFueSwgbW9kZWw6IFVuaXRNb2RlbCwgY2hhbm5lbDogQ2hhbm5lbCwgdHlwZTogTGVnZW5kVHlwZSk6IFZnRW5jb2RlRW50cnkge1xuICBpZiAodHlwZSA9PT0gJ2dyYWRpZW50Jykge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICBsZXQgb3V0ID0ge1xuICAgIC4uLmFwcGx5TWFya0NvbmZpZyh7fSwgbW9kZWwsIEZJTExfU1RST0tFX0NPTkZJRyksXG4gICAgLi4ubWl4aW5zLmNvbG9yKG1vZGVsKVxuICB9O1xuXG4gIHN3aXRjaCAobW9kZWwubWFyaykge1xuICAgIGNhc2UgQkFSOlxuICAgIGNhc2UgVElDSzpcbiAgICBjYXNlIFRFWFQ6XG4gICAgICBvdXQuc2hhcGUgPSB7dmFsdWU6ICdzcXVhcmUnfTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgQ0lSQ0xFOlxuICAgIGNhc2UgU1FVQVJFOlxuICAgICAgb3V0LnNoYXBlID0ge3ZhbHVlOiBtb2RlbC5tYXJrfTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgUE9JTlQ6XG4gICAgY2FzZSBMSU5FOlxuICAgIGNhc2UgR0VPU0hBUEU6XG4gICAgY2FzZSBBUkVBOlxuICAgICAgLy8gdXNlIGRlZmF1bHQgY2lyY2xlXG4gICAgICBicmVhaztcbiAgfVxuXG4gIGNvbnN0IHttYXJrRGVmLCBlbmNvZGluZ30gPSBtb2RlbDtcbiAgY29uc3QgZmlsbGVkID0gbWFya0RlZi5maWxsZWQ7XG5cbiAgaWYgKG91dC5maWxsKSB7XG4gICAgLy8gZm9yIGZpbGwgbGVnZW5kLCB3ZSBkb24ndCB3YW50IGFueSBmaWxsIGluIHN5bWJvbFxuICAgIGlmIChjaGFubmVsID09PSAnZmlsbCcgfHwgKGZpbGxlZCAmJiBjaGFubmVsID09PSBDT0xPUikpIHtcbiAgICAgIGRlbGV0ZSBvdXQuZmlsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKG91dC5maWxsWydmaWVsZCddKSB7XG4gICAgICAgIC8vIEZvciBvdGhlcnMsIHJlbW92ZSBmaWxsIGZpZWxkXG4gICAgICAgIGRlbGV0ZSBvdXQuZmlsbDtcbiAgICAgIH0gZWxzZSBpZiAoaXNBcnJheShvdXQuZmlsbCkpIHtcbiAgICAgICAgY29uc3QgZmlsbCA9IGdldEZpcnN0Q29uZGl0aW9uVmFsdWUoZW5jb2RpbmcuZmlsbCB8fCBlbmNvZGluZy5jb2xvcikgfHwgbWFya0RlZi5maWxsIHx8IChmaWxsZWQgJiYgbWFya0RlZi5jb2xvcik7XG4gICAgICAgIGlmIChmaWxsKSB7XG4gICAgICAgICAgb3V0LmZpbGwgPSB7dmFsdWU6IGZpbGx9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYgKG91dC5zdHJva2UpIHtcbiAgICBpZiAoY2hhbm5lbCA9PT0gJ3N0cm9rZScgfHwgKCFmaWxsZWQgJiYgY2hhbm5lbCA9PT0gQ09MT1IpKSB7XG4gICAgICBkZWxldGUgb3V0LnN0cm9rZTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKG91dC5zdHJva2VbJ2ZpZWxkJ10pIHtcbiAgICAgICAgLy8gRm9yIG90aGVycywgcmVtb3ZlIHN0cm9rZSBmaWVsZFxuICAgICAgICBkZWxldGUgb3V0LnN0cm9rZTtcbiAgICAgIH0gZWxzZSBpZiAoaXNBcnJheShvdXQuc3Ryb2tlKSkge1xuICAgICAgICBjb25zdCBzdHJva2UgPSBnZXRGaXJzdENvbmRpdGlvblZhbHVlKGVuY29kaW5nLnN0cm9rZSB8fCBlbmNvZGluZy5jb2xvcikgfHwgbWFya0RlZi5zdHJva2UgfHwgKCFmaWxsZWQgJiYgbWFya0RlZi5jb2xvcik7XG4gICAgICAgIGlmIChzdHJva2UpIHtcbiAgICAgICAgICBvdXQuc3Ryb2tlID0ge3ZhbHVlOiBzdHJva2V9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaWYgKG91dC5maWxsICYmIG91dC5maWxsWyd2YWx1ZSddICE9PSAndHJhbnNwYXJlbnQnICYmICFvdXQuc3Ryb2tlKSB7XG4gICAgLy8gZm9yIG5vbiBjb2xvciBjaGFubmVsJ3MgbGVnZW5kLCB3ZSBuZWVkIHRvIG92ZXJyaWRlIHN5bWJvbCBzdHJva2UgY29uZmlnIGZyb20gVmVnYSBjb25maWdcbiAgICBvdXQuc3Ryb2tlID0ge3ZhbHVlOiAndHJhbnNwYXJlbnQnfTtcbiAgfVxuXG4gIGlmIChjaGFubmVsICE9PSBTSEFQRSkge1xuICAgIGNvbnN0IHNoYXBlID0gZ2V0Rmlyc3RDb25kaXRpb25WYWx1ZShlbmNvZGluZy5zaGFwZSkgfHwgbWFya0RlZi5zaGFwZTtcbiAgICBpZiAoc2hhcGUpIHtcbiAgICAgIG91dC5zaGFwZSA9IHt2YWx1ZTogc2hhcGV9O1xuICAgIH1cbiAgfVxuXG4gIGlmIChjaGFubmVsICE9PSBPUEFDSVRZKSB7XG4gICAgY29uc3Qgb3BhY2l0eSA9IGdldE1heFZhbHVlKGVuY29kaW5nLm9wYWNpdHkpIHx8IG1hcmtEZWYub3BhY2l0eTtcbiAgICBpZiAob3BhY2l0eSkgeyAvLyBvbmx5IGFwcGx5IG9wYWNpdHkgaWYgaXQgaXMgbmVpdGhlciB6ZXJvIG9yIHVuZGVmaW5lZFxuICAgICAgb3V0Lm9wYWNpdHkgPSB7dmFsdWU6IG9wYWNpdHl9O1xuICAgIH1cbiAgfVxuXG4gIG91dCA9IHsuLi5vdXQsIC4uLnN5bWJvbHNTcGVjfTtcblxuICByZXR1cm4ga2V5cyhvdXQpLmxlbmd0aCA+IDAgPyBvdXQgOiB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBncmFkaWVudChmaWVsZERlZjogRmllbGREZWY8c3RyaW5nPiwgZ3JhZGllbnRTcGVjOiBhbnksIG1vZGVsOiBVbml0TW9kZWwsIGNoYW5uZWw6IENoYW5uZWwsIHR5cGU6IExlZ2VuZFR5cGUpIHtcbiAgbGV0IG91dDogYW55ID0ge307XG5cbiAgaWYgKHR5cGUgPT09ICdncmFkaWVudCcpIHtcbiAgICBjb25zdCBvcGFjaXR5ID0gZ2V0TWF4VmFsdWUobW9kZWwuZW5jb2Rpbmcub3BhY2l0eSkgfHwgbW9kZWwubWFya0RlZi5vcGFjaXR5O1xuICAgIGlmIChvcGFjaXR5KSB7IC8vIG9ubHkgYXBwbHkgb3BhY2l0eSBpZiBpdCBpcyBuZWl0aGVyIHplcm8gb3IgdW5kZWZpbmVkXG4gICAgICBvdXQub3BhY2l0eSA9IHt2YWx1ZTogb3BhY2l0eX07XG4gICAgfVxuICB9XG5cbiAgb3V0ID0gey4uLm91dCwgLi4uZ3JhZGllbnRTcGVjfTtcbiAgcmV0dXJuIGtleXMob3V0KS5sZW5ndGggPiAwID8gb3V0IDogdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbGFiZWxzKGZpZWxkRGVmOiBGaWVsZERlZjxzdHJpbmc+LCBsYWJlbHNTcGVjOiBhbnksIG1vZGVsOiBVbml0TW9kZWwsIGNoYW5uZWw6IE5vblBvc2l0aW9uU2NhbGVDaGFubmVsLCB0eXBlOiBMZWdlbmRUeXBlKSB7XG4gIGNvbnN0IGxlZ2VuZCA9IG1vZGVsLmxlZ2VuZChjaGFubmVsKTtcbiAgY29uc3QgY29uZmlnID0gbW9kZWwuY29uZmlnO1xuXG4gIGxldCBvdXQ6IGFueSA9IHt9O1xuXG4gIGlmIChpc1RpbWVGaWVsZERlZihmaWVsZERlZikpIHtcbiAgICBjb25zdCBpc1VUQ1NjYWxlID0gbW9kZWwuZ2V0U2NhbGVDb21wb25lbnQoY2hhbm5lbCkuZ2V0KCd0eXBlJykgPT09IFNjYWxlVHlwZS5VVEM7XG4gICAgY29uc3QgZXhwciA9IHRpbWVGb3JtYXRFeHByZXNzaW9uKCdkYXR1bS52YWx1ZScsIGZpZWxkRGVmLnRpbWVVbml0LCBsZWdlbmQuZm9ybWF0LCBjb25maWcubGVnZW5kLnNob3J0VGltZUxhYmVscywgY29uZmlnLnRpbWVGb3JtYXQsIGlzVVRDU2NhbGUpO1xuICAgIGxhYmVsc1NwZWMgPSB7XG4gICAgICAuLi4oZXhwciA/IHt0ZXh0OiB7c2lnbmFsOiBleHByfX0gOiB7fSksXG4gICAgICAuLi5sYWJlbHNTcGVjLFxuICAgIH07XG4gIH1cblxuICBvdXQgPSB7Li4ub3V0LCAuLi5sYWJlbHNTcGVjfTtcblxuICByZXR1cm4ga2V5cyhvdXQpLmxlbmd0aCA+IDAgPyBvdXQgOiB1bmRlZmluZWQ7XG59XG5cbmZ1bmN0aW9uIGdldE1heFZhbHVlKGNoYW5uZWxEZWY6IEZpZWxkRGVmV2l0aENvbmRpdGlvbjxNYXJrUHJvcEZpZWxkRGVmPHN0cmluZz4+IHwgVmFsdWVEZWZXaXRoQ29uZGl0aW9uPE1hcmtQcm9wRmllbGREZWY8c3RyaW5nPj4pIHtcbiAgcmV0dXJuIGdldENvbmRpdGlvblZhbHVlKGNoYW5uZWxEZWYsXG4gICAgKHY6IG51bWJlciwgY29uZGl0aW9uYWxEZWYpID0+IE1hdGgubWF4KHYsIGNvbmRpdGlvbmFsRGVmLnZhbHVlIGFzIGFueSlcbiAgKTtcbn1cblxuZnVuY3Rpb24gZ2V0Rmlyc3RDb25kaXRpb25WYWx1ZShjaGFubmVsRGVmOiBGaWVsZERlZldpdGhDb25kaXRpb248TWFya1Byb3BGaWVsZERlZjxzdHJpbmc+PiB8IFZhbHVlRGVmV2l0aENvbmRpdGlvbjxNYXJrUHJvcEZpZWxkRGVmPHN0cmluZz4+KSB7XG4gIHJldHVybiBnZXRDb25kaXRpb25WYWx1ZShjaGFubmVsRGVmLFxuICAgICh2OiBudW1iZXIsIGNvbmRpdGlvbmFsRGVmKSA9PiB2ICE9PSB1bmRlZmluZWQgPyB2IDogY29uZGl0aW9uYWxEZWYudmFsdWVcbiAgKTtcbn1cblxuZnVuY3Rpb24gZ2V0Q29uZGl0aW9uVmFsdWU8VD4oXG4gIGNoYW5uZWxEZWY6IEZpZWxkRGVmV2l0aENvbmRpdGlvbjxNYXJrUHJvcEZpZWxkRGVmPHN0cmluZz4+IHwgVmFsdWVEZWZXaXRoQ29uZGl0aW9uPE1hcmtQcm9wRmllbGREZWY8c3RyaW5nPj4sXG4gIHJlZHVjZXI6ICh2YWw6IFQsIGNvbmRpdGlvbmFsRGVmOiBDb25kaXRpb25hbDxWYWx1ZURlZj4pID0+IFRcbik6IFQge1xuXG4gIGlmIChoYXNDb25kaXRpb25hbFZhbHVlRGVmKGNoYW5uZWxEZWYpKSB7XG4gICAgcmV0dXJuIChpc0FycmF5KGNoYW5uZWxEZWYuY29uZGl0aW9uKSA/IGNoYW5uZWxEZWYuY29uZGl0aW9uIDogW2NoYW5uZWxEZWYuY29uZGl0aW9uXSlcbiAgICAgIC5yZWR1Y2UocmVkdWNlciwgY2hhbm5lbERlZi52YWx1ZSBhcyBhbnkpO1xuICB9IGVsc2UgaWYgKGlzVmFsdWVEZWYoY2hhbm5lbERlZikpIHtcbiAgICByZXR1cm4gY2hhbm5lbERlZi52YWx1ZSBhcyBhbnk7XG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cbiJdfQ==","import { isColorChannel } from '../../channel';\nimport { dateTimeExpr, isDateTime } from '../../datetime';\nimport { isBinScale } from '../../scale';\nimport { contains } from '../../util';\nexport function values(legend) {\n    var vals = legend.values;\n    if (vals && isDateTime(vals[0])) {\n        return vals.map(function (dt) {\n            // normalize = true as end user won't put 0 = January\n            return { signal: dateTimeExpr(dt, true) };\n        });\n    }\n    return vals;\n}\nexport function type(t, channel, scaleType) {\n    if (isColorChannel(channel) && ((t === 'quantitative' && !isBinScale(scaleType)) ||\n        (t === 'temporal' && contains(['time', 'utc'], scaleType)))) {\n        return 'gradient';\n    }\n    return undefined;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvcGVydGllcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21waWxlL2xlZ2VuZC9wcm9wZXJ0aWVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBVSxjQUFjLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDdEQsT0FBTyxFQUFXLFlBQVksRUFBRSxVQUFVLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUVsRSxPQUFPLEVBQUMsVUFBVSxFQUFZLE1BQU0sYUFBYSxDQUFDO0FBRWxELE9BQU8sRUFBQyxRQUFRLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFFcEMsTUFBTSxpQkFBaUIsTUFBYztJQUNuQyxJQUFNLElBQUksR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDO0lBQzNCLElBQUksSUFBSSxJQUFJLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRTtRQUMvQixPQUFRLElBQW1CLENBQUMsR0FBRyxDQUFDLFVBQUMsRUFBRTtZQUNqQyxxREFBcUQ7WUFDckQsT0FBTyxFQUFDLE1BQU0sRUFBRSxZQUFZLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQyxFQUFDLENBQUM7UUFDMUMsQ0FBQyxDQUFDLENBQUM7S0FDSjtJQUNELE9BQU8sSUFBSSxDQUFDO0FBQ2QsQ0FBQztBQUVELE1BQU0sZUFBZSxDQUFPLEVBQUUsT0FBZ0IsRUFBRSxTQUFvQjtJQUNsRSxJQUNJLGNBQWMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUN6QixDQUFDLENBQUMsS0FBSyxjQUFjLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDaEQsQ0FBQyxDQUFDLEtBQUssVUFBVSxJQUFJLFFBQVEsQ0FBWSxDQUFDLE1BQU0sRUFBRSxLQUFLLENBQUMsRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUN0RSxFQUNEO1FBQ0YsT0FBTyxVQUFVLENBQUM7S0FDbkI7SUFDRCxPQUFPLFNBQVMsQ0FBQztBQUNuQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDaGFubmVsLCBpc0NvbG9yQ2hhbm5lbH0gZnJvbSAnLi4vLi4vY2hhbm5lbCc7XG5pbXBvcnQge0RhdGVUaW1lLCBkYXRlVGltZUV4cHIsIGlzRGF0ZVRpbWV9IGZyb20gJy4uLy4uL2RhdGV0aW1lJztcbmltcG9ydCB7TGVnZW5kfSBmcm9tICcuLi8uLi9sZWdlbmQnO1xuaW1wb3J0IHtpc0JpblNjYWxlLCBTY2FsZVR5cGV9IGZyb20gJy4uLy4uL3NjYWxlJztcbmltcG9ydCB7VHlwZX0gZnJvbSAnLi4vLi4vdHlwZSc7XG5pbXBvcnQge2NvbnRhaW5zfSBmcm9tICcuLi8uLi91dGlsJztcblxuZXhwb3J0IGZ1bmN0aW9uIHZhbHVlcyhsZWdlbmQ6IExlZ2VuZCkge1xuICBjb25zdCB2YWxzID0gbGVnZW5kLnZhbHVlcztcbiAgaWYgKHZhbHMgJiYgaXNEYXRlVGltZSh2YWxzWzBdKSkge1xuICAgIHJldHVybiAodmFscyBhcyBEYXRlVGltZVtdKS5tYXAoKGR0KSA9PiB7XG4gICAgICAvLyBub3JtYWxpemUgPSB0cnVlIGFzIGVuZCB1c2VyIHdvbid0IHB1dCAwID0gSmFudWFyeVxuICAgICAgcmV0dXJuIHtzaWduYWw6IGRhdGVUaW1lRXhwcihkdCwgdHJ1ZSl9O1xuICAgIH0pO1xuICB9XG4gIHJldHVybiB2YWxzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdHlwZSh0OiBUeXBlLCBjaGFubmVsOiBDaGFubmVsLCBzY2FsZVR5cGU6IFNjYWxlVHlwZSk6ICdncmFkaWVudCcge1xuICBpZiAoXG4gICAgICBpc0NvbG9yQ2hhbm5lbChjaGFubmVsKSAmJiAoXG4gICAgICAgICh0ID09PSAncXVhbnRpdGF0aXZlJyAmJiAhaXNCaW5TY2FsZShzY2FsZVR5cGUpKSB8fFxuICAgICAgICAodCA9PT0gJ3RlbXBvcmFsJyAmJiBjb250YWluczxTY2FsZVR5cGU+KFsndGltZScsICd1dGMnXSwgc2NhbGVUeXBlKSlcbiAgICAgIClcbiAgICApIHtcbiAgICByZXR1cm4gJ2dyYWRpZW50JztcbiAgfVxuICByZXR1cm4gdW5kZWZpbmVkO1xufVxuIl19","import { COLOR, FILL, OPACITY, SHAPE, SIZE, STROKE } from '../../channel';\nimport { isFieldDef, title as fieldDefTitle } from '../../fielddef';\nimport { LEGEND_PROPERTIES, VG_LEGEND_PROPERTIES } from '../../legend';\nimport { GEOJSON } from '../../type';\nimport { deleteNestedProperty, keys } from '../../util';\nimport { getSpecifiedOrDefaultValue, guideEncodeEntry, mergeTitleComponent, numberFormat } from '../common';\nimport { isUnitModel } from '../model';\nimport { parseGuideResolve } from '../resolve';\nimport { defaultTieBreaker, makeImplicit, mergeValuesWithExplicit } from '../split';\nimport { LegendComponent } from './component';\nimport * as encode from './encode';\nimport * as properties from './properties';\nexport function parseLegend(model) {\n    if (isUnitModel(model)) {\n        model.component.legends = parseUnitLegend(model);\n    }\n    else {\n        model.component.legends = parseNonUnitLegend(model);\n    }\n}\nfunction parseUnitLegend(model) {\n    var encoding = model.encoding;\n    return [COLOR, FILL, STROKE, SIZE, SHAPE, OPACITY].reduce(function (legendComponent, channel) {\n        var def = encoding[channel];\n        if (model.legend(channel) && model.getScaleComponent(channel) && !(isFieldDef(def) && (channel === SHAPE && def.type === GEOJSON))) {\n            legendComponent[channel] = parseLegendForChannel(model, channel);\n        }\n        return legendComponent;\n    }, {});\n}\nfunction getLegendDefWithScale(model, channel) {\n    var _a;\n    // For binned field with continuous scale, use a special scale so we can overrride the mark props and labels\n    switch (channel) {\n        case COLOR:\n            var scale = model.scaleName(COLOR);\n            return model.markDef.filled ? { fill: scale } : { stroke: scale };\n        case FILL:\n        case STROKE:\n        case SIZE:\n        case SHAPE:\n        case OPACITY:\n            return _a = {}, _a[channel] = model.scaleName(channel), _a;\n    }\n}\nexport function parseLegendForChannel(model, channel) {\n    var fieldDef = model.fieldDef(channel);\n    var legend = model.legend(channel);\n    var legendCmpt = new LegendComponent({}, getLegendDefWithScale(model, channel));\n    LEGEND_PROPERTIES.forEach(function (property) {\n        var value = getProperty(property, legend, channel, model);\n        if (value !== undefined) {\n            var explicit = \n            // specified legend.values is already respected, but may get transformed.\n            property === 'values' ? !!legend.values :\n                // title can be explicit if fieldDef.title is set\n                property === 'title' && value === model.fieldDef(channel).title ? true :\n                    // Otherwise, things are explicit if the returned value matches the specified property\n                    value === legend[property];\n            if (explicit || model.config.legend[property] === undefined) {\n                legendCmpt.set(property, value, explicit);\n            }\n        }\n    });\n    // 2) Add mark property definition groups\n    var legendEncoding = legend.encoding || {};\n    var legendEncode = ['labels', 'legend', 'title', 'symbols', 'gradient'].reduce(function (e, part) {\n        var legendEncodingPart = guideEncodeEntry(legendEncoding[part] || {}, model);\n        var value = encode[part] ?\n            // TODO: replace legendCmpt with type is sufficient\n            encode[part](fieldDef, legendEncodingPart, model, channel, legendCmpt.get('type')) : // apply rule\n            legendEncodingPart; // no rule -- just default values\n        if (value !== undefined && keys(value).length > 0) {\n            e[part] = { update: value };\n        }\n        return e;\n    }, {});\n    if (keys(legendEncode).length > 0) {\n        legendCmpt.set('encode', legendEncode, !!legend.encoding);\n    }\n    return legendCmpt;\n}\nfunction getProperty(property, specifiedLegend, channel, model) {\n    var fieldDef = model.fieldDef(channel);\n    switch (property) {\n        case 'format':\n            // We don't include temporal field here as we apply format in encode block\n            return numberFormat(fieldDef, specifiedLegend.format, model.config);\n        case 'title':\n            // For falsy value, keep undefined so we use default,\n            // but use null for '', null, and false to hide the title\n            var specifiedTitle = fieldDef.title !== undefined ? fieldDef.title :\n                specifiedLegend.title || (specifiedLegend.title === undefined ? undefined : null);\n            return getSpecifiedOrDefaultValue(specifiedTitle, fieldDefTitle(fieldDef, model.config)) || undefined; // make falsy value undefined so output Vega spec is shorter\n        case 'values':\n            return properties.values(specifiedLegend);\n        case 'type':\n            return getSpecifiedOrDefaultValue(specifiedLegend.type, properties.type(fieldDef.type, channel, model.getScaleComponent(channel).get('type')));\n    }\n    // Otherwise, return specified property.\n    return specifiedLegend[property];\n}\nfunction parseNonUnitLegend(model) {\n    var _a = model.component, legends = _a.legends, resolve = _a.resolve;\n    var _loop_1 = function (child) {\n        parseLegend(child);\n        keys(child.component.legends).forEach(function (channel) {\n            resolve.legend[channel] = parseGuideResolve(model.component.resolve, channel);\n            if (resolve.legend[channel] === 'shared') {\n                // If the resolve says shared (and has not been overridden)\n                // We will try to merge and see if there is a conflict\n                legends[channel] = mergeLegendComponent(legends[channel], child.component.legends[channel]);\n                if (!legends[channel]) {\n                    // If merge returns nothing, there is a conflict so we cannot make the legend shared.\n                    // Thus, mark legend as independent and remove the legend component.\n                    resolve.legend[channel] = 'independent';\n                    delete legends[channel];\n                }\n            }\n        });\n    };\n    for (var _i = 0, _b = model.children; _i < _b.length; _i++) {\n        var child = _b[_i];\n        _loop_1(child);\n    }\n    keys(legends).forEach(function (channel) {\n        for (var _i = 0, _a = model.children; _i < _a.length; _i++) {\n            var child = _a[_i];\n            if (!child.component.legends[channel]) {\n                // skip if the child does not have a particular legend\n                continue;\n            }\n            if (resolve.legend[channel] === 'shared') {\n                // After merging shared legend, make sure to remove legend from child\n                delete child.component.legends[channel];\n            }\n        }\n    });\n    return legends;\n}\nexport function mergeLegendComponent(mergedLegend, childLegend) {\n    if (!mergedLegend) {\n        return childLegend.clone();\n    }\n    var mergedOrient = mergedLegend.getWithExplicit('orient');\n    var childOrient = childLegend.getWithExplicit('orient');\n    if (mergedOrient.explicit && childOrient.explicit && mergedOrient.value !== childOrient.value) {\n        // TODO: throw warning if resolve is explicit (We don't have info about explicit/implicit resolve yet.)\n        // Cannot merge due to inconsistent orient\n        return undefined;\n    }\n    var typeMerged = false;\n    var _loop_2 = function (prop) {\n        var mergedValueWithExplicit = mergeValuesWithExplicit(mergedLegend.getWithExplicit(prop), childLegend.getWithExplicit(prop), prop, 'legend', \n        // Tie breaker function\n        function (v1, v2) {\n            switch (prop) {\n                case 'title':\n                    return mergeTitleComponent(v1, v2);\n                case 'type':\n                    // There are only two types. If we have different types, then prefer symbol over gradient.\n                    typeMerged = true;\n                    return makeImplicit('symbol');\n            }\n            return defaultTieBreaker(v1, v2, prop, 'legend');\n        });\n        mergedLegend.setWithExplicit(prop, mergedValueWithExplicit);\n    };\n    // Otherwise, let's merge\n    for (var _i = 0, VG_LEGEND_PROPERTIES_1 = VG_LEGEND_PROPERTIES; _i < VG_LEGEND_PROPERTIES_1.length; _i++) {\n        var prop = VG_LEGEND_PROPERTIES_1[_i];\n        _loop_2(prop);\n    }\n    if (typeMerged) {\n        if (((mergedLegend.implicit || {}).encode || {}).gradient) {\n            deleteNestedProperty(mergedLegend.implicit, ['encode', 'gradient']);\n        }\n        if (((mergedLegend.explicit || {}).encode || {}).gradient) {\n            deleteNestedProperty(mergedLegend.explicit, ['encode', 'gradient']);\n        }\n    }\n    return mergedLegend;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyc2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9sZWdlbmQvcGFyc2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFDLEtBQUssRUFBRSxJQUFJLEVBQTJCLE9BQU8sRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUNqRyxPQUFPLEVBQUMsVUFBVSxFQUFFLEtBQUssSUFBSSxhQUFhLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUNsRSxPQUFPLEVBQVMsaUJBQWlCLEVBQUUsb0JBQW9CLEVBQUMsTUFBTSxjQUFjLENBQUM7QUFDN0UsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLFlBQVksQ0FBQztBQUNuQyxPQUFPLEVBQUMsb0JBQW9CLEVBQUUsSUFBSSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBRXRELE9BQU8sRUFBQywwQkFBMEIsRUFBRSxnQkFBZ0IsRUFBRSxtQkFBbUIsRUFBRSxZQUFZLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDMUcsT0FBTyxFQUFDLFdBQVcsRUFBUSxNQUFNLFVBQVUsQ0FBQztBQUM1QyxPQUFPLEVBQUMsaUJBQWlCLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDN0MsT0FBTyxFQUFDLGlCQUFpQixFQUFZLFlBQVksRUFBRSx1QkFBdUIsRUFBQyxNQUFNLFVBQVUsQ0FBQztBQUU1RixPQUFPLEVBQUMsZUFBZSxFQUF1QixNQUFNLGFBQWEsQ0FBQztBQUNsRSxPQUFPLEtBQUssTUFBTSxNQUFNLFVBQVUsQ0FBQztBQUNuQyxPQUFPLEtBQUssVUFBVSxNQUFNLGNBQWMsQ0FBQztBQUczQyxNQUFNLHNCQUFzQixLQUFZO0lBQ3RDLElBQUksV0FBVyxDQUFDLEtBQUssQ0FBQyxFQUFFO1FBQ3RCLEtBQUssQ0FBQyxTQUFTLENBQUMsT0FBTyxHQUFHLGVBQWUsQ0FBQyxLQUFLLENBQUMsQ0FBQztLQUNsRDtTQUFNO1FB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RUFBRSxDQUFDLENBQUM7Z0JBQ3JDLEtBQUssTUFBTTtvQkFDVCwwRkFBMEY7b0JBQzFGLFVBQVUsR0FBRyxJQUFJLENBQUM7b0JBQ2xCLE9BQU8sWUFBWSxDQUFDLFFBQVEsQ0FBQyxDQUFDO2FBQ2pDO1lBQ0QsT0FBTyxpQkFBaUIsQ0FBZ0IsRUFBRSxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDbEUsQ0FBQyxDQUNGLENBQUM7UUFDRixZQUFZLENBQUMsZUFBZSxDQUFDLElBQUksRUFBRSx1QkFBdUIsQ0FBQyxDQUFDO0lBQzlELENBQUM7SUFyQkQseUJBQXlCO0lBQ3pCLEtBQW1CLFVBQW9CLEVBQXBCLDZDQUFvQixFQUFwQixrQ0FBb0IsRUFBcEIsSUFBb0I7UUFBbEMsSUFBTSxJQUFJLDZCQUFBO2dCQUFKLElBQUk7S0FvQmQ7SUFDRCxJQUFJLFVBQVUsRUFBRTtRQUNkLElBQUcsQ0FBQyxDQUFDLFlBQVksQ0FBQyxRQUFRLElBQUksRUFBRSxDQUFDLENBQUMsTUFBTSxJQUFJLEVBQUUsQ0FBQyxDQUFDLFFBQVEsRUFBRTtZQUN4RCxvQkFBb0IsQ0FBQyxZQUFZLENBQUMsUUFBUSxFQUFFLENBQUMsUUFBUSxFQUFFLFVBQVUsQ0FBQyxDQUFDLENBQUM7U0FDckU7UUFDRCxJQUFJLENBQUMsQ0FBQyxZQUFZLENBQUMsUUFBUSxJQUFJLEVBQUUsQ0FBQyxDQUFDLE1BQU0sSUFBSSxFQUFFLENBQUMsQ0FBQyxRQUFRLEVBQUU7WUFDekQsb0JBQW9CLENBQUMsWUFBWSxDQUFDLFFBQVEsRUFBRSxDQUFDLFFBQVEsRUFBRSxVQUFVLENBQUMsQ0FBQyxDQUFDO1NBQ3JFO0tBQ0Y7SUFHRCxPQUFPLFlBQVksQ0FBQztBQUN0QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDT0xPUiwgRklMTCwgTm9uUG9zaXRpb25TY2FsZUNoYW5uZWwsIE9QQUNJVFksIFNIQVBFLCBTSVpFLCBTVFJPS0V9IGZyb20gJy4uLy4uL2NoYW5uZWwnO1xuaW1wb3J0IHtpc0ZpZWxkRGVmLCB0aXRsZSBhcyBmaWVsZERlZlRpdGxlfSBmcm9tICcuLi8uLi9maWVsZGRlZic7XG5pbXBvcnQge0xlZ2VuZCwgTEVHRU5EX1BST1BFUlRJRVMsIFZHX0xFR0VORF9QUk9QRVJUSUVTfSBmcm9tICcuLi8uLi9sZWdlbmQnO1xuaW1wb3J0IHtHRU9KU09OfSBmcm9tICcuLi8uLi90eXBlJztcbmltcG9ydCB7ZGVsZXRlTmVzdGVkUHJvcGVydHksIGtleXN9IGZyb20gJy4uLy4uL3V0aWwnO1xuaW1wb3J0IHtWZ0xlZ2VuZCwgVmdMZWdlbmRFbmNvZGV9IGZyb20gJy4uLy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7Z2V0U3BlY2lmaWVkT3JEZWZhdWx0VmFsdWUsIGd1aWRlRW5jb2RlRW50cnksIG1lcmdlVGl0bGVDb21wb25lbnQsIG51bWJlckZvcm1hdH0gZnJvbSAnLi4vY29tbW9uJztcbmltcG9ydCB7aXNVbml0TW9kZWwsIE1vZGVsfSBmcm9tICcuLi9tb2RlbCc7XG5pbXBvcnQge3BhcnNlR3VpZGVSZXNvbHZlfSBmcm9tICcuLi9yZXNvbHZlJztcbmltcG9ydCB7ZGVmYXVsdFRpZUJyZWFrZXIsIEV4cGxpY2l0LCBtYWtlSW1wbGljaXQsIG1lcmdlVmFsdWVzV2l0aEV4cGxpY2l0fSBmcm9tICcuLi9zcGxpdCc7XG5pbXBvcnQge1VuaXRNb2RlbH0gZnJvbSAnLi4vdW5pdCc7XG5pbXBvcnQge0xlZ2VuZENvbXBvbmVudCwgTGVnZW5kQ29tcG9uZW50SW5kZXh9IGZyb20gJy4vY29tcG9uZW50JztcbmltcG9ydCAqIGFzIGVuY29kZSBmcm9tICcuL2VuY29kZSc7XG5pbXBvcnQgKiBhcyBwcm9wZXJ0aWVzIGZyb20gJy4vcHJvcGVydGllcyc7XG5cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlTGVnZW5kKG1vZGVsOiBNb2RlbCkge1xuICBpZiAoaXNVbml0TW9kZWwobW9kZWwpKSB7XG4gICAgbW9kZWwuY29tcG9uZW50LmxlZ2VuZHMgPSBwYXJzZVVuaXRMZWdlbmQobW9kZWwpO1xuICB9IGVsc2Uge1xuICAgIG1vZGVsLmNvbXBvbmVudC5sZWdlbmRzID0gcGFyc2VOb25Vbml0TGVnZW5kKG1vZGVsKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBwYXJzZVVuaXRMZWdlbmQobW9kZWw6IFVuaXRNb2RlbCk6IExlZ2VuZENvbXBvbmVudEluZGV4IHtcbiAgY29uc3Qge2VuY29kaW5nfSA9IG1vZGVsO1xuICByZXR1cm4gW0NPTE9SLCBGSUxMLCBTVFJPS0UsIFNJWkUsIFNIQVBFLCBPUEFDSVRZXS5yZWR1Y2UoZnVuY3Rpb24gKGxlZ2VuZENvbXBvbmVudCwgY2hhbm5lbCkge1xuICAgIGNvbnN0IGRlZiA9IGVuY29kaW5nW2NoYW5uZWxdO1xuICAgIGlmIChtb2RlbC5sZWdlbmQoY2hhbm5lbCkgJiYgbW9kZWwuZ2V0U2NhbGVDb21wb25lbnQoY2hhbm5lbCkgJiYgIShpc0ZpZWxkRGVmKGRlZikgJiYgKGNoYW5uZWwgPT09IFNIQVBFICYmIGRlZi50eXBlID09PSBHRU9KU09OKSkpIHtcbiAgICAgIGxlZ2VuZENvbXBvbmVudFtjaGFubmVsXSA9IHBhcnNlTGVnZW5kRm9yQ2hhbm5lbChtb2RlbCwgY2hhbm5lbCk7XG4gICAgfVxuICAgIHJldHVybiBsZWdlbmRDb21wb25lbnQ7XG4gIH0sIHt9KTtcbn1cblxuZnVuY3Rpb24gZ2V0TGVnZW5kRGVmV2l0aFNjYWxlKG1vZGVsOiBVbml0TW9kZWwsIGNoYW5uZWw6IE5vblBvc2l0aW9uU2NhbGVDaGFubmVsKTogVmdMZWdlbmQge1xuICAvLyBGb3IgYmlubmVkIGZpZWxkIHdpdGggY29udGludW91cyBzY2FsZSwgdXNlIGEgc3BlY2lhbCBzY2FsZSBzbyB3ZSBjYW4gb3ZlcnJyaWRlIHRoZSBtYXJrIHByb3BzIGFuZCBsYWJlbHNcbiAgc3dpdGNoIChjaGFubmVsKSB7XG4gICAgY2FzZSBDT0xPUjpcbiAgICAgIGNvbnN0IHNjYWxlID0gbW9kZWwuc2NhbGVOYW1lKENPTE9SKTtcbiAgICAgIHJldHVybiBtb2RlbC5tYXJrRGVmLmZpbGxlZCA/IHtmaWxsOiBzY2FsZX0gOiB7c3Ryb2tlOiBzY2FsZX07XG4gICAgY2FzZSBGSUxMOlxuICAgIGNhc2UgU1RST0tFOlxuICAgIGNhc2UgU0laRTpcbiAgICBjYXNlIFNIQVBFOlxuICAgIGNhc2UgT1BBQ0lUWTpcbiAgICAgIHJldHVybiB7W2NoYW5uZWxdOiBtb2RlbC5zY2FsZU5hbWUoY2hhbm5lbCl9O1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUxlZ2VuZEZvckNoYW5uZWwobW9kZWw6IFVuaXRNb2RlbCwgY2hhbm5lbDogTm9uUG9zaXRpb25TY2FsZUNoYW5uZWwpOiBMZWdlbmRDb21wb25lbnQge1xuICBjb25zdCBmaWVsZERlZiA9IG1vZGVsLmZpZWxkRGVmKGNoYW5uZWwpO1xuICBjb25zdCBsZWdlbmQgPSBtb2RlbC5sZWdlbmQoY2hhbm5lbCk7XG5cbiAgY29uc3QgbGVnZW5kQ21wdCA9IG5ldyBMZWdlbmRDb21wb25lbnQoe30sIGdldExlZ2VuZERlZldpdGhTY2FsZShtb2RlbCwgY2hhbm5lbCkpO1xuXG4gIExFR0VORF9QUk9QRVJUSUVTLmZvckVhY2goZnVuY3Rpb24ocHJvcGVydHkpIHtcbiAgICBjb25zdCB2YWx1ZSA9IGdldFByb3BlcnR5KHByb3BlcnR5LCBsZWdlbmQsIGNoYW5uZWwsIG1vZGVsKTtcbiAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgY29uc3QgZXhwbGljaXQgPVxuICAgICAgICAvLyBzcGVjaWZpZWQgbGVnZW5kLnZhbHVlcyBpcyBhbHJlYWR5IHJlc3BlY3RlZCwgYnV0IG1heSBnZXQgdHJhbnNmb3JtZWQuXG4gICAgICAgIHByb3BlcnR5ID09PSAndmFsdWVzJyA/ICEhbGVnZW5kLnZhbHVlcyA6XG4gICAgICAgIC8vIHRpdGxlIGNhbiBiZSBleHBsaWNpdCBpZiBmaWVsZERlZi50aXRsZSBpcyBzZXRcbiAgICAgICAgcHJvcGVydHkgPT09ICd0aXRsZScgJiYgdmFsdWUgPT09IG1vZGVsLmZpZWxkRGVmKGNoYW5uZWwpLnRpdGxlID8gdHJ1ZSA6XG4gICAgICAgIC8vIE90aGVyd2lzZSwgdGhpbmdzIGFyZSBleHBsaWNpdCBpZiB0aGUgcmV0dXJuZWQgdmFsdWUgbWF0Y2hlcyB0aGUgc3BlY2lmaWVkIHByb3BlcnR5XG4gICAgICAgIHZhbHVlID09PSBsZWdlbmRbcHJvcGVydHldO1xuICAgICAgaWYgKGV4cGxpY2l0IHx8IG1vZGVsLmNvbmZpZy5sZWdlbmRbcHJvcGVydHldID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgbGVnZW5kQ21wdC5zZXQocHJvcGVydHksIHZhbHVlLCBleHBsaWNpdCk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICAvLyAyKSBBZGQgbWFyayBwcm9wZXJ0eSBkZWZpbml0aW9uIGdyb3Vwc1xuICBjb25zdCBsZWdlbmRFbmNvZGluZyA9IGxlZ2VuZC5lbmNvZGluZyB8fCB7fTtcbiAgY29uc3QgbGVnZW5kRW5jb2RlID0gWydsYWJlbHMnLCAnbGVnZW5kJywgJ3RpdGxlJywgJ3N5bWJvbHMnLCAnZ3JhZGllbnQnXS5yZWR1Y2UoKGU6IFZnTGVnZW5kRW5jb2RlLCBwYXJ0KSA9PiB7XG4gICAgY29uc3QgbGVnZW5kRW5jb2RpbmdQYXJ0ID0gZ3VpZGVFbmNvZGVFbnRyeShsZWdlbmRFbmNvZGluZ1twYXJ0XSB8fCB7fSwgbW9kZWwpO1xuICAgIGNvbnN0IHZhbHVlID0gZW5jb2RlW3BhcnRdID9cbiAgICAgIC8vIFRPRE86IHJlcGxhY2UgbGVnZW5kQ21wdCB3aXRoIHR5cGUgaXMgc3VmZmljaWVudFxuICAgICAgZW5jb2RlW3BhcnRdKGZpZWxkRGVmLCBsZWdlbmRFbmNvZGluZ1BhcnQsIG1vZGVsLCBjaGFubmVsLCBsZWdlbmRDbXB0LmdldCgndHlwZScpKSA6IC8vIGFwcGx5IHJ1bGVcbiAgICAgIGxlZ2VuZEVuY29kaW5nUGFydDsgLy8gbm8gcnVsZSAtLSBqdXN0IGRlZmF1bHQgdmFsdWVzXG4gICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYga2V5cyh2YWx1ZSkubGVuZ3RoID4gMCkge1xuICAgICAgZVtwYXJ0XSA9IHt1cGRhdGU6IHZhbHVlfTtcbiAgICB9XG4gICAgcmV0dXJuIGU7XG4gIH0sIHt9IGFzIFZnTGVnZW5kRW5jb2RlKTtcblxuICBpZiAoa2V5cyhsZWdlbmRFbmNvZGUpLmxlbmd0aCA+IDApIHtcbiAgICBsZWdlbmRDbXB0LnNldCgnZW5jb2RlJywgbGVnZW5kRW5jb2RlLCAhIWxlZ2VuZC5lbmNvZGluZyk7XG4gIH1cblxuICByZXR1cm4gbGVnZW5kQ21wdDtcbn1cblxuZnVuY3Rpb24gZ2V0UHJvcGVydHkocHJvcGVydHk6IGtleW9mIChMZWdlbmQgfCBWZ0xlZ2VuZCksIHNwZWNpZmllZExlZ2VuZDogTGVnZW5kLCBjaGFubmVsOiBOb25Qb3NpdGlvblNjYWxlQ2hhbm5lbCwgbW9kZWw6IFVuaXRNb2RlbCkge1xuICBjb25zdCBmaWVsZERlZiA9IG1vZGVsLmZpZWxkRGVmKGNoYW5uZWwpO1xuXG4gIHN3aXRjaCAocHJvcGVydHkpIHtcbiAgICBjYXNlICdmb3JtYXQnOlxuICAgICAgLy8gV2UgZG9uJ3QgaW5jbHVkZSB0ZW1wb3JhbCBmaWVsZCBoZXJlIGFzIHdlIGFwcGx5IGZvcm1hdCBpbiBlbmNvZGUgYmxvY2tcbiAgICAgIHJldHVybiBudW1iZXJGb3JtYXQoZmllbGREZWYsIHNwZWNpZmllZExlZ2VuZC5mb3JtYXQsIG1vZGVsLmNvbmZpZyk7XG4gICAgY2FzZSAndGl0bGUnOlxuICAgICAgLy8gRm9yIGZhbHN5IHZhbHVlLCBrZWVwIHVuZGVmaW5lZCBzbyB3ZSB1c2UgZGVmYXVsdCxcbiAgICAgIC8vIGJ1dCB1c2UgbnVsbCBmb3IgJycsIG51bGwsIGFuZCBmYWxzZSB0byBoaWRlIHRoZSB0aXRsZVxuICAgICAgY29uc3Qgc3BlY2lmaWVkVGl0bGUgPSBmaWVsZERlZi50aXRsZSAhPT0gdW5kZWZpbmVkID8gZmllbGREZWYudGl0bGUgOlxuICAgICAgICBzcGVjaWZpZWRMZWdlbmQudGl0bGUgfHwgKHNwZWNpZmllZExlZ2VuZC50aXRsZSA9PT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogbnVsbCk7XG5cbiAgICAgIHJldHVybiBnZXRTcGVjaWZpZWRPckRlZmF1bHRWYWx1ZShcbiAgICAgICAgc3BlY2lmaWVkVGl0bGUsXG4gICAgICAgIGZpZWxkRGVmVGl0bGUoZmllbGREZWYsIG1vZGVsLmNvbmZpZylcbiAgICAgICkgfHwgdW5kZWZpbmVkOyAvLyBtYWtlIGZhbHN5IHZhbHVlIHVuZGVmaW5lZCBzbyBvdXRwdXQgVmVnYSBzcGVjIGlzIHNob3J0ZXJcbiAgICBjYXNlICd2YWx1ZXMnOlxuICAgICAgcmV0dXJuIHByb3BlcnRpZXMudmFsdWVzKHNwZWNpZmllZExlZ2VuZCk7XG4gICAgY2FzZSAndHlwZSc6XG4gICAgICByZXR1cm4gZ2V0U3BlY2lmaWVkT3JEZWZhdWx0VmFsdWUoc3BlY2lmaWVkTGVnZW5kLnR5cGUsIHByb3BlcnRpZXMudHlwZShmaWVsZERlZi50eXBlLCBjaGFubmVsLCBtb2RlbC5nZXRTY2FsZUNvbXBvbmVudChjaGFubmVsKS5nZXQoJ3R5cGUnKSkpO1xuICB9XG5cbiAgLy8gT3RoZXJ3aXNlLCByZXR1cm4gc3BlY2lmaWVkIHByb3BlcnR5LlxuICByZXR1cm4gc3BlY2lmaWVkTGVnZW5kW3Byb3BlcnR5XTtcbn1cblxuZnVuY3Rpb24gcGFyc2VOb25Vbml0TGVnZW5kKG1vZGVsOiBNb2RlbCkge1xuICBjb25zdCB7bGVnZW5kcywgcmVzb2x2ZX0gPSBtb2RlbC5jb21wb25lbnQ7XG5cbiAgZm9yIChjb25zdCBjaGlsZCBvZiBtb2RlbC5jaGlsZHJlbikge1xuICAgIHBhcnNlTGVnZW5kKGNoaWxkKTtcblxuICAgIGtleXMoY2hpbGQuY29tcG9uZW50LmxlZ2VuZHMpLmZvckVhY2goKGNoYW5uZWw6IE5vblBvc2l0aW9uU2NhbGVDaGFubmVsKSA9PiB7XG4gICAgICByZXNvbHZlLmxlZ2VuZFtjaGFubmVsXSA9IHBhcnNlR3VpZGVSZXNvbHZlKG1vZGVsLmNvbXBvbmVudC5yZXNvbHZlLCBjaGFubmVsKTtcblxuICAgICAgaWYgKHJlc29sdmUubGVnZW5kW2NoYW5uZWxdID09PSAnc2hhcmVkJykge1xuICAgICAgICAvLyBJZiB0aGUgcmVzb2x2ZSBzYXlzIHNoYXJlZCAoYW5kIGhhcyBub3QgYmVlbiBvdmVycmlkZGVuKVxuICAgICAgICAvLyBXZSB3aWxsIHRyeSB0byBtZXJnZSBhbmQgc2VlIGlmIHRoZXJlIGlzIGEgY29uZmxpY3RcblxuICAgICAgICBsZWdlbmRzW2NoYW5uZWxdID0gbWVyZ2VMZWdlbmRDb21wb25lbnQobGVnZW5kc1tjaGFubmVsXSwgY2hpbGQuY29tcG9uZW50LmxlZ2VuZHNbY2hhbm5lbF0pO1xuXG4gICAgICAgIGlmICghbGVnZW5kc1tjaGFubmVsXSkge1xuICAgICAgICAgIC8vIElmIG1lcmdlIHJldHVybnMgbm90aGluZywgdGhlcmUgaXMgYSBjb25mbGljdCBzbyB3ZSBjYW5ub3QgbWFrZSB0aGUgbGVnZW5kIHNoYXJlZC5cbiAgICAgICAgICAvLyBUaHVzLCBtYXJrIGxlZ2VuZCBhcyBpbmRlcGVuZGVudCBhbmQgcmVtb3ZlIHRoZSBsZWdlbmQgY29tcG9uZW50LlxuICAgICAgICAgIHJlc29sdmUubGVnZW5kW2NoYW5uZWxdID0gJ2luZGVwZW5kZW50JztcbiAgICAgICAgICBkZWxldGUgbGVnZW5kc1tjaGFubmVsXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAga2V5cyhsZWdlbmRzKS5mb3JFYWNoKChjaGFubmVsOiBOb25Qb3NpdGlvblNjYWxlQ2hhbm5lbCkgPT4ge1xuICAgIGZvciAoY29uc3QgY2hpbGQgb2YgbW9kZWwuY2hpbGRyZW4pIHtcbiAgICAgIGlmICghY2hpbGQuY29tcG9uZW50LmxlZ2VuZHNbY2hhbm5lbF0pIHtcbiAgICAgICAgLy8gc2tpcCBpZiB0aGUgY2hpbGQgZG9lcyBub3QgaGF2ZSBhIHBhcnRpY3VsYXIgbGVnZW5kXG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAocmVzb2x2ZS5sZWdlbmRbY2hhbm5lbF0gPT09ICdzaGFyZWQnKSB7XG4gICAgICAgIC8vIEFmdGVyIG1lcmdpbmcgc2hhcmVkIGxlZ2VuZCwgbWFrZSBzdXJlIHRvIHJlbW92ZSBsZWdlbmQgZnJvbSBjaGlsZFxuICAgICAgICBkZWxldGUgY2hpbGQuY29tcG9uZW50LmxlZ2VuZHNbY2hhbm5lbF07XG4gICAgICB9XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIGxlZ2VuZHM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtZXJnZUxlZ2VuZENvbXBvbmVudChtZXJnZWRMZWdlbmQ6IExlZ2VuZENvbXBvbmVudCwgY2hpbGRMZWdlbmQ6IExlZ2VuZENvbXBvbmVudCk6IExlZ2VuZENvbXBvbmVudCB7XG4gIGlmICghbWVyZ2VkTGVnZW5kKSB7XG4gICAgcmV0dXJuIGNoaWxkTGVnZW5kLmNsb25lKCk7XG4gIH1cbiAgY29uc3QgbWVyZ2VkT3JpZW50ID0gbWVyZ2VkTGVnZW5kLmdldFdpdGhFeHBsaWNpdCgnb3JpZW50Jyk7XG4gIGNvbnN0IGNoaWxkT3JpZW50ID0gY2hpbGRMZWdlbmQuZ2V0V2l0aEV4cGxpY2l0KCdvcmllbnQnKTtcblxuXG4gIGlmIChtZXJnZWRPcmllbnQuZXhwbGljaXQgJiYgY2hpbGRPcmllbnQuZXhwbGljaXQgJiYgbWVyZ2VkT3JpZW50LnZhbHVlICE9PSBjaGlsZE9yaWVudC52YWx1ZSkge1xuICAgIC8vIFRPRE86IHRocm93IHdhcm5pbmcgaWYgcmVzb2x2ZSBpcyBleHBsaWNpdCAoV2UgZG9uJ3QgaGF2ZSBpbmZvIGFib3V0IGV4cGxpY2l0L2ltcGxpY2l0IHJlc29sdmUgeWV0LilcbiAgICAvLyBDYW5ub3QgbWVyZ2UgZHVlIHRvIGluY29uc2lzdGVudCBvcmllbnRcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG4gIGxldCB0eXBlTWVyZ2VkID0gZmFsc2U7XG4gIC8vIE90aGVyd2lzZSwgbGV0J3MgbWVyZ2VcbiAgZm9yIChjb25zdCBwcm9wIG9mIFZHX0xFR0VORF9QUk9QRVJUSUVTKSB7XG4gICAgY29uc3QgbWVyZ2VkVmFsdWVXaXRoRXhwbGljaXQgPSBtZXJnZVZhbHVlc1dpdGhFeHBsaWNpdDxWZ0xlZ2VuZCwgYW55PihcbiAgICAgIG1lcmdlZExlZ2VuZC5nZXRXaXRoRXhwbGljaXQocHJvcCksXG4gICAgICBjaGlsZExlZ2VuZC5nZXRXaXRoRXhwbGljaXQocHJvcCksXG4gICAgICBwcm9wLCAnbGVnZW5kJyxcblxuICAgICAgLy8gVGllIGJyZWFrZXIgZnVuY3Rpb25cbiAgICAgICh2MTogRXhwbGljaXQ8YW55PiwgdjI6IEV4cGxpY2l0PGFueT4pOiBhbnkgPT4ge1xuICAgICAgICBzd2l0Y2ggKHByb3ApIHtcbiAgICAgICAgICBjYXNlICd0aXRsZSc6XG4gICAgICAgICAgICByZXR1cm4gbWVyZ2VUaXRsZUNvbXBvbmVudCh2MSwgdjIpO1xuICAgICAgICAgIGNhc2UgJ3R5cGUnOlxuICAgICAgICAgICAgLy8gVGhlcmUgYXJlIG9ubHkgdHdvIHR5cGVzLiBJZiB3ZSBoYXZlIGRpZmZlcmVudCB0eXBlcywgdGhlbiBwcmVmZXIgc3ltYm9sIG92ZXIgZ3JhZGllbnQuXG4gICAgICAgICAgICB0eXBlTWVyZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiBtYWtlSW1wbGljaXQoJ3N5bWJvbCcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZWZhdWx0VGllQnJlYWtlcjxWZ0xlZ2VuZCwgYW55Pih2MSwgdjIsIHByb3AsICdsZWdlbmQnKTtcbiAgICAgIH1cbiAgICApO1xuICAgIG1lcmdlZExlZ2VuZC5zZXRXaXRoRXhwbGljaXQocHJvcCwgbWVyZ2VkVmFsdWVXaXRoRXhwbGljaXQpO1xuICB9XG4gIGlmICh0eXBlTWVyZ2VkKSB7XG4gICAgaWYoKChtZXJnZWRMZWdlbmQuaW1wbGljaXQgfHwge30pLmVuY29kZSB8fCB7fSkuZ3JhZGllbnQpIHtcbiAgICAgIGRlbGV0ZU5lc3RlZFByb3BlcnR5KG1lcmdlZExlZ2VuZC5pbXBsaWNpdCwgWydlbmNvZGUnLCAnZ3JhZGllbnQnXSk7XG4gICAgfVxuICAgIGlmICgoKG1lcmdlZExlZ2VuZC5leHBsaWNpdCB8fCB7fSkuZW5jb2RlIHx8IHt9KS5ncmFkaWVudCkge1xuICAgICAgZGVsZXRlTmVzdGVkUHJvcGVydHkobWVyZ2VkTGVnZW5kLmV4cGxpY2l0LCBbJ2VuY29kZScsICdncmFkaWVudCddKTtcbiAgICB9XG4gIH1cblxuXG4gIHJldHVybiBtZXJnZWRMZWdlbmQ7XG59XG5cbiJdfQ==","import { flatten, keys, stringify, vals } from '../../util';\nimport { mergeLegendComponent } from './parse';\nexport function assembleLegends(model) {\n    var legendComponentIndex = model.component.legends;\n    var legendByDomain = {};\n    for (var _i = 0, _a = keys(legendComponentIndex); _i < _a.length; _i++) {\n        var channel = _a[_i];\n        var scaleComponent = model.getScaleComponent(channel);\n        var domainHash = stringify(scaleComponent.domains);\n        if (legendByDomain[domainHash]) {\n            for (var _b = 0, _c = legendByDomain[domainHash]; _b < _c.length; _b++) {\n                var mergedLegendComponent = _c[_b];\n                var merged = mergeLegendComponent(mergedLegendComponent, legendComponentIndex[channel]);\n                if (!merged) {\n                    // If cannot merge, need to add this legend separately\n                    legendByDomain[domainHash].push(legendComponentIndex[channel]);\n                }\n            }\n        }\n        else {\n            legendByDomain[domainHash] = [legendComponentIndex[channel].clone()];\n        }\n    }\n    return flatten(vals(legendByDomain)).map(function (legendCmpt) { return legendCmpt.combine(); });\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXNzZW1ibGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9sZWdlbmQvYXNzZW1ibGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBQyxNQUFNLFlBQVksQ0FBQztBQUkxRCxPQUFPLEVBQUMsb0JBQW9CLEVBQUMsTUFBTSxTQUFTLENBQUM7QUFFN0MsTUFBTSwwQkFBMEIsS0FBWTtJQUMxQyxJQUFNLG9CQUFvQixHQUFHLEtBQUssQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDO0lBQ3JELElBQU0sY0FBYyxHQUE4QyxFQUFFLENBQUM7SUFFckUsS0FBc0IsVUFBMEIsRUFBMUIsS0FBQSxJQUFJLENBQUMsb0JBQW9CLENBQUMsRUFBMUIsY0FBMEIsRUFBMUIsSUFBMEIsRUFBRTtRQUE3QyxJQUFNLE9BQU8sU0FBQTtRQUNoQixJQUFNLGNBQWMsR0FBRyxLQUFLLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDeEQsSUFBTSxVQUFVLEdBQUcsU0FBUyxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNyRCxJQUFJLGNBQWMsQ0FBQyxVQUFVLENBQUMsRUFBRTtZQUM5QixLQUFvQyxVQUEwQixFQUExQixLQUFBLGNBQWMsQ0FBQyxVQUFVLENBQUMsRUFBMUIsY0FBMEIsRUFBMUIsSUFBMEIsRUFBRTtnQkFBM0QsSUFBTSxxQkFBcUIsU0FBQTtnQkFDOUIsSUFBTSxNQUFNLEdBQUcsb0JBQW9CLENBQUMscUJBQXFCLEVBQUUsb0JBQW9CLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztnQkFDMUYsSUFBSSxDQUFDLE1BQU0sRUFBRTtvQkFDWCxzREFBc0Q7b0JBQ3RELGNBQWMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztpQkFDaEU7YUFDRjtTQUVGO2FBQU07WUFDTCxjQUFjLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxvQkFBb0IsQ0FBQyxPQUFPLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDO1NBQ3RFO0tBQ0Y7SUFFRCxPQUFPLE9BQU8sQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBQyxVQUEyQixJQUFLLE9BQUEsVUFBVSxDQUFDLE9BQU8sRUFBRSxFQUFwQixDQUFvQixDQUFDLENBQUM7QUFDbEcsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7ZmxhdHRlbiwga2V5cywgc3RyaW5naWZ5LCB2YWxzfSBmcm9tICcuLi8uLi91dGlsJztcbmltcG9ydCB7VmdMZWdlbmR9IGZyb20gJy4uLy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7TW9kZWx9IGZyb20gJy4uL21vZGVsJztcbmltcG9ydCB7TGVnZW5kQ29tcG9uZW50fSBmcm9tICcuL2NvbXBvbmVudCc7XG5pbXBvcnQge21lcmdlTGVnZW5kQ29tcG9uZW50fSBmcm9tICcuL3BhcnNlJztcblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VtYmxlTGVnZW5kcyhtb2RlbDogTW9kZWwpOiBWZ0xlZ2VuZFtdIHtcbiAgY29uc3QgbGVnZW5kQ29tcG9uZW50SW5kZXggPSBtb2RlbC5jb21wb25lbnQubGVnZW5kcztcbiAgY29uc3QgbGVnZW5kQnlEb21haW46IHtbZG9tYWluSGFzaDogc3RyaW5nXTogTGVnZW5kQ29tcG9uZW50W119ID0ge307XG5cbiAgZm9yIChjb25zdCBjaGFubmVsIG9mIGtleXMobGVnZW5kQ29tcG9uZW50SW5kZXgpKSB7XG4gICAgY29uc3Qgc2NhbGVDb21wb25lbnQgPSBtb2RlbC5nZXRTY2FsZUNvbXBvbmVudChjaGFubmVsKTtcbiAgICBjb25zdCBkb21haW5IYXNoID0gc3RyaW5naWZ5KHNjYWxlQ29tcG9uZW50LmRvbWFpbnMpO1xuICAgIGlmIChsZWdlbmRCeURvbWFpbltkb21haW5IYXNoXSkge1xuICAgICAgZm9yIChjb25zdCBtZXJnZWRMZWdlbmRDb21wb25lbnQgb2YgbGVnZW5kQnlEb21haW5bZG9tYWluSGFzaF0pIHtcbiAgICAgICAgY29uc3QgbWVyZ2VkID0gbWVyZ2VMZWdlbmRDb21wb25lbnQobWVyZ2VkTGVnZW5kQ29tcG9uZW50LCBsZWdlbmRDb21wb25lbnRJbmRleFtjaGFubmVsXSk7XG4gICAgICAgIGlmICghbWVyZ2VkKSB7XG4gICAgICAgICAgLy8gSWYgY2Fubm90IG1lcmdlLCBuZWVkIHRvIGFkZCB0aGlzIGxlZ2VuZCBzZXBhcmF0ZWx5XG4gICAgICAgICAgbGVnZW5kQnlEb21haW5bZG9tYWluSGFzaF0ucHVzaChsZWdlbmRDb21wb25lbnRJbmRleFtjaGFubmVsXSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgIH0gZWxzZSB7XG4gICAgICBsZWdlbmRCeURvbWFpbltkb21haW5IYXNoXSA9IFtsZWdlbmRDb21wb25lbnRJbmRleFtjaGFubmVsXS5jbG9uZSgpXTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZmxhdHRlbih2YWxzKGxlZ2VuZEJ5RG9tYWluKSkubWFwKChsZWdlbmRDbXB0OiBMZWdlbmRDb21wb25lbnQpID0+IGxlZ2VuZENtcHQuY29tYmluZSgpKTtcbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { contains } from '../../util';\nimport { isVgSignalRef } from '../../vega.schema';\nimport { isConcatModel, isLayerModel, isRepeatModel } from '../model';\nexport function assembleProjections(model) {\n    if (isLayerModel(model) || isConcatModel(model) || isRepeatModel(model)) {\n        return assembleProjectionsForModelAndChildren(model);\n    }\n    else {\n        return assembleProjectionForModel(model);\n    }\n}\nexport function assembleProjectionsForModelAndChildren(model) {\n    return model.children.reduce(function (projections, child) {\n        return projections.concat(child.assembleProjections());\n    }, assembleProjectionForModel(model));\n}\nexport function assembleProjectionForModel(model) {\n    var component = model.component.projection;\n    if (!component || component.merged) {\n        return [];\n    }\n    var projection = component.combine();\n    var name = projection.name, rest = tslib_1.__rest(projection, [\"name\"]); // we need to extract name so that it is always present in the output and pass TS type validation\n    var size = {\n        signal: \"[\" + component.size.map(function (ref) { return ref.signal; }).join(', ') + \"]\"\n    };\n    var fit = component.data.reduce(function (sources, data) {\n        var source = isVgSignalRef(data) ? data.signal : \"data('\" + model.lookupDataSource(data) + \"')\";\n        if (!contains(sources, source)) {\n            // build a unique list of sources\n            sources.push(source);\n        }\n        return sources;\n    }, []);\n    if (fit.length <= 0) {\n        throw new Error(\"Projection's fit didn't find any data sources\");\n    }\n    return [tslib_1.__assign({ name: name,\n            size: size, fit: {\n                signal: fit.length > 1 ? \"[\" + fit.join(', ') + \"]\" : fit[0]\n            } }, rest)];\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXNzZW1ibGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9wcm9qZWN0aW9uL2Fzc2VtYmxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUMsUUFBUSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQ3BDLE9BQU8sRUFBQyxhQUFhLEVBQTRCLE1BQU0sbUJBQW1CLENBQUM7QUFDM0UsT0FBTyxFQUFDLGFBQWEsRUFBRSxZQUFZLEVBQUUsYUFBYSxFQUFRLE1BQU0sVUFBVSxDQUFDO0FBRTNFLE1BQU0sOEJBQThCLEtBQVk7SUFDOUMsSUFBSSxZQUFZLENBQUMsS0FBSyxDQUFDLElBQUksYUFBYSxDQUFDLEtBQUssQ0FBQyxJQUFJLGFBQWEsQ0FBQyxLQUFLLENBQUMsRUFBRTtRQUN2RSxPQUFPLHNDQUFzQyxDQUFDLEtBQUssQ0FBQyxDQUFDO0tBQ3REO1NBQU07UUFDTCxPQUFPLDBCQUEwQixDQUFDLEtBQUssQ0FBQyxDQUFDO0tBQzFDO0FBQ0gsQ0FBQztBQUVELE1BQU0saURBQWlELEtBQVk7SUFDakUsT0FBTyxLQUFLLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxVQUFDLFdBQVcsRUFBRSxLQUFLO1FBQzlDLE9BQU8sV0FBVyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsbUJBQW1CLEVBQUUsQ0FBQyxDQUFDO0lBQ3pELENBQUMsRUFBRSwwQkFBMEIsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO0FBQ3hDLENBQUM7QUFFRCxNQUFNLHFDQUFxQyxLQUFZO0lBQ3JELElBQU0sU0FBUyxHQUFHLEtBQUssQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDO0lBQzdDLElBQUksQ0FBQyxTQUFTLElBQUksU0FBUyxDQUFDLE1BQU0sRUFBRTtRQUNsQyxPQUFPLEVBQUUsQ0FBQztLQUNYO0lBRUQsSUFBTSxVQUFVLEdBQUcsU0FBUyxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQ2hDLElBQUEsc0JBQUksRUFBRSwyQ0FBTyxDQUFlLENBQUUsaUdBQWlHO0lBRXRJLElBQU0sSUFBSSxHQUFnQjtRQUN4QixNQUFNLEVBQUUsTUFBSSxTQUFTLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxVQUFDLEdBQUcsSUFBSyxPQUFBLEdBQUcsQ0FBQyxNQUFNLEVBQVYsQ0FBVSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFHO0tBQ2xFLENBQUM7SUFFRixJQUFNLEdBQUcsR0FBYSxTQUFTLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFDLE9BQU8sRUFBRSxJQUFJO1FBQ3hELElBQU0sTUFBTSxHQUFXLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsV0FBUyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLE9BQUksQ0FBQztRQUNyRyxJQUFJLENBQUMsUUFBUSxDQUFDLE9BQU8sRUFBRSxNQUFNLENBQUMsRUFBRTtZQUM5QixpQ0FBaUM7WUFDakMsT0FBTyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztTQUN0QjtRQUNELE9BQU8sT0FBTyxDQUFDO0lBQ2pCLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUVQLElBQUksR0FBRyxDQUFDLE1BQU0sSUFBSSxDQUFDLEVBQUU7UUFDbkIsTUFBTSxJQUFJLEtBQUssQ0FBQywrQ0FBK0MsQ0FBQyxDQUFDO0tBQ2xFO0lBRUQsT0FBTyxvQkFDTCxJQUFJLE1BQUE7WUFDSixJQUFJLE1BQUEsRUFDSixHQUFHLEVBQUU7Z0JBQ0gsTUFBTSxFQUFFLEdBQUcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFJLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQzthQUN4RCxJQUNFLElBQUksRUFDUCxDQUFDO0FBQ0wsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Y29udGFpbnN9IGZyb20gJy4uLy4uL3V0aWwnO1xuaW1wb3J0IHtpc1ZnU2lnbmFsUmVmLCBWZ1Byb2plY3Rpb24sIFZnU2lnbmFsUmVmfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge2lzQ29uY2F0TW9kZWwsIGlzTGF5ZXJNb2RlbCwgaXNSZXBlYXRNb2RlbCwgTW9kZWx9IGZyb20gJy4uL21vZGVsJztcblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VtYmxlUHJvamVjdGlvbnMobW9kZWw6IE1vZGVsKTogVmdQcm9qZWN0aW9uW10ge1xuICBpZiAoaXNMYXllck1vZGVsKG1vZGVsKSB8fCBpc0NvbmNhdE1vZGVsKG1vZGVsKSB8fCBpc1JlcGVhdE1vZGVsKG1vZGVsKSkge1xuICAgIHJldHVybiBhc3NlbWJsZVByb2plY3Rpb25zRm9yTW9kZWxBbmRDaGlsZHJlbihtb2RlbCk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGFzc2VtYmxlUHJvamVjdGlvbkZvck1vZGVsKG1vZGVsKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gYXNzZW1ibGVQcm9qZWN0aW9uc0Zvck1vZGVsQW5kQ2hpbGRyZW4obW9kZWw6IE1vZGVsKTogVmdQcm9qZWN0aW9uW10ge1xuICByZXR1cm4gbW9kZWwuY2hpbGRyZW4ucmVkdWNlKChwcm9qZWN0aW9ucywgY2hpbGQpID0+IHtcbiAgICByZXR1cm4gcHJvamVjdGlvbnMuY29uY2F0KGNoaWxkLmFzc2VtYmxlUHJvamVjdGlvbnMoKSk7XG4gIH0sIGFzc2VtYmxlUHJvamVjdGlvbkZvck1vZGVsKG1vZGVsKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhc3NlbWJsZVByb2plY3Rpb25Gb3JNb2RlbChtb2RlbDogTW9kZWwpOiBWZ1Byb2plY3Rpb25bXSB7XG4gIGNvbnN0IGNvbXBvbmVudCA9IG1vZGVsLmNvbXBvbmVudC5wcm9qZWN0aW9uO1xuICBpZiAoIWNvbXBvbmVudCB8fCBjb21wb25lbnQubWVyZ2VkKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG5cbiAgY29uc3QgcHJvamVjdGlvbiA9IGNvbXBvbmVudC5jb21iaW5lKCk7XG4gIGNvbnN0IHtuYW1lLCAuLi5yZXN0fSA9IHByb2plY3Rpb247ICAvLyB3ZSBuZWVkIHRvIGV4dHJhY3QgbmFtZSBzbyB0aGF0IGl0IGlzIGFsd2F5cyBwcmVzZW50IGluIHRoZSBvdXRwdXQgYW5kIHBhc3MgVFMgdHlwZSB2YWxpZGF0aW9uXG5cbiAgY29uc3Qgc2l6ZTogVmdTaWduYWxSZWYgPSB7XG4gICAgc2lnbmFsOiBgWyR7Y29tcG9uZW50LnNpemUubWFwKChyZWYpID0+IHJlZi5zaWduYWwpLmpvaW4oJywgJyl9XWBcbiAgfTtcblxuICBjb25zdCBmaXQ6IHN0cmluZ1tdID0gY29tcG9uZW50LmRhdGEucmVkdWNlKChzb3VyY2VzLCBkYXRhKSA9PiB7XG4gICAgY29uc3Qgc291cmNlOiBzdHJpbmcgPSBpc1ZnU2lnbmFsUmVmKGRhdGEpID8gZGF0YS5zaWduYWwgOiBgZGF0YSgnJHttb2RlbC5sb29rdXBEYXRhU291cmNlKGRhdGEpfScpYDtcbiAgICBpZiAoIWNvbnRhaW5zKHNvdXJjZXMsIHNvdXJjZSkpIHtcbiAgICAgIC8vIGJ1aWxkIGEgdW5pcXVlIGxpc3Qgb2Ygc291cmNlc1xuICAgICAgc291cmNlcy5wdXNoKHNvdXJjZSk7XG4gICAgfVxuICAgIHJldHVybiBzb3VyY2VzO1xuICB9LCBbXSk7XG5cbiAgaWYgKGZpdC5sZW5ndGggPD0gMCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlByb2plY3Rpb24ncyBmaXQgZGlkbid0IGZpbmQgYW55IGRhdGEgc291cmNlc1wiKTtcbiAgfVxuXG4gIHJldHVybiBbe1xuICAgIG5hbWUsXG4gICAgc2l6ZSxcbiAgICBmaXQ6IHtcbiAgICAgIHNpZ25hbDogZml0Lmxlbmd0aCA+IDEgPyBgWyR7Zml0LmpvaW4oJywgJyl9XWAgOiBmaXRbMF1cbiAgICB9LFxuICAgIC4uLnJlc3RcbiAgfV07XG59XG4iXX0=","export var PROJECTION_PROPERTIES = [\n    'type',\n    'clipAngle',\n    'clipExtent',\n    'center',\n    'rotate',\n    'precision',\n    'coefficient',\n    'distance',\n    'fraction',\n    'lobes',\n    'parallel',\n    'radius',\n    'ratio',\n    'spacing',\n    'tilt'\n];\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvamVjdGlvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wcm9qZWN0aW9uLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQTJEQSxNQUFNLENBQUMsSUFBTSxxQkFBcUIsR0FBeUI7SUFDekQsTUFBTTtJQUNOLFdBQVc7SUFDWCxZQUFZO0lBQ1osUUFBUTtJQUNSLFFBQVE7SUFDUixXQUFXO0lBQ1gsYUFBYTtJQUNiLFVBQVU7SUFDVixVQUFVO0lBQ1YsT0FBTztJQUNQLFVBQVU7SUFDVixRQUFRO0lBQ1IsT0FBTztJQUNQLFNBQVM7SUFDVCxNQUFNO0NBQ1AsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IHtWZ1Byb2plY3Rpb25UeXBlfSBmcm9tICcuL3ZlZ2Euc2NoZW1hJztcblxuZXhwb3J0IHR5cGUgUHJvamVjdGlvblR5cGUgPSBWZ1Byb2plY3Rpb25UeXBlO1xuXG5leHBvcnQgaW50ZXJmYWNlIFByb2plY3Rpb24ge1xuICAvKipcbiAgICogVGhlIGNhcnRvZ3JhcGhpYyBwcm9qZWN0aW9uIHRvIHVzZS4gVGhpcyB2YWx1ZSBpcyBjYXNlLWluc2Vuc2l0aXZlLCBmb3IgZXhhbXBsZSBgXCJhbGJlcnNcImAgYW5kIGBcIkFsYmVyc1wiYCBpbmRpY2F0ZSB0aGUgc2FtZSBwcm9qZWN0aW9uIHR5cGUuIFlvdSBjYW4gZmluZCBhbGwgdmFsaWQgcHJvamVjdGlvbiB0eXBlcyBbaW4gdGhlIGRvY3VtZW50YXRpb25dKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvcHJvamVjdGlvbi5odG1sI3Byb2plY3Rpb24tdHlwZXMpLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYG1lcmNhdG9yYFxuICAgKi9cbiAgdHlwZT86IFByb2plY3Rpb25UeXBlO1xuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBwcm9qZWN0aW9u4oCZcyBjbGlwcGluZyBjaXJjbGUgcmFkaXVzIHRvIHRoZSBzcGVjaWZpZWQgYW5nbGUgaW4gZGVncmVlcy4gSWYgYG51bGxgLCBzd2l0Y2hlcyB0byBbYW50aW1lcmlkaWFuXShodHRwOi8vYmwub2Nrcy5vcmcvbWJvc3RvY2svMzc4ODk5OSkgY3V0dGluZyByYXRoZXIgdGhhbiBzbWFsbC1jaXJjbGUgY2xpcHBpbmcuXG4gICAqL1xuICBjbGlwQW5nbGU/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIHByb2plY3Rpb27igJlzIHZpZXdwb3J0IGNsaXAgZXh0ZW50IHRvIHRoZSBzcGVjaWZpZWQgYm91bmRzIGluIHBpeGVscy4gVGhlIGV4dGVudCBib3VuZHMgYXJlIHNwZWNpZmllZCBhcyBhbiBhcnJheSBgW1t4MCwgeTBdLCBbeDEsIHkxXV1gLCB3aGVyZSBgeDBgIGlzIHRoZSBsZWZ0LXNpZGUgb2YgdGhlIHZpZXdwb3J0LCBgeTBgIGlzIHRoZSB0b3AsIGB4MWAgaXMgdGhlIHJpZ2h0IGFuZCBgeTFgIGlzIHRoZSBib3R0b20uIElmIGBudWxsYCwgbm8gdmlld3BvcnQgY2xpcHBpbmcgaXMgcGVyZm9ybWVkLlxuICAgKi9cbiAgY2xpcEV4dGVudD86IG51bWJlcltdW107XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIHByb2plY3Rpb27igJlzIGNlbnRlciB0byB0aGUgc3BlY2lmaWVkIGNlbnRlciwgYSB0d28tZWxlbWVudCBhcnJheSBvZiBsb25naXR1ZGUgYW5kIGxhdGl0dWRlIGluIGRlZ3JlZXMuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgWzAsIDBdYFxuICAgKi9cbiAgY2VudGVyPzogbnVtYmVyW107XG5cbiAgLyoqXG4gICAqIFNldHMgdGhlIHByb2plY3Rpb27igJlzIHRocmVlLWF4aXMgcm90YXRpb24gdG8gdGhlIHNwZWNpZmllZCBhbmdsZXMsIHdoaWNoIG11c3QgYmUgYSB0d28tIG9yIHRocmVlLWVsZW1lbnQgYXJyYXkgb2YgbnVtYmVycyBbYGxhbWJkYWAsIGBwaGlgLCBgZ2FtbWFgXSBzcGVjaWZ5aW5nIHRoZSByb3RhdGlvbiBhbmdsZXMgaW4gZGVncmVlcyBhYm91dCBlYWNoIHNwaGVyaWNhbCBheGlzLiAoVGhlc2UgY29ycmVzcG9uZCB0byB5YXcsIHBpdGNoIGFuZCByb2xsLilcbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBbMCwgMCwgMF1gXG4gICAqL1xuICByb3RhdGU/OiBudW1iZXJbXTtcblxuICAvKipcbiAgICogU2V0cyB0aGUgdGhyZXNob2xkIGZvciB0aGUgcHJvamVjdGlvbuKAmXMgW2FkYXB0aXZlIHJlc2FtcGxpbmddKGh0dHA6Ly9ibC5vY2tzLm9yZy9tYm9zdG9jay8zNzk1NTQ0KSB0byB0aGUgc3BlY2lmaWVkIHZhbHVlIGluIHBpeGVscy4gVGhpcyB2YWx1ZSBjb3JyZXNwb25kcyB0byB0aGUgW0RvdWdsYXPigJNQZXVja2VyIGRpc3RhbmNlXShodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL1JhbWVyJUUyJTgwJTkzRG91Z2xhcyVFMiU4MCU5M1BldWNrZXJfYWxnb3JpdGhtKS4gSWYgcHJlY2lzaW9uIGlzIG5vdCBzcGVjaWZpZWQsIHJldHVybnMgdGhlIHByb2plY3Rpb27igJlzIGN1cnJlbnQgcmVzYW1wbGluZyBwcmVjaXNpb24gd2hpY2ggZGVmYXVsdHMgdG8gYOKImjAuNSDiiYUgMC43MDcxMOKApmAuXG4gICAqL1xuICBwcmVjaXNpb24/OiBTdHJpbmc7XG5cbiAgLyogVGhlIGZvbGxvd2luZyBwcm9wZXJ0aWVzIGFyZSBhbGwgc3VwcG9ydGVkIGZvciBzcGVjaWZpYyB0eXBlcyBvZiBwcm9qZWN0aW9ucy4gQ29uc3VsdCB0aGUgZDMtZ2VvLXByb2plY3Rpb24gbGlicmFyeSBmb3IgbW9yZSBpbmZvcm1hdGlvbjogaHR0cHM6Ly9naXRodWIuY29tL2QzL2QzLWdlby1wcm9qZWN0aW9uICovXG4gIGNvZWZmaWNpZW50PzogbnVtYmVyO1xuICBkaXN0YW5jZT86IG51bWJlcjtcbiAgZnJhY3Rpb24/OiBudW1iZXI7XG4gIGxvYmVzPzogbnVtYmVyO1xuICBwYXJhbGxlbD86IG51bWJlcjtcbiAgcmFkaXVzPzogbnVtYmVyO1xuICByYXRpbz86IG51bWJlcjtcbiAgc3BhY2luZz86IG51bWJlcjtcbiAgdGlsdD86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBBbnkgcHJvcGVydHkgb2YgUHJvamVjdGlvbiBjYW4gYmUgaW4gY29uZmlnXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUHJvamVjdGlvbkNvbmZpZyBleHRlbmRzIFByb2plY3Rpb24geyB9XG5cbmV4cG9ydCBjb25zdCBQUk9KRUNUSU9OX1BST1BFUlRJRVM6IChrZXlvZiBQcm9qZWN0aW9uKVtdID0gW1xuICAndHlwZScsXG4gICdjbGlwQW5nbGUnLFxuICAnY2xpcEV4dGVudCcsXG4gICdjZW50ZXInLFxuICAncm90YXRlJyxcbiAgJ3ByZWNpc2lvbicsXG4gICdjb2VmZmljaWVudCcsXG4gICdkaXN0YW5jZScsXG4gICdmcmFjdGlvbicsXG4gICdsb2JlcycsXG4gICdwYXJhbGxlbCcsXG4gICdyYWRpdXMnLFxuICAncmF0aW8nLFxuICAnc3BhY2luZycsXG4gICd0aWx0J1xuXTtcbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { Split } from '../split';\nvar ProjectionComponent = /** @class */ (function (_super) {\n    tslib_1.__extends(ProjectionComponent, _super);\n    function ProjectionComponent(name, specifiedProjection, size, data) {\n        var _this = _super.call(this, tslib_1.__assign({}, specifiedProjection), // all explicit properties of projection\n        { name: name } // name as initial implicit property\n        ) || this;\n        _this.specifiedProjection = specifiedProjection;\n        _this.size = size;\n        _this.data = data;\n        _this.merged = false;\n        return _this;\n    }\n    return ProjectionComponent;\n}(Split));\nexport { ProjectionComponent };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvcHJvamVjdGlvbi9jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUVBLE9BQU8sRUFBQyxLQUFLLEVBQUMsTUFBTSxVQUFVLENBQUM7QUFFL0I7SUFBeUMsK0NBQW1CO0lBRzFELDZCQUFZLElBQVksRUFBUyxtQkFBK0IsRUFBUyxJQUFtQixFQUFTLElBQThCO1FBQW5JLFlBQ0UsdUNBQ00sbUJBQW1CLEdBQUksd0NBQXdDO1FBQ25FLEVBQUMsSUFBSSxNQUFBLEVBQUMsQ0FBRSxvQ0FBb0M7U0FDN0MsU0FDRjtRQUxnQyx5QkFBbUIsR0FBbkIsbUJBQW1CLENBQVk7UUFBUyxVQUFJLEdBQUosSUFBSSxDQUFlO1FBQVMsVUFBSSxHQUFKLElBQUksQ0FBMEI7UUFGNUgsWUFBTSxHQUFHLEtBQUssQ0FBQzs7SUFPdEIsQ0FBQztJQUNILDBCQUFDO0FBQUQsQ0FBQyxBQVRELENBQXlDLEtBQUssR0FTN0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1Byb2plY3Rpb259IGZyb20gJy4uLy4uL3Byb2plY3Rpb24nO1xuaW1wb3J0IHtWZ1Byb2plY3Rpb24sIFZnU2lnbmFsUmVmfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge1NwbGl0fSBmcm9tICcuLi9zcGxpdCc7XG5cbmV4cG9ydCBjbGFzcyBQcm9qZWN0aW9uQ29tcG9uZW50IGV4dGVuZHMgU3BsaXQ8VmdQcm9qZWN0aW9uPiB7XG4gIHB1YmxpYyBtZXJnZWQgPSBmYWxzZTtcblxuICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcsIHB1YmxpYyBzcGVjaWZpZWRQcm9qZWN0aW9uOiBQcm9qZWN0aW9uLCBwdWJsaWMgc2l6ZTogVmdTaWduYWxSZWZbXSwgcHVibGljIGRhdGE6IChzdHJpbmcgfCBWZ1NpZ25hbFJlZilbXSkge1xuICAgIHN1cGVyKFxuICAgICAgey4uLnNwZWNpZmllZFByb2plY3Rpb259LCAgLy8gYWxsIGV4cGxpY2l0IHByb3BlcnRpZXMgb2YgcHJvamVjdGlvblxuICAgICAge25hbWV9ICAvLyBuYW1lIGFzIGluaXRpYWwgaW1wbGljaXQgcHJvcGVydHlcbiAgICApO1xuICB9XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { LATITUDE, LATITUDE2, LONGITUDE, LONGITUDE2, SHAPE } from '../../channel';\nimport { MAIN } from '../../data';\nimport { PROJECTION_PROPERTIES } from '../../projection';\nimport { GEOJSON } from '../../type';\nimport { duplicate, every, stringify } from '../../util';\nimport { isUnitModel } from '../model';\nimport { ProjectionComponent } from './component';\nexport function parseProjection(model) {\n    if (isUnitModel(model)) {\n        model.component.projection = parseUnitProjection(model);\n    }\n    else {\n        // because parse happens from leaves up (unit specs before layer spec),\n        // we can be sure that the above if statement has already occurred\n        // and therefore we have access to child.component.projection\n        // for each of model's children\n        model.component.projection = parseNonUnitProjections(model);\n    }\n}\nfunction parseUnitProjection(model) {\n    var specifiedProjection = model.specifiedProjection, config = model.config, hasProjection = model.hasProjection;\n    if (hasProjection) {\n        var data_1 = [];\n        [[LONGITUDE, LATITUDE], [LONGITUDE2, LATITUDE2]].forEach(function (posssiblePair) {\n            if (model.channelHasField(posssiblePair[0]) || model.channelHasField(posssiblePair[1])) {\n                data_1.push({\n                    signal: model.getName(\"geojson_\" + data_1.length)\n                });\n            }\n        });\n        if (model.channelHasField(SHAPE) && model.fieldDef(SHAPE).type === GEOJSON) {\n            data_1.push({\n                signal: model.getName(\"geojson_\" + data_1.length)\n            });\n        }\n        if (data_1.length === 0) {\n            // main source is geojson, so we can just use that\n            data_1.push(model.requestDataName(MAIN));\n        }\n        return new ProjectionComponent(model.projectionName(true), tslib_1.__assign({}, (config.projection || {}), (specifiedProjection || {})), [model.getSizeSignalRef('width'), model.getSizeSignalRef('height')], data_1);\n    }\n    return undefined;\n}\nfunction mergeIfNoConflict(first, second) {\n    var allPropertiesShared = every(PROJECTION_PROPERTIES, function (prop) {\n        // neither has the poperty\n        if (!first.explicit.hasOwnProperty(prop) &&\n            !second.explicit.hasOwnProperty(prop)) {\n            return true;\n        }\n        // both have property and an equal value for property\n        if (first.explicit.hasOwnProperty(prop) &&\n            second.explicit.hasOwnProperty(prop) &&\n            // some properties might be signals or objects and require hashing for comparison\n            stringify(first.get(prop)) === stringify(second.get(prop))) {\n            return true;\n        }\n        return false;\n    });\n    var size = stringify(first.size) === stringify(second.size);\n    if (size) {\n        if (allPropertiesShared) {\n            return first;\n        }\n        else if (stringify(first.explicit) === stringify({})) {\n            return second;\n        }\n        else if (stringify(second.explicit) === stringify({})) {\n            return first;\n        }\n    }\n    // if all properties don't match, let each unit spec have its own projection\n    return null;\n}\nfunction parseNonUnitProjections(model) {\n    if (model.children.length === 0) {\n        return undefined;\n    }\n    var nonUnitProjection;\n    var mergable = every(model.children, function (child) {\n        parseProjection(child);\n        var projection = child.component.projection;\n        if (!projection) {\n            // child layer does not use a projection\n            return true;\n        }\n        else if (!nonUnitProjection) {\n            // cached 'projection' is null, cache this one\n            nonUnitProjection = projection;\n            return true;\n        }\n        else {\n            var merge = mergeIfNoConflict(nonUnitProjection, projection);\n            if (merge) {\n                nonUnitProjection = merge;\n            }\n            return !!merge;\n        }\n    });\n    // it cached one and all other children share the same projection,\n    if (nonUnitProjection && mergable) {\n        // so we can elevate it to the layer level\n        var name_1 = model.projectionName(true);\n        var modelProjection_1 = new ProjectionComponent(name_1, nonUnitProjection.specifiedProjection, nonUnitProjection.size, duplicate(nonUnitProjection.data));\n        // rename and assign all others as merged\n        model.children.forEach(function (child) {\n            if (child.component.projection) {\n                modelProjection_1.data = modelProjection_1.data.concat(child.component.projection.data);\n                child.renameProjection(child.component.projection.get('name'), name_1);\n                child.component.projection.merged = true;\n            }\n        });\n        return modelProjection_1;\n    }\n    return undefined;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyc2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9wcm9qZWN0aW9uL3BhcnNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUMsUUFBUSxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUNoRixPQUFPLEVBQUMsSUFBSSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQ2hDLE9BQU8sRUFBQyxxQkFBcUIsRUFBQyxNQUFNLGtCQUFrQixDQUFDO0FBQ3ZELE9BQU8sRUFBQyxPQUFPLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDbkMsT0FBTyxFQUFDLFNBQVMsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBRXZELE9BQU8sRUFBQyxXQUFXLEVBQVEsTUFBTSxVQUFVLENBQUM7QUFFNUMsT0FBTyxFQUFDLG1CQUFtQixFQUFDLE1BQU0sYUFBYSxDQUFDO0FBRWhELE1BQU0sMEJBQTBCLEtBQVk7SUFDMUMsSUFBSSxXQUFXLENBQUMsS0FBSyxDQUFDLEVBQUU7UUFDdEIsS0FBSyxDQUFDLFNBQVMsQ0FBQyxVQUFVLEdBQUcsbUJBQW1CLENBQUMsS0FBSyxDQUFDLENBQUM7S0FDekQ7U0FBTTtRQUNMLHVFQUF1RTtRQUN2RSxrRUFBa0U7UUFDbEUsNkRBQTZEO1FBQzdELCtCQUErQjtRQUMvQixLQUFLLENBQUMsU0FBUyxDQUFDLFVBQVUsR0FBRyx1QkFBdUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztLQUM3RDtBQUNILENBQUM7QUFFRCw2QkFBNkIsS0FBZ0I7SUFDcEMsSUFBQSwrQ0FBbUIsRUFBRSxxQkFBTSxFQUFFLG1DQUFhLENBQVU7SUFFM0QsSUFBSSxhQUFhLEVBQUU7UUFDakIsSUFBTSxNQUFJLEdBQTZCLEVBQUUsQ0FBQztRQUUxQyxDQUFDLENBQUMsU0FBUyxFQUFFLFFBQVEsQ0FBQyxFQUFF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QUssQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLFVBQUMsS0FBSztZQUMzQixJQUFJLEtBQUssQ0FBQyxTQUFTLENBQUMsVUFBVSxFQUFFO2dCQUM5QixpQkFBZSxDQUFDLElBQUksR0FBRyxpQkFBZSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ3BGLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEVBQUUsTUFBSSxDQUFDLENBQUM7Z0JBQ3JFLEtBQUssQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUM7YUFDMUM7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUVILE9BQU8saUJBQWUsQ0FBQztLQUN4QjtJQUVELE9BQU8sU0FBUyxDQUFDO0FBQ25CLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0xBVElUVURFLCBMQVRJVFVERTIsIExPTkdJVFVERSwgTE9OR0lUVURFMiwgU0hBUEV9IGZyb20gJy4uLy4uL2NoYW5uZWwnO1xuaW1wb3J0IHtNQUlOfSBmcm9tICcuLi8uLi9kYXRhJztcbmltcG9ydCB7UFJPSkVDVElPTl9QUk9QRVJUSUVTfSBmcm9tICcuLi8uLi9wcm9qZWN0aW9uJztcbmltcG9ydCB7R0VPSlNPTn0gZnJvbSAnLi4vLi4vdHlwZSc7XG5pbXBvcnQge2R1cGxpY2F0ZSwgZXZlcnksIHN0cmluZ2lmeX0gZnJvbSAnLi4vLi4vdXRpbCc7XG5pbXBvcnQge1ZnU2lnbmFsUmVmfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge2lzVW5pdE1vZGVsLCBNb2RlbH0gZnJvbSAnLi4vbW9kZWwnO1xuaW1wb3J0IHtVbml0TW9kZWx9IGZyb20gJy4uL3VuaXQnO1xuaW1wb3J0IHtQcm9qZWN0aW9uQ29tcG9uZW50fSBmcm9tICcuL2NvbXBvbmVudCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVByb2plY3Rpb24obW9kZWw6IE1vZGVsKSB7XG4gIGlmIChpc1VuaXRNb2RlbChtb2RlbCkpIHtcbiAgICBtb2RlbC5jb21wb25lbnQucHJvamVjdGlvbiA9IHBhcnNlVW5pdFByb2plY3Rpb24obW9kZWwpO1xuICB9IGVsc2Uge1xuICAgIC8vIGJlY2F1c2UgcGFyc2UgaGFwcGVucyBmcm9tIGxlYXZlcyB1cCAodW5pdCBzcGVjcyBiZWZvcmUgbGF5ZXIgc3BlYyksXG4gICAgLy8gd2UgY2FuIGJlIHN1cmUgdGhhdCB0aGUgYWJvdmUgaWYgc3RhdGVtZW50IGhhcyBhbHJlYWR5IG9jY3VycmVkXG4gICAgLy8gYW5kIHRoZXJlZm9yZSB3ZSBoYXZlIGFjY2VzcyB0byBjaGlsZC5jb21wb25lbnQucHJvamVjdGlvblxuICAgIC8vIGZvciBlYWNoIG9mIG1vZGVsJ3MgY2hpbGRyZW5cbiAgICBtb2RlbC5jb21wb25lbnQucHJvamVjdGlvbiA9IHBhcnNlTm9uVW5pdFByb2plY3Rpb25zKG1vZGVsKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBwYXJzZVVuaXRQcm9qZWN0aW9uKG1vZGVsOiBVbml0TW9kZWwpOiBQcm9qZWN0aW9uQ29tcG9uZW50IHtcbiAgY29uc3Qge3NwZWNpZmllZFByb2plY3Rpb24sIGNvbmZpZywgaGFzUHJvamVjdGlvbn0gPSBtb2RlbDtcblxuICBpZiAoaGFzUHJvamVjdGlvbikge1xuICAgIGNvbnN0IGRhdGE6IChWZ1NpZ25hbFJlZiB8IHN0cmluZylbXSA9IFtdO1xuXG4gICAgW1tMT05HSVRVREUsIExBVElUVURFXSwgW0xPTkdJVFVERTIsIExBVElUVURFMl1dLmZvckVhY2goKHBvc3NzaWJsZVBhaXIpID0+IHtcbiAgICAgIGlmIChtb2RlbC5jaGFubmVsSGFzRmllbGQocG9zc3NpYmxlUGFpclswXSkgfHwgbW9kZWwuY2hhbm5lbEhhc0ZpZWxkKHBvc3NzaWJsZVBhaXJbMV0pKSB7XG4gICAgICAgIGRhdGEucHVzaCh7XG4gICAgICAgICAgc2lnbmFsOiBtb2RlbC5nZXROYW1lKGBnZW9qc29uXyR7ZGF0YS5sZW5ndGh9YClcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAobW9kZWwuY2hhbm5lbEhhc0ZpZWxkKFNIQVBFKSAmJiBtb2RlbC5maWVsZERlZihTSEFQRSkudHlwZSA9PT0gR0VPSlNPTikge1xuICAgICAgZGF0YS5wdXNoKHtcbiAgICAgICAgc2lnbmFsOiBtb2RlbC5nZXROYW1lKGBnZW9qc29uXyR7ZGF0YS5sZW5ndGh9YClcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChkYXRhLmxlbmd0aCA9PT0gMCkge1xuICAgICAgLy8gbWFpbiBzb3VyY2UgaXMgZ2VvanNvbiwgc28gd2UgY2FuIGp1c3QgdXNlIHRoYXRcbiAgICAgIGRhdGEucHVzaChtb2RlbC5yZXF1ZXN0RGF0YU5hbWUoTUFJTikpO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgUHJvamVjdGlvbkNvbXBvbmVudChtb2RlbC5wcm9qZWN0aW9uTmFtZSh0cnVlKSwge1xuICAgICAgLi4uKGNvbmZpZy5wcm9qZWN0aW9uIHx8IHt9KSxcbiAgICAgIC4uLihzcGVjaWZpZWRQcm9qZWN0aW9uIHx8IHt9KSxcbiAgICB9LCBbbW9kZWwuZ2V0U2l6ZVNpZ25hbFJlZignd2lkdGgnKSwgbW9kZWwuZ2V0U2l6ZVNpZ25hbFJlZignaGVpZ2h0JyldLCBkYXRhKTtcbiAgfVxuXG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG5cblxuZnVuY3Rpb24gbWVyZ2VJZk5vQ29uZmxpY3QoZmlyc3Q6IFByb2plY3Rpb25Db21wb25lbnQsIHNlY29uZDogUHJvamVjdGlvbkNvbXBvbmVudCk6IFByb2plY3Rpb25Db21wb25lbnQge1xuICBjb25zdCBhbGxQcm9wZXJ0aWVzU2hhcmVkID0gZXZlcnkoUFJPSkVDVElPTl9QUk9QRVJUSUVTLCAocHJvcCkgPT4ge1xuICAgIC8vIG5laXRoZXIgaGFzIHRoZSBwb3BlcnR5XG4gICAgaWYgKCFmaXJzdC5leHBsaWNpdC5oYXNPd25Qcm9wZXJ0eShwcm9wKSAmJlxuICAgICAgIXNlY29uZC5leHBsaWNpdC5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIC8vIGJvdGggaGF2ZSBwcm9wZXJ0eSBhbmQgYW4gZXF1YWwgdmFsdWUgZm9yIHByb3BlcnR5XG4gICAgaWYgKGZpcnN0LmV4cGxpY2l0Lmhhc093blByb3BlcnR5KHByb3ApICYmXG4gICAgICBzZWNvbmQuZXhwbGljaXQuaGFzT3duUHJvcGVydHkocHJvcCkgJiZcbiAgICAgIC8vIHNvbWUgcHJvcGVydGllcyBtaWdodCBiZSBzaWduYWxzIG9yIG9iamVjdHMgYW5kIHJlcXVpcmUgaGFzaGluZyBmb3IgY29tcGFyaXNvblxuICAgICAgc3RyaW5naWZ5KGZpcnN0LmdldChwcm9wKSkgPT09IHN0cmluZ2lmeShzZWNvbmQuZ2V0KHByb3ApKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfSk7XG5cbiAgY29uc3Qgc2l6ZSA9IHN0cmluZ2lmeShmaXJzdC5zaXplKSA9PT0gc3RyaW5naWZ5KHNlY29uZC5zaXplKTtcbiAgaWYgKHNpemUpIHtcbiAgICBpZiAoYWxsUHJvcGVydGllc1NoYXJlZCkge1xuICAgICAgcmV0dXJuIGZpcnN0O1xuICAgIH0gZWxzZSBpZiAoc3RyaW5naWZ5KGZpcnN0LmV4cGxpY2l0KSA9PT0gc3RyaW5naWZ5KHt9KSkge1xuICAgICAgcmV0dXJuIHNlY29uZDtcbiAgICB9IGVsc2UgaWYgKHN0cmluZ2lmeShzZWNvbmQuZXhwbGljaXQpID09PSBzdHJpbmdpZnkoe30pKSB7XG4gICAgICByZXR1cm4gZmlyc3Q7XG4gICAgfVxuICB9XG5cbiAgLy8gaWYgYWxsIHByb3BlcnRpZXMgZG9uJ3QgbWF0Y2gsIGxldCBlYWNoIHVuaXQgc3BlYyBoYXZlIGl0cyBvd24gcHJvamVjdGlvblxuICByZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gcGFyc2VOb25Vbml0UHJvamVjdGlvbnMobW9kZWw6IE1vZGVsKTogUHJvamVjdGlvbkNvbXBvbmVudCB7XG4gIGlmIChtb2RlbC5jaGlsZHJlbi5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgbGV0IG5vblVuaXRQcm9qZWN0aW9uOiBQcm9qZWN0aW9uQ29tcG9uZW50O1xuICBjb25zdCBtZXJnYWJsZSA9IGV2ZXJ5KG1vZGVsLmNoaWxkcmVuLCAoY2hpbGQpID0+IHtcbiAgICBwYXJzZVByb2plY3Rpb24oY2hpbGQpO1xuICAgIGNvbnN0IHByb2plY3Rpb24gPSBjaGlsZC5jb21wb25lbnQucHJvamVjdGlvbjtcbiAgICBpZiAoIXByb2plY3Rpb24pIHtcbiAgICAgIC8vIGNoaWxkIGxheWVyIGRvZXMgbm90IHVzZSBhIHByb2plY3Rpb25cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSBpZiAoIW5vblVuaXRQcm9qZWN0aW9uKSB7XG4gICAgICAvLyBjYWNoZWQgJ3Byb2plY3Rpb24nIGlzIG51bGwsIGNhY2hlIHRoaXMgb25lXG4gICAgICBub25Vbml0UHJvamVjdGlvbiA9IHByb2plY3Rpb247XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgbWVyZ2UgPSBtZXJnZUlmTm9Db25mbGljdChub25Vbml0UHJvamVjdGlvbiwgcHJvamVjdGlvbik7XG4gICAgICBpZiAobWVyZ2UpIHtcbiAgICAgICAgbm9uVW5pdFByb2plY3Rpb24gPSBtZXJnZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAhIW1lcmdlO1xuICAgIH1cbiAgfSk7XG5cbiAgLy8gaXQgY2FjaGVkIG9uZSBhbmQgYWxsIG90aGVyIGNoaWxkcmVuIHNoYXJlIHRoZSBzYW1lIHByb2plY3Rpb24sXG4gIGlmIChub25Vbml0UHJvamVjdGlvbiAmJiBtZXJnYWJsZSkge1xuICAgIC8vIHNvIHdlIGNhbiBlbGV2YXRlIGl0IHRvIHRoZSBsYXllciBsZXZlbFxuICAgIGNvbnN0IG5hbWUgPSBtb2RlbC5wcm9qZWN0aW9uTmFtZSh0cnVlKTtcbiAgICBjb25zdCBtb2RlbFByb2plY3Rpb24gPSBuZXcgUHJvamVjdGlvbkNvbXBvbmVudChcbiAgICAgIG5hbWUsXG4gICAgICBub25Vbml0UHJvamVjdGlvbi5zcGVjaWZpZWRQcm9qZWN0aW9uLFxuICAgICAgbm9uVW5pdFByb2plY3Rpb24uc2l6ZSxcbiAgICAgIGR1cGxpY2F0ZShub25Vbml0UHJvamVjdGlvbi5kYXRhKVxuICAgICk7XG5cbiAgICAvLyByZW5hbWUgYW5kIGFzc2lnbiBhbGwgb3RoZXJzIGFzIG1lcmdlZFxuICAgIG1vZGVsLmNoaWxkcmVuLmZvckVhY2goKGNoaWxkKSA9PiB7XG4gICAgICBpZiAoY2hpbGQuY29tcG9uZW50LnByb2plY3Rpb24pIHtcbiAgICAgICAgbW9kZWxQcm9qZWN0aW9uLmRhdGEgPSBtb2RlbFByb2plY3Rpb24uZGF0YS5jb25jYXQoY2hpbGQuY29tcG9uZW50LnByb2plY3Rpb24uZGF0YSk7XG4gICAgICAgIGNoaWxkLnJlbmFtZVByb2plY3Rpb24oY2hpbGQuY29tcG9uZW50LnByb2plY3Rpb24uZ2V0KCduYW1lJyksIG5hbWUpO1xuICAgICAgICBjaGlsZC5jb21wb25lbnQucHJvamVjdGlvbi5tZXJnZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIG1vZGVsUHJvamVjdGlvbjtcbiAgfVxuXG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG4iXX0=","import { isArray, isString } from 'vega-util';\nexport function isSortField(sort) {\n    return !!sort && (sort['op'] === 'count' || !!sort['field']) && !!sort['op'];\n}\nexport function isSortArray(sort) {\n    return !!sort && isArray(sort) && sort.every(function (s) { return isString(s); });\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic29ydC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zb3J0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBQyxPQUFPLEVBQUUsUUFBUSxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBa0Q1QyxNQUFNLHNCQUF5QixJQUFpRDtJQUM5RSxPQUFPLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssT0FBTyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQy9FLENBQUM7QUFFRCxNQUFNLHNCQUF5QixJQUFpRDtJQUM5RSxPQUFPLENBQUMsQ0FBQyxJQUFJLElBQUksT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQVgsQ0FBVyxDQUFDLENBQUM7QUFDakUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7QWdncmVnYXRlT3B9IGZyb20gJ3ZlZ2EnO1xuaW1wb3J0IHtpc0FycmF5LCBpc1N0cmluZ30gZnJvbSAndmVnYS11dGlsJztcblxuaW1wb3J0IHtWZ0NvbXBhcmF0b3JPcmRlcn0gZnJvbSAnLi92ZWdhLnNjaGVtYSc7XG5cblxuZXhwb3J0IHR5cGUgU29ydE9yZGVyID0gVmdDb21wYXJhdG9yT3JkZXIgfCBudWxsO1xuXG5cbi8qKlxuICogQSBzb3J0IGRlZmluaXRpb24gZm9yIHRyYW5zZm9ybVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFNvcnRGaWVsZCB7XG4gIC8qKlxuICAgKiBUaGUgbmFtZSBvZiB0aGUgZmllbGQgdG8gc29ydC5cbiAgICovXG4gIGZpZWxkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gc29ydCB0aGUgZmllbGQgaW4gYXNjZW5kaW5nIG9yIGRlc2NlbmRpbmcgb3JkZXIuXG4gICAqL1xuICBvcmRlcj86IFZnQ29tcGFyYXRvck9yZGVyO1xufVxuXG5cbi8qKlxuICogQSBzb3J0IGRlZmluaXRpb24gZm9yIHNvcnRpbmcgYSBkaXNjcmV0ZSBzY2FsZSBpbiBhbiBlbmNvZGluZyBmaWVsZCBkZWZpbml0aW9uLlxuICovXG5cbmV4cG9ydCBpbnRlcmZhY2UgRW5jb2RpbmdTb3J0RmllbGQ8Rj4ge1xuICAvKipcbiAgICogVGhlIGRhdGEgW2ZpZWxkXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL2ZpZWxkLmh0bWwpIHRvIHNvcnQgYnkuXG4gICAqXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBJZiB1bnNwZWNpZmllZCwgZGVmYXVsdHMgdG8gdGhlIGZpZWxkIHNwZWNpZmllZCBpbiB0aGUgb3V0ZXIgZGF0YSByZWZlcmVuY2UuXG4gICAqL1xuICBmaWVsZD86IEY7XG4gIC8qKlxuICAgKiBBbiBbYWdncmVnYXRlIG9wZXJhdGlvbl0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9hZ2dyZWdhdGUuaHRtbCNvcHMpIHRvIHBlcmZvcm0gb24gdGhlIGZpZWxkIHByaW9yIHRvIHNvcnRpbmcgKGUuZy4sIGBcImNvdW50XCJgLCBgXCJtZWFuXCJgIGFuZCBgXCJtZWRpYW5cImApLlxuICAgKiBUaGlzIHByb3BlcnR5IGlzIHJlcXVpcmVkIGluIGNhc2VzIHdoZXJlIHRoZSBzb3J0IGZpZWxkIGFuZCB0aGUgZGF0YSByZWZlcmVuY2UgZmllbGQgZG8gbm90IG1hdGNoLlxuICAgKiBUaGUgaW5wdXQgZGF0YSBvYmplY3RzIHdpbGwgYmUgYWdncmVnYXRlZCwgZ3JvdXBlZCBieSB0aGUgZW5jb2RlZCBkYXRhIGZpZWxkLlxuICAgKlxuICAgKiBGb3IgYSBmdWxsIGxpc3Qgb2Ygb3BlcmF0aW9ucywgcGxlYXNlIHNlZSB0aGUgZG9jdW1lbnRhdGlvbiBmb3IgW2FnZ3JlZ2F0ZV0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9hZ2dyZWdhdGUuaHRtbCNvcHMpLlxuICAgKi9cbiAgb3A6IEFnZ3JlZ2F0ZU9wO1xuXG4gIC8qKlxuICAgKiBUaGUgc29ydCBvcmRlci4gT25lIG9mIGBcImFzY2VuZGluZ1wiYCAoZGVmYXVsdCksIGBcImRlc2NlbmRpbmdcImAsIG9yIGBudWxsYCAobm8gbm90IHNvcnQpLlxuICAgKi9cbiAgb3JkZXI/OiBTb3J0T3JkZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1NvcnRGaWVsZDxGPihzb3J0OiBzdHJpbmdbXSB8IFNvcnRPcmRlciB8IEVuY29kaW5nU29ydEZpZWxkPEY+KTogc29ydCBpcyBFbmNvZGluZ1NvcnRGaWVsZDxGPiB7XG4gIHJldHVybiAhIXNvcnQgJiYgKHNvcnRbJ29wJ10gPT09ICdjb3VudCcgfHwgISFzb3J0WydmaWVsZCddKSAmJiAhIXNvcnRbJ29wJ107XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1NvcnRBcnJheTxGPihzb3J0OiBzdHJpbmdbXSB8IFNvcnRPcmRlciB8IEVuY29kaW5nU29ydEZpZWxkPEY+KTogc29ydCBpcyBzdHJpbmdbXSB7XG4gIHJldHVybiAhIXNvcnQgJiYgaXNBcnJheShzb3J0KSAmJiBzb3J0LmV2ZXJ5KHMgPT4gaXNTdHJpbmcocykpO1xufVxuIl19","import * as tslib_1 from \"tslib\";\n/**\n * A node in the dataflow tree.\n */\nvar DataFlowNode = /** @class */ (function () {\n    function DataFlowNode(parent, debugName) {\n        this.debugName = debugName;\n        this._children = [];\n        this._parent = null;\n        if (parent) {\n            this.parent = parent;\n        }\n    }\n    /**\n     * Clone this node with a deep copy but don't clone links to children or parents.\n     */\n    DataFlowNode.prototype.clone = function () {\n        throw new Error('Cannot clone node');\n    };\n    /**\n     * Set of fields that are being created by this node.\n     */\n    DataFlowNode.prototype.producedFields = function () {\n        return {};\n    };\n    DataFlowNode.prototype.dependentFields = function () {\n        return {};\n    };\n    Object.defineProperty(DataFlowNode.prototype, \"parent\", {\n        get: function () {\n            return this._parent;\n        },\n        /**\n         * Set the parent of the node and also add this not to the parent's children.\n         */\n        set: function (parent) {\n            this._parent = parent;\n            parent.addChild(this);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DataFlowNode.prototype, \"children\", {\n        get: function () {\n            return this._children;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    DataFlowNode.prototype.numChildren = function () {\n        return this._children.length;\n    };\n    DataFlowNode.prototype.addChild = function (child) {\n        this._children.push(child);\n    };\n    DataFlowNode.prototype.removeChild = function (oldChild) {\n        this._children.splice(this._children.indexOf(oldChild), 1);\n    };\n    /**\n     * Remove node from the dataflow.\n     */\n    DataFlowNode.prototype.remove = function () {\n        for (var _i = 0, _a = this._children; _i < _a.length; _i++) {\n            var child = _a[_i];\n            child.parent = this._parent;\n        }\n        this._parent.removeChild(this);\n    };\n    /**\n     * Insert another node as a parent of this node.\n     */\n    DataFlowNode.prototype.insertAsParentOf = function (other) {\n        var parent = other.parent;\n        parent.removeChild(this);\n        this.parent = parent;\n        other.parent = this;\n    };\n    DataFlowNode.prototype.swapWithParent = function () {\n        var parent = this._parent;\n        var newParent = parent.parent;\n        // reconnect the children\n        for (var _i = 0, _a = this._children; _i < _a.length; _i++) {\n            var child = _a[_i];\n            child.parent = parent;\n        }\n        // remove old links\n        this._children = []; // equivalent to removing every child link one by one\n        parent.removeChild(this);\n        parent.parent.removeChild(parent);\n        // swap two nodes\n        this.parent = newParent;\n        parent.parent = this;\n    };\n    return DataFlowNode;\n}());\nexport { DataFlowNode };\nvar OutputNode = /** @class */ (function (_super) {\n    tslib_1.__extends(OutputNode, _super);\n    /**\n     * @param source The name of the source. Will change in assemble.\n     * @param type The type of the output node.\n     * @param refCounts A global ref counter map.\n     */\n    function OutputNode(parent, source, type, refCounts) {\n        var _this = _super.call(this, parent, source) || this;\n        _this.type = type;\n        _this.refCounts = refCounts;\n        _this._source = _this._name = source;\n        if (_this.refCounts && !(_this._name in _this.refCounts)) {\n            _this.refCounts[_this._name] = 0;\n        }\n        return _this;\n    }\n    OutputNode.prototype.clone = function () {\n        var cloneObj = new this.constructor;\n        cloneObj.debugName = 'clone_' + this.debugName;\n        cloneObj._source = this._source;\n        cloneObj._name = 'clone_' + this._name;\n        cloneObj.type = this.type;\n        cloneObj.refCounts = this.refCounts;\n        cloneObj.refCounts[cloneObj._name] = 0;\n        return cloneObj;\n    };\n    /**\n     * Request the datasource name and increase the ref counter.\n     *\n     * During the parsing phase, this will return the simple name such as 'main' or 'raw'.\n     * It is crucial to request the name from an output node to mark it as a required node.\n     * If nobody ever requests the name, this datasource will not be instantiated in the assemble phase.\n     *\n     * In the assemble phase, this will return the correct name.\n     */\n    OutputNode.prototype.getSource = function () {\n        this.refCounts[this._name]++;\n        return this._source;\n    };\n    OutputNode.prototype.isRequired = function () {\n        return !!this.refCounts[this._name];\n    };\n    OutputNode.prototype.setSource = function (source) {\n        this._source = source;\n    };\n    return OutputNode;\n}(DataFlowNode));\nexport { OutputNode };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0YWZsb3cuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9kYXRhL2RhdGFmbG93LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFLQTs7R0FFRztBQUNIO0lBS0Usc0JBQVksTUFBb0IsRUFBa0IsU0FBa0I7UUFBbEIsY0FBUyxHQUFULFNBQVMsQ0FBUztRQUo1RCxjQUFTLEdBQW1CLEVBQUUsQ0FBQztRQUUvQixZQUFPLEdBQWlCLElBQUksQ0FBQztRQUduQyxJQUFJLE1BQU0sRUFBRTtZQUNWLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1NBQ3RCO0lBQ0gsQ0FBQztJQUVEOztPQUVHO0lBQ0ksNEJBQUssR0FBWjtRQUNFLE1BQU0sSUFBSSxLQUFLLENBQUMsbUJBQW1CLENBQUMsQ0FBQztJQUN2QyxDQUFDO0lBRUQ7O09BRUc7SUFDSSxxQ0FBYyxHQUFyQjtRQUNFLE9BQU8sRUFBRSxDQUFDO0lBQ1osQ0FBQztJQUVNLHNDQUFlLEdBQXRCO1FBQ0UsT0FBTyxFQUFFLENBQUM7SUFDWixDQUFDO0lBRUQsc0JBQUksZ0NBQU07YUFBVjtZQUNFLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQztRQUN0QixDQUFDO1FBRUQ7O1dBRUc7YUFDSCxVQUFXLE1BQW9CO1lBQzdCLElBQUksQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO1lBQ3RCLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDeEIsQ0FBQzs7O09BUkE7SUFVRCxzQkFBSSxrQ0FBUTthQUFaO1lBQ0UsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDO1FBQ3hCLENBQUM7OztPQUFBO0lBRU0sa0NBQVcsR0FBbEI7UUFDRSxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDO0lBQy9CLENBQUM7SUFFTSwrQkFBUSxHQUFmLFVBQWdCLEtBQW1CO1FBQ2pDLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLEtB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R0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDO1FBQ3BDLFFBQVEsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUN2QyxPQUFPLFFBQVEsQ0FBQztJQUNsQixDQUFDO0lBaUJEOzs7Ozs7OztPQVFHO0lBQ0ksOEJBQVMsR0FBaEI7UUFDRSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDO1FBQzdCLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQztJQUN0QixDQUFDO0lBRU0sK0JBQVUsR0FBakI7UUFDRSxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUN0QyxDQUFDO0lBRU0sOEJBQVMsR0FBaEIsVUFBaUIsTUFBYztRQUM3QixJQUFJLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQztJQUN4QixDQUFDO0lBQ0gsaUJBQUM7QUFBRCxDQUFDLEFBcERELENBQWdDLFlBQVksR0FvRDNDIiwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQge0RhdGFTb3VyY2VUeXBlfSBmcm9tICcuLi8uLi9kYXRhJztcbmltcG9ydCB7RGljdCwgU3RyaW5nU2V0fSBmcm9tICcuLi8uLi91dGlsJztcblxuXG4vKipcbiAqIEEgbm9kZSBpbiB0aGUgZGF0YWZsb3cgdHJlZS5cbiAqL1xuZXhwb3J0IGNsYXNzIERhdGFGbG93Tm9kZSB7XG4gIHByaXZhdGUgX2NoaWxkcmVuOiBEYXRhRmxvd05vZGVbXSA9IFtdO1xuXG4gIHByaXZhdGUgX3BhcmVudDogRGF0YUZsb3dOb2RlID0gbnVsbDtcblxuICBjb25zdHJ1Y3RvcihwYXJlbnQ6IERhdGFGbG93Tm9kZSwgcHVibGljIHJlYWRvbmx5IGRlYnVnTmFtZT86IHN0cmluZykge1xuICAgIGlmIChwYXJlbnQpIHtcbiAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDbG9uZSB0aGlzIG5vZGUgd2l0aCBhIGRlZXAgY29weSBidXQgZG9uJ3QgY2xvbmUgbGlua3MgdG8gY2hpbGRyZW4gb3IgcGFyZW50cy5cbiAgICovXG4gIHB1YmxpYyBjbG9uZSgpOiBEYXRhRmxvd05vZGUge1xuICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGNsb25lIG5vZGUnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgb2YgZmllbGRzIHRoYXQgYXJlIGJlaW5nIGNyZWF0ZWQgYnkgdGhpcyBub2RlLlxuICAgKi9cbiAgcHVibGljIHByb2R1Y2VkRmllbGRzKCk6IFN0cmluZ1NldCB7XG4gICAgcmV0dXJuIHt9O1xuICB9XG5cbiAgcHVibGljIGRlcGVuZGVudEZpZWxkcygpOiBTdHJpbmdTZXQge1xuICAgIHJldHVybiB7fTtcbiAgfVxuXG4gIGdldCBwYXJlbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3BhcmVudDtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgdGhlIHBhcmVudCBvZiB0aGUgbm9kZSBhbmQgYWxzbyBhZGQgdGhpcyBub3QgdG8gdGhlIHBhcmVudCdzIGNoaWxkcmVuLlxuICAgKi9cbiAgc2V0IHBhcmVudChwYXJlbnQ6IERhdGFGbG93Tm9kZSkge1xuICAgIHRoaXMuX3BhcmVudCA9IHBhcmVudDtcbiAgICBwYXJlbnQuYWRkQ2hpbGQodGhpcyk7XG4gIH1cblxuICBnZXQgY2hpbGRyZW4oKSB7XG4gICAgcmV0dXJuIHRoaXMuX2NoaWxkcmVuO1xuICB9XG5cbiAgcHVibGljIG51bUNoaWxkcmVuKCkge1xuICAgIHJldHVybiB0aGlzLl9jaGlsZHJlbi5sZW5ndGg7XG4gIH1cblxuICBwdWJsaWMgYWRkQ2hpbGQoY2hpbGQ6IERhdGFGbG93Tm9kZSkge1xuICAgIHRoaXMuX2NoaWxkcmVuLnB1c2goY2hpbGQpO1xuICB9XG5cbiAgcHVibGljIHJlbW92ZUNoaWxkKG9sZENoaWxkOiBEYXRhRmxvd05vZGUpIHtcbiAgICB0aGlzLl9jaGlsZHJlbi5zcGxpY2UodGhpcy5fY2hpbGRyZW4uaW5kZXhPZihvbGRDaGlsZCksIDEpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBub2RlIGZyb20gdGhlIGRhdGFmbG93LlxuICAgKi9cbiAgcHVibGljIHJlbW92ZSgpIHtcbiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRoaXMuX2NoaWxkcmVuKSB7XG4gICAgICBjaGlsZC5wYXJlbnQgPSB0aGlzLl9wYXJlbnQ7XG4gICAgfVxuICAgIHRoaXMuX3BhcmVudC5yZW1vdmVDaGlsZCh0aGlzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbnNlcnQgYW5vdGhlciBub2RlIGFzIGEgcGFyZW50IG9mIHRoaXMgbm9kZS5cbiAgICovXG4gIHB1YmxpYyBpbnNlcnRBc1BhcmVudE9mKG90aGVyOiBEYXRhRmxvd05vZGUpIHtcbiAgICBjb25zdCBwYXJlbnQgPSBvdGhlci5wYXJlbnQ7XG4gICAgcGFyZW50LnJlbW92ZUNoaWxkKHRoaXMpO1xuICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgIG90aGVyLnBhcmVudCA9IHRoaXM7XG4gIH1cblxuICBwdWJsaWMgc3dhcFdpdGhQYXJlbnQoKSB7XG4gICAgY29uc3QgcGFyZW50ID0gdGhpcy5fcGFyZW50O1xuICAgIGNvbnN0IG5ld1BhcmVudCA9IHBhcmVudC5wYXJlbnQ7XG5cbiAgICAvLyByZWNvbm5lY3QgdGhlIGNoaWxkcmVuXG4gICAgZm9yIChjb25zdCBjaGlsZCBvZiB0aGlzLl9jaGlsZHJlbikge1xuICAgICAgY2hpbGQucGFyZW50ID0gcGFyZW50O1xuICAgIH1cblxuICAgIC8vIHJlbW92ZSBvbGQgbGlua3NcbiAgICB0aGlzLl9jaGlsZHJlbiA9IFtdOyAgLy8gZXF1aXZhbGVudCB0byByZW1vdmluZyBldmVyeSBjaGlsZCBsaW5rIG9uZSBieSBvbmVcbiAgICBwYXJlbnQucmVtb3ZlQ2hpbGQodGhpcyk7XG4gICAgcGFyZW50LnBhcmVudC5yZW1vdmVDaGlsZChwYXJlbnQpO1xuXG5cbiAgICAvLyBzd2FwIHR3byBub2Rlc1xuICAgIHRoaXMucGFyZW50ID0gbmV3UGFyZW50O1xuICAgIHBhcmVudC5wYXJlbnQgPSB0aGlzO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBPdXRwdXROb2RlIGV4dGVuZHMgRGF0YUZsb3dOb2RlIHtcbiAgcHJpdmF0ZSBfc291cmNlOiBzdHJpbmc7XG5cbiAgcHJpdmF0ZSBfbmFtZTogc3RyaW5nO1xuXG4gIHB1YmxpYyBjbG9uZSgpOiB0aGlzIHtcbiAgICBjb25zdCBjbG9uZU9iaiA9IG5ldyAoPGFueT50aGlzLmNvbnN0cnVjdG9yKTtcbiAgICBjbG9uZU9iai5kZWJ1Z05hbWUgPSAnY2xvbmVfJyArIHRoaXMuZGVidWdOYW1lO1xuICAgIGNsb25lT2JqLl9zb3VyY2UgPSB0aGlzLl9zb3VyY2U7XG4gICAgY2xvbmVPYmouX25hbWUgPSAnY2xvbmVfJyArIHRoaXMuX25hbWU7XG4gICAgY2xvbmVPYmoudHlwZSA9IHRoaXMudHlwZTtcbiAgICBjbG9uZU9iai5yZWZDb3VudHMgPSB0aGlzLnJlZkNvdW50cztcbiAgICBjbG9uZU9iai5yZWZDb3VudHNbY2xvbmVPYmouX25hbWVdID0gMDtcbiAgICByZXR1cm4gY2xvbmVPYmo7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIHNvdXJjZSBUaGUgbmFtZSBvZiB0aGUgc291cmNlLiBXaWxsIGNoYW5nZSBpbiBhc3NlbWJsZS5cbiAgICogQHBhcmFtIHR5cGUgVGhlIHR5cGUgb2YgdGhlIG91dHB1dCBub2RlLlxuICAgKiBAcGFyYW0gcmVmQ291bnRzIEEgZ2xvYmFsIHJlZiBjb3VudGVyIG1hcC5cbiAgICovXG4gIGNvbnN0cnVjdG9yKHBhcmVudDogRGF0YUZsb3dOb2RlLCBzb3VyY2U6IHN0cmluZywgcHVibGljIHJlYWRvbmx5IHR5cGU6IERhdGFTb3VyY2VUeXBlLCBwcml2YXRlIHJlYWRvbmx5IHJlZkNvdW50czogRGljdDxudW1iZXI+KSB7XG4gICAgc3VwZXIocGFyZW50LCBzb3VyY2UpO1xuXG4gICAgdGhpcy5fc291cmNlID0gdGhpcy5fbmFtZSA9IHNvdXJjZTtcblxuICAgIGlmICh0aGlzLnJlZkNvdW50cyAmJiAhKHRoaXMuX25hbWUgaW4gdGhpcy5yZWZDb3VudHMpKSB7XG4gICAgICB0aGlzLnJlZkNvdW50c1t0aGlzLl9uYW1lXSA9IDA7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlcXVlc3QgdGhlIGRhdGFzb3VyY2UgbmFtZSBhbmQgaW5jcmVhc2UgdGhlIHJlZiBjb3VudGVyLlxuICAgKlxuICAgKiBEdXJpbmcgdGhlIHBhcnNpbmcgcGhhc2UsIHRoaXMgd2lsbCByZXR1cm4gdGhlIHNpbXBsZSBuYW1lIHN1Y2ggYXMgJ21haW4nIG9yICdyYXcnLlxuICAgKiBJdCBpcyBjcnVjaWFsIHRvIHJlcXVlc3QgdGhlIG5hbWUgZnJvbSBhbiBvdXRwdXQgbm9kZSB0byBtYXJrIGl0IGFzIGEgcmVxdWlyZWQgbm9kZS5cbiAgICogSWYgbm9ib2R5IGV2ZXIgcmVxdWVzdHMgdGhlIG5hbWUsIHRoaXMgZGF0YXNvdXJjZSB3aWxsIG5vdCBiZSBpbnN0YW50aWF0ZWQgaW4gdGhlIGFzc2VtYmxlIHBoYXNlLlxuICAgKlxuICAgKiBJbiB0aGUgYXNzZW1ibGUgcGhhc2UsIHRoaXMgd2lsbCByZXR1cm4gdGhlIGNvcnJlY3QgbmFtZS5cbiAgICovXG4gIHB1YmxpYyBnZXRTb3VyY2UoKSB7XG4gICAgdGhpcy5yZWZDb3VudHNbdGhpcy5fbmFtZV0rKztcbiAgICByZXR1cm4gdGhpcy5fc291cmNlO1xuICB9XG5cbiAgcHVibGljIGlzUmVxdWlyZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICEhdGhpcy5yZWZDb3VudHNbdGhpcy5fbmFtZV07XG4gIH1cblxuICBwdWJsaWMgc2V0U291cmNlKHNvdXJjZTogc3RyaW5nKSB7XG4gICAgdGhpcy5fc291cmNlID0gc291cmNlO1xuICB9XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { isScaleFieldDef, vgField } from '../../fielddef';\nimport { isSortArray } from '../../sort';\nimport { duplicate } from '../../util';\nimport { DataFlowNode } from './dataflow';\n/**\n * We don't know what a calculate node depends on so we should never move it beyond anything that produces fields.\n */\nvar CalculateNode = /** @class */ (function (_super) {\n    tslib_1.__extends(CalculateNode, _super);\n    function CalculateNode(parent, transform) {\n        var _this = _super.call(this, parent) || this;\n        _this.transform = transform;\n        return _this;\n    }\n    CalculateNode.prototype.clone = function () {\n        return new CalculateNode(null, duplicate(this.transform));\n    };\n    CalculateNode.parseAllForSortIndex = function (parent, model) {\n        // get all the encoding with sort fields from model\n        model.forEachFieldDef(function (fieldDef, channel) {\n            if (isScaleFieldDef(fieldDef) && isSortArray(fieldDef.sort)) {\n                var transform = {\n                    calculate: CalculateNode.calculateExpressionFromSortField(fieldDef.field, fieldDef.sort),\n                    as: sortArrayIndexField(model, channel)\n                };\n                parent = new CalculateNode(parent, transform);\n            }\n        });\n        return parent;\n    };\n    CalculateNode.calculateExpressionFromSortField = function (field, sortFields) {\n        var expression = '';\n        var i;\n        for (i = 0; i < sortFields.length; i++) {\n            expression += \"datum.\" + field + \" === '\" + sortFields[i] + \"' ? \" + i + \" : \";\n        }\n        expression += i;\n        return expression;\n    };\n    CalculateNode.prototype.producedFields = function () {\n        var out = {};\n        out[this.transform.as] = true;\n        return out;\n    };\n    CalculateNode.prototype.assemble = function () {\n        return {\n            type: 'formula',\n            expr: this.transform.calculate,\n            as: this.transform.as\n        };\n    };\n    return CalculateNode;\n}(DataFlowNode));\nexport { CalculateNode };\nexport function sortArrayIndexField(model, channel) {\n    var fieldDef = model.fieldDef(channel);\n    return channel + \"_\" + vgField(fieldDef) + \"_sort_index\";\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2FsY3VsYXRlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvZGF0YS9jYWxjdWxhdGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBQyxlQUFlLEVBQWlCLE9BQU8sRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ3ZFLE9BQU8sRUFBQyxXQUFXLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDdkMsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLFlBQVksQ0FBQztBQUtyQyxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBRXhDOztHQUVHO0FBQ0g7SUFBbUMseUNBQVk7SUFLN0MsdUJBQVksTUFBb0IsRUFBVSxTQUE2QjtRQUF2RSxZQUNFLGtCQUFNLE1BQU0sQ0FBQyxTQUNkO1FBRnlDLGVBQVMsR0FBVCxTQUFTLENBQW9COztJQUV2RSxDQUFDO0lBTk0sNkJBQUssR0FBWjtRQUNFLE9BQU8sSUFBSSxhQUFhLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQztJQUM1RCxDQUFDO0lBTWEsa0NBQW9CLEdBQWxDLFVBQW1DLE1BQW9CLEVBQUUsS0FBcUI7UUFDNUUsbURBQW1EO1FBQ25ELEtBQUssQ0FBQyxlQUFlLENBQUMsVUFBQyxRQUErQixFQUFFLE9BQXlCO1lBQy9FLElBQUksZUFBZSxDQUFDLFFBQVEsQ0FBQyxJQUFJLFdBQVcsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUU7Z0JBQzNELElBQU0sU0FBUyxHQUF1QjtvQkFDcEMsU0FBUyxFQUFFLGFBQWEsQ0FBQyxnQ0FBZ0MsQ0FBQyxRQUFRLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxJQUFJLENBQUM7b0JBQ3hGLEVBQUUsRUFBRSxtQkFBbUIsQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDO2lCQUN4QyxDQUFDO2dCQUNGLE1BQU0sR0FBRyxJQUFJLGFBQWEsQ0FBQyxNQUFNLEVBQUUsU0FBUyxDQUFDLENBQUM7YUFDL0M7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUNILE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7SUFFYSw4Q0FBZ0MsR0FBOUMsVUFBK0MsS0FBYSxFQUFFLFVBQW9CO1FBQ2hGLElBQUksVUFBVSxHQUFHLEVBQUUsQ0FBQztRQUNwQixJQUFJLENBQVMsQ0FBQztRQUNkLEtBQUssQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsVUFBVSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUN0QyxVQUFVLElBQUksV0FBUyxLQUFLLGNBQVMsVUFBVSxDQUFDLENBQUMsQ0FBQyxZQUFPLENBQUMsUUFBSyxDQUFDO1NBQ2pFO1FBQ0QsVUFBVSxJQUFJLENBQUMsQ0FBQztRQUNoQixPQUFPLFVBQVUsQ0FBQztJQUNwQixDQUFDO0lBRU0sc0NBQWMsR0FBckI7UUFDRSxJQUFNLEdBQUcsR0FBRyxFQUFFLENBQUM7UUFDZixHQUFHLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUM7UUFDOUIsT0FBTyxHQUFHLENBQUM7SUFDYixDQUFDO0lBRU0sZ0NBQVEsR0FBZjtRQUNFLE9BQU87WUFDTCxJQUFJLEVBQUUsU0FBUztZQUNmLElBQUksRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVM7WUFDOUIsRUFBRSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRTtTQUN0QixDQUFDO0lBQ0osQ0FBQztJQUNILG9CQUFDO0FBQUQsQ0FBQyxBQTlDRCxDQUFtQyxZQUFZLEdBOEM5Qzs7QUFFRCxNQUFNLDhCQUE4QixLQUFxQixFQUFFLE9BQXlCO0lBQ2xGLElBQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDekMsT0FBVSxPQUFPLFNBQUksT0FBTyxDQUFDLFFBQVEsQ0FBQyxnQkFBYSxDQUFDO0FBQ3RELENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2lzU2NhbGVGaWVsZERlZiwgU2NhbGVGaWVsZERlZiwgdmdGaWVsZH0gZnJvbSAnLi4vLi4vZmllbGRkZWYnO1xuaW1wb3J0IHtpc1NvcnRBcnJheX0gZnJvbSAnLi4vLi4vc29ydCc7XG5pbXBvcnQge2R1cGxpY2F0ZX0gZnJvbSAnLi4vLi4vdXRpbCc7XG5pbXBvcnQge1ZnRm9ybXVsYVRyYW5zZm9ybX0gZnJvbSAnLi4vLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtNb2RlbFdpdGhGaWVsZH0gZnJvbSAnLi4vbW9kZWwnO1xuaW1wb3J0IHtTaW5nbGVEZWZDaGFubmVsfSBmcm9tICcuLy4uLy4uL2NoYW5uZWwnO1xuaW1wb3J0IHtDYWxjdWxhdGVUcmFuc2Zvcm19IGZyb20gJy4vLi4vLi4vdHJhbnNmb3JtJztcbmltcG9ydCB7RGF0YUZsb3dOb2RlfSBmcm9tICcuL2RhdGFmbG93JztcblxuLyoqXG4gKiBXZSBkb24ndCBrbm93IHdoYXQgYSBjYWxjdWxhdGUgbm9kZSBkZXBlbmRzIG9uIHNvIHdlIHNob3VsZCBuZXZlciBtb3ZlIGl0IGJleW9uZCBhbnl0aGluZyB0aGF0IHByb2R1Y2VzIGZpZWxkcy5cbiAqL1xuZXhwb3J0IGNsYXNzIENhbGN1bGF0ZU5vZGUgZXh0ZW5kcyBEYXRhRmxvd05vZGUge1xuICBwdWJsaWMgY2xvbmUoKSB7XG4gICAgcmV0dXJuIG5ldyBDYWxjdWxhdGVOb2RlKG51bGwsIGR1cGxpY2F0ZSh0aGlzLnRyYW5zZm9ybSkpO1xuICB9XG5cbiAgY29uc3RydWN0b3IocGFyZW50OiBEYXRhRmxvd05vZGUsIHByaXZhdGUgdHJhbnNmb3JtOiBDYWxjdWxhdGVUcmFuc2Zvcm0pIHtcbiAgICBzdXBlcihwYXJlbnQpO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBwYXJzZUFsbEZvclNvcnRJbmRleChwYXJlbnQ6IERhdGFGbG93Tm9kZSwgbW9kZWw6IE1vZGVsV2l0aEZpZWxkKSB7XG4gICAgLy8gZ2V0IGFsbCB0aGUgZW5jb2Rpbmcgd2l0aCBzb3J0IGZpZWxkcyBmcm9tIG1vZGVsXG4gICAgbW9kZWwuZm9yRWFjaEZpZWxkRGVmKChmaWVsZERlZjogU2NhbGVGaWVsZERlZjxzdHJpbmc+LCBjaGFubmVsOiBTaW5nbGVEZWZDaGFubmVsKSA9PiB7XG4gICAgICBpZiAoaXNTY2FsZUZpZWxkRGVmKGZpZWxkRGVmKSAmJiBpc1NvcnRBcnJheShmaWVsZERlZi5zb3J0KSkge1xuICAgICAgICBjb25zdCB0cmFuc2Zvcm06IENhbGN1bGF0ZVRyYW5zZm9ybSA9IHtcbiAgICAgICAgICBjYWxjdWxhdGU6IENhbGN1bGF0ZU5vZGUuY2FsY3VsYXRlRXhwcmVzc2lvbkZyb21Tb3J0RmllbGQoZmllbGREZWYuZmllbGQsIGZpZWxkRGVmLnNvcnQpLFxuICAgICAgICAgIGFzOiBzb3J0QXJyYXlJbmRleEZpZWxkKG1vZGVsLCBjaGFubmVsKVxuICAgICAgICB9O1xuICAgICAgICBwYXJlbnQgPSBuZXcgQ2FsY3VsYXRlTm9kZShwYXJlbnQsIHRyYW5zZm9ybSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHBhcmVudDtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgY2FsY3VsYXRlRXhwcmVzc2lvbkZyb21Tb3J0RmllbGQoZmllbGQ6IHN0cmluZywgc29ydEZpZWxkczogc3RyaW5nW10pOiBzdHJpbmcge1xuICAgIGxldCBleHByZXNzaW9uID0gJyc7XG4gICAgbGV0IGk6IG51bWJlcjtcbiAgICBmb3IgKGkgPSAwOyBpIDwgc29ydEZpZWxkcy5sZW5ndGg7IGkrKykge1xuICAgICAgZXhwcmVzc2lvbiArPSBgZGF0dW0uJHtmaWVsZH0gPT09ICcke3NvcnRGaWVsZHNbaV19JyA/ICR7aX0gOiBgO1xuICAgIH1cbiAgICBleHByZXNzaW9uICs9IGk7XG4gICAgcmV0dXJuIGV4cHJlc3Npb247XG4gIH1cblxuICBwdWJsaWMgcHJvZHVjZWRGaWVsZHMoKSB7XG4gICAgY29uc3Qgb3V0ID0ge307XG4gICAgb3V0W3RoaXMudHJhbnNmb3JtLmFzXSA9IHRydWU7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuXG4gIHB1YmxpYyBhc3NlbWJsZSgpOiBWZ0Zvcm11bGFUcmFuc2Zvcm0ge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnZm9ybXVsYScsXG4gICAgICBleHByOiB0aGlzLnRyYW5zZm9ybS5jYWxjdWxhdGUsXG4gICAgICBhczogdGhpcy50cmFuc2Zvcm0uYXNcbiAgICB9O1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzb3J0QXJyYXlJbmRleEZpZWxkKG1vZGVsOiBNb2RlbFdpdGhGaWVsZCwgY2hhbm5lbDogU2luZ2xlRGVmQ2hhbm5lbCkge1xuICBjb25zdCBmaWVsZERlZiA9IG1vZGVsLmZpZWxkRGVmKGNoYW5uZWwpO1xuICByZXR1cm4gYCR7Y2hhbm5lbH1fJHt2Z0ZpZWxkKGZpZWxkRGVmKX1fc29ydF9pbmRleGA7XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { isScaleChannel } from '../../channel';\nimport { vgField } from '../../fielddef';\nimport * as log from '../../log';\nimport { differ, duplicate, keys } from '../../util';\nimport { binRequiresRange } from '../common';\nimport { DataFlowNode } from './dataflow';\nfunction addDimension(dims, channel, fieldDef) {\n    if (fieldDef.bin) {\n        dims[vgField(fieldDef, {})] = true;\n        dims[vgField(fieldDef, { binSuffix: 'end' })] = true;\n        if (binRequiresRange(fieldDef, channel)) {\n            dims[vgField(fieldDef, { binSuffix: 'range' })] = true;\n        }\n    }\n    else {\n        dims[vgField(fieldDef)] = true;\n    }\n    return dims;\n}\nfunction mergeMeasures(parentMeasures, childMeasures) {\n    for (var f in childMeasures) {\n        if (childMeasures.hasOwnProperty(f)) {\n            // when we merge a measure, we either have to add an aggregation operator or even a new field\n            var ops = childMeasures[f];\n            for (var op in ops) {\n                if (ops.hasOwnProperty(op)) {\n                    if (f in parentMeasures) {\n                        // add operator to existing measure field\n                        parentMeasures[f][op] = ops[op];\n                    }\n                    else {\n                        parentMeasures[f] = { op: ops[op] };\n                    }\n                }\n            }\n        }\n    }\n}\nvar AggregateNode = /** @class */ (function (_super) {\n    tslib_1.__extends(AggregateNode, _super);\n    /**\n     * @param dimensions string set for dimensions\n     * @param measures dictionary mapping field name => dict of aggregation functions and names to use\n     */\n    function AggregateNode(parent, dimensions, measures) {\n        var _this = _super.call(this, parent) || this;\n        _this.dimensions = dimensions;\n        _this.measures = measures;\n        return _this;\n    }\n    AggregateNode.prototype.clone = function () {\n        return new AggregateNode(null, tslib_1.__assign({}, this.dimensions), duplicate(this.measures));\n    };\n    AggregateNode.makeFromEncoding = function (parent, model) {\n        var isAggregate = false;\n        model.forEachFieldDef(function (fd) {\n            if (fd.aggregate) {\n                isAggregate = true;\n            }\n        });\n        var meas = {};\n        var dims = {};\n        if (!isAggregate) {\n            // no need to create this node if the model has no aggregation\n            return null;\n        }\n        model.forEachFieldDef(function (fieldDef, channel) {\n            var aggregate = fieldDef.aggregate, field = fieldDef.field;\n            if (aggregate) {\n                if (aggregate === 'count') {\n                    meas['*'] = meas['*'] || {};\n                    meas['*']['count'] = vgField(fieldDef);\n                }\n                else {\n                    meas[field] = meas[field] || {};\n                    meas[field][aggregate] = vgField(fieldDef);\n                    // For scale channel with domain === 'unaggregated', add min/max so we can use their union as unaggregated domain\n                    if (isScaleChannel(channel) && model.scaleDomain(channel) === 'unaggregated') {\n                        meas[field]['min'] = vgField({ field: field, aggregate: 'min' });\n                        meas[field]['max'] = vgField({ field: field, aggregate: 'max' });\n                    }\n                }\n            }\n            else {\n                addDimension(dims, channel, fieldDef);\n            }\n        });\n        if ((keys(dims).length + keys(meas).length) === 0) {\n            return null;\n        }\n        return new AggregateNode(parent, dims, meas);\n    };\n    AggregateNode.makeFromTransform = function (parent, t) {\n        var dims = {};\n        var meas = {};\n        for (var _i = 0, _a = t.aggregate; _i < _a.length; _i++) {\n            var s = _a[_i];\n            var op = s.op, field = s.field, as = s.as;\n            if (op) {\n                if (op === 'count') {\n                    meas['*'] = meas['*'] || {};\n                    meas['*']['count'] = as || vgField(s);\n                }\n                else {\n                    meas[field] = meas[field] || {};\n                    meas[field][op] = as || vgField(s);\n                }\n            }\n        }\n        for (var _b = 0, _c = t.groupby || []; _b < _c.length; _b++) {\n            var s = _c[_b];\n            dims[s] = true;\n        }\n        if ((keys(dims).length + keys(meas).length) === 0) {\n            return null;\n        }\n        return new AggregateNode(parent, dims, meas);\n    };\n    AggregateNode.prototype.merge = function (other) {\n        if (!differ(this.dimensions, other.dimensions)) {\n            mergeMeasures(this.measures, other.measures);\n            other.remove();\n        }\n        else {\n            log.debug('different dimensions, cannot merge');\n        }\n    };\n    AggregateNode.prototype.addDimensions = function (fields) {\n        var _this = this;\n        fields.forEach(function (f) { return _this.dimensions[f] = true; });\n    };\n    AggregateNode.prototype.dependentFields = function () {\n        var out = {};\n        keys(this.dimensions).forEach(function (f) { return out[f] = true; });\n        keys(this.measures).forEach(function (m) { return out[m] = true; });\n        return out;\n    };\n    AggregateNode.prototype.producedFields = function () {\n        var _this = this;\n        var out = {};\n        keys(this.measures).forEach(function (field) {\n            keys(_this.measures[field]).forEach(function (op) {\n                out[op + \"_\" + field] = true;\n            });\n        });\n        return out;\n    };\n    AggregateNode.prototype.assemble = function () {\n        var ops = [];\n        var fields = [];\n        var as = [];\n        for (var _i = 0, _a = keys(this.measures); _i < _a.length; _i++) {\n            var field = _a[_i];\n            for (var _b = 0, _c = keys(this.measures[field]); _b < _c.length; _b++) {\n                var op = _c[_b];\n                as.push(this.measures[field][op]);\n                ops.push(op);\n                fields.push(field);\n            }\n        }\n        var result = {\n            type: 'aggregate',\n            groupby: keys(this.dimensions),\n            ops: ops,\n            fields: fields,\n            as: as\n        };\n        return result;\n    };\n    return AggregateNode;\n}(DataFlowNode));\nexport { AggregateNode };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWdncmVnYXRlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvZGF0YS9hZ2dyZWdhdGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUVBLE9BQU8sRUFBVSxjQUFjLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDdEQsT0FBTyxFQUFXLE9BQU8sRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ2pELE9BQU8sS0FBSyxHQUFHLE1BQU0sV0FBVyxDQUFDO0FBRWpDLE9BQU8sRUFBTyxNQUFNLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBWSxNQUFNLFlBQVksQ0FBQztBQUVwRSxPQUFPLEVBQUMsZ0JBQWdCLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFFM0MsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLFlBQVksQ0FBQztBQUV4QyxzQkFBc0IsSUFBZ0MsRUFBRSxPQUFnQixFQUFFLFFBQTBCO0lBQ2xHLElBQUksUUFBUSxDQUFDLEdBQUcsRUFBRTtRQUNoQixJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxFQUFFLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQztRQUNuQyxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxFQUFDLFNBQVMsRUFBRSxLQUFLLEVBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDO1FBRW5ELElBQUksZ0JBQWdCLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxFQUFFO1lBQ3ZDLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFFLEVBQUMsU0FBUyxFQUFFLE9BQU8sRUFBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUM7U0FDdEQ7S0FDRjtTQUFNO1FBQ0wsSUFBSSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQztLQUNoQztJQUNELE9BQU8sSUFBSSxDQUFDO0FBQ2QsQ0FBQztBQUVELHVCQUF1QixjQUFrQyxFQUFFLGFBQWlDO0lBQzFGLEtBQUss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RUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDbEMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQztnQkFDYixNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO2FBQ3BCO1NBQ0Y7UUFFRCxJQUFNLE1BQU0sR0FBeUI7WUFDbkMsSUFBSSxFQUFFLFdBQVc7WUFDakIsT0FBTyxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDO1lBQzlCLEdBQUcsS0FBQTtZQUNILE1BQU0sUUFBQTtZQUNOLEVBQUUsSUFBQTtTQUNILENBQUM7UUFFRixPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0lBQ0gsb0JBQUM7QUFBRCxDQUFDLEFBOUlELENBQW1DLFlBQVksR0E4STlDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtBZ2dyZWdhdGVPcH0gZnJvbSAndmVnYSc7XG5cbmltcG9ydCB7Q2hhbm5lbCwgaXNTY2FsZUNoYW5uZWx9IGZyb20gJy4uLy4uL2NoYW5uZWwnO1xuaW1wb3J0IHtGaWVsZERlZiwgdmdGaWVsZH0gZnJvbSAnLi4vLi4vZmllbGRkZWYnO1xuaW1wb3J0ICogYXMgbG9nIGZyb20gJy4uLy4uL2xvZyc7XG5pbXBvcnQge0FnZ3JlZ2F0ZVRyYW5zZm9ybX0gZnJvbSAnLi4vLi4vdHJhbnNmb3JtJztcbmltcG9ydCB7RGljdCwgZGlmZmVyLCBkdXBsaWNhdGUsIGtleXMsIFN0cmluZ1NldH0gZnJvbSAnLi4vLi4vdXRpbCc7XG5pbXBvcnQge1ZnQWdncmVnYXRlVHJhbnNmb3JtfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge2JpblJlcXVpcmVzUmFuZ2V9IGZyb20gJy4uL2NvbW1vbic7XG5pbXBvcnQge1VuaXRNb2RlbH0gZnJvbSAnLi8uLi91bml0JztcbmltcG9ydCB7RGF0YUZsb3dOb2RlfSBmcm9tICcuL2RhdGFmbG93JztcblxuZnVuY3Rpb24gYWRkRGltZW5zaW9uKGRpbXM6IHtbZmllbGQ6IHN0cmluZ106IGJvb2xlYW59LCBjaGFubmVsOiBDaGFubmVsLCBmaWVsZERlZjogRmllbGREZWY8c3RyaW5nPikge1xuICBpZiAoZmllbGREZWYuYmluKSB7XG4gICAgZGltc1t2Z0ZpZWxkKGZpZWxkRGVmLCB7fSldID0gdHJ1ZTtcbiAgICBkaW1zW3ZnRmllbGQoZmllbGREZWYsIHtiaW5TdWZmaXg6ICdlbmQnfSldID0gdHJ1ZTtcblxuICAgIGlmIChiaW5SZXF1aXJlc1JhbmdlKGZpZWxkRGVmLCBjaGFubmVsKSkge1xuICAgICAgZGltc1t2Z0ZpZWxkKGZpZWxkRGVmLCB7YmluU3VmZml4OiAncmFuZ2UnfSldID0gdHJ1ZTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgZGltc1t2Z0ZpZWxkKGZpZWxkRGVmKV0gPSB0cnVlO1xuICB9XG4gIHJldHVybiBkaW1zO1xufVxuXG5mdW5jdGlvbiBtZXJnZU1lYXN1cmVzKHBhcmVudE1lYXN1cmVzOiBEaWN0PERpY3Q8c3RyaW5nPj4sIGNoaWxkTWVhc3VyZXM6IERpY3Q8RGljdDxzdHJpbmc+Pikge1xuICBmb3IgKGNvbnN0IGYgaW4gY2hpbGRNZWFzdXJlcykge1xuICAgIGlmIChjaGlsZE1lYXN1cmVzLmhhc093blByb3BlcnR5KGYpKSB7XG4gICAgICAvLyB3aGVuIHdlIG1lcmdlIGEgbWVhc3VyZSwgd2UgZWl0aGVyIGhhdmUgdG8gYWRkIGFuIGFnZ3JlZ2F0aW9uIG9wZXJhdG9yIG9yIGV2ZW4gYSBuZXcgZmllbGRcbiAgICAgIGNvbnN0IG9wcyA9IGNoaWxkTWVhc3VyZXNbZl07XG4gICAgICBmb3IgKGNvbnN0IG9wIGluIG9wcykge1xuICAgICAgICBpZiAob3BzLmhhc093blByb3BlcnR5KG9wKSkge1xuICAgICAgICAgIGlmIChmIGluIHBhcmVudE1lYXN1cmVzKSB7XG4gICAgICAgICAgICAvLyBhZGQgb3BlcmF0b3IgdG8gZXhpc3RpbmcgbWVhc3VyZSBmaWVsZFxuICAgICAgICAgICAgcGFyZW50TWVhc3VyZXNbZl1bb3BdID0gb3BzW29wXTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcGFyZW50TWVhc3VyZXNbZl0gPSB7b3A6IG9wc1tvcF19O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQWdncmVnYXRlTm9kZSBleHRlbmRzIERhdGFGbG93Tm9kZSB7XG4gIHB1YmxpYyBjbG9uZSgpIHtcbiAgICByZXR1cm4gbmV3IEFnZ3JlZ2F0ZU5vZGUobnVsbCwgey4uLnRoaXMuZGltZW5zaW9uc30sIGR1cGxpY2F0ZSh0aGlzLm1lYXN1cmVzKSk7XG4gIH1cblxuICAvKipcbiAgICogQHBhcmFtIGRpbWVuc2lvbnMgc3RyaW5nIHNldCBmb3IgZGltZW5zaW9uc1xuICAgKiBAcGFyYW0gbWVhc3VyZXMgZGljdGlvbmFyeSBtYXBwaW5nIGZpZWxkIG5hbWUgPT4gZGljdCBvZiBhZ2dyZWdhdGlvbiBmdW5jdGlvbnMgYW5kIG5hbWVzIHRvIHVzZVxuICAgKi9cbiAgY29uc3RydWN0b3IocGFyZW50OiBEYXRhRmxvd05vZGUsIHByaXZhdGUgZGltZW5zaW9uczogU3RyaW5nU2V0LCBwcml2YXRlIG1lYXN1cmVzOiBEaWN0PHtba2V5IGluIEFnZ3JlZ2F0ZU9wXT86IHN0cmluZ30+KSB7XG4gICAgc3VwZXIocGFyZW50KTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgbWFrZUZyb21FbmNvZGluZyhwYXJlbnQ6IERhdGFGbG93Tm9kZSwgbW9kZWw6IFVuaXRNb2RlbCk6IEFnZ3JlZ2F0ZU5vZGUge1xuICAgIGxldCBpc0FnZ3JlZ2F0ZSA9IGZhbHNlO1xuICAgIG1vZGVsLmZvckVhY2hGaWVsZERlZihmZCA9PiB7XG4gICAgICBpZiAoZmQuYWdncmVnYXRlKSB7XG4gICAgICAgIGlzQWdncmVnYXRlID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IG1lYXMgPSB7fTtcbiAgICBjb25zdCBkaW1zID0ge307XG5cbiAgICBpZiAoIWlzQWdncmVnYXRlKSB7XG4gICAgICAvLyBubyBuZWVkIHRvIGNyZWF0ZSB0aGlzIG5vZGUgaWYgdGhlIG1vZGVsIGhhcyBubyBhZ2dyZWdhdGlvblxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgbW9kZWwuZm9yRWFjaEZpZWxkRGVmKChmaWVsZERlZiwgY2hhbm5lbCkgPT4ge1xuICAgICAgY29uc3Qge2FnZ3JlZ2F0ZSwgZmllbGR9ID0gZmllbGREZWY7XG4gICAgICBpZiAoYWdncmVnYXRlKSB7XG4gICAgICAgIGlmIChhZ2dyZWdhdGUgPT09ICdjb3VudCcpIHtcbiAgICAgICAgICBtZWFzWycqJ10gPSBtZWFzWycqJ10gfHwge307XG4gICAgICAgICAgbWVhc1snKiddWydjb3VudCddID0gdmdGaWVsZChmaWVsZERlZik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbWVhc1tmaWVsZF0gPSBtZWFzW2ZpZWxkXSB8fCB7fTtcbiAgICAgICAgICBtZWFzW2ZpZWxkXVthZ2dyZWdhdGVdID0gdmdGaWVsZChmaWVsZERlZik7XG5cbiAgICAgICAgICAvLyBGb3Igc2NhbGUgY2hhbm5lbCB3aXRoIGRvbWFpbiA9PT0gJ3VuYWdncmVnYXRlZCcsIGFkZCBtaW4vbWF4IHNvIHdlIGNhbiB1c2UgdGhlaXIgdW5pb24gYXMgdW5hZ2dyZWdhdGVkIGRvbWFpblxuICAgICAgICAgIGlmIChpc1NjYWxlQ2hhbm5lbChjaGFubmVsKSAmJiBtb2RlbC5zY2FsZURvbWFpbihjaGFubmVsKSA9PT0gJ3VuYWdncmVnYXRlZCcpIHtcbiAgICAgICAgICAgIG1lYXNbZmllbGRdWydtaW4nXSA9IHZnRmllbGQoe2ZpZWxkLCBhZ2dyZWdhdGU6ICdtaW4nfSk7XG4gICAgICAgICAgICBtZWFzW2ZpZWxkXVsnbWF4J10gPSB2Z0ZpZWxkKHtmaWVsZCwgYWdncmVnYXRlOiAnbWF4J30pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYWRkRGltZW5zaW9uKGRpbXMsIGNoYW5uZWwsIGZpZWxkRGVmKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmICgoa2V5cyhkaW1zKS5sZW5ndGggKyBrZXlzKG1lYXMpLmxlbmd0aCkgPT09IDApIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgQWdncmVnYXRlTm9kZShwYXJlbnQsIGRpbXMsIG1lYXMpO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBtYWtlRnJvbVRyYW5zZm9ybShwYXJlbnQ6IERhdGFGbG93Tm9kZSwgdDogQWdncmVnYXRlVHJhbnNmb3JtKTogQWdncmVnYXRlTm9kZSB7XG4gICAgY29uc3QgZGltcyA9IHt9O1xuICAgIGNvbnN0IG1lYXMgPSB7fTtcblxuICAgIGZvciAoY29uc3QgcyBvZiB0LmFnZ3JlZ2F0ZSkge1xuICAgICAgY29uc3Qge29wLCBmaWVsZCwgYXN9ID0gcztcbiAgICAgIGlmIChvcCkge1xuICAgICAgICBpZiAob3AgPT09ICdjb3VudCcpIHtcbiAgICAgICAgICBtZWFzWycqJ10gPSBtZWFzWycqJ10gfHwge307XG4gICAgICAgICAgbWVhc1snKiddWydjb3VudCddID0gYXMgfHwgdmdGaWVsZChzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBtZWFzW2ZpZWxkXSA9IG1lYXNbZmllbGRdIHx8IHt9O1xuICAgICAgICAgIG1lYXNbZmllbGRdW29wXSA9IGFzIHx8IHZnRmllbGQocyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IHMgb2YgdC5ncm91cGJ5IHx8IFtdKSB7XG4gICAgICBkaW1zW3NdID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAoKGtleXMoZGltcykubGVuZ3RoICsga2V5cyhtZWFzKS5sZW5ndGgpID09PSAwKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IEFnZ3JlZ2F0ZU5vZGUocGFyZW50LCBkaW1zLCBtZWFzKTtcbiAgfVxuXG4gIHB1YmxpYyBtZXJnZShvdGhlcjogQWdncmVnYXRlTm9kZSkge1xuICAgIGlmICghZGlmZmVyKHRoaXMuZGltZW5zaW9ucywgb3RoZXIuZGltZW5zaW9ucykpIHtcbiAgICAgIG1lcmdlTWVhc3VyZXModGhpcy5tZWFzdXJlcywgb3RoZXIubWVhc3VyZXMpO1xuICAgICAgb3RoZXIucmVtb3ZlKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvZy5kZWJ1ZygnZGlmZmVyZW50IGRpbWVuc2lvbnMsIGNhbm5vdCBtZXJnZScpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBhZGREaW1lbnNpb25zKGZpZWxkczogc3RyaW5nW10pIHtcbiAgICBmaWVsZHMuZm9yRWFjaChmID0+IHRoaXMuZGltZW5zaW9uc1tmXSA9IHRydWUpO1xuICB9XG5cbiAgcHVibGljIGRlcGVuZGVudEZpZWxkcygpIHtcbiAgICBjb25zdCBvdXQgPSB7fTtcblxuICAgIGtleXModGhpcy5kaW1lbnNpb25zKS5mb3JFYWNoKGYgPT4gb3V0W2ZdID0gdHJ1ZSk7XG4gICAga2V5cyh0aGlzLm1lYXN1cmVzKS5mb3JFYWNoKG0gPT4gb3V0W21dID0gdHJ1ZSk7XG5cbiAgICByZXR1cm4gb3V0O1xuICB9XG5cbiAgcHVibGljIHByb2R1Y2VkRmllbGRzKCkge1xuICAgIGNvbnN0IG91dCA9IHt9O1xuXG4gICAga2V5cyh0aGlzLm1lYXN1cmVzKS5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgIGtleXModGhpcy5tZWFzdXJlc1tmaWVsZF0pLmZvckVhY2gob3AgPT4ge1xuICAgICAgICBvdXRbYCR7b3B9XyR7ZmllbGR9YF0gPSB0cnVlO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gb3V0O1xuICB9XG5cbiAgcHVibGljIGFzc2VtYmxlKCk6IFZnQWdncmVnYXRlVHJhbnNmb3JtIHtcbiAgICBjb25zdCBvcHM6IEFnZ3JlZ2F0ZU9wW10gPSBbXTtcbiAgICBjb25zdCBmaWVsZHM6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3QgYXM6IHN0cmluZ1tdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IGZpZWxkIG9mIGtleXModGhpcy5tZWFzdXJlcykpIHtcbiAgICAgIGZvciAoY29uc3Qgb3Agb2Yga2V5cyh0aGlzLm1lYXN1cmVzW2ZpZWxkXSkpIHtcbiAgICAgICAgYXMucHVzaCh0aGlzLm1lYXN1cmVzW2ZpZWxkXVtvcF0pO1xuICAgICAgICBvcHMucHVzaChvcCk7XG4gICAgICAgIGZpZWxkcy5wdXNoKGZpZWxkKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCByZXN1bHQ6IFZnQWdncmVnYXRlVHJhbnNmb3JtID0ge1xuICAgICAgdHlwZTogJ2FnZ3JlZ2F0ZScsXG4gICAgICBncm91cGJ5OiBrZXlzKHRoaXMuZGltZW5zaW9ucyksXG4gICAgICBvcHMsXG4gICAgICBmaWVsZHMsXG4gICAgICBhc1xuICAgIH07XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { COLUMN, ROW } from '../../channel';\nimport * as log from '../../log';\nimport { hasDiscreteDomain } from '../../scale';\nimport { isVgRangeStep } from '../../vega.schema';\nimport { assembleDomain, getFieldFromDomain } from '../scale/domain';\nimport { DataFlowNode } from './dataflow';\n/**\n * A node that helps us track what fields we are faceting by.\n */\nvar FacetNode = /** @class */ (function (_super) {\n    tslib_1.__extends(FacetNode, _super);\n    /**\n     * @param model The facet model.\n     * @param name The name that this facet source will have.\n     * @param data The source data for this facet data.\n     */\n    function FacetNode(parent, model, name, data) {\n        var _this = _super.call(this, parent) || this;\n        _this.model = model;\n        _this.name = name;\n        _this.data = data;\n        if (model.facet.column) {\n            _this.columnFields = [model.vgField(COLUMN)];\n            _this.columnName = model.getName('column_domain');\n            if (model.fieldDef(COLUMN).bin) {\n                _this.columnFields.push(model.vgField(COLUMN, { binSuffix: 'end' }));\n            }\n        }\n        if (model.facet.row) {\n            _this.rowFields = [model.vgField(ROW)];\n            _this.rowName = model.getName('row_domain');\n            if (model.fieldDef(ROW).bin) {\n                _this.rowFields.push(model.vgField(ROW, { binSuffix: 'end' }));\n            }\n        }\n        _this.childModel = model.child;\n        return _this;\n    }\n    Object.defineProperty(FacetNode.prototype, \"fields\", {\n        get: function () {\n            var fields = [];\n            if (this.columnFields) {\n                fields = fields.concat(this.columnFields);\n            }\n            if (this.rowFields) {\n                fields = fields.concat(this.rowFields);\n            }\n            return fields;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * The name to reference this source is its name.\n     */\n    FacetNode.prototype.getSource = function () {\n        return this.name;\n    };\n    FacetNode.prototype.getChildIndependentFieldsWithStep = function () {\n        var childIndependentFieldsWithStep = {};\n        for (var _i = 0, _a = ['x', 'y']; _i < _a.length; _i++) {\n            var channel = _a[_i];\n            var childScaleComponent = this.childModel.component.scales[channel];\n            if (childScaleComponent && !childScaleComponent.merged) {\n                var type = childScaleComponent.get('type');\n                var range = childScaleComponent.get('range');\n                if (hasDiscreteDomain(type) && isVgRangeStep(range)) {\n                    var domain = assembleDomain(this.childModel, channel);\n                    var field = getFieldFromDomain(domain);\n                    if (field) {\n                        childIndependentFieldsWithStep[channel] = field;\n                    }\n                    else {\n                        log.warn('Unknown field for ${channel}.  Cannot calculate view size.');\n                    }\n                }\n            }\n        }\n        return childIndependentFieldsWithStep;\n    };\n    FacetNode.prototype.assembleRowColumnData = function (channel, crossedDataName, childIndependentFieldsWithStep) {\n        var aggregateChildField = {};\n        var childChannel = channel === 'row' ? 'y' : 'x';\n        if (childIndependentFieldsWithStep[childChannel]) {\n            if (crossedDataName) {\n                aggregateChildField = {\n                    // If there is a crossed data, calculate max\n                    fields: [\"distinct_\" + childIndependentFieldsWithStep[childChannel]],\n                    ops: ['max'],\n                    // Although it is technically a max, just name it distinct so it's easier to refer to it\n                    as: [\"distinct_\" + childIndependentFieldsWithStep[childChannel]]\n                };\n            }\n            else {\n                aggregateChildField = {\n                    // If there is no crossed data, just calculate distinct\n                    fields: [childIndependentFieldsWithStep[childChannel]],\n                    ops: ['distinct']\n                };\n            }\n        }\n        return {\n            name: channel === 'row' ? this.rowName : this.columnName,\n            // Use data from the crossed one if it exist\n            source: crossedDataName || this.data,\n            transform: [tslib_1.__assign({ type: 'aggregate', groupby: channel === 'row' ? this.rowFields : this.columnFields }, aggregateChildField)]\n        };\n    };\n    FacetNode.prototype.assemble = function () {\n        var data = [];\n        var crossedDataName = null;\n        var childIndependentFieldsWithStep = this.getChildIndependentFieldsWithStep();\n        if (this.columnName && this.rowName && (childIndependentFieldsWithStep.x || childIndependentFieldsWithStep.y)) {\n            // Need to create a cross dataset to correctly calculate cardinality\n            crossedDataName = \"cross_\" + this.columnName + \"_\" + this.rowName;\n            var fields = [].concat(childIndependentFieldsWithStep.x ? [childIndependentFieldsWithStep.x] : [], childIndependentFieldsWithStep.y ? [childIndependentFieldsWithStep.y] : []);\n            var ops = fields.map(function () { return 'distinct'; });\n            data.push({\n                name: crossedDataName,\n                source: this.data,\n                transform: [{\n                        type: 'aggregate',\n                        groupby: this.columnFields.concat(this.rowFields),\n                        fields: fields,\n                        ops: ops\n                    }]\n            });\n        }\n        if (this.columnName) {\n            data.push(this.assembleRowColumnData('column', crossedDataName, childIndependentFieldsWithStep));\n        }\n        if (this.rowName) {\n            data.push(this.assembleRowColumnData('row', crossedDataName, childIndependentFieldsWithStep));\n        }\n        return data;\n    };\n    return FacetNode;\n}(DataFlowNode));\nexport { FacetNode };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmFjZXQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9kYXRhL2ZhY2V0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQSxPQUFPLEVBQUMsTUFBTSxFQUFFLEdBQUcsRUFBZSxNQUFNLGVBQWUsQ0FBQztBQUN4RCxPQUFPLEtBQUssR0FBRyxNQUFNLFdBQVcsQ0FBQztBQUNqQyxPQUFPLEVBQUMsaUJBQWlCLEVBQUMsTUFBTSxhQUFhLENBQUM7QUFDOUMsT0FBTyxFQUFDLGFBQWEsRUFBK0IsTUFBTSxtQkFBbUIsQ0FBQztBQUc5RSxPQUFPLEVBQUMsY0FBYyxFQUFFLGtCQUFrQixFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFDbkUsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLFlBQVksQ0FBQztBQU94Qzs7R0FFRztBQUNIO0lBQStCLHFDQUFZO0lBU3pDOzs7O09BSUc7SUFDSCxtQkFBbUIsTUFBb0IsRUFBa0IsS0FBaUIsRUFBa0IsSUFBWSxFQUFTLElBQVk7UUFBN0gsWUFDRSxrQkFBTSxNQUFNLENBQUMsU0FtQmQ7UUFwQndELFdBQUssR0FBTCxLQUFLLENBQVk7UUFBa0IsVUFBSSxHQUFKLElBQUksQ0FBUTtRQUFTLFVBQUksR0FBSixJQUFJLENBQVE7UUFHM0gsSUFBSSxLQUFLLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRTtZQUN0QixLQUFJLENBQUMsWUFBWSxHQUFHLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1lBQzVDLEtBQUksQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQztZQUNqRCxJQUFJLEtBQUssQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsR0FBRyxFQUFFO2dCQUM5QixLQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sRUFBRSxFQUFDLFNB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QUFDO0FBQUQsQ0FBQyxBQXJKRCxDQUErQixZQUFZLEdBcUoxQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7QWdncmVnYXRlT3B9IGZyb20gJ3ZlZ2EnO1xuaW1wb3J0IHtDT0xVTU4sIFJPVywgU2NhbGVDaGFubmVsfSBmcm9tICcuLi8uLi9jaGFubmVsJztcbmltcG9ydCAqIGFzIGxvZyBmcm9tICcuLi8uLi9sb2cnO1xuaW1wb3J0IHtoYXNEaXNjcmV0ZURvbWFpbn0gZnJvbSAnLi4vLi4vc2NhbGUnO1xuaW1wb3J0IHtpc1ZnUmFuZ2VTdGVwLCBWZ0FnZ3JlZ2F0ZVRyYW5zZm9ybSwgVmdEYXRhfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge0ZhY2V0TW9kZWx9IGZyb20gJy4uL2ZhY2V0JztcbmltcG9ydCB7TW9kZWx9IGZyb20gJy4uL21vZGVsJztcbmltcG9ydCB7YXNzZW1ibGVEb21haW4sIGdldEZpZWxkRnJvbURvbWFpbn0gZnJvbSAnLi4vc2NhbGUvZG9tYWluJztcbmltcG9ydCB7RGF0YUZsb3dOb2RlfSBmcm9tICcuL2RhdGFmbG93JztcblxudHlwZSBDaGlsZEluZGVwZW5kZW50RmllbGRzV2l0aFN0ZXAgPSB7XG4gIHg/OiBzdHJpbmcsXG4gIHk/OiBzdHJpbmdcbn07XG5cbi8qKlxuICogQSBub2RlIHRoYXQgaGVscHMgdXMgdHJhY2sgd2hhdCBmaWVsZHMgd2UgYXJlIGZhY2V0aW5nIGJ5LlxuICovXG5leHBvcnQgY2xhc3MgRmFjZXROb2RlIGV4dGVuZHMgRGF0YUZsb3dOb2RlIHtcbiAgcHJpdmF0ZSByZWFkb25seSBjb2x1bW5GaWVsZHM6IHN0cmluZ1tdO1xuICBwcml2YXRlIHJlYWRvbmx5IGNvbHVtbk5hbWU6IHN0cmluZztcblxuICBwcml2YXRlIHJlYWRvbmx5IHJvd0ZpZWxkczogc3RyaW5nW107XG4gIHByaXZhdGUgcmVhZG9ubHkgcm93TmFtZTogc3RyaW5nO1xuXG4gIHByaXZhdGUgcmVhZG9ubHkgY2hpbGRNb2RlbDogTW9kZWw7XG5cbiAgLyoqXG4gICAqIEBwYXJhbSBtb2RlbCBUaGUgZmFjZXQgbW9kZWwuXG4gICAqIEBwYXJhbSBuYW1lIFRoZSBuYW1lIHRoYXQgdGhpcyBmYWNldCBzb3VyY2Ugd2lsbCBoYXZlLlxuICAgKiBAcGFyYW0gZGF0YSBUaGUgc291cmNlIGRhdGEgZm9yIHRoaXMgZmFjZXQgZGF0YS5cbiAgICovXG4gIHB1YmxpYyBjb25zdHJ1Y3RvcihwYXJlbnQ6IERhdGFGbG93Tm9kZSwgcHVibGljIHJlYWRvbmx5IG1vZGVsOiBGYWNldE1vZGVsLCBwdWJsaWMgcmVhZG9ubHkgbmFtZTogc3RyaW5nLCBwdWJsaWMgZGF0YTogc3RyaW5nKSB7XG4gICAgc3VwZXIocGFyZW50KTtcblxuICAgIGlmIChtb2RlbC5mYWNldC5jb2x1bW4pIHtcbiAgICAgIHRoaXMuY29sdW1uRmllbGRzID0gW21vZGVsLnZnRmllbGQoQ09MVU1OKV07XG4gICAgICB0aGlzLmNvbHVtbk5hbWUgPSBtb2RlbC5nZXROYW1lKCdjb2x1bW5fZG9tYWluJyk7XG4gICAgICBpZiAobW9kZWwuZmllbGREZWYoQ09MVU1OKS5iaW4pIHtcbiAgICAgICAgdGhpcy5jb2x1bW5GaWVsZHMucHVzaChtb2RlbC52Z0ZpZWxkKENPTFVNTiwge2JpblN1ZmZpeDogJ2VuZCd9KSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG1vZGVsLmZhY2V0LnJvdykge1xuICAgICAgdGhpcy5yb3dGaWVsZHMgPSBbbW9kZWwudmdGaWVsZChST1cpXTtcbiAgICAgIHRoaXMucm93TmFtZSA9IG1vZGVsLmdldE5hbWUoJ3Jvd19kb21haW4nKTtcbiAgICAgIGlmIChtb2RlbC5maWVsZERlZihST1cpLmJpbikge1xuICAgICAgICB0aGlzLnJvd0ZpZWxkcy5wdXNoKG1vZGVsLnZnRmllbGQoUk9XLCB7YmluU3VmZml4OiAnZW5kJ30pKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmNoaWxkTW9kZWwgPSBtb2RlbC5jaGlsZDtcbiAgfVxuXG4gIGdldCBmaWVsZHMoKSB7XG4gICAgbGV0IGZpZWxkczogc3RyaW5nW10gPSBbXTtcbiAgICBpZiAodGhpcy5jb2x1bW5GaWVsZHMpIHtcbiAgICAgIGZpZWxkcyA9IGZpZWxkcy5jb25jYXQodGhpcy5jb2x1bW5GaWVsZHMpO1xuICAgIH1cbiAgICBpZiAodGhpcy5yb3dGaWVsZHMpIHtcbiAgICAgIGZpZWxkcyA9IGZpZWxkcy5jb25jYXQodGhpcy5yb3dGaWVsZHMpO1xuICAgIH1cbiAgICByZXR1cm4gZmllbGRzO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBuYW1lIHRvIHJlZmVyZW5jZSB0aGlzIHNvdXJjZSBpcyBpdHMgbmFtZS5cbiAgICovXG4gIHB1YmxpYyBnZXRTb3VyY2UoKSB7XG4gICAgcmV0dXJuIHRoaXMubmFtZTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0Q2hpbGRJbmRlcGVuZGVudEZpZWxkc1dpdGhTdGVwKCkge1xuICAgIGNvbnN0IGNoaWxkSW5kZXBlbmRlbnRGaWVsZHNXaXRoU3RlcDogQ2hpbGRJbmRlcGVuZGVudEZpZWxkc1dpdGhTdGVwID0ge307XG5cbiAgICBmb3IgKGNvbnN0IGNoYW5uZWwgb2YgWyd4JywgJ3knXSBhcyBTY2FsZUNoYW5uZWxbXSkge1xuICAgICAgY29uc3QgY2hpbGRTY2FsZUNvbXBvbmVudCA9IHRoaXMuY2hpbGRNb2RlbC5jb21wb25lbnQuc2NhbGVzW2NoYW5uZWxdO1xuICAgICAgaWYgKGNoaWxkU2NhbGVDb21wb25lbnQgJiYgIWNoaWxkU2NhbGVDb21wb25lbnQubWVyZ2VkKSB7XG4gICAgICAgIGNvbnN0IHR5cGUgPSBjaGlsZFNjYWxlQ29tcG9uZW50LmdldCgndHlwZScpO1xuICAgICAgICBjb25zdCByYW5nZSA9IGNoaWxkU2NhbGVDb21wb25lbnQuZ2V0KCdyYW5nZScpO1xuXG4gICAgICAgIGlmIChoYXNEaXNjcmV0ZURvbWFpbih0eXBlKSAmJiBpc1ZnUmFuZ2VTdGVwKHJhbmdlKSkge1xuICAgICAgICAgIGNvbnN0IGRvbWFpbiA9IGFzc2VtYmxlRG9tYWluKHRoaXMuY2hpbGRNb2RlbCwgY2hhbm5lbCk7XG4gICAgICAgICAgY29uc3QgZmllbGQgPSBnZXRGaWVsZEZyb21Eb21haW4oZG9tYWluKTtcbiAgICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICAgIGNoaWxkSW5kZXBlbmRlbnRGaWVsZHNXaXRoU3RlcFtjaGFubmVsXSA9IGZpZWxkO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsb2cud2FybignVW5rbm93biBmaWVsZCBmb3IgJHtjaGFubmVsfS4gIENhbm5vdCBjYWxjdWxhdGUgdmlldyBzaXplLicpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBjaGlsZEluZGVwZW5kZW50RmllbGRzV2l0aFN0ZXA7XG4gIH1cblxuICBwcml2YXRlIGFzc2VtYmxlUm93Q29sdW1uRGF0YShjaGFubmVsOiAncm93JyB8ICdjb2x1bW4nLCBjcm9zc2VkRGF0YU5hbWU6IHN0cmluZywgY2hpbGRJbmRlcGVuZGVudEZpZWxkc1dpdGhTdGVwOiBDaGlsZEluZGVwZW5kZW50RmllbGRzV2l0aFN0ZXApOiBWZ0RhdGEge1xuICAgIGxldCBhZ2dyZWdhdGVDaGlsZEZpZWxkOiBQYXJ0aWFsPFZnQWdncmVnYXRlVHJhbnNmb3JtPiA9IHt9O1xuICAgIGNvbnN0IGNoaWxkQ2hhbm5lbCA9IGNoYW5uZWwgPT09ICdyb3cnID8gJ3knIDogJ3gnO1xuXG4gICAgaWYgKGNoaWxkSW5kZXBlbmRlbnRGaWVsZHNXaXRoU3RlcFtjaGlsZENoYW5uZWxdKSB7XG4gICAgICBpZiAoY3Jvc3NlZERhdGFOYW1lKSB7XG4gICAgICAgIGFnZ3JlZ2F0ZUNoaWxkRmllbGQgPSB7XG4gICAgICAgICAgLy8gSWYgdGhlcmUgaXMgYSBjcm9zc2VkIGRhdGEsIGNhbGN1bGF0ZSBtYXhcbiAgICAgICAgICBmaWVsZHM6IFtgZGlzdGluY3RfJHtjaGlsZEluZGVwZW5kZW50RmllbGRzV2l0aFN0ZXBbY2hpbGRDaGFubmVsXX1gXSxcbiAgICAgICAgICBvcHM6IFsnbWF4J10sXG4gICAgICAgICAgLy8gQWx0aG91Z2ggaXQgaXMgdGVjaG5pY2FsbHkgYSBtYXgsIGp1c3QgbmFtZSBpdCBkaXN0aW5jdCBzbyBpdCdzIGVhc2llciB0byByZWZlciB0byBpdFxuICAgICAgICAgIGFzOiBbYGRpc3RpbmN0XyR7Y2hpbGRJbmRlcGVuZGVudEZpZWxkc1dpdGhTdGVwW2NoaWxkQ2hhbm5lbF19YF1cbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFnZ3JlZ2F0ZUNoaWxkRmllbGQgPSB7XG4gICAgICAgICAgLy8gSWYgdGhlcmUgaXMgbm8gY3Jvc3NlZCBkYXRhLCBqdXN0IGNhbGN1bGF0ZSBkaXN0aW5jdFxuICAgICAgICAgIGZpZWxkczogW2NoaWxkSW5kZXBlbmRlbnRGaWVsZHNXaXRoU3RlcFtjaGlsZENoYW5uZWxdXSxcbiAgICAgICAgICBvcHM6IFsnZGlzdGluY3QnXVxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBjaGFubmVsID09PSAncm93JyA/IHRoaXMucm93TmFtZSA6IHRoaXMuY29sdW1uTmFtZSxcbiAgICAgIC8vIFVzZSBkYXRhIGZyb20gdGhlIGNyb3NzZWQgb25lIGlmIGl0IGV4aXN0XG4gICAgICBzb3VyY2U6IGNyb3NzZWREYXRhTmFtZSB8fCB0aGlzLmRhdGEsXG4gICAgICB0cmFuc2Zvcm06IFt7XG4gICAgICAgIHR5cGU6ICdhZ2dyZWdhdGUnLFxuICAgICAgICBncm91cGJ5OiBjaGFubmVsID09PSAncm93JyA/IHRoaXMucm93RmllbGRzIDogdGhpcy5jb2x1bW5GaWVsZHMsXG4gICAgICAgIC4uLmFnZ3JlZ2F0ZUNoaWxkRmllbGRcbiAgICAgIH1dXG4gICAgfTtcbiAgfVxuXG4gIHB1YmxpYyBhc3NlbWJsZSgpIHtcbiAgICBjb25zdCBkYXRhOiBWZ0RhdGFbXSA9IFtdO1xuICAgIGxldCBjcm9zc2VkRGF0YU5hbWUgPSBudWxsO1xuICAgIGNvbnN0IGNoaWxkSW5kZXBlbmRlbnRGaWVsZHNXaXRoU3RlcCA9IHRoaXMuZ2V0Q2hpbGRJbmRlcGVuZGVudEZpZWxkc1dpdGhTdGVwKCk7XG5cbiAgICBpZiAodGhpcy5jb2x1bW5OYW1lICYmIHRoaXMucm93TmFtZSAmJiAoY2hpbGRJbmRlcGVuZGVudEZpZWxkc1dpdGhTdGVwLnggfHwgY2hpbGRJbmRlcGVuZGVudEZpZWxkc1dpdGhTdGVwLnkpKSB7XG4gICAgICAvLyBOZWVkIHRvIGNyZWF0ZSBhIGNyb3NzIGRhdGFzZXQgdG8gY29ycmVjdGx5IGNhbGN1bGF0ZSBjYXJkaW5hbGl0eVxuICAgICAgY3Jvc3NlZERhdGFOYW1lID0gYGNyb3NzXyR7dGhpcy5jb2x1bW5OYW1lfV8ke3RoaXMucm93TmFtZX1gO1xuXG4gICAgICBjb25zdCBmaWVsZHMgPSBbXS5jb25jYXQoXG4gICAgICAgIGNoaWxkSW5kZXBlbmRlbnRGaWVsZHNXaXRoU3RlcC54ID8gW2NoaWxkSW5kZXBlbmRlbnRGaWVsZHNXaXRoU3RlcC54XSA6IFtdLFxuICAgICAgICBjaGlsZEluZGVwZW5kZW50RmllbGRzV2l0aFN0ZXAueSA/IFtjaGlsZEluZGVwZW5kZW50RmllbGRzV2l0aFN0ZXAueV0gOiBbXSxcbiAgICAgICk7XG4gICAgICBjb25zdCBvcHMgPSBmaWVsZHMubWFwKCgpOiBBZ2dyZWdhdGVPcCA9PiAnZGlzdGluY3QnKTtcblxuICAgICAgZGF0YS5wdXNoKHtcbiAgICAgICAgbmFtZTogY3Jvc3NlZERhdGFOYW1lLFxuICAgICAgICBzb3VyY2U6IHRoaXMuZGF0YSxcbiAgICAgICAgdHJhbnNmb3JtOiBbe1xuICAgICAgICAgIHR5cGU6ICdhZ2dyZWdhdGUnLFxuICAgICAgICAgIGdyb3VwYnk6IHRoaXMuY29sdW1uRmllbGRzLmNvbmNhdCh0aGlzLnJvd0ZpZWxkcyksXG4gICAgICAgICAgZmllbGRzOiBmaWVsZHMsXG4gICAgICAgICAgb3BzXG4gICAgICAgIH1dXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5jb2x1bW5OYW1lKSB7XG4gICAgICBkYXRhLnB1c2godGhpcy5hc3NlbWJsZVJvd0NvbHVtbkRhdGEoJ2NvbHVtbicsIGNyb3NzZWREYXRhTmFtZSwgY2hpbGRJbmRlcGVuZGVudEZpZWxkc1dpdGhTdGVwKSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMucm93TmFtZSkge1xuICAgICAgZGF0YS5wdXNoKHRoaXMuYXNzZW1ibGVSb3dDb2x1bW5EYXRhKCdyb3cnLCBjcm9zc2VkRGF0YU5hbWUsIGNoaWxkSW5kZXBlbmRlbnRGaWVsZHNXaXRoU3RlcCkpO1xuICAgIH1cblxuICAgIHJldHVybiBkYXRhO1xuICB9XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { isScaleChannel } from '../../channel';\nimport { vgField as fieldRef } from '../../fielddef';\nimport { isPathMark } from '../../mark';\nimport { hasContinuousDomain } from '../../scale';\nimport { keys } from '../../util';\nimport { DataFlowNode } from './dataflow';\nvar FilterInvalidNode = /** @class */ (function (_super) {\n    tslib_1.__extends(FilterInvalidNode, _super);\n    function FilterInvalidNode(parent, fieldDefs) {\n        var _this = _super.call(this, parent) || this;\n        _this.fieldDefs = fieldDefs;\n        return _this;\n    }\n    FilterInvalidNode.prototype.clone = function () {\n        return new FilterInvalidNode(null, tslib_1.__assign({}, this.fieldDefs));\n    };\n    FilterInvalidNode.make = function (parent, model) {\n        var config = model.config, mark = model.mark;\n        if (config.invalidValues !== 'filter') {\n            return null;\n        }\n        var filter = model.reduceFieldDef(function (aggregator, fieldDef, channel) {\n            var scaleComponent = isScaleChannel(channel) && model.getScaleComponent(channel);\n            if (scaleComponent) {\n                var scaleType = scaleComponent.get('type');\n                // While discrete domain scales can handle invalid values, continuous scales can't.\n                // Thus, for non-path marks, we have to filter null for scales with continuous domains.\n                // (For path marks, we will use \"defined\" property and skip these values instead.)\n                if (hasContinuousDomain(scaleType) && !fieldDef.aggregate && !isPathMark(mark)) {\n                    aggregator[fieldDef.field] = fieldDef;\n                }\n            }\n            return aggregator;\n        }, {});\n        if (!keys(filter).length) {\n            return null;\n        }\n        return new FilterInvalidNode(parent, filter);\n    };\n    Object.defineProperty(FilterInvalidNode.prototype, \"filter\", {\n        get: function () {\n            return this.fieldDefs;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // create the VgTransforms for each of the filtered fields\n    FilterInvalidNode.prototype.assemble = function () {\n        var _this = this;\n        var filters = keys(this.filter).reduce(function (vegaFilters, field) {\n            var fieldDef = _this.fieldDefs[field];\n            var ref = fieldRef(fieldDef, { expr: 'datum' });\n            if (fieldDef !== null) {\n                vegaFilters.push(ref + \" !== null\");\n                vegaFilters.push(\"!isNaN(\" + ref + \")\");\n            }\n            return vegaFilters;\n        }, []);\n        return filters.length > 0 ?\n            {\n                type: 'filter',\n                expr: filters.join(' && ')\n            } : null;\n    };\n    return FilterInvalidNode;\n}(DataFlowNode));\nexport { FilterInvalidNode };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsdGVyaW52YWxpZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21waWxlL2RhdGEvZmlsdGVyaW52YWxpZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFDLGNBQWMsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUM3QyxPQUFPLEVBQVcsT0FBTyxJQUFJLFFBQVEsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQzdELE9BQU8sRUFBQyxVQUFVLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDdEMsT0FBTyxFQUFDLG1CQUFtQixFQUFZLE1BQU0sYUFBYSxDQUFDO0FBQzNELE9BQU8sRUFBTyxJQUFJLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFHdEMsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLFlBQVksQ0FBQztBQUV4QztJQUF1Qyw2Q0FBWTtJQUtqRCwyQkFBWSxNQUFvQixFQUFVLFNBQWlDO1FBQTNFLFlBQ0Msa0JBQU0sTUFBTSxDQUFDLFNBQ2I7UUFGeUMsZUFBUyxHQUFULFNBQVMsQ0FBd0I7O0lBRTNFLENBQUM7SUFOTSxpQ0FBSyxHQUFaO1FBQ0UsT0FBTyxJQUFJLGlCQUFpQixDQUFDLElBQUksdUJBQU0sSUFBSSxDQUFDLFNBQVMsRUFBRSxDQUFDO0lBQzFELENBQUM7SUFNYSxzQkFBSSxHQUFsQixVQUFtQixNQUFvQixFQUFFLEtBQWdCO1FBQ2hELElBQUEscUJBQU0sRUFBRSxpQkFBSSxDQUFVO1FBQzdCLElBQUksTUFBTSxDQUFDLGFBQWEsS0FBSyxRQUFRLEVBQUc7WUFDdEMsT0FBTyxJQUFJLENBQUM7U0FDYjtRQUVELElBQU0sTUFBTSxHQUFHLEtBQUssQ0FBQyxjQUFjLENBQUMsVUFBQyxVQUFrQyxFQUFFLFFBQVEsRUFBRSxPQUFPO1lBQ3hGLElBQU0sY0FBYyxHQUFHLGNBQWMsQ0FBQyxPQUFPLENBQUMsSUFBSSxLQUFLLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDbkYsSUFBSSxjQUFjLEVBQUU7Z0JBQ2xCLElBQU0sU0FBUyxHQUFHLGNBQWMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBRzdDLG1GQUFtRjtnQkFDbkYsdUZBQXVGO2dCQUN2RixrRkFBa0Y7Z0JBQ2xGLElBQUksbUJBQW1CLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxFQUFFO29CQUM5RSxVQUFVLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxHQUFHLFFBQVEsQ0FBQztpQkFDdkM7YUFDRjtZQUNELE9BQU8sVUFBVSxDQUFDO1FBQ3BCLENBQUMsRUFBRSxFQUE0QixDQUFDLENBQUM7UUFFakMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLEVBQUU7WUFDeEIsT0FBTyxJQUFJLENBQUM7U0FDYjtRQUVELE9BQU8sSUFBSSxpQkFBaUIsQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDL0MsQ0FBQztJQUVELHNCQUFJLHFDQUFNO2FBQVY7WUFDRSxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUM7UUFDeEIsQ0FBQzs7O09BQUE7SUFFRCwwREFBMEQ7SUFDbkQsb0NBQVEsR0FBZjtRQUFBLGlCQWlCQztRQWhCQyxJQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxVQUFDLFdBQVcsRUFBRSxLQUFLO1lBQzFELElBQU0sUUFBUSxHQUFHLEtBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDdkMsSUFBTSxHQUFHLEdBQUcsUUFBUSxDQUFDLFFBQVEsRUFBRSxFQUFDLElBQUksRUFBRSxPQUFPLEVBQUMsQ0FBQyxDQUFDO1lBRWhELElBQUksUUFBUSxLQUFLLElBQUksRUFBRTtnQkFDckIsV0FBVyxDQUFDLElBQUksQ0FBSSxHQUFHLGNBQVcsQ0FBQyxDQUFDO2dCQUNwQyxXQUFXLENBQUMsSUFBSSxDQUFDLFlBQVUsR0FBRyxNQUFHLENBQUMsQ0FBQzthQUNwQztZQUNELE9BQU8sV0FBVyxDQUFDO1FBQ3JCLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztRQUVQLE9BQU8sT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQztZQUMzQjtnQkFDSSxJQUFJLEVBQUUsUUFBUTtnQkFDZCxJQUFJLEVBQUUsT0FBTyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUM7YUFDN0IsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0lBQ1gsQ0FBQztJQUNILHdCQUFDO0FBQUQsQ0FBQyxBQTdERCxDQUF1QyxZQUFZLEdBNkRsRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7aXNTY2FsZUNoYW5uZWx9IGZyb20gJy4uLy4uL2NoYW5uZWwnO1xuaW1wb3J0IHtGaWVsZERlZiwgdmdGaWVsZCBhcyBmaWVsZFJlZn0gZnJvbSAnLi4vLi4vZmllbGRkZWYnO1xuaW1wb3J0IHtpc1BhdGhNYXJrfSBmcm9tICcuLi8uLi9tYXJrJztcbmltcG9ydCB7aGFzQ29udGludW91c0RvbWFpbiwgU2NhbGVUeXBlfSBmcm9tICcuLi8uLi9zY2FsZSc7XG5pbXBvcnQge0RpY3QsIGtleXN9IGZyb20gJy4uLy4uL3V0aWwnO1xuaW1wb3J0IHtWZ0ZpbHRlclRyYW5zZm9ybX0gZnJvbSAnLi4vLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtVbml0TW9kZWx9IGZyb20gJy4uL3VuaXQnO1xuaW1wb3J0IHtEYXRhRmxvd05vZGV9IGZyb20gJy4vZGF0YWZsb3cnO1xuXG5leHBvcnQgY2xhc3MgRmlsdGVySW52YWxpZE5vZGUgZXh0ZW5kcyBEYXRhRmxvd05vZGUge1xuICBwdWJsaWMgY2xvbmUoKSB7XG4gICAgcmV0dXJuIG5ldyBGaWx0ZXJJbnZhbGlkTm9kZShudWxsLCB7Li4udGhpcy5maWVsZERlZnN9KTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHBhcmVudDogRGF0YUZsb3dOb2RlLCBwcml2YXRlIGZpZWxkRGVmczogRGljdDxGaWVsZERlZjxzdHJpbmc+Pikge1xuICAgc3VwZXIocGFyZW50KTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgbWFrZShwYXJlbnQ6IERhdGFGbG93Tm9kZSwgbW9kZWw6IFVuaXRNb2RlbCk6IEZpbHRlckludmFsaWROb2RlIHtcbiAgICBjb25zdCB7Y29uZmlnLCBtYXJrfSA9IG1vZGVsO1xuICAgIGlmIChjb25maWcuaW52YWxpZFZhbHVlcyAhPT0gJ2ZpbHRlcicgKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBmaWx0ZXIgPSBtb2RlbC5yZWR1Y2VGaWVsZERlZigoYWdncmVnYXRvcjogRGljdDxGaWVsZERlZjxzdHJpbmc+PiwgZmllbGREZWYsIGNoYW5uZWwpID0+IHtcbiAgICAgIGNvbnN0IHNjYWxlQ29tcG9uZW50ID0gaXNTY2FsZUNoYW5uZWwoY2hhbm5lbCkgJiYgbW9kZWwuZ2V0U2NhbGVDb21wb25lbnQoY2hhbm5lbCk7XG4gICAgICBpZiAoc2NhbGVDb21wb25lbnQpIHtcbiAgICAgICAgY29uc3Qgc2NhbGVUeXBlID0gc2NhbGVDb21wb25lbnQuZ2V0KCd0eXBlJyk7XG5cblxuICAgICAgICAvLyBXaGlsZSBkaXNjcmV0ZSBkb21haW4gc2NhbGVzIGNhbiBoYW5kbGUgaW52YWxpZCB2YWx1ZXMsIGNvbnRpbnVvdXMgc2NhbGVzIGNhbid0LlxuICAgICAgICAvLyBUaHVzLCBmb3Igbm9uLXBhdGggbWFya3MsIHdlIGhhdmUgdG8gZmlsdGVyIG51bGwgZm9yIHNjYWxlcyB3aXRoIGNvbnRpbnVvdXMgZG9tYWlucy5cbiAgICAgICAgLy8gKEZvciBwYXRoIG1hcmtzLCB3ZSB3aWxsIHVzZSBcImRlZmluZWRcIiBwcm9wZXJ0eSBhbmQgc2tpcCB0aGVzZSB2YWx1ZXMgaW5zdGVhZC4pXG4gICAgICAgIGlmIChoYXNDb250aW51b3VzRG9tYWluKHNjYWxlVHlwZSkgJiYgIWZpZWxkRGVmLmFnZ3JlZ2F0ZSAmJiAhaXNQYXRoTWFyayhtYXJrKSkge1xuICAgICAgICAgIGFnZ3JlZ2F0b3JbZmllbGREZWYuZmllbGRdID0gZmllbGREZWY7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBhZ2dyZWdhdG9yO1xuICAgIH0sIHt9IGFzIERpY3Q8RmllbGREZWY8c3RyaW5nPj4pO1xuXG4gICAgaWYgKCFrZXlzKGZpbHRlcikubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IEZpbHRlckludmFsaWROb2RlKHBhcmVudCwgZmlsdGVyKTtcbiAgfVxuXG4gIGdldCBmaWx0ZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmllbGREZWZzO1xuICB9XG5cbiAgLy8gY3JlYXRlIHRoZSBWZ1RyYW5zZm9ybXMgZm9yIGVhY2ggb2YgdGhlIGZpbHRlcmVkIGZpZWxkc1xuICBwdWJsaWMgYXNzZW1ibGUoKTogVmdGaWx0ZXJUcmFuc2Zvcm0ge1xuICAgIGNvbnN0IGZpbHRlcnMgPSBrZXlzKHRoaXMuZmlsdGVyKS5yZWR1Y2UoKHZlZ2FGaWx0ZXJzLCBmaWVsZCkgPT4ge1xuICAgICAgY29uc3QgZmllbGREZWYgPSB0aGlzLmZpZWxkRGVmc1tmaWVsZF07XG4gICAgICBjb25zdCByZWYgPSBmaWVsZFJlZihmaWVsZERlZiwge2V4cHI6ICdkYXR1bSd9KTtcblxuICAgICAgaWYgKGZpZWxkRGVmICE9PSBudWxsKSB7XG4gICAgICAgIHZlZ2FGaWx0ZXJzLnB1c2goYCR7cmVmfSAhPT0gbnVsbGApO1xuICAgICAgICB2ZWdhRmlsdGVycy5wdXNoKGAhaXNOYU4oJHtyZWZ9KWApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZlZ2FGaWx0ZXJzO1xuICAgIH0sIFtdKTtcblxuICAgIHJldHVybiBmaWx0ZXJzLmxlbmd0aCA+IDAgP1xuICAgIHtcbiAgICAgICAgdHlwZTogJ2ZpbHRlcicsXG4gICAgICAgIGV4cHI6IGZpbHRlcnMuam9pbignICYmICcpXG4gICAgfSA6IG51bGw7XG4gIH1cbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { isNumber, isString, toSet } from 'vega-util';\nimport { isCountingAggregateOp } from '../../aggregate';\nimport { isDateTime } from '../../datetime';\nimport { isNumberFieldDef, isScaleFieldDef, isTimeFieldDef } from '../../fielddef';\nimport * as log from '../../log';\nimport { forEachLeaf } from '../../logical';\nimport { isFieldEqualPredicate, isFieldOneOfPredicate, isFieldPredicate, isFieldRangePredicate } from '../../predicate';\nimport { isSortField } from '../../sort';\nimport { accessPathDepth, accessPathWithDatum, duplicate, keys, removePathFromField } from '../../util';\nimport { isFacetModel, isUnitModel } from '../model';\nimport { Split } from '../split';\nimport { DataFlowNode } from './dataflow';\n/**\n * @param field The field.\n * @param parse What to parse the field as.\n */\nfunction parseExpression(field, parse) {\n    var f = accessPathWithDatum(field);\n    if (parse === 'number') {\n        return \"toNumber(\" + f + \")\";\n    }\n    else if (parse === 'boolean') {\n        return \"toBoolean(\" + f + \")\";\n    }\n    else if (parse === 'string') {\n        return \"toString(\" + f + \")\";\n    }\n    else if (parse === 'date') {\n        return \"toDate(\" + f + \")\";\n    }\n    else if (parse === 'flatten') {\n        return f;\n    }\n    else if (parse.indexOf('date:') === 0) {\n        var specifier = parse.slice(5, parse.length);\n        return \"timeParse(\" + f + \",\" + specifier + \")\";\n    }\n    else if (parse.indexOf('utc:') === 0) {\n        var specifier = parse.slice(4, parse.length);\n        return \"utcParse(\" + f + \",\" + specifier + \")\";\n    }\n    else {\n        log.warn(log.message.unrecognizedParse(parse));\n        return null;\n    }\n}\nvar ParseNode = /** @class */ (function (_super) {\n    tslib_1.__extends(ParseNode, _super);\n    function ParseNode(parent, parse) {\n        var _this = _super.call(this, parent) || this;\n        _this._parse = parse;\n        return _this;\n    }\n    ParseNode.prototype.clone = function () {\n        return new ParseNode(null, duplicate(this._parse));\n    };\n    /**\n     * Creates a parse node from a data.format.parse and updates ancestorParse.\n     */\n    ParseNode.makeExplicit = function (parent, model, ancestorParse) {\n        // Custom parse\n        var explicit = {};\n        var data = model.data;\n        if (data && data.format && data.format.parse) {\n            explicit = data.format.parse;\n        }\n        return this.makeWithAncestors(parent, explicit, {}, ancestorParse);\n    };\n    ParseNode.makeImplicitFromFilterTransform = function (parent, transform, ancestorParse) {\n        var parse = {};\n        forEachLeaf(transform.filter, function (filter) {\n            if (isFieldPredicate(filter)) {\n                // Automatically add a parse node for filters with filter objects\n                var val = null;\n                // For EqualFilter, just use the equal property.\n                // For RangeFilter and OneOfFilter, all array members should have\n                // the same type, so we only use the first one.\n                if (isFieldEqualPredicate(filter)) {\n                    val = filter.equal;\n                }\n                else if (isFieldRangePredicate(filter)) {\n                    val = filter.range[0];\n                }\n                else if (isFieldOneOfPredicate(filter)) {\n                    val = (filter.oneOf || filter['in'])[0];\n                } // else -- for filter expression, we can't infer anything\n                if (val) {\n                    if (isDateTime(val)) {\n                        parse[filter.field] = 'date';\n                    }\n                    else if (isNumber(val)) {\n                        parse[filter.field] = 'number';\n                    }\n                    else if (isString(val)) {\n                        parse[filter.field] = 'string';\n                    }\n                }\n                if (filter.timeUnit) {\n                    parse[filter.field] = 'date';\n                }\n            }\n        });\n        if (keys(parse).length === 0) {\n            return null;\n        }\n        return this.makeWithAncestors(parent, {}, parse, ancestorParse);\n    };\n    /**\n     * Creates a parse node for implicit parsing from a model and updates ancestorParse.\n     */\n    ParseNode.makeImplicitFromEncoding = function (parent, model, ancestorParse) {\n        var implicit = {};\n        if (isUnitModel(model) || isFacetModel(model)) {\n            // Parse encoded fields\n            model.forEachFieldDef(function (fieldDef) {\n                if (isTimeFieldDef(fieldDef)) {\n                    implicit[fieldDef.field] = 'date';\n                }\n                else if (isNumberFieldDef(fieldDef)) {\n                    if (!isCountingAggregateOp(fieldDef.aggregate)) {\n                        implicit[fieldDef.field] = 'number';\n                    }\n                }\n                else if (accessPathDepth(fieldDef.field) > 1) {\n                    // For non-date/non-number (strings and booleans), derive a flattened field for a referenced nested field.\n                    // (Parsing numbers / dates already flattens numeric and temporal fields.)\n                    if (!(fieldDef.field in implicit)) {\n                        implicit[fieldDef.field] = 'flatten';\n                    }\n                }\n                else if (isScaleFieldDef(fieldDef) && isSortField(fieldDef.sort) && accessPathDepth(fieldDef.sort.field) > 1) {\n                    // Flatten fields that we sort by but that are not otherwise flattened.\n                    if (!(fieldDef.sort.field in implicit)) {\n                        implicit[fieldDef.sort.field] = 'flatten';\n                    }\n                }\n            });\n        }\n        return this.makeWithAncestors(parent, {}, implicit, ancestorParse);\n    };\n    /**\n     * Creates a parse node from \"explicit\" parse and \"implicit\" parse and updates ancestorParse.\n     */\n    ParseNode.makeWithAncestors = function (parent, explicit, implicit, ancestorParse) {\n        // We should not parse what has already been parsed in a parent (explicitly or implicitly) or what has been derived (maked as \"derived\"). We also don't need to flatten a field that has already been parsed.\n        for (var _i = 0, _a = keys(implicit); _i < _a.length; _i++) {\n            var field = _a[_i];\n            var parsedAs = ancestorParse.getWithExplicit(field);\n            if (parsedAs.value !== undefined) {\n                // We always ignore derived fields even if they are implicitly defined because we expect users to create the right types.\n                if (parsedAs.explicit || parsedAs.value === implicit[field] || parsedAs.value === 'derived' || implicit[field] === 'flatten') {\n                    delete implicit[field];\n                }\n                else {\n                    log.warn(log.message.differentParse(field, implicit[field], parsedAs.value));\n                }\n            }\n        }\n        for (var _b = 0, _c = keys(explicit); _b < _c.length; _b++) {\n            var field = _c[_b];\n            var parsedAs = ancestorParse.get(field);\n            if (parsedAs !== undefined) {\n                // Don't parse a field again if it has been parsed with the same type already.\n                if (parsedAs === explicit[field]) {\n                    delete explicit[field];\n                }\n                else {\n                    log.warn(log.message.differentParse(field, explicit[field], parsedAs));\n                }\n            }\n        }\n        var parse = new Split(explicit, implicit);\n        // add the format parse from this model so that children don't parse the same field again\n        ancestorParse.copyAll(parse);\n        // copy only non-null parses\n        var p = {};\n        for (var _d = 0, _e = keys(parse.combine()); _d < _e.length; _d++) {\n            var key = _e[_d];\n            var val = parse.get(key);\n            if (val !== null) {\n                p[key] = val;\n            }\n        }\n        if (keys(p).length === 0 || ancestorParse.parseNothing) {\n            return null;\n        }\n        return new ParseNode(parent, p);\n    };\n    Object.defineProperty(ParseNode.prototype, \"parse\", {\n        get: function () {\n            return this._parse;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ParseNode.prototype.merge = function (other) {\n        this._parse = tslib_1.__assign({}, this._parse, other.parse);\n        other.remove();\n    };\n    /**\n     * Assemble an object for Vega's format.parse property.\n     */\n    ParseNode.prototype.assembleFormatParse = function () {\n        var formatParse = {};\n        for (var _i = 0, _a = keys(this._parse); _i < _a.length; _i++) {\n            var field = _a[_i];\n            var p = this._parse[field];\n            if (accessPathDepth(field) === 1) {\n                formatParse[field] = p;\n            }\n        }\n        return formatParse;\n    };\n    // format parse depends and produces all fields in its parse\n    ParseNode.prototype.producedFields = function () {\n        return toSet(keys(this._parse));\n    };\n    ParseNode.prototype.dependentFields = function () {\n        return toSet(keys(this._parse));\n    };\n    ParseNode.prototype.assembleTransforms = function (onlyNested) {\n        var _this = this;\n        if (onlyNested === void 0) { onlyNested = false; }\n        return keys(this._parse)\n            .filter(function (field) { return onlyNested ? accessPathDepth(field) > 1 : true; })\n            .map(function (field) {\n            var expr = parseExpression(field, _this._parse[field]);\n            if (!expr) {\n                return null;\n            }\n            var formula = {\n                type: 'formula',\n                expr: expr,\n                as: removePathFromField(field) // Vega output is always flattened\n            };\n            return formula;\n        }).filter(function (t) { return t !== null; });\n    };\n    return ParseNode;\n}(DataFlowNode));\nexport { ParseNode };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybWF0cGFyc2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9kYXRhL2Zvcm1hdHBhcnNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUMsUUFBUSxFQUFFLFFBQVEsRUFBRSxLQUFLLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFFcEQsT0FBTyxFQUFDLHFCQUFxQixFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFDdEQsT0FBTyxFQUFXLFVBQVUsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ3BELE9BQU8sRUFBQyxnQkFBZ0IsRUFBRSxlQUFlLEVBQUUsY0FBYyxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDakYsT0FBTyxLQUFLLEdBQUcsTUFBTSxXQUFXLENBQUM7QUFDakMsT0FBTyxFQUFDLFdBQVcsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUMxQyxPQUFPLEVBQUMscUJBQXFCLEVBQUUscUJBQXFCLEVBQUUsZ0JBQWdCLEVBQUUscUJBQXFCLEVBQUMsTUFBTSxpQkFBaUIsQ0FBQztBQUN0SCxPQUFPLEVBQUMsV0FBVyxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBRXZDLE9BQU8sRUFBQyxlQUFlLEVBQUUsbUJBQW1CLEVBQVEsU0FBUyxFQUFFLElBQUksRUFBRSxtQkFBbUIsRUFBWSxNQUFNLFlBQVksQ0FBQztBQUV2SCxPQUFPLEVBQUMsWUFBWSxFQUFFLFdBQVcsRUFBUSxNQUFNLFVBQVUsQ0FBQztBQUMxRCxPQUFPLEVBQUMsS0FBSyxFQUFDLE1BQU0sVUFBVSxDQUFDO0FBQy9CLE9BQU8sRUFBQyxZQUFZLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFHeEM7OztHQUdHO0FBQ0gseUJBQXlCLEtBQWEsRUFBRSxLQUFhO0lBQ25ELElBQU0sQ0FBQyxHQUFHLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3JDLElBQUksS0FBSyxLQUFLLFFBQVEsRUFBRTtRQUN0QixPQUFPLGNBQVks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QUFPLElBQUksQ0FBQzthQUNiO1lBRUQsSUFBTSxPQUFPLEdBQXVCO2dCQUNsQyxJQUFJLEVBQUUsU0FBUztnQkFDZixJQUFJLE1BQUE7Z0JBQ0osRUFBRSxFQUFFLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxDQUFFLGtDQUFrQzthQUNuRSxDQUFDO1lBQ0YsT0FBTyxPQUFPLENBQUM7UUFDakIsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxLQUFLLElBQUksRUFBVixDQUFVLENBQUMsQ0FBQztJQUMvQixDQUFDO0lBQ0gsZ0JBQUM7QUFBRCxDQUFDLEFBdk1ELENBQStCLFlBQVksR0F1TTFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtpc051bWJlciwgaXNTdHJpbmcsIHRvU2V0fSBmcm9tICd2ZWdhLXV0aWwnO1xuaW1wb3J0IHtBbmNlc3RvclBhcnNlfSBmcm9tICcuJztcbmltcG9ydCB7aXNDb3VudGluZ0FnZ3JlZ2F0ZU9wfSBmcm9tICcuLi8uLi9hZ2dyZWdhdGUnO1xuaW1wb3J0IHtEYXRlVGltZSwgaXNEYXRlVGltZX0gZnJvbSAnLi4vLi4vZGF0ZXRpbWUnO1xuaW1wb3J0IHtpc051bWJlckZpZWxkRGVmLCBpc1NjYWxlRmllbGREZWYsIGlzVGltZUZpZWxkRGVmfSBmcm9tICcuLi8uLi9maWVsZGRlZic7XG5pbXBvcnQgKiBhcyBsb2cgZnJvbSAnLi4vLi4vbG9nJztcbmltcG9ydCB7Zm9yRWFjaExlYWZ9IGZyb20gJy4uLy4uL2xvZ2ljYWwnO1xuaW1wb3J0IHtpc0ZpZWxkRXF1YWxQcmVkaWNhdGUsIGlzRmllbGRPbmVPZlByZWRpY2F0ZSwgaXNGaWVsZFByZWRpY2F0ZSwgaXNGaWVsZFJhbmdlUHJlZGljYXRlfSBmcm9tICcuLi8uLi9wcmVkaWNhdGUnO1xuaW1wb3J0IHtpc1NvcnRGaWVsZH0gZnJvbSAnLi4vLi4vc29ydCc7XG5pbXBvcnQge0ZpbHRlclRyYW5zZm9ybX0gZnJvbSAnLi4vLi4vdHJhbnNmb3JtJztcbmltcG9ydCB7YWNjZXNzUGF0aERlcHRoLCBhY2Nlc3NQYXRoV2l0aERhdHVtLCBEaWN0LCBkdXBsaWNhdGUsIGtleXMsIHJlbW92ZVBhdGhGcm9tRmllbGQsIFN0cmluZ1NldH0gZnJvbSAnLi4vLi4vdXRpbCc7XG5pbXBvcnQge1ZnRm9ybXVsYVRyYW5zZm9ybX0gZnJvbSAnLi4vLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtpc0ZhY2V0TW9kZWwsIGlzVW5pdE1vZGVsLCBNb2RlbH0gZnJvbSAnLi4vbW9kZWwnO1xuaW1wb3J0IHtTcGxpdH0gZnJvbSAnLi4vc3BsaXQnO1xuaW1wb3J0IHtEYXRhRmxvd05vZGV9IGZyb20gJy4vZGF0YWZsb3cnO1xuXG5cbi8qKlxuICogQHBhcmFtIGZpZWxkIFRoZSBmaWVsZC5cbiAqIEBwYXJhbSBwYXJzZSBXaGF0IHRvIHBhcnNlIHRoZSBmaWVsZCBhcy5cbiAqL1xuZnVuY3Rpb24gcGFyc2VFeHByZXNzaW9uKGZpZWxkOiBzdHJpbmcsIHBhcnNlOiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCBmID0gYWNjZXNzUGF0aFdpdGhEYXR1bShmaWVsZCk7XG4gIGlmIChwYXJzZSA9PT0gJ251bWJlcicpIHtcbiAgICByZXR1cm4gYHRvTnVtYmVyKCR7Zn0pYDtcbiAgfSBlbHNlIGlmIChwYXJzZSA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgcmV0dXJuIGB0b0Jvb2xlYW4oJHtmfSlgO1xuICB9IGVsc2UgaWYgKHBhcnNlID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBgdG9TdHJpbmcoJHtmfSlgO1xuICB9IGVsc2UgaWYgKHBhcnNlID09PSAnZGF0ZScpIHtcbiAgICByZXR1cm4gYHRvRGF0ZSgke2Z9KWA7XG4gIH0gZWxzZSBpZiAocGFyc2UgPT09ICdmbGF0dGVuJykge1xuICAgIHJldHVybiBmO1xuICB9IGVsc2UgaWYgKHBhcnNlLmluZGV4T2YoJ2RhdGU6JykgPT09IDApIHtcbiAgICBjb25zdCBzcGVjaWZpZXIgPSBwYXJzZS5zbGljZSg1LCBwYXJzZS5sZW5ndGgpO1xuICAgIHJldHVybiBgdGltZVBhcnNlKCR7Zn0sJHtzcGVjaWZpZXJ9KWA7XG4gIH0gZWxzZSBpZiAocGFyc2UuaW5kZXhPZigndXRjOicpID09PSAwKSB7XG4gICAgY29uc3Qgc3BlY2lmaWVyID0gcGFyc2Uuc2xpY2UoNCwgcGFyc2UubGVuZ3RoKTtcbiAgICByZXR1cm4gYHV0Y1BhcnNlKCR7Zn0sJHtzcGVjaWZpZXJ9KWA7XG4gIH0gZWxzZSB7XG4gICAgbG9nLndhcm4obG9nLm1lc3NhZ2UudW5yZWNvZ25pemVkUGFyc2UocGFyc2UpKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgUGFyc2VOb2RlIGV4dGVuZHMgRGF0YUZsb3dOb2RlIHtcbiAgcHJpdmF0ZSBfcGFyc2U6IERpY3Q8c3RyaW5nPjtcblxuICBwdWJsaWMgY2xvbmUoKSB7XG4gICAgcmV0dXJuIG5ldyBQYXJzZU5vZGUobnVsbCwgZHVwbGljYXRlKHRoaXMuX3BhcnNlKSk7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihwYXJlbnQ6IERhdGFGbG93Tm9kZSwgcGFyc2U6IERpY3Q8c3RyaW5nPikge1xuICAgIHN1cGVyKHBhcmVudCk7XG5cbiAgICB0aGlzLl9wYXJzZSA9IHBhcnNlO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBwYXJzZSBub2RlIGZyb20gYSBkYXRhLmZvcm1hdC5wYXJzZSBhbmQgdXBkYXRlcyBhbmNlc3RvclBhcnNlLlxuICAgKi9cbiAgcHVibGljIHN0YXRpYyBtYWtlRXhwbGljaXQocGFyZW50OiBEYXRhRmxvd05vZGUsIG1vZGVsOiBNb2RlbCwgYW5jZXN0b3JQYXJzZTogQW5jZXN0b3JQYXJzZSkge1xuICAgIC8vIEN1c3RvbSBwYXJzZVxuICAgIGxldCBleHBsaWNpdCA9IHt9O1xuICAgIGNvbnN0IGRhdGEgPSBtb2RlbC5kYXRhO1xuICAgIGlmIChkYXRhICYmIGRhdGEuZm9ybWF0ICYmIGRhdGEuZm9ybWF0LnBhcnNlKSB7XG4gICAgICBleHBsaWNpdCA9IGRhdGEuZm9ybWF0LnBhcnNlO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLm1ha2VXaXRoQW5jZXN0b3JzKHBhcmVudCwgZXhwbGljaXQsIHt9LCBhbmNlc3RvclBhcnNlKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgbWFrZUltcGxpY2l0RnJvbUZpbHRlclRyYW5zZm9ybShwYXJlbnQ6IERhdGFGbG93Tm9kZSwgdHJhbnNmb3JtOiBGaWx0ZXJUcmFuc2Zvcm0sIGFuY2VzdG9yUGFyc2U6IEFuY2VzdG9yUGFyc2UpIHtcbiAgICBjb25zdCBwYXJzZSA9IHt9O1xuICAgIGZvckVhY2hMZWFmKHRyYW5zZm9ybS5maWx0ZXIsIGZpbHRlciA9PiB7XG4gICAgICBpZiAoaXNGaWVsZFByZWRpY2F0ZShmaWx0ZXIpKSB7XG4gICAgICAgIC8vIEF1dG9tYXRpY2FsbHkgYWRkIGEgcGFyc2Ugbm9kZSBmb3IgZmlsdGVycyB3aXRoIGZpbHRlciBvYmplY3RzXG4gICAgICAgIGxldCB2YWw6IHN0cmluZyB8IG51bWJlciB8IGJvb2xlYW4gfCBEYXRlVGltZSA9IG51bGw7XG5cbiAgICAgICAgLy8gRm9yIEVxdWFsRmlsdGVyLCBqdXN0IHVzZSB0aGUgZXF1YWwgcHJvcGVydHkuXG4gICAgICAgIC8vIEZvciBSYW5nZUZpbHRlciBhbmQgT25lT2ZGaWx0ZXIsIGFsbCBhcnJheSBtZW1iZXJzIHNob3VsZCBoYXZlXG4gICAgICAgIC8vIHRoZSBzYW1lIHR5cGUsIHNvIHdlIG9ubHkgdXNlIHRoZSBmaXJzdCBvbmUuXG4gICAgICAgIGlmIChpc0ZpZWxkRXF1YWxQcmVkaWNhdGUoZmlsdGVyKSkge1xuICAgICAgICAgIHZhbCA9IGZpbHRlci5lcXVhbDtcbiAgICAgICAgfSBlbHNlIGlmIChpc0ZpZWxkUmFuZ2VQcmVkaWNhdGUoZmlsdGVyKSkge1xuICAgICAgICAgIHZhbCA9IGZpbHRlci5yYW5nZVswXTtcbiAgICAgICAgfSBlbHNlIGlmIChpc0ZpZWxkT25lT2ZQcmVkaWNhdGUoZmlsdGVyKSkge1xuICAgICAgICAgIHZhbCA9IChmaWx0ZXIub25lT2YgfHwgZmlsdGVyWydpbiddKVswXTtcbiAgICAgICAgfSAvLyBlbHNlIC0tIGZvciBmaWx0ZXIgZXhwcmVzc2lvbiwgd2UgY2FuJ3QgaW5mZXIgYW55dGhpbmdcbiAgICAgICAgaWYgKHZhbCkge1xuICAgICAgICAgIGlmIChpc0RhdGVUaW1lKHZhbCkpIHtcbiAgICAgICAgICAgIHBhcnNlW2ZpbHRlci5maWVsZF0gPSAnZGF0ZSc7XG4gICAgICAgICAgfSBlbHNlIGlmIChpc051bWJlcih2YWwpKSB7XG4gICAgICAgICAgICBwYXJzZVtmaWx0ZXIuZmllbGRdID0gJ251bWJlcic7XG4gICAgICAgICAgfSBlbHNlIGlmIChpc1N0cmluZyh2YWwpKSB7XG4gICAgICAgICAgICBwYXJzZVtmaWx0ZXIuZmllbGRdID0gJ3N0cmluZyc7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZpbHRlci50aW1lVW5pdCkge1xuICAgICAgICAgIHBhcnNlW2ZpbHRlci5maWVsZF0gPSAnZGF0ZSc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChrZXlzKHBhcnNlKS5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLm1ha2VXaXRoQW5jZXN0b3JzKHBhcmVudCwge30sIHBhcnNlLCBhbmNlc3RvclBhcnNlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgcGFyc2Ugbm9kZSBmb3IgaW1wbGljaXQgcGFyc2luZyBmcm9tIGEgbW9kZWwgYW5kIHVwZGF0ZXMgYW5jZXN0b3JQYXJzZS5cbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgbWFrZUltcGxpY2l0RnJvbUVuY29kaW5nKHBhcmVudDogRGF0YUZsb3dOb2RlLCBtb2RlbDogTW9kZWwsIGFuY2VzdG9yUGFyc2U6IEFuY2VzdG9yUGFyc2UpIHtcbiAgICBjb25zdCBpbXBsaWNpdCA9IHt9O1xuXG4gICAgaWYgKGlzVW5pdE1vZGVsKG1vZGVsKSB8fCBpc0ZhY2V0TW9kZWwobW9kZWwpKSB7XG4gICAgICAvLyBQYXJzZSBlbmNvZGVkIGZpZWxkc1xuICAgICAgbW9kZWwuZm9yRWFjaEZpZWxkRGVmKGZpZWxkRGVmID0+IHtcbiAgICAgICAgaWYgKGlzVGltZUZpZWxkRGVmKGZpZWxkRGVmKSkge1xuICAgICAgICAgIGltcGxpY2l0W2ZpZWxkRGVmLmZpZWxkXSA9ICdkYXRlJztcbiAgICAgICAgfSBlbHNlIGlmIChpc051bWJlckZpZWxkRGVmKGZpZWxkRGVmKSkge1xuICAgICAgICAgIGlmICghaXNDb3VudGluZ0FnZ3JlZ2F0ZU9wKGZpZWxkRGVmLmFnZ3JlZ2F0ZSkpIHtcbiAgICAgICAgICAgIGltcGxpY2l0W2ZpZWxkRGVmLmZpZWxkXSA9ICdudW1iZXInO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChhY2Nlc3NQYXRoRGVwdGgoZmllbGREZWYuZmllbGQpID4gMSkge1xuICAgICAgICAgIC8vIEZvciBub24tZGF0ZS9ub24tbnVtYmVyIChzdHJpbmdzIGFuZCBib29sZWFucyksIGRlcml2ZSBhIGZsYXR0ZW5lZCBmaWVsZCBmb3IgYSByZWZlcmVuY2VkIG5lc3RlZCBmaWVsZC5cbiAgICAgICAgICAvLyAoUGFyc2luZyBudW1iZXJzIC8gZGF0ZXMgYWxyZWFkeSBmbGF0dGVucyBudW1lcmljIGFuZCB0ZW1wb3JhbCBmaWVsZHMuKVxuICAgICAgICAgIGlmICghKGZpZWxkRGVmLmZpZWxkIGluIGltcGxpY2l0KSkge1xuICAgICAgICAgICAgaW1wbGljaXRbZmllbGREZWYuZmllbGRdID0gJ2ZsYXR0ZW4nO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChpc1NjYWxlRmllbGREZWYoZmllbGREZWYpICYmIGlzU29ydEZpZWxkKGZpZWxkRGVmLnNvcnQpICYmIGFjY2Vzc1BhdGhEZXB0aChmaWVsZERlZi5zb3J0LmZpZWxkKSA+IDEpIHtcbiAgICAgICAgICAvLyBGbGF0dGVuIGZpZWxkcyB0aGF0IHdlIHNvcnQgYnkgYnV0IHRoYXQgYXJlIG5vdCBvdGhlcndpc2UgZmxhdHRlbmVkLlxuICAgICAgICAgIGlmICghKGZpZWxkRGVmLnNvcnQuZmllbGQgaW4gaW1wbGljaXQpKSB7XG4gICAgICAgICAgICBpbXBsaWNpdFtmaWVsZERlZi5zb3J0LmZpZWxkXSA9ICdmbGF0dGVuJztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLm1ha2VXaXRoQW5jZXN0b3JzKHBhcmVudCwge30sIGltcGxpY2l0LCBhbmNlc3RvclBhcnNlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgcGFyc2Ugbm9kZSBmcm9tIFwiZXhwbGljaXRcIiBwYXJzZSBhbmQgXCJpbXBsaWNpdFwiIHBhcnNlIGFuZCB1cGRhdGVzIGFuY2VzdG9yUGFyc2UuXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBtYWtlV2l0aEFuY2VzdG9ycyhwYXJlbnQ6IERhdGFGbG93Tm9kZSwgZXhwbGljaXQ6IERpY3Q8c3RyaW5nPiwgaW1wbGljaXQ6IERpY3Q8c3RyaW5nPiwgYW5jZXN0b3JQYXJzZTogQW5jZXN0b3JQYXJzZSkge1xuICAgIC8vIFdlIHNob3VsZCBub3QgcGFyc2Ugd2hhdCBoYXMgYWxyZWFkeSBiZWVuIHBhcnNlZCBpbiBhIHBhcmVudCAoZXhwbGljaXRseSBvciBpbXBsaWNpdGx5KSBvciB3aGF0IGhhcyBiZWVuIGRlcml2ZWQgKG1ha2VkIGFzIFwiZGVyaXZlZFwiKS4gV2UgYWxzbyBkb24ndCBuZWVkIHRvIGZsYXR0ZW4gYSBmaWVsZCB0aGF0IGhhcyBhbHJlYWR5IGJlZW4gcGFyc2VkLlxuICAgIGZvciAoY29uc3QgZmllbGQgb2Yga2V5cyhpbXBsaWNpdCkpIHtcbiAgICAgIGNvbnN0IHBhcnNlZEFzID0gYW5jZXN0b3JQYXJzZS5nZXRXaXRoRXhwbGljaXQoZmllbGQpO1xuICAgICAgaWYgKHBhcnNlZEFzLnZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgLy8gV2UgYWx3YXlzIGlnbm9yZSBkZXJpdmVkIGZpZWxkcyBldmVuIGlmIHRoZXkgYXJlIGltcGxpY2l0bHkgZGVmaW5lZCBiZWNhdXNlIHdlIGV4cGVjdCB1c2VycyB0byBjcmVhdGUgdGhlIHJpZ2h0IHR5cGVzLlxuICAgICAgICBpZiAocGFyc2VkQXMuZXhwbGljaXQgfHwgcGFyc2VkQXMudmFsdWUgPT09IGltcGxpY2l0W2ZpZWxkXSB8fCBwYXJzZWRBcy52YWx1ZSA9PT0gJ2Rlcml2ZWQnIHx8IGltcGxpY2l0W2ZpZWxkXSA9PT0gJ2ZsYXR0ZW4nKSB7XG4gICAgICAgICAgZGVsZXRlIGltcGxpY2l0W2ZpZWxkXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsb2cud2Fybihsb2cubWVzc2FnZS5kaWZmZXJlbnRQYXJzZShmaWVsZCwgaW1wbGljaXRbZmllbGRdLCBwYXJzZWRBcy52YWx1ZSkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBmaWVsZCBvZiBrZXlzKGV4cGxpY2l0KSkge1xuICAgICAgY29uc3QgcGFyc2VkQXMgPSBhbmNlc3RvclBhcnNlLmdldChmaWVsZCk7XG4gICAgICBpZiAocGFyc2VkQXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAvLyBEb24ndCBwYXJzZSBhIGZpZWxkIGFnYWluIGlmIGl0IGhhcyBiZWVuIHBhcnNlZCB3aXRoIHRoZSBzYW1lIHR5cGUgYWxyZWFkeS5cbiAgICAgICAgaWYgKHBhcnNlZEFzID09PSBleHBsaWNpdFtmaWVsZF0pIHtcbiAgICAgICAgICBkZWxldGUgZXhwbGljaXRbZmllbGRdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLmRpZmZlcmVudFBhcnNlKGZpZWxkLCBleHBsaWNpdFtmaWVsZF0sIHBhcnNlZEFzKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBwYXJzZSA9IG5ldyBTcGxpdChleHBsaWNpdCwgaW1wbGljaXQpO1xuXG4gICAgLy8gYWRkIHRoZSBmb3JtYXQgcGFyc2UgZnJvbSB0aGlzIG1vZGVsIHNvIHRoYXQgY2hpbGRyZW4gZG9uJ3QgcGFyc2UgdGhlIHNhbWUgZmllbGQgYWdhaW5cbiAgICBhbmNlc3RvclBhcnNlLmNvcHlBbGwocGFyc2UpO1xuXG4gICAgLy8gY29weSBvbmx5IG5vbi1udWxsIHBhcnNlc1xuICAgIGNvbnN0IHAgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGtleSBvZiBrZXlzKHBhcnNlLmNvbWJpbmUoKSkpIHtcbiAgICAgIGNvbnN0IHZhbCA9IHBhcnNlLmdldChrZXkpO1xuICAgICAgaWYgKHZhbCAhPT0gbnVsbCkge1xuICAgICAgICBwW2tleV0gPSB2YWw7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGtleXMocCkubGVuZ3RoID09PSAwIHx8IGFuY2VzdG9yUGFyc2UucGFyc2VOb3RoaW5nKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFBhcnNlTm9kZShwYXJlbnQsIHApO1xuICB9XG5cbiAgcHVibGljIGdldCBwYXJzZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fcGFyc2U7XG4gIH1cblxuICBwdWJsaWMgbWVyZ2Uob3RoZXI6IFBhcnNlTm9kZSkge1xuICAgIHRoaXMuX3BhcnNlID0gey4uLnRoaXMuX3BhcnNlLCAuLi5vdGhlci5wYXJzZX07XG4gICAgb3RoZXIucmVtb3ZlKCk7XG4gIH1cblxuICAvKipcbiAgICogQXNzZW1ibGUgYW4gb2JqZWN0IGZvciBWZWdhJ3MgZm9ybWF0LnBhcnNlIHByb3BlcnR5LlxuICAgKi9cbiAgcHVibGljIGFzc2VtYmxlRm9ybWF0UGFyc2UoKSB7XG4gICAgY29uc3QgZm9ybWF0UGFyc2UgPSB7fTtcbiAgICBmb3IgKGNvbnN0IGZpZWxkIG9mIGtleXModGhpcy5fcGFyc2UpKSB7XG4gICAgICBjb25zdCBwID0gdGhpcy5fcGFyc2VbZmllbGRdO1xuICAgICAgaWYgKGFjY2Vzc1BhdGhEZXB0aChmaWVsZCkgPT09IDEpIHtcbiAgICAgICAgZm9ybWF0UGFyc2VbZmllbGRdID0gcDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZvcm1hdFBhcnNlO1xuICB9XG5cbiAgLy8gZm9ybWF0IHBhcnNlIGRlcGVuZHMgYW5kIHByb2R1Y2VzIGFsbCBmaWVsZHMgaW4gaXRzIHBhcnNlXG4gIHB1YmxpYyBwcm9kdWNlZEZpZWxkcygpOiBTdHJpbmdTZXQge1xuICAgIHJldHVybiB0b1NldChrZXlzKHRoaXMuX3BhcnNlKSk7XG4gIH1cblxuICBwdWJsaWMgZGVwZW5kZW50RmllbGRzKCk6IFN0cmluZ1NldCB7XG4gICAgcmV0dXJuIHRvU2V0KGtleXModGhpcy5fcGFyc2UpKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3NlbWJsZVRyYW5zZm9ybXMob25seU5lc3RlZCA9IGZhbHNlKTogVmdGb3JtdWxhVHJhbnNmb3JtW10ge1xuICAgIHJldHVybiBrZXlzKHRoaXMuX3BhcnNlKVxuICAgICAgLmZpbHRlcihmaWVsZCA9PiBvbmx5TmVzdGVkID8gYWNjZXNzUGF0aERlcHRoKGZpZWxkKSA+IDEgOiB0cnVlKVxuICAgICAgLm1hcChmaWVsZCA9PiB7XG4gICAgICAgIGNvbnN0IGV4cHIgPSBwYXJzZUV4cHJlc3Npb24oZmllbGQsIHRoaXMuX3BhcnNlW2ZpZWxkXSk7XG4gICAgICAgIGlmICghZXhwcikge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZm9ybXVsYTogVmdGb3JtdWxhVHJhbnNmb3JtID0ge1xuICAgICAgICAgIHR5cGU6ICdmb3JtdWxhJyxcbiAgICAgICAgICBleHByLFxuICAgICAgICAgIGFzOiByZW1vdmVQYXRoRnJvbUZpZWxkKGZpZWxkKSAgLy8gVmVnYSBvdXRwdXQgaXMgYWx3YXlzIGZsYXR0ZW5lZFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZm9ybXVsYTtcbiAgICAgIH0pLmZpbHRlcih0ID0+IHQgIT09IG51bGwpO1xuICB9XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { isInlineData, isNamedData, isUrlData } from '../../data';\nimport { contains, hash } from '../../util';\nimport { DataFlowNode } from './dataflow';\nvar SourceNode = /** @class */ (function (_super) {\n    tslib_1.__extends(SourceNode, _super);\n    function SourceNode(data) {\n        var _this = _super.call(this, null) || this;\n        data = data || { name: 'source' };\n        if (isInlineData(data)) {\n            _this._data = { values: data.values };\n        }\n        else if (isUrlData(data)) {\n            _this._data = { url: data.url };\n            if (!data.format) {\n                data.format = {};\n            }\n            if (!data.format || !data.format.type) {\n                // Extract extension from URL using snippet from\n                // http://stackoverflow.com/questions/680929/how-to-extract-extension-from-filename-string-in-javascript\n                var defaultExtension = /(?:\\.([^.]+))?$/.exec(data.url)[1];\n                if (!contains(['json', 'csv', 'tsv', 'dsv', 'topojson'], defaultExtension)) {\n                    defaultExtension = 'json';\n                }\n                // defaultExtension has type string but we ensure that it is DataFormatType above\n                data.format.type = defaultExtension;\n            }\n        }\n        else if (isNamedData(data)) {\n            _this._data = {};\n        }\n        // any dataset can be named\n        if (data.name) {\n            _this._name = data.name;\n        }\n        if (data.format) {\n            var _a = data.format, _b = _a.parse, parse = _b === void 0 ? null : _b, format = tslib_1.__rest(_a, [\"parse\"]);\n            _this._data.format = format;\n        }\n        return _this;\n    }\n    Object.defineProperty(SourceNode.prototype, \"data\", {\n        get: function () {\n            return this._data;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SourceNode.prototype.hasName = function () {\n        return !!this._name;\n    };\n    Object.defineProperty(SourceNode.prototype, \"dataName\", {\n        get: function () {\n            return this._name;\n        },\n        set: function (name) {\n            this._name = name;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SourceNode.prototype, \"parent\", {\n        set: function (parent) {\n            throw new Error('Source nodes have to be roots.');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SourceNode.prototype.remove = function () {\n        throw new Error('Source nodes are roots and cannot be removed.');\n    };\n    /**\n     * Return a unique identifier for this data source.\n     */\n    SourceNode.prototype.hash = function () {\n        if (isInlineData(this._data)) {\n            if (!this._hash) {\n                // Hashing can be expensive for large inline datasets.\n                this._hash = hash(this._data);\n            }\n            return this._hash;\n        }\n        else if (isUrlData(this._data)) {\n            return hash([this._data.url, this._data.format]);\n        }\n        else {\n            return this._name;\n        }\n    };\n    SourceNode.prototype.assemble = function () {\n        return tslib_1.__assign({ name: this._name }, this._data, { transform: [] });\n    };\n    return SourceNode;\n}(DataFlowNode));\nexport { SourceNode };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic291cmNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvZGF0YS9zb3VyY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBdUIsWUFBWSxFQUFFLFdBQVcsRUFBRSxTQUFTLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDdEYsT0FBTyxFQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFFMUMsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLFlBQVksQ0FBQztBQUV4QztJQUFnQyxzQ0FBWTtJQU8xQyxvQkFBWSxJQUFVO1FBQXRCLFlBQ0Usa0JBQU0sSUFBSSxDQUFDLFNBcUNaO1FBbkNDLElBQUksR0FBRyxJQUFJLElBQUksRUFBQyxJQUFJLEVBQUUsUUFBUSxFQUFDLENBQUM7UUFFaEMsSUFBSSxZQUFZLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDdEIsS0FBSSxDQUFDLEtBQUssR0FBRyxFQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFDLENBQUM7U0FDcEM7YUFBTSxJQUFJLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUMxQixLQUFJLENBQUMsS0FBSyxHQUFHLEVBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUMsQ0FBQztZQUU3QixJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRTtnQkFDaEIsSUFBSSxDQUFDLE1BQU0sR0FBRyxFQUFFLENBQUM7YUFDbEI7WUFFRCxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFO2dCQUNyQyxnREFBZ0Q7Z0JBQ2hELHdHQUF3RztnQkFDeEcsSUFBSSxnQkFBZ0IsR0FBRyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUMzRCxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLFVBQVUsQ0FBQyxFQUFFLGdCQUFnQixDQUFDLEVBQUU7b0JBQzFFLGdCQUFnQixHQUFHLE1BQU0sQ0FBQztpQkFDM0I7Z0JBRUQsaUZBQWlGO2dCQUNqRixJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksR0FBRyxnQkFBa0MsQ0FBQzthQUN2RDtTQUNGO2FBQU0sSUFBSSxXQUFXLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDNUIsS0FBSSxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUM7U0FDakI7UUFFRCwyQkFBMkI7UUFDM0IsSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFO1lBQ2IsS0FBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO1NBQ3hCO1FBRUQsSUFBSSxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ2YsSUFBTSxnQkFBdUMsRUFBdEMsYUFBWSxFQUFaLGlDQUFZLEVBQUUsc0NBQXdCLENBQUM7WUFDOUMsS0FBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1NBQzVCOztJQUNILENBQUM7SUFFRCxzQkFBSSw0QkFBSTthQUFSO1lBQ0UsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBQ3BCLENBQUM7OztPQUFBO0lBRU0sNEJBQU8sR0FBZDtRQUNFLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7SUFDdEIsQ0FBQztJQUVELHNCQUFJLGdDQUFRO2FBQVo7WUFDRSxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUM7UUFDcEIsQ0FBQzthQUVELFVBQWEsSUFBWTtZQUN2QixJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztRQUNwQixDQUFDOzs7T0FKQTtJQU1ELHNCQUFJLDhCQUFNO2FBQVYsVUFBVyxNQUFvQjtZQUM3QixNQUFNLElBQUksS0FBSyxDQUFDLGdDQUFnQyxDQUFDLENBQUM7UUFDcEQsQ0FBQzs7O09BQUE7SUFFTSwyQkFBTSxHQUFiO1FBQ0UsTUFBTSxJQUFJLEtBQUssQ0FBQywrQ0FBK0MsQ0FBQyxDQUFDO0lBQ25FLENBQUM7SUFFRDs7T0FFRztJQUNJLHlCQUFJLEdBQVg7UUFDRSxJQUFJLFlBQVksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUU7WUFDNUIsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUU7Z0JBQ2Ysc0RBQXNEO2dCQUN0RCxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7YUFDL0I7WUFDRCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUM7U0FDbkI7YUFBTSxJQUFJLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUU7WUFDaEMsT0FBTyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7U0FDbEQ7YUFBTTtZQUNMLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQztTQUNuQjtJQUNILENBQUM7SUFFTSw2QkFBUSxHQUFmO1FBQ0UsMEJBQ0UsSUFBSSxFQUFFLElBQUksQ0FBQyxLQUFLLElBQ2IsSUFBSSxDQUFDLEtBQUssSUFDYixTQUFTLEVBQUUsRUFBRSxJQUNiO0lBQ0osQ0FBQztJQUNILGlCQUFDO0FBQUQsQ0FBQyxBQS9GRCxDQUFnQyxZQUFZLEdBK0YzQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7RGF0YSwgRGF0YUZvcm1hdFR5cGUsIGlzSW5saW5lRGF0YSwgaXNOYW1lZERhdGEsIGlzVXJsRGF0YX0gZnJvbSAnLi4vLi4vZGF0YSc7XG5pbXBvcnQge2NvbnRhaW5zLCBoYXNofSBmcm9tICcuLi8uLi91dGlsJztcbmltcG9ydCB7VmdEYXRhfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge0RhdGFGbG93Tm9kZX0gZnJvbSAnLi9kYXRhZmxvdyc7XG5cbmV4cG9ydCBjbGFzcyBTb3VyY2VOb2RlIGV4dGVuZHMgRGF0YUZsb3dOb2RlIHtcbiAgcHJpdmF0ZSBfZGF0YTogUGFydGlhbDxWZ0RhdGE+O1xuXG4gIHByaXZhdGUgX25hbWU6IHN0cmluZztcblxuICBwcml2YXRlIF9oYXNoOiBzdHJpbmcgfCBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IoZGF0YTogRGF0YSkge1xuICAgIHN1cGVyKG51bGwpOyAgLy8gc291cmNlIGNhbm5vdCBoYXZlIHBhcmVudFxuXG4gICAgZGF0YSA9IGRhdGEgfHwge25hbWU6ICdzb3VyY2UnfTtcblxuICAgIGlmIChpc0lubGluZURhdGEoZGF0YSkpIHtcbiAgICAgIHRoaXMuX2RhdGEgPSB7dmFsdWVzOiBkYXRhLnZhbHVlc307XG4gICAgfSBlbHNlIGlmIChpc1VybERhdGEoZGF0YSkpIHtcbiAgICAgIHRoaXMuX2RhdGEgPSB7dXJsOiBkYXRhLnVybH07XG5cbiAgICAgIGlmICghZGF0YS5mb3JtYXQpIHtcbiAgICAgICAgZGF0YS5mb3JtYXQgPSB7fTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFkYXRhLmZvcm1hdCB8fCAhZGF0YS5mb3JtYXQudHlwZSkge1xuICAgICAgICAvLyBFeHRyYWN0IGV4dGVuc2lvbiBmcm9tIFVSTCB1c2luZyBzbmlwcGV0IGZyb21cbiAgICAgICAgLy8gaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy82ODA5MjkvaG93LXRvLWV4dHJhY3QtZXh0ZW5zaW9uLWZyb20tZmlsZW5hbWUtc3RyaW5nLWluLWphdmFzY3JpcHRcbiAgICAgICAgbGV0IGRlZmF1bHRFeHRlbnNpb24gPSAvKD86XFwuKFteLl0rKSk/JC8uZXhlYyhkYXRhLnVybClbMV07XG4gICAgICAgIGlmICghY29udGFpbnMoWydqc29uJywgJ2NzdicsICd0c3YnLCAnZHN2JywgJ3RvcG9qc29uJ10sIGRlZmF1bHRFeHRlbnNpb24pKSB7XG4gICAgICAgICAgZGVmYXVsdEV4dGVuc2lvbiA9ICdqc29uJztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGRlZmF1bHRFeHRlbnNpb24gaGFzIHR5cGUgc3RyaW5nIGJ1dCB3ZSBlbnN1cmUgdGhhdCBpdCBpcyBEYXRhRm9ybWF0VHlwZSBhYm92ZVxuICAgICAgICBkYXRhLmZvcm1hdC50eXBlID0gZGVmYXVsdEV4dGVuc2lvbiBhcyBEYXRhRm9ybWF0VHlwZTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGlzTmFtZWREYXRhKGRhdGEpKSB7XG4gICAgICB0aGlzLl9kYXRhID0ge307XG4gICAgfVxuXG4gICAgLy8gYW55IGRhdGFzZXQgY2FuIGJlIG5hbWVkXG4gICAgaWYgKGRhdGEubmFtZSkge1xuICAgICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB9XG5cbiAgICBpZiAoZGF0YS5mb3JtYXQpIHtcbiAgICAgIGNvbnN0IHtwYXJzZSA9IG51bGwsIC4uLmZvcm1hdH0gPSBkYXRhLmZvcm1hdDtcbiAgICAgIHRoaXMuX2RhdGEuZm9ybWF0ID0gZm9ybWF0O1xuICAgIH1cbiAgfVxuXG4gIGdldCBkYXRhKCkge1xuICAgIHJldHVybiB0aGlzLl9kYXRhO1xuICB9XG5cbiAgcHVibGljIGhhc05hbWUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICEhdGhpcy5fbmFtZTtcbiAgfVxuXG4gIGdldCBkYXRhTmFtZSgpIHtcbiAgICByZXR1cm4gdGhpcy5fbmFtZTtcbiAgfVxuXG4gIHNldCBkYXRhTmFtZShuYW1lOiBzdHJpbmcpIHtcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgfVxuXG4gIHNldCBwYXJlbnQocGFyZW50OiBEYXRhRmxvd05vZGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1NvdXJjZSBub2RlcyBoYXZlIHRvIGJlIHJvb3RzLicpO1xuICB9XG5cbiAgcHVibGljIHJlbW92ZSgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1NvdXJjZSBub2RlcyBhcmUgcm9vdHMgYW5kIGNhbm5vdCBiZSByZW1vdmVkLicpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiBhIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGlzIGRhdGEgc291cmNlLlxuICAgKi9cbiAgcHVibGljIGhhc2goKSB7XG4gICAgaWYgKGlzSW5saW5lRGF0YSh0aGlzLl9kYXRhKSkge1xuICAgICAgaWYgKCF0aGlzLl9oYXNoKSB7XG4gICAgICAgIC8vIEhhc2hpbmcgY2FuIGJlIGV4cGVuc2l2ZSBmb3IgbGFyZ2UgaW5saW5lIGRhdGFzZXRzLlxuICAgICAgICB0aGlzLl9oYXNoID0gaGFzaCh0aGlzLl9kYXRhKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLl9oYXNoO1xuICAgIH0gZWxzZSBpZiAoaXNVcmxEYXRhKHRoaXMuX2RhdGEpKSB7XG4gICAgICByZXR1cm4gaGFzaChbdGhpcy5fZGF0YS51cmwsIHRoaXMuX2RhdGEuZm9ybWF0XSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLl9uYW1lO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBhc3NlbWJsZSgpOiBWZ0RhdGEge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLFxuICAgICAgLi4udGhpcy5fZGF0YSxcbiAgICAgIHRyYW5zZm9ybTogW11cbiAgICB9O1xuICB9XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { vgField } from '../../fielddef';\nimport { fieldExpr } from '../../timeunit';\nimport { duplicate, keys, vals } from '../../util';\nimport { DataFlowNode } from './dataflow';\nvar TimeUnitNode = /** @class */ (function (_super) {\n    tslib_1.__extends(TimeUnitNode, _super);\n    function TimeUnitNode(parent, formula) {\n        var _this = _super.call(this, parent) || this;\n        _this.formula = formula;\n        return _this;\n    }\n    TimeUnitNode.prototype.clone = function () {\n        return new TimeUnitNode(null, duplicate(this.formula));\n    };\n    TimeUnitNode.makeFromEncoding = function (parent, model) {\n        var formula = model.reduceFieldDef(function (timeUnitComponent, fieldDef) {\n            if (fieldDef.timeUnit) {\n                var f = vgField(fieldDef);\n                timeUnitComponent[f] = {\n                    as: f,\n                    timeUnit: fieldDef.timeUnit,\n                    field: fieldDef.field\n                };\n            }\n            return timeUnitComponent;\n        }, {});\n        if (keys(formula).length === 0) {\n            return null;\n        }\n        return new TimeUnitNode(parent, formula);\n    };\n    TimeUnitNode.makeFromTransform = function (parent, t) {\n        var _a;\n        return new TimeUnitNode(parent, (_a = {},\n            _a[t.field] = {\n                as: t.as,\n                timeUnit: t.timeUnit,\n                field: t.field\n            },\n            _a));\n    };\n    TimeUnitNode.prototype.merge = function (other) {\n        this.formula = tslib_1.__assign({}, this.formula, other.formula);\n        other.remove();\n    };\n    TimeUnitNode.prototype.producedFields = function () {\n        var out = {};\n        vals(this.formula).forEach(function (f) {\n            out[f.as] = true;\n        });\n        return out;\n    };\n    TimeUnitNode.prototype.dependentFields = function () {\n        var out = {};\n        vals(this.formula).forEach(function (f) {\n            out[f.field] = true;\n        });\n        return out;\n    };\n    TimeUnitNode.prototype.assemble = function () {\n        return vals(this.formula).map(function (c) {\n            return {\n                type: 'formula',\n                as: c.as,\n                expr: fieldExpr(c.timeUnit, c.field)\n            };\n        });\n    };\n    return TimeUnitNode;\n}(DataFlowNode));\nexport { TimeUnitNode };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGltZXVuaXQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9kYXRhL3RpbWV1bml0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUMsT0FBTyxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDdkMsT0FBTyxFQUFDLFNBQVMsRUFBVyxNQUFNLGdCQUFnQixDQUFDO0FBRW5ELE9BQU8sRUFBTyxTQUFTLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBQyxNQUFNLFlBQVksQ0FBQztBQUd2RCxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBU3hDO0lBQWtDLHdDQUFZO0lBSzVDLHNCQUFZLE1BQW9CLEVBQVUsT0FBZ0M7UUFBMUUsWUFDRSxrQkFBTSxNQUFNLENBQUMsU0FDZDtRQUZ5QyxhQUFPLEdBQVAsT0FBTyxDQUF5Qjs7SUFFMUUsQ0FBQztJQU5NLDRCQUFLLEdBQVo7UUFDRSxPQUFPLElBQUksWUFBWSxDQUFDLElBQUksRUFBRSxTQUFTLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7SUFDekQsQ0FBQztJQU1hLDZCQUFnQixHQUE5QixVQUErQixNQUFvQixFQUFFLEtBQXFCO1FBQ3hFLElBQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxjQUFjLENBQUMsVUFBQyxpQkFBb0MsRUFBRSxRQUFRO1lBQ2xGLElBQUksUUFBUSxDQUFDLFFBQVEsRUFBRTtnQkFDckIsSUFBTSxDQUFDLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO2dCQUM1QixpQkFBaUIsQ0FBQyxDQUFDLENBQUMsR0FBRztvQkFDckIsRUFBRSxFQUFFLENBQUM7b0JBQ0wsUUFBUSxFQUFFLFFBQVEsQ0FBQyxRQUFRO29CQUMzQixLQUFLLEVBQUUsUUFBUSxDQUFDLEtBQUs7aUJBQ3RCLENBQUM7YUFDSDtZQUNELE9BQU8saUJBQWlCLENBQUM7UUFDM0IsQ0FBQyxFQUFFLEVBQTZCLENBQUMsQ0FBQztRQUVsQyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQzlCLE9BQU8sSUFBSSxDQUFDO1NBQ2I7UUFFRCxPQUFPLElBQUksWUFBWSxDQUFDLE1BQU0sRUFBRSxPQUFPLENBQUMsQ0FBQztJQUMzQyxDQUFDO0lBRWEsOEJBQWlCLEdBQS9CLFVBQWdDLE1BQW9CLEVBQUUsQ0FBb0I7O1FBQ3hFLE9BQU8sSUFBSSxZQUFZLENBQUMsTUFBTTtZQUM1QixHQUFDLENBQUMsQ0FBQyxLQUFLLElBQUc7Z0JBQ1QsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFO2dCQUNSLFFBQVEsRUFBRSxDQUFDLENBQUMsUUFBUTtnQkFDcEIsS0FBSyxFQUFFLENBQUMsQ0FBQyxLQUFLO2FBQ2Y7Z0JBQ0QsQ0FBQztJQUNMLENBQUM7SUFFTSw0QkFBSyxHQUFaLFVBQWEsS0FBbUI7UUFDOUIsSUFBSSxDQUFDLE9BQU8sd0JBQU8sSUFBSSxDQUFDLE9BQU8sRUFBSyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDbkQsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQ2pCLENBQUM7SUFFTSxxQ0FBYyxHQUFyQjtRQUNFLElBQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQztRQUVmLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQUEsQ0FBQztZQUMxQixHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQztRQUNuQixDQUFDLENBQUMsQ0FBQztRQUVILE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQztJQUVNLHNDQUFlLEdBQXRCO1FBQ0UsSUFBTSxHQUFHLEdBQUcsRUFBRSxDQUFDO1FBRWYsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBQSxDQUFDO1lBQzFCLEdBQUcsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsSUFBSSxDQUFDO1FBQ3RCLENBQUMsQ0FBQyxDQUFDO1FBRUgsT0FBTyxHQUFHLENBQUM7SUFDYixDQUFDO0lBRU0sK0JBQVEsR0FBZjtRQUNFLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBQSxDQUFDO1lBQzdCLE9BQU87Z0JBQ0wsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFO2dCQUNSLElBQUksRUFBRSxTQUFTLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDO2FBQ2YsQ0FBQztRQUMxQixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFDSCxtQkFBQztBQUFELENBQUMsQUF6RUQsQ0FBa0MsWUFBWSxHQXlFN0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge3ZnRmllbGR9IGZyb20gJy4uLy4uL2ZpZWxkZGVmJztcbmltcG9ydCB7ZmllbGRFeHByLCBUaW1lVW5pdH0gZnJvbSAnLi4vLi4vdGltZXVuaXQnO1xuaW1wb3J0IHtUaW1lVW5pdFRyYW5zZm9ybX0gZnJvbSAnLi4vLi4vdHJhbnNmb3JtJztcbmltcG9ydCB7RGljdCwgZHVwbGljYXRlLCBrZXlzLCB2YWxzfSBmcm9tICcuLi8uLi91dGlsJztcbmltcG9ydCB7VmdGb3JtdWxhVHJhbnNmb3JtfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge01vZGVsV2l0aEZpZWxkfSBmcm9tICcuLi9tb2RlbCc7XG5pbXBvcnQge0RhdGFGbG93Tm9kZX0gZnJvbSAnLi9kYXRhZmxvdyc7XG5cblxuZXhwb3J0IGludGVyZmFjZSBUaW1lVW5pdENvbXBvbmVudCB7XG4gIGFzOiBzdHJpbmc7XG4gIHRpbWVVbml0OiBUaW1lVW5pdDtcbiAgZmllbGQ6IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIFRpbWVVbml0Tm9kZSBleHRlbmRzIERhdGFGbG93Tm9kZSB7XG4gIHB1YmxpYyBjbG9uZSgpIHtcbiAgICByZXR1cm4gbmV3IFRpbWVVbml0Tm9kZShudWxsLCBkdXBsaWNhdGUodGhpcy5mb3JtdWxhKSk7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihwYXJlbnQ6IERhdGFGbG93Tm9kZSwgcHJpdmF0ZSBmb3JtdWxhOiBEaWN0PFRpbWVVbml0Q29tcG9uZW50Pikge1xuICAgIHN1cGVyKHBhcmVudCk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIG1ha2VGcm9tRW5jb2RpbmcocGFyZW50OiBEYXRhRmxvd05vZGUsIG1vZGVsOiBNb2RlbFdpdGhGaWVsZCkge1xuICAgIGNvbnN0IGZvcm11bGEgPSBtb2RlbC5yZWR1Y2VGaWVsZERlZigodGltZVVuaXRDb21wb25lbnQ6IFRpbWVVbml0Q29tcG9uZW50LCBmaWVsZERlZikgPT4ge1xuICAgICAgaWYgKGZpZWxkRGVmLnRpbWVVbml0KSB7XG4gICAgICAgIGNvbnN0IGYgPSB2Z0ZpZWxkKGZpZWxkRGVmKTtcbiAgICAgICAgdGltZVVuaXRDb21wb25lbnRbZl0gPSB7XG4gICAgICAgICAgYXM6IGYsXG4gICAgICAgICAgdGltZVVuaXQ6IGZpZWxkRGVmLnRpbWVVbml0LFxuICAgICAgICAgIGZpZWxkOiBmaWVsZERlZi5maWVsZFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRpbWVVbml0Q29tcG9uZW50O1xuICAgIH0sIHt9IGFzIERpY3Q8VGltZVVuaXRDb21wb25lbnQ+KTtcblxuICAgIGlmIChrZXlzKGZvcm11bGEpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBUaW1lVW5pdE5vZGUocGFyZW50LCBmb3JtdWxhKTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgbWFrZUZyb21UcmFuc2Zvcm0ocGFyZW50OiBEYXRhRmxvd05vZGUsIHQ6IFRpbWVVbml0VHJhbnNmb3JtKSB7XG4gICAgcmV0dXJuIG5ldyBUaW1lVW5pdE5vZGUocGFyZW50LCB7XG4gICAgICBbdC5maWVsZF06IHtcbiAgICAgICAgYXM6IHQuYXMsXG4gICAgICAgIHRpbWVVbml0OiB0LnRpbWVVbml0LFxuICAgICAgICBmaWVsZDogdC5maWVsZFxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIG1lcmdlKG90aGVyOiBUaW1lVW5pdE5vZGUpIHtcbiAgICB0aGlzLmZvcm11bGEgPSB7Li4udGhpcy5mb3JtdWxhLCAuLi5vdGhlci5mb3JtdWxhfTtcbiAgICBvdGhlci5yZW1vdmUoKTtcbiAgfVxuXG4gIHB1YmxpYyBwcm9kdWNlZEZpZWxkcygpIHtcbiAgICBjb25zdCBvdXQgPSB7fTtcblxuICAgIHZhbHModGhpcy5mb3JtdWxhKS5mb3JFYWNoKGYgPT4ge1xuICAgICAgb3V0W2YuYXNdID0gdHJ1ZTtcbiAgICB9KTtcblxuICAgIHJldHVybiBvdXQ7XG4gIH1cblxuICBwdWJsaWMgZGVwZW5kZW50RmllbGRzKCkge1xuICAgIGNvbnN0IG91dCA9IHt9O1xuXG4gICAgdmFscyh0aGlzLmZvcm11bGEpLmZvckVhY2goZiA9PiB7XG4gICAgICBvdXRbZi5maWVsZF0gPSB0cnVlO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIG91dDtcbiAgfVxuXG4gIHB1YmxpYyBhc3NlbWJsZSgpIHtcbiAgICByZXR1cm4gdmFscyh0aGlzLmZvcm11bGEpLm1hcChjID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdmb3JtdWxhJyxcbiAgICAgICAgYXM6IGMuYXMsXG4gICAgICAgIGV4cHI6IGZpZWxkRXhwcihjLnRpbWVVbml0LCBjLmZpZWxkKVxuICAgICAgfSBhcyBWZ0Zvcm11bGFUcmFuc2Zvcm07XG4gICAgfSk7XG4gIH1cbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { hasIntersection, keys } from '../../util';\nimport { OutputNode } from './dataflow';\nimport { FacetNode } from './facet';\nimport { ParseNode } from './formatparse';\nimport { SourceNode } from './source';\nimport { TimeUnitNode } from './timeunit';\n/**\n * Start optimization path at the leaves. Useful for merging up or removing things.\n *\n * If the callback returns true, the recursion continues.\n */\nexport function iterateFromLeaves(f) {\n    function optimizeNextFromLeaves(node) {\n        if (node instanceof SourceNode) {\n            return;\n        }\n        var next = node.parent;\n        if (f(node)) {\n            optimizeNextFromLeaves(next);\n        }\n    }\n    return optimizeNextFromLeaves;\n}\n/**\n * Move parse nodes up to forks.\n */\nexport function moveParseUp(node) {\n    var parent = node.parent;\n    // move parse up by merging or swapping\n    if (node instanceof ParseNode) {\n        if (parent instanceof SourceNode) {\n            return false;\n        }\n        if (parent.numChildren() > 1) {\n            // don't move parse further up but continue with parent.\n            return true;\n        }\n        if (parent instanceof ParseNode) {\n            parent.merge(node);\n        }\n        else {\n            // don't swap with nodes that produce something that the parse node depends on (e.g. lookup)\n            if (hasIntersection(parent.producedFields(), node.dependentFields())) {\n                return true;\n            }\n            node.swapWithParent();\n        }\n    }\n    return true;\n}\n/**\n * Repeatedly remove leaf nodes that are not output or facet nodes.\n * The reason is that we don't need subtrees that don't have any output nodes.\n * Facet nodes are needed for the row or column domains.\n */\nexport function removeUnusedSubtrees(node) {\n    if (node instanceof OutputNode || node.numChildren() > 0 || node instanceof FacetNode) {\n        // no need to continue with parent because it is output node or will have children (there was a fork)\n        return false;\n    }\n    else {\n        node.remove();\n    }\n    return true;\n}\n/**\n * Removes duplicate time unit nodes (as determined by the name of the\n * output field) that may be generated due to selections projected over\n * time units.\n */\nexport function removeDuplicateTimeUnits(leaf) {\n    var fields = {};\n    return iterateFromLeaves(function (node) {\n        if (node instanceof TimeUnitNode) {\n            var pfields = node.producedFields();\n            var dupe = keys(pfields).every(function (k) { return !!fields[k]; });\n            if (dupe) {\n                node.remove();\n            }\n            else {\n                fields = tslib_1.__assign({}, fields, pfields);\n            }\n        }\n        return true;\n    })(leaf);\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3B0aW1pemVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21waWxlL2RhdGEvb3B0aW1pemVycy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFDLGVBQWUsRUFBRSxJQUFJLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDakQsT0FBTyxFQUFlLFVBQVUsRUFBQyxNQUFNLFlBQVksQ0FBQztBQUNwRCxPQUFPLEVBQUMsU0FBUyxFQUFDLE1BQU0sU0FBUyxDQUFDO0FBQ2xDLE9BQU8sRUFBQyxTQUFTLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDeEMsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLFVBQVUsQ0FBQztBQUNwQyxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBR3hDOzs7O0dBSUc7QUFDSCxNQUFNLDRCQUE0QixDQUFrQztJQUNsRSxnQ0FBZ0MsSUFBa0I7UUFDaEQsSUFBSSxJQUFJLFlBQVksVUFBVSxFQUFFO1lBQzlCLE9BQU87U0FDUjtRQUVELElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUM7UUFDekIsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUU7WUFDWCxzQkFBc0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUM5QjtJQUNILENBQUM7SUFFRCxPQUFPLHNCQUFzQixDQUFDO0FBQ2hDLENBQUM7QUFFRDs7R0FFRztBQUNILE1BQU0sc0JBQXNCLElBQWtCO0lBQzVDLElBQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUM7SUFFM0IsdUNBQXVDO0lBQ3ZDLElBQUksSUFBSSxZQUFZLFNBQVMsRUFBRTtRQUM3QixJQUFJLE1BQU0sWUFBWSxVQUFVLEVBQUU7WUFDaEMsT0FBTyxLQUFLLENBQUM7U0FDZDtRQUVELElBQUksTUFBTSxDQUFDLFdBQVcsRUFBRSxHQUFHLENBQUMsRUFBRTtZQUM1Qix3REFBd0Q7WUFDeEQsT0FBTyxJQUFJLENBQUM7U0FDYjtRQUVELElBQUksTUFBTSxZQUFZLFNBQVMsRUFBRTtZQUMvQixNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ3BCO2FBQU07WUFDTCw0RkFBNEY7WUFDNUYsSUFBSSxlQUFlLENBQUMsTUFBTSxDQUFDLGNBQWMsRUFBRSxFQUFFLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQyxFQUFFO2dCQUNwRSxPQUFPLElBQUksQ0FBQzthQUNiO1lBRUQsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1NBQ3ZCO0tBQ0Y7SUFFRCxPQUFPLElBQUksQ0FBQztBQUNkLENBQUM7QUFFRDs7OztHQUlHO0FBQ0gsTUFBTSwrQkFBK0IsSUFBa0I7SUFDckQsSUFBSSxJQUFJLFlBQVksVUFBVSxJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUUsR0FBRyxDQUFDLElBQUksSUFBSSxZQUFZLFNBQVMsRUFBRTtRQUNyRixxR0FBcUc7UUFDckcsT0FBTyxLQUFLLENBQUM7S0FDZDtTQUFNO1FBQ0wsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDO0tBQ2Y7SUFDRCxPQUFPLElBQUksQ0FBQztBQUNkLENBQUM7QUFFRDs7OztHQUlHO0FBQ0gsTUFBTSxtQ0FBbUMsSUFBa0I7SUFDekQsSUFBSSxNQUFNLEdBQUcsRUFBRSxDQUFDO0lBQ2hCLE9BQU8saUJBQWlCLENBQUMsVUFBQyxJQUFrQjtRQUMxQyxJQUFJLElBQUksWUFBWSxZQUFZLEVBQUU7WUFDaEMsSUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO1lBQ3RDLElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxLQUFLLENBQUMsVUFBQyxDQUFDLElBQUssT0FBQSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFYLENBQVcsQ0FBQyxDQUFDO1lBRXJELElBQUksSUFBSSxFQUFFO2dCQUNSLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQzthQUNmO2lCQUFNO2dCQUNMLE1BQU0sd0JBQU8sTUFBTSxFQUFLLE9BQU8sQ0FBQyxDQUFDO2FBQ2xDO1NBQ0Y7UUFFRCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ1gsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7aGFzSW50ZXJzZWN0aW9uLCBrZXlzfSBmcm9tICcuLi8uLi91dGlsJztcbmltcG9ydCB7RGF0YUZsb3dOb2RlLCBPdXRwdXROb2RlfSBmcm9tICcuL2RhdGFmbG93JztcbmltcG9ydCB7RmFjZXROb2RlfSBmcm9tICcuL2ZhY2V0JztcbmltcG9ydCB7UGFyc2VOb2RlfSBmcm9tICcuL2Zvcm1hdHBhcnNlJztcbmltcG9ydCB7U291cmNlTm9kZX0gZnJvbSAnLi9zb3VyY2UnO1xuaW1wb3J0IHtUaW1lVW5pdE5vZGV9IGZyb20gJy4vdGltZXVuaXQnO1xuXG5cbi8qKlxuICogU3RhcnQgb3B0aW1pemF0aW9uIHBhdGggYXQgdGhlIGxlYXZlcy4gVXNlZnVsIGZvciBtZXJnaW5nIHVwIG9yIHJlbW92aW5nIHRoaW5ncy5cbiAqXG4gKiBJZiB0aGUgY2FsbGJhY2sgcmV0dXJucyB0cnVlLCB0aGUgcmVjdXJzaW9uIGNvbnRpbnVlcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGl0ZXJhdGVGcm9tTGVhdmVzKGY6IChub2RlOiBEYXRhRmxvd05vZGUpID0+IGJvb2xlYW4pIHtcbiAgZnVuY3Rpb24gb3B0aW1pemVOZXh0RnJvbUxlYXZlcyhub2RlOiBEYXRhRmxvd05vZGUpIHtcbiAgICBpZiAobm9kZSBpbnN0YW5jZW9mIFNvdXJjZU5vZGUpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBuZXh0ID0gbm9kZS5wYXJlbnQ7XG4gICAgaWYgKGYobm9kZSkpIHtcbiAgICAgIG9wdGltaXplTmV4dEZyb21MZWF2ZXMobmV4dCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG9wdGltaXplTmV4dEZyb21MZWF2ZXM7XG59XG5cbi8qKlxuICogTW92ZSBwYXJzZSBub2RlcyB1cCB0byBmb3Jrcy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1vdmVQYXJzZVVwKG5vZGU6IERhdGFGbG93Tm9kZSkge1xuICBjb25zdCBwYXJlbnQgPSBub2RlLnBhcmVudDtcblxuICAvLyBtb3ZlIHBhcnNlIHVwIGJ5IG1lcmdpbmcgb3Igc3dhcHBpbmdcbiAgaWYgKG5vZGUgaW5zdGFuY2VvZiBQYXJzZU5vZGUpIHtcbiAgICBpZiAocGFyZW50IGluc3RhbmNlb2YgU291cmNlTm9kZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChwYXJlbnQubnVtQ2hpbGRyZW4oKSA+IDEpIHtcbiAgICAgIC8vIGRvbid0IG1vdmUgcGFyc2UgZnVydGhlciB1cCBidXQgY29udGludWUgd2l0aCBwYXJlbnQuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAocGFyZW50IGluc3RhbmNlb2YgUGFyc2VOb2RlKSB7XG4gICAgICBwYXJlbnQubWVyZ2Uobm9kZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGRvbid0IHN3YXAgd2l0aCBub2RlcyB0aGF0IHByb2R1Y2Ugc29tZXRoaW5nIHRoYXQgdGhlIHBhcnNlIG5vZGUgZGVwZW5kcyBvbiAoZS5nLiBsb29rdXApXG4gICAgICBpZiAoaGFzSW50ZXJzZWN0aW9uKHBhcmVudC5wcm9kdWNlZEZpZWxkcygpLCBub2RlLmRlcGVuZGVudEZpZWxkcygpKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgbm9kZS5zd2FwV2l0aFBhcmVudCgpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufVxuXG4vKipcbiAqIFJlcGVhdGVkbHkgcmVtb3ZlIGxlYWYgbm9kZXMgdGhhdCBhcmUgbm90IG91dHB1dCBvciBmYWNldCBub2Rlcy5cbiAqIFRoZSByZWFzb24gaXMgdGhhdCB3ZSBkb24ndCBuZWVkIHN1YnRyZWVzIHRoYXQgZG9uJ3QgaGF2ZSBhbnkgb3V0cHV0IG5vZGVzLlxuICogRmFjZXQgbm9kZXMgYXJlIG5lZWRlZCBmb3IgdGhlIHJvdyBvciBjb2x1bW4gZG9tYWlucy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZVVudXNlZFN1YnRyZWVzKG5vZGU6IERhdGFGbG93Tm9kZSkge1xuICBpZiAobm9kZSBpbnN0YW5jZW9mIE91dHB1dE5vZGUgfHwgbm9kZS5udW1DaGlsZHJlbigpID4gMCB8fCBub2RlIGluc3RhbmNlb2YgRmFjZXROb2RlKSB7XG4gICAgLy8gbm8gbmVlZCB0byBjb250aW51ZSB3aXRoIHBhcmVudCBiZWNhdXNlIGl0IGlzIG91dHB1dCBub2RlIG9yIHdpbGwgaGF2ZSBjaGlsZHJlbiAodGhlcmUgd2FzIGEgZm9yaylcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0gZWxzZSB7XG4gICAgbm9kZS5yZW1vdmUoKTtcbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cblxuLyoqXG4gKiBSZW1vdmVzIGR1cGxpY2F0ZSB0aW1lIHVuaXQgbm9kZXMgKGFzIGRldGVybWluZWQgYnkgdGhlIG5hbWUgb2YgdGhlXG4gKiBvdXRwdXQgZmllbGQpIHRoYXQgbWF5IGJlIGdlbmVyYXRlZCBkdWUgdG8gc2VsZWN0aW9ucyBwcm9qZWN0ZWQgb3ZlclxuICogdGltZSB1bml0cy5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUR1cGxpY2F0ZVRpbWVVbml0cyhsZWFmOiBEYXRhRmxvd05vZGUpIHtcbiAgbGV0IGZpZWxkcyA9IHt9O1xuICByZXR1cm4gaXRlcmF0ZUZyb21MZWF2ZXMoKG5vZGU6IERhdGFGbG93Tm9kZSkgPT4ge1xuICAgIGlmIChub2RlIGluc3RhbmNlb2YgVGltZVVuaXROb2RlKSB7XG4gICAgICBjb25zdCBwZmllbGRzID0gbm9kZS5wcm9kdWNlZEZpZWxkcygpO1xuICAgICAgY29uc3QgZHVwZSA9IGtleXMocGZpZWxkcykuZXZlcnkoKGspID0+ICEhZmllbGRzW2tdKTtcblxuICAgICAgaWYgKGR1cGUpIHtcbiAgICAgICAgbm9kZS5yZW1vdmUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZpZWxkcyA9IHsuLi5maWVsZHMsIC4uLnBmaWVsZHN9O1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9KShsZWFmKTtcbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { isArray, isString } from 'vega-util';\nimport { isFieldDef, vgField } from '../../fielddef';\nimport { duplicate } from '../../util';\nimport { sortParams } from '../common';\nimport { DataFlowNode } from './dataflow';\nfunction getStackByFields(model) {\n    return model.stack.stackBy.reduce(function (fields, by) {\n        var fieldDef = by.fieldDef;\n        var _field = vgField(fieldDef);\n        if (_field) {\n            fields.push(_field);\n        }\n        return fields;\n    }, []);\n}\nfunction isValidAsArray(as) {\n    return isArray(as) && as.every(function (s) { return isString(s); }) && as.length > 1;\n}\nvar StackNode = /** @class */ (function (_super) {\n    tslib_1.__extends(StackNode, _super);\n    function StackNode(parent, stack) {\n        var _this = _super.call(this, parent) || this;\n        _this._stack = stack;\n        return _this;\n    }\n    StackNode.prototype.clone = function () {\n        return new StackNode(null, duplicate(this._stack));\n    };\n    StackNode.makeFromTransform = function (parent, stackTransform) {\n        var stack = stackTransform.stack, groupby = stackTransform.groupby, as = stackTransform.as, _a = stackTransform.offset, offset = _a === void 0 ? 'zero' : _a;\n        var sortFields = [];\n        var sortOrder = [];\n        if (stackTransform.sort !== undefined) {\n            for (var _i = 0, _b = stackTransform.sort; _i < _b.length; _i++) {\n                var sortField = _b[_i];\n                sortFields.push(sortField.field);\n                sortOrder.push(sortField.order === undefined ? 'ascending' : sortField.order);\n            }\n        }\n        var sort = {\n            field: sortFields,\n            order: sortOrder,\n        };\n        var normalizedAs;\n        if (isValidAsArray(as)) {\n            normalizedAs = as;\n        }\n        else if (isString(as)) {\n            normalizedAs = [as, as + '_end'];\n        }\n        else {\n            normalizedAs = [stackTransform.stack + '_start', stackTransform.stack + '_end'];\n        }\n        return new StackNode(parent, {\n            stackField: stack,\n            groupby: groupby,\n            offset: offset,\n            sort: sort,\n            facetby: [],\n            as: normalizedAs\n        });\n    };\n    StackNode.makeFromEncoding = function (parent, model) {\n        var stackProperties = model.stack;\n        if (!stackProperties) {\n            return null;\n        }\n        var dimensionFieldDef;\n        if (stackProperties.groupbyChannel) {\n            dimensionFieldDef = model.fieldDef(stackProperties.groupbyChannel);\n        }\n        var stackby = getStackByFields(model);\n        var orderDef = model.encoding.order;\n        var sort;\n        if (isArray(orderDef) || isFieldDef(orderDef)) {\n            sort = sortParams(orderDef);\n        }\n        else {\n            // default = descending by stackFields\n            // FIXME is the default here correct for binned fields?\n            sort = stackby.reduce(function (s, field) {\n                s.field.push(field);\n                s.order.push('descending');\n                return s;\n            }, { field: [], order: [] });\n        }\n        // Refactored to add \"as\" in the make phase so that we can get producedFields\n        // from the as property\n        var field = model.vgField(stackProperties.fieldChannel);\n        return new StackNode(parent, {\n            dimensionFieldDef: dimensionFieldDef,\n            stackField: field,\n            facetby: [],\n            stackby: stackby,\n            sort: sort,\n            offset: stackProperties.offset,\n            impute: stackProperties.impute,\n            as: [field + '_start', field + '_end']\n        });\n    };\n    Object.defineProperty(StackNode.prototype, \"stack\", {\n        get: function () {\n            return this._stack;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    StackNode.prototype.addDimensions = function (fields) {\n        this._stack.facetby = this._stack.facetby.concat(fields);\n    };\n    StackNode.prototype.dependentFields = function () {\n        var out = {};\n        out[this._stack.stackField] = true;\n        this.getGroupbyFields().forEach(function (f) { return out[f] = true; });\n        this._stack.facetby.forEach(function (f) { return out[f] = true; });\n        var field = this._stack.sort.field;\n        isArray(field) ? field.forEach(function (f) { return out[f] = true; }) : out[field] = true;\n        return out;\n    };\n    StackNode.prototype.producedFields = function () {\n        return this._stack.as.reduce(function (result, item) {\n            result[item] = true;\n            return result;\n        }, {});\n    };\n    StackNode.prototype.getGroupbyFields = function () {\n        var _a = this._stack, dimensionFieldDef = _a.dimensionFieldDef, impute = _a.impute, groupby = _a.groupby;\n        if (dimensionFieldDef) {\n            if (dimensionFieldDef.bin) {\n                if (impute) {\n                    // For binned group by field with impute, we calculate bin_mid\n                    // as we cannot impute two fields simultaneously\n                    return [vgField(dimensionFieldDef, { binSuffix: 'mid' })];\n                }\n                return [\n                    // For binned group by field without impute, we need both bin (start) and bin_end\n                    vgField(dimensionFieldDef, {}),\n                    vgField(dimensionFieldDef, { binSuffix: 'end' })\n                ];\n            }\n            return [vgField(dimensionFieldDef)];\n        }\n        return groupby || [];\n    };\n    StackNode.prototype.assemble = function () {\n        var transform = [];\n        var _a = this._stack, facetby = _a.facetby, dimensionFieldDef = _a.dimensionFieldDef, field = _a.stackField, stackby = _a.stackby, sort = _a.sort, offset = _a.offset, impute = _a.impute, as = _a.as;\n        // Impute\n        if (impute && dimensionFieldDef) {\n            var dimensionField = dimensionFieldDef ? vgField(dimensionFieldDef, { binSuffix: 'mid' }) : undefined;\n            if (dimensionFieldDef.bin) {\n                // As we can only impute one field at a time, we need to calculate\n                // mid point for a binned field\n                transform.push({\n                    type: 'formula',\n                    expr: '(' +\n                        vgField(dimensionFieldDef, { expr: 'datum' }) +\n                        '+' +\n                        vgField(dimensionFieldDef, { expr: 'datum', binSuffix: 'end' }) +\n                        ')/2',\n                    as: dimensionField\n                });\n            }\n            transform.push({\n                type: 'impute',\n                field: field,\n                groupby: stackby,\n                key: dimensionField,\n                method: 'value',\n                value: 0\n            });\n        }\n        // Stack\n        transform.push({\n            type: 'stack',\n            groupby: this.getGroupbyFields().concat(facetby),\n            field: field,\n            sort: sort,\n            as: as,\n            offset: offset\n        });\n        return transform;\n    };\n    return StackNode;\n}(DataFlowNode));\nexport { StackNode };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhY2suanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9kYXRhL3N0YWNrLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUMsT0FBTyxFQUFFLFFBQVEsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUM1QyxPQUFPLEVBQVcsVUFBVSxFQUFFLE9BQU8sRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBRzdELE9BQU8sRUFBQyxTQUFTLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFFckMsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUVyQyxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBRXhDLDBCQUEwQixLQUFnQjtJQUN4QyxPQUFPLEtBQUssQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxVQUFDLE1BQU0sRUFBRSxFQUFFO1FBQzNDLElBQU0sUUFBUSxHQUFHLEVBQUUsQ0FBQyxRQUFRLENBQUM7UUFFN0IsSUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2pDLElBQUksTUFBTSxFQUFFO1lBQ1YsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztTQUNyQjtRQUNELE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUMsRUFBRSxFQUFjLENBQUMsQ0FBQztBQUNyQixDQUFDO0FBZ0RELHdCQUF3QixFQUFxQjtJQUMzQyxPQUFPLE9BQU8sQ0FBQyxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUMsS0FBSyxDQUFDLFVBQUEsQ0FBQyxJQUFJLE9BQUEsUUFBUSxDQUFDLENBQUMsQ0FBQyxFQUFYLENBQVcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxNQUFNLEdBQUUsQ0FBQyxDQUFDO0FBQ25FLENBQUM7QUFFRDtJQUErQixxQ0FBWTtJQU96QyxtQkFBWSxNQUFvQixFQUFFLEtBQXFCO1FBQXZELFlBQ0Usa0JBQU0sTUFBTSxD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QUNkLEtBQUssT0FBQTtnQkFDTCxPQUFPLEVBQUUsT0FBTztnQkFDaEIsR0FBRyxFQUFFLGNBQWM7Z0JBQ25CLE1BQU0sRUFBRSxPQUFPO2dCQUNmLEtBQUssRUFBRSxDQUFDO2FBQ1QsQ0FBQyxDQUFDO1NBQ0o7UUFFRCxRQUFRO1FBQ1IsU0FBUyxDQUFDLElBQUksQ0FBQztZQUNiLElBQUksRUFBRSxPQUFPO1lBQ2IsT0FBTyxFQUFFLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUM7WUFDaEQsS0FBSyxPQUFBO1lBQ0wsSUFBSSxNQUFBO1lBQ0osRUFBRSxJQUFBO1lBQ0YsTUFBTSxRQUFBO1NBQ1AsQ0FBQyxDQUFDO1FBRUgsT0FBTyxTQUFTLENBQUM7SUFDbkIsQ0FBQztJQUNILGdCQUFDO0FBQUQsQ0FBQyxBQXhMRCxDQUErQixZQUFZLEdBd0wxQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7aXNBcnJheSwgaXNTdHJpbmd9IGZyb20gJ3ZlZ2EtdXRpbCc7XG5pbXBvcnQge0ZpZWxkRGVmLCBpc0ZpZWxkRGVmLCB2Z0ZpZWxkfSBmcm9tICcuLi8uLi9maWVsZGRlZic7XG5pbXBvcnQge1N0YWNrT2Zmc2V0fSBmcm9tICcuLi8uLi9zdGFjayc7XG5pbXBvcnQge1N0YWNrVHJhbnNmb3JtfSBmcm9tICcuLi8uLi90cmFuc2Zvcm0nO1xuaW1wb3J0IHtkdXBsaWNhdGV9IGZyb20gJy4uLy4uL3V0aWwnO1xuaW1wb3J0IHtWZ0NvbXBhcmF0b3JPcmRlciwgVmdTb3J0LCBWZ1RyYW5zZm9ybX0gZnJvbSAnLi4vLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtzb3J0UGFyYW1zfSBmcm9tICcuLi9jb21tb24nO1xuaW1wb3J0IHtVbml0TW9kZWx9IGZyb20gJy4vLi4vdW5pdCc7XG5pbXBvcnQge0RhdGFGbG93Tm9kZX0gZnJvbSAnLi9kYXRhZmxvdyc7XG5cbmZ1bmN0aW9uIGdldFN0YWNrQnlGaWVsZHMobW9kZWw6IFVuaXRNb2RlbCk6IHN0cmluZ1tdIHtcbiAgcmV0dXJuIG1vZGVsLnN0YWNrLnN0YWNrQnkucmVkdWNlKChmaWVsZHMsIGJ5KSA9PiB7XG4gICAgY29uc3QgZmllbGREZWYgPSBieS5maWVsZERlZjtcblxuICAgIGNvbnN0IF9maWVsZCA9IHZnRmllbGQoZmllbGREZWYpO1xuICAgIGlmIChfZmllbGQpIHtcbiAgICAgIGZpZWxkcy5wdXNoKF9maWVsZCk7XG4gICAgfVxuICAgIHJldHVybiBmaWVsZHM7XG4gIH0sIFtdIGFzIHN0cmluZ1tdKTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdGFja0NvbXBvbmVudCB7XG5cbiAgLyoqXG4gICAqIEZhY2V0ZWQgZmllbGQuXG4gICAqL1xuICBmYWNldGJ5OiBzdHJpbmdbXTtcblxuICBkaW1lbnNpb25GaWVsZERlZj86IEZpZWxkRGVmPHN0cmluZz47XG5cbiAgLyoqXG4gICAqIFN0YWNrIG1lYXN1cmUncyBmaWVsZC4gVXNlZCBpbiBtYWtlRnJvbUVuY29kaW5nLlxuICAgKi9cbiAgc3RhY2tGaWVsZDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBMZXZlbCBvZiBkZXRhaWwgZmllbGRzIGZvciBlYWNoIGxldmVsIGluIHRoZSBzdGFja2VkIGNoYXJ0cyBzdWNoIGFzIGNvbG9yIG9yIGRldGFpbC5cbiAgICogVXNlZCBpbiBtYWtlRnJvbUVuY29kaW5nLlxuICAgKi9cbiAgc3RhY2tieT86IHN0cmluZ1tdO1xuXG4gIC8qKlxuICAgKiBGaWVsZCB0aGF0IGRldGVybWluZXMgb3JkZXIgb2YgbGV2ZWxzIGluIHRoZSBzdGFja2VkIGNoYXJ0cy5cbiAgICogVXNlZCBpbiBib3RoIGJ1dCBvcHRpb25hbCBpbiB0cmFuc2Zvcm0uXG4gICAqL1xuICBzb3J0OiBWZ1NvcnQ7XG5cbiAgLyoqIE1vZGUgZm9yIHN0YWNraW5nIG1hcmtzLlxuICAgKi9cbiAgb2Zmc2V0OiBTdGFja09mZnNldDtcblxuICAvKipcbiAgICogV2hldGhlciB0byBpbXB1dGUgdGhlIGRhdGEgYmVmb3JlIHN0YWNraW5nLiBVc2VkIG9ubHkgaW4gbWFrZUZyb21FbmNvZGluZy5cbiAgICovXG4gIGltcHV0ZT86IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFRoZSBkYXRhIGZpZWxkcyB0byBncm91cCBieS5cbiAgICovXG4gIGdyb3VwYnk/OiBzdHJpbmdbXTtcbiAgLyoqXG4gICAqIE91dHB1dCBmaWVsZCBuYW1lcyBvZiBlYWNoIHN0YWNrIGZpZWxkLlxuICAgKi9cbiAgYXM6IHN0cmluZ1tdO1xuXG59XG5cbmZ1bmN0aW9uIGlzVmFsaWRBc0FycmF5KGFzOiBzdHJpbmdbXSB8IHN0cmluZyk6IGFzIGlzIHN0cmluZ1tdIHtcbiAgcmV0dXJuIGlzQXJyYXkoYXMpICYmIGFzLmV2ZXJ5KHMgPT4gaXNTdHJpbmcocykpICYmIGFzLmxlbmd0aCA+MTtcbn1cblxuZXhwb3J0IGNsYXNzIFN0YWNrTm9kZSBleHRlbmRzIERhdGFGbG93Tm9kZSB7XG4gIHByaXZhdGUgX3N0YWNrOiBTdGFja0NvbXBvbmVudDtcblxuICBwdWJsaWMgY2xvbmUoKSB7XG4gICAgcmV0dXJuIG5ldyBTdGFja05vZGUobnVsbCwgZHVwbGljYXRlKHRoaXMuX3N0YWNrKSk7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihwYXJlbnQ6IERhdGFGbG93Tm9kZSwgc3RhY2s6IFN0YWNrQ29tcG9uZW50KSB7XG4gICAgc3VwZXIocGFyZW50KTtcblxuICAgIHRoaXMuX3N0YWNrID0gc3RhY2s7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIG1ha2VGcm9tVHJhbnNmb3JtKHBhcmVudDogRGF0YUZsb3dOb2RlLCBzdGFja1RyYW5zZm9ybTogU3RhY2tUcmFuc2Zvcm0pIHtcblxuICAgIGNvbnN0IHtzdGFjaywgZ3JvdXBieSwgYXMsIG9mZnNldD0nemVybyd9ID0gc3RhY2tUcmFuc2Zvcm07XG5cbiAgICBjb25zdCBzb3J0RmllbGRzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IHNvcnRPcmRlcjogVmdDb21wYXJhdG9yT3JkZXJbXSA9IFtdO1xuICAgIGlmIChzdGFja1RyYW5zZm9ybS5zb3J0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGZvciAoY29uc3Qgc29ydEZpZWxkIG9mIHN0YWNrVHJhbnNmb3JtLnNvcnQpIHtcbiAgICAgICAgc29ydEZpZWxkcy5wdXNoKHNvcnRGaWVsZC5maWVsZCk7XG4gICAgICAgIHNvcnRPcmRlci5wdXNoKHNvcnRGaWVsZC5vcmRlciA9PT0gdW5kZWZpbmVkID8gJ2FzY2VuZGluZycgOiBzb3J0RmllbGQub3JkZXIgYXMgVmdDb21wYXJhdG9yT3JkZXIpO1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBzb3J0OiBWZ1NvcnQgPSB7XG4gICAgICBmaWVsZDogc29ydEZpZWxkcyxcbiAgICAgIG9yZGVyOiBzb3J0T3JkZXIsXG4gICAgfTtcbiAgICBsZXQgbm9ybWFsaXplZEFzOiBBcnJheTxzdHJpbmc+O1xuICAgIGlmIChpc1ZhbGlkQXNBcnJheShhcykpIHtcbiAgICAgIG5vcm1hbGl6ZWRBcyA9IGFzO1xuICAgIH0gZWxzZSBpZihpc1N0cmluZyhhcykpIHtcbiAgICAgIG5vcm1hbGl6ZWRBcyA9IFthcywgYXMgKyAnX2VuZCddO1xuICAgIH0gZWxzZSB7XG4gICAgICBub3JtYWxpemVkQXMgPSBbc3RhY2tUcmFuc2Zvcm0uc3RhY2sgKyAnX3N0YXJ0Jywgc3RhY2tUcmFuc2Zvcm0uc3RhY2sgKyAnX2VuZCddO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgU3RhY2tOb2RlIChwYXJlbnQsIHtcbiAgICAgIHN0YWNrRmllbGQ6IHN0YWNrLFxuICAgICAgZ3JvdXBieSxcbiAgICAgIG9mZnNldCxcbiAgICAgIHNvcnQsXG4gICAgICBmYWNldGJ5OiBbXSxcbiAgICAgIGFzOiBub3JtYWxpemVkQXNcbiAgICB9KTtcblxuICB9XG4gIHB1YmxpYyBzdGF0aWMgbWFrZUZyb21FbmNvZGluZyhwYXJlbnQ6IERhdGFGbG93Tm9kZSwgbW9kZWw6IFVuaXRNb2RlbCkge1xuXG4gICAgY29uc3Qgc3RhY2tQcm9wZXJ0aWVzID0gbW9kZWwuc3RhY2s7XG5cbiAgICBpZiAoIXN0YWNrUHJvcGVydGllcykge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgbGV0IGRpbWVuc2lvbkZpZWxkRGVmOiBGaWVsZERlZjxzdHJpbmc+O1xuICAgIGlmIChzdGFja1Byb3BlcnRpZXMuZ3JvdXBieUNoYW5uZWwpIHtcbiAgICAgIGRpbWVuc2lvbkZpZWxkRGVmID0gbW9kZWwuZmllbGREZWYoc3RhY2tQcm9wZXJ0aWVzLmdyb3VwYnlDaGFubmVsKTtcbiAgICB9XG5cbiAgICBjb25zdCBzdGFja2J5ID0gZ2V0U3RhY2tCeUZpZWxkcyhtb2RlbCk7XG4gICAgY29uc3Qgb3JkZXJEZWYgPSBtb2RlbC5lbmNvZGluZy5vcmRlcjtcblxuICAgIGxldCBzb3J0OiBWZ1NvcnQ7XG4gICAgaWYgKGlzQXJyYXkob3JkZXJEZWYpIHx8IGlzRmllbGREZWYob3JkZXJEZWYpKSB7XG4gICAgICBzb3J0ID0gc29ydFBhcmFtcyhvcmRlckRlZik7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIGRlZmF1bHQgPSBkZXNjZW5kaW5nIGJ5IHN0YWNrRmllbGRzXG4gICAgICAvLyBGSVhNRSBpcyB0aGUgZGVmYXVsdCBoZXJlIGNvcnJlY3QgZm9yIGJpbm5lZCBmaWVsZHM/XG4gICAgICBzb3J0ID0gc3RhY2tieS5yZWR1Y2UoKHMsIGZpZWxkKSA9PiB7XG4gICAgICAgIHMuZmllbGQucHVzaChmaWVsZCk7XG4gICAgICAgIHMub3JkZXIucHVzaCgnZGVzY2VuZGluZycpO1xuICAgICAgICByZXR1cm4gcztcbiAgICAgIH0sIHtmaWVsZDpbXSwgb3JkZXI6IFtdfSk7XG4gICAgfVxuICAgIC8vIFJlZmFjdG9yZWQgdG8gYWRkIFwiYXNcIiBpbiB0aGUgbWFrZSBwaGFzZSBzbyB0aGF0IHdlIGNhbiBnZXQgcHJvZHVjZWRGaWVsZHNcbiAgICAvLyBmcm9tIHRoZSBhcyBwcm9wZXJ0eVxuICAgIGNvbnN0IGZpZWxkID0gbW9kZWwudmdGaWVsZChzdGFja1Byb3BlcnRpZXMuZmllbGRDaGFubmVsKTtcblxuICAgIHJldHVybiBuZXcgU3RhY2tOb2RlKHBhcmVudCwge1xuICAgICAgZGltZW5zaW9uRmllbGREZWYsXG4gICAgICBzdGFja0ZpZWxkOmZpZWxkLFxuICAgICAgZmFjZXRieTogW10sXG4gICAgICBzdGFja2J5LFxuICAgICAgc29ydCxcbiAgICAgIG9mZnNldDogc3RhY2tQcm9wZXJ0aWVzLm9mZnNldCxcbiAgICAgIGltcHV0ZTogc3RhY2tQcm9wZXJ0aWVzLmltcHV0ZSxcbiAgICAgIGFzOiBbZmllbGQgKyAnX3N0YXJ0JywgZmllbGQgKyAnX2VuZCddXG4gICAgfSk7XG4gIH1cblxuICBnZXQgc3RhY2soKTogU3RhY2tDb21wb25lbnQge1xuICAgIHJldHVybiB0aGlzLl9zdGFjaztcbiAgfVxuXG4gIHB1YmxpYyBhZGREaW1lbnNpb25zKGZpZWxkczogc3RyaW5nW10pIHtcbiAgICB0aGlzLl9zdGFjay5mYWNldGJ5ID0gdGhpcy5fc3RhY2suZmFjZXRieS5jb25jYXQoZmllbGRzKTtcbiAgfVxuXG4gIHB1YmxpYyBkZXBlbmRlbnRGaWVsZHMoKSB7XG4gICAgY29uc3Qgb3V0ID0ge307XG5cbiAgICBvdXRbdGhpcy5fc3RhY2suc3RhY2tGaWVsZF0gPSB0cnVlO1xuXG4gICAgdGhpcy5nZXRHcm91cGJ5RmllbGRzKCkuZm9yRWFjaChmID0+IG91dFtmXSA9IHRydWUpO1xuICAgIHRoaXMuX3N0YWNrLmZhY2V0YnkuZm9yRWFjaChmID0+IG91dFtmXSA9IHRydWUpO1xuICAgIGNvbnN0IGZpZWxkID0gdGhpcy5fc3RhY2suc29ydC5maWVsZDtcbiAgICBpc0FycmF5KGZpZWxkKSA/IGZpZWxkLmZvckVhY2goZiA9PiBvdXRbZl0gPSB0cnVlKSA6IG91dFtmaWVsZF0gPSB0cnVlO1xuXG4gICAgcmV0dXJuIG91dDtcbiAgfVxuXG4gIHB1YmxpYyBwcm9kdWNlZEZpZWxkcygpIHtcbiAgICByZXR1cm4gdGhpcy5fc3RhY2suYXMucmVkdWNlKChyZXN1bHQsIGl0ZW0pID0+IHtcbiAgICAgIHJlc3VsdFtpdGVtXSA9IHRydWU7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0sIHt9KTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0R3JvdXBieUZpZWxkcygpIHtcbiAgICBjb25zdCB7ZGltZW5zaW9uRmllbGREZWYsIGltcHV0ZSwgZ3JvdXBieX0gPSB0aGlzLl9zdGFjaztcbiAgICBpZiAoZGltZW5zaW9uRmllbGREZWYpIHtcbiAgICAgIGlmIChkaW1lbnNpb25GaWVsZERlZi5iaW4pIHtcbiAgICAgICAgaWYgKGltcHV0ZSkge1xuICAgICAgICAgIC8vIEZvciBiaW5uZWQgZ3JvdXAgYnkgZmllbGQgd2l0aCBpbXB1dGUsIHdlIGNhbGN1bGF0ZSBiaW5fbWlkXG4gICAgICAgICAgLy8gYXMgd2UgY2Fubm90IGltcHV0ZSB0d28gZmllbGRzIHNpbXVsdGFuZW91c2x5XG4gICAgICAgICAgcmV0dXJuIFt2Z0ZpZWxkKGRpbWVuc2lvbkZpZWxkRGVmLCB7YmluU3VmZml4OiAnbWlkJ30pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgIC8vIEZvciBiaW5uZWQgZ3JvdXAgYnkgZmllbGQgd2l0aG91dCBpbXB1dGUsIHdlIG5lZWQgYm90aCBiaW4gKHN0YXJ0KSBhbmQgYmluX2VuZFxuICAgICAgICAgIHZnRmllbGQoZGltZW5zaW9uRmllbGREZWYsIHt9KSxcbiAgICAgICAgICB2Z0ZpZWxkKGRpbWVuc2lvbkZpZWxkRGVmLCB7YmluU3VmZml4OiAnZW5kJ30pXG4gICAgICAgIF07XG4gICAgICB9XG4gICAgICByZXR1cm4gW3ZnRmllbGQoZGltZW5zaW9uRmllbGREZWYpXTtcbiAgICB9XG4gICAgcmV0dXJuIGdyb3VwYnkgfHwgW107XG4gIH1cblxuICBwdWJsaWMgYXNzZW1ibGUoKTogVmdUcmFuc2Zvcm1bXSB7XG4gICAgY29uc3QgdHJhbnNmb3JtOiBWZ1RyYW5zZm9ybVtdID0gW107XG4gICAgY29uc3Qge2ZhY2V0YnksIGRpbWVuc2lvbkZpZWxkRGVmLCBzdGFja0ZpZWxkOiBmaWVsZCwgc3RhY2tieSwgc29ydCwgb2Zmc2V0LCBpbXB1dGUsIGFzfSA9IHRoaXMuX3N0YWNrO1xuXG4gICAgICAvLyBJbXB1dGVcbiAgICBpZiAoaW1wdXRlICYmIGRpbWVuc2lvbkZpZWxkRGVmKSB7XG4gICAgICBjb25zdCBkaW1lbnNpb25GaWVsZCA9IGRpbWVuc2lvbkZpZWxkRGVmID8gdmdGaWVsZChkaW1lbnNpb25GaWVsZERlZiwge2JpblN1ZmZpeDogJ21pZCd9KTogdW5kZWZpbmVkO1xuXG4gICAgICBpZiAoZGltZW5zaW9uRmllbGREZWYuYmluKSB7XG4gICAgICAgIC8vIEFzIHdlIGNhbiBvbmx5IGltcHV0ZSBvbmUgZmllbGQgYXQgYSB0aW1lLCB3ZSBuZWVkIHRvIGNhbGN1bGF0ZVxuICAgICAgICAvLyBtaWQgcG9pbnQgZm9yIGEgYmlubmVkIGZpZWxkXG4gICAgICAgIHRyYW5zZm9ybS5wdXNoKHtcbiAgICAgICAgICB0eXBlOiAnZm9ybXVsYScsXG4gICAgICAgICAgZXhwcjogJygnICtcbiAgICAgICAgICAgIHZnRmllbGQoZGltZW5zaW9uRmllbGREZWYsIHtleHByOiAnZGF0dW0nfSkgK1xuICAgICAgICAgICAgJysnICtcbiAgICAgICAgICAgIHZnRmllbGQoZGltZW5zaW9uRmllbGREZWYsIHtleHByOiAnZGF0dW0nLCBiaW5TdWZmaXg6ICdlbmQnfSkgK1xuICAgICAgICAgICAgJykvMicsXG4gICAgICAgICAgYXM6IGRpbWVuc2lvbkZpZWxkXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICB0cmFuc2Zvcm0ucHVzaCh7XG4gICAgICAgIHR5cGU6ICdpbXB1dGUnLFxuICAgICAgICBmaWVsZCxcbiAgICAgICAgZ3JvdXBieTogc3RhY2tieSxcbiAgICAgICAga2V5OiBkaW1lbnNpb25GaWVsZCxcbiAgICAgICAgbWV0aG9kOiAndmFsdWUnLFxuICAgICAgICB2YWx1ZTogMFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gU3RhY2tcbiAgICB0cmFuc2Zvcm0ucHVzaCh7XG4gICAgICB0eXBlOiAnc3RhY2snLFxuICAgICAgZ3JvdXBieTogdGhpcy5nZXRHcm91cGJ5RmllbGRzKCkuY29uY2F0KGZhY2V0YnkpLFxuICAgICAgZmllbGQsXG4gICAgICBzb3J0LFxuICAgICAgYXMsXG4gICAgICBvZmZzZXRcbiAgICB9KTtcblxuICAgIHJldHVybiB0cmFuc2Zvcm07XG4gIH1cbn1cbiJdfQ==","import { MAIN } from '../../data';\nimport { every, flatten, keys, vals } from '../../util';\nimport { AggregateNode } from './aggregate';\nimport { OutputNode } from './dataflow';\nimport { FacetNode } from './facet';\nimport { FilterInvalidNode } from './filterinvalid';\nimport * as optimizers from './optimizers';\nimport { StackNode } from './stack';\nexport var FACET_SCALE_PREFIX = 'scale_';\n/**\n * Clones the subtree and ignores output nodes except for the leafs, which are renamed.\n */\nfunction cloneSubtree(facet) {\n    function clone(node) {\n        if (!(node instanceof FacetNode)) {\n            var copy_1 = node.clone();\n            if (copy_1 instanceof OutputNode) {\n                var newName = FACET_SCALE_PREFIX + copy_1.getSource();\n                copy_1.setSource(newName);\n                facet.model.component.data.outputNodes[newName] = copy_1;\n            }\n            else if (copy_1 instanceof AggregateNode || copy_1 instanceof StackNode) {\n                copy_1.addDimensions(facet.fields);\n            }\n            flatten(node.children.map(clone)).forEach(function (n) { return n.parent = copy_1; });\n            return [copy_1];\n        }\n        return flatten(node.children.map(clone));\n    }\n    return clone;\n}\n/**\n * Move facet nodes down to the next fork or output node. Also pull the main output with the facet node.\n * After moving down the facet node, make a copy of the subtree and make it a child of the main output.\n */\nfunction moveFacetDown(node) {\n    if (node instanceof FacetNode) {\n        if (node.numChildren() === 1 && !(node.children[0] instanceof OutputNode)) {\n            // move down until we hit a fork or output node\n            var child = node.children[0];\n            if (child instanceof AggregateNode || child instanceof StackNode) {\n                child.addDimensions(node.fields);\n            }\n            child.swapWithParent();\n            moveFacetDown(node);\n        }\n        else {\n            // move main to facet\n            moveMainDownToFacet(node.model.component.data.main);\n            // replicate the subtree and place it before the facet's main node\n            var copy = flatten(node.children.map(cloneSubtree(node)));\n            copy.forEach(function (c) { return c.parent = node.model.component.data.main; });\n        }\n    }\n    else {\n        node.children.forEach(moveFacetDown);\n    }\n}\nfunction moveMainDownToFacet(node) {\n    if (node instanceof OutputNode && node.type === MAIN) {\n        if (node.numChildren() === 1) {\n            var child = node.children[0];\n            if (!(child instanceof FacetNode)) {\n                child.swapWithParent();\n                moveMainDownToFacet(node);\n            }\n        }\n    }\n}\n/**\n * Remove nodes that are not required starting from a root.\n */\nfunction removeUnnecessaryNodes(node) {\n    // remove empty null filter nodes\n    if (node instanceof FilterInvalidNode && every(vals(node.filter), function (f) { return f === null; })) {\n        node.remove();\n    }\n    // remove output nodes that are not required\n    if (node instanceof OutputNode && !node.isRequired()) {\n        node.remove();\n    }\n    node.children.forEach(removeUnnecessaryNodes);\n}\n/**\n * Return all leaf nodes.\n */\nfunction getLeaves(roots) {\n    var leaves = [];\n    function append(node) {\n        if (node.numChildren() === 0) {\n            leaves.push(node);\n        }\n        else {\n            node.children.forEach(append);\n        }\n    }\n    roots.forEach(append);\n    return leaves;\n}\n/**\n * Optimizes the dataflow of the passed in data component.\n */\nexport function optimizeDataflow(dataComponent) {\n    var roots = vals(dataComponent.sources);\n    roots.forEach(removeUnnecessaryNodes);\n    // remove source nodes that don't have any children because they also don't have output nodes\n    roots = roots.filter(function (r) { return r.numChildren() > 0; });\n    getLeaves(roots).forEach(optimizers.iterateFromLeaves(optimizers.removeUnusedSubtrees));\n    roots = roots.filter(function (r) { return r.numChildren() > 0; });\n    getLeaves(roots).forEach(optimizers.iterateFromLeaves(optimizers.moveParseUp));\n    getLeaves(roots).forEach(optimizers.removeDuplicateTimeUnits);\n    roots.forEach(moveFacetDown);\n    keys(dataComponent.sources).forEach(function (s) {\n        if (dataComponent.sources[s].numChildren() === 0) {\n            delete dataComponent.sources[s];\n        }\n    });\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3B0aW1pemUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9kYXRhL29wdGltaXplLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBQyxJQUFJLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDaEMsT0FBTyxFQUFDLEtBQUssRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBQyxNQUFNLFlBQVksQ0FBQztBQUN0RCxPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0sYUFBYSxDQUFDO0FBQzFDLE9BQU8sRUFBZSxVQUFVLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDcEQsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLFNBQVMsQ0FBQztBQUNsQyxPQUFPLEVBQUMsaUJBQWlCLEVBQUMsTUFBTSxpQkFBaUIsQ0FBQztBQUVsRCxPQUFPLEtBQUssVUFBVSxNQUFNLGNBQWMsQ0FBQztBQUUzQyxPQUFPLEVBQUMsU0FBUyxFQUFDLE1BQU0sU0FBUyxDQUFDO0FBRWxDLE1BQU0sQ0FBQyxJQUFNLGtCQUFrQixHQUFHLFFBQVEsQ0FBQztBQUUzQzs7R0FFRztBQUNILHNCQUFzQixLQUFnQjtJQUNwQyxlQUFlLElBQWtCO1FBQy9CLElBQUksQ0FBQyxDQUFDLElBQUksWUFBWSxTQUFTLENBQUMsRUFBRTtZQUNoQyxJQUFNLE1BQUksR0FBRyxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7WUFFMUIsSUFBSSxNQUFJLFlBQVksVUFBVSxFQUFFO2dCQUM5QixJQUFNLE9BQU8sR0FBRyxrQkFBa0IsR0FBRyxNQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7Z0JBQ3RELE1BQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBRXhCLEtBQUssQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLEdBQUcsTUFBSSxDQUFDO2FBQ3hEO2lCQUFNLElBQUksTUFB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LEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsaUJBQWlCLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUM7SUFDL0UsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUMsd0JBQXdCLENBQUMsQ0FBQztJQUU5RCxLQUFLLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBRTdCLElBQUksQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQUEsQ0FBQztRQUNuQyxJQUFJLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFFLEtBQUssQ0FBQyxFQUFFO1lBQ2hELE9BQU8sYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUNqQztJQUNILENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7TUFJTn0gZnJvbSAnLi4vLi4vZGF0YSc7XG5pbXBvcnQge2V2ZXJ5LCBmbGF0dGVuLCBrZXlzLCB2YWxzfSBmcm9tICcuLi8uLi91dGlsJztcbmltcG9ydCB7QWdncmVnYXRlTm9kZX0gZnJvbSAnLi9hZ2dyZWdhdGUnO1xuaW1wb3J0IHtEYXRhRmxvd05vZGUsIE91dHB1dE5vZGV9IGZyb20gJy4vZGF0YWZsb3cnO1xuaW1wb3J0IHtGYWNldE5vZGV9IGZyb20gJy4vZmFjZXQnO1xuaW1wb3J0IHtGaWx0ZXJJbnZhbGlkTm9kZX0gZnJvbSAnLi9maWx0ZXJpbnZhbGlkJztcbmltcG9ydCB7RGF0YUNvbXBvbmVudH0gZnJvbSAnLi9pbmRleCc7XG5pbXBvcnQgKiBhcyBvcHRpbWl6ZXJzIGZyb20gJy4vb3B0aW1pemVycyc7XG5pbXBvcnQge1NvdXJjZU5vZGV9IGZyb20gJy4vc291cmNlJztcbmltcG9ydCB7U3RhY2tOb2RlfSBmcm9tICcuL3N0YWNrJztcblxuZXhwb3J0IGNvbnN0IEZBQ0VUX1NDQUxFX1BSRUZJWCA9ICdzY2FsZV8nO1xuXG4vKipcbiAqIENsb25lcyB0aGUgc3VidHJlZSBhbmQgaWdub3JlcyBvdXRwdXQgbm9kZXMgZXhjZXB0IGZvciB0aGUgbGVhZnMsIHdoaWNoIGFyZSByZW5hbWVkLlxuICovXG5mdW5jdGlvbiBjbG9uZVN1YnRyZWUoZmFjZXQ6IEZhY2V0Tm9kZSkge1xuICBmdW5jdGlvbiBjbG9uZShub2RlOiBEYXRhRmxvd05vZGUpOiBEYXRhRmxvd05vZGVbXSB7XG4gICAgaWYgKCEobm9kZSBpbnN0YW5jZW9mIEZhY2V0Tm9kZSkpIHtcbiAgICAgIGNvbnN0IGNvcHkgPSBub2RlLmNsb25lKCk7XG5cbiAgICAgIGlmIChjb3B5IGluc3RhbmNlb2YgT3V0cHV0Tm9kZSkge1xuICAgICAgICBjb25zdCBuZXdOYW1lID0gRkFDRVRfU0NBTEVfUFJFRklYICsgY29weS5nZXRTb3VyY2UoKTtcbiAgICAgICAgY29weS5zZXRTb3VyY2UobmV3TmFtZSk7XG5cbiAgICAgICAgZmFjZXQubW9kZWwuY29tcG9uZW50LmRhdGEub3V0cHV0Tm9kZXNbbmV3TmFtZV0gPSBjb3B5O1xuICAgICAgfSBlbHNlIGlmIChjb3B5IGluc3RhbmNlb2YgQWdncmVnYXRlTm9kZSB8fCBjb3B5IGluc3RhbmNlb2YgU3RhY2tOb2RlKSB7XG4gICAgICAgIGNvcHkuYWRkRGltZW5zaW9ucyhmYWNldC5maWVsZHMpO1xuICAgICAgfVxuICAgICAgZmxhdHRlbihub2RlLmNoaWxkcmVuLm1hcChjbG9uZSkpLmZvckVhY2goKG46IERhdGFGbG93Tm9kZSkgPT4gbi5wYXJlbnQgPSBjb3B5KTtcblxuICAgICAgcmV0dXJuIFtjb3B5XTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmxhdHRlbihub2RlLmNoaWxkcmVuLm1hcChjbG9uZSkpO1xuICB9XG4gIHJldHVybiBjbG9uZTtcbn1cblxuLyoqXG4gKiBNb3ZlIGZhY2V0IG5vZGVzIGRvd24gdG8gdGhlIG5leHQgZm9yayBvciBvdXRwdXQgbm9kZS4gQWxzbyBwdWxsIHRoZSBtYWluIG91dHB1dCB3aXRoIHRoZSBmYWNldCBub2RlLlxuICogQWZ0ZXIgbW92aW5nIGRvd24gdGhlIGZhY2V0IG5vZGUsIG1ha2UgYSBjb3B5IG9mIHRoZSBzdWJ0cmVlIGFuZCBtYWtlIGl0IGEgY2hpbGQgb2YgdGhlIG1haW4gb3V0cHV0LlxuICovXG5mdW5jdGlvbiBtb3ZlRmFjZXREb3duKG5vZGU6IERhdGFGbG93Tm9kZSkge1xuICBpZiAobm9kZSBpbnN0YW5jZW9mIEZhY2V0Tm9kZSkge1xuICAgIGlmIChub2RlLm51bUNoaWxkcmVuKCkgPT09IDEgJiYgIShub2RlLmNoaWxkcmVuWzBdIGluc3RhbmNlb2YgT3V0cHV0Tm9kZSkpIHtcbiAgICAgIC8vIG1vdmUgZG93biB1bnRpbCB3ZSBoaXQgYSBmb3JrIG9yIG91dHB1dCBub2RlXG5cbiAgICAgIGNvbnN0IGNoaWxkID0gbm9kZS5jaGlsZHJlblswXTtcblxuICAgICAgaWYgKGNoaWxkIGluc3RhbmNlb2YgQWdncmVnYXRlTm9kZSB8fCBjaGlsZCBpbnN0YW5jZW9mIFN0YWNrTm9kZSkge1xuICAgICAgICBjaGlsZC5hZGREaW1lbnNpb25zKG5vZGUuZmllbGRzKTtcbiAgICAgIH1cblxuICAgICAgY2hpbGQuc3dhcFdpdGhQYXJlbnQoKTtcbiAgICAgIG1vdmVGYWNldERvd24obm9kZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIG1vdmUgbWFpbiB0byBmYWNldFxuICAgICAgbW92ZU1haW5Eb3duVG9GYWNldChub2RlLm1vZGVsLmNvbXBvbmVudC5kYXRhLm1haW4pO1xuXG4gICAgICAvLyByZXBsaWNhdGUgdGhlIHN1YnRyZWUgYW5kIHBsYWNlIGl0IGJlZm9yZSB0aGUgZmFjZXQncyBtYWluIG5vZGVcbiAgICAgIGNvbnN0IGNvcHk6IERhdGFGbG93Tm9kZVtdID0gZmxhdHRlbihub2RlLmNoaWxkcmVuLm1hcChjbG9uZVN1YnRyZWUobm9kZSkpKTtcbiAgICAgIGNvcHkuZm9yRWFjaChjID0+IGMucGFyZW50ID0gbm9kZS5tb2RlbC5jb21wb25lbnQuZGF0YS5tYWluKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgbm9kZS5jaGlsZHJlbi5mb3JFYWNoKG1vdmVGYWNldERvd24pO1xuICB9XG59XG5cbmZ1bmN0aW9uIG1vdmVNYWluRG93blRvRmFjZXQobm9kZTogRGF0YUZsb3dOb2RlKSB7XG4gIGlmIChub2RlIGluc3RhbmNlb2YgT3V0cHV0Tm9kZSAmJiBub2RlLnR5cGUgPT09IE1BSU4pIHtcbiAgICBpZiAobm9kZS5udW1DaGlsZHJlbigpID09PSAxKSB7XG4gICAgICBjb25zdCBjaGlsZCA9IG5vZGUuY2hpbGRyZW5bMF07XG5cbiAgICAgIGlmICghKGNoaWxkIGluc3RhbmNlb2YgRmFjZXROb2RlKSkge1xuICAgICAgICBjaGlsZC5zd2FwV2l0aFBhcmVudCgpO1xuICAgICAgICBtb3ZlTWFpbkRvd25Ub0ZhY2V0KG5vZGUpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIFJlbW92ZSBub2RlcyB0aGF0IGFyZSBub3QgcmVxdWlyZWQgc3RhcnRpbmcgZnJvbSBhIHJvb3QuXG4gKi9cbmZ1bmN0aW9uIHJlbW92ZVVubmVjZXNzYXJ5Tm9kZXMobm9kZTogRGF0YUZsb3dOb2RlKSB7XG5cbiAgLy8gcmVtb3ZlIGVtcHR5IG51bGwgZmlsdGVyIG5vZGVzXG4gIGlmIChub2RlIGluc3RhbmNlb2YgRmlsdGVySW52YWxpZE5vZGUgJiYgZXZlcnkodmFscyhub2RlLmZpbHRlciksIGYgPT4gZiA9PT0gbnVsbCkpIHtcbiAgICBub2RlLnJlbW92ZSgpO1xuICB9XG5cbiAgLy8gcmVtb3ZlIG91dHB1dCBub2RlcyB0aGF0IGFyZSBub3QgcmVxdWlyZWRcbiAgaWYgKG5vZGUgaW5zdGFuY2VvZiBPdXRwdXROb2RlICYmICFub2RlLmlzUmVxdWlyZWQoKSkge1xuICAgIG5vZGUucmVtb3ZlKCk7XG4gIH1cblxuICBub2RlLmNoaWxkcmVuLmZvckVhY2gocmVtb3ZlVW5uZWNlc3NhcnlOb2Rlcyk7XG59XG5cbi8qKlxuICogUmV0dXJuIGFsbCBsZWFmIG5vZGVzLlxuICovXG5mdW5jdGlvbiBnZXRMZWF2ZXMocm9vdHM6IERhdGFGbG93Tm9kZVtdKSB7XG4gIGNvbnN0IGxlYXZlczogRGF0YUZsb3dOb2RlW10gPSBbXTtcbiAgZnVuY3Rpb24gYXBwZW5kKG5vZGU6IERhdGFGbG93Tm9kZSkge1xuICAgIGlmIChub2RlLm51bUNoaWxkcmVuKCkgPT09IDApIHtcbiAgICAgIGxlYXZlcy5wdXNoKG5vZGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBub2RlLmNoaWxkcmVuLmZvckVhY2goYXBwZW5kKTtcbiAgICB9XG4gIH1cblxuICByb290cy5mb3JFYWNoKGFwcGVuZCk7XG4gIHJldHVybiBsZWF2ZXM7XG59XG5cbi8qKlxuICogT3B0aW1pemVzIHRoZSBkYXRhZmxvdyBvZiB0aGUgcGFzc2VkIGluIGRhdGEgY29tcG9uZW50LlxuICovXG5leHBvcnQgZnVuY3Rpb24gb3B0aW1pemVEYXRhZmxvdyhkYXRhQ29tcG9uZW50OiBEYXRhQ29tcG9uZW50KSB7XG4gIGxldCByb290czogU291cmNlTm9kZVtdID0gdmFscyhkYXRhQ29tcG9uZW50LnNvdXJjZXMpO1xuXG4gIHJvb3RzLmZvckVhY2gocmVtb3ZlVW5uZWNlc3NhcnlOb2Rlcyk7XG5cbiAgLy8gcmVtb3ZlIHNvdXJjZSBub2RlcyB0aGF0IGRvbid0IGhhdmUgYW55IGNoaWxkcmVuIGJlY2F1c2UgdGhleSBhbHNvIGRvbid0IGhhdmUgb3V0cHV0IG5vZGVzXG4gIHJvb3RzID0gcm9vdHMuZmlsdGVyKHIgPT4gci5udW1DaGlsZHJlbigpID4gMCk7XG4gIGdldExlYXZlcyhyb290cykuZm9yRWFjaChvcHRpbWl6ZXJzLml0ZXJhdGVGcm9tTGVhdmVzKG9wdGltaXplcnMucmVtb3ZlVW51c2VkU3VidHJlZXMpKTtcbiAgcm9vdHMgPSByb290cy5maWx0ZXIociA9PiByLm51bUNoaWxkcmVuKCkgPiAwKTtcblxuICBnZXRMZWF2ZXMocm9vdHMpLmZvckVhY2gob3B0aW1pemVycy5pdGVyYXRlRnJvbUxlYXZlcyhvcHRpbWl6ZXJzLm1vdmVQYXJzZVVwKSk7XG4gIGdldExlYXZlcyhyb290cykuZm9yRWFjaChvcHRpbWl6ZXJzLnJlbW92ZUR1cGxpY2F0ZVRpbWVVbml0cyk7XG5cbiAgcm9vdHMuZm9yRWFjaChtb3ZlRmFjZXREb3duKTtcblxuICBrZXlzKGRhdGFDb21wb25lbnQuc291cmNlcykuZm9yRWFjaChzID0+IHtcbiAgICBpZiAoZGF0YUNvbXBvbmVudC5zb3VyY2VzW3NdLm51bUNoaWxkcmVuKCkgPT09IDApIHtcbiAgICAgIGRlbGV0ZSBkYXRhQ29tcG9uZW50LnNvdXJjZXNbc107XG4gICAgfVxuICB9KTtcbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { isString } from 'vega-util';\nimport { SHARED_DOMAIN_OP_INDEX } from '../../aggregate';\nimport { binToString, isBinParams } from '../../bin';\nimport { isScaleChannel } from '../../channel';\nimport { MAIN, RAW } from '../../data';\nimport { dateTimeExpr, isDateTime } from '../../datetime';\nimport { vgField } from '../../fielddef';\nimport * as log from '../../log';\nimport { hasDiscreteDomain, isBinScale, isSelectionDomain } from '../../scale';\nimport { isSortArray, isSortField } from '../../sort';\nimport * as util from '../../util';\nimport { isDataRefDomain, isDataRefUnionedDomain, isFieldRefUnionDomain } from '../../vega.schema';\nimport { binRequiresRange } from '../common';\nimport { sortArrayIndexField } from '../data/calculate';\nimport { FACET_SCALE_PREFIX } from '../data/optimize';\nimport { isFacetModel, isUnitModel } from '../model';\nimport { SELECTION_DOMAIN } from '../selection/selection';\nexport function parseScaleDomain(model) {\n    if (isUnitModel(model)) {\n        parseUnitScaleDomain(model);\n    }\n    else {\n        parseNonUnitScaleDomain(model);\n    }\n}\nfunction parseUnitScaleDomain(model) {\n    var scales = model.specifiedScales;\n    var localScaleComponents = model.component.scales;\n    util.keys(localScaleComponents).forEach(function (channel) {\n        var specifiedScale = scales[channel];\n        var specifiedDomain = specifiedScale ? specifiedScale.domain : undefined;\n        var domains = parseDomainForChannel(model, channel);\n        var localScaleCmpt = localScaleComponents[channel];\n        localScaleCmpt.domains = domains;\n        if (isSelectionDomain(specifiedDomain)) {\n            // As scale parsing occurs before selection parsing, we use a temporary\n            // signal here and append the scale.domain definition. This is replaced\n            // with the correct domainRaw signal during scale assembly.\n            // For more information, see isRawSelectionDomain in selection.ts.\n            // FIXME: replace this with a special property in the scaleComponent\n            localScaleCmpt.set('domainRaw', {\n                signal: SELECTION_DOMAIN + util.hash(specifiedDomain)\n            }, true);\n        }\n        if (model.component.data.isFaceted) {\n            // get resolve from closest facet parent as this decides whether we need to refer to cloned subtree or not\n            var facetParent = model;\n            while (!isFacetModel(facetParent) && facetParent.parent) {\n                facetParent = facetParent.parent;\n            }\n            var resolve = facetParent.component.resolve.scale[channel];\n            if (resolve === 'shared') {\n                for (var _i = 0, domains_1 = domains; _i < domains_1.length; _i++) {\n                    var domain = domains_1[_i];\n                    // Replace the scale domain with data output from a cloned subtree after the facet.\n                    if (isDataRefDomain(domain)) {\n                        // use data from cloned subtree (which is the same as data but with a prefix added once)\n                        domain.data = FACET_SCALE_PREFIX + domain.data.replace(FACET_SCALE_PREFIX, '');\n                    }\n                }\n            }\n        }\n    });\n}\nfunction parseNonUnitScaleDomain(model) {\n    for (var _i = 0, _a = model.children; _i < _a.length; _i++) {\n        var child = _a[_i];\n        parseScaleDomain(child);\n    }\n    var localScaleComponents = model.component.scales;\n    util.keys(localScaleComponents).forEach(function (channel) {\n        var domains;\n        var domainRaw = null;\n        for (var _i = 0, _a = model.children; _i < _a.length; _i++) {\n            var child = _a[_i];\n            var childComponent = child.component.scales[channel];\n            if (childComponent) {\n                if (domains === undefined) {\n                    domains = childComponent.domains;\n                }\n                else {\n                    domains = domains.concat(childComponent.domains);\n                }\n                var dr = childComponent.get('domainRaw');\n                if (domainRaw && dr && domainRaw.signal !== dr.signal) {\n                    log.warn('The same selection must be used to override scale domains in a layered view.');\n                }\n                domainRaw = dr;\n            }\n        }\n        localScaleComponents[channel].domains = domains;\n        if (domainRaw) {\n            localScaleComponents[channel].set('domainRaw', domainRaw, true);\n        }\n    });\n}\n/**\n * Remove unaggregated domain if it is not applicable\n * Add unaggregated domain if domain is not specified and config.scale.useUnaggregatedDomain is true.\n */\nfunction normalizeUnaggregatedDomain(domain, fieldDef, scaleType, scaleConfig) {\n    if (domain === 'unaggregated') {\n        var _a = canUseUnaggregatedDomain(fieldDef, scaleType), valid = _a.valid, reason = _a.reason;\n        if (!valid) {\n            log.warn(reason);\n            return undefined;\n        }\n    }\n    else if (domain === undefined && scaleConfig.useUnaggregatedDomain) {\n        // Apply config if domain is not specified.\n        var valid = canUseUnaggregatedDomain(fieldDef, scaleType).valid;\n        if (valid) {\n            return 'unaggregated';\n        }\n    }\n    return domain;\n}\nexport function parseDomainForChannel(model, channel) {\n    var scaleType = model.getScaleComponent(channel).get('type');\n    var domain = normalizeUnaggregatedDomain(model.scaleDomain(channel), model.fieldDef(channel), scaleType, model.config.scale);\n    if (domain !== model.scaleDomain(channel)) {\n        model.specifiedScales[channel] = tslib_1.__assign({}, model.specifiedScales[channel], { domain: domain });\n    }\n    // If channel is either X or Y then union them with X2 & Y2 if they exist\n    if (channel === 'x' && model.channelHasField('x2')) {\n        if (model.channelHasField('x')) {\n            return parseSingleChannelDomain(scaleType, domain, model, 'x').concat(parseSingleChannelDomain(scaleType, domain, model, 'x2'));\n        }\n        else {\n            return parseSingleChannelDomain(scaleType, domain, model, 'x2');\n        }\n    }\n    else if (channel === 'y' && model.channelHasField('y2')) {\n        if (model.channelHasField('y')) {\n            return parseSingleChannelDomain(scaleType, domain, model, 'y').concat(parseSingleChannelDomain(scaleType, domain, model, 'y2'));\n        }\n        else {\n            return parseSingleChannelDomain(scaleType, domain, model, 'y2');\n        }\n    }\n    return parseSingleChannelDomain(scaleType, domain, model, channel);\n}\nfunction parseSingleChannelDomain(scaleType, domain, model, channel) {\n    var fieldDef = model.fieldDef(channel);\n    if (domain && domain !== 'unaggregated' && !isSelectionDomain(domain)) { // explicit value\n        if (isDateTime(domain[0])) {\n            return domain.map(function (dt) {\n                return { signal: \"{data: \" + dateTimeExpr(dt, true) + \"}\" };\n            });\n        }\n        return [domain];\n    }\n    var stack = model.stack;\n    if (stack && channel === stack.fieldChannel) {\n        if (stack.offset === 'normalize') {\n            return [[0, 1]];\n        }\n        var data = model.requestDataName(MAIN);\n        return [{\n                data: data,\n                field: model.vgField(channel, { suffix: 'start' })\n            }, {\n                data: data,\n                field: model.vgField(channel, { suffix: 'end' })\n            }];\n    }\n    var sort = isScaleChannel(channel) ? domainSort(model, channel, scaleType) : undefined;\n    if (domain === 'unaggregated') {\n        var data = model.requestDataName(MAIN);\n        var field = fieldDef.field;\n        return [{\n                data: data,\n                field: vgField({ field: field, aggregate: 'min' })\n            }, {\n                data: data,\n                field: vgField({ field: field, aggregate: 'max' })\n            }];\n    }\n    else if (fieldDef.bin) { // bin\n        if (isBinScale(scaleType)) {\n            var signal = model.getName(binToString(fieldDef.bin) + \"_\" + fieldDef.field + \"_bins\");\n            return [{ signal: \"sequence(\" + signal + \".start, \" + signal + \".stop + \" + signal + \".step, \" + signal + \".step)\" }];\n        }\n        if (hasDiscreteDomain(scaleType)) {\n            // ordinal bin scale takes domain from bin_range, ordered by bin start\n            // This is useful for both axis-based scale (x/y) and legend-based scale (other channels).\n            return [{\n                    // If sort by aggregation of a specified sort field, we need to use RAW table,\n                    // so we can aggregate values for the scale independently from the main aggregation.\n                    data: util.isBoolean(sort) ? model.requestDataName(MAIN) : model.requestDataName(RAW),\n                    // Use range if we added it and the scale does not support computing a range as a signal.\n                    field: model.vgField(channel, binRequiresRange(fieldDef, channel) ? { binSuffix: 'range' } : {}),\n                    // we have to use a sort object if sort = true to make the sort correct by bin start\n                    sort: sort === true || !isSortField(sort) ? {\n                        field: model.vgField(channel, {}),\n                        op: 'min' // min or max doesn't matter since we sort by the start of the bin range\n                    } : sort\n                }];\n        }\n        else { // continuous scales\n            if (channel === 'x' || channel === 'y') {\n                if (isBinParams(fieldDef.bin) && fieldDef.bin.extent) {\n                    return [fieldDef.bin.extent];\n                }\n                // X/Y position have to include start and end for non-ordinal scale\n                var data = model.requestDataName(MAIN);\n                return [{\n                        data: data,\n                        field: model.vgField(channel, {})\n                    }, {\n                        data: data,\n                        field: model.vgField(channel, { binSuffix: 'end' })\n                    }];\n            }\n            else {\n                // TODO: use bin_mid\n                return [{\n                        data: model.requestDataName(MAIN),\n                        field: model.vgField(channel, {})\n                    }];\n            }\n        }\n    }\n    else if (sort) {\n        return [{\n                // If sort by aggregation of a specified sort field, we need to use RAW table,\n                // so we can aggregate values for the scale independently from the main aggregation.\n                data: util.isBoolean(sort) ? model.requestDataName(MAIN) : model.requestDataName(RAW),\n                field: model.vgField(channel),\n                sort: sort\n            }];\n    }\n    else {\n        return [{\n                data: model.requestDataName(MAIN),\n                field: model.vgField(channel)\n            }];\n    }\n}\nexport function domainSort(model, channel, scaleType) {\n    if (!hasDiscreteDomain(scaleType)) {\n        return undefined;\n    }\n    var fieldDef = model.fieldDef(channel);\n    var sort = fieldDef.sort;\n    // if the sort is specified with array, use the derived sort index field\n    if (isSortArray(sort)) {\n        return {\n            op: 'min',\n            field: sortArrayIndexField(model, channel),\n            order: 'ascending'\n        };\n    }\n    // Sorted based on an aggregate calculation over a specified sort field (only for ordinal scale)\n    if (isSortField(sort)) {\n        // flatten nested fields\n        return tslib_1.__assign({}, sort, (sort.field ? { field: util.replacePathInField(sort.field) } : {}));\n    }\n    if (sort === 'descending') {\n        return {\n            op: 'min',\n            field: model.vgField(channel),\n            order: 'descending'\n        };\n    }\n    if (util.contains(['ascending', undefined /* default =ascending*/], sort)) {\n        return true;\n    }\n    // sort == null\n    return undefined;\n}\n/**\n * Determine if a scale can use unaggregated domain.\n * @return {Boolean} Returns true if all of the following conditons applies:\n * 1. `scale.domain` is `unaggregated`\n * 2. Aggregation function is not `count` or `sum`\n * 3. The scale is quantitative or time scale.\n */\nexport function canUseUnaggregatedDomain(fieldDef, scaleType) {\n    if (!fieldDef.aggregate) {\n        return {\n            valid: false,\n            reason: log.message.unaggregateDomainHasNoEffectForRawField(fieldDef)\n        };\n    }\n    if (!SHARED_DOMAIN_OP_INDEX[fieldDef.aggregate]) {\n        return {\n            valid: false,\n            reason: log.message.unaggregateDomainWithNonSharedDomainOp(fieldDef.aggregate)\n        };\n    }\n    if (fieldDef.type === 'quantitative') {\n        if (scaleType === 'log') {\n            return {\n                valid: false,\n                reason: log.message.unaggregatedDomainWithLogScale(fieldDef)\n            };\n        }\n    }\n    return { valid: true };\n}\n/**\n * Converts an array of domains to a single Vega scale domain.\n */\nexport function mergeDomains(domains) {\n    var uniqueDomains = util.unique(domains.map(function (domain) {\n        // ignore sort property when computing the unique domains\n        if (isDataRefDomain(domain)) {\n            var _s = domain.sort, domainWithoutSort = tslib_1.__rest(domain, [\"sort\"]);\n            return domainWithoutSort;\n        }\n        return domain;\n    }), util.hash);\n    var sorts = util.unique(domains.map(function (d) {\n        if (isDataRefDomain(d)) {\n            var s = d.sort;\n            if (s !== undefined && !util.isBoolean(s)) {\n                if (s.op === 'count') {\n                    // let's make sure that if op is count, we don't use a field\n                    delete s.field;\n                }\n                if (s.order === 'ascending') {\n                    // drop order: ascending as it is the default\n                    delete s.order;\n                }\n            }\n            return s;\n        }\n        return undefined;\n    }).filter(function (s) { return s !== undefined; }), util.hash);\n    if (uniqueDomains.length === 1) {\n        var domain = domains[0];\n        if (isDataRefDomain(domain) && sorts.length > 0) {\n            var sort_1 = sorts[0];\n            if (sorts.length > 1) {\n                log.warn(log.message.MORE_THAN_ONE_SORT);\n                sort_1 = true;\n            }\n            return tslib_1.__assign({}, domain, { sort: sort_1 });\n        }\n        return domain;\n    }\n    // only keep simple sort properties that work with unioned domains\n    var simpleSorts = util.unique(sorts.map(function (s) {\n        if (s === true) {\n            return s;\n        }\n        if (s.op === 'count') {\n            return s;\n        }\n        log.warn(log.message.domainSortDropped(s));\n        return true;\n    }), util.hash);\n    var sort = undefined;\n    if (simpleSorts.length === 1) {\n        sort = simpleSorts[0];\n    }\n    else if (simpleSorts.length > 1) {\n        log.warn(log.message.MORE_THAN_ONE_SORT);\n        sort = true;\n    }\n    var allData = util.unique(domains.map(function (d) {\n        if (isDataRefDomain(d)) {\n            return d.data;\n        }\n        return null;\n    }), function (x) { return x; });\n    if (allData.length === 1 && allData[0] !== null) {\n        // create a union domain of different fields with a single data source\n        var domain = tslib_1.__assign({ data: allData[0], fields: uniqueDomains.map(function (d) { return d.field; }) }, (sort ? { sort: sort } : {}));\n        return domain;\n    }\n    return tslib_1.__assign({ fields: uniqueDomains }, (sort ? { sort: sort } : {}));\n}\n/**\n * Return a field if a scale single field.\n * Return `undefined` otherwise.\n *\n */\nexport function getFieldFromDomain(domain) {\n    if (isDataRefDomain(domain) && isString(domain.field)) {\n        return domain.field;\n    }\n    else if (isDataRefUnionedDomain(domain)) {\n        var field = void 0;\n        for (var _i = 0, _a = domain.fields; _i < _a.length; _i++) {\n            var nonUnionDomain = _a[_i];\n            if (isDataRefDomain(nonUnionDomain) && isString(nonUnionDomain.field)) {\n                if (!field) {\n                    field = nonUnionDomain.field;\n                }\n                else if (field !== nonUnionDomain.field) {\n                    log.warn('Detected faceted independent scales that union domain of multiple fields from different data sources.  We will use the first field.  The result view size may be incorrect.');\n                    return field;\n                }\n            }\n        }\n        log.warn('Detected faceted independent scales that union domain of identical fields from different source detected.  We will assume that this is the same field from a different fork of the same data source.  However, if this is not case, the result view size maybe incorrect.');\n        return field;\n    }\n    else if (isFieldRefUnionDomain(domain)) {\n        log.warn('Detected faceted independent scales that union domain of multiple fields from the same data source.  We will use the first field.  The result view size may be incorrect.');\n        var field = domain.fields[0];\n        return isString(field) ? field : undefined;\n    }\n    return undefined;\n}\nexport function assembleDomain(model, channel) {\n    var scaleComponent = model.component.scales[channel];\n    var domains = scaleComponent.domains.map(function (domain) {\n        // Correct references to data as the original domain's data was determined\n        // in parseScale, which happens before parseData. Thus the original data\n        // reference can be incorrect.\n        if (isDataRefDomain(domain)) {\n            domain.data = model.lookupDataSource(domain.data);\n        }\n        return domain;\n    });\n    // domains is an array that has to be merged into a single vega domain\n    return mergeDomains(domains);\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZG9tYWluLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvc2NhbGUvZG9tYWluLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUMsUUFBUSxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBQ25DLE9BQU8sRUFBQyxzQkFBc0IsRUFBQyxNQUFNLGlCQUFpQixDQUFDO0FBQ3ZELE9BQU8sRUFBQyxXQUFXLEVBQUUsV0FBVyxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBQ25ELE9BQU8sRUFBQyxjQUFjLEVBQWUsTUFBTSxlQUFlLENBQUM7QUFDM0QsT0FBTyxFQUFDLElBQUksRUFBRSxHQUFHLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDckMsT0FBTyxFQUFXLFlBQVksRUFBRSxVQUFVLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUNsRSxPQUFPLEVBQTBCLE9BQU8sRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ2hFLE9BQU8sS0FBSyxHQUFHLE1BQU0sV0FBVyxDQUFDO0FBQ2pDLE9BQU8sRUFBUyxpQkFBaUIsRUFBRSxVQUFVLEVBQUUsaUJBQWlCLEVBQXlCLE1BQU0sYUFBYSxDQUFDO0FBQzdHLE9BQU8sRUFBb0IsV0FBVyxFQUFFLFdBQVcsRUFBQyxNQUFNLFlBQVksQ0FBQztBQUN2RSxPQUFPLEtBQUssSUFBSSxNQUFNLFlBQVksQ0FBQztBQUNuQyxPQUFPLEVBQUMsZUFBZSxFQUFFLHNCQUFzQixFQUFFLHFCQUFxQixFQUE4RixNQUFNLG1CQUFtQixDQUFDO0FBQzlMLE9BQU8sRUFBQyxnQkFBZ0IsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUMzQyxPQUFPLEVBQUMsbUJBQW1CLEVBQUMsTUFBTSxtQkFBbUIsQ0FBQztBQUN0RCxPQUFPLEVBQUMsa0JBQWtCLEVBQUMsTUFBTSxrQkFBa0IsQ0FBQztBQUNwRCxPQUFPLEVBQUMsWUFBWSxFQUFFLFdBQVcsRUFBUSxNQUFNLFVBQVUsQ0FBQztBQUMxRCxP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LElBQUksR0FBRyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ25EO1FBQ0QsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQyxDQUFDLENBQUM7SUFFSCxzRUFBc0U7SUFDdEUsT0FBTyxZQUFZLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDL0IsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7aXNTdHJpbmd9IGZyb20gJ3ZlZ2EtdXRpbCc7XG5pbXBvcnQge1NIQVJFRF9ET01BSU5fT1BfSU5ERVh9IGZyb20gJy4uLy4uL2FnZ3JlZ2F0ZSc7XG5pbXBvcnQge2JpblRvU3RyaW5nLCBpc0JpblBhcmFtc30gZnJvbSAnLi4vLi4vYmluJztcbmltcG9ydCB7aXNTY2FsZUNoYW5uZWwsIFNjYWxlQ2hhbm5lbH0gZnJvbSAnLi4vLi4vY2hhbm5lbCc7XG5pbXBvcnQge01BSU4sIFJBV30gZnJvbSAnLi4vLi4vZGF0YSc7XG5pbXBvcnQge0RhdGVUaW1lLCBkYXRlVGltZUV4cHIsIGlzRGF0ZVRpbWV9IGZyb20gJy4uLy4uL2RhdGV0aW1lJztcbmltcG9ydCB7RmllbGREZWYsIFNjYWxlRmllbGREZWYsIHZnRmllbGR9IGZyb20gJy4uLy4uL2ZpZWxkZGVmJztcbmltcG9ydCAqIGFzIGxvZyBmcm9tICcuLi8uLi9sb2cnO1xuaW1wb3J0IHtEb21haW4sIGhhc0Rpc2NyZXRlRG9tYWluLCBpc0JpblNjYWxlLCBpc1NlbGVjdGlvbkRvbWFpbiwgU2NhbGVDb25maWcsIFNjYWxlVHlwZX0gZnJvbSAnLi4vLi4vc2NhbGUnO1xuaW1wb3J0IHtFbmNvZGluZ1NvcnRGaWVsZCwgaXNTb3J0QXJyYXksIGlzU29ydEZpZWxkfSBmcm9tICcuLi8uLi9zb3J0JztcbmltcG9ydCAqIGFzIHV0aWwgZnJvbSAnLi4vLi4vdXRpbCc7XG5pbXBvcnQge2lzRGF0YVJlZkRvbWFpbiwgaXNEYXRhUmVmVW5pb25lZERvbWFpbiwgaXNGaWVsZFJlZlVuaW9uRG9tYWluLCBWZ0RhdGFSZWYsIFZnRG9tYWluLCBWZ0ZpZWxkUmVmVW5pb25Eb21haW4sIFZnTm9uVW5pb25Eb21haW4sIFZnU29ydEZpZWxkLCBWZ1VuaW9uU29ydEZpZWxkfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge2JpblJlcXVpcmVzUmFuZ2V9IGZyb20gJy4uL2NvbW1vbic7XG5pbXBvcnQge3NvcnRBcnJheUluZGV4RmllbGR9IGZyb20gJy4uL2RhdGEvY2FsY3VsYXRlJztcbmltcG9ydCB7RkFDRVRfU0NBTEVfUFJFRklYfSBmcm9tICcuLi9kYXRhL29wdGltaXplJztcbmltcG9ydCB7aXNGYWNldE1vZGVsLCBpc1VuaXRNb2RlbCwgTW9kZWx9IGZyb20gJy4uL21vZGVsJztcbmltcG9ydCB7U0VMRUNUSU9OX0RPTUFJTn0gZnJvbSAnLi4vc2VsZWN0aW9uL3NlbGVjdGlvbic7XG5pbXBvcnQge1VuaXRNb2RlbH0gZnJvbSAnLi4vdW5pdCc7XG5pbXBvcnQge1NjYWxlQ29tcG9uZW50SW5kZXh9IGZyb20gJy4vY29tcG9uZW50JztcblxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VTY2FsZURvbWFpbihtb2RlbDogTW9kZWwpIHtcbiAgaWYgKGlzVW5pdE1vZGVsKG1vZGVsKSkge1xuICAgIHBhcnNlVW5pdFNjYWxlRG9tYWluKG1vZGVsKTtcbiAgfSBlbHNlIHtcbiAgICBwYXJzZU5vblVuaXRTY2FsZURvbWFpbihtb2RlbCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcGFyc2VVbml0U2NhbGVEb21haW4obW9kZWw6IFVuaXRNb2RlbCkge1xuICBjb25zdCBzY2FsZXMgPSBtb2RlbC5zcGVjaWZpZWRTY2FsZXM7XG4gIGNvbnN0IGxvY2FsU2NhbGVDb21wb25lbnRzOiBTY2FsZUNvbXBvbmVudEluZGV4ID0gbW9kZWwuY29tcG9uZW50LnNjYWxlcztcblxuICB1dGlsLmtleXMobG9jYWxTY2FsZUNvbXBvbmVudHMpLmZvckVhY2goKGNoYW5uZWw6IFNjYWxlQ2hhbm5lbCkgPT4ge1xuICAgIGNvbnN0IHNwZWNpZmllZFNjYWxlID0gc2NhbGVzW2NoYW5uZWxdO1xuICAgIGNvbnN0IHNwZWNpZmllZERvbWFpbiA9IHNwZWNpZmllZFNjYWxlID8gc3BlY2lmaWVkU2NhbGUuZG9tYWluIDogdW5kZWZpbmVkO1xuXG4gICAgY29uc3QgZG9tYWlucyA9IHBhcnNlRG9tYWluRm9yQ2hhbm5lbChtb2RlbCwgY2hhbm5lbCk7XG4gICAgY29uc3QgbG9jYWxTY2FsZUNtcHQgPSBsb2NhbFNjYWxlQ29tcG9uZW50c1tjaGFubmVsXTtcbiAgICBsb2NhbFNjYWxlQ21wdC5kb21haW5zID0gZG9tYWlucztcblxuICAgIGlmIChpc1NlbGVjdGlvbkRvbWFpbihzcGVjaWZpZWREb21haW4pKSB7XG4gICAgICAvLyBBcyBzY2FsZSBwYXJzaW5nIG9jY3VycyBiZWZvcmUgc2VsZWN0aW9uIHBhcnNpbmcsIHdlIHVzZSBhIHRlbXBvcmFyeVxuICAgICAgLy8gc2lnbmFsIGhlcmUgYW5kIGFwcGVuZCB0aGUgc2NhbGUuZG9tYWluIGRlZmluaXRpb24uIFRoaXMgaXMgcmVwbGFjZWRcbiAgICAgIC8vIHdpdGggdGhlIGNvcnJlY3QgZG9tYWluUmF3IHNpZ25hbCBkdXJpbmcgc2NhbGUgYXNzZW1ibHkuXG4gICAgICAvLyBGb3IgbW9yZSBpbmZvcm1hdGlvbiwgc2VlIGlzUmF3U2VsZWN0aW9uRG9tYWluIGluIHNlbGVjdGlvbi50cy5cblxuICAgICAgLy8gRklYTUU6IHJlcGxhY2UgdGhpcyB3aXRoIGEgc3BlY2lhbCBwcm9wZXJ0eSBpbiB0aGUgc2NhbGVDb21wb25lbnRcbiAgICAgIGxvY2FsU2NhbGVDbXB0LnNldCgnZG9tYWluUmF3Jywge1xuICAgICAgICBzaWduYWw6IFNFTEVDVElPTl9ET01BSU4gKyB1dGlsLmhhc2goc3BlY2lmaWVkRG9tYWluKVxuICAgICAgfSwgdHJ1ZSk7XG4gICAgfVxuXG4gICAgaWYgKG1vZGVsLmNvbXBvbmVudC5kYXRhLmlzRmFjZXRlZCkge1xuICAgICAgLy8gZ2V0IHJlc29sdmUgZnJvbSBjbG9zZXN0IGZhY2V0IHBhcmVudCBhcyB0aGlzIGRlY2lkZXMgd2hldGhlciB3ZSBuZWVkIHRvIHJlZmVyIHRvIGNsb25lZCBzdWJ0cmVlIG9yIG5vdFxuICAgICAgbGV0IGZhY2V0UGFyZW50OiBNb2RlbCA9IG1vZGVsO1xuICAgICAgd2hpbGUgKCFpc0ZhY2V0TW9kZWwoZmFjZXRQYXJlbnQpICYmIGZhY2V0UGFyZW50LnBhcmVudCkge1xuICAgICAgICBmYWNldFBhcmVudCA9IGZhY2V0UGFyZW50LnBhcmVudDtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzb2x2ZSA9IGZhY2V0UGFyZW50LmNvbXBvbmVudC5yZXNvbHZlLnNjYWxlW2NoYW5uZWxdO1xuXG4gICAgICBpZiAocmVzb2x2ZSA9PT0gJ3NoYXJlZCcpIHtcbiAgICAgICAgZm9yIChjb25zdCBkb21haW4gb2YgZG9tYWlucykge1xuICAgICAgICAgIC8vIFJlcGxhY2UgdGhlIHNjYWxlIGRvbWFpbiB3aXRoIGRhdGEgb3V0cHV0IGZyb20gYSBjbG9uZWQgc3VidHJlZSBhZnRlciB0aGUgZmFjZXQuXG4gICAgICAgICAgaWYgKGlzRGF0YVJlZkRvbWFpbihkb21haW4pKSB7XG4gICAgICAgICAgICAvLyB1c2UgZGF0YSBmcm9tIGNsb25lZCBzdWJ0cmVlICh3aGljaCBpcyB0aGUgc2FtZSBhcyBkYXRhIGJ1dCB3aXRoIGEgcHJlZml4IGFkZGVkIG9uY2UpXG4gICAgICAgICAgICBkb21haW4uZGF0YSA9IEZBQ0VUX1NDQUxFX1BSRUZJWCArIGRvbWFpbi5kYXRhLnJlcGxhY2UoRkFDRVRfU0NBTEVfUFJFRklYLCAnJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gcGFyc2VOb25Vbml0U2NhbGVEb21haW4obW9kZWw6IE1vZGVsKSB7XG4gIGZvciAoY29uc3QgY2hpbGQgb2YgbW9kZWwuY2hpbGRyZW4pIHtcbiAgICBwYXJzZVNjYWxlRG9tYWluKGNoaWxkKTtcbiAgfVxuXG4gIGNvbnN0IGxvY2FsU2NhbGVDb21wb25lbnRzOiBTY2FsZUNvbXBvbmVudEluZGV4ID0gbW9kZWwuY29tcG9uZW50LnNjYWxlcztcblxuICB1dGlsLmtleXMobG9jYWxTY2FsZUNvbXBvbmVudHMpLmZvckVhY2goKGNoYW5uZWw6IFNjYWxlQ2hhbm5lbCkgPT4ge1xuICAgIGxldCBkb21haW5zOiBWZ05vblVuaW9uRG9tYWluW107XG4gICAgbGV0IGRvbWFpblJhdyA9IG51bGw7XG5cbiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIG1vZGVsLmNoaWxkcmVuKSB7XG4gICAgICBjb25zdCBjaGlsZENvbXBvbmVudCA9IGNoaWxkLmNvbXBvbmVudC5zY2FsZXNbY2hhbm5lbF07XG4gICAgICBpZiAoY2hpbGRDb21wb25lbnQpIHtcbiAgICAgICAgaWYgKGRvbWFpbnMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGRvbWFpbnMgPSBjaGlsZENvbXBvbmVudC5kb21haW5zO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRvbWFpbnMgPSBkb21haW5zLmNvbmNhdChjaGlsZENvbXBvbmVudC5kb21haW5zKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGRyID0gY2hpbGRDb21wb25lbnQuZ2V0KCdkb21haW5SYXcnKTtcbiAgICAgICAgaWYgKGRvbWFpblJhdyAmJiBkciAmJiBkb21haW5SYXcuc2lnbmFsICE9PSBkci5zaWduYWwpIHtcbiAgICAgICAgICBsb2cud2FybignVGhlIHNhbWUgc2VsZWN0aW9uIG11c3QgYmUgdXNlZCB0byBvdmVycmlkZSBzY2FsZSBkb21haW5zIGluIGEgbGF5ZXJlZCB2aWV3LicpO1xuICAgICAgICB9XG4gICAgICAgIGRvbWFpblJhdyA9IGRyO1xuICAgICAgfVxuICAgIH1cblxuICAgIGxvY2FsU2NhbGVDb21wb25lbnRzW2NoYW5uZWxdLmRvbWFpbnMgPSBkb21haW5zO1xuXG4gICAgaWYgKGRvbWFpblJhdykge1xuICAgICAgbG9jYWxTY2FsZUNvbXBvbmVudHNbY2hhbm5lbF0uc2V0KCdkb21haW5SYXcnLCBkb21haW5SYXcsIHRydWUpO1xuICAgIH1cbiAgfSk7XG59XG5cblxuLyoqXG4gKiBSZW1vdmUgdW5hZ2dyZWdhdGVkIGRvbWFpbiBpZiBpdCBpcyBub3QgYXBwbGljYWJsZVxuICogQWRkIHVuYWdncmVnYXRlZCBkb21haW4gaWYgZG9tYWluIGlzIG5vdCBzcGVjaWZpZWQgYW5kIGNvbmZpZy5zY2FsZS51c2VVbmFnZ3JlZ2F0ZWREb21haW4gaXMgdHJ1ZS5cbiAqL1xuZnVuY3Rpb24gbm9ybWFsaXplVW5hZ2dyZWdhdGVkRG9tYWluKGRvbWFpbjogRG9tYWluLCBmaWVsZERlZjogRmllbGREZWY8c3RyaW5nPiwgc2NhbGVUeXBlOiBTY2FsZVR5cGUsIHNjYWxlQ29uZmlnOiBTY2FsZUNvbmZpZykge1xuICBpZiAoZG9tYWluID09PSAndW5hZ2dyZWdhdGVkJykge1xuICAgIGNvbnN0IHt2YWxpZCwgcmVhc29ufSA9IGNhblVzZVVuYWdncmVnYXRlZERvbWFpbihmaWVsZERlZiwgc2NhbGVUeXBlKTtcbiAgICBpZighdmFsaWQpIHtcbiAgICAgIGxvZy53YXJuKHJlYXNvbik7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgfSBlbHNlIGlmIChkb21haW4gPT09IHVuZGVmaW5lZCAmJiBzY2FsZUNvbmZpZy51c2VVbmFnZ3JlZ2F0ZWREb21haW4pIHtcbiAgICAvLyBBcHBseSBjb25maWcgaWYgZG9tYWluIGlzIG5vdCBzcGVjaWZpZWQuXG4gICAgY29uc3Qge3ZhbGlkfSA9IGNhblVzZVVuYWdncmVnYXRlZERvbWFpbihmaWVsZERlZiwgc2NhbGVUeXBlKTtcbiAgICBpZiAodmFsaWQpIHtcbiAgICAgIHJldHVybiAndW5hZ2dyZWdhdGVkJztcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZG9tYWluO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VEb21haW5Gb3JDaGFubmVsKG1vZGVsOiBVbml0TW9kZWwsIGNoYW5uZWw6IFNjYWxlQ2hhbm5lbCk6IFZnTm9uVW5pb25Eb21haW5bXSB7XG4gIGNvbnN0IHNjYWxlVHlwZSA9IG1vZGVsLmdldFNjYWxlQ29tcG9uZW50KGNoYW5uZWwpLmdldCgndHlwZScpO1xuXG4gIGNvbnN0IGRvbWFpbiA9IG5vcm1hbGl6ZVVuYWdncmVnYXRlZERvbWFpbihtb2RlbC5zY2FsZURvbWFpbihjaGFubmVsKSwgbW9kZWwuZmllbGREZWYoY2hhbm5lbCksIHNjYWxlVHlwZSwgbW9kZWwuY29uZmlnLnNjYWxlKTtcbiAgaWYgKGRvbWFpbiAhPT0gbW9kZWwuc2NhbGVEb21haW4oY2hhbm5lbCkpIHtcbiAgICBtb2RlbC5zcGVjaWZpZWRTY2FsZXNbY2hhbm5lbF0gPSB7XG4gICAgICAuLi5tb2RlbC5zcGVjaWZpZWRTY2FsZXNbY2hhbm5lbF0sXG4gICAgICBkb21haW5cbiAgICB9O1xuICB9XG5cbiAgLy8gSWYgY2hhbm5lbCBpcyBlaXRoZXIgWCBvciBZIHRoZW4gdW5pb24gdGhlbSB3aXRoIFgyICYgWTIgaWYgdGhleSBleGlzdFxuICBpZiAoY2hhbm5lbCA9PT0gJ3gnICYmIG1vZGVsLmNoYW5uZWxIYXNGaWVsZCgneDInKSkge1xuICAgIGlmIChtb2RlbC5jaGFubmVsSGFzRmllbGQoJ3gnKSkge1xuICAgICAgcmV0dXJuIHBhcnNlU2luZ2xlQ2hhbm5lbERvbWFpbihzY2FsZVR5cGUsIGRvbWFpbiwgbW9kZWwsICd4JykuY29uY2F0KHBhcnNlU2luZ2xlQ2hhbm5lbERvbWFpbihzY2FsZVR5cGUsIGRvbWFpbiwgbW9kZWwsICd4MicpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHBhcnNlU2luZ2xlQ2hhbm5lbERvbWFpbihzY2FsZVR5cGUsIGRvbWFpbiwgbW9kZWwsICd4MicpO1xuICAgIH1cbiAgfSBlbHNlIGlmIChjaGFubmVsID09PSAneScgJiYgbW9kZWwuY2hhbm5lbEhhc0ZpZWxkKCd5MicpKSB7XG4gICAgaWYgKG1vZGVsLmNoYW5uZWxIYXNGaWVsZCgneScpKSB7XG4gICAgICByZXR1cm4gcGFyc2VTaW5nbGVDaGFubmVsRG9tYWluKHNjYWxlVHlwZSwgZG9tYWluLCBtb2RlbCwgJ3knKS5jb25jYXQocGFyc2VTaW5nbGVDaGFubmVsRG9tYWluKHNjYWxlVHlwZSwgZG9tYWluLCBtb2RlbCwgJ3kyJykpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcGFyc2VTaW5nbGVDaGFubmVsRG9tYWluKHNjYWxlVHlwZSwgZG9tYWluLCBtb2RlbCwgJ3kyJyk7XG4gICAgfVxuICB9XG4gIHJldHVybiBwYXJzZVNpbmdsZUNoYW5uZWxEb21haW4oc2NhbGVUeXBlLCBkb21haW4sIG1vZGVsLCBjaGFubmVsKTtcbn1cblxuZnVuY3Rpb24gcGFyc2VTaW5nbGVDaGFubmVsRG9tYWluKHNjYWxlVHlwZTogU2NhbGVUeXBlLCBkb21haW46IERvbWFpbiwgbW9kZWw6IFVuaXRNb2RlbCwgY2hhbm5lbDogU2NhbGVDaGFubmVsIHwgJ3gyJyB8ICd5MicpOiBWZ05vblVuaW9uRG9tYWluW10ge1xuICBjb25zdCBmaWVsZERlZiA9IG1vZGVsLmZpZWxkRGVmKGNoYW5uZWwpO1xuXG4gIGlmIChkb21haW4gJiYgZG9tYWluICE9PSAndW5hZ2dyZWdhdGVkJyAmJiAhaXNTZWxlY3Rpb25Eb21haW4oZG9tYWluKSkgeyAvLyBleHBsaWNpdCB2YWx1ZVxuICAgIGlmIChpc0RhdGVUaW1lKGRvbWFpblswXSkpIHtcbiAgICAgIHJldHVybiAoZG9tYWluIGFzIERhdGVUaW1lW10pLm1hcCgoZHQpID0+IHtcbiAgICAgICAgcmV0dXJuIHtzaWduYWw6IGB7ZGF0YTogJHtkYXRlVGltZUV4cHIoZHQsIHRydWUpfX1gfTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gW2RvbWFpbl07XG4gIH1cblxuICBjb25zdCBzdGFjayA9IG1vZGVsLnN0YWNrO1xuICBpZiAoc3RhY2sgJiYgY2hhbm5lbCA9PT0gc3RhY2suZmllbGRDaGFubmVsKSB7XG4gICAgaWYoc3RhY2sub2Zmc2V0ID09PSAnbm9ybWFsaXplJykge1xuICAgICAgcmV0dXJuIFtbMCwgMV1dO1xuICAgIH1cblxuICAgIGNvbnN0IGRhdGEgPSBtb2RlbC5yZXF1ZXN0RGF0YU5hbWUoTUFJTik7XG4gICAgcmV0dXJuIFt7XG4gICAgICBkYXRhLFxuICAgICAgZmllbGQ6IG1vZGVsLnZnRmllbGQoY2hhbm5lbCwge3N1ZmZpeDogJ3N0YXJ0J30pXG4gICAgfSwge1xuICAgICAgZGF0YSxcbiAgICAgIGZpZWxkOiBtb2RlbC52Z0ZpZWxkKGNoYW5uZWwsIHtzdWZmaXg6ICdlbmQnfSlcbiAgICB9XTtcbiAgfVxuXG4gIGNvbnN0IHNvcnQgPSBpc1NjYWxlQ2hhbm5lbChjaGFubmVsKSA/IGRvbWFpblNvcnQobW9kZWwsIGNoYW5uZWwsIHNjYWxlVHlwZSkgOiB1bmRlZmluZWQ7XG5cbiAgaWYgKGRvbWFpbiA9PT0gJ3VuYWdncmVnYXRlZCcpIHtcbiAgICBjb25zdCBkYXRhID0gbW9kZWwucmVxdWVzdERhdGFOYW1lKE1BSU4pO1xuICAgIGNvbnN0IHtmaWVsZH0gPSBmaWVsZERlZjtcbiAgICByZXR1cm4gW3tcbiAgICAgIGRhdGEsXG4gICAgICBmaWVsZDogdmdGaWVsZCh7ZmllbGQsIGFnZ3JlZ2F0ZTogJ21pbid9KVxuICAgIH0sIHtcbiAgICAgIGRhdGEsXG4gICAgICBmaWVsZDogdmdGaWVsZCh7ZmllbGQsIGFnZ3JlZ2F0ZTogJ21heCd9KVxuICAgIH1dO1xuICB9IGVsc2UgaWYgKGZpZWxkRGVmLmJpbikgeyAvLyBiaW5cbiAgICBpZiAoaXNCaW5TY2FsZShzY2FsZVR5cGUpKSB7XG4gICAgICBjb25zdCBzaWduYWwgPSBtb2RlbC5nZXROYW1lKGAke2JpblRvU3RyaW5nKGZpZWxkRGVmLmJpbil9XyR7ZmllbGREZWYuZmllbGR9X2JpbnNgKTtcbiAgICAgIHJldHVybiBbe3NpZ25hbDogYHNlcXVlbmNlKCR7c2lnbmFsfS5zdGFydCwgJHtzaWduYWx9LnN0b3AgKyAke3NpZ25hbH0uc3RlcCwgJHtzaWduYWx9LnN0ZXApYH1dO1xuICAgIH1cblxuICAgIGlmIChoYXNEaXNjcmV0ZURvbWFpbihzY2FsZVR5cGUpKSB7XG4gICAgICAvLyBvcmRpbmFsIGJpbiBzY2FsZSB0YWtlcyBkb21haW4gZnJvbSBiaW5fcmFuZ2UsIG9yZGVyZWQgYnkgYmluIHN0YXJ0XG4gICAgICAvLyBUaGlzIGlzIHVzZWZ1bCBmb3IgYm90aCBheGlzLWJhc2VkIHNjYWxlICh4L3kpIGFuZCBsZWdlbmQtYmFzZWQgc2NhbGUgKG90aGVyIGNoYW5uZWxzKS5cbiAgICAgIHJldHVybiBbe1xuICAgICAgICAvLyBJZiBzb3J0IGJ5IGFnZ3JlZ2F0aW9uIG9mIGEgc3BlY2lmaWVkIHNvcnQgZmllbGQsIHdlIG5lZWQgdG8gdXNlIFJBVyB0YWJsZSxcbiAgICAgICAgLy8gc28gd2UgY2FuIGFnZ3JlZ2F0ZSB2YWx1ZXMgZm9yIHRoZSBzY2FsZSBpbmRlcGVuZGVudGx5IGZyb20gdGhlIG1haW4gYWdncmVnYXRpb24uXG4gICAgICAgIGRhdGE6IHV0aWwuaXNCb29sZWFuKHNvcnQpID8gbW9kZWwucmVxdWVzdERhdGFOYW1lKE1BSU4pIDogbW9kZWwucmVxdWVzdERhdGFOYW1lKFJBVyksXG4gICAgICAgIC8vIFVzZSByYW5nZSBpZiB3ZSBhZGRlZCBpdCBhbmQgdGhlIHNjYWxlIGRvZXMgbm90IHN1cHBvcnQgY29tcHV0aW5nIGEgcmFuZ2UgYXMgYSBzaWduYWwuXG4gICAgICAgIGZpZWxkOiBtb2RlbC52Z0ZpZWxkKGNoYW5uZWwsIGJpblJlcXVpcmVzUmFuZ2UoZmllbGREZWYsIGNoYW5uZWwpID8ge2JpblN1ZmZpeDogJ3JhbmdlJ30gOiB7fSksXG4gICAgICAgIC8vIHdlIGhhdmUgdG8gdXNlIGEgc29ydCBvYmplY3QgaWYgc29ydCA9IHRydWUgdG8gbWFrZSB0aGUgc29ydCBjb3JyZWN0IGJ5IGJpbiBzdGFydFxuICAgICAgICBzb3J0OiBzb3J0ID09PSB0cnVlIHx8ICFpc1NvcnRGaWVsZChzb3J0KSA/IHtcbiAgICAgICAgICBmaWVsZDogbW9kZWwudmdGaWVsZChjaGFubmVsLCB7fSksXG4gICAgICAgICAgb3A6ICdtaW4nIC8vIG1pbiBvciBtYXggZG9lc24ndCBtYXR0ZXIgc2luY2Ugd2Ugc29ydCBieSB0aGUgc3RhcnQgb2YgdGhlIGJpbiByYW5nZVxuICAgICAgICB9IDogc29ydFxuICAgICAgfV07XG4gICAgfSBlbHNlIHsgLy8gY29udGludW91cyBzY2FsZXNcbiAgICAgIGlmIChjaGFubmVsID09PSAneCcgfHwgY2hhbm5lbCA9PT0gJ3knKSB7XG4gICAgICAgIGlmIChpc0JpblBhcmFtcyhmaWVsZERlZi5iaW4pICYmIGZpZWxkRGVmLmJpbi5leHRlbnQpIHtcbiAgICAgICAgICByZXR1cm4gW2ZpZWxkRGVmLmJpbi5leHRlbnRdO1xuICAgICAgICB9XG4gICAgICAgIC8vIFgvWSBwb3NpdGlvbiBoYXZlIHRvIGluY2x1ZGUgc3RhcnQgYW5kIGVuZCBmb3Igbm9uLW9yZGluYWwgc2NhbGVcbiAgICAgICAgY29uc3QgZGF0YSA9IG1vZGVsLnJlcXVlc3REYXRhTmFtZShNQUlOKTtcbiAgICAgICAgcmV0dXJuIFt7XG4gICAgICAgICAgZGF0YSxcbiAgICAgICAgICBmaWVsZDogbW9kZWwudmdGaWVsZChjaGFubmVsLCB7fSlcbiAgICAgICAgfSwge1xuICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgZmllbGQ6IG1vZGVsLnZnRmllbGQoY2hhbm5lbCwge2JpblN1ZmZpeDogJ2VuZCd9KVxuICAgICAgICB9XTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFRPRE86IHVzZSBiaW5fbWlkXG4gICAgICAgIHJldHVybiBbe1xuICAgICAgICAgIGRhdGE6IG1vZGVsLnJlcXVlc3REYXRhTmFtZShNQUlOKSxcbiAgICAgICAgICBmaWVsZDogbW9kZWwudmdGaWVsZChjaGFubmVsLCB7fSlcbiAgICAgICAgfV07XG4gICAgICB9XG4gICAgfVxuICB9IGVsc2UgaWYgKHNvcnQpIHtcbiAgICByZXR1cm4gW3tcbiAgICAgIC8vIElmIHNvcnQgYnkgYWdncmVnYXRpb24gb2YgYSBzcGVjaWZpZWQgc29ydCBmaWVsZCwgd2UgbmVlZCB0byB1c2UgUkFXIHRhYmxlLFxuICAgICAgLy8gc28gd2UgY2FuIGFnZ3JlZ2F0ZSB2YWx1ZXMgZm9yIHRoZSBzY2FsZSBpbmRlcGVuZGVudGx5IGZyb20gdGhlIG1haW4gYWdncmVnYXRpb24uXG4gICAgICBkYXRhOiB1dGlsLmlzQm9vbGVhbihzb3J0KSA/IG1vZGVsLnJlcXVlc3REYXRhTmFtZShNQUlOKSA6IG1vZGVsLnJlcXVlc3REYXRhTmFtZShSQVcpLFxuICAgICAgZmllbGQ6IG1vZGVsLnZnRmllbGQoY2hhbm5lbCksXG4gICAgICBzb3J0OiBzb3J0XG4gICAgfV07XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIFt7XG4gICAgICBkYXRhOiBtb2RlbC5yZXF1ZXN0RGF0YU5hbWUoTUFJTiksXG4gICAgICBmaWVsZDogbW9kZWwudmdGaWVsZChjaGFubmVsKVxuICAgIH1dO1xuICB9XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGRvbWFpblNvcnQobW9kZWw6IFVuaXRNb2RlbCwgY2hhbm5lbDogU2NhbGVDaGFubmVsLCBzY2FsZVR5cGU6IFNjYWxlVHlwZSk6IHRydWUgfCBFbmNvZGluZ1NvcnRGaWVsZDxzdHJpbmc+IHtcbiAgaWYgKCFoYXNEaXNjcmV0ZURvbWFpbihzY2FsZVR5cGUpKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIGNvbnN0IGZpZWxkRGVmOiBTY2FsZUZpZWxkRGVmPHN0cmluZz4gPSBtb2RlbC5maWVsZERlZihjaGFubmVsKTtcbiAgY29uc3Qgc29ydCA9IGZpZWxkRGVmLnNvcnQ7XG5cbiAgLy8gaWYgdGhlIHNvcnQgaXMgc3BlY2lmaWVkIHdpdGggYXJyYXksIHVzZSB0aGUgZGVyaXZlZCBzb3J0IGluZGV4IGZpZWxkXG4gIGlmIChpc1NvcnRBcnJheShzb3J0KSkge1xuICAgIHJldHVybiB7XG4gICAgICBvcDogJ21pbicsXG4gICAgICBmaWVsZDogc29ydEFycmF5SW5kZXhGaWVsZChtb2RlbCwgY2hhbm5lbCksXG4gICAgICBvcmRlcjogJ2FzY2VuZGluZydcbiAgICB9O1xuICB9XG5cbiAgLy8gU29ydGVkIGJhc2VkIG9uIGFuIGFnZ3JlZ2F0ZSBjYWxjdWxhdGlvbiBvdmVyIGEgc3BlY2lmaWVkIHNvcnQgZmllbGQgKG9ubHkgZm9yIG9yZGluYWwgc2NhbGUpXG4gIGlmIChpc1NvcnRGaWVsZChzb3J0KSkge1xuICAgIC8vIGZsYXR0ZW4gbmVzdGVkIGZpZWxkc1xuICAgIHJldHVybiB7XG4gICAgICAuLi5zb3J0LFxuICAgICAgLi4uKHNvcnQuZmllbGQgPyB7ZmllbGQ6IHV0aWwucmVwbGFjZVBhdGhJbkZpZWxkKHNvcnQuZmllbGQpfSA6IHt9KVxuICAgIH07XG4gIH1cblxuICBpZiAoc29ydCA9PT0gJ2Rlc2NlbmRpbmcnKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG9wOiAnbWluJyxcbiAgICAgIGZpZWxkOiBtb2RlbC52Z0ZpZWxkKGNoYW5uZWwpLFxuICAgICAgb3JkZXI6ICdkZXNjZW5kaW5nJ1xuICAgIH07XG4gIH1cblxuICBpZiAodXRpbC5jb250YWlucyhbJ2FzY2VuZGluZycsIHVuZGVmaW5lZCAvKiBkZWZhdWx0ID1hc2NlbmRpbmcqL10sIHNvcnQpKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICAvLyBzb3J0ID09IG51bGxcbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuXG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgc2NhbGUgY2FuIHVzZSB1bmFnZ3JlZ2F0ZWQgZG9tYWluLlxuICogQHJldHVybiB7Qm9vbGVhbn0gUmV0dXJucyB0cnVlIGlmIGFsbCBvZiB0aGUgZm9sbG93aW5nIGNvbmRpdG9ucyBhcHBsaWVzOlxuICogMS4gYHNjYWxlLmRvbWFpbmAgaXMgYHVuYWdncmVnYXRlZGBcbiAqIDIuIEFnZ3JlZ2F0aW9uIGZ1bmN0aW9uIGlzIG5vdCBgY291bnRgIG9yIGBzdW1gXG4gKiAzLiBUaGUgc2NhbGUgaXMgcXVhbnRpdGF0aXZlIG9yIHRpbWUgc2NhbGUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjYW5Vc2VVbmFnZ3JlZ2F0ZWREb21haW4oZmllbGREZWY6IEZpZWxkRGVmPHN0cmluZz4sIHNjYWxlVHlwZTogU2NhbGVUeXBlKToge3ZhbGlkOiBib29sZWFuLCByZWFzb24/OiBzdHJpbmd9IHtcbiAgaWYgKCFmaWVsZERlZi5hZ2dyZWdhdGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgcmVhc29uOiBsb2cubWVzc2FnZS51bmFnZ3JlZ2F0ZURvbWFpbkhhc05vRWZmZWN0Rm9yUmF3RmllbGQoZmllbGREZWYpXG4gICAgfTtcbiAgfVxuXG4gIGlmICghU0hBUkVEX0RPTUFJTl9PUF9JTkRFWFtmaWVsZERlZi5hZ2dyZWdhdGVdKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgIHJlYXNvbjogbG9nLm1lc3NhZ2UudW5hZ2dyZWdhdGVEb21haW5XaXRoTm9uU2hhcmVkRG9tYWluT3AoZmllbGREZWYuYWdncmVnYXRlKVxuICAgIH07XG4gIH1cblxuICBpZiAoZmllbGREZWYudHlwZSA9PT0gJ3F1YW50aXRhdGl2ZScpIHtcbiAgICBpZiAoc2NhbGVUeXBlID09PSAnbG9nJykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICByZWFzb246IGxvZy5tZXNzYWdlLnVuYWdncmVnYXRlZERvbWFpbldpdGhMb2dTY2FsZShmaWVsZERlZilcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHt2YWxpZDogdHJ1ZX07XG59XG5cbi8qKlxuICogQ29udmVydHMgYW4gYXJyYXkgb2YgZG9tYWlucyB0byBhIHNpbmdsZSBWZWdhIHNjYWxlIGRvbWFpbi5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1lcmdlRG9tYWlucyhkb21haW5zOiBWZ05vblVuaW9uRG9tYWluW10pOiBWZ0RvbWFpbiB7XG4gIGNvbnN0IHVuaXF1ZURvbWFpbnMgPSB1dGlsLnVuaXF1ZShkb21haW5zLm1hcChkb21haW4gPT4ge1xuICAgIC8vIGlnbm9yZSBzb3J0IHByb3BlcnR5IHdoZW4gY29tcHV0aW5nIHRoZSB1bmlxdWUgZG9tYWluc1xuICAgIGlmIChpc0RhdGFSZWZEb21haW4oZG9tYWluKSkge1xuICAgICAgY29uc3Qge3NvcnQ6IF9zLCAuLi5kb21haW5XaXRob3V0U29ydH0gPSBkb21haW47XG4gICAgICByZXR1cm4gZG9tYWluV2l0aG91dFNvcnQ7XG4gICAgfVxuICAgIHJldHVybiBkb21haW47XG4gIH0pLCB1dGlsLmhhc2gpO1xuXG4gIGNvbnN0IHNvcnRzOiBWZ1NvcnRGaWVsZFtdID0gdXRpbC51bmlxdWUoZG9tYWlucy5tYXAoZCA9PiB7XG4gICAgaWYgKGlzRGF0YVJlZkRvbWFpbihkKSkge1xuICAgICAgY29uc3QgcyA9IGQuc29ydDtcbiAgICAgIGlmIChzICE9PSB1bmRlZmluZWQgJiYgIXV0aWwuaXNCb29sZWFuKHMpKSB7XG4gICAgICAgIGlmIChzLm9wID09PSAnY291bnQnKSB7XG4gICAgICAgICAgLy8gbGV0J3MgbWFrZSBzdXJlIHRoYXQgaWYgb3AgaXMgY291bnQsIHdlIGRvbid0IHVzZSBhIGZpZWxkXG4gICAgICAgICAgZGVsZXRlIHMuZmllbGQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHMub3JkZXIgPT09ICdhc2NlbmRpbmcnKSB7XG4gICAgICAgICAgLy8gZHJvcCBvcmRlcjogYXNjZW5kaW5nIGFzIGl0IGlzIHRoZSBkZWZhdWx0XG4gICAgICAgICAgZGVsZXRlIHMub3JkZXI7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBzO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9KS5maWx0ZXIocyA9PiBzICE9PSB1bmRlZmluZWQpLCB1dGlsLmhhc2gpO1xuXG4gIGlmICh1bmlxdWVEb21haW5zLmxlbmd0aCA9PT0gMSkge1xuICAgIGNvbnN0IGRvbWFpbiA9IGRvbWFpbnNbMF07XG4gICAgaWYgKGlzRGF0YVJlZkRvbWFpbihkb21haW4pICYmIHNvcnRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGxldCBzb3J0ID0gc29ydHNbMF07XG4gICAgICBpZiAoc29ydHMubGVuZ3RoID4gMSkge1xuICAgICAgICBsb2cud2Fybihsb2cubWVzc2FnZS5NT1JFX1RIQU5fT05FX1NPUlQpO1xuICAgICAgICBzb3J0ID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLmRvbWFpbixcbiAgICAgICAgc29ydFxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIGRvbWFpbjtcbiAgfVxuXG4gIC8vIG9ubHkga2VlcCBzaW1wbGUgc29ydCBwcm9wZXJ0aWVzIHRoYXQgd29yayB3aXRoIHVuaW9uZWQgZG9tYWluc1xuICBjb25zdCBzaW1wbGVTb3J0cyA9IHV0aWwudW5pcXVlKHNvcnRzLm1hcChzID0+IHtcbiAgICBpZiAocyA9PT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIHM7XG4gICAgfVxuICAgIGlmIChzLm9wID09PSAnY291bnQnKSB7XG4gICAgICByZXR1cm4gcztcbiAgICB9XG4gICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuZG9tYWluU29ydERyb3BwZWQocykpO1xuICAgIHJldHVybiB0cnVlO1xuICB9KSwgdXRpbC5oYXNoKSBhcyBWZ1VuaW9uU29ydEZpZWxkW107XG5cbiAgbGV0IHNvcnQ6IFZnVW5pb25Tb3J0RmllbGQgPSB1bmRlZmluZWQ7XG5cbiAgaWYgKHNpbXBsZVNvcnRzLmxlbmd0aCA9PT0gMSkge1xuICAgIHNvcnQgPSBzaW1wbGVTb3J0c1swXTtcbiAgfSBlbHNlIGlmIChzaW1wbGVTb3J0cy5sZW5ndGggPiAxKSB7XG4gICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuTU9SRV9USEFOX09ORV9TT1JUKTtcbiAgICBzb3J0ID0gdHJ1ZTtcbiAgfVxuXG4gIGNvbnN0IGFsbERhdGEgPSB1dGlsLnVuaXF1ZShkb21haW5zLm1hcChkID0+IHtcbiAgICBpZiAoaXNEYXRhUmVmRG9tYWluKGQpKSB7XG4gICAgICByZXR1cm4gZC5kYXRhO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfSksIHggPT4geCk7XG5cbiAgaWYgKGFsbERhdGEubGVuZ3RoID09PSAxICYmIGFsbERhdGFbMF0gIT09IG51bGwpIHtcbiAgICAvLyBjcmVhdGUgYSB1bmlvbiBkb21haW4gb2YgZGlmZmVyZW50IGZpZWxkcyB3aXRoIGEgc2luZ2xlIGRhdGEgc291cmNlXG4gICAgY29uc3QgZG9tYWluOiBWZ0ZpZWxkUmVmVW5pb25Eb21haW4gPSB7XG4gICAgICBkYXRhOiBhbGxEYXRhWzBdLFxuICAgICAgZmllbGRzOiB1bmlxdWVEb21haW5zLm1hcChkID0+IChkIGFzIFZnRGF0YVJlZikuZmllbGQpLFxuICAgICAgLi4uKHNvcnQgPyB7c29ydH0gOiB7fSlcbiAgICB9O1xuXG4gICAgcmV0dXJuIGRvbWFpbjtcbiAgfVxuXG4gIHJldHVybiB7ZmllbGRzOiB1bmlxdWVEb21haW5zLCAuLi4oc29ydCA/IHtzb3J0fSA6IHt9KX07XG59XG5cbi8qKlxuICogUmV0dXJuIGEgZmllbGQgaWYgYSBzY2FsZSBzaW5nbGUgZmllbGQuXG4gKiBSZXR1cm4gYHVuZGVmaW5lZGAgb3RoZXJ3aXNlLlxuICpcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEZpZWxkRnJvbURvbWFpbihkb21haW46IFZnRG9tYWluKTogc3RyaW5nIHtcbiAgaWYgKGlzRGF0YVJlZkRvbWFpbihkb21haW4pICYmIGlzU3RyaW5nKGRvbWFpbi5maWVsZCkpIHtcbiAgICByZXR1cm4gZG9tYWluLmZpZWxkO1xuICB9IGVsc2UgaWYgKGlzRGF0YVJlZlVuaW9uZWREb21haW4oZG9tYWluKSkge1xuICAgIGxldCBmaWVsZDtcbiAgICBmb3IgKGNvbnN0IG5vblVuaW9uRG9tYWluIG9mIGRvbWFpbi5maWVsZHMpIHtcbiAgICAgIGlmIChpc0RhdGFSZWZEb21haW4obm9uVW5pb25Eb21haW4pICYmIGlzU3RyaW5nKG5vblVuaW9uRG9tYWluLmZpZWxkKSkge1xuICAgICAgICBpZiAoIWZpZWxkKSB7XG4gICAgICAgICAgZmllbGQgPSBub25VbmlvbkRvbWFpbi5maWVsZDtcbiAgICAgICAgfSBlbHNlIGlmIChmaWVsZCAhPT0gbm9uVW5pb25Eb21haW4uZmllbGQpIHtcbiAgICAgICAgICBsb2cud2FybignRGV0ZWN0ZWQgZmFjZXRlZCBpbmRlcGVuZGVudCBzY2FsZXMgdGhhdCB1bmlvbiBkb21haW4gb2YgbXVsdGlwbGUgZmllbGRzIGZyb20gZGlmZmVyZW50IGRhdGEgc291cmNlcy4gIFdlIHdpbGwgdXNlIHRoZSBmaXJzdCBmaWVsZC4gIFRoZSByZXN1bHQgdmlldyBzaXplIG1heSBiZSBpbmNvcnJlY3QuJyk7XG4gICAgICAgICAgcmV0dXJuIGZpZWxkO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGxvZy53YXJuKCdEZXRlY3RlZCBmYWNldGVkIGluZGVwZW5kZW50IHNjYWxlcyB0aGF0IHVuaW9uIGRvbWFpbiBvZiBpZGVudGljYWwgZmllbGRzIGZyb20gZGlmZmVyZW50IHNvdXJjZSBkZXRlY3RlZC4gIFdlIHdpbGwgYXNzdW1lIHRoYXQgdGhpcyBpcyB0aGUgc2FtZSBmaWVsZCBmcm9tIGEgZGlmZmVyZW50IGZvcmsgb2YgdGhlIHNhbWUgZGF0YSBzb3VyY2UuICBIb3dldmVyLCBpZiB0aGlzIGlzIG5vdCBjYXNlLCB0aGUgcmVzdWx0IHZpZXcgc2l6ZSBtYXliZSBpbmNvcnJlY3QuJyk7XG4gICAgcmV0dXJuIGZpZWxkO1xuICB9IGVsc2UgaWYgKGlzRmllbGRSZWZVbmlvbkRvbWFpbihkb21haW4pKSB7XG4gICAgbG9nLndhcm4oJ0RldGVjdGVkIGZhY2V0ZWQgaW5kZXBlbmRlbnQgc2NhbGVzIHRoYXQgdW5pb24gZG9tYWluIG9mIG11bHRpcGxlIGZpZWxkcyBmcm9tIHRoZSBzYW1lIGRhdGEgc291cmNlLiAgV2Ugd2lsbCB1c2UgdGhlIGZpcnN0IGZpZWxkLiAgVGhlIHJlc3VsdCB2aWV3IHNpemUgbWF5IGJlIGluY29ycmVjdC4nKTtcbiAgICBjb25zdCBmaWVsZCA9IGRvbWFpbi5maWVsZHNbMF07XG4gICAgcmV0dXJuIGlzU3RyaW5nKGZpZWxkKSA/IGZpZWxkIDogdW5kZWZpbmVkO1xuICB9XG5cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VtYmxlRG9tYWluKG1vZGVsOiBNb2RlbCwgY2hhbm5lbDogU2NhbGVDaGFubmVsKSB7XG4gIGNvbnN0IHNjYWxlQ29tcG9uZW50ID0gbW9kZWwuY29tcG9uZW50LnNjYWxlc1tjaGFubmVsXTtcbiAgY29uc3QgZG9tYWlucyA9IHNjYWxlQ29tcG9uZW50LmRvbWFpbnMubWFwKGRvbWFpbiA9PiB7XG4gICAgLy8gQ29ycmVjdCByZWZlcmVuY2VzIHRvIGRhdGEgYXMgdGhlIG9yaWdpbmFsIGRvbWFpbidzIGRhdGEgd2FzIGRldGVybWluZWRcbiAgICAvLyBpbiBwYXJzZVNjYWxlLCB3aGljaCBoYXBwZW5zIGJlZm9yZSBwYXJzZURhdGEuIFRodXMgdGhlIG9yaWdpbmFsIGRhdGFcbiAgICAvLyByZWZlcmVuY2UgY2FuIGJlIGluY29ycmVjdC5cblxuICAgIGlmIChpc0RhdGFSZWZEb21haW4oZG9tYWluKSkge1xuICAgICAgZG9tYWluLmRhdGEgPSBtb2RlbC5sb29rdXBEYXRhU291cmNlKGRvbWFpbi5kYXRhKTtcbiAgICB9XG4gICAgcmV0dXJuIGRvbWFpbjtcbiAgfSk7XG5cbiAgLy8gZG9tYWlucyBpcyBhbiBhcnJheSB0aGF0IGhhcyB0byBiZSBtZXJnZWQgaW50byBhIHNpbmdsZSB2ZWdhIGRvbWFpblxuICByZXR1cm4gbWVyZ2VEb21haW5zKGRvbWFpbnMpO1xufVxuIl19","import * as tslib_1 from \"tslib\";\nimport { isArray } from 'vega-util';\nimport { keys } from '../../util';\nimport { isVgRangeStep, isVgSignalRef } from '../../vega.schema';\nimport { isConcatModel, isLayerModel, isRepeatModel } from '../model';\nimport { isRawSelectionDomain, selectionScaleDomain } from '../selection/selection';\nimport { assembleDomain } from './domain';\nexport function assembleScales(model) {\n    if (isLayerModel(model) || isConcatModel(model) || isRepeatModel(model)) {\n        // For concat / layer / repeat, include scales of children too\n        return model.children.reduce(function (scales, child) {\n            return scales.concat(assembleScales(child));\n        }, assembleScalesForModel(model));\n    }\n    else {\n        // For facet, child scales would not be included in the parent's scope.\n        // For unit, there is no child.\n        return assembleScalesForModel(model);\n    }\n}\nexport function assembleScalesForModel(model) {\n    return keys(model.component.scales).reduce(function (scales, channel) {\n        var scaleComponent = model.component.scales[channel];\n        if (scaleComponent.merged) {\n            // Skipped merged scales\n            return scales;\n        }\n        var scale = scaleComponent.combine();\n        // need to separate const and non const object destruction\n        var domainRaw = scale.domainRaw, range = scale.range;\n        var name = scale.name, type = scale.type, _d = scale.domainRaw, _r = scale.range, otherScaleProps = tslib_1.__rest(scale, [\"name\", \"type\", \"domainRaw\", \"range\"]);\n        range = assembleScaleRange(range, name, model, channel);\n        // As scale parsing occurs before selection parsing, a temporary signal\n        // is used for domainRaw. Here, we detect if this temporary signal\n        // is set, and replace it with the correct domainRaw signal.\n        // For more information, see isRawSelectionDomain in selection.ts.\n        if (domainRaw && isRawSelectionDomain(domainRaw)) {\n            domainRaw = selectionScaleDomain(model, domainRaw);\n        }\n        scales.push(tslib_1.__assign({ name: name,\n            type: type, domain: assembleDomain(model, channel) }, (domainRaw ? { domainRaw: domainRaw } : {}), { range: range }, otherScaleProps));\n        return scales;\n    }, []);\n}\nexport function assembleScaleRange(scaleRange, scaleName, model, channel) {\n    // add signals to x/y range\n    if (channel === 'x' || channel === 'y') {\n        if (isVgRangeStep(scaleRange)) {\n            // For x/y range step, use a signal created in layout assemble instead of a constant range step.\n            return {\n                step: { signal: scaleName + '_step' }\n            };\n        }\n        else if (isArray(scaleRange) && scaleRange.length === 2) {\n            var r0 = scaleRange[0];\n            var r1 = scaleRange[1];\n            if (r0 === 0 && isVgSignalRef(r1)) {\n                // Replace width signal just in case it is renamed.\n                return [0, { signal: model.getSizeName(r1.signal) }];\n            }\n            else if (isVgSignalRef(r0) && r1 === 0) {\n                // Replace height signal just in case it is renamed.\n                return [{ signal: model.getSizeName(r0.signal) }, 0];\n            }\n        }\n    }\n    return scaleRange;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXNzZW1ibGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9zY2FsZS9hc3NlbWJsZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUVsQyxPQUFPLEVBQUMsSUFBSSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQ2hDLE9BQU8sRUFBQyxhQUFhLEVBQUUsYUFBYSxFQUFtQixNQUFNLG1CQUFtQixDQUFDO0FBQ2pGLE9BQU8sRUFBQyxhQUFhLEVBQUUsWUFBWSxFQUFFLGFBQWEsRUFBUSxNQUFNLFVBQVUsQ0FBQztBQUMzRSxPQUFPLEVBQUMsb0JBQW9CLEVBQUUsb0JBQW9CLEVBQUMsTUFBTSx3QkFBd0IsQ0FBQztBQUNsRixPQUFPLEVBQUMsY0FBYyxFQUFDLE1BQU0sVUFBVSxDQUFDO0FBRXhDLE1BQU0seUJBQXlCLEtBQVk7SUFDekMsSUFBSSxZQUFZLENBQUMsS0FBSyxDQUFDLElBQUksYUFBYSxDQUFDLEtBQUssQ0FBQyxJQUFJLGFBQWEsQ0FBQyxLQUFLLENBQUMsRUFBRTtRQUN2RSw4REFBOEQ7UUFDOUQsT0FBTyxLQUFLLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxVQUFDLE1BQU0sRUFBRSxLQUFLO1lBQ3pDLE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztRQUM5QyxDQUFDLEVBQUUsc0JBQXNCLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztLQUNuQztTQUFNO1FBQ0wsdUVBQXVFO1FBQ3ZFLCtCQUErQjtRQUMvQixPQUFPLHNCQUFzQixDQUFDLEtBQUssQ0FBQyxDQUFDO0tBQ3RDO0FBQ0gsQ0FBQztBQUVELE1BQU0saUNBQWlDLEtBQVk7SUFDL0MsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxNQUFNLENBQUMsVUFBQyxNQUFpQixFQUFFLE9BQXFCO1FBQ2xGLElBQU0sY0FBYyxHQUFHLEtBQUssQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3ZELElBQUksY0FBYyxDQUFDLE1BQU0sRUFBRTtZQUN6Qix3QkFBd0I7WUFDeEIsT0FBTyxNQUFNLENBQUM7U0FDZjtRQUVELElBQU0sS0FBSyxHQUFHLGNBQWMsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUV2QywwREFBMEQ7UUFDckQsSUFBQSwyQkFBUyxFQUFFLG1CQUFLLENBQVU7UUFDeEIsSUFBQSxpQkFBSSxFQUFFLGlCQUFJLEVBQUUsb0JBQWEsRUFBRSxnQkFBUyxFQUFFLCtFQUFrQixDQUFVO1FBRXpFLEtBQUssR0FBRyxrQkFBa0IsQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQztRQUV4RCx1RUFBdUU7UUFDdkUsa0VBQWtFO1FBQ2xFLDREQUE0RDtRQUM1RCxrRUFBa0U7UUFDbEUsSUFBSSxTQUFTLElBQUksb0JBQW9CLENBQUMsU0FBUyxDQUFDLEVBQUU7WUFDaEQsU0FBUyxHQUFHLG9CQUFvQixDQUFDLEtBQUssRUFBRSxTQUFTLENBQUMsQ0FBQztTQUNwRDtRQUdELE1BQU0sQ0FBQyxJQUFJLG9CQUNULElBQUksTUFBQTtZQUNKLElBQUksTUFBQSxFQUNKLE1BQU0sRUFBRSxjQUFjLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxJQUNuQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBQyxTQUFTLFdBQUEsRUFBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFDakMsS0FBSyxFQUFFLEtBQUssSUFDVCxlQUFlLEVBQ2xCLENBQUM7UUFFSCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDLEVBQUUsRUFBZSxDQUFDLENBQUM7QUFDeEIsQ0FBQztBQUVELE1BQU0sNkJBQTZCLFVBQW1CLEVBQUUsU0FBaUIsRUFBRSxLQUFZLEVBQUUsT0FBZ0I7SUFDdkcsMkJBQTJCO0lBQzNCLElBQUksT0FBTyxLQUFLLEdBQUcsSUFBSSxPQUFPLEtBQUssR0FBRyxFQUFFO1FBQ3RDLElBQUksYUFBYSxDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQzdCLGdHQUFnRztZQUNoRyxPQUFPO2dCQUNMLElBQUksRUFBRSxFQUFDLE1BQU0sRUFBRSxTQUFTLEdBQUcsT0FBTyxFQUFDO2FBQ3BDLENBQUM7U0FDSDthQUFNLElBQUksT0FBTyxDQUFDLFVBQVUsQ0FBQyxJQUFJLFVBQVUsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQ3pELElBQU0sRUFBRSxHQUFHLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN6QixJQUFNLEVBQUUsR0FBRyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDekIsSUFBSSxFQUFFLEtBQUssQ0FBQyxJQUFJLGFBQWEsQ0FBQyxFQUFFLENBQUMsRUFBRTtnQkFDakMsbURBQW1EO2dCQUNuRCxPQUFPLENBQUMsQ0FBQyxFQUFFLEVBQUMsTUFBTSxFQUFFLEtBQUssQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxFQUFDLENBQUMsQ0FBQzthQUNwRDtpQkFBTSxJQUFJLGFBQWEsQ0FBQyxFQUFFLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxFQUFFO2dCQUN4QyxvREFBb0Q7Z0JBQ3BELE9BQU8sQ0FBQyxFQUFDLE1BQU0sRUFBRSxLQUFLLENBQUMsV0FBVyxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsRUFBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO2FBQ3BEO1NBQ0Y7S0FDRjtJQUNELE9BQU8sVUFBVSxDQUFDO0FBQ3BCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2lzQXJyYXl9IGZyb20gJ3ZlZ2EtdXRpbCc7XG5pbXBvcnQge0NoYW5uZWwsIFNjYWxlQ2hhbm5lbH0gZnJvbSAnLi4vLi4vY2hhbm5lbCc7XG5pbXBvcnQge2tleXN9IGZyb20gJy4uLy4uL3V0aWwnO1xuaW1wb3J0IHtpc1ZnUmFuZ2VTdGVwLCBpc1ZnU2lnbmFsUmVmLCBWZ1JhbmdlLCBWZ1NjYWxlfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge2lzQ29uY2F0TW9kZWwsIGlzTGF5ZXJNb2RlbCwgaXNSZXBlYXRNb2RlbCwgTW9kZWx9IGZyb20gJy4uL21vZGVsJztcbmltcG9ydCB7aXNSYXdTZWxlY3Rpb25Eb21haW4sIHNlbGVjdGlvblNjYWxlRG9tYWlufSBmcm9tICcuLi9zZWxlY3Rpb24vc2VsZWN0aW9uJztcbmltcG9ydCB7YXNzZW1ibGVEb21haW59IGZyb20gJy4vZG9tYWluJztcblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VtYmxlU2NhbGVzKG1vZGVsOiBNb2RlbCk6IFZnU2NhbGVbXSB7XG4gIGlmIChpc0xheWVyTW9kZWwobW9kZWwpIHx8IGlzQ29uY2F0TW9kZWwobW9kZWwpIHx8IGlzUmVwZWF0TW9kZWwobW9kZWwpKSB7XG4gICAgLy8gRm9yIGNvbmNhdCAvIGxheWVyIC8gcmVwZWF0LCBpbmNsdWRlIHNjYWxlcyBvZiBjaGlsZHJlbiB0b29cbiAgICByZXR1cm4gbW9kZWwuY2hpbGRyZW4ucmVkdWNlKChzY2FsZXMsIGNoaWxkKSA9PiB7XG4gICAgICByZXR1cm4gc2NhbGVzLmNvbmNhdChhc3NlbWJsZVNjYWxlcyhjaGlsZCkpO1xuICAgIH0sIGFzc2VtYmxlU2NhbGVzRm9yTW9kZWwobW9kZWwpKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBGb3IgZmFjZXQsIGNoaWxkIHNjYWxlcyB3b3VsZCBub3QgYmUgaW5jbHVkZWQgaW4gdGhlIHBhcmVudCdzIHNjb3BlLlxuICAgIC8vIEZvciB1bml0LCB0aGVyZSBpcyBubyBjaGlsZC5cbiAgICByZXR1cm4gYXNzZW1ibGVTY2FsZXNGb3JNb2RlbChtb2RlbCk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VtYmxlU2NhbGVzRm9yTW9kZWwobW9kZWw6IE1vZGVsKTogVmdTY2FsZVtdIHtcbiAgICByZXR1cm4ga2V5cyhtb2RlbC5jb21wb25lbnQuc2NhbGVzKS5yZWR1Y2UoKHNjYWxlczogVmdTY2FsZVtdLCBjaGFubmVsOiBTY2FsZUNoYW5uZWwpID0+IHtcbiAgICAgIGNvbnN0IHNjYWxlQ29tcG9uZW50ID0gbW9kZWwuY29tcG9uZW50LnNjYWxlc1tjaGFubmVsXTtcbiAgICAgIGlmIChzY2FsZUNvbXBvbmVudC5tZXJnZWQpIHtcbiAgICAgICAgLy8gU2tpcHBlZCBtZXJnZWQgc2NhbGVzXG4gICAgICAgIHJldHVybiBzY2FsZXM7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHNjYWxlID0gc2NhbGVDb21wb25lbnQuY29tYmluZSgpO1xuXG4gICAgICAvLyBuZWVkIHRvIHNlcGFyYXRlIGNvbnN0IGFuZCBub24gY29uc3Qgb2JqZWN0IGRlc3RydWN0aW9uXG4gICAgICBsZXQge2RvbWFpblJhdywgcmFuZ2V9ID0gc2NhbGU7XG4gICAgICBjb25zdCB7bmFtZSwgdHlwZSwgZG9tYWluUmF3OiBfZCwgcmFuZ2U6IF9yLCAuLi5vdGhlclNjYWxlUHJvcHN9ID0gc2NhbGU7XG5cbiAgICAgIHJhbmdlID0gYXNzZW1ibGVTY2FsZVJhbmdlKHJhbmdlLCBuYW1lLCBtb2RlbCwgY2hhbm5lbCk7XG5cbiAgICAgIC8vIEFzIHNjYWxlIHBhcnNpbmcgb2NjdXJzIGJlZm9yZSBzZWxlY3Rpb24gcGFyc2luZywgYSB0ZW1wb3Jhcnkgc2lnbmFsXG4gICAgICAvLyBpcyB1c2VkIGZvciBkb21haW5SYXcuIEhlcmUsIHdlIGRldGVjdCBpZiB0aGlzIHRlbXBvcmFyeSBzaWduYWxcbiAgICAgIC8vIGlzIHNldCwgYW5kIHJlcGxhY2UgaXQgd2l0aCB0aGUgY29ycmVjdCBkb21haW5SYXcgc2lnbmFsLlxuICAgICAgLy8gRm9yIG1vcmUgaW5mb3JtYXRpb24sIHNlZSBpc1Jhd1NlbGVjdGlvbkRvbWFpbiBpbiBzZWxlY3Rpb24udHMuXG4gICAgICBpZiAoZG9tYWluUmF3ICYmIGlzUmF3U2VsZWN0aW9uRG9tYWluKGRvbWFpblJhdykpIHtcbiAgICAgICAgZG9tYWluUmF3ID0gc2VsZWN0aW9uU2NhbGVEb21haW4obW9kZWwsIGRvbWFpblJhdyk7XG4gICAgICB9XG5cblxuICAgICAgc2NhbGVzLnB1c2goe1xuICAgICAgICBuYW1lLFxuICAgICAgICB0eXBlLFxuICAgICAgICBkb21haW46IGFzc2VtYmxlRG9tYWluKG1vZGVsLCBjaGFubmVsKSxcbiAgICAgICAgLi4uKGRvbWFpblJhdyA/IHtkb21haW5SYXd9IDoge30pLFxuICAgICAgICByYW5nZTogcmFuZ2UsXG4gICAgICAgIC4uLm90aGVyU2NhbGVQcm9wc1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBzY2FsZXM7XG4gICAgfSwgW10gYXMgVmdTY2FsZVtdKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VtYmxlU2NhbGVSYW5nZShzY2FsZVJhbmdlOiBWZ1JhbmdlLCBzY2FsZU5hbWU6IHN0cmluZywgbW9kZWw6IE1vZGVsLCBjaGFubmVsOiBDaGFubmVsKSB7XG4gIC8vIGFkZCBzaWduYWxzIHRvIHgveSByYW5nZVxuICBpZiAoY2hhbm5lbCA9PT0gJ3gnIHx8IGNoYW5uZWwgPT09ICd5Jykge1xuICAgIGlmIChpc1ZnUmFuZ2VTdGVwKHNjYWxlUmFuZ2UpKSB7XG4gICAgICAvLyBGb3IgeC95IHJhbmdlIHN0ZXAsIHVzZSBhIHNpZ25hbCBjcmVhdGVkIGluIGxheW91dCBhc3NlbWJsZSBpbnN0ZWFkIG9mIGEgY29uc3RhbnQgcmFuZ2Ugc3RlcC5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN0ZXA6IHtzaWduYWw6IHNjYWxlTmFtZSArICdfc3RlcCd9XG4gICAgICB9O1xuICAgIH0gZWxzZSBpZiAoaXNBcnJheShzY2FsZVJhbmdlKSAmJiBzY2FsZVJhbmdlLmxlbmd0aCA9PT0gMikge1xuICAgICAgY29uc3QgcjAgPSBzY2FsZVJhbmdlWzBdO1xuICAgICAgY29uc3QgcjEgPSBzY2FsZVJhbmdlWzFdO1xuICAgICAgaWYgKHIwID09PSAwICYmIGlzVmdTaWduYWxSZWYocjEpKSB7XG4gICAgICAgIC8vIFJlcGxhY2Ugd2lkdGggc2lnbmFsIGp1c3QgaW4gY2FzZSBpdCBpcyByZW5hbWVkLlxuICAgICAgICByZXR1cm4gWzAsIHtzaWduYWw6IG1vZGVsLmdldFNpemVOYW1lKHIxLnNpZ25hbCl9XTtcbiAgICAgIH0gZWxzZSBpZiAoaXNWZ1NpZ25hbFJlZihyMCkgJiYgcjEgPT09IDApIHtcbiAgICAgICAgLy8gUmVwbGFjZSBoZWlnaHQgc2lnbmFsIGp1c3QgaW4gY2FzZSBpdCBpcyByZW5hbWVkLlxuICAgICAgICByZXR1cm4gW3tzaWduYWw6IG1vZGVsLmdldFNpemVOYW1lKHIwLnNpZ25hbCl9LCAwXTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHNjYWxlUmFuZ2U7XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { Split } from '../split';\nvar ScaleComponent = /** @class */ (function (_super) {\n    tslib_1.__extends(ScaleComponent, _super);\n    function ScaleComponent(name, typeWithExplicit) {\n        var _this = _super.call(this, {}, // no initial explicit property\n        { name: name } // name as initial implicit property\n        ) || this;\n        _this.merged = false;\n        _this.domains = [];\n        _this.setWithExplicit('type', typeWithExplicit);\n        return _this;\n    }\n    return ScaleComponent;\n}(Split));\nexport { ScaleComponent };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvc2NhbGUvY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFJQSxPQUFPLEVBQVcsS0FBSyxFQUFDLE1BQU0sVUFBVSxDQUFDO0FBU3pDO0lBQW9DLDBDQUEwQjtJQUs1RCx3QkFBWSxJQUFZLEVBQUUsZ0JBQXFDO1FBQS9ELFlBQ0Usa0JBQ0UsRUFBRSxFQUFNLCtCQUErQjtRQUN2QyxFQUFDLElBQUksTUFBQSxFQUFDLENBQUUsb0NBQW9DO1NBQzdDLFNBRUY7UUFWTSxZQUFNLEdBQUcsS0FBSyxDQUFDO1FBRWYsYUFBTyxHQUF1QixFQUFFLENBQUM7UUFPdEMsS0FBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQzs7SUFDakQsQ0FBQztJQUNILHFCQUFDO0FBQUQsQ0FBQyxBQVpELENBQW9DLEtBQUssR0FZeEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1NjYWxlQ2hhbm5lbH0gZnJvbSAnLi4vLi4vY2hhbm5lbCc7XG5pbXBvcnQge1NjYWxlLCBTY2FsZVR5cGV9IGZyb20gJy4uLy4uL3NjYWxlJztcbmltcG9ydCB7T21pdH0gZnJvbSAnLi4vLi4vdXRpbCc7XG5pbXBvcnQge1ZnTm9uVW5pb25Eb21haW4sIFZnU2NhbGV9IGZyb20gJy4uLy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7RXhwbGljaXQsIFNwbGl0fSBmcm9tICcuLi9zcGxpdCc7XG5cbi8qKlxuICogQWxsIFZnRG9tYWluIHByb3BlcnR5IGV4Y2VwdCBkb21haW4uXG4gKiAoV2UgZXhjbHVkZSBkb21haW4gYXMgd2UgaGF2ZSBhIHNwZWNpYWwgXCJkb21haW5zXCIgYXJyYXkgdGhhdCBhbGxvdyB1cyBtZXJnZSB0aGVtIGFsbCBhdCBvbmNlIGluIGFzc2VtYmxlLilcbiAqL1xuLy8gVE9ETzogYWxzbyBleGNsdWRlIGRvbWFpblJhdyBhbmQgcHJvcGVydHkgaW1wbGVtZW50IHRoZSByaWdodCBzY2FsZUNvbXBvbmVudCBmb3Igc2VsZWN0aW9uIGRvbWFpblxuZXhwb3J0IHR5cGUgU2NhbGVDb21wb25lbnRQcm9wcyA9IE9taXQ8VmdTY2FsZSwgJ2RvbWFpbic+O1xuXG5leHBvcnQgY2xhc3MgU2NhbGVDb21wb25lbnQgZXh0ZW5kcyBTcGxpdDxTY2FsZUNvbXBvbmVudFByb3BzPiB7XG4gIHB1YmxpYyBtZXJnZWQgPSBmYWxzZTtcblxuICBwdWJsaWMgZG9tYWluczogVmdOb25VbmlvbkRvbWFpbltdID0gW107XG5cbiAgY29uc3RydWN0b3IobmFtZTogc3RyaW5nLCB0eXBlV2l0aEV4cGxpY2l0OiBFeHBsaWNpdDxTY2FsZVR5cGU+KSB7XG4gICAgc3VwZXIoXG4gICAgICB7fSwgICAgIC8vIG5vIGluaXRpYWwgZXhwbGljaXQgcHJvcGVydHlcbiAgICAgIHtuYW1lfSAgLy8gbmFtZSBhcyBpbml0aWFsIGltcGxpY2l0IHByb3BlcnR5XG4gICAgKTtcbiAgICB0aGlzLnNldFdpdGhFeHBsaWNpdCgndHlwZScsIHR5cGVXaXRoRXhwbGljaXQpO1xuICB9XG59XG5cbi8vIFVzaW5nIE1hcHBlZCBUeXBlIHRvIGRlY2xhcmUgdHlwZSAoaHR0cHM6Ly93d3cudHlwZXNjcmlwdGxhbmcub3JnL2RvY3MvaGFuZGJvb2svYWR2YW5jZWQtdHlwZXMuaHRtbCNtYXBwZWQtdHlwZXMpXG5leHBvcnQgdHlwZSBTY2FsZUNvbXBvbmVudEluZGV4ID0ge1tQIGluIFNjYWxlQ2hhbm5lbF0/OiBTY2FsZUNvbXBvbmVudH07XG5cbmV4cG9ydCB0eXBlIFNjYWxlSW5kZXggPSB7W1AgaW4gU2NhbGVDaGFubmVsXT86IFNjYWxlfTtcbiJdfQ==","import { isNumber } from 'vega-util';\nimport { COLOR, FILL, OPACITY, SCALE_CHANNELS, SHAPE, SIZE, STROKE, X, Y } from '../../channel';\nimport * as log from '../../log';\nimport { channelScalePropertyIncompatability, isExtendedScheme, scaleTypeSupportProperty, } from '../../scale';\nimport { hasContinuousDomain } from '../../scale';\nimport * as util from '../../util';\nimport { isVgRangeStep } from '../../vega.schema';\nimport { isUnitModel } from '../model';\nimport { makeExplicit, makeImplicit } from '../split';\nimport { parseNonUnitScaleProperty } from './properties';\nexport var RANGE_PROPERTIES = ['range', 'rangeStep', 'scheme'];\nexport function parseScaleRange(model) {\n    if (isUnitModel(model)) {\n        parseUnitScaleRange(model);\n    }\n    else {\n        parseNonUnitScaleProperty(model, 'range');\n    }\n}\nfunction parseUnitScaleRange(model) {\n    var localScaleComponents = model.component.scales;\n    // use SCALE_CHANNELS instead of scales[channel] to ensure that x, y come first!\n    SCALE_CHANNELS.forEach(function (channel) {\n        var localScaleCmpt = localScaleComponents[channel];\n        if (!localScaleCmpt) {\n            return;\n        }\n        var mergedScaleCmpt = model.getScaleComponent(channel);\n        var specifiedScale = model.specifiedScales[channel];\n        var fieldDef = model.fieldDef(channel);\n        // Read if there is a specified width/height\n        var sizeType = channel === 'x' ? 'width' : channel === 'y' ? 'height' : undefined;\n        var sizeSpecified = sizeType ? !!model.component.layoutSize.get(sizeType) : undefined;\n        var scaleType = mergedScaleCmpt.get('type');\n        // if autosize is fit, size cannot be data driven\n        var rangeStep = util.contains(['point', 'band'], scaleType) || !!specifiedScale.rangeStep;\n        if (sizeType && model.fit && !sizeSpecified && rangeStep) {\n            log.warn(log.message.CANNOT_FIX_RANGE_STEP_WITH_FIT);\n            sizeSpecified = true;\n        }\n        var xyRangeSteps = getXYRangeStep(model);\n        var rangeWithExplicit = parseRangeForChannel(channel, scaleType, fieldDef.type, specifiedScale, model.config, localScaleCmpt.get('zero'), model.mark, sizeSpecified, model.getName(sizeType), xyRangeSteps);\n        localScaleCmpt.setWithExplicit('range', rangeWithExplicit);\n    });\n}\nfunction getXYRangeStep(model) {\n    var xyRangeSteps = [];\n    var xScale = model.getScaleComponent('x');\n    var xRange = xScale && xScale.get('range');\n    if (xRange && isVgRangeStep(xRange) && isNumber(xRange.step)) {\n        xyRangeSteps.push(xRange.step);\n    }\n    var yScale = model.getScaleComponent('y');\n    var yRange = yScale && yScale.get('range');\n    if (yRange && isVgRangeStep(yRange) && isNumber(yRange.step)) {\n        xyRangeSteps.push(yRange.step);\n    }\n    return xyRangeSteps;\n}\n/**\n * Return mixins that includes one of the range properties (range, rangeStep, scheme).\n */\nexport function parseRangeForChannel(channel, scaleType, type, specifiedScale, config, zero, mark, sizeSpecified, sizeSignal, xyRangeSteps) {\n    var noRangeStep = sizeSpecified || specifiedScale.rangeStep === null;\n    // Check if any of the range properties is specified.\n    // If so, check if it is compatible and make sure that we only output one of the properties\n    for (var _i = 0, RANGE_PROPERTIES_1 = RANGE_PROPERTIES; _i < RANGE_PROPERTIES_1.length; _i++) {\n        var property = RANGE_PROPERTIES_1[_i];\n        if (specifiedScale[property] !== undefined) {\n            var supportedByScaleType = scaleTypeSupportProperty(scaleType, property);\n            var channelIncompatability = channelScalePropertyIncompatability(channel, property);\n            if (!supportedByScaleType) {\n                log.warn(log.message.scalePropertyNotWorkWithScaleType(scaleType, property, channel));\n            }\n            else if (channelIncompatability) { // channel\n                log.warn(channelIncompatability);\n            }\n            else {\n                switch (property) {\n                    case 'range':\n                        return makeExplicit(specifiedScale[property]);\n                    case 'scheme':\n                        return makeExplicit(parseScheme(specifiedScale[property]));\n                    case 'rangeStep':\n                        var rangeStep = specifiedScale[property];\n                        if (rangeStep !== null) {\n                            if (!sizeSpecified) {\n                                return makeExplicit({ step: rangeStep });\n                            }\n                            else {\n                                // If top-level size is specified, we ignore specified rangeStep.\n                                log.warn(log.message.rangeStepDropped(channel));\n                            }\n                        }\n                }\n            }\n        }\n    }\n    return makeImplicit(defaultRange(channel, scaleType, type, config, zero, mark, sizeSignal, xyRangeSteps, noRangeStep));\n}\nfunction parseScheme(scheme) {\n    if (isExtendedScheme(scheme)) {\n        var r = { scheme: scheme.name };\n        if (scheme.count) {\n            r.count = scheme.count;\n        }\n        if (scheme.extent) {\n            r.extent = scheme.extent;\n        }\n        return r;\n    }\n    return { scheme: scheme };\n}\nexport function defaultRange(channel, scaleType, type, config, zero, mark, sizeSignal, xyRangeSteps, noRangeStep) {\n    switch (channel) {\n        case X:\n        case Y:\n            if (util.contains(['point', 'band'], scaleType) && !noRangeStep) {\n                if (channel === X && mark === 'text') {\n                    if (config.scale.textXRangeStep) {\n                        return { step: config.scale.textXRangeStep };\n                    }\n                }\n                else {\n                    if (config.scale.rangeStep) {\n                        return { step: config.scale.rangeStep };\n                    }\n                }\n            }\n            // If range step is null, use zero to width or height.\n            // Note that these range signals are temporary\n            // as they can be merged and renamed.\n            // (We do not have the right size signal here since parseLayoutSize() happens after parseScale().)\n            // We will later replace these temporary names with\n            // the final name in assembleScaleRange()\n            if (channel === Y && hasContinuousDomain(scaleType)) {\n                // For y continuous scale, we have to start from the height as the bottom part has the max value.\n                return [{ signal: sizeSignal }, 0];\n            }\n            else {\n                return [0, { signal: sizeSignal }];\n            }\n        case SIZE:\n            // TODO: support custom rangeMin, rangeMax\n            var rangeMin = sizeRangeMin(mark, zero, config);\n            var rangeMax = sizeRangeMax(mark, xyRangeSteps, config);\n            return [rangeMin, rangeMax];\n        case SHAPE:\n            return 'symbol';\n        case COLOR:\n        case FILL:\n        case STROKE:\n            if (scaleType === 'ordinal') {\n                // Only nominal data uses ordinal scale by default\n                return type === 'nominal' ? 'category' : 'ordinal';\n            }\n            return mark === 'rect' || mark === 'geoshape' ? 'heatmap' : 'ramp';\n        case OPACITY:\n            // TODO: support custom rangeMin, rangeMax\n            return [config.scale.minOpacity, config.scale.maxOpacity];\n    }\n    /* istanbul ignore next: should never reach here */\n    throw new Error(\"Scale range undefined for channel \" + channel);\n}\nfunction sizeRangeMin(mark, zero, config) {\n    if (zero) {\n        return 0;\n    }\n    switch (mark) {\n        case 'bar':\n        case 'tick':\n            return config.scale.minBandSize;\n        case 'line':\n        case 'trail':\n        case 'rule':\n            return config.scale.minStrokeWidth;\n        case 'text':\n            return config.scale.minFontSize;\n        case 'point':\n        case 'square':\n        case 'circle':\n            return config.scale.minSize;\n    }\n    /* istanbul ignore next: should never reach here */\n    // sizeRangeMin not implemented for the mark\n    throw new Error(log.message.incompatibleChannel('size', mark));\n}\nfunction sizeRangeMax(mark, xyRangeSteps, config) {\n    var scaleConfig = config.scale;\n    switch (mark) {\n        case 'bar':\n        case 'tick':\n            if (config.scale.maxBandSize !== undefined) {\n                return config.scale.maxBandSize;\n            }\n            return minXYRangeStep(xyRangeSteps, config.scale) - 1;\n        case 'line':\n        case 'trail':\n        case 'rule':\n            return config.scale.maxStrokeWidth;\n        case 'text':\n            return config.scale.maxFontSize;\n        case 'point':\n        case 'square':\n        case 'circle':\n            if (config.scale.maxSize) {\n                return config.scale.maxSize;\n            }\n            // FIXME this case totally should be refactored\n            var pointStep = minXYRangeStep(xyRangeSteps, scaleConfig);\n            return (pointStep - 2) * (pointStep - 2);\n    }\n    /* istanbul ignore next: should never reach here */\n    // sizeRangeMax not implemented for the mark\n    throw new Error(log.message.incompatibleChannel('size', mark));\n}\n/**\n * @returns {number} Range step of x or y or minimum between the two if both are ordinal scale.\n */\nfunction minXYRangeStep(xyRangeSteps, scaleConfig) {\n    if (xyRangeSteps.length > 0) {\n        return Math.min.apply(null, xyRangeSteps);\n    }\n    if (scaleConfig.rangeStep) {\n        return scaleConfig.rangeStep;\n    }\n    return 21; // FIXME: re-evaluate the default value here.\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmFuZ2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9zY2FsZS9yYW5nZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsUUFBUSxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBRW5DLE9BQU8sRUFBVSxLQUFLLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxjQUFjLEVBQWdCLEtBQUssRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFFckgsT0FBTyxLQUFLLEdBQUcsTUFBTSxXQUFXLENBQUM7QUFFakMsT0FBTyxFQUNMLG1DQUFtQyxFQUNuQyxnQkFBZ0IsRUFLaEIsd0JBQXdCLEdBRXpCLE1BQU0sYUFBYSxDQUFDO0FBQ3JCLE9BQU8sRUFBQyxtQkFBbUIsRUFBQyxNQUFNLGFBQWEsQ0FBQztBQUVoRCxPQUFPLEtBQUssSUFBSSxNQUFNLFlBQVksQ0FBQztBQUNuQyxPQUFPLEVBQUMsYUFBYSxFQUFvQixNQUFNLG1CQUFtQixDQUFDO0FBQ25FLE9BQU8sRUFBQyxXQUFXLEVBQVEsTUFBTSxVQUFVLENBQUM7QUFDNUMsT0FBTyxFQUFXLFlBQVksRUFBRSxZQUFZLEVBQUMsTUFBTSxVQUFVLENBQUM7QUFHOUQsT0FBTyxFQUFDLHlCQUF5QixFQUFDLE1BQU0sY0FBYyxDQUFDO0FBS3ZELE1BQU0sQ0FBQyxJQUFNLGdCQUFnQixHQUFvQixDQUFDLE9BQU8sRUFBRSxXQUFXLEVBQUUsUUFBUSxDQUFDLENBQUM7QUFHbEYsTUFBTSwwQkFBMEIsS0FBWTtJQUMxQyxJQUFJLFdBQVcsQ0FBQyxLQUFLLENBQUMsRUFBRTtRQUN0QixtQkFBbUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztLQUM1QjtTQUFNO1FBQ0wseUJBQXlCLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0tBQzNDO0FBQ0gsQ0FBQztBQUVELDZCQUE2QixLQUFn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K0M7WUFDL0MsSUFBTSxTQUFTLEdBQUcsY0FBYyxDQUFDLFlBQVksRUFBRSxXQUFXLENBQUMsQ0FBQztZQUM1RCxPQUFPLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQyxDQUFDO0tBQzVDO0lBQ0QsbURBQW1EO0lBQ25ELDRDQUE0QztJQUM1QyxNQUFNLElBQUksS0FBSyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7QUFDakUsQ0FBQztBQUVEOztHQUVHO0FBQ0gsd0JBQXdCLFlBQXNCLEVBQUUsV0FBd0I7SUFDdEUsSUFBSSxZQUFZLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtRQUMzQixPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxZQUFZLENBQUMsQ0FBQztLQUMzQztJQUNELElBQUksV0FBVyxDQUFDLFNBQVMsRUFBRTtRQUN6QixPQUFPLFdBQVcsQ0FBQyxTQUFTLENBQUM7S0FDOUI7SUFDRCxPQUFPLEVBQUUsQ0FBQyxDQUFDLDZDQUE2QztBQUMxRCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtpc051bWJlcn0gZnJvbSAndmVnYS11dGlsJztcblxuaW1wb3J0IHtDaGFubmVsLCBDT0xPUiwgRklMTCwgT1BBQ0lUWSwgU0NBTEVfQ0hBTk5FTFMsIFNjYWxlQ2hhbm5lbCwgU0hBUEUsIFNJWkUsIFNUUk9LRSwgWCwgWX0gZnJvbSAnLi4vLi4vY2hhbm5lbCc7XG5pbXBvcnQge0NvbmZpZ30gZnJvbSAnLi4vLi4vY29uZmlnJztcbmltcG9ydCAqIGFzIGxvZyBmcm9tICcuLi8uLi9sb2cnO1xuaW1wb3J0IHtNYXJrfSBmcm9tICcuLi8uLi9tYXJrJztcbmltcG9ydCB7XG4gIGNoYW5uZWxTY2FsZVByb3BlcnR5SW5jb21wYXRhYmlsaXR5LFxuICBpc0V4dGVuZGVkU2NoZW1lLFxuICBSYW5nZSxcbiAgU2NhbGUsXG4gIFNjYWxlQ29uZmlnLFxuICBTY2FsZVR5cGUsXG4gIHNjYWxlVHlwZVN1cHBvcnRQcm9wZXJ0eSxcbiAgU2NoZW1lLFxufSBmcm9tICcuLi8uLi9zY2FsZSc7XG5pbXBvcnQge2hhc0NvbnRpbnVvdXNEb21haW59IGZyb20gJy4uLy4uL3NjYWxlJztcbmltcG9ydCB7VHlwZX0gZnJvbSAnLi4vLi4vdHlwZSc7XG5pbXBvcnQgKiBhcyB1dGlsIGZyb20gJy4uLy4uL3V0aWwnO1xuaW1wb3J0IHtpc1ZnUmFuZ2VTdGVwLCBWZ1JhbmdlLCBWZ1NjaGVtZX0gZnJvbSAnLi4vLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtpc1VuaXRNb2RlbCwgTW9kZWx9IGZyb20gJy4uL21vZGVsJztcbmltcG9ydCB7RXhwbGljaXQsIG1ha2VFeHBsaWNpdCwgbWFrZUltcGxpY2l0fSBmcm9tICcuLi9zcGxpdCc7XG5pbXBvcnQge1VuaXRNb2RlbH0gZnJvbSAnLi4vdW5pdCc7XG5pbXBvcnQge1NjYWxlQ29tcG9uZW50SW5kZXh9IGZyb20gJy4vY29tcG9uZW50JztcbmltcG9ydCB7cGFyc2VOb25Vbml0U2NhbGVQcm9wZXJ0eX0gZnJvbSAnLi9wcm9wZXJ0aWVzJztcblxuXG5leHBvcnQgdHlwZSBSYW5nZU1peGlucyA9IHtyYW5nZTogUmFuZ2V9IHwge3JhbmdlU3RlcDogbnVtYmVyfSB8IHtzY2hlbWU6IFNjaGVtZX07XG5cbmV4cG9ydCBjb25zdCBSQU5HRV9QUk9QRVJUSUVTOiAoa2V5b2YgU2NhbGUpW10gPSBbJ3JhbmdlJywgJ3JhbmdlU3RlcCcsICdzY2hlbWUnXTtcblxuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VTY2FsZVJhbmdlKG1vZGVsOiBNb2RlbCkge1xuICBpZiAoaXNVbml0TW9kZWwobW9kZWwpKSB7XG4gICAgcGFyc2VVbml0U2NhbGVSYW5nZShtb2RlbCk7XG4gIH0gZWxzZSB7XG4gICAgcGFyc2VOb25Vbml0U2NhbGVQcm9wZXJ0eShtb2RlbCwgJ3JhbmdlJyk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcGFyc2VVbml0U2NhbGVSYW5nZShtb2RlbDogVW5pdE1vZGVsKSB7XG4gIGNvbnN0IGxvY2FsU2NhbGVDb21wb25lbnRzOiBTY2FsZUNvbXBvbmVudEluZGV4ID0gbW9kZWwuY29tcG9uZW50LnNjYWxlcztcblxuICAvLyB1c2UgU0NBTEVfQ0hBTk5FTFMgaW5zdGVhZCBvZiBzY2FsZXNbY2hhbm5lbF0gdG8gZW5zdXJlIHRoYXQgeCwgeSBjb21lIGZpcnN0IVxuICBTQ0FMRV9DSEFOTkVMUy5mb3JFYWNoKChjaGFubmVsOiBTY2FsZUNoYW5uZWwpID0+IHtcbiAgICBjb25zdCBsb2NhbFNjYWxlQ21wdCA9IGxvY2FsU2NhbGVDb21wb25lbnRzW2NoYW5uZWxdO1xuICAgIGlmICghbG9jYWxTY2FsZUNtcHQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgbWVyZ2VkU2NhbGVDbXB0ID0gbW9kZWwuZ2V0U2NhbGVDb21wb25lbnQoY2hhbm5lbCk7XG5cblxuICAgIGNvbnN0IHNwZWNpZmllZFNjYWxlID0gbW9kZWwuc3BlY2lmaWVkU2NhbGVzW2NoYW5uZWxdO1xuICAgIGNvbnN0IGZpZWxkRGVmID0gbW9kZWwuZmllbGREZWYoY2hhbm5lbCk7XG5cbiAgICAvLyBSZWFkIGlmIHRoZXJlIGlzIGEgc3BlY2lmaWVkIHdpZHRoL2hlaWdodFxuICAgIGNvbnN0IHNpemVUeXBlID0gY2hhbm5lbCA9PT0gJ3gnID8gJ3dpZHRoJyA6IGNoYW5uZWwgPT09ICd5JyA/ICdoZWlnaHQnIDogdW5kZWZpbmVkO1xuICAgIGxldCBzaXplU3BlY2lmaWVkID0gc2l6ZVR5cGUgPyAhIW1vZGVsLmNvbXBvbmVudC5sYXlvdXRTaXplLmdldChzaXplVHlwZSkgOiB1bmRlZmluZWQ7XG5cbiAgICBjb25zdCBzY2FsZVR5cGUgPSBtZXJnZWRTY2FsZUNtcHQuZ2V0KCd0eXBlJyk7XG5cbiAgICAvLyBpZiBhdXRvc2l6ZSBpcyBmaXQsIHNpemUgY2Fubm90IGJlIGRhdGEgZHJpdmVuXG4gICAgY29uc3QgcmFuZ2VTdGVwID0gdXRpbC5jb250YWlucyhbJ3BvaW50JywgJ2JhbmQnXSwgc2NhbGVUeXBlKSB8fCAhIXNwZWNpZmllZFNjYWxlLnJhbmdlU3RlcDtcbiAgICBpZiAoc2l6ZVR5cGUgJiYgbW9kZWwuZml0ICYmICFzaXplU3BlY2lmaWVkICYmIHJhbmdlU3RlcCkge1xuICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuQ0FOTk9UX0ZJWF9SQU5HRV9TVEVQX1dJVEhfRklUKTtcbiAgICAgIHNpemVTcGVjaWZpZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGNvbnN0IHh5UmFuZ2VTdGVwcyA9IGdldFhZUmFuZ2VTdGVwKG1vZGVsKTtcblxuICAgIGNvbnN0IHJhbmdlV2l0aEV4cGxpY2l0ID0gcGFyc2VSYW5nZUZvckNoYW5uZWwoXG4gICAgICBjaGFubmVsLCBzY2FsZVR5cGUsIGZpZWxkRGVmLnR5cGUsIHNwZWNpZmllZFNjYWxlLCBtb2RlbC5jb25maWcsXG4gICAgICBsb2NhbFNjYWxlQ21wdC5nZXQoJ3plcm8nKSwgbW9kZWwubWFyaywgc2l6ZVNwZWNpZmllZCwgbW9kZWwuZ2V0TmFtZShzaXplVHlwZSksIHh5UmFuZ2VTdGVwc1xuICAgICk7XG5cbiAgICBsb2NhbFNjYWxlQ21wdC5zZXRXaXRoRXhwbGljaXQoJ3JhbmdlJywgcmFuZ2VXaXRoRXhwbGljaXQpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gZ2V0WFlSYW5nZVN0ZXAobW9kZWw6IFVuaXRNb2RlbCkge1xuICBjb25zdCB4eVJhbmdlU3RlcHM6IG51bWJlcltdID0gW107XG5cbiAgY29uc3QgeFNjYWxlID0gbW9kZWwuZ2V0U2NhbGVDb21wb25lbnQoJ3gnKTtcbiAgY29uc3QgeFJhbmdlID0geFNjYWxlICYmIHhTY2FsZS5nZXQoJ3JhbmdlJyk7XG4gIGlmICh4UmFuZ2UgJiYgaXNWZ1JhbmdlU3RlcCh4UmFuZ2UpICYmIGlzTnVtYmVyKHhSYW5nZS5zdGVwKSkge1xuICAgIHh5UmFuZ2VTdGVwcy5wdXNoKHhSYW5nZS5zdGVwKTtcbiAgfVxuXG4gIGNvbnN0IHlTY2FsZSA9IG1vZGVsLmdldFNjYWxlQ29tcG9uZW50KCd5Jyk7XG4gIGNvbnN0IHlSYW5nZSA9IHlTY2FsZSAmJiB5U2NhbGUuZ2V0KCdyYW5nZScpO1xuICBpZiAoeVJhbmdlICYmIGlzVmdSYW5nZVN0ZXAoeVJhbmdlKSAmJiBpc051bWJlcih5UmFuZ2Uuc3RlcCkpIHtcbiAgICB4eVJhbmdlU3RlcHMucHVzaCh5UmFuZ2Uuc3RlcCk7XG4gIH1cblxuICByZXR1cm4geHlSYW5nZVN0ZXBzO1xufVxuXG4vKipcbiAqIFJldHVybiBtaXhpbnMgdGhhdCBpbmNsdWRlcyBvbmUgb2YgdGhlIHJhbmdlIHByb3BlcnRpZXMgKHJhbmdlLCByYW5nZVN0ZXAsIHNjaGVtZSkuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVJhbmdlRm9yQ2hhbm5lbChcbiAgICBjaGFubmVsOiBDaGFubmVsLCBzY2FsZVR5cGU6IFNjYWxlVHlwZSwgdHlwZTogVHlwZSwgc3BlY2lmaWVkU2NhbGU6IFNjYWxlLCBjb25maWc6IENvbmZpZyxcbiAgICB6ZXJvOiBib29sZWFuLCBtYXJrOiBNYXJrLCBzaXplU3BlY2lmaWVkOiBib29sZWFuLCBzaXplU2lnbmFsOiBzdHJpbmcsIHh5UmFuZ2VTdGVwczogbnVtYmVyW11cbiAgKTogRXhwbGljaXQ8VmdSYW5nZT4ge1xuXG4gIGNvbnN0IG5vUmFuZ2VTdGVwID0gc2l6ZVNwZWNpZmllZCB8fCBzcGVjaWZpZWRTY2FsZS5yYW5nZVN0ZXAgPT09IG51bGw7XG5cbiAgLy8gQ2hlY2sgaWYgYW55IG9mIHRoZSByYW5nZSBwcm9wZXJ0aWVzIGlzIHNwZWNpZmllZC5cbiAgLy8gSWYgc28sIGNoZWNrIGlmIGl0IGlzIGNvbXBhdGlibGUgYW5kIG1ha2Ugc3VyZSB0aGF0IHdlIG9ubHkgb3V0cHV0IG9uZSBvZiB0aGUgcHJvcGVydGllc1xuICBmb3IgKGNvbnN0IHByb3BlcnR5IG9mIFJBTkdFX1BST1BFUlRJRVMpIHtcbiAgICBpZiAoc3BlY2lmaWVkU2NhbGVbcHJvcGVydHldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnN0IHN1cHBvcnRlZEJ5U2NhbGVUeXBlID0gc2NhbGVUeXBlU3VwcG9ydFByb3BlcnR5KHNjYWxlVHlwZSwgcHJvcGVydHkpO1xuICAgICAgY29uc3QgY2hhbm5lbEluY29tcGF0YWJpbGl0eSA9IGNoYW5uZWxTY2FsZVByb3BlcnR5SW5jb21wYXRhYmlsaXR5KGNoYW5uZWwsIHByb3BlcnR5KTtcbiAgICAgIGlmICghc3VwcG9ydGVkQnlTY2FsZVR5cGUpIHtcbiAgICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2Uuc2NhbGVQcm9wZXJ0eU5vdFdvcmtXaXRoU2NhbGVUeXBlKHNjYWxlVHlwZSwgcHJvcGVydHksIGNoYW5uZWwpKTtcbiAgICAgIH0gZWxzZSBpZiAoY2hhbm5lbEluY29tcGF0YWJpbGl0eSkgeyAvLyBjaGFubmVsXG4gICAgICAgIGxvZy53YXJuKGNoYW5uZWxJbmNvbXBhdGFiaWxpdHkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3dpdGNoIChwcm9wZXJ0eSkge1xuICAgICAgICAgIGNhc2UgJ3JhbmdlJzpcbiAgICAgICAgICAgIHJldHVybiBtYWtlRXhwbGljaXQoc3BlY2lmaWVkU2NhbGVbcHJvcGVydHldKTtcbiAgICAgICAgICBjYXNlICdzY2hlbWUnOlxuICAgICAgICAgICAgcmV0dXJuIG1ha2VFeHBsaWNpdChwYXJzZVNjaGVtZShzcGVjaWZpZWRTY2FsZVtwcm9wZXJ0eV0pKTtcbiAgICAgICAgICBjYXNlICdyYW5nZVN0ZXAnOlxuICAgICAgICAgICAgY29uc3QgcmFuZ2VTdGVwID0gc3BlY2lmaWVkU2NhbGVbcHJvcGVydHldO1xuICAgICAgICAgICAgaWYgKHJhbmdlU3RlcCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICBpZiAoIXNpemVTcGVjaWZpZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWFrZUV4cGxpY2l0KHtzdGVwOiByYW5nZVN0ZXB9KTtcbiAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBJZiB0b3AtbGV2ZWwgc2l6ZSBpcyBzcGVjaWZpZWQsIHdlIGlnbm9yZSBzcGVjaWZpZWQgcmFuZ2VTdGVwLlxuICAgICAgICAgICAgICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLnJhbmdlU3RlcERyb3BwZWQoY2hhbm5lbCkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG1ha2VJbXBsaWNpdChcbiAgICBkZWZhdWx0UmFuZ2UoXG4gICAgICBjaGFubmVsLCBzY2FsZVR5cGUsIHR5cGUsIGNvbmZpZyxcbiAgICAgIHplcm8sIG1hcmssIHNpemVTaWduYWwsIHh5UmFuZ2VTdGVwcywgbm9SYW5nZVN0ZXBcbiAgICApXG4gICk7XG59XG5cbmZ1bmN0aW9uIHBhcnNlU2NoZW1lKHNjaGVtZTogU2NoZW1lKSB7XG4gIGlmIChpc0V4dGVuZGVkU2NoZW1lKHNjaGVtZSkpIHtcbiAgICBjb25zdCByOiBWZ1NjaGVtZSA9IHtzY2hlbWU6IHNjaGVtZS5uYW1lfTtcbiAgICBpZiAoc2NoZW1lLmNvdW50KSB7XG4gICAgICByLmNvdW50ID0gc2NoZW1lLmNvdW50O1xuICAgIH1cbiAgICBpZiAoc2NoZW1lLmV4dGVudCkge1xuICAgICAgci5leHRlbnQgPSBzY2hlbWUuZXh0ZW50O1xuICAgIH1cbiAgICByZXR1cm4gcjtcbiAgfVxuICByZXR1cm4ge3NjaGVtZTogc2NoZW1lfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlZmF1bHRSYW5nZShcbiAgY2hhbm5lbDogQ2hhbm5lbCwgc2NhbGVUeXBlOiBTY2FsZVR5cGUsIHR5cGU6IFR5cGUsIGNvbmZpZzogQ29uZmlnLCB6ZXJvOiBib29sZWFuLCBtYXJrOiBNYXJrLFxuICBzaXplU2lnbmFsOiBzdHJpbmcsIHh5UmFuZ2VTdGVwczogbnVtYmVyW10sIG5vUmFuZ2VTdGVwOiBib29sZWFuXG4pOiBWZ1JhbmdlIHtcbiAgc3dpdGNoIChjaGFubmVsKSB7XG4gICAgY2FzZSBYOlxuICAgIGNhc2UgWTpcbiAgICAgIGlmICh1dGlsLmNvbnRhaW5zKFsncG9pbnQnLCAnYmFuZCddLCBzY2FsZVR5cGUpICYmICFub1JhbmdlU3RlcCkge1xuICAgICAgICBpZiAoY2hhbm5lbCA9PT0gWCAmJiBtYXJrID09PSAndGV4dCcpIHtcbiAgICAgICAgICBpZiAoY29uZmlnLnNjYWxlLnRleHRYUmFuZ2VTdGVwKSB7XG4gICAgICAgICAgICByZXR1cm4ge3N0ZXA6IGNvbmZpZy5zY2FsZS50ZXh0WFJhbmdlU3RlcH07XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChjb25maWcuc2NhbGUucmFuZ2VTdGVwKSB7XG4gICAgICAgICAgICByZXR1cm4ge3N0ZXA6IGNvbmZpZy5zY2FsZS5yYW5nZVN0ZXB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBJZiByYW5nZSBzdGVwIGlzIG51bGwsIHVzZSB6ZXJvIHRvIHdpZHRoIG9yIGhlaWdodC5cbiAgICAgIC8vIE5vdGUgdGhhdCB0aGVzZSByYW5nZSBzaWduYWxzIGFyZSB0ZW1wb3JhcnlcbiAgICAgIC8vIGFzIHRoZXkgY2FuIGJlIG1lcmdlZCBhbmQgcmVuYW1lZC5cbiAgICAgIC8vIChXZSBkbyBub3QgaGF2ZSB0aGUgcmlnaHQgc2l6ZSBzaWduYWwgaGVyZSBzaW5jZSBwYXJzZUxheW91dFNpemUoKSBoYXBwZW5zIGFmdGVyIHBhcnNlU2NhbGUoKS4pXG4gICAgICAvLyBXZSB3aWxsIGxhdGVyIHJlcGxhY2UgdGhlc2UgdGVtcG9yYXJ5IG5hbWVzIHdpdGhcbiAgICAgIC8vIHRoZSBmaW5hbCBuYW1lIGluIGFzc2VtYmxlU2NhbGVSYW5nZSgpXG5cbiAgICAgIGlmIChjaGFubmVsID09PSBZICYmIGhhc0NvbnRpbnVvdXNEb21haW4oc2NhbGVUeXBlKSkge1xuICAgICAgICAvLyBGb3IgeSBjb250aW51b3VzIHNjYWxlLCB3ZSBoYXZlIHRvIHN0YXJ0IGZyb20gdGhlIGhlaWdodCBhcyB0aGUgYm90dG9tIHBhcnQgaGFzIHRoZSBtYXggdmFsdWUuXG4gICAgICAgIHJldHVybiBbe3NpZ25hbDogc2l6ZVNpZ25hbH0sIDBdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFswLCB7c2lnbmFsOiBzaXplU2lnbmFsfV07XG4gICAgICB9XG4gICAgY2FzZSBTSVpFOlxuICAgICAgLy8gVE9ETzogc3VwcG9ydCBjdXN0b20gcmFuZ2VNaW4sIHJhbmdlTWF4XG4gICAgICBjb25zdCByYW5nZU1pbiA9IHNpemVSYW5nZU1pbihtYXJrLCB6ZXJvLCBjb25maWcpO1xuICAgICAgY29uc3QgcmFuZ2VNYXggPSBzaXplUmFuZ2VNYXgobWFyaywgeHlSYW5nZVN0ZXBzLCBjb25maWcpO1xuICAgICAgcmV0dXJuIFtyYW5nZU1pbiwgcmFuZ2VNYXhdO1xuICAgIGNhc2UgU0hBUEU6XG4gICAgICByZXR1cm4gJ3N5bWJvbCc7XG4gICAgY2FzZSBDT0xPUjpcbiAgICBjYXNlIEZJTEw6XG4gICAgY2FzZSBTVFJPS0U6XG4gICAgICBpZiAoc2NhbGVUeXBlID09PSAnb3JkaW5hbCcpIHtcbiAgICAgICAgLy8gT25seSBub21pbmFsIGRhdGEgdXNlcyBvcmRpbmFsIHNjYWxlIGJ5IGRlZmF1bHRcbiAgICAgICAgcmV0dXJuIHR5cGUgPT09ICdub21pbmFsJyA/ICdjYXRlZ29yeScgOiAnb3JkaW5hbCc7XG4gICAgICB9XG4gICAgICByZXR1cm4gbWFyayA9PT0gJ3JlY3QnIHx8IG1hcmsgPT09ICdnZW9zaGFwZScgPyAnaGVhdG1hcCcgOiAncmFtcCc7XG4gICAgY2FzZSBPUEFDSVRZOlxuICAgICAgLy8gVE9ETzogc3VwcG9ydCBjdXN0b20gcmFuZ2VNaW4sIHJhbmdlTWF4XG4gICAgICByZXR1cm4gW2NvbmZpZy5zY2FsZS5taW5PcGFjaXR5LCBjb25maWcuc2NhbGUubWF4T3BhY2l0eV07XG4gIH1cbiAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IHNob3VsZCBuZXZlciByZWFjaCBoZXJlICovXG4gIHRocm93IG5ldyBFcnJvcihgU2NhbGUgcmFuZ2UgdW5kZWZpbmVkIGZvciBjaGFubmVsICR7Y2hhbm5lbH1gKTtcbn1cblxuZnVuY3Rpb24gc2l6ZVJhbmdlTWluKG1hcms6IE1hcmssIHplcm86IGJvb2xlYW4sIGNvbmZpZzogQ29uZmlnKSB7XG4gIGlmICh6ZXJvKSB7XG4gICAgcmV0dXJuIDA7XG4gIH1cbiAgc3dpdGNoIChtYXJrKSB7XG4gICAgY2FzZSAnYmFyJzpcbiAgICBjYXNlICd0aWNrJzpcbiAgICAgIHJldHVybiBjb25maWcuc2NhbGUubWluQmFuZFNpemU7XG4gICAgY2FzZSAnbGluZSc6XG4gICAgY2FzZSAndHJhaWwnOlxuICAgIGNhc2UgJ3J1bGUnOlxuICAgICAgcmV0dXJuIGNvbmZpZy5zY2FsZS5taW5TdHJva2VXaWR0aDtcbiAgICBjYXNlICd0ZXh0JzpcbiAgICAgIHJldHVybiBjb25maWcuc2NhbGUubWluRm9udFNpemU7XG4gICAgY2FzZSAncG9pbnQnOlxuICAgIGNhc2UgJ3NxdWFyZSc6XG4gICAgY2FzZSAnY2lyY2xlJzpcbiAgICAgIHJldHVybiBjb25maWcuc2NhbGUubWluU2l6ZTtcbiAgfVxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dDogc2hvdWxkIG5ldmVyIHJlYWNoIGhlcmUgKi9cbiAgLy8gc2l6ZVJhbmdlTWluIG5vdCBpbXBsZW1lbnRlZCBmb3IgdGhlIG1hcmtcbiAgdGhyb3cgbmV3IEVycm9yKGxvZy5tZXNzYWdlLmluY29tcGF0aWJsZUNoYW5uZWwoJ3NpemUnLCBtYXJrKSk7XG59XG5cbmZ1bmN0aW9uIHNpemVSYW5nZU1heChtYXJrOiBNYXJrLCB4eVJhbmdlU3RlcHM6IG51bWJlcltdLCBjb25maWc6IENvbmZpZykge1xuICBjb25zdCBzY2FsZUNvbmZpZyA9IGNvbmZpZy5zY2FsZTtcbiAgc3dpdGNoIChtYXJrKSB7XG4gICAgY2FzZSAnYmFyJzpcbiAgICBjYXNlICd0aWNrJzpcbiAgICAgIGlmIChjb25maWcuc2NhbGUubWF4QmFuZFNpemUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gY29uZmlnLnNjYWxlLm1heEJhbmRTaXplO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG1pblhZUmFuZ2VTdGVwKHh5UmFuZ2VTdGVwcywgY29uZmlnLnNjYWxlKSAtIDE7XG4gICAgY2FzZSAnbGluZSc6XG4gICAgY2FzZSAndHJhaWwnOlxuICAgIGNhc2UgJ3J1bGUnOlxuICAgICAgcmV0dXJuIGNvbmZpZy5zY2FsZS5tYXhTdHJva2VXaWR0aDtcbiAgICBjYXNlICd0ZXh0JzpcbiAgICAgIHJldHVybiBjb25maWcuc2NhbGUubWF4Rm9udFNpemU7XG4gICAgY2FzZSAncG9pbnQnOlxuICAgIGNhc2UgJ3NxdWFyZSc6XG4gICAgY2FzZSAnY2lyY2xlJzpcbiAgICAgIGlmIChjb25maWcuc2NhbGUubWF4U2l6ZSkge1xuICAgICAgICByZXR1cm4gY29uZmlnLnNjYWxlLm1heFNpemU7XG4gICAgICB9XG5cbiAgICAgIC8vIEZJWE1FIHRoaXMgY2FzZSB0b3RhbGx5IHNob3VsZCBiZSByZWZhY3RvcmVkXG4gICAgICBjb25zdCBwb2ludFN0ZXAgPSBtaW5YWVJhbmdlU3RlcCh4eVJhbmdlU3RlcHMsIHNjYWxlQ29uZmlnKTtcbiAgICAgIHJldHVybiAocG9pbnRTdGVwIC0gMikgKiAocG9pbnRTdGVwIC0gMik7XG4gIH1cbiAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IHNob3VsZCBuZXZlciByZWFjaCBoZXJlICovXG4gIC8vIHNpemVSYW5nZU1heCBub3QgaW1wbGVtZW50ZWQgZm9yIHRoZSBtYXJrXG4gIHRocm93IG5ldyBFcnJvcihsb2cubWVzc2FnZS5pbmNvbXBhdGlibGVDaGFubmVsKCdzaXplJywgbWFyaykpO1xufVxuXG4vKipcbiAqIEByZXR1cm5zIHtudW1iZXJ9IFJhbmdlIHN0ZXAgb2YgeCBvciB5IG9yIG1pbmltdW0gYmV0d2VlbiB0aGUgdHdvIGlmIGJvdGggYXJlIG9yZGluYWwgc2NhbGUuXG4gKi9cbmZ1bmN0aW9uIG1pblhZUmFuZ2VTdGVwKHh5UmFuZ2VTdGVwczogbnVtYmVyW10sIHNjYWxlQ29uZmlnOiBTY2FsZUNvbmZpZyk6IG51bWJlciB7XG4gIGlmICh4eVJhbmdlU3RlcHMubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiBNYXRoLm1pbi5hcHBseShudWxsLCB4eVJhbmdlU3RlcHMpO1xuICB9XG4gIGlmIChzY2FsZUNvbmZpZy5yYW5nZVN0ZXApIHtcbiAgICByZXR1cm4gc2NhbGVDb25maWcucmFuZ2VTdGVwO1xuICB9XG4gIHJldHVybiAyMTsgLy8gRklYTUU6IHJlLWV2YWx1YXRlIHRoZSBkZWZhdWx0IHZhbHVlIGhlcmUuXG59XG4iXX0=","import { X, Y } from '../../channel';\nimport * as log from '../../log';\nimport { channelScalePropertyIncompatability, hasContinuousDomain, isContinuousToContinuous, ScaleType, scaleTypeSupportProperty } from '../../scale';\nimport { contains, keys } from '../../util';\nimport * as util from '../../util';\nimport { isUnitModel } from '../model';\nimport { mergeValuesWithExplicit, tieBreakByComparing } from '../split';\nimport { parseScaleRange } from './range';\nexport function parseScaleProperty(model, property) {\n    if (isUnitModel(model)) {\n        parseUnitScaleProperty(model, property);\n    }\n    else {\n        parseNonUnitScaleProperty(model, property);\n    }\n}\nfunction parseUnitScaleProperty(model, property) {\n    var localScaleComponents = model.component.scales;\n    keys(localScaleComponents).forEach(function (channel) {\n        var specifiedScale = model.specifiedScales[channel];\n        var localScaleCmpt = localScaleComponents[channel];\n        var mergedScaleCmpt = model.getScaleComponent(channel);\n        var fieldDef = model.fieldDef(channel);\n        var config = model.config;\n        var specifiedValue = specifiedScale[property];\n        var sType = mergedScaleCmpt.get('type');\n        var supportedByScaleType = scaleTypeSupportProperty(sType, property);\n        var channelIncompatability = channelScalePropertyIncompatability(channel, property);\n        if (specifiedValue !== undefined) {\n            // If there is a specified value, check if it is compatible with scale type and channel\n            if (!supportedByScaleType) {\n                log.warn(log.message.scalePropertyNotWorkWithScaleType(sType, property, channel));\n            }\n            else if (channelIncompatability) { // channel\n                log.warn(channelIncompatability);\n            }\n        }\n        if (supportedByScaleType && channelIncompatability === undefined) {\n            if (specifiedValue !== undefined) {\n                // copyKeyFromObject ensure type safety\n                localScaleCmpt.copyKeyFromObject(property, specifiedScale);\n            }\n            else {\n                var value = getDefaultValue(property, channel, fieldDef, mergedScaleCmpt.get('type'), mergedScaleCmpt.get('padding'), mergedScaleCmpt.get('paddingInner'), specifiedScale.domain, model.markDef, config);\n                if (value !== undefined) {\n                    localScaleCmpt.set(property, value, false);\n                }\n            }\n        }\n    });\n}\n// Note: This method is used in Voyager.\nexport function getDefaultValue(property, channel, fieldDef, scaleType, scalePadding, scalePaddingInner, specifiedDomain, markDef, config) {\n    var scaleConfig = config.scale;\n    // If we have default rule-base, determine default value first\n    switch (property) {\n        case 'nice':\n            return nice(scaleType, channel, fieldDef);\n        case 'padding':\n            return padding(channel, scaleType, scaleConfig, fieldDef, markDef, config.bar);\n        case 'paddingInner':\n            return paddingInner(scalePadding, channel, scaleConfig);\n        case 'paddingOuter':\n            return paddingOuter(scalePadding, channel, scaleType, scalePaddingInner, scaleConfig);\n        case 'reverse':\n            return reverse(scaleType, fieldDef.sort);\n        case 'zero':\n            return zero(channel, fieldDef, specifiedDomain, markDef);\n    }\n    // Otherwise, use scale config\n    return scaleConfig[property];\n}\nexport function parseNonUnitScaleProperty(model, property) {\n    var localScaleComponents = model.component.scales;\n    for (var _i = 0, _a = model.children; _i < _a.length; _i++) {\n        var child = _a[_i];\n        if (property === 'range') {\n            parseScaleRange(child);\n        }\n        else {\n            parseScaleProperty(child, property);\n        }\n    }\n    keys(localScaleComponents).forEach(function (channel) {\n        var valueWithExplicit;\n        for (var _i = 0, _a = model.children; _i < _a.length; _i++) {\n            var child = _a[_i];\n            var childComponent = child.component.scales[channel];\n            if (childComponent) {\n                var childValueWithExplicit = childComponent.getWithExplicit(property);\n                valueWithExplicit = mergeValuesWithExplicit(valueWithExplicit, childValueWithExplicit, property, 'scale', tieBreakByComparing(function (v1, v2) {\n                    switch (property) {\n                        case 'range':\n                            // For range step, prefer larger step\n                            if (v1.step && v2.step) {\n                                return v1.step - v2.step;\n                            }\n                            return 0;\n                        // TODO: precedence rule for other properties\n                    }\n                    return 0;\n                }));\n            }\n        }\n        localScaleComponents[channel].setWithExplicit(property, valueWithExplicit);\n    });\n}\nexport function nice(scaleType, channel, fieldDef) {\n    if (fieldDef.bin || util.contains([ScaleType.TIME, ScaleType.UTC], scaleType)) {\n        return undefined;\n    }\n    return util.contains([X, Y], channel); // return true for quantitative X/Y unless binned\n}\nexport function padding(channel, scaleType, scaleConfig, fieldDef, markDef, barConfig) {\n    if (util.contains([X, Y], channel)) {\n        if (isContinuousToContinuous(scaleType)) {\n            if (scaleConfig.continuousPadding !== undefined) {\n                return scaleConfig.continuousPadding;\n            }\n            var type = markDef.type, orient = markDef.orient;\n            if (type === 'bar' && !fieldDef.bin) {\n                if ((orient === 'vertical' && channel === 'x') ||\n                    (orient === 'horizontal' && channel === 'y')) {\n                    return barConfig.continuousBandSize;\n                }\n            }\n        }\n        if (scaleType === ScaleType.POINT) {\n            return scaleConfig.pointPadding;\n        }\n    }\n    return undefined;\n}\nexport function paddingInner(paddingValue, channel, scaleConfig) {\n    if (paddingValue !== undefined) {\n        // If user has already manually specified \"padding\", no need to add default paddingInner.\n        return undefined;\n    }\n    if (util.contains([X, Y], channel)) {\n        // Padding is only set for X and Y by default.\n        // Basically it doesn't make sense to add padding for color and size.\n        // paddingOuter would only be called if it's a band scale, just return the default for bandScale.\n        return scaleConfig.bandPaddingInner;\n    }\n    return undefined;\n}\nexport function paddingOuter(paddingValue, channel, scaleType, paddingInnerValue, scaleConfig) {\n    if (paddingValue !== undefined) {\n        // If user has already manually specified \"padding\", no need to add default paddingOuter.\n        return undefined;\n    }\n    if (util.contains([X, Y], channel)) {\n        // Padding is only set for X and Y by default.\n        // Basically it doesn't make sense to add padding for color and size.\n        if (scaleType === ScaleType.BAND) {\n            if (scaleConfig.bandPaddingOuter !== undefined) {\n                return scaleConfig.bandPaddingOuter;\n            }\n            /* By default, paddingOuter is paddingInner / 2. The reason is that\n                size (width/height) = step * (cardinality - paddingInner + 2 * paddingOuter).\n                and we want the width/height to be integer by default.\n                Note that step (by default) and cardinality are integers.) */\n            return paddingInnerValue / 2;\n        }\n    }\n    return undefined;\n}\nexport function reverse(scaleType, sort) {\n    if (hasContinuousDomain(scaleType) && sort === 'descending') {\n        // For continuous domain scales, Vega does not support domain sort.\n        // Thus, we reverse range instead if sort is descending\n        return true;\n    }\n    return undefined;\n}\nexport function zero(channel, fieldDef, specifiedScale, markDef) {\n    // If users explicitly provide a domain range, we should not augment zero as that will be unexpected.\n    var hasCustomDomain = !!specifiedScale && specifiedScale !== 'unaggregated';\n    if (hasCustomDomain) {\n        return false;\n    }\n    // If there is no custom domain, return true only for the following cases:\n    // 1) using quantitative field with size\n    // While this can be either ratio or interval fields, our assumption is that\n    // ratio are more common.\n    if (channel === 'size' && fieldDef.type === 'quantitative') {\n        return true;\n    }\n    // 2) non-binned, quantitative x-scale or y-scale\n    // (For binning, we should not include zero by default because binning are calculated without zero.)\n    if (!fieldDef.bin && util.contains([X, Y], channel)) {\n        var orient = markDef.orient, type = markDef.type;\n        if (contains(['bar', 'area', 'line', 'trail'], type)) {\n            if ((orient === 'horizontal' && channel === 'y') ||\n                (orient === 'vertical' && channel === 'x')) {\n                return false;\n            }\n        }\n        return true;\n    }\n    return false;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvcGVydGllcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21waWxlL3NjYWxlL3Byb3BlcnRpZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUF3QixDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBRzFELE9BQU8sS0FBSyxHQUFHLE1BQU0sV0FBVyxDQUFDO0FBRWpDLE9BQU8sRUFBQyxtQ0FBbUMsRUFBVSxtQkFBbUIsRUFBRSx3QkFBd0IsRUFBZ0MsU0FBUyxFQUFFLHdCQUF3QixFQUFDLE1BQU0sYUFBYSxDQUFDO0FBRTFMLE9BQU8sRUFBQyxRQUFRLEVBQUUsSUFBSSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQzFDLE9BQU8sS0FBSyxJQUFJLE1BQU0sWUFBWSxDQUFDO0FBRW5DLE9BQU8sRUFBQyxXQUFXLEVBQVEsTUFBTSxVQUFVLENBQUM7QUFDNUMsT0FBTyxFQUFXLHVCQUF1QixFQUFFLG1CQUFtQixFQUFDLE1BQU0sVUFBVSxDQUFDO0FBR2hGLE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxTQUFTLENBQUM7QUFFeEMsTUFBTSw2QkFBNkIsS0FBWSxFQUFFLFFBQTZDO0lBQzVGLElBQUksV0FBVyxDQUFDLEtBQUssQ0FBQyxFQUFFO1FBQ3RCLHNCQUFzQixDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQztLQUN6QztTQUFNO1FBQ0wseUJBQXlCLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0tBQzVDO0FBQ0gsQ0FBQztBQUVELGdDQUFnQyxLQUFnQixFQUFFLFFBQTZDO0lBQzdGLElBQU0sb0JBQW9CLEdBQXdCLEtBQUssQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDO0lBRXpFLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFDLE9BQXFCO1FBQ3ZELElBQU0sY0FBYyxHQUFHLEtBQUssQ0FBQyxlQUFlLENBQUMsT0FBTyxD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SSxRQUFRLENBQUMsQ0FBQyxLQUFLLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxPQUFPLENBQUMsRUFBRSxJQUFJLENBQUMsRUFBRTtZQUNwRCxJQUNFLENBQUMsTUFBTSxLQUFLLFlBQVksSUFBSSxPQUFPLEtBQUssR0FBRyxDQUFDO2dCQUM1QyxDQUFDLE1BQU0sS0FBSyxVQUFVLElBQUksT0FBTyxLQUFLLEdBQUcsQ0FBQyxFQUMxQztnQkFDQSxPQUFPLEtBQUssQ0FBQzthQUNkO1NBQ0Y7UUFFRCxPQUFPLElBQUksQ0FBQztLQUNiO0lBQ0QsT0FBTyxLQUFLLENBQUM7QUFDZixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDaGFubmVsLCBTY2FsZUNoYW5uZWwsIFgsIFl9IGZyb20gJy4uLy4uL2NoYW5uZWwnO1xuaW1wb3J0IHtDb25maWd9IGZyb20gJy4uLy4uL2NvbmZpZyc7XG5pbXBvcnQge0ZpZWxkRGVmLCBTY2FsZUZpZWxkRGVmfSBmcm9tICcuLi8uLi9maWVsZGRlZic7XG5pbXBvcnQgKiBhcyBsb2cgZnJvbSAnLi4vLi4vbG9nJztcbmltcG9ydCB7QmFyQ29uZmlnLCBNYXJrRGVmfSBmcm9tICcuLi8uLi9tYXJrJztcbmltcG9ydCB7Y2hhbm5lbFNjYWxlUHJvcGVydHlJbmNvbXBhdGFiaWxpdHksIERvbWFpbiwgaGFzQ29udGludW91c0RvbWFpbiwgaXNDb250aW51b3VzVG9Db250aW51b3VzLCBOaWNlVGltZSwgU2NhbGUsIFNjYWxlQ29uZmlnLCBTY2FsZVR5cGUsIHNjYWxlVHlwZVN1cHBvcnRQcm9wZXJ0eX0gZnJvbSAnLi4vLi4vc2NhbGUnO1xuaW1wb3J0IHtFbmNvZGluZ1NvcnRGaWVsZCwgU29ydE9yZGVyfSBmcm9tICcuLi8uLi9zb3J0JztcbmltcG9ydCB7Y29udGFpbnMsIGtleXN9IGZyb20gJy4uLy4uL3V0aWwnO1xuaW1wb3J0ICogYXMgdXRpbCBmcm9tICcuLi8uLi91dGlsJztcbmltcG9ydCB7VmdTY2FsZX0gZnJvbSAnLi4vLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtpc1VuaXRNb2RlbCwgTW9kZWx9IGZyb20gJy4uL21vZGVsJztcbmltcG9ydCB7RXhwbGljaXQsIG1lcmdlVmFsdWVzV2l0aEV4cGxpY2l0LCB0aWVCcmVha0J5Q29tcGFyaW5nfSBmcm9tICcuLi9zcGxpdCc7XG5pbXBvcnQge1VuaXRNb2RlbH0gZnJvbSAnLi4vdW5pdCc7XG5pbXBvcnQge1NjYWxlQ29tcG9uZW50LCBTY2FsZUNvbXBvbmVudEluZGV4LCBTY2FsZUNvbXBvbmVudFByb3BzfSBmcm9tICcuL2NvbXBvbmVudCc7XG5pbXBvcnQge3BhcnNlU2NhbGVSYW5nZX0gZnJvbSAnLi9yYW5nZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVNjYWxlUHJvcGVydHkobW9kZWw6IE1vZGVsLCBwcm9wZXJ0eToga2V5b2YgKFNjYWxlIHwgU2NhbGVDb21wb25lbnRQcm9wcykpIHtcbiAgaWYgKGlzVW5pdE1vZGVsKG1vZGVsKSkge1xuICAgIHBhcnNlVW5pdFNjYWxlUHJvcGVydHkobW9kZWwsIHByb3BlcnR5KTtcbiAgfSBlbHNlIHtcbiAgICBwYXJzZU5vblVuaXRTY2FsZVByb3BlcnR5KG1vZGVsLCBwcm9wZXJ0eSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcGFyc2VVbml0U2NhbGVQcm9wZXJ0eShtb2RlbDogVW5pdE1vZGVsLCBwcm9wZXJ0eToga2V5b2YgKFNjYWxlIHwgU2NhbGVDb21wb25lbnRQcm9wcykpIHtcbiAgY29uc3QgbG9jYWxTY2FsZUNvbXBvbmVudHM6IFNjYWxlQ29tcG9uZW50SW5kZXggPSBtb2RlbC5jb21wb25lbnQuc2NhbGVzO1xuXG4gIGtleXMobG9jYWxTY2FsZUNvbXBvbmVudHMpLmZvckVhY2goKGNoYW5uZWw6IFNjYWxlQ2hhbm5lbCkgPT4ge1xuICAgIGNvbnN0IHNwZWNpZmllZFNjYWxlID0gbW9kZWwuc3BlY2lmaWVkU2NhbGVzW2NoYW5uZWxdO1xuICAgIGNvbnN0IGxvY2FsU2NhbGVDbXB0ID0gbG9jYWxTY2FsZUNvbXBvbmVudHNbY2hhbm5lbF07XG4gICAgY29uc3QgbWVyZ2VkU2NhbGVDbXB0ID0gbW9kZWwuZ2V0U2NhbGVDb21wb25lbnQoY2hhbm5lbCk7XG4gICAgY29uc3QgZmllbGREZWYgPSBtb2RlbC5maWVsZERlZihjaGFubmVsKTtcbiAgICBjb25zdCBjb25maWcgPSBtb2RlbC5jb25maWc7XG5cbiAgICBjb25zdCBzcGVjaWZpZWRWYWx1ZSA9IHNwZWNpZmllZFNjYWxlW3Byb3BlcnR5XTtcbiAgICBjb25zdCBzVHlwZSA9IG1lcmdlZFNjYWxlQ21wdC5nZXQoJ3R5cGUnKTtcblxuICAgIGNvbnN0IHN1cHBvcnRlZEJ5U2NhbGVUeXBlID0gc2NhbGVUeXBlU3VwcG9ydFByb3BlcnR5KHNUeXBlLCBwcm9wZXJ0eSk7XG4gICAgY29uc3QgY2hhbm5lbEluY29tcGF0YWJpbGl0eSA9IGNoYW5uZWxTY2FsZVByb3BlcnR5SW5jb21wYXRhYmlsaXR5KGNoYW5uZWwsIHByb3BlcnR5KTtcblxuICAgIGlmIChzcGVjaWZpZWRWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAvLyBJZiB0aGVyZSBpcyBhIHNwZWNpZmllZCB2YWx1ZSwgY2hlY2sgaWYgaXQgaXMgY29tcGF0aWJsZSB3aXRoIHNjYWxlIHR5cGUgYW5kIGNoYW5uZWxcbiAgICAgIGlmICghc3VwcG9ydGVkQnlTY2FsZVR5cGUpIHtcbiAgICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2Uuc2NhbGVQcm9wZXJ0eU5vdFdvcmtXaXRoU2NhbGVUeXBlKHNUeXBlLCBwcm9wZXJ0eSwgY2hhbm5lbCkpO1xuICAgICAgfSBlbHNlIGlmIChjaGFubmVsSW5jb21wYXRhYmlsaXR5KSB7IC8vIGNoYW5uZWxcbiAgICAgICAgbG9nLndhcm4oY2hhbm5lbEluY29tcGF0YWJpbGl0eSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChzdXBwb3J0ZWRCeVNjYWxlVHlwZSAmJiBjaGFubmVsSW5jb21wYXRhYmlsaXR5ID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGlmIChzcGVjaWZpZWRWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIC8vIGNvcHlLZXlGcm9tT2JqZWN0IGVuc3VyZSB0eXBlIHNhZmV0eVxuICAgICAgICBsb2NhbFNjYWxlQ21wdC5jb3B5S2V5RnJvbU9iamVjdChwcm9wZXJ0eSwgc3BlY2lmaWVkU2NhbGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBnZXREZWZhdWx0VmFsdWUoXG4gICAgICAgICAgcHJvcGVydHksIGNoYW5uZWwsIGZpZWxkRGVmLFxuICAgICAgICAgIG1lcmdlZFNjYWxlQ21wdC5nZXQoJ3R5cGUnKSxcbiAgICAgICAgICBtZXJnZWRTY2FsZUNtcHQuZ2V0KCdwYWRkaW5nJyksXG4gICAgICAgICAgbWVyZ2VkU2NhbGVDbXB0LmdldCgncGFkZGluZ0lubmVyJyksXG4gICAgICAgICAgc3BlY2lmaWVkU2NhbGUuZG9tYWluLFxuICAgICAgICAgIG1vZGVsLm1hcmtEZWYsIGNvbmZpZ1xuICAgICAgICApO1xuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGxvY2FsU2NhbGVDbXB0LnNldChwcm9wZXJ0eSwgdmFsdWUsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSk7XG59XG5cbi8vIE5vdGU6IFRoaXMgbWV0aG9kIGlzIHVzZWQgaW4gVm95YWdlci5cbmV4cG9ydCBmdW5jdGlvbiBnZXREZWZhdWx0VmFsdWUoXG4gIHByb3BlcnR5OiBrZXlvZiBTY2FsZSwgY2hhbm5lbDogQ2hhbm5lbCwgZmllbGREZWY6IFNjYWxlRmllbGREZWY8c3RyaW5nPixcbiAgc2NhbGVUeXBlOiBTY2FsZVR5cGUsIHNjYWxlUGFkZGluZzogbnVtYmVyLCBzY2FsZVBhZGRpbmdJbm5lcjogbnVtYmVyLFxuICBzcGVjaWZpZWREb21haW46IFNjYWxlWydkb21haW4nXSwgbWFya0RlZjogTWFya0RlZiwgY29uZmlnOiBDb25maWcpIHtcbiAgY29uc3Qgc2NhbGVDb25maWcgPSBjb25maWcuc2NhbGU7XG5cbiAgLy8gSWYgd2UgaGF2ZSBkZWZhdWx0IHJ1bGUtYmFzZSwgZGV0ZXJtaW5lIGRlZmF1bHQgdmFsdWUgZmlyc3RcbiAgc3dpdGNoIChwcm9wZXJ0eSkge1xuICAgIGNhc2UgJ25pY2UnOlxuICAgICAgcmV0dXJuIG5pY2Uoc2NhbGVUeXBlLCBjaGFubmVsLCBmaWVsZERlZik7XG4gICAgY2FzZSAncGFkZGluZyc6XG4gICAgICByZXR1cm4gcGFkZGluZyhjaGFubmVsLCBzY2FsZVR5cGUsIHNjYWxlQ29uZmlnLCBmaWVsZERlZiwgbWFya0RlZiwgY29uZmlnLmJhcik7XG4gICAgY2FzZSAncGFkZGluZ0lubmVyJzpcbiAgICAgIHJldHVybiBwYWRkaW5nSW5uZXIoc2NhbGVQYWRkaW5nLCBjaGFubmVsLCBzY2FsZUNvbmZpZyk7XG4gICAgY2FzZSAncGFkZGluZ091dGVyJzpcbiAgICAgIHJldHVybiBwYWRkaW5nT3V0ZXIoc2NhbGVQYWRkaW5nLCBjaGFubmVsLCBzY2FsZVR5cGUsIHNjYWxlUGFkZGluZ0lubmVyLCBzY2FsZUNvbmZpZyk7XG4gICAgY2FzZSAncmV2ZXJzZSc6XG4gICAgICByZXR1cm4gcmV2ZXJzZShzY2FsZVR5cGUsIGZpZWxkRGVmLnNvcnQpO1xuICAgIGNhc2UgJ3plcm8nOlxuICAgICAgcmV0dXJuIHplcm8oY2hhbm5lbCwgZmllbGREZWYsIHNwZWNpZmllZERvbWFpbiwgbWFya0RlZik7XG4gIH1cbiAgLy8gT3RoZXJ3aXNlLCB1c2Ugc2NhbGUgY29uZmlnXG4gIHJldHVybiBzY2FsZUNvbmZpZ1twcm9wZXJ0eV07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZU5vblVuaXRTY2FsZVByb3BlcnR5KG1vZGVsOiBNb2RlbCwgcHJvcGVydHk6IGtleW9mIChTY2FsZSB8IFNjYWxlQ29tcG9uZW50UHJvcHMpKSB7XG4gIGNvbnN0IGxvY2FsU2NhbGVDb21wb25lbnRzOiBTY2FsZUNvbXBvbmVudEluZGV4ID0gbW9kZWwuY29tcG9uZW50LnNjYWxlcztcblxuICBmb3IgKGNvbnN0IGNoaWxkIG9mIG1vZGVsLmNoaWxkcmVuKSB7XG4gICAgaWYgKHByb3BlcnR5ID09PSAncmFuZ2UnKSB7XG4gICAgICBwYXJzZVNjYWxlUmFuZ2UoY2hpbGQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBwYXJzZVNjYWxlUHJvcGVydHkoY2hpbGQsIHByb3BlcnR5KTtcbiAgICB9XG4gIH1cblxuICBrZXlzKGxvY2FsU2NhbGVDb21wb25lbnRzKS5mb3JFYWNoKChjaGFubmVsOiBTY2FsZUNoYW5uZWwpID0+IHtcbiAgICBsZXQgdmFsdWVXaXRoRXhwbGljaXQ6IEV4cGxpY2l0PGFueT47XG5cbiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIG1vZGVsLmNoaWxkcmVuKSB7XG4gICAgICBjb25zdCBjaGlsZENvbXBvbmVudCA9IGNoaWxkLmNvbXBvbmVudC5zY2FsZXNbY2hhbm5lbF07XG4gICAgICBpZiAoY2hpbGRDb21wb25lbnQpIHtcbiAgICAgICAgY29uc3QgY2hpbGRWYWx1ZVdpdGhFeHBsaWNpdCA9IGNoaWxkQ29tcG9uZW50LmdldFdpdGhFeHBsaWNpdChwcm9wZXJ0eSk7XG4gICAgICAgIHZhbHVlV2l0aEV4cGxpY2l0ID0gbWVyZ2VWYWx1ZXNXaXRoRXhwbGljaXQ8VmdTY2FsZSwgYW55PihcbiAgICAgICAgICB2YWx1ZVdpdGhFeHBsaWNpdCwgY2hpbGRWYWx1ZVdpdGhFeHBsaWNpdCxcbiAgICAgICAgICBwcm9wZXJ0eSxcbiAgICAgICAgICAnc2NhbGUnLFxuICAgICAgICAgIHRpZUJyZWFrQnlDb21wYXJpbmc8VmdTY2FsZSwgYW55PigodjEsIHYyKSA9PiB7XG4gICAgICAgICAgICBzd2l0Y2ggKHByb3BlcnR5KSB7XG4gICAgICAgICAgICAgIGNhc2UgJ3JhbmdlJzpcbiAgICAgICAgICAgICAgICAvLyBGb3IgcmFuZ2Ugc3RlcCwgcHJlZmVyIGxhcmdlciBzdGVwXG4gICAgICAgICAgICAgICAgaWYgKHYxLnN0ZXAgJiYgdjIuc3RlcCkge1xuICAgICAgICAgICAgICAgICAgcmV0dXJuIHYxLnN0ZXAgLSB2Mi5zdGVwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgLy8gVE9ETzogcHJlY2VkZW5jZSBydWxlIGZvciBvdGhlciBwcm9wZXJ0aWVzXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICBsb2NhbFNjYWxlQ29tcG9uZW50c1tjaGFubmVsXS5zZXRXaXRoRXhwbGljaXQocHJvcGVydHksIHZhbHVlV2l0aEV4cGxpY2l0KTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBuaWNlKHNjYWxlVHlwZTogU2NhbGVUeXBlLCBjaGFubmVsOiBDaGFubmVsLCBmaWVsZERlZjogRmllbGREZWY8c3RyaW5nPik6IGJvb2xlYW4gfCBOaWNlVGltZSB7XG4gIGlmIChmaWVsZERlZi5iaW4gfHwgdXRpbC5jb250YWlucyhbU2NhbGVUeXBlLlRJTUUsIFNjYWxlVHlwZS5VVENdLCBzY2FsZVR5cGUpKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICByZXR1cm4gdXRpbC5jb250YWlucyhbWCwgWV0sIGNoYW5uZWwpOyAvLyByZXR1cm4gdHJ1ZSBmb3IgcXVhbnRpdGF0aXZlIFgvWSB1bmxlc3MgYmlubmVkXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYWRkaW5nKGNoYW5uZWw6IENoYW5uZWwsIHNjYWxlVHlwZTogU2NhbGVUeXBlLCBzY2FsZUNvbmZpZzogU2NhbGVDb25maWcsIGZpZWxkRGVmOiBGaWVsZERlZjxzdHJpbmc+LCBtYXJrRGVmOiBNYXJrRGVmLCBiYXJDb25maWc6IEJhckNvbmZpZykge1xuICBpZiAodXRpbC5jb250YWlucyhbWCwgWV0sIGNoYW5uZWwpKSB7XG4gICAgaWYgKGlzQ29udGludW91c1RvQ29udGludW91cyhzY2FsZVR5cGUpKSB7XG4gICAgICBpZiAoc2NhbGVDb25maWcuY29udGludW91c1BhZGRpbmcgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gc2NhbGVDb25maWcuY29udGludW91c1BhZGRpbmc7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHt0eXBlLCBvcmllbnR9ID0gbWFya0RlZjtcbiAgICAgIGlmICh0eXBlID09PSAnYmFyJyAmJiAhZmllbGREZWYuYmluKSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICAob3JpZW50ID09PSAndmVydGljYWwnICYmIGNoYW5uZWwgPT09ICd4JykgfHxcbiAgICAgICAgICAob3JpZW50ID09PSAnaG9yaXpvbnRhbCcgJiYgY2hhbm5lbCA9PT0gJ3knKVxuICAgICAgICApIHtcbiAgICAgICAgICByZXR1cm4gYmFyQ29uZmlnLmNvbnRpbnVvdXNCYW5kU2l6ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChzY2FsZVR5cGUgPT09IFNjYWxlVHlwZS5QT0lOVCkge1xuICAgICAgcmV0dXJuIHNjYWxlQ29uZmlnLnBvaW50UGFkZGluZztcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhZGRpbmdJbm5lcihwYWRkaW5nVmFsdWU6IG51bWJlciwgY2hhbm5lbDogQ2hhbm5lbCwgc2NhbGVDb25maWc6IFNjYWxlQ29uZmlnKSB7XG4gIGlmIChwYWRkaW5nVmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgIC8vIElmIHVzZXIgaGFzIGFscmVhZHkgbWFudWFsbHkgc3BlY2lmaWVkIFwicGFkZGluZ1wiLCBubyBuZWVkIHRvIGFkZCBkZWZhdWx0IHBhZGRpbmdJbm5lci5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgaWYgKHV0aWwuY29udGFpbnMoW1gsIFldLCBjaGFubmVsKSkge1xuICAgIC8vIFBhZGRpbmcgaXMgb25seSBzZXQgZm9yIFggYW5kIFkgYnkgZGVmYXVsdC5cbiAgICAvLyBCYXNpY2FsbHkgaXQgZG9lc24ndCBtYWtlIHNlbnNlIHRvIGFkZCBwYWRkaW5nIGZvciBjb2xvciBhbmQgc2l6ZS5cblxuICAgIC8vIHBhZGRpbmdPdXRlciB3b3VsZCBvbmx5IGJlIGNhbGxlZCBpZiBpdCdzIGEgYmFuZCBzY2FsZSwganVzdCByZXR1cm4gdGhlIGRlZmF1bHQgZm9yIGJhbmRTY2FsZS5cbiAgICByZXR1cm4gc2NhbGVDb25maWcuYmFuZFBhZGRpbmdJbm5lcjtcbiAgfVxuICByZXR1cm4gdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFkZGluZ091dGVyKHBhZGRpbmdWYWx1ZTogbnVtYmVyLCBjaGFubmVsOiBDaGFubmVsLCBzY2FsZVR5cGU6IFNjYWxlVHlwZSwgcGFkZGluZ0lubmVyVmFsdWU6IG51bWJlciwgc2NhbGVDb25maWc6IFNjYWxlQ29uZmlnKSB7XG4gIGlmIChwYWRkaW5nVmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgIC8vIElmIHVzZXIgaGFzIGFscmVhZHkgbWFudWFsbHkgc3BlY2lmaWVkIFwicGFkZGluZ1wiLCBubyBuZWVkIHRvIGFkZCBkZWZhdWx0IHBhZGRpbmdPdXRlci5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgaWYgKHV0aWwuY29udGFpbnMoW1gsIFldLCBjaGFubmVsKSkge1xuICAgIC8vIFBhZGRpbmcgaXMgb25seSBzZXQgZm9yIFggYW5kIFkgYnkgZGVmYXVsdC5cbiAgICAvLyBCYXNpY2FsbHkgaXQgZG9lc24ndCBtYWtlIHNlbnNlIHRvIGFkZCBwYWRkaW5nIGZvciBjb2xvciBhbmQgc2l6ZS5cbiAgICBpZiAoc2NhbGVUeXBlID09PSBTY2FsZVR5cGUuQkFORCkge1xuICAgICAgaWYgKHNjYWxlQ29uZmlnLmJhbmRQYWRkaW5nT3V0ZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gc2NhbGVDb25maWcuYmFuZFBhZGRpbmdPdXRlcjtcbiAgICAgIH1cbiAgICAgIC8qIEJ5IGRlZmF1bHQsIHBhZGRpbmdPdXRlciBpcyBwYWRkaW5nSW5uZXIgLyAyLiBUaGUgcmVhc29uIGlzIHRoYXRcbiAgICAgICAgICBzaXplICh3aWR0aC9oZWlnaHQpID0gc3RlcCAqIChjYXJkaW5hbGl0eSAtIHBhZGRpbmdJbm5lciArIDIgKiBwYWRkaW5nT3V0ZXIpLlxuICAgICAgICAgIGFuZCB3ZSB3YW50IHRoZSB3aWR0aC9oZWlnaHQgdG8gYmUgaW50ZWdlciBieSBkZWZhdWx0LlxuICAgICAgICAgIE5vdGUgdGhhdCBzdGVwIChieSBkZWZhdWx0KSBhbmQgY2FyZGluYWxpdHkgYXJlIGludGVnZXJzLikgKi9cbiAgICAgIHJldHVybiBwYWRkaW5nSW5uZXJWYWx1ZSAvIDI7XG4gICAgfVxuICB9XG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXZlcnNlKHNjYWxlVHlwZTogU2NhbGVUeXBlLCBzb3J0OiBTb3J0T3JkZXIgfCBFbmNvZGluZ1NvcnRGaWVsZDxzdHJpbmc+IHwgc3RyaW5nW10pIHtcbiAgaWYgKGhhc0NvbnRpbnVvdXNEb21haW4oc2NhbGVUeXBlKSAmJiBzb3J0ID09PSAnZGVzY2VuZGluZycpIHtcbiAgICAvLyBGb3IgY29udGludW91cyBkb21haW4gc2NhbGVzLCBWZWdhIGRvZXMgbm90IHN1cHBvcnQgZG9tYWluIHNvcnQuXG4gICAgLy8gVGh1cywgd2UgcmV2ZXJzZSByYW5nZSBpbnN0ZWFkIGlmIHNvcnQgaXMgZGVzY2VuZGluZ1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB6ZXJvKGNoYW5uZWw6IENoYW5uZWwsIGZpZWxkRGVmOiBGaWVsZERlZjxzdHJpbmc+LCBzcGVjaWZpZWRTY2FsZTogRG9tYWluLCBtYXJrRGVmOiBNYXJrRGVmKSB7XG5cbiAgLy8gSWYgdXNlcnMgZXhwbGljaXRseSBwcm92aWRlIGEgZG9tYWluIHJhbmdlLCB3ZSBzaG91bGQgbm90IGF1Z21lbnQgemVybyBhcyB0aGF0IHdpbGwgYmUgdW5leHBlY3RlZC5cbiAgY29uc3QgaGFzQ3VzdG9tRG9tYWluID0gISFzcGVjaWZpZWRTY2FsZSAmJiBzcGVjaWZpZWRTY2FsZSAhPT0gJ3VuYWdncmVnYXRlZCc7XG4gIGlmIChoYXNDdXN0b21Eb21haW4pIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvLyBJZiB0aGVyZSBpcyBubyBjdXN0b20gZG9tYWluLCByZXR1cm4gdHJ1ZSBvbmx5IGZvciB0aGUgZm9sbG93aW5nIGNhc2VzOlxuXG4gIC8vIDEpIHVzaW5nIHF1YW50aXRhdGl2ZSBmaWVsZCB3aXRoIHNpemVcbiAgLy8gV2hpbGUgdGhpcyBjYW4gYmUgZWl0aGVyIHJhdGlvIG9yIGludGVydmFsIGZpZWxkcywgb3VyIGFzc3VtcHRpb24gaXMgdGhhdFxuICAvLyByYXRpbyBhcmUgbW9yZSBjb21tb24uXG4gIGlmIChjaGFubmVsID09PSAnc2l6ZScgJiYgZmllbGREZWYudHlwZSA9PT0gJ3F1YW50aXRhdGl2ZScpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIC8vIDIpIG5vbi1iaW5uZWQsIHF1YW50aXRhdGl2ZSB4LXNjYWxlIG9yIHktc2NhbGVcbiAgLy8gKEZvciBiaW5uaW5nLCB3ZSBzaG91bGQgbm90IGluY2x1ZGUgemVybyBieSBkZWZhdWx0IGJlY2F1c2UgYmlubmluZyBhcmUgY2FsY3VsYXRlZCB3aXRob3V0IHplcm8uKVxuICBpZiAoIWZpZWxkRGVmLmJpbiAmJiB1dGlsLmNvbnRhaW5zKFtYLCBZXSwgY2hhbm5lbCkpIHtcbiAgICBjb25zdCB7b3JpZW50LCB0eXBlfSA9IG1hcmtEZWY7XG4gICAgaWYgKGNvbnRhaW5zKFsnYmFyJywgJ2FyZWEnLCAnbGluZScsICd0cmFpbCddLCB0eXBlKSkge1xuICAgICAgaWYgKFxuICAgICAgICAob3JpZW50ID09PSAnaG9yaXpvbnRhbCcgJiYgY2hhbm5lbCA9PT0gJ3knKSB8fFxuICAgICAgICAob3JpZW50ID09PSAndmVydGljYWwnICYmIGNoYW5uZWwgPT09ICd4JylcbiAgICAgICkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuIl19","import { isColorChannel, isScaleChannel, rangeType } from '../../channel';\nimport * as log from '../../log';\nimport { channelSupportScaleType, scaleTypeSupportDataType } from '../../scale';\nimport * as util from '../../util';\n/**\n * Determine if there is a specified scale type and if it is appropriate,\n * or determine default type if type is unspecified or inappropriate.\n */\n// NOTE: CompassQL uses this method.\nexport function scaleType(specifiedType, channel, fieldDef, mark, scaleConfig) {\n    var defaultScaleType = defaultType(channel, fieldDef, mark, scaleConfig);\n    if (!isScaleChannel(channel)) {\n        // There is no scale for these channels\n        return null;\n    }\n    if (specifiedType !== undefined) {\n        // Check if explicitly specified scale type is supported by the channel\n        if (!channelSupportScaleType(channel, specifiedType)) {\n            log.warn(log.message.scaleTypeNotWorkWithChannel(channel, specifiedType, defaultScaleType));\n            return defaultScaleType;\n        }\n        // Check if explicitly specified scale type is supported by the data type\n        if (!scaleTypeSupportDataType(specifiedType, fieldDef.type, fieldDef.bin)) {\n            log.warn(log.message.scaleTypeNotWorkWithFieldDef(specifiedType, defaultScaleType));\n            return defaultScaleType;\n        }\n        return specifiedType;\n    }\n    return defaultScaleType;\n}\n/**\n * Determine appropriate default scale type.\n */\n// NOTE: Voyager uses this method.\nfunction defaultType(channel, fieldDef, mark, scaleConfig) {\n    switch (fieldDef.type) {\n        case 'nominal':\n        case 'ordinal':\n            if (isColorChannel(channel) || rangeType(channel) === 'discrete') {\n                if (channel === 'shape' && fieldDef.type === 'ordinal') {\n                    log.warn(log.message.discreteChannelCannotEncode(channel, 'ordinal'));\n                }\n                return 'ordinal';\n            }\n            if (util.contains(['x', 'y'], channel)) {\n                if (util.contains(['rect', 'bar', 'rule'], mark)) {\n                    // The rect/bar mark should fit into a band.\n                    // For rule, using band scale to make rule align with axis ticks better https://github.com/vega/vega-lite/issues/3429\n                    return 'band';\n                }\n                if (mark === 'bar') {\n                    return 'band';\n                }\n            }\n            // Otherwise, use ordinal point scale so we can easily get center positions of the marks.\n            return 'point';\n        case 'temporal':\n            if (isColorChannel(channel)) {\n                return 'sequential';\n            }\n            else if (rangeType(channel) === 'discrete') {\n                log.warn(log.message.discreteChannelCannotEncode(channel, 'temporal'));\n                // TODO: consider using quantize (equivalent to binning) once we have it\n                return 'ordinal';\n            }\n            return 'time';\n        case 'quantitative':\n            if (isColorChannel(channel)) {\n                if (fieldDef.bin) {\n                    return 'bin-ordinal';\n                }\n                // Use `sequential` as the default color scale for continuous data\n                // since it supports both array range and scheme range.\n                return 'sequential';\n            }\n            else if (rangeType(channel) === 'discrete') {\n                log.warn(log.message.discreteChannelCannotEncode(channel, 'quantitative'));\n                // TODO: consider using quantize (equivalent to binning) once we have it\n                return 'ordinal';\n            }\n            // x and y use a linear scale because selections don't work with bin scales.\n            // Binned scales apply discretization but pan/zoom apply transformations to a [min, max] extent domain.\n            if (fieldDef.bin && channel !== 'x' && channel !== 'y') {\n                return 'bin-linear';\n            }\n            return 'linear';\n        case 'latitude':\n        case 'longitude':\n        case 'geojson':\n            return undefined;\n    }\n    /* istanbul ignore next: should never reach this */\n    throw new Error(log.message.invalidFieldType(fieldDef.type));\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21waWxlL3NjYWxlL3R5cGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFVLGNBQWMsRUFBRSxjQUFjLEVBQUUsU0FBUyxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBRWpGLE9BQU8sS0FBSyxHQUFHLE1BQU0sV0FBVyxDQUFDO0FBRWpDLE9BQU8sRUFBQyx1QkFBdUIsRUFBMEIsd0JBQXdCLEVBQUMsTUFBTSxhQUFhLENBQUM7QUFDdEcsT0FBTyxLQUFLLElBQUksTUFBTSxZQUFZLENBQUM7QUFJbkM7OztHQUdHO0FBQ0gsb0NBQW9DO0FBQ3BDLE1BQU0sb0JBQ0osYUFBd0IsRUFBRSxPQUFnQixFQUFFLFFBQTBCLEVBQ3RFLElBQVUsRUFBRSxXQUF3QjtJQUdwQyxJQUFNLGdCQUFnQixHQUFHLFdBQVcsQ0FBQyxPQUFPLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxXQUFXLENBQUMsQ0FBQztJQUUzRSxJQUFJLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxFQUFFO1FBQzVCLHVDQUF1QztRQUN2QyxPQUFPLElBQUksQ0FBQztLQUNiO0lBQ0QsSUFBSSxhQUFhLEtBQUssU0FBUyxFQUFFO1FBQy9CLHVFQUF1RTtRQUN2RSxJQUFJLENBQUMsdUJBQXVCLENBQUMsT0FBTyxFQUFFLGFBQWEsQ0FBQyxFQUFFO1lBQ3BELEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQywyQkFBMkIsQ0FBQyxPQUFPLEVBQUUsYUFBYSxFQUFFLGdCQUFnQixDQUFDLENBQUMsQ0FBQztZQUM1RixPQUFPLGdCQUFnQixDQUFDO1NBQ3pCO1FBRUQseUVBQXlFO1FBQ3pFLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxhQUFhLEVBQUUsUUFBUSxDQUFDLElBQUksRUFBRSxRQUFRLENBQUMsR0FBRyxDQUFDLEVBQUU7WUFDekUsR0FBRyxDQUFDLElBQUks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LENBQUMsQ0FBQyxDQUFDO0FBQy9ELENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NoYW5uZWwsIGlzQ29sb3JDaGFubmVsLCBpc1NjYWxlQ2hhbm5lbCwgcmFuZ2VUeXBlfSBmcm9tICcuLi8uLi9jaGFubmVsJztcbmltcG9ydCB7RmllbGREZWZ9IGZyb20gJy4uLy4uL2ZpZWxkZGVmJztcbmltcG9ydCAqIGFzIGxvZyBmcm9tICcuLi8uLi9sb2cnO1xuaW1wb3J0IHtNYXJrfSBmcm9tICcuLi8uLi9tYXJrJztcbmltcG9ydCB7Y2hhbm5lbFN1cHBvcnRTY2FsZVR5cGUsIFNjYWxlQ29uZmlnLCBTY2FsZVR5cGUsIHNjYWxlVHlwZVN1cHBvcnREYXRhVHlwZX0gZnJvbSAnLi4vLi4vc2NhbGUnO1xuaW1wb3J0ICogYXMgdXRpbCBmcm9tICcuLi8uLi91dGlsJztcblxuZXhwb3J0IHR5cGUgUmFuZ2VUeXBlID0gJ2NvbnRpbnVvdXMnIHwgJ2Rpc2NyZXRlJyB8ICdmbGV4aWJsZScgfCB1bmRlZmluZWQ7XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIHRoZXJlIGlzIGEgc3BlY2lmaWVkIHNjYWxlIHR5cGUgYW5kIGlmIGl0IGlzIGFwcHJvcHJpYXRlLFxuICogb3IgZGV0ZXJtaW5lIGRlZmF1bHQgdHlwZSBpZiB0eXBlIGlzIHVuc3BlY2lmaWVkIG9yIGluYXBwcm9wcmlhdGUuXG4gKi9cbi8vIE5PVEU6IENvbXBhc3NRTCB1c2VzIHRoaXMgbWV0aG9kLlxuZXhwb3J0IGZ1bmN0aW9uIHNjYWxlVHlwZShcbiAgc3BlY2lmaWVkVHlwZTogU2NhbGVUeXBlLCBjaGFubmVsOiBDaGFubmVsLCBmaWVsZERlZjogRmllbGREZWY8c3RyaW5nPixcbiAgbWFyazogTWFyaywgc2NhbGVDb25maWc6IFNjYWxlQ29uZmlnXG4pOiBTY2FsZVR5cGUge1xuXG4gIGNvbnN0IGRlZmF1bHRTY2FsZVR5cGUgPSBkZWZhdWx0VHlwZShjaGFubmVsLCBmaWVsZERlZiwgbWFyaywgc2NhbGVDb25maWcpO1xuXG4gIGlmICghaXNTY2FsZUNoYW5uZWwoY2hhbm5lbCkpIHtcbiAgICAvLyBUaGVyZSBpcyBubyBzY2FsZSBmb3IgdGhlc2UgY2hhbm5lbHNcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBpZiAoc3BlY2lmaWVkVHlwZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gQ2hlY2sgaWYgZXhwbGljaXRseSBzcGVjaWZpZWQgc2NhbGUgdHlwZSBpcyBzdXBwb3J0ZWQgYnkgdGhlIGNoYW5uZWxcbiAgICBpZiAoIWNoYW5uZWxTdXBwb3J0U2NhbGVUeXBlKGNoYW5uZWwsIHNwZWNpZmllZFR5cGUpKSB7XG4gICAgICBsb2cud2Fybihsb2cubWVzc2FnZS5zY2FsZVR5cGVOb3RXb3JrV2l0aENoYW5uZWwoY2hhbm5lbCwgc3BlY2lmaWVkVHlwZSwgZGVmYXVsdFNjYWxlVHlwZSkpO1xuICAgICAgcmV0dXJuIGRlZmF1bHRTY2FsZVR5cGU7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgZXhwbGljaXRseSBzcGVjaWZpZWQgc2NhbGUgdHlwZSBpcyBzdXBwb3J0ZWQgYnkgdGhlIGRhdGEgdHlwZVxuICAgIGlmICghc2NhbGVUeXBlU3VwcG9ydERhdGFUeXBlKHNwZWNpZmllZFR5cGUsIGZpZWxkRGVmLnR5cGUsIGZpZWxkRGVmLmJpbikpIHtcbiAgICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLnNjYWxlVHlwZU5vdFdvcmtXaXRoRmllbGREZWYoc3BlY2lmaWVkVHlwZSwgZGVmYXVsdFNjYWxlVHlwZSkpO1xuICAgICAgcmV0dXJuIGRlZmF1bHRTY2FsZVR5cGU7XG4gICAgfVxuXG4gICAgcmV0dXJuIHNwZWNpZmllZFR5cGU7XG4gIH1cblxuICByZXR1cm4gZGVmYXVsdFNjYWxlVHlwZTtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgYXBwcm9wcmlhdGUgZGVmYXVsdCBzY2FsZSB0eXBlLlxuICovXG4vLyBOT1RFOiBWb3lhZ2VyIHVzZXMgdGhpcyBtZXRob2QuXG5mdW5jdGlvbiBkZWZhdWx0VHlwZShcbiAgY2hhbm5lbDogQ2hhbm5lbCwgZmllbGREZWY6IEZpZWxkRGVmPHN0cmluZz4sIG1hcms6IE1hcmssIHNjYWxlQ29uZmlnOiBTY2FsZUNvbmZpZ1xuKTogU2NhbGVUeXBlIHtcbiAgc3dpdGNoIChmaWVsZERlZi50eXBlKSB7XG4gICAgY2FzZSAnbm9taW5hbCc6XG4gICAgY2FzZSAnb3JkaW5hbCc6XG4gICAgICBpZiAoaXNDb2xvckNoYW5uZWwoY2hhbm5lbCl8fCByYW5nZVR5cGUoY2hhbm5lbCkgPT09ICdkaXNjcmV0ZScpIHtcbiAgICAgICAgaWYgKGNoYW5uZWwgPT09ICdzaGFwZScgJiYgZmllbGREZWYudHlwZSA9PT0gJ29yZGluYWwnKSB7XG4gICAgICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuZGlzY3JldGVDaGFubmVsQ2Fubm90RW5jb2RlKGNoYW5uZWwsICdvcmRpbmFsJykpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAnb3JkaW5hbCc7XG4gICAgICB9XG5cbiAgICAgIGlmICh1dGlsLmNvbnRhaW5zKFsneCcsICd5J10sIGNoYW5uZWwpKSB7XG4gICAgICAgIGlmICh1dGlsLmNvbnRhaW5zKFsncmVjdCcsICdiYXInLCAncnVsZSddLCBtYXJrKSkge1xuICAgICAgICAgIC8vIFRoZSByZWN0L2JhciBtYXJrIHNob3VsZCBmaXQgaW50byBhIGJhbmQuXG4gICAgICAgICAgLy8gRm9yIHJ1bGUsIHVzaW5nIGJhbmQgc2NhbGUgdG8gbWFrZSBydWxlIGFsaWduIHdpdGggYXhpcyB0aWNrcyBiZXR0ZXIgaHR0cHM6Ly9naXRodWIuY29tL3ZlZ2EvdmVnYS1saXRlL2lzc3Vlcy8zNDI5XG4gICAgICAgICAgcmV0dXJuICdiYW5kJztcbiAgICAgICAgfVxuICAgICAgICBpZiAobWFyayA9PT0gJ2JhcicpIHtcbiAgICAgICAgICByZXR1cm4gJ2JhbmQnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBPdGhlcndpc2UsIHVzZSBvcmRpbmFsIHBvaW50IHNjYWxlIHNvIHdlIGNhbiBlYXNpbHkgZ2V0IGNlbnRlciBwb3NpdGlvbnMgb2YgdGhlIG1hcmtzLlxuICAgICAgcmV0dXJuICdwb2ludCc7XG5cbiAgICBjYXNlICd0ZW1wb3JhbCc6XG4gICAgICBpZiAoaXNDb2xvckNoYW5uZWwoY2hhbm5lbCkpIHtcbiAgICAgICAgcmV0dXJuICdzZXF1ZW50aWFsJztcbiAgICAgIH0gZWxzZSBpZiAocmFuZ2VUeXBlKGNoYW5uZWwpID09PSAnZGlzY3JldGUnKSB7XG4gICAgICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLmRpc2NyZXRlQ2hhbm5lbENhbm5vdEVuY29kZShjaGFubmVsLCAndGVtcG9yYWwnKSk7XG4gICAgICAgIC8vIFRPRE86IGNvbnNpZGVyIHVzaW5nIHF1YW50aXplIChlcXVpdmFsZW50IHRvIGJpbm5pbmcpIG9uY2Ugd2UgaGF2ZSBpdFxuICAgICAgICByZXR1cm4gJ29yZGluYWwnO1xuICAgICAgfVxuICAgICAgcmV0dXJuICd0aW1lJztcblxuICAgIGNhc2UgJ3F1YW50aXRhdGl2ZSc6XG4gICAgICBpZiAoaXNDb2xvckNoYW5uZWwoY2hhbm5lbCkpIHtcbiAgICAgICAgaWYgKGZpZWxkRGVmLmJpbikge1xuICAgICAgICAgIHJldHVybiAnYmluLW9yZGluYWwnO1xuICAgICAgICB9XG4gICAgICAgIC8vIFVzZSBgc2VxdWVudGlhbGAgYXMgdGhlIGRlZmF1bHQgY29sb3Igc2NhbGUgZm9yIGNvbnRpbnVvdXMgZGF0YVxuICAgICAgICAvLyBzaW5jZSBpdCBzdXBwb3J0cyBib3RoIGFycmF5IHJhbmdlIGFuZCBzY2hlbWUgcmFuZ2UuXG4gICAgICAgIHJldHVybiAnc2VxdWVudGlhbCc7XG4gICAgICB9IGVsc2UgaWYgKHJhbmdlVHlwZShjaGFubmVsKSA9PT0gJ2Rpc2NyZXRlJykge1xuICAgICAgICBsb2cud2Fybihsb2cubWVzc2FnZS5kaXNjcmV0ZUNoYW5uZWxDYW5ub3RFbmNvZGUoY2hhbm5lbCwgJ3F1YW50aXRhdGl2ZScpKTtcbiAgICAgICAgLy8gVE9ETzogY29uc2lkZXIgdXNpbmcgcXVhbnRpemUgKGVxdWl2YWxlbnQgdG8gYmlubmluZykgb25jZSB3ZSBoYXZlIGl0XG4gICAgICAgIHJldHVybiAnb3JkaW5hbCc7XG4gICAgICB9XG5cbiAgICAgIC8vIHggYW5kIHkgdXNlIGEgbGluZWFyIHNjYWxlIGJlY2F1c2Ugc2VsZWN0aW9ucyBkb24ndCB3b3JrIHdpdGggYmluIHNjYWxlcy5cbiAgICAgIC8vIEJpbm5lZCBzY2FsZXMgYXBwbHkgZGlzY3JldGl6YXRpb24gYnV0IHBhbi96b29tIGFwcGx5IHRyYW5zZm9ybWF0aW9ucyB0byBhIFttaW4sIG1heF0gZXh0ZW50IGRvbWFpbi5cbiAgICAgIGlmIChmaWVsZERlZi5iaW4gJiYgY2hhbm5lbCAhPT0gJ3gnICYmIGNoYW5uZWwgIT09ICd5Jykge1xuICAgICAgICByZXR1cm4gJ2Jpbi1saW5lYXInO1xuICAgICAgfVxuICAgICAgcmV0dXJuICdsaW5lYXInO1xuXG4gICAgY2FzZSAnbGF0aXR1ZGUnOlxuICAgIGNhc2UgJ2xvbmdpdHVkZSc6XG4gICAgY2FzZSAnZ2VvanNvbic6XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IHNob3VsZCBuZXZlciByZWFjaCB0aGlzICovXG4gIHRocm93IG5ldyBFcnJvcihsb2cubWVzc2FnZS5pbnZhbGlkRmllbGRUeXBlKGZpZWxkRGVmLnR5cGUpKTtcbn1cbiJdfQ==","import { SCALE_CHANNELS, SHAPE, X, Y } from '../../channel';\nimport { getFieldDef, hasConditionalFieldDef, isFieldDef } from '../../fielddef';\nimport { GEOSHAPE } from '../../mark';\nimport { NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES, scaleCompatible, scaleTypePrecedence, } from '../../scale';\nimport { GEOJSON } from '../../type';\nimport { keys } from '../../util';\nimport { isUnitModel } from '../model';\nimport { defaultScaleResolve } from '../resolve';\nimport { mergeValuesWithExplicit, tieBreakByComparing } from '../split';\nimport { ScaleComponent } from './component';\nimport { parseScaleDomain } from './domain';\nimport { parseScaleProperty } from './properties';\nimport { parseScaleRange } from './range';\nimport { scaleType } from './type';\nexport function parseScale(model) {\n    parseScaleCore(model);\n    parseScaleDomain(model);\n    for (var _i = 0, NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES_1 = NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES; _i < NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES_1.length; _i++) {\n        var prop = NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES_1[_i];\n        parseScaleProperty(model, prop);\n    }\n    // range depends on zero\n    parseScaleRange(model);\n}\nexport function parseScaleCore(model) {\n    if (isUnitModel(model)) {\n        model.component.scales = parseUnitScaleCore(model);\n    }\n    else {\n        model.component.scales = parseNonUnitScaleCore(model);\n    }\n}\n/**\n * Parse scales for all channels of a model.\n */\nfunction parseUnitScaleCore(model) {\n    var encoding = model.encoding, config = model.config, mark = model.mark;\n    return SCALE_CHANNELS.reduce(function (scaleComponents, channel) {\n        var fieldDef;\n        var specifiedScale = undefined;\n        var channelDef = encoding[channel];\n        // Don't generate scale for shape of geoshape\n        if (isFieldDef(channelDef) && mark === GEOSHAPE &&\n            channel === SHAPE && channelDef.type === GEOJSON) {\n            return scaleComponents;\n        }\n        if (isFieldDef(channelDef)) {\n            fieldDef = channelDef;\n            specifiedScale = channelDef.scale;\n        }\n        else if (hasConditionalFieldDef(channelDef)) {\n            fieldDef = channelDef.condition;\n            specifiedScale = channelDef.condition['scale']; // We use ['scale'] since we know that channel here has scale for sure\n        }\n        else if (channel === X) {\n            fieldDef = getFieldDef(encoding.x2);\n        }\n        else if (channel === Y) {\n            fieldDef = getFieldDef(encoding.y2);\n        }\n        if (fieldDef && specifiedScale !== null && specifiedScale !== false) {\n            specifiedScale = specifiedScale || {};\n            var specifiedScaleType = specifiedScale.type;\n            var sType = scaleType(specifiedScale.type, channel, fieldDef, mark, config.scale);\n            scaleComponents[channel] = new ScaleComponent(model.scaleName(channel + '', true), { value: sType, explicit: specifiedScaleType === sType });\n        }\n        return scaleComponents;\n    }, {});\n}\nvar scaleTypeTieBreaker = tieBreakByComparing(function (st1, st2) { return (scaleTypePrecedence(st1) - scaleTypePrecedence(st2)); });\nfunction parseNonUnitScaleCore(model) {\n    var scaleComponents = model.component.scales = {};\n    var scaleTypeWithExplicitIndex = {};\n    var resolve = model.component.resolve;\n    var _loop_1 = function (child) {\n        parseScaleCore(child);\n        // Instead of always merging right away -- check if it is compatible to merge first!\n        keys(child.component.scales).forEach(function (channel) {\n            // if resolve is undefined, set default first\n            resolve.scale[channel] = resolve.scale[channel] || defaultScaleResolve(channel, model);\n            if (resolve.scale[channel] === 'shared') {\n                var explicitScaleType = scaleTypeWithExplicitIndex[channel];\n                var childScaleType = child.component.scales[channel].getWithExplicit('type');\n                if (explicitScaleType) {\n                    if (scaleCompatible(explicitScaleType.value, childScaleType.value)) {\n                        // merge scale component if type are compatible\n                        scaleTypeWithExplicitIndex[channel] = mergeValuesWithExplicit(explicitScaleType, childScaleType, 'type', 'scale', scaleTypeTieBreaker);\n                    }\n                    else {\n                        // Otherwise, update conflicting channel to be independent\n                        resolve.scale[channel] = 'independent';\n                        // Remove from the index so they don't get merged\n                        delete scaleTypeWithExplicitIndex[channel];\n                    }\n                }\n                else {\n                    scaleTypeWithExplicitIndex[channel] = childScaleType;\n                }\n            }\n        });\n    };\n    // Parse each child scale and determine if a particular channel can be merged.\n    for (var _i = 0, _a = model.children; _i < _a.length; _i++) {\n        var child = _a[_i];\n        _loop_1(child);\n    }\n    // Merge each channel listed in the index\n    keys(scaleTypeWithExplicitIndex).forEach(function (channel) {\n        // Create new merged scale component\n        var name = model.scaleName(channel, true);\n        var typeWithExplicit = scaleTypeWithExplicitIndex[channel];\n        scaleComponents[channel] = new ScaleComponent(name, typeWithExplicit);\n        // rename each child and mark them as merged\n        for (var _i = 0, _a = model.children; _i < _a.length; _i++) {\n            var child = _a[_i];\n            var childScale = child.component.scales[channel];\n            if (childScale) {\n                child.renameScale(childScale.get('name'), name);\n                childScale.merged = true;\n            }\n        }\n    });\n    return scaleComponents;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyc2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9zY2FsZS9wYXJzZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsY0FBYyxFQUFnQixLQUFLLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUN4RSxPQUFPLEVBQVcsV0FBVyxFQUFFLHNCQUFzQixFQUFFLFVBQVUsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ3pGLE9BQU8sRUFBQyxRQUFRLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDcEMsT0FBTyxFQUNMLDJDQUEyQyxFQUUzQyxlQUFlLEVBRWYsbUJBQW1CLEdBQ3BCLE1BQU0sYUFBYSxDQUFDO0FBQ3JCLE9BQU8sRUFBQyxPQUFPLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDbkMsT0FBTyxFQUFDLElBQUksRUFBQyxNQUFNLFlBQVksQ0FBQztBQUVoQyxPQUFPLEVBQUMsV0FBVyxFQUFRLE1BQU0sVUFBVSxDQUFDO0FBQzVDLE9BQU8sRUFBQyxtQkFBbUIsRUFBQyxNQUFNLFlBQVksQ0FBQztBQUMvQyxPQUFPLEVBQVcsdUJBQXVCLEVBQUUsbUJBQW1CLEVBQUMsTUFBTSxVQUFVLENBQUM7QUFFaEYsT0FBTyxFQUFDLGNBQWMsRUFBc0IsTUFBTSxhQUFhLENBQUM7QUFDaEUsT0FBTyxFQUFDLGdCQUFnQixFQUFDLE1BQU0sVUFBVSxDQUFDO0FBQzFDLE9BQU8sRUFBQyxrQkFBa0IsRUFBQyxNQUFNLGNBQWMsQ0FBQztBQUNoRCxPQUFPLEVBQUMsZUFBZSxFQUFDLE1BQU0sU0FBUyxDQUFDO0FBQ3hDLE9BQU8sRUFBQyxTQUFTLEVBQUMsTUFBTSxRQUFRLENBQUM7QUFFakMsTUFBTSxxQkFBcUIsS0FBWTtJQUNyQyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDdEIsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDeEIsS0FBbUIsVUFB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QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtTQ0FMRV9DSEFOTkVMUywgU2NhbGVDaGFubmVsLCBTSEFQRSwgWCwgWX0gZnJvbSAnLi4vLi4vY2hhbm5lbCc7XG5pbXBvcnQge0ZpZWxkRGVmLCBnZXRGaWVsZERlZiwgaGFzQ29uZGl0aW9uYWxGaWVsZERlZiwgaXNGaWVsZERlZn0gZnJvbSAnLi4vLi4vZmllbGRkZWYnO1xuaW1wb3J0IHtHRU9TSEFQRX0gZnJvbSAnLi4vLi4vbWFyayc7XG5pbXBvcnQge1xuICBOT05fVFlQRV9ET01BSU5fUkFOR0VfVkVHQV9TQ0FMRV9QUk9QRVJUSUVTLFxuICBTY2FsZSxcbiAgc2NhbGVDb21wYXRpYmxlLFxuICBTY2FsZVR5cGUsXG4gIHNjYWxlVHlwZVByZWNlZGVuY2UsXG59IGZyb20gJy4uLy4uL3NjYWxlJztcbmltcG9ydCB7R0VPSlNPTn0gZnJvbSAnLi4vLi4vdHlwZSc7XG5pbXBvcnQge2tleXN9IGZyb20gJy4uLy4uL3V0aWwnO1xuaW1wb3J0IHtWZ1NjYWxlfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge2lzVW5pdE1vZGVsLCBNb2RlbH0gZnJvbSAnLi4vbW9kZWwnO1xuaW1wb3J0IHtkZWZhdWx0U2NhbGVSZXNvbHZlfSBmcm9tICcuLi9yZXNvbHZlJztcbmltcG9ydCB7RXhwbGljaXQsIG1lcmdlVmFsdWVzV2l0aEV4cGxpY2l0LCB0aWVCcmVha0J5Q29tcGFyaW5nfSBmcm9tICcuLi9zcGxpdCc7XG5pbXBvcnQge1VuaXRNb2RlbH0gZnJvbSAnLi4vdW5pdCc7XG5pbXBvcnQge1NjYWxlQ29tcG9uZW50LCBTY2FsZUNvbXBvbmVudEluZGV4fSBmcm9tICcuL2NvbXBvbmVudCc7XG5pbXBvcnQge3BhcnNlU2NhbGVEb21haW59IGZyb20gJy4vZG9tYWluJztcbmltcG9ydCB7cGFyc2VTY2FsZVByb3BlcnR5fSBmcm9tICcuL3Byb3BlcnRpZXMnO1xuaW1wb3J0IHtwYXJzZVNjYWxlUmFuZ2V9IGZyb20gJy4vcmFuZ2UnO1xuaW1wb3J0IHtzY2FsZVR5cGV9IGZyb20gJy4vdHlwZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVNjYWxlKG1vZGVsOiBNb2RlbCkge1xuICBwYXJzZVNjYWxlQ29yZShtb2RlbCk7XG4gIHBhcnNlU2NhbGVEb21haW4obW9kZWwpO1xuICBmb3IgKGNvbnN0IHByb3Agb2YgTk9OX1RZUEVfRE9NQUlOX1JBTkdFX1ZFR0FfU0NBTEVfUFJPUEVSVElFUykge1xuICAgIHBhcnNlU2NhbGVQcm9wZXJ0eShtb2RlbCwgcHJvcCk7XG4gIH1cbiAgLy8gcmFuZ2UgZGVwZW5kcyBvbiB6ZXJvXG4gIHBhcnNlU2NhbGVSYW5nZShtb2RlbCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVNjYWxlQ29yZShtb2RlbDogTW9kZWwpIHtcbiAgaWYgKGlzVW5pdE1vZGVsKG1vZGVsKSkge1xuICAgIG1vZGVsLmNvbXBvbmVudC5zY2FsZXMgPSBwYXJzZVVuaXRTY2FsZUNvcmUobW9kZWwpO1xuICB9IGVsc2Uge1xuICAgIG1vZGVsLmNvbXBvbmVudC5zY2FsZXMgPSBwYXJzZU5vblVuaXRTY2FsZUNvcmUobW9kZWwpO1xuICB9XG59XG5cbi8qKlxuICogUGFyc2Ugc2NhbGVzIGZvciBhbGwgY2hhbm5lbHMgb2YgYSBtb2RlbC5cbiAqL1xuZnVuY3Rpb24gcGFyc2VVbml0U2NhbGVDb3JlKG1vZGVsOiBVbml0TW9kZWwpOiBTY2FsZUNvbXBvbmVudEluZGV4IHtcbiAgY29uc3Qge2VuY29kaW5nLCBjb25maWcsIG1hcmt9ID0gbW9kZWw7XG5cbiAgcmV0dXJuIFNDQUxFX0NIQU5ORUxTLnJlZHVjZSgoc2NhbGVDb21wb25lbnRzOiBTY2FsZUNvbXBvbmVudEluZGV4LCBjaGFubmVsOiBTY2FsZUNoYW5uZWwpID0+IHtcbiAgICBsZXQgZmllbGREZWY6IEZpZWxkRGVmPHN0cmluZz47XG4gICAgbGV0IHNwZWNpZmllZFNjYWxlOiBTY2FsZSB8IG51bGwgPSB1bmRlZmluZWQ7XG5cbiAgICBjb25zdCBjaGFubmVsRGVmID0gZW5jb2RpbmdbY2hhbm5lbF07XG5cbiAgICAvLyBEb24ndCBnZW5lcmF0ZSBzY2FsZSBmb3Igc2hhcGUgb2YgZ2Vvc2hhcGVcbiAgICBpZiAoXG4gICAgICBpc0ZpZWxkRGVmKGNoYW5uZWxEZWYpICYmIG1hcmsgPT09IEdFT1NIQVBFICYmXG4gICAgICBjaGFubmVsID09PSBTSEFQRSAmJiBjaGFubmVsRGVmLnR5cGUgPT09IEdFT0pTT05cbiAgICApIHtcbiAgICAgIHJldHVybiBzY2FsZUNvbXBvbmVudHM7XG4gICAgfVxuXG4gICAgaWYgKGlzRmllbGREZWYoY2hhbm5lbERlZikpIHtcbiAgICAgIGZpZWxkRGVmID0gY2hhbm5lbERlZjtcbiAgICAgIHNwZWNpZmllZFNjYWxlID0gY2hhbm5lbERlZi5zY2FsZTtcbiAgICB9IGVsc2UgaWYgKGhhc0NvbmRpdGlvbmFsRmllbGREZWYoY2hhbm5lbERlZikpIHtcbiAgICAgIGZpZWxkRGVmID0gY2hhbm5lbERlZi5jb25kaXRpb247XG4gICAgICBzcGVjaWZpZWRTY2FsZSA9IGNoYW5uZWxEZWYuY29uZGl0aW9uWydzY2FsZSddOyAvLyBXZSB1c2UgWydzY2FsZSddIHNpbmNlIHdlIGtub3cgdGhhdCBjaGFubmVsIGhlcmUgaGFzIHNjYWxlIGZvciBzdXJlXG4gICAgfSBlbHNlIGlmIChjaGFubmVsID09PSBYKSB7XG4gICAgICBmaWVsZERlZiA9IGdldEZpZWxkRGVmKGVuY29kaW5nLngyKTtcbiAgICB9IGVsc2UgaWYgKGNoYW5uZWwgPT09IFkpIHtcbiAgICAgIGZpZWxkRGVmID0gZ2V0RmllbGREZWYoZW5jb2RpbmcueTIpO1xuICAgIH1cblxuICAgIGlmIChmaWVsZERlZiAmJiBzcGVjaWZpZWRTY2FsZSAhPT0gbnVsbCAmJiBzcGVjaWZpZWRTY2FsZSAhPT0gZmFsc2UpIHtcbiAgICAgIHNwZWNpZmllZFNjYWxlID0gc3BlY2lmaWVkU2NhbGUgfHwge307XG4gICAgICBjb25zdCBzcGVjaWZpZWRTY2FsZVR5cGUgPSBzcGVjaWZpZWRTY2FsZS50eXBlO1xuICAgICAgY29uc3Qgc1R5cGUgPSBzY2FsZVR5cGUoc3BlY2lmaWVkU2NhbGUudHlwZSwgY2hhbm5lbCwgZmllbGREZWYsIG1hcmssIGNvbmZpZy5zY2FsZSk7XG4gICAgICBzY2FsZUNvbXBvbmVudHNbY2hhbm5lbF0gPSBuZXcgU2NhbGVDb21wb25lbnQoXG4gICAgICAgIG1vZGVsLnNjYWxlTmFtZShjaGFubmVsICsgJycsIHRydWUpLFxuICAgICAgICB7dmFsdWU6IHNUeXBlLCBleHBsaWNpdDogc3BlY2lmaWVkU2NhbGVUeXBlID09PSBzVHlwZX1cbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBzY2FsZUNvbXBvbmVudHM7XG4gIH0sIHt9KTtcbn1cblxuY29uc3Qgc2NhbGVUeXBlVGllQnJlYWtlciA9IHRpZUJyZWFrQnlDb21wYXJpbmcoXG4gIChzdDE6IFNjYWxlVHlwZSwgc3QyOiBTY2FsZVR5cGUpID0+IChzY2FsZVR5cGVQcmVjZWRlbmNlKHN0MSkgLSBzY2FsZVR5cGVQcmVjZWRlbmNlKHN0MikpXG4pO1xuXG5cbmZ1bmN0aW9uIHBhcnNlTm9uVW5pdFNjYWxlQ29yZShtb2RlbDogTW9kZWwpIHtcbiAgY29uc3Qgc2NhbGVDb21wb25lbnRzOiBTY2FsZUNvbXBvbmVudEluZGV4ID0gbW9kZWwuY29tcG9uZW50LnNjYWxlcyA9IHt9O1xuXG4gIGNvbnN0IHNjYWxlVHlwZVdpdGhFeHBsaWNpdEluZGV4OiB7XG4gICAgLy8gVXNpbmcgTWFwcGVkIFR5cGUgdG8gZGVjbGFyZSB0eXBlIChodHRwczovL3d3dy50eXBlc2NyaXB0bGFuZy5vcmcvZG9jcy9oYW5kYm9vay9hZHZhbmNlZC10eXBlcy5odG1sI21hcHBlZC10eXBlcylcbiAgICBbayBpbiBTY2FsZUNoYW5uZWxdPzogRXhwbGljaXQ8U2NhbGVUeXBlPlxuICB9ID0ge307XG4gIGNvbnN0IHJlc29sdmUgPSBtb2RlbC5jb21wb25lbnQucmVzb2x2ZTtcblxuICAvLyBQYXJzZSBlYWNoIGNoaWxkIHNjYWxlIGFuZCBkZXRlcm1pbmUgaWYgYSBwYXJ0aWN1bGFyIGNoYW5uZWwgY2FuIGJlIG1lcmdlZC5cbiAgZm9yIChjb25zdCBjaGlsZCBvZiBtb2RlbC5jaGlsZHJlbikge1xuICAgIHBhcnNlU2NhbGVDb3JlKGNoaWxkKTtcblxuICAgIC8vIEluc3RlYWQgb2YgYWx3YXlzIG1lcmdpbmcgcmlnaHQgYXdheSAtLSBjaGVjayBpZiBpdCBpcyBjb21wYXRpYmxlIHRvIG1lcmdlIGZpcnN0IVxuICAgIGtleXMoY2hpbGQuY29tcG9uZW50LnNjYWxlcykuZm9yRWFjaCgoY2hhbm5lbDogU2NhbGVDaGFubmVsKSA9PiB7XG4gICAgICAvLyBpZiByZXNvbHZlIGlzIHVuZGVmaW5lZCwgc2V0IGRlZmF1bHQgZmlyc3RcbiAgICAgIHJlc29sdmUuc2NhbGVbY2hhbm5lbF0gPSByZXNvbHZlLnNjYWxlW2NoYW5uZWxdIHx8IGRlZmF1bHRTY2FsZVJlc29sdmUoY2hhbm5lbCwgbW9kZWwpO1xuXG4gICAgICBpZiAocmVzb2x2ZS5zY2FsZVtjaGFubmVsXSA9PT0gJ3NoYXJlZCcpIHtcbiAgICAgICAgY29uc3QgZXhwbGljaXRTY2FsZVR5cGUgPSBzY2FsZVR5cGVXaXRoRXhwbGljaXRJbmRleFtjaGFubmVsXTtcbiAgICAgICAgY29uc3QgY2hpbGRTY2FsZVR5cGUgPSBjaGlsZC5jb21wb25lbnQuc2NhbGVzW2NoYW5uZWxdLmdldFdpdGhFeHBsaWNpdCgndHlwZScpO1xuXG4gICAgICAgIGlmIChleHBsaWNpdFNjYWxlVHlwZSkge1xuICAgICAgICAgIGlmIChzY2FsZUNvbXBhdGlibGUoZXhwbGljaXRTY2FsZVR5cGUudmFsdWUsIGNoaWxkU2NhbGVUeXBlLnZhbHVlKSkge1xuICAgICAgICAgICAgLy8gbWVyZ2Ugc2NhbGUgY29tcG9uZW50IGlmIHR5cGUgYXJlIGNvbXBhdGlibGVcbiAgICAgICAgICAgIHNjYWxlVHlwZVdpdGhFeHBsaWNpdEluZGV4W2NoYW5uZWxdID0gbWVyZ2VWYWx1ZXNXaXRoRXhwbGljaXQ8VmdTY2FsZSwgU2NhbGVUeXBlPihcbiAgICAgICAgICAgICAgZXhwbGljaXRTY2FsZVR5cGUsIGNoaWxkU2NhbGVUeXBlLCAndHlwZScsICdzY2FsZScsIHNjYWxlVHlwZVRpZUJyZWFrZXJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIE90aGVyd2lzZSwgdXBkYXRlIGNvbmZsaWN0aW5nIGNoYW5uZWwgdG8gYmUgaW5kZXBlbmRlbnRcbiAgICAgICAgICAgIHJlc29sdmUuc2NhbGVbY2hhbm5lbF0gPSAnaW5kZXBlbmRlbnQnO1xuICAgICAgICAgICAgLy8gUmVtb3ZlIGZyb20gdGhlIGluZGV4IHNvIHRoZXkgZG9uJ3QgZ2V0IG1lcmdlZFxuICAgICAgICAgICAgZGVsZXRlIHNjYWxlVHlwZVdpdGhFeHBsaWNpdEluZGV4W2NoYW5uZWxdO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzY2FsZVR5cGVXaXRoRXhwbGljaXRJbmRleFtjaGFubmVsXSA9IGNoaWxkU2NhbGVUeXBlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvLyBNZXJnZSBlYWNoIGNoYW5uZWwgbGlzdGVkIGluIHRoZSBpbmRleFxuICBrZXlzKHNjYWxlVHlwZVdpdGhFeHBsaWNpdEluZGV4KS5mb3JFYWNoKChjaGFubmVsOiBTY2FsZUNoYW5uZWwpID0+IHtcbiAgICAvLyBDcmVhdGUgbmV3IG1lcmdlZCBzY2FsZSBjb21wb25lbnRcbiAgICBjb25zdCBuYW1lID0gbW9kZWwuc2NhbGVOYW1lKGNoYW5uZWwsIHRydWUpO1xuICAgIGNvbnN0IHR5cGVXaXRoRXhwbGljaXQgPSBzY2FsZVR5cGVXaXRoRXhwbGljaXRJbmRleFtjaGFubmVsXTtcbiAgICBzY2FsZUNvbXBvbmVudHNbY2hhbm5lbF0gPSBuZXcgU2NhbGVDb21wb25lbnQobmFtZSwgdHlwZVdpdGhFeHBsaWNpdCk7XG5cbiAgICAvLyByZW5hbWUgZWFjaCBjaGlsZCBhbmQgbWFyayB0aGVtIGFzIG1lcmdlZFxuICAgIGZvciAoY29uc3QgY2hpbGQgb2YgbW9kZWwuY2hpbGRyZW4pIHtcbiAgICAgIGNvbnN0IGNoaWxkU2NhbGUgPSBjaGlsZC5jb21wb25lbnQuc2NhbGVzW2NoYW5uZWxdO1xuICAgICAgaWYgKGNoaWxkU2NhbGUpIHtcbiAgICAgICAgY2hpbGQucmVuYW1lU2NhbGUoY2hpbGRTY2FsZS5nZXQoJ25hbWUnKSwgbmFtZSk7XG4gICAgICAgIGNoaWxkU2NhbGUubWVyZ2VkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBzY2FsZUNvbXBvbmVudHM7XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { isString } from 'vega-util';\nimport { isChannel, isScaleChannel } from '../channel';\nimport { forEach, reduce } from '../encoding';\nimport { getFieldDef, vgField } from '../fielddef';\nimport * as log from '../log';\nimport { hasDiscreteDomain } from '../scale';\nimport { isFacetSpec } from '../spec';\nimport { extractTitleConfig } from '../title';\nimport { normalizeTransform } from '../transform';\nimport { contains, keys, varName } from '../util';\nimport { isVgRangeStep } from '../vega.schema';\nimport { assembleAxes } from './axis/assemble';\nimport { getHeaderGroups, getTitleGroup, HEADER_CHANNELS } from './layout/header';\nimport { sizeExpr } from './layoutsize/assemble';\nimport { assembleLegends } from './legend/assemble';\nimport { parseLegend } from './legend/parse';\nimport { assembleProjections } from './projection/assemble';\nimport { parseProjection } from './projection/parse';\nimport { assembleScales } from './scale/assemble';\nimport { assembleDomain, getFieldFromDomain } from './scale/domain';\nimport { parseScale } from './scale/parse';\nimport { Split } from './split';\nvar NameMap = /** @class */ (function () {\n    function NameMap() {\n        this.nameMap = {};\n    }\n    NameMap.prototype.rename = function (oldName, newName) {\n        this.nameMap[oldName] = newName;\n    };\n    NameMap.prototype.has = function (name) {\n        return this.nameMap[name] !== undefined;\n    };\n    NameMap.prototype.get = function (name) {\n        // If the name appears in the _nameMap, we need to read its new name.\n        // We have to loop over the dict just in case the new name also gets renamed.\n        while (this.nameMap[name] && name !== this.nameMap[name]) {\n            name = this.nameMap[name];\n        }\n        return name;\n    };\n    return NameMap;\n}());\nexport { NameMap };\n/*\n  We use type guards instead of `instanceof` as `instanceof` makes\n  different parts of the compiler depend on the actual implementation of\n  the model classes, which in turn depend on different parts of the compiler.\n  Thus, `instanceof` leads to circular dependency problems.\n\n  On the other hand, type guards only make different parts of the compiler\n  depend on the type of the model classes, but not the actual implementation.\n*/\nexport function isUnitModel(model) {\n    return model && model.type === 'unit';\n}\nexport function isFacetModel(model) {\n    return model && model.type === 'facet';\n}\nexport function isRepeatModel(model) {\n    return model && model.type === 'repeat';\n}\nexport function isConcatModel(model) {\n    return model && model.type === 'concat';\n}\nexport function isLayerModel(model) {\n    return model && model.type === 'layer';\n}\nvar Model = /** @class */ (function () {\n    function Model(spec, parent, parentGivenName, config, repeater, resolve) {\n        var _this = this;\n        this.children = [];\n        /**\n         * Corrects the data references in marks after assemble.\n         */\n        this.correctDataNames = function (mark) {\n            // TODO: make this correct\n            // for normal data references\n            if (mark.from && mark.from.data) {\n                mark.from.data = _this.lookupDataSource(mark.from.data);\n            }\n            // for access to facet data\n            if (mark.from && mark.from.facet && mark.from.facet.data) {\n                mark.from.facet.data = _this.lookupDataSource(mark.from.facet.data);\n            }\n            return mark;\n        };\n        this.parent = parent;\n        this.config = config;\n        this.repeater = repeater;\n        // If name is not provided, always use parent's givenName to avoid name conflicts.\n        this.name = spec.name || parentGivenName;\n        this.title = isString(spec.title) ? { text: spec.title } : spec.title;\n        // Shared name maps\n        this.scaleNameMap = parent ? parent.scaleNameMap : new NameMap();\n        this.projectionNameMap = parent ? parent.projectionNameMap : new NameMap();\n        this.layoutSizeNameMap = parent ? parent.layoutSizeNameMap : new NameMap();\n        this.data = spec.data;\n        this.description = spec.description;\n        this.transforms = normalizeTransform(spec.transform || []);\n        this.component = {\n            data: {\n                sources: parent ? parent.component.data.sources : {},\n                outputNodes: parent ? parent.component.data.outputNodes : {},\n                outputNodeRefCounts: parent ? parent.component.data.outputNodeRefCounts : {},\n                // data is faceted if the spec is a facet spec or the parent has faceted data and no data is defined\n                isFaceted: isFacetSpec(spec) || (parent && parent.component.data.isFaceted && !spec.data)\n            },\n            layoutSize: new Split(),\n            layoutHeaders: { row: {}, column: {} },\n            mark: null,\n            resolve: tslib_1.__assign({ scale: {}, axis: {}, legend: {} }, (resolve || {})),\n            selection: null,\n            scales: null,\n            projection: null,\n            axes: {},\n            legends: {},\n        };\n    }\n    Object.defineProperty(Model.prototype, \"width\", {\n        get: function () {\n            return this.getSizeSignalRef('width');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Model.prototype, \"height\", {\n        get: function () {\n            return this.getSizeSignalRef('height');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Model.prototype.initSize = function (size) {\n        var width = size.width, height = size.height;\n        if (width) {\n            this.component.layoutSize.set('width', width, true);\n        }\n        if (height) {\n            this.component.layoutSize.set('height', height, true);\n        }\n    };\n    Model.prototype.parse = function () {\n        this.parseScale();\n        this.parseLayoutSize(); // depends on scale\n        this.renameTopLevelLayoutSize();\n        this.parseSelection();\n        this.parseProjection();\n        this.parseData(); // (pathorder) depends on markDef; selection filters depend on parsed selections; depends on projection because some transforms require the finalized projection name.\n        this.parseAxisAndHeader(); // depends on scale and layout size\n        this.parseLegend(); // depends on scale, markDef\n        this.parseMarkGroup(); // depends on data name, scale, layout size, axisGroup, and children's scale, axis, legend and mark.\n    };\n    Model.prototype.parseScale = function () {\n        parseScale(this);\n    };\n    Model.prototype.parseProjection = function () {\n        parseProjection(this);\n    };\n    /**\n     * Rename top-level spec's size to be just width / height, ignoring model name.\n     * This essentially merges the top-level spec's width/height signals with the width/height signals\n     * to help us reduce redundant signals declaration.\n     */\n    Model.prototype.renameTopLevelLayoutSize = function () {\n        if (this.getName('width') !== 'width') {\n            this.renameLayoutSize(this.getName('width'), 'width');\n        }\n        if (this.getName('height') !== 'height') {\n            this.renameLayoutSize(this.getName('height'), 'height');\n        }\n    };\n    Model.prototype.parseLegend = function () {\n        parseLegend(this);\n    };\n    Model.prototype.assembleGroupStyle = function () {\n        if (this.type === 'unit' || this.type === 'layer') {\n            return 'cell';\n        }\n        return undefined;\n    };\n    Model.prototype.assembleLayoutSize = function () {\n        if (this.type === 'unit' || this.type === 'layer') {\n            return {\n                width: this.getSizeSignalRef('width'),\n                height: this.getSizeSignalRef('height')\n            };\n        }\n        return undefined;\n    };\n    Model.prototype.assembleHeaderMarks = function () {\n        var layoutHeaders = this.component.layoutHeaders;\n        var headerMarks = [];\n        for (var _i = 0, HEADER_CHANNELS_1 = HEADER_CHANNELS; _i < HEADER_CHANNELS_1.length; _i++) {\n            var channel = HEADER_CHANNELS_1[_i];\n            if (layoutHeaders[channel].title) {\n                headerMarks.push(getTitleGroup(this, channel));\n            }\n        }\n        for (var _a = 0, HEADER_CHANNELS_2 = HEADER_CHANNELS; _a < HEADER_CHANNELS_2.length; _a++) {\n            var channel = HEADER_CHANNELS_2[_a];\n            headerMarks = headerMarks.concat(getHeaderGroups(this, channel));\n        }\n        return headerMarks;\n    };\n    Model.prototype.assembleAxes = function () {\n        return assembleAxes(this.component.axes, this.config);\n    };\n    Model.prototype.assembleLegends = function () {\n        return assembleLegends(this);\n    };\n    Model.prototype.assembleProjections = function () {\n        return assembleProjections(this);\n    };\n    Model.prototype.assembleTitle = function () {\n        var title = tslib_1.__assign({}, extractTitleConfig(this.config.title).nonMark, this.title);\n        if (title.text) {\n            if (!contains(['unit', 'layer'], this.type)) {\n                // As described in https://github.com/vega/vega-lite/issues/2875:\n                // Due to vega/vega#960 (comment), we only support title's anchor for unit and layered spec for now.\n                if (title.anchor && title.anchor !== 'start') {\n                    log.warn(log.message.cannotSetTitleAnchor(this.type));\n                }\n                title.anchor = 'start';\n            }\n            return keys(title).length > 0 ? title : undefined;\n        }\n        return undefined;\n    };\n    /**\n     * Assemble the mark group for this model.  We accept optional `signals` so that we can include concat top-level signals with the top-level model's local signals.\n     */\n    Model.prototype.assembleGroup = function (signals) {\n        if (signals === void 0) { signals = []; }\n        var group = {};\n        signals = signals.concat(this.assembleSelectionSignals());\n        if (signals.length > 0) {\n            group.signals = signals;\n        }\n        var layout = this.assembleLayout();\n        if (layout) {\n            group.layout = layout;\n        }\n        group.marks = [].concat(this.assembleHeaderMarks(), this.assembleMarks());\n        // Only include scales if this spec is top-level or if parent is facet.\n        // (Otherwise, it will be merged with upper-level's scope.)\n        var scales = (!this.parent || isFacetModel(this.parent)) ? assembleScales(this) : [];\n        if (scales.length > 0) {\n            group.scales = scales;\n        }\n        var axes = this.assembleAxes();\n        if (axes.length > 0) {\n            group.axes = axes;\n        }\n        var legends = this.assembleLegends();\n        if (legends.length > 0) {\n            group.legends = legends;\n        }\n        return group;\n    };\n    Model.prototype.hasDescendantWithFieldOnChannel = function (channel) {\n        for (var _i = 0, _a = this.children; _i < _a.length; _i++) {\n            var child = _a[_i];\n            if (isUnitModel(child)) {\n                if (child.channelHasField(channel)) {\n                    return true;\n                }\n            }\n            else {\n                if (child.hasDescendantWithFieldOnChannel(channel)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    Model.prototype.getName = function (text) {\n        return varName((this.name ? this.name + '_' : '') + text);\n    };\n    /**\n     * Request a data source name for the given data source type and mark that data source as required. This method should be called in parse, so that all used data source can be correctly instantiated in assembleData().\n     */\n    Model.prototype.requestDataName = function (name) {\n        var fullName = this.getName(name);\n        // Increase ref count. This is critical because otherwise we won't create a data source.\n        // We also increase the ref counts on OutputNode.getSource() calls.\n        var refCounts = this.component.data.outputNodeRefCounts;\n        refCounts[fullName] = (refCounts[fullName] || 0) + 1;\n        return fullName;\n    };\n    Model.prototype.getSizeSignalRef = function (sizeType) {\n        if (isFacetModel(this.parent)) {\n            var channel = sizeType === 'width' ? 'x' : 'y';\n            var scaleComponent = this.component.scales[channel];\n            if (scaleComponent && !scaleComponent.merged) { // independent scale\n                var type = scaleComponent.get('type');\n                var range = scaleComponent.get('range');\n                if (hasDiscreteDomain(type) && isVgRangeStep(range)) {\n                    var scaleName = scaleComponent.get('name');\n                    var domain = assembleDomain(this, channel);\n                    var field = getFieldFromDomain(domain);\n                    if (field) {\n                        var fieldRef = vgField({ aggregate: 'distinct', field: field }, { expr: 'datum' });\n                        return {\n                            signal: sizeExpr(scaleName, scaleComponent, fieldRef)\n                        };\n                    }\n                    else {\n                        log.warn('Unknown field for ${channel}.  Cannot calculate view size.');\n                        return null;\n                    }\n                }\n            }\n        }\n        return {\n            signal: this.layoutSizeNameMap.get(this.getName(sizeType))\n        };\n    };\n    /**\n     * Lookup the name of the datasource for an output node. You probably want to call this in assemble.\n     */\n    Model.prototype.lookupDataSource = function (name) {\n        var node = this.component.data.outputNodes[name];\n        if (!node) {\n            // Name not found in map so let's just return what we got.\n            // This can happen if we already have the correct name.\n            return name;\n        }\n        return node.getSource();\n    };\n    Model.prototype.getSizeName = function (oldSizeName) {\n        return this.layoutSizeNameMap.get(oldSizeName);\n    };\n    Model.prototype.renameLayoutSize = function (oldName, newName) {\n        this.layoutSizeNameMap.rename(oldName, newName);\n    };\n    Model.prototype.renameScale = function (oldName, newName) {\n        this.scaleNameMap.rename(oldName, newName);\n    };\n    Model.prototype.renameProjection = function (oldName, newName) {\n        this.projectionNameMap.rename(oldName, newName);\n    };\n    /**\n     * @return scale name for a given channel after the scale has been parsed and named.\n     */\n    Model.prototype.scaleName = function (originalScaleName, parse) {\n        if (parse) {\n            // During the parse phase always return a value\n            // No need to refer to rename map because a scale can't be renamed\n            // before it has the original name.\n            return this.getName(originalScaleName);\n        }\n        // If there is a scale for the channel, it should either\n        // be in the scale component or exist in the name map\n        if (\n        // If there is a scale for the channel, there should be a local scale component for it\n        (isChannel(originalScaleName) && isScaleChannel(originalScaleName) && this.component.scales[originalScaleName]) ||\n            // in the scale name map (the scale get merged by its parent)\n            this.scaleNameMap.has(this.getName(originalScaleName))) {\n            return this.scaleNameMap.get(this.getName(originalScaleName));\n        }\n        return undefined;\n    };\n    /**\n     * @return projection name after the projection has been parsed and named.\n     */\n    Model.prototype.projectionName = function (parse) {\n        if (parse) {\n            // During the parse phase always return a value\n            // No need to refer to rename map because a projection can't be renamed\n            // before it has the original name.\n            return this.getName('projection');\n        }\n        if ((this.component.projection && !this.component.projection.merged) || this.projectionNameMap.has(this.getName('projection'))) {\n            return this.projectionNameMap.get(this.getName('projection'));\n        }\n        return undefined;\n    };\n    /**\n     * Traverse a model's hierarchy to get the scale component for a particular channel.\n     */\n    Model.prototype.getScaleComponent = function (channel) {\n        /* istanbul ignore next: This is warning for debugging test */\n        if (!this.component.scales) {\n            throw new Error('getScaleComponent cannot be called before parseScale().  Make sure you have called parseScale or use parseUnitModelWithScale().');\n        }\n        var localScaleComponent = this.component.scales[channel];\n        if (localScaleComponent && !localScaleComponent.merged) {\n            return localScaleComponent;\n        }\n        return (this.parent ? this.parent.getScaleComponent(channel) : undefined);\n    };\n    /**\n     * Traverse a model's hierarchy to get a particular selection component.\n     */\n    Model.prototype.getSelectionComponent = function (variableName, origName) {\n        var sel = this.component.selection[variableName];\n        if (!sel && this.parent) {\n            sel = this.parent.getSelectionComponent(variableName, origName);\n        }\n        if (!sel) {\n            throw new Error(log.message.selectionNotFound(origName));\n        }\n        return sel;\n    };\n    return Model;\n}());\nexport { Model };\n/** Abstract class for UnitModel and FacetModel.  Both of which can contain fieldDefs as a part of its own specification. */\nvar ModelWithField = /** @class */ (function (_super) {\n    tslib_1.__extends(ModelWithField, _super);\n    function ModelWithField() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /** Get \"field\" reference for vega */\n    ModelWithField.prototype.vgField = function (channel, opt) {\n        if (opt === void 0) { opt = {}; }\n        var fieldDef = this.fieldDef(channel);\n        if (!fieldDef) {\n            return undefined;\n        }\n        return vgField(fieldDef, opt);\n    };\n    ModelWithField.prototype.reduceFieldDef = function (f, init, t) {\n        return reduce(this.getMapping(), function (acc, cd, c) {\n            var fieldDef = getFieldDef(cd);\n            if (fieldDef) {\n                return f(acc, fieldDef, c);\n            }\n            return acc;\n        }, init, t);\n    };\n    ModelWithField.prototype.forEachFieldDef = function (f, t) {\n        forEach(this.getMapping(), function (cd, c) {\n            var fieldDef = getFieldDef(cd);\n            if (fieldDef) {\n                f(fieldDef, c);\n            }\n        }, t);\n    };\n    return ModelWithField;\n}(Model));\nexport { ModelWithField };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kZWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29tcGlsZS9tb2RlbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFDLFFBQVEsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUNuQyxPQUFPLEVBQVUsU0FBUyxFQUFFLGNBQWMsRUFBaUMsTUFBTSxZQUFZLENBQUM7QUFHOUYsT0FBTyxFQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUMsTUFBTSxhQUFhLENBQUM7QUFDNUMsT0FBTyxFQUF1QyxXQUFXLEVBQUUsT0FBTyxFQUFDLE1BQU0sYUFBYSxDQUFDO0FBQ3ZGLE9BQU8sS0FBSyxHQUFHLE1BQU0sUUFBUSxDQUFDO0FBRTlCLE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLFVBQVUsQ0FBQztBQUMzQyxPQUFPLEVBQVcsV0FBVyxFQUFDLE1BQU0sU0FBUyxDQUFDO0FBQzlDLE9BQU8sRUFBQyxrQkFBa0IsRUFBYyxNQUFNLFVBQVUsQ0FBQztBQUN6RCxPQUFPLEVBQUMsa0JBQWtCLEVBQVksTUFBTSxjQUFjLENBQUM7QUFDM0QsT0FBTyxFQUFDLFFBQVEsRUFBUSxJQUFJLEVBQUUsT0FBTyxFQUFDLE1BQU0sU0FBUyxDQUFDO0FBQ3RELE9BQU8sRUFBQyxhQUFhLEVBQStHLE1BQU0sZ0JBQWdCLENBQUM7QUFDM0osT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLGlCQUFpQixDQUFDO0FBTTdDLE9BQU8sRUFBQyxlQUFlLEVBQUUsYUFBYSxFQUFFLGVBQWUsRUFBd0IsTUFBTSxpQkFBaUIsQ0FBQztBQUN2RyxPQUFPLEVBQUMsUUFBUSxFQUFDLE1BQU0sdUJBQXVCLENBQUM7QUFFL0MsT0FBTyxFQUFDLGVBQWUsRUFBQyxNQUFNLG1CQUFtQixDQUFDO0FBRWxELE9BQU8sRUFBQyxXQUFXLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUMzQyxPQUFPLEVBQUMsbUJBQW1CLEVBQUMsTUFBTSx1QkFBdUIsQ0FB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Q0FBQyxBQW5DRCxDQUE2QyxLQUFLLEdBbUNqRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7aXNTdHJpbmd9IGZyb20gJ3ZlZ2EtdXRpbCc7XG5pbXBvcnQge0NoYW5uZWwsIGlzQ2hhbm5lbCwgaXNTY2FsZUNoYW5uZWwsIFNjYWxlQ2hhbm5lbCwgU2luZ2xlRGVmQ2hhbm5lbH0gZnJvbSAnLi4vY2hhbm5lbCc7XG5pbXBvcnQge0NvbmZpZ30gZnJvbSAnLi4vY29uZmlnJztcbmltcG9ydCB7RGF0YSwgRGF0YVNvdXJjZVR5cGV9IGZyb20gJy4uL2RhdGEnO1xuaW1wb3J0IHtmb3JFYWNoLCByZWR1Y2V9IGZyb20gJy4uL2VuY29kaW5nJztcbmltcG9ydCB7Q2hhbm5lbERlZiwgRmllbGREZWYsIEZpZWxkUmVmT3B0aW9uLCBnZXRGaWVsZERlZiwgdmdGaWVsZH0gZnJvbSAnLi4vZmllbGRkZWYnO1xuaW1wb3J0ICogYXMgbG9nIGZyb20gJy4uL2xvZyc7XG5pbXBvcnQge1Jlc29sdmV9IGZyb20gJy4uL3Jlc29sdmUnO1xuaW1wb3J0IHtoYXNEaXNjcmV0ZURvbWFpbn0gZnJvbSAnLi4vc2NhbGUnO1xuaW1wb3J0IHtCYXNlU3BlYywgaXNGYWNldFNwZWN9IGZyb20gJy4uL3NwZWMnO1xuaW1wb3J0IHtleHRyYWN0VGl0bGVDb25maWcsIFRpdGxlUGFyYW1zfSBmcm9tICcuLi90aXRsZSc7XG5pbXBvcnQge25vcm1hbGl6ZVRyYW5zZm9ybSwgVHJhbnNmb3JtfSBmcm9tICcuLi90cmFuc2Zvcm0nO1xuaW1wb3J0IHtjb250YWlucywgRGljdCwga2V5cywgdmFyTmFtZX0gZnJvbSAnLi4vdXRpbCc7XG5pbXBvcnQge2lzVmdSYW5nZVN0ZXAsIFZnQXhpcywgVmdEYXRhLCBWZ0VuY29kZUVudHJ5LCBWZ0xheW91dCwgVmdMZWdlbmQsIFZnTWFya0dyb3VwLCBWZ1Byb2plY3Rpb24sIFZnU2lnbmFsLCBWZ1NpZ25hbFJlZiwgVmdUaXRsZX0gZnJvbSAnLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHthc3NlbWJsZUF4ZXN9IGZyb20gJy4vYXhpcy9hc3NlbWJsZSc7XG5pbXBvcnQge0F4aXNDb21wb25lbnRJbmRleH0gZnJvbSAnLi9heGlzL2NvbXBvbmVudCc7XG5pbXBvcnQge0NvbmNhdE1vZGVsfSBmcm9tICcuL2NvbmNhdCc7XG5pbXBvcnQge0RhdGFDb21wb25lbnR9IGZyb20gJy4vZGF0YSc7XG5pbXBvcnQge0ZhY2V0TW9kZWx9IGZyb20gJy4vZmFjZXQnO1xuaW1wb3J0IHtMYXllck1vZGVsfSBmcm9tICcuL2xheWVyJztcbmltcG9ydCB7Z2V0SGVhZGVyR3JvdXBzLCBnZXRUaXRsZUdyb3VwLCBIRUFERVJfQ0hBTk5FTFMsIExheW91dEhlYWRlckNvbXBvbmVudH0gZnJvbSAnLi9sYXlvdXQvaGVhZGVyJztcbmltcG9ydCB7c2l6ZUV4cHJ9IGZyb20gJy4vbGF5b3V0c2l6ZS9hc3NlbWJsZSc7XG5pbXBvcnQge0xheW91dFNpemVDb21wb25lbnQsIExheW91dFNpemVJbmRleH0gZnJvbSAnLi9sYXlvdXRzaXplL2NvbXBvbmVudCc7XG5pbXBvcnQge2Fzc2VtYmxlTGVnZW5kc30gZnJvbSAnLi9sZWdlbmQvYXNzZW1ibGUnO1xuaW1wb3J0IHtMZWdlbmRDb21wb25lbnRJbmRleH0gZnJvbSAnLi9sZWdlbmQvY29tcG9uZW50JztcbmltcG9ydCB7cGFyc2VMZWdlbmR9IGZyb20gJy4vbGVnZW5kL3BhcnNlJztcbmltcG9ydCB7YXNzZW1ibGVQcm9qZWN0aW9uc30gZnJvbSAnLi9wcm9qZWN0aW9uL2Fzc2VtYmxlJztcbmltcG9ydCB7UHJvamVjdGlvbkNvbXBvbmVudH0gZnJvbSAnLi9wcm9qZWN0aW9uL2NvbXBvbmVudCc7XG5pbXBvcnQge3BhcnNlUHJvamVjdGlvbn0gZnJvbSAnLi9wcm9qZWN0aW9uL3BhcnNlJztcbmltcG9ydCB7UmVwZWF0TW9kZWx9IGZyb20gJy4vcmVwZWF0JztcbmltcG9ydCB7UmVwZWF0ZXJWYWx1ZX0gZnJvbSAnLi9yZXBlYXRlcic7XG5pbXBvcnQge2Fzc2VtYmxlU2NhbGVzfSBmcm9tICcuL3NjYWxlL2Fzc2VtYmxlJztcbmltcG9ydCB7U2NhbGVDb21wb25lbnQsIFNjYWxlQ29tcG9uZW50SW5kZXh9IGZyb20gJy4vc2NhbGUvY29tcG9uZW50JztcbmltcG9ydCB7YXNzZW1ibGVEb21haW4sIGdldEZpZWxkRnJvbURvbWFpbn0gZnJvbSAnLi9zY2FsZS9kb21haW4nO1xuaW1wb3J0IHtwYXJzZVNjYWxlfSBmcm9tICcuL3NjYWxlL3BhcnNlJztcbmltcG9ydCB7U2VsZWN0aW9uQ29tcG9uZW50fSBmcm9tICcuL3NlbGVjdGlvbi9zZWxlY3Rpb24nO1xuaW1wb3J0IHtTcGxpdH0gZnJvbSAnLi9zcGxpdCc7XG5pbXBvcnQge1VuaXRNb2RlbH0gZnJvbSAnLi91bml0JztcblxuLyoqXG4gKiBDb21wb3NhYmxlIENvbXBvbmVudHMgdGhhdCBhcmUgaW50ZXJtZWRpYXRlIHJlc3VsdHMgb2YgdGhlIHBhcnNpbmcgcGhhc2Ugb2YgdGhlXG4gKiBjb21waWxhdGlvbnMuICBUaGUgY29tcG9uZW50cyByZXByZXNlbnRzIHBhcnRzIG9mIHRoZSBzcGVjaWZpY2F0aW9uIGluIGEgZm9ybSB0aGF0XG4gKiBjYW4gYmUgZWFzaWx5IG1lcmdlZCAoZHVyaW5nIHBhcnNpbmcgZm9yIGNvbXBvc2l0ZSBzcGVjcykuXG4gKiBJbiBhZGRpdGlvbiwgdGhlc2UgY29tcG9uZW50cyBhcmUgZWFzaWx5IHRyYW5zZm9ybWVkIGludG8gVmVnYSBzcGVjaWZpY2F0aW9uc1xuICogZHVyaW5nIHRoZSBcImFzc2VtYmxlXCIgcGhhc2UsIHdoaWNoIGlzIHRoZSBsYXN0IHBoYXNlIG9mIHRoZSBjb21waWxhdGlvbiBzdGVwLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIENvbXBvbmVudCB7XG4gIGRhdGE6IERhdGFDb21wb25lbnQ7XG5cbiAgbGF5b3V0U2l6ZTogTGF5b3V0U2l6ZUNvbXBvbmVudDtcblxuICBsYXlvdXRIZWFkZXJzOiB7XG4gICAgcm93PzogTGF5b3V0SGVhZGVyQ29tcG9uZW50LFxuICAgIGNvbHVtbj86IExheW91dEhlYWRlckNvbXBvbmVudFxuICB9O1xuXG4gIG1hcms6IFZnTWFya0dyb3VwW107XG4gIHNjYWxlczogU2NhbGVDb21wb25lbnRJbmRleDtcbiAgcHJvamVjdGlvbjogUHJvamVjdGlvbkNvbXBvbmVudDtcbiAgc2VsZWN0aW9uOiBEaWN0PFNlbGVjdGlvbkNvbXBvbmVudD47XG5cbiAgLyoqIERpY3Rpb25hcnkgbWFwcGluZyBjaGFubmVsIHRvIFZnQXhpcyBkZWZpbml0aW9uICovXG4gIGF4ZXM6IEF4aXNDb21wb25lbnRJbmRleDtcblxuICAvKiogRGljdGlvbmFyeSBtYXBwaW5nIGNoYW5uZWwgdG8gVmdMZWdlbmQgZGVmaW5pdGlvbiAqL1xuICBsZWdlbmRzOiBMZWdlbmRDb21wb25lbnRJbmRleDtcblxuICByZXNvbHZlOiBSZXNvbHZlO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE5hbWVNYXBJbnRlcmZhY2Uge1xuICByZW5hbWUob2xkbmFtZTogc3RyaW5nLCBuZXdOYW1lOiBzdHJpbmcpOiB2b2lkO1xuICBoYXMobmFtZTogc3RyaW5nKTogYm9vbGVhbjtcbiAgZ2V0KG5hbWU6IHN0cmluZyk6IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIE5hbWVNYXAgaW1wbGVtZW50cyBOYW1lTWFwSW50ZXJmYWNlIHtcbiAgcHJpdmF0ZSBuYW1lTWFwOiBEaWN0PHN0cmluZz47XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5uYW1lTWFwID0ge307XG4gIH1cblxuICBwdWJsaWMgcmVuYW1lKG9sZE5hbWU6IHN0cmluZywgbmV3TmFtZTogc3RyaW5nKSB7XG4gICAgdGhpcy5uYW1lTWFwW29sZE5hbWVdID0gbmV3TmFtZTtcbiAgfVxuXG5cbiAgcHVibGljIGhhcyhuYW1lOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5uYW1lTWFwW25hbWVdICE9PSB1bmRlZmluZWQ7XG4gIH1cblxuICBwdWJsaWMgZ2V0KG5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8gSWYgdGhlIG5hbWUgYXBwZWFycyBpbiB0aGUgX25hbWVNYXAsIHdlIG5lZWQgdG8gcmVhZCBpdHMgbmV3IG5hbWUuXG4gICAgLy8gV2UgaGF2ZSB0byBsb29wIG92ZXIgdGhlIGRpY3QganVzdCBpbiBjYXNlIHRoZSBuZXcgbmFtZSBhbHNvIGdldHMgcmVuYW1lZC5cbiAgICB3aGlsZSAodGhpcy5uYW1lTWFwW25hbWVdICYmIG5hbWUgIT09IHRoaXMubmFtZU1hcFtuYW1lXSkge1xuICAgICAgbmFtZSA9IHRoaXMubmFtZU1hcFtuYW1lXTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmFtZTtcbiAgfVxufVxuXG4vKlxuICBXZSB1c2UgdHlwZSBndWFyZHMgaW5zdGVhZCBvZiBgaW5zdGFuY2VvZmAgYXMgYGluc3RhbmNlb2ZgIG1ha2VzXG4gIGRpZmZlcmVudCBwYXJ0cyBvZiB0aGUgY29tcGlsZXIgZGVwZW5kIG9uIHRoZSBhY3R1YWwgaW1wbGVtZW50YXRpb24gb2ZcbiAgdGhlIG1vZGVsIGNsYXNzZXMsIHdoaWNoIGluIHR1cm4gZGVwZW5kIG9uIGRpZmZlcmVudCBwYXJ0cyBvZiB0aGUgY29tcGlsZXIuXG4gIFRodXMsIGBpbnN0YW5jZW9mYCBsZWFkcyB0byBjaXJjdWxhciBkZXBlbmRlbmN5IHByb2JsZW1zLlxuXG4gIE9uIHRoZSBvdGhlciBoYW5kLCB0eXBlIGd1YXJkcyBvbmx5IG1ha2UgZGlmZmVyZW50IHBhcnRzIG9mIHRoZSBjb21waWxlclxuICBkZXBlbmQgb24gdGhlIHR5cGUgb2YgdGhlIG1vZGVsIGNsYXNzZXMsIGJ1dCBub3QgdGhlIGFjdHVhbCBpbXBsZW1lbnRhdGlvbi5cbiovXG5cbmV4cG9ydCBmdW5jdGlvbiBpc1VuaXRNb2RlbChtb2RlbDogTW9kZWwpOiBtb2RlbCBpcyBVbml0TW9kZWwge1xuICByZXR1cm4gbW9kZWwgJiYgbW9kZWwudHlwZSA9PT0gJ3VuaXQnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNGYWNldE1vZGVsKG1vZGVsOiBNb2RlbCk6IG1vZGVsIGlzIEZhY2V0TW9kZWwge1xuICByZXR1cm4gbW9kZWwgJiYgbW9kZWwudHlwZSA9PT0gJ2ZhY2V0Jztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzUmVwZWF0TW9kZWwobW9kZWw6IE1vZGVsKTogbW9kZWwgaXMgUmVwZWF0TW9kZWwge1xuICByZXR1cm4gbW9kZWwgJiYgbW9kZWwudHlwZSA9PT0gJ3JlcGVhdCc7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0NvbmNhdE1vZGVsKG1vZGVsOiBNb2RlbCk6IG1vZGVsIGlzIENvbmNhdE1vZGVsIHtcbiAgcmV0dXJuIG1vZGVsICYmIG1vZGVsLnR5cGUgPT09ICdjb25jYXQnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNMYXllck1vZGVsKG1vZGVsOiBNb2RlbCk6IG1vZGVsIGlzIExheWVyTW9kZWwge1xuICByZXR1cm4gbW9kZWwgJiYgbW9kZWwudHlwZSA9PT0gJ2xheWVyJztcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIE1vZGVsIHtcblxuICBwdWJsaWMgYWJzdHJhY3QgcmVhZG9ubHkgdHlwZTogJ3VuaXQnIHwgJ2ZhY2V0JyB8ICdsYXllcicgfCAnY29uY2F0JyB8ICdyZXBlYXQnO1xuICBwdWJsaWMgcmVhZG9ubHkgcGFyZW50OiBNb2RlbDtcbiAgcHVibGljIHJlYWRvbmx5IG5hbWU6IHN0cmluZztcblxuICBwdWJsaWMgcmVhZG9ubHkgdGl0bGU6IFRpdGxlUGFyYW1zO1xuICBwdWJsaWMgcmVhZG9ubHkgZGVzY3JpcHRpb246IHN0cmluZztcblxuICBwdWJsaWMgcmVhZG9ubHkgZGF0YTogRGF0YTtcbiAgcHVibGljIHJlYWRvbmx5IHRyYW5zZm9ybXM6IFRyYW5zZm9ybVtdO1xuXG4gIC8qKiBOYW1lIG1hcCBmb3Igc2NhbGVzLCB3aGljaCBjYW4gYmUgcmVuYW1lZCBieSBhIG1vZGVsJ3MgcGFyZW50LiAqL1xuICBwcm90ZWN0ZWQgc2NhbGVOYW1lTWFwOiBOYW1lTWFwSW50ZXJmYWNlO1xuXG4gIC8qKiBOYW1lIG1hcCBmb3IgcHJvamVjdGlvbnMsIHdoaWNoIGNhbiBiZSByZW5hbWVkIGJ5IGEgbW9kZWwncyBwYXJlbnQuICovXG4gIHByb3RlY3RlZCBwcm9qZWN0aW9uTmFtZU1hcDogTmFtZU1hcEludGVyZmFjZTtcblxuICAvKiogTmFtZSBtYXAgZm9yIHNpemUsIHdoaWNoIGNhbiBiZSByZW5hbWVkIGJ5IGEgbW9kZWwncyBwYXJlbnQuICovXG4gIHByb3RlY3RlZCBsYXlvdXRTaXplTmFtZU1hcDogTmFtZU1hcEludGVyZmFjZTtcblxuICBwdWJsaWMgcmVhZG9ubHkgcmVwZWF0ZXI6IFJlcGVhdGVyVmFsdWU7XG5cbiAgcHVibGljIHJlYWRvbmx5IGNvbmZpZzogQ29uZmlnO1xuXG4gIHB1YmxpYyByZWFkb25seSBjb21wb25lbnQ6IENvbXBvbmVudDtcblxuICBwdWJsaWMgYWJzdHJhY3QgcmVhZG9ubHkgY2hpbGRyZW46IE1vZGVsW10gPSBbXTtcblxuICBjb25zdHJ1Y3RvcihzcGVjOiBCYXNlU3BlYywgcGFyZW50OiBNb2RlbCwgcGFyZW50R2l2ZW5OYW1lOiBzdHJpbmcsIGNvbmZpZzogQ29uZmlnLCByZXBlYXRlcjogUmVwZWF0ZXJWYWx1ZSwgcmVzb2x2ZTogUmVzb2x2ZSkge1xuICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgIHRoaXMuY29uZmlnID0gY29uZmlnO1xuICAgIHRoaXMucmVwZWF0ZXIgPSByZXBlYXRlcjtcblxuICAgIC8vIElmIG5hbWUgaXMgbm90IHByb3ZpZGVkLCBhbHdheXMgdXNlIHBhcmVudCdzIGdpdmVuTmFtZSB0byBhdm9pZCBuYW1lIGNvbmZsaWN0cy5cbiAgICB0aGlzLm5hbWUgPSBzcGVjLm5hbWUgfHwgcGFyZW50R2l2ZW5OYW1lO1xuICAgIHRoaXMudGl0bGUgPSBpc1N0cmluZyhzcGVjLnRpdGxlKSA/IHt0ZXh0OiBzcGVjLnRpdGxlfSA6IHNwZWMudGl0bGU7XG5cbiAgICAvLyBTaGFyZWQgbmFtZSBtYXBzXG4gICAgdGhpcy5zY2FsZU5hbWVNYXAgPSBwYXJlbnQgPyBwYXJlbnQuc2NhbGVOYW1lTWFwIDogbmV3IE5hbWVNYXAoKTtcbiAgICB0aGlzLnByb2plY3Rpb25OYW1lTWFwID0gcGFyZW50ID8gcGFyZW50LnByb2plY3Rpb25OYW1lTWFwIDogbmV3IE5hbWVNYXAoKTtcbiAgICB0aGlzLmxheW91dFNpemVOYW1lTWFwID0gcGFyZW50ID8gcGFyZW50LmxheW91dFNpemVOYW1lTWFwIDogbmV3IE5hbWVNYXAoKTtcblxuICAgIHRoaXMuZGF0YSA9IHNwZWMuZGF0YTtcblxuICAgIHRoaXMuZGVzY3JpcHRpb24gPSBzcGVjLmRlc2NyaXB0aW9uO1xuICAgIHRoaXMudHJhbnNmb3JtcyA9IG5vcm1hbGl6ZVRyYW5zZm9ybShzcGVjLnRyYW5zZm9ybSB8fCBbXSk7XG5cbiAgICB0aGlzLmNvbXBvbmVudCA9IHtcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgc291cmNlczogcGFyZW50ID8gcGFyZW50LmNvbXBvbmVudC5kYXRhLnNvdXJjZXMgOiB7fSxcbiAgICAgICAgb3V0cHV0Tm9kZXM6IHBhcmVudCA/IHBhcmVudC5jb21wb25lbnQuZGF0YS5vdXRwdXROb2RlcyA6IHt9LFxuICAgICAgICBvdXRwdXROb2RlUmVmQ291bnRzOiBwYXJlbnQgPyBwYXJlbnQuY29tcG9uZW50LmRhdGEub3V0cHV0Tm9kZVJlZkNvdW50cyA6IHt9LFxuICAgICAgICAvLyBkYXRhIGlzIGZhY2V0ZWQgaWYgdGhlIHNwZWMgaXMgYSBmYWNldCBzcGVjIG9yIHRoZSBwYXJlbnQgaGFzIGZhY2V0ZWQgZGF0YSBhbmQgbm8gZGF0YSBpcyBkZWZpbmVkXG4gICAgICAgIGlzRmFjZXRlZDogaXNGYWNldFNwZWMoc3BlYykgfHwgKHBhcmVudCAmJiBwYXJlbnQuY29tcG9uZW50LmRhdGEuaXNGYWNldGVkICYmICFzcGVjLmRhdGEpXG4gICAgICB9LFxuICAgICAgbGF5b3V0U2l6ZTogbmV3IFNwbGl0PExheW91dFNpemVJbmRleD4oKSxcbiAgICAgIGxheW91dEhlYWRlcnM6e3Jvdzoge30sIGNvbHVtbjoge319LFxuICAgICAgbWFyazogbnVsbCxcbiAgICAgIHJlc29sdmU6IHtcbiAgICAgICAgc2NhbGU6IHt9LCBheGlzOiB7fSwgbGVnZW5kOiB7fSxcbiAgICAgICAgLi4uKHJlc29sdmUgfHwge30pXG4gICAgICB9LFxuICAgICAgc2VsZWN0aW9uOiBudWxsLFxuICAgICAgc2NhbGVzOiBudWxsLFxuICAgICAgcHJvamVjdGlvbjogbnVsbCxcbiAgICAgIGF4ZXM6IHt9LFxuICAgICAgbGVnZW5kczoge30sXG4gICAgfTtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgd2lkdGgoKTogVmdTaWduYWxSZWYge1xuICAgIHJldHVybiB0aGlzLmdldFNpemVTaWduYWxSZWYoJ3dpZHRoJyk7XG4gIH1cblxuXG4gIHB1YmxpYyBnZXQgaGVpZ2h0KCk6IFZnU2lnbmFsUmVmIHtcbiAgICByZXR1cm4gdGhpcy5nZXRTaXplU2lnbmFsUmVmKCdoZWlnaHQnKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBpbml0U2l6ZShzaXplOiBMYXlvdXRTaXplSW5kZXgpIHtcbiAgICBjb25zdCB7d2lkdGgsIGhlaWdodH0gPSBzaXplO1xuICAgIGlmICh3aWR0aCkge1xuICAgICAgdGhpcy5jb21wb25lbnQubGF5b3V0U2l6ZS5zZXQoJ3dpZHRoJywgd2lkdGgsIHRydWUpO1xuICAgIH1cblxuICAgIGlmIChoZWlnaHQpIHtcbiAgICAgIHRoaXMuY29tcG9uZW50LmxheW91dFNpemUuc2V0KCdoZWlnaHQnLCBoZWlnaHQsIHRydWUpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBwYXJzZSgpIHtcbiAgICB0aGlzLnBhcnNlU2NhbGUoKTtcblxuICAgIHRoaXMucGFyc2VMYXlvdXRTaXplKCk7IC8vIGRlcGVuZHMgb24gc2NhbGVcbiAgICB0aGlzLnJlbmFtZVRvcExldmVsTGF5b3V0U2l6ZSgpO1xuXG4gICAgdGhpcy5wYXJzZVNlbGVjdGlvbigpO1xuICAgIHRoaXMucGFyc2VQcm9qZWN0aW9uKCk7XG4gICAgdGhpcy5wYXJzZURhdGEoKTsgLy8gKHBhdGhvcmRlcikgZGVwZW5kcyBvbiBtYXJrRGVmOyBzZWxlY3Rpb24gZmlsdGVycyBkZXBlbmQgb24gcGFyc2VkIHNlbGVjdGlvbnM7IGRlcGVuZHMgb24gcHJvamVjdGlvbiBiZWNhdXNlIHNvbWUgdHJhbnNmb3JtcyByZXF1aXJlIHRoZSBmaW5hbGl6ZWQgcHJvamVjdGlvbiBuYW1lLlxuICAgIHRoaXMucGFyc2VBeGlzQW5kSGVhZGVyKCk7IC8vIGRlcGVuZHMgb24gc2NhbGUgYW5kIGxheW91dCBzaXplXG4gICAgdGhpcy5wYXJzZUxlZ2VuZCgpOyAvLyBkZXBlbmRzIG9uIHNjYWxlLCBtYXJrRGVmXG4gICAgdGhpcy5wYXJzZU1hcmtHcm91cCgpOyAvLyBkZXBlbmRzIG9uIGRhdGEgbmFtZSwgc2NhbGUsIGxheW91dCBzaXplLCBheGlzR3JvdXAsIGFuZCBjaGlsZHJlbidzIHNjYWxlLCBheGlzLCBsZWdlbmQgYW5kIG1hcmsuXG4gIH1cblxuICBwdWJsaWMgYWJzdHJhY3QgcGFyc2VEYXRhKCk6IHZvaWQ7XG5cbiAgcHVibGljIGFic3RyYWN0IHBhcnNlU2VsZWN0aW9uKCk6IHZvaWQ7XG5cblxuICBwdWJsaWMgcGFyc2VTY2FsZSgpIHtcbiAgICBwYXJzZVNjYWxlKHRoaXMpO1xuICB9XG5cbiAgcHVibGljIHBhcnNlUHJvamVjdGlvbigpIHtcbiAgICBwYXJzZVByb2plY3Rpb24odGhpcyk7XG4gIH1cblxuICBwdWJsaWMgYWJzdHJhY3QgcGFyc2VMYXlvdXRTaXplKCk6IHZvaWQ7XG5cbiAgLyoqXG4gICAqIFJlbmFtZSB0b3AtbGV2ZWwgc3BlYydzIHNpemUgdG8gYmUganVzdCB3aWR0aCAvIGhlaWdodCwgaWdub3JpbmcgbW9kZWwgbmFtZS5cbiAgICogVGhpcyBlc3NlbnRpYWxseSBtZXJnZXMgdGhlIHRvcC1sZXZlbCBzcGVjJ3Mgd2lkdGgvaGVpZ2h0IHNpZ25hbHMgd2l0aCB0aGUgd2lkdGgvaGVpZ2h0IHNpZ25hbHNcbiAgICogdG8gaGVscCB1cyByZWR1Y2UgcmVkdW5kYW50IHNpZ25hbHMgZGVjbGFyYXRpb24uXG4gICAqL1xuICBwcml2YXRlIHJlbmFtZVRvcExldmVsTGF5b3V0U2l6ZSgpIHtcbiAgICBpZiAodGhpcy5nZXROYW1lKCd3aWR0aCcpICE9PSAnd2lkdGgnKSB7XG4gICAgICB0aGlzLnJlbmFtZUxheW91dFNpemUodGhpcy5nZXROYW1lKCd3aWR0aCcpLCAnd2lkdGgnKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuZ2V0TmFtZSgnaGVpZ2h0JykgIT09ICdoZWlnaHQnKSB7XG4gICAgICB0aGlzLnJlbmFtZUxheW91dFNpemUodGhpcy5nZXROYW1lKCdoZWlnaHQnKSwgJ2hlaWdodCcpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBhYnN0cmFjdCBwYXJzZU1hcmtHcm91cCgpOiB2b2lkO1xuXG4gIHB1YmxpYyBhYnN0cmFjdCBwYXJzZUF4aXNBbmRIZWFkZXIoKTogdm9pZDtcblxuICBwdWJsaWMgcGFyc2VMZWdlbmQoKSB7XG4gICAgcGFyc2VMZWdlbmQodGhpcyk7XG4gIH1cblxuICBwdWJsaWMgYWJzdHJhY3QgYXNzZW1ibGVTZWxlY3Rpb25Ub3BMZXZlbFNpZ25hbHMoc2lnbmFsczogYW55W10pOiBhbnlbXTtcbiAgcHVibGljIGFic3RyYWN0IGFzc2VtYmxlU2VsZWN0aW9uU2lnbmFscygpOiBhbnlbXTtcblxuICBwdWJsaWMgYWJzdHJhY3QgYXNzZW1ibGVTZWxlY3Rpb25EYXRhKGRhdGE6IFZnRGF0YVtdKTogVmdEYXRhW107XG5cbiAgcHVibGljIGFzc2VtYmxlR3JvdXBTdHlsZSgpOiBzdHJpbmcge1xuICAgIGlmICh0aGlzLnR5cGUgPT09ICd1bml0JyB8fCB0aGlzLnR5cGUgPT09ICdsYXllcicpIHtcbiAgICAgIHJldHVybiAnY2VsbCc7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICBwdWJsaWMgYXNzZW1ibGVMYXlvdXRTaXplKCk6IFZnRW5jb2RlRW50cnkge1xuICAgIGlmICh0aGlzLnR5cGUgPT09ICd1bml0JyB8fCB0aGlzLnR5cGUgPT09ICdsYXllcicpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHdpZHRoOiB0aGlzLmdldFNpemVTaWduYWxSZWYoJ3dpZHRoJyksXG4gICAgICAgIGhlaWdodDogdGhpcy5nZXRTaXplU2lnbmFsUmVmKCdoZWlnaHQnKVxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIHB1YmxpYyBhYnN0cmFjdCBhc3NlbWJsZUxheW91dCgpOiBWZ0xheW91dDtcblxuICBwdWJsaWMgYWJzdHJhY3QgYXNzZW1ibGVMYXlvdXRTaWduYWxzKCk6IFZnU2lnbmFsW107XG5cbiAgcHVibGljIGFzc2VtYmxlSGVhZGVyTWFya3MoKTogVmdNYXJrR3JvdXBbXSB7XG4gICAgY29uc3Qge2xheW91dEhlYWRlcnN9ID0gdGhpcy5jb21wb25lbnQ7XG4gICAgbGV0IGhlYWRlck1hcmtzID0gW107XG5cbiAgICBmb3IgKGNvbnN0IGNoYW5uZWwgb2YgSEVBREVSX0NIQU5ORUxTKSB7XG4gICAgICBpZiAobGF5b3V0SGVhZGVyc1tjaGFubmVsXS50aXRsZSkge1xuICAgICAgICBoZWFkZXJNYXJrcy5wdXNoKGdldFRpdGxlR3JvdXAodGhpcywgY2hhbm5lbCkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAoY29uc3QgY2hhbm5lbCBvZiBIRUFERVJfQ0hBTk5FTFMpIHtcbiAgICAgIGhlYWRlck1hcmtzID0gaGVhZGVyTWFya3MuY29uY2F0KGdldEhlYWRlckdyb3Vwcyh0aGlzLCBjaGFubmVsKSk7XG4gICAgfVxuICAgIHJldHVybiBoZWFkZXJNYXJrcztcbiAgfVxuXG4gIHB1YmxpYyBhYnN0cmFjdCBhc3NlbWJsZU1hcmtzKCk6IFZnTWFya0dyb3VwW107IC8vIFRPRE86IFZnTWFya0dyb3VwW11cblxuICBwdWJsaWMgYXNzZW1ibGVBeGVzKCk6IFZnQXhpc1tdIHtcbiAgICByZXR1cm4gYXNzZW1ibGVBeGVzKHRoaXMuY29tcG9uZW50LmF4ZXMsIHRoaXMuY29uZmlnKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3NlbWJsZUxlZ2VuZHMoKTogVmdMZWdlbmRbXSB7XG4gICAgcmV0dXJuIGFzc2VtYmxlTGVnZW5kcyh0aGlzKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3NlbWJsZVByb2plY3Rpb25zKCk6IFZnUHJvamVjdGlvbltdIHtcbiAgICByZXR1cm4gYXNzZW1ibGVQcm9qZWN0aW9ucyh0aGlzKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3NlbWJsZVRpdGxlKCk6IFZnVGl0bGUge1xuICAgIGNvbnN0IHRpdGxlOiBWZ1RpdGxlID0ge1xuICAgICAgLi4uZXh0cmFjdFRpdGxlQ29uZmlnKHRoaXMuY29uZmlnLnRpdGxlKS5ub25NYXJrLFxuICAgICAgLi4udGhpcy50aXRsZVxuICAgIH07XG5cbiAgICBpZiAodGl0bGUudGV4dCkge1xuICAgICAgaWYgKCFjb250YWlucyhbJ3VuaXQnLCAnbGF5ZXInXSwgdGhpcy50eXBlKSkge1xuICAgICAgICAvLyBBcyBkZXNjcmliZWQgaW4gaHR0cHM6Ly9naXRodWIuY29tL3ZlZ2EvdmVnYS1saXRlL2lzc3Vlcy8yODc1OlxuICAgICAgICAvLyBEdWUgdG8gdmVnYS92ZWdhIzk2MCAoY29tbWVudCksIHdlIG9ubHkgc3VwcG9ydCB0aXRsZSdzIGFuY2hvciBmb3IgdW5pdCBhbmQgbGF5ZXJlZCBzcGVjIGZvciBub3cuXG5cbiAgICAgICAgaWYgKHRpdGxlLmFuY2hvciAmJiB0aXRsZS5hbmNob3IgIT09ICdzdGFydCcpIHtcbiAgICAgICAgICBsb2cud2Fybihsb2cubWVzc2FnZS5jYW5ub3RTZXRUaXRsZUFuY2hvcih0aGlzLnR5cGUpKTtcbiAgICAgICAgfVxuICAgICAgICB0aXRsZS5hbmNob3IgPSAnc3RhcnQnO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ga2V5cyh0aXRsZSkubGVuZ3RoID4gMCA/IHRpdGxlIDogdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgLyoqXG4gICAqIEFzc2VtYmxlIHRoZSBtYXJrIGdyb3VwIGZvciB0aGlzIG1vZGVsLiAgV2UgYWNjZXB0IG9wdGlvbmFsIGBzaWduYWxzYCBzbyB0aGF0IHdlIGNhbiBpbmNsdWRlIGNvbmNhdCB0b3AtbGV2ZWwgc2lnbmFscyB3aXRoIHRoZSB0b3AtbGV2ZWwgbW9kZWwncyBsb2NhbCBzaWduYWxzLlxuICAgKi9cbiAgcHVibGljIGFzc2VtYmxlR3JvdXAoc2lnbmFsczogVmdTaWduYWxbXSA9IFtdKSB7XG4gICAgY29uc3QgZ3JvdXA6IFZnTWFya0dyb3VwID0ge307XG5cbiAgICBzaWduYWxzID0gc2lnbmFscy5jb25jYXQodGhpcy5hc3NlbWJsZVNlbGVjdGlvblNpZ25hbHMoKSk7XG5cbiAgICBpZiAoc2lnbmFscy5sZW5ndGggPiAwKSB7XG4gICAgICBncm91cC5zaWduYWxzID0gc2lnbmFscztcbiAgICB9XG5cbiAgICBjb25zdCBsYXlvdXQgPSB0aGlzLmFzc2VtYmxlTGF5b3V0KCk7XG4gICAgaWYgKGxheW91dCkge1xuICAgICAgZ3JvdXAubGF5b3V0ID0gbGF5b3V0O1xuICAgIH1cblxuICAgIGdyb3VwLm1hcmtzID0gW10uY29uY2F0KFxuICAgICAgdGhpcy5hc3NlbWJsZUhlYWRlck1hcmtzKCksXG4gICAgICB0aGlzLmFzc2VtYmxlTWFya3MoKVxuICAgICk7XG5cbiAgICAvLyBPbmx5IGluY2x1ZGUgc2NhbGVzIGlmIHRoaXMgc3BlYyBpcyB0b3AtbGV2ZWwgb3IgaWYgcGFyZW50IGlzIGZhY2V0LlxuICAgIC8vIChPdGhlcndpc2UsIGl0IHdpbGwgYmUgbWVyZ2VkIHdpdGggdXBwZXItbGV2ZWwncyBzY29wZS4pXG4gICAgY29uc3Qgc2NhbGVzID0gKCF0aGlzLnBhcmVudCB8fCBpc0ZhY2V0TW9kZWwodGhpcy5wYXJlbnQpKSA/IGFzc2VtYmxlU2NhbGVzKHRoaXMpIDogW107XG4gICAgaWYgKHNjYWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICBncm91cC5zY2FsZXMgPSBzY2FsZXM7XG4gICAgfVxuXG4gICAgY29uc3QgYXhlcyA9IHRoaXMuYXNzZW1ibGVBeGVzKCk7XG4gICAgaWYgKGF4ZXMubGVuZ3RoID4gMCkge1xuICAgICAgZ3JvdXAuYXhlcyA9IGF4ZXM7XG4gICAgfVxuXG4gICAgY29uc3QgbGVnZW5kcyA9IHRoaXMuYXNzZW1ibGVMZWdlbmRzKCk7XG4gICAgaWYgKGxlZ2VuZHMubGVuZ3RoID4gMCkge1xuICAgICAgZ3JvdXAubGVnZW5kcyA9IGxlZ2VuZHM7XG4gICAgfVxuXG4gICAgcmV0dXJuIGdyb3VwO1xuICB9XG5cbiAgcHVibGljIGhhc0Rlc2NlbmRhbnRXaXRoRmllbGRPbkNoYW5uZWwoY2hhbm5lbDogQ2hhbm5lbCkge1xuICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpcy5jaGlsZHJlbikge1xuICAgICAgaWYgKGlzVW5pdE1vZGVsKGNoaWxkKSkge1xuICAgICAgICBpZiAoY2hpbGQuY2hhbm5lbEhhc0ZpZWxkKGNoYW5uZWwpKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChjaGlsZC5oYXNEZXNjZW5kYW50V2l0aEZpZWxkT25DaGFubmVsKGNoYW5uZWwpKSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcHVibGljIGdldE5hbWUodGV4dDogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHZhck5hbWUoKHRoaXMubmFtZSA/IHRoaXMubmFtZSArICdfJyA6ICcnKSArIHRleHQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlcXVlc3QgYSBkYXRhIHNvdXJjZSBuYW1lIGZvciB0aGUgZ2l2ZW4gZGF0YSBzb3VyY2UgdHlwZSBhbmQgbWFyayB0aGF0IGRhdGEgc291cmNlIGFzIHJlcXVpcmVkLiBUaGlzIG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkIGluIHBhcnNlLCBzbyB0aGF0IGFsbCB1c2VkIGRhdGEgc291cmNlIGNhbiBiZSBjb3JyZWN0bHkgaW5zdGFudGlhdGVkIGluIGFzc2VtYmxlRGF0YSgpLlxuICAgKi9cbiAgcHVibGljIHJlcXVlc3REYXRhTmFtZShuYW1lOiBEYXRhU291cmNlVHlwZSkge1xuICAgIGNvbnN0IGZ1bGxOYW1lID0gdGhpcy5nZXROYW1lKG5hbWUpO1xuXG4gICAgLy8gSW5jcmVhc2UgcmVmIGNvdW50LiBUaGlzIGlzIGNyaXRpY2FsIGJlY2F1c2Ugb3RoZXJ3aXNlIHdlIHdvbid0IGNyZWF0ZSBhIGRhdGEgc291cmNlLlxuICAgIC8vIFdlIGFsc28gaW5jcmVhc2UgdGhlIHJlZiBjb3VudHMgb24gT3V0cHV0Tm9kZS5nZXRTb3VyY2UoKSBjYWxscy5cbiAgICBjb25zdCByZWZDb3VudHMgPSB0aGlzLmNvbXBvbmVudC5kYXRhLm91dHB1dE5vZGVSZWZDb3VudHM7XG4gICAgcmVmQ291bnRzW2Z1bGxOYW1lXSA9IChyZWZDb3VudHNbZnVsbE5hbWVdIHx8IDApICsgMTtcblxuICAgIHJldHVybiBmdWxsTmFtZTtcbiAgfVxuXG4gIHB1YmxpYyBnZXRTaXplU2lnbmFsUmVmKHNpemVUeXBlOiAnd2lkdGgnIHwgJ2hlaWdodCcpOiBWZ1NpZ25hbFJlZiB7XG4gICAgaWYgKGlzRmFjZXRNb2RlbCh0aGlzLnBhcmVudCkpIHtcbiAgICAgIGNvbnN0IGNoYW5uZWwgPSBzaXplVHlwZSA9PT0gJ3dpZHRoJyA/ICd4JyA6ICd5JztcbiAgICAgIGNvbnN0IHNjYWxlQ29tcG9uZW50ID0gdGhpcy5jb21wb25lbnQuc2NhbGVzW2NoYW5uZWxdO1xuXG4gICAgICBpZiAoc2NhbGVDb21wb25lbnQgJiYgIXNjYWxlQ29tcG9uZW50Lm1lcmdlZCkgeyAvLyBpbmRlcGVuZGVudCBzY2FsZVxuICAgICAgICBjb25zdCB0eXBlID0gc2NhbGVDb21wb25lbnQuZ2V0KCd0eXBlJyk7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gc2NhbGVDb21wb25lbnQuZ2V0KCdyYW5nZScpO1xuXG4gICAgICAgIGlmIChoYXNEaXNjcmV0ZURvbWFpbih0eXBlKSAmJiBpc1ZnUmFuZ2VTdGVwKHJhbmdlKSkge1xuICAgICAgICAgIGNvbnN0IHNjYWxlTmFtZSA9IHNjYWxlQ29tcG9uZW50LmdldCgnbmFtZScpO1xuICAgICAgICAgIGNvbnN0IGRvbWFpbiA9IGFzc2VtYmxlRG9tYWluKHRoaXMsIGNoYW5uZWwpO1xuICAgICAgICAgIGNvbnN0IGZpZWxkID0gZ2V0RmllbGRGcm9tRG9tYWluKGRvbWFpbik7XG4gICAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZFJlZiA9IHZnRmllbGQoe2FnZ3JlZ2F0ZTogJ2Rpc3RpbmN0JywgZmllbGR9LCB7ZXhwcjogJ2RhdHVtJ30pO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgc2lnbmFsOiBzaXplRXhwcihzY2FsZU5hbWUsIHNjYWxlQ29tcG9uZW50LCBmaWVsZFJlZilcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxvZy53YXJuKCdVbmtub3duIGZpZWxkIGZvciAke2NoYW5uZWx9LiAgQ2Fubm90IGNhbGN1bGF0ZSB2aWV3IHNpemUuJyk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBzaWduYWw6IHRoaXMubGF5b3V0U2l6ZU5hbWVNYXAuZ2V0KHRoaXMuZ2V0TmFtZShzaXplVHlwZSkpXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBMb29rdXAgdGhlIG5hbWUgb2YgdGhlIGRhdGFzb3VyY2UgZm9yIGFuIG91dHB1dCBub2RlLiBZb3UgcHJvYmFibHkgd2FudCB0byBjYWxsIHRoaXMgaW4gYXNzZW1ibGUuXG4gICAqL1xuICBwdWJsaWMgbG9va3VwRGF0YVNvdXJjZShuYW1lOiBzdHJpbmcpIHtcbiAgICBjb25zdCBub2RlID0gdGhpcy5jb21wb25lbnQuZGF0YS5vdXRwdXROb2Rlc1tuYW1lXTtcblxuICAgIGlmICghbm9kZSkge1xuICAgICAgLy8gTmFtZSBub3QgZm91bmQgaW4gbWFwIHNvIGxldCdzIGp1c3QgcmV0dXJuIHdoYXQgd2UgZ290LlxuICAgICAgLy8gVGhpcyBjYW4gaGFwcGVuIGlmIHdlIGFscmVhZHkgaGF2ZSB0aGUgY29ycmVjdCBuYW1lLlxuICAgICAgcmV0dXJuIG5hbWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5vZGUuZ2V0U291cmNlKCk7XG4gIH1cblxuICBwdWJsaWMgZ2V0U2l6ZU5hbWUob2xkU2l6ZU5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgIHJldHVybiB0aGlzLmxheW91dFNpemVOYW1lTWFwLmdldChvbGRTaXplTmFtZSk7XG4gIH1cblxuICBwdWJsaWMgcmVuYW1lTGF5b3V0U2l6ZShvbGROYW1lOiBzdHJpbmcsIG5ld05hbWU6IHN0cmluZykge1xuICAgIHRoaXMubGF5b3V0U2l6ZU5hbWVNYXAucmVuYW1lKG9sZE5hbWUsIG5ld05hbWUpO1xuICB9XG5cbiAgcHVibGljIHJlbmFtZVNjYWxlKG9sZE5hbWU6IHN0cmluZywgbmV3TmFtZTogc3RyaW5nKSB7XG4gICAgdGhpcy5zY2FsZU5hbWVNYXAucmVuYW1lKG9sZE5hbWUsIG5ld05hbWUpO1xuICB9XG5cbiAgcHVibGljIHJlbmFtZVByb2plY3Rpb24ob2xkTmFtZTogc3RyaW5nLCBuZXdOYW1lOiBzdHJpbmcpIHtcbiAgICB0aGlzLnByb2plY3Rpb25OYW1lTWFwLnJlbmFtZShvbGROYW1lLCBuZXdOYW1lKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcmV0dXJuIHNjYWxlIG5hbWUgZm9yIGEgZ2l2ZW4gY2hhbm5lbCBhZnRlciB0aGUgc2NhbGUgaGFzIGJlZW4gcGFyc2VkIGFuZCBuYW1lZC5cbiAgICovXG4gIHB1YmxpYyBzY2FsZU5hbWUob3JpZ2luYWxTY2FsZU5hbWU6IENoYW5uZWwgfCBzdHJpbmcsIHBhcnNlPzogYm9vbGVhbik6IHN0cmluZyB7XG4gICAgaWYgKHBhcnNlKSB7XG4gICAgICAvLyBEdXJpbmcgdGhlIHBhcnNlIHBoYXNlIGFsd2F5cyByZXR1cm4gYSB2YWx1ZVxuICAgICAgLy8gTm8gbmVlZCB0byByZWZlciB0byByZW5hbWUgbWFwIGJlY2F1c2UgYSBzY2FsZSBjYW4ndCBiZSByZW5hbWVkXG4gICAgICAvLyBiZWZvcmUgaXQgaGFzIHRoZSBvcmlnaW5hbCBuYW1lLlxuICAgICAgcmV0dXJuIHRoaXMuZ2V0TmFtZShvcmlnaW5hbFNjYWxlTmFtZSk7XG4gICAgfVxuXG4gICAgLy8gSWYgdGhlcmUgaXMgYSBzY2FsZSBmb3IgdGhlIGNoYW5uZWwsIGl0IHNob3VsZCBlaXRoZXJcbiAgICAvLyBiZSBpbiB0aGUgc2NhbGUgY29tcG9uZW50IG9yIGV4aXN0IGluIHRoZSBuYW1lIG1hcFxuICAgIGlmIChcbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgYSBzY2FsZSBmb3IgdGhlIGNoYW5uZWwsIHRoZXJlIHNob3VsZCBiZSBhIGxvY2FsIHNjYWxlIGNvbXBvbmVudCBmb3IgaXRcbiAgICAgICAgKGlzQ2hhbm5lbChvcmlnaW5hbFNjYWxlTmFtZSkgJiYgaXNTY2FsZUNoYW5uZWwob3JpZ2luYWxTY2FsZU5hbWUpICYmIHRoaXMuY29tcG9uZW50LnNjYWxlc1tvcmlnaW5hbFNjYWxlTmFtZV0pIHx8XG4gICAgICAgIC8vIGluIHRoZSBzY2FsZSBuYW1lIG1hcCAodGhlIHNjYWxlIGdldCBtZXJnZWQgYnkgaXRzIHBhcmVudClcbiAgICAgICAgdGhpcy5zY2FsZU5hbWVNYXAuaGFzKHRoaXMuZ2V0TmFtZShvcmlnaW5hbFNjYWxlTmFtZSkpXG4gICAgICApIHtcbiAgICAgIHJldHVybiB0aGlzLnNjYWxlTmFtZU1hcC5nZXQodGhpcy5nZXROYW1lKG9yaWdpbmFsU2NhbGVOYW1lKSk7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICAvKipcbiAgICogQHJldHVybiBwcm9qZWN0aW9uIG5hbWUgYWZ0ZXIgdGhlIHByb2plY3Rpb24gaGFzIGJlZW4gcGFyc2VkIGFuZCBuYW1lZC5cbiAgICovXG4gIHB1YmxpYyBwcm9qZWN0aW9uTmFtZShwYXJzZT86IGJvb2xlYW4pOiBzdHJpbmcge1xuICAgIGlmIChwYXJzZSkge1xuICAgICAgLy8gRHVyaW5nIHRoZSBwYXJzZSBwaGFzZSBhbHdheXMgcmV0dXJuIGEgdmFsdWVcbiAgICAgIC8vIE5vIG5lZWQgdG8gcmVmZXIgdG8gcmVuYW1lIG1hcCBiZWNhdXNlIGEgcHJvamVjdGlvbiBjYW4ndCBiZSByZW5hbWVkXG4gICAgICAvLyBiZWZvcmUgaXQgaGFzIHRoZSBvcmlnaW5hbCBuYW1lLlxuICAgICAgcmV0dXJuIHRoaXMuZ2V0TmFtZSgncHJvamVjdGlvbicpO1xuICAgIH1cblxuICAgIGlmICgodGhpcy5jb21wb25lbnQucHJvamVjdGlvbiAmJiAhdGhpcy5jb21wb25lbnQucHJvamVjdGlvbi5tZXJnZWQpIHx8IHRoaXMucHJvamVjdGlvbk5hbWVNYXAuaGFzKHRoaXMuZ2V0TmFtZSgncHJvamVjdGlvbicpKSkge1xuICAgICAgcmV0dXJuIHRoaXMucHJvamVjdGlvbk5hbWVNYXAuZ2V0KHRoaXMuZ2V0TmFtZSgncHJvamVjdGlvbicpKTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb3JyZWN0cyB0aGUgZGF0YSByZWZlcmVuY2VzIGluIG1hcmtzIGFmdGVyIGFzc2VtYmxlLlxuICAgKi9cbiAgcHVibGljIGNvcnJlY3REYXRhTmFtZXMgPSAobWFyazogVmdNYXJrR3JvdXApID0+IHtcbiAgICAvLyBUT0RPOiBtYWtlIHRoaXMgY29ycmVjdFxuXG4gICAgLy8gZm9yIG5vcm1hbCBkYXRhIHJlZmVyZW5jZXNcbiAgICBpZiAobWFyay5mcm9tICYmIG1hcmsuZnJvbS5kYXRhKSB7XG4gICAgICBtYXJrLmZyb20uZGF0YSA9IHRoaXMubG9va3VwRGF0YVNvdXJjZShtYXJrLmZyb20uZGF0YSk7XG4gICAgfVxuXG4gICAgLy8gZm9yIGFjY2VzcyB0byBmYWNldCBkYXRhXG4gICAgaWYgKG1hcmsuZnJvbSAmJiBtYXJrLmZyb20uZmFjZXQgJiYgbWFyay5mcm9tLmZhY2V0LmRhdGEpIHtcbiAgICAgIG1hcmsuZnJvbS5mYWNldC5kYXRhID0gdGhpcy5sb29rdXBEYXRhU291cmNlKG1hcmsuZnJvbS5mYWNldC5kYXRhKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbWFyaztcbiAgfVxuXG4gIC8qKlxuICAgKiBUcmF2ZXJzZSBhIG1vZGVsJ3MgaGllcmFyY2h5IHRvIGdldCB0aGUgc2NhbGUgY29tcG9uZW50IGZvciBhIHBhcnRpY3VsYXIgY2hhbm5lbC5cbiAgICovXG4gIHB1YmxpYyBnZXRTY2FsZUNvbXBvbmVudChjaGFubmVsOiBTY2FsZUNoYW5uZWwpOiBTY2FsZUNvbXBvbmVudCB7XG4gICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IFRoaXMgaXMgd2FybmluZyBmb3IgZGVidWdnaW5nIHRlc3QgKi9cbiAgICBpZiAoIXRoaXMuY29tcG9uZW50LnNjYWxlcykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdnZXRTY2FsZUNvbXBvbmVudCBjYW5ub3QgYmUgY2FsbGVkIGJlZm9yZSBwYXJzZVNjYWxlKCkuICBNYWtlIHN1cmUgeW91IGhhdmUgY2FsbGVkIHBhcnNlU2NhbGUgb3IgdXNlIHBhcnNlVW5pdE1vZGVsV2l0aFNjYWxlKCkuJyk7XG4gICAgfVxuXG4gICAgY29uc3QgbG9jYWxTY2FsZUNvbXBvbmVudCA9IHRoaXMuY29tcG9uZW50LnNjYWxlc1tjaGFubmVsXTtcbiAgICBpZiAobG9jYWxTY2FsZUNvbXBvbmVudCAmJiAhbG9jYWxTY2FsZUNvbXBvbmVudC5tZXJnZWQpIHtcbiAgICAgIHJldHVybiBsb2NhbFNjYWxlQ29tcG9uZW50O1xuICAgIH1cbiAgICByZXR1cm4gKHRoaXMucGFyZW50ID8gdGhpcy5wYXJlbnQuZ2V0U2NhbGVDb21wb25lbnQoY2hhbm5lbCkgOiB1bmRlZmluZWQpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRyYXZlcnNlIGEgbW9kZWwncyBoaWVyYXJjaHkgdG8gZ2V0IGEgcGFydGljdWxhciBzZWxlY3Rpb24gY29tcG9uZW50LlxuICAgKi9cbiAgcHVibGljIGdldFNlbGVjdGlvbkNvbXBvbmVudCh2YXJpYWJsZU5hbWU6IHN0cmluZywgb3JpZ05hbWU6IHN0cmluZyk6IFNlbGVjdGlvbkNvbXBvbmVudCB7XG4gICAgbGV0IHNlbCA9IHRoaXMuY29tcG9uZW50LnNlbGVjdGlvblt2YXJpYWJsZU5hbWVdO1xuICAgIGlmICghc2VsICYmIHRoaXMucGFyZW50KSB7XG4gICAgICBzZWwgPSB0aGlzLnBhcmVudC5nZXRTZWxlY3Rpb25Db21wb25lbnQodmFyaWFibGVOYW1lLCBvcmlnTmFtZSk7XG4gICAgfVxuICAgIGlmICghc2VsKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IobG9nLm1lc3NhZ2Uuc2VsZWN0aW9uTm90Rm91bmQob3JpZ05hbWUpKTtcbiAgICB9XG4gICAgcmV0dXJuIHNlbDtcbiAgfVxufVxuXG4vKiogQWJzdHJhY3QgY2xhc3MgZm9yIFVuaXRNb2RlbCBhbmQgRmFjZXRNb2RlbC4gIEJvdGggb2Ygd2hpY2ggY2FuIGNvbnRhaW4gZmllbGREZWZzIGFzIGEgcGFydCBvZiBpdHMgb3duIHNwZWNpZmljYXRpb24uICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgTW9kZWxXaXRoRmllbGQgZXh0ZW5kcyBNb2RlbCB7XG4gIHB1YmxpYyBhYnN0cmFjdCBmaWVsZERlZihjaGFubmVsOiBTaW5nbGVEZWZDaGFubmVsKTogRmllbGREZWY8c3RyaW5nPjtcblxuICAvKiogR2V0IFwiZmllbGRcIiByZWZlcmVuY2UgZm9yIHZlZ2EgKi9cbiAgcHVibGljIHZnRmllbGQoY2hhbm5lbDogU2luZ2xlRGVmQ2hhbm5lbCwgb3B0OiBGaWVsZFJlZk9wdGlvbiA9IHt9KSB7XG4gICAgY29uc3QgZmllbGREZWYgPSB0aGlzLmZpZWxkRGVmKGNoYW5uZWwpO1xuXG4gICAgaWYgKCFmaWVsZERlZikge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICByZXR1cm4gdmdGaWVsZChmaWVsZERlZiwgb3B0KTtcbiAgfVxuXG4gIHByb3RlY3RlZCBhYnN0cmFjdCBnZXRNYXBwaW5nKCk6IHtba2V5IGluIENoYW5uZWxdPzogYW55fTtcblxuICBwdWJsaWMgcmVkdWNlRmllbGREZWY8VCwgVT4oZjogKGFjYzogVSwgZmQ6IEZpZWxkRGVmPHN0cmluZz4sIGM6IENoYW5uZWwpID0+IFUsIGluaXQ6IFQsIHQ/OiBhbnkpIHtcbiAgICByZXR1cm4gcmVkdWNlKHRoaXMuZ2V0TWFwcGluZygpLCAoYWNjOlUgLCBjZDogQ2hhbm5lbERlZjxzdHJpbmc+LCBjOiBDaGFubmVsKSA9PiB7XG4gICAgICBjb25zdCBmaWVsZERlZiA9IGdldEZpZWxkRGVmKGNkKTtcbiAgICAgIGlmIChmaWVsZERlZikge1xuICAgICAgICByZXR1cm4gZihhY2MsIGZpZWxkRGVmLCBjKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhY2M7XG4gICAgfSwgaW5pdCwgdCk7XG4gIH1cblxuICBwdWJsaWMgZm9yRWFjaEZpZWxkRGVmKGY6IChmZDogRmllbGREZWY8c3RyaW5nPiwgYzogQ2hhbm5lbCkgPT4gdm9pZCwgdD86IGFueSkge1xuICAgIGZvckVhY2godGhpcy5nZXRNYXBwaW5nKCksIChjZDogQ2hhbm5lbERlZjxzdHJpbmc+LCBjOiBDaGFubmVsKSA9PiB7XG4gICAgICBjb25zdCBmaWVsZERlZiA9IGdldEZpZWxkRGVmKGNkKTtcbiAgICAgIGlmIChmaWVsZERlZikge1xuICAgICAgICBmKGZpZWxkRGVmLCBjKTtcbiAgICAgIH1cbiAgICB9LCB0KTtcbiAgfVxuICBwdWJsaWMgYWJzdHJhY3QgY2hhbm5lbEhhc0ZpZWxkKGNoYW5uZWw6IENoYW5uZWwpOiBib29sZWFuO1xufVxuIl19","import { stringValue } from 'vega-util';\nimport { X, Y } from '../../../channel';\nimport * as log from '../../../log';\nimport { hasContinuousDomain, isBinScale } from '../../../scale';\nimport { channelSignalName } from '../selection';\nvar scaleBindings = {\n    has: function (selCmpt) {\n        return selCmpt.type === 'interval' && selCmpt.resolve === 'global' &&\n            selCmpt.bind && selCmpt.bind === 'scales';\n    },\n    parse: function (model, selDef, selCmpt) {\n        var bound = selCmpt.scales = [];\n        selCmpt.project.forEach(function (p) {\n            var channel = p.channel;\n            var scale = model.getScaleComponent(channel);\n            var scaleType = scale ? scale.get('type') : undefined;\n            if (!scale || !hasContinuousDomain(scaleType) || isBinScale(scaleType)) {\n                log.warn(log.message.SCALE_BINDINGS_CONTINUOUS);\n                return;\n            }\n            scale.set('domainRaw', { signal: channelSignalName(selCmpt, channel, 'data') }, true);\n            bound.push(channel);\n            // Bind both x/y for diag plot of repeated views.\n            if (model.repeater && model.repeater.row === model.repeater.column) {\n                var scale2 = model.getScaleComponent(channel === X ? Y : X);\n                scale2.set('domainRaw', { signal: channelSignalName(selCmpt, channel, 'data') }, true);\n            }\n        });\n    },\n    topLevelSignals: function (model, selCmpt, signals) {\n        // Top-level signals are only needed when coordinating composed views.\n        if (!model.parent) {\n            return signals;\n        }\n        var channels = selCmpt.scales.filter(function (channel) {\n            return !(signals.filter(function (s) { return s.name === channelSignalName(selCmpt, channel, 'data'); }).length);\n        });\n        return signals.concat(channels.map(function (channel) {\n            return { name: channelSignalName(selCmpt, channel, 'data') };\n        }));\n    },\n    signals: function (model, selCmpt, signals) {\n        // Nested signals need only push to top-level signals when within composed views.\n        if (model.parent) {\n            selCmpt.scales.forEach(function (channel) {\n                var signal = signals.filter(function (s) { return s.name === channelSignalName(selCmpt, channel, 'data'); })[0];\n                signal.push = 'outer';\n                delete signal.value;\n                delete signal.update;\n            });\n        }\n        return signals;\n    }\n};\nexport default scaleBindings;\nexport function domain(model, channel) {\n    var scale = stringValue(model.scaleName(channel));\n    return \"domain(\" + scale + \")\";\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NhbGVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvc2VsZWN0aW9uL3RyYW5zZm9ybXMvc2NhbGVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBQyxXQUFXLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDdEMsT0FBTyxFQUFVLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxrQkFBa0IsQ0FBQztBQUMvQyxPQUFPLEtBQUssR0FBRyxNQUFNLGNBQWMsQ0FBQztBQUNwQyxPQUFPLEVBQUMsbUJBQW1CLEVBQUUsVUFBVSxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFFL0QsT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0sY0FBYyxDQUFDO0FBSS9DLElBQU0sYUFBYSxHQUFxQjtJQUN0QyxHQUFHLEVBQUUsVUFBUyxPQUFPO1FBQ25CLE9BQU8sT0FBTyxDQUFDLElBQUksS0FBSyxVQUFVLElBQUksT0FBTyxDQUFDLE9BQU8sS0FBSyxRQUFRO1lBQ2hFLE9BQU8sQ0FBQyxJQUFJLElBQUksT0FBTyxDQUFDLElBQUksS0FBSyxRQUFRLENBQUM7SUFDOUMsQ0FBQztJQUVELEtBQUssRUFBRSxVQUFTLEtBQUssRUFBRSxNQUFNLEVBQUUsT0FBTztRQUNwQyxJQUFNLEtBQUssR0FBYyxPQUFPLENBQUMsTUFBTSxHQUFHLEVBQUUsQ0FBQztRQUU3QyxPQUFPLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxVQUFTLENBQUM7WUFDaEMsSUFBTSxPQUFPLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQztZQUMxQixJQUFNLEtBQUssR0FBRyxLQUFLLENBQUMsaUJBQWlCLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDL0MsSUFBTSxTQUFTLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7WUFFeEQsSUFBSSxD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QUFDO0lBQ3BELE9BQU8sWUFBVSxLQUFLLE1BQUcsQ0FBQztBQUM1QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtzdHJpbmdWYWx1ZX0gZnJvbSAndmVnYS11dGlsJztcbmltcG9ydCB7Q2hhbm5lbCwgWCwgWX0gZnJvbSAnLi4vLi4vLi4vY2hhbm5lbCc7XG5pbXBvcnQgKiBhcyBsb2cgZnJvbSAnLi4vLi4vLi4vbG9nJztcbmltcG9ydCB7aGFzQ29udGludW91c0RvbWFpbiwgaXNCaW5TY2FsZX0gZnJvbSAnLi4vLi4vLi4vc2NhbGUnO1xuaW1wb3J0IHtVbml0TW9kZWx9IGZyb20gJy4uLy4uL3VuaXQnO1xuaW1wb3J0IHtjaGFubmVsU2lnbmFsTmFtZX0gZnJvbSAnLi4vc2VsZWN0aW9uJztcbmltcG9ydCB7VHJhbnNmb3JtQ29tcGlsZXJ9IGZyb20gJy4vdHJhbnNmb3Jtcyc7XG5cblxuY29uc3Qgc2NhbGVCaW5kaW5nczpUcmFuc2Zvcm1Db21waWxlciA9IHtcbiAgaGFzOiBmdW5jdGlvbihzZWxDbXB0KSB7XG4gICAgcmV0dXJuIHNlbENtcHQudHlwZSA9PT0gJ2ludGVydmFsJyAmJiBzZWxDbXB0LnJlc29sdmUgPT09ICdnbG9iYWwnICYmXG4gICAgICBzZWxDbXB0LmJpbmQgJiYgc2VsQ21wdC5iaW5kID09PSAnc2NhbGVzJztcbiAgfSxcblxuICBwYXJzZTogZnVuY3Rpb24obW9kZWwsIHNlbERlZiwgc2VsQ21wdCkge1xuICAgIGNvbnN0IGJvdW5kOiBDaGFubmVsW10gPSBzZWxDbXB0LnNjYWxlcyA9IFtdO1xuXG4gICAgc2VsQ21wdC5wcm9qZWN0LmZvckVhY2goZnVuY3Rpb24ocCkge1xuICAgICAgY29uc3QgY2hhbm5lbCA9IHAuY2hhbm5lbDtcbiAgICAgIGNvbnN0IHNjYWxlID0gbW9kZWwuZ2V0U2NhbGVDb21wb25lbnQoY2hhbm5lbCk7XG4gICAgICBjb25zdCBzY2FsZVR5cGUgPSBzY2FsZSA/IHNjYWxlLmdldCgndHlwZScpIDogdW5kZWZpbmVkO1xuXG4gICAgICBpZiAoIXNjYWxlIHx8ICFoYXNDb250aW51b3VzRG9tYWluKHNjYWxlVHlwZSkgfHwgaXNCaW5TY2FsZShzY2FsZVR5cGUpKSB7XG4gICAgICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLlNDQUxFX0JJTkRJTkdTX0NPTlRJTlVPVVMpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHNjYWxlLnNldCgnZG9tYWluUmF3Jywge3NpZ25hbDogY2hhbm5lbFNpZ25hbE5hbWUoc2VsQ21wdCwgY2hhbm5lbCwgJ2RhdGEnKX0sIHRydWUpO1xuICAgICAgYm91bmQucHVzaChjaGFubmVsKTtcblxuICAgICAgLy8gQmluZCBib3RoIHgveSBmb3IgZGlhZyBwbG90IG9mIHJlcGVhdGVkIHZpZXdzLlxuICAgICAgaWYgKG1vZGVsLnJlcGVhdGVyICYmIG1vZGVsLnJlcGVhdGVyLnJvdyA9PT0gbW9kZWwucmVwZWF0ZXIuY29sdW1uKSB7XG4gICAgICAgIGNvbnN0IHNjYWxlMiA9IG1vZGVsLmdldFNjYWxlQ29tcG9uZW50KGNoYW5uZWwgPT09IFggPyBZIDogWCk7XG4gICAgICAgIHNjYWxlMi5zZXQoJ2RvbWFpblJhdycsIHtzaWduYWw6IGNoYW5uZWxTaWduYWxOYW1lKHNlbENtcHQsIGNoYW5uZWwsICdkYXRhJyl9LCB0cnVlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSxcblxuICB0b3BMZXZlbFNpZ25hbHM6IGZ1bmN0aW9uKG1vZGVsLCBzZWxDbXB0LCBzaWduYWxzKSB7XG4gICAgLy8gVG9wLWxldmVsIHNpZ25hbHMgYXJlIG9ubHkgbmVlZGVkIHdoZW4gY29vcmRpbmF0aW5nIGNvbXBvc2VkIHZpZXdzLlxuICAgIGlmICghbW9kZWwucGFyZW50KSB7XG4gICAgICByZXR1cm4gc2lnbmFscztcbiAgICB9XG5cbiAgICBjb25zdCBjaGFubmVscyA9IHNlbENtcHQuc2NhbGVzLmZpbHRlcigoY2hhbm5lbCkgPT4ge1xuICAgICAgcmV0dXJuICEoc2lnbmFscy5maWx0ZXIocyA9PiBzLm5hbWUgPT09IGNoYW5uZWxTaWduYWxOYW1lKHNlbENtcHQsIGNoYW5uZWwsICdkYXRhJykpLmxlbmd0aCk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gc2lnbmFscy5jb25jYXQoY2hhbm5lbHMubWFwKChjaGFubmVsKSA9PiB7XG4gICAgICByZXR1cm4ge25hbWU6IGNoYW5uZWxTaWduYWxOYW1lKHNlbENtcHQsIGNoYW5uZWwsICdkYXRhJyl9O1xuICAgIH0pKTtcbiAgfSxcblxuICBzaWduYWxzOiBmdW5jdGlvbihtb2RlbCwgc2VsQ21wdCwgc2lnbmFscykge1xuICAgIC8vIE5lc3RlZCBzaWduYWxzIG5lZWQgb25seSBwdXNoIHRvIHRvcC1sZXZlbCBzaWduYWxzIHdoZW4gd2l0aGluIGNvbXBvc2VkIHZpZXdzLlxuICAgIGlmIChtb2RlbC5wYXJlbnQpIHtcbiAgICAgIHNlbENtcHQuc2NhbGVzLmZvckVhY2goY2hhbm5lbCA9PiB7XG4gICAgICAgIGNvbnN0IHNpZ25hbCA9IHNpZ25hbHMuZmlsdGVyKHMgPT4gcy5uYW1lID09PSBjaGFubmVsU2lnbmFsTmFtZShzZWxDbXB0LCBjaGFubmVsLCAnZGF0YScpKVswXTtcblxuICAgICAgICBzaWduYWwucHVzaCA9ICdvdXRlcic7XG4gICAgICAgIGRlbGV0ZSBzaWduYWwudmFsdWU7XG4gICAgICAgIGRlbGV0ZSBzaWduYWwudXBkYXRlO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHNpZ25hbHM7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IHNjYWxlQmluZGluZ3M7XG5cbmV4cG9ydCBmdW5jdGlvbiBkb21haW4obW9kZWw6IFVuaXRNb2RlbCwgY2hhbm5lbDogQ2hhbm5lbCkge1xuICBjb25zdCBzY2FsZSA9IHN0cmluZ1ZhbHVlKG1vZGVsLnNjYWxlTmFtZShjaGFubmVsKSk7XG4gIHJldHVybiBgZG9tYWluKCR7c2NhbGV9KWA7XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { stringValue } from 'vega-util';\nimport { X, Y } from '../../channel';\nimport { warn } from '../../log';\nimport { hasContinuousDomain, isBinScale } from '../../scale';\nimport { keys } from '../../util';\nimport { channelSignalName, positionalProjections, STORE, TUPLE, unitName, } from './selection';\nimport scales from './transforms/scales';\nexport var BRUSH = '_brush';\nexport var SCALE_TRIGGER = '_scale_trigger';\nvar interval = {\n    predicate: 'vlInterval',\n    scaleDomain: 'vlIntervalDomain',\n    signals: function (model, selCmpt) {\n        var name = selCmpt.name;\n        var hasScales = scales.has(selCmpt);\n        var signals = [];\n        var intervals = [];\n        var tupleTriggers = [];\n        var scaleTriggers = [];\n        if (selCmpt.translate && !hasScales) {\n            var filterExpr_1 = \"!event.item || event.item.mark.name !== \" + stringValue(name + BRUSH);\n            events(selCmpt, function (_, evt) {\n                var filters = evt.between[0].filter || (evt.between[0].filter = []);\n                if (filters.indexOf(filterExpr_1) < 0) {\n                    filters.push(filterExpr_1);\n                }\n            });\n        }\n        selCmpt.project.forEach(function (p) {\n            var channel = p.channel;\n            if (channel !== X && channel !== Y) {\n                warn('Interval selections only support x and y encoding channels.');\n                return;\n            }\n            var cs = channelSignals(model, selCmpt, channel);\n            var dname = channelSignalName(selCmpt, channel, 'data');\n            var vname = channelSignalName(selCmpt, channel, 'visual');\n            var scaleStr = stringValue(model.scaleName(channel));\n            var scaleType = model.getScaleComponent(channel).get('type');\n            var toNum = hasContinuousDomain(scaleType) ? '+' : '';\n            signals.push.apply(signals, cs);\n            tupleTriggers.push(dname);\n            intervals.push(\"{encoding: \" + stringValue(channel) + \", \" +\n                (\"field: \" + stringValue(p.field) + \", extent: \" + dname + \"}\"));\n            scaleTriggers.push({\n                scaleName: model.scaleName(channel),\n                expr: \"(!isArray(\" + dname + \") || \" +\n                    (\"(\" + toNum + \"invert(\" + scaleStr + \", \" + vname + \")[0] === \" + toNum + dname + \"[0] && \") +\n                    (toNum + \"invert(\" + scaleStr + \", \" + vname + \")[1] === \" + toNum + dname + \"[1]))\")\n            });\n        });\n        // Proxy scale reactions to ensure that an infinite loop doesn't occur\n        // when an interval selection filter touches the scale.\n        if (!hasScales) {\n            signals.push({\n                name: name + SCALE_TRIGGER,\n                update: scaleTriggers.map(function (t) { return t.expr; }).join(' && ') +\n                    (\" ? \" + (name + SCALE_TRIGGER) + \" : {}\")\n            });\n        }\n        // Only add an interval to the store if it has valid data extents. Data extents\n        // are set to null if pixel extents are equal to account for intervals over\n        // ordinal/nominal domains which, when inverted, will still produce a valid datum.\n        return signals.concat({\n            name: name + TUPLE,\n            on: [{\n                    events: tupleTriggers.map(function (t) { return ({ signal: t }); }),\n                    update: tupleTriggers.join(' && ') +\n                        (\" ? {unit: \" + unitName(model) + \", intervals: [\" + intervals.join(', ') + \"]} : null\")\n                }]\n        });\n    },\n    modifyExpr: function (model, selCmpt) {\n        var tpl = selCmpt.name + TUPLE;\n        return tpl + ', ' +\n            (selCmpt.resolve === 'global' ? 'true' : \"{unit: \" + unitName(model) + \"}\");\n    },\n    marks: function (model, selCmpt, marks) {\n        var name = selCmpt.name;\n        var _a = positionalProjections(selCmpt), xi = _a.xi, yi = _a.yi;\n        var store = \"data(\" + stringValue(selCmpt.name + STORE) + \")\";\n        // Do not add a brush if we're binding to scales.\n        if (scales.has(selCmpt)) {\n            return marks;\n        }\n        var update = {\n            x: xi !== null ? { signal: name + \"_x[0]\" } : { value: 0 },\n            y: yi !== null ? { signal: name + \"_y[0]\" } : { value: 0 },\n            x2: xi !== null ? { signal: name + \"_x[1]\" } : { field: { group: 'width' } },\n            y2: yi !== null ? { signal: name + \"_y[1]\" } : { field: { group: 'height' } }\n        };\n        // If the selection is resolved to global, only a single interval is in\n        // the store. Wrap brush mark's encodings with a production rule to test\n        // this based on the `unit` property. Hide the brush mark if it corresponds\n        // to a unit different from the one in the store.\n        if (selCmpt.resolve === 'global') {\n            for (var _i = 0, _b = keys(update); _i < _b.length; _i++) {\n                var key = _b[_i];\n                update[key] = [tslib_1.__assign({ test: store + \".length && \" + store + \"[0].unit === \" + unitName(model) }, update[key]), { value: 0 }];\n            }\n        }\n        // Two brush marks ensure that fill colors and other aesthetic choices do\n        // not interefere with the core marks, but that the brushed region can still\n        // be interacted with (e.g., dragging it around).\n        var _c = selCmpt.mark, fill = _c.fill, fillOpacity = _c.fillOpacity, stroke = tslib_1.__rest(_c, [\"fill\", \"fillOpacity\"]);\n        var vgStroke = keys(stroke).reduce(function (def, k) {\n            def[k] = [{\n                    test: [\n                        xi !== null && name + \"_x[0] !== \" + name + \"_x[1]\",\n                        yi != null && name + \"_y[0] !== \" + name + \"_y[1]\",\n                    ].filter(function (x) { return x; }).join(' && '),\n                    value: stroke[k]\n                }, { value: null }];\n            return def;\n        }, {});\n        return [{\n                name: name + BRUSH + '_bg',\n                type: 'rect',\n                clip: true,\n                encode: {\n                    enter: {\n                        fill: { value: fill },\n                        fillOpacity: { value: fillOpacity }\n                    },\n                    update: update\n                }\n            }].concat(marks, {\n            name: name + BRUSH,\n            type: 'rect',\n            clip: true,\n            encode: {\n                enter: {\n                    fill: { value: 'transparent' }\n                },\n                update: tslib_1.__assign({}, update, vgStroke)\n            }\n        });\n    }\n};\nexport default interval;\n/**\n * Returns the visual and data signals for an interval selection.\n */\nfunction channelSignals(model, selCmpt, channel) {\n    var vname = channelSignalName(selCmpt, channel, 'visual');\n    var dname = channelSignalName(selCmpt, channel, 'data');\n    var hasScales = scales.has(selCmpt);\n    var scaleName = model.scaleName(channel);\n    var scaleStr = stringValue(scaleName);\n    var scale = model.getScaleComponent(channel);\n    var scaleType = scale ? scale.get('type') : undefined;\n    var size = model.getSizeSignalRef(channel === X ? 'width' : 'height').signal;\n    var coord = channel + \"(unit)\";\n    var on = events(selCmpt, function (def, evt) {\n        return def.concat({ events: evt.between[0], update: \"[\" + coord + \", \" + coord + \"]\" }, // Brush Start\n        { events: evt, update: \"[\" + vname + \"[0], clamp(\" + coord + \", 0, \" + size + \")]\" } // Brush End\n        );\n    });\n    // React to pan/zooms of continuous scales. Non-continuous scales\n    // (bin-linear, band, point) cannot be pan/zoomed and any other changes\n    // to their domains (e.g., filtering) should clear the brushes.\n    on.push({\n        events: { signal: selCmpt.name + SCALE_TRIGGER },\n        update: hasContinuousDomain(scaleType) && !isBinScale(scaleType) ?\n            \"[scale(\" + scaleStr + \", \" + dname + \"[0]), scale(\" + scaleStr + \", \" + dname + \"[1])]\" : \"[0, 0]\"\n    });\n    return hasScales ? [{ name: dname, on: [] }] : [{\n            name: vname, value: [], on: on\n        }, {\n            name: dname,\n            on: [{ events: { signal: vname }, update: vname + \"[0] === \" + vname + \"[1] ? null : invert(\" + scaleStr + \", \" + vname + \")\" }]\n        }];\n}\nfunction events(selCmpt, cb) {\n    return selCmpt.events.reduce(function (on, evt) {\n        if (!evt.between) {\n            warn(evt + \" is not an ordered event stream for interval selections\");\n            return on;\n        }\n        return cb(on, evt);\n    }, []);\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZXJ2YWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9zZWxlY3Rpb24vaW50ZXJ2YWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBQyxXQUFXLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDdEMsT0FBTyxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDbkMsT0FBTyxFQUFDLElBQUksRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUMvQixPQUFPLEVBQUMsbUJBQW1CLEVBQUUsVUFBVSxFQUFDLE1BQU0sYUFBYSxDQUFDO0FBQzVELE9BQU8sRUFBQyxJQUFJLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFHaEMsT0FBTyxFQUNMLGlCQUFpQixFQUNqQixxQkFBcUIsRUFHckIsS0FBSyxFQUNMLEtBQUssRUFDTCxRQUFRLEdBQ1QsTUFBTSxhQUFhLENBQUM7QUFDckIsT0FBTyxNQUFNLE1BQU0scUJBQXFCLENBQUM7QUFFekMsTUFBTSxDQUFDLElBQU0sS0FBSyxHQUFHLFFBQVEsQ0FBQztBQUM5QixNQUFNLENBQUMsSUFBTSxhQUFhLEdBQUcsZ0JBQWdCLENBQUM7QUFFOUMsSUFBTSxRQUFRLEdBQXFCO0lBQ2pDLFNBQVMsRUFBRSxZQUFZO0lBQ3ZCLFdBQVcsRUFBRSxrQkFBa0I7SUFFL0IsT0FBTyxFQUFFLFVBQVMsS0FBSyxFQUFFLE9BQU87UUFDOUIsSUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQztRQUMxQixJQUFNLFNBQVMsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3RDLElBQU0sT0FBTyxHQUFVLEVBQUUsQ0FBQztRQUMxQixJQUFNLFNBQVMsR0FBVSxFQUFFLENBQUM7UUFDNUIsSUFBTSxhQUFhLEdBQWEsRUFBRSxDQUFDO1FBQ25DLElBQU0sYUFBYSxHQUFVLEVBQUUsQ0FBQztRQUVoQyxJQUFJLE9B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QUFDO0FBRUQsZ0JBQWdCLE9BQTJCLEVBQUUsRUFBWTtJQUN2RCxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLFVBQVMsRUFBUyxFQUFFLEdBQWtCO1FBQ2pFLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFO1lBQ2hCLElBQUksQ0FBSSxHQUFHLDREQUF5RCxDQUFDLENBQUM7WUFDdEUsT0FBTyxFQUFFLENBQUM7U0FDWDtRQUNELE9BQU8sRUFBRSxDQUFDLEVBQUUsRUFBRSxHQUFHLENBQUMsQ0FBQztJQUNyQixDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7QUFDVCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtzdHJpbmdWYWx1ZX0gZnJvbSAndmVnYS11dGlsJztcbmltcG9ydCB7WCwgWX0gZnJvbSAnLi4vLi4vY2hhbm5lbCc7XG5pbXBvcnQge3dhcm59IGZyb20gJy4uLy4uL2xvZyc7XG5pbXBvcnQge2hhc0NvbnRpbnVvdXNEb21haW4sIGlzQmluU2NhbGV9IGZyb20gJy4uLy4uL3NjYWxlJztcbmltcG9ydCB7a2V5c30gZnJvbSAnLi4vLi4vdXRpbCc7XG5pbXBvcnQge1ZnRXZlbnRTdHJlYW19IGZyb20gJy4uLy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7VW5pdE1vZGVsfSBmcm9tICcuLi91bml0JztcbmltcG9ydCB7XG4gIGNoYW5uZWxTaWduYWxOYW1lLFxuICBwb3NpdGlvbmFsUHJvamVjdGlvbnMsXG4gIFNlbGVjdGlvbkNvbXBpbGVyLFxuICBTZWxlY3Rpb25Db21wb25lbnQsXG4gIFNUT1JFLFxuICBUVVBMRSxcbiAgdW5pdE5hbWUsXG59IGZyb20gJy4vc2VsZWN0aW9uJztcbmltcG9ydCBzY2FsZXMgZnJvbSAnLi90cmFuc2Zvcm1zL3NjYWxlcyc7XG5cbmV4cG9ydCBjb25zdCBCUlVTSCA9ICdfYnJ1c2gnO1xuZXhwb3J0IGNvbnN0IFNDQUxFX1RSSUdHRVIgPSAnX3NjYWxlX3RyaWdnZXInO1xuXG5jb25zdCBpbnRlcnZhbDpTZWxlY3Rpb25Db21waWxlciA9IHtcbiAgcHJlZGljYXRlOiAndmxJbnRlcnZhbCcsXG4gIHNjYWxlRG9tYWluOiAndmxJbnRlcnZhbERvbWFpbicsXG5cbiAgc2lnbmFsczogZnVuY3Rpb24obW9kZWwsIHNlbENtcHQpIHtcbiAgICBjb25zdCBuYW1lID0gc2VsQ21wdC5uYW1lO1xuICAgIGNvbnN0IGhhc1NjYWxlcyA9IHNjYWxlcy5oYXMoc2VsQ21wdCk7XG4gICAgY29uc3Qgc2lnbmFsczogYW55W10gPSBbXTtcbiAgICBjb25zdCBpbnRlcnZhbHM6IGFueVtdID0gW107XG4gICAgY29uc3QgdHVwbGVUcmlnZ2Vyczogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCBzY2FsZVRyaWdnZXJzOiBhbnlbXSA9IFtdO1xuXG4gICAgaWYgKHNlbENtcHQudHJhbnNsYXRlICYmICFoYXNTY2FsZXMpIHtcbiAgICAgIGNvbnN0IGZpbHRlckV4cHIgPSBgIWV2ZW50Lml0ZW0gfHwgZXZlbnQuaXRlbS5tYXJrLm5hbWUgIT09ICR7c3RyaW5nVmFsdWUobmFtZSArIEJSVVNIKX1gO1xuICAgICAgZXZlbnRzKHNlbENtcHQsIGZ1bmN0aW9uKF86IGFueVtdLCBldnQ6IFZnRXZlbnRTdHJlYW0pIHtcbiAgICAgICAgY29uc3QgZmlsdGVycyA9IGV2dC5iZXR3ZWVuWzBdLmZpbHRlciB8fCAoZXZ0LmJldHdlZW5bMF0uZmlsdGVyID0gW10pO1xuICAgICAgICBpZiAoZmlsdGVycy5pbmRleE9mKGZpbHRlckV4cHIpIDwgMCkge1xuICAgICAgICAgIGZpbHRlcnMucHVzaChmaWx0ZXJFeHByKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2VsQ21wdC5wcm9qZWN0LmZvckVhY2goZnVuY3Rpb24ocCkge1xuICAgICAgY29uc3QgY2hhbm5lbCA9IHAuY2hhbm5lbDtcbiAgICAgIGlmIChjaGFubmVsICE9PSBYICYmIGNoYW5uZWwgIT09IFkpIHtcbiAgICAgICAgd2FybignSW50ZXJ2YWwgc2VsZWN0aW9ucyBvbmx5IHN1cHBvcnQgeCBhbmQgeSBlbmNvZGluZyBjaGFubmVscy4nKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBjcyA9IGNoYW5uZWxTaWduYWxzKG1vZGVsLCBzZWxDbXB0LCBjaGFubmVsKTtcbiAgICAgIGNvbnN0IGRuYW1lID0gY2hhbm5lbFNpZ25hbE5hbWUoc2VsQ21wdCwgY2hhbm5lbCwgJ2RhdGEnKTtcbiAgICAgIGNvbnN0IHZuYW1lID0gY2hhbm5lbFNpZ25hbE5hbWUoc2VsQ21wdCwgY2hhbm5lbCwgJ3Zpc3VhbCcpO1xuICAgICAgY29uc3Qgc2NhbGVTdHIgPSBzdHJpbmdWYWx1ZShtb2RlbC5zY2FsZU5hbWUoY2hhbm5lbCkpO1xuICAgICAgY29uc3Qgc2NhbGVUeXBlID0gbW9kZWwuZ2V0U2NhbGVDb21wb25lbnQoY2hhbm5lbCkuZ2V0KCd0eXBlJyk7XG4gICAgICBjb25zdCB0b051bSA9IGhhc0NvbnRpbnVvdXNEb21haW4oc2NhbGVUeXBlKSA/ICcrJyA6ICcnO1xuXG4gICAgICBzaWduYWxzLnB1c2guYXBwbHkoc2lnbmFscywgY3MpO1xuICAgICAgdHVwbGVUcmlnZ2Vycy5wdXNoKGRuYW1lKTtcbiAgICAgIGludGVydmFscy5wdXNoKGB7ZW5jb2Rpbmc6ICR7c3RyaW5nVmFsdWUoY2hhbm5lbCl9LCBgICtcbiAgICAgICAgYGZpZWxkOiAke3N0cmluZ1ZhbHVlKHAuZmllbGQpfSwgZXh0ZW50OiAke2RuYW1lfX1gKTtcblxuICAgICAgc2NhbGVUcmlnZ2Vycy5wdXNoKHtcbiAgICAgICAgc2NhbGVOYW1lOiBtb2RlbC5zY2FsZU5hbWUoY2hhbm5lbCksXG4gICAgICAgIGV4cHI6IGAoIWlzQXJyYXkoJHtkbmFtZX0pIHx8IGAgK1xuICAgICAgICAgIGAoJHt0b051bX1pbnZlcnQoJHtzY2FsZVN0cn0sICR7dm5hbWV9KVswXSA9PT0gJHt0b051bX0ke2RuYW1lfVswXSAmJiBgICtcbiAgICAgICAgICAgIGAke3RvTnVtfWludmVydCgke3NjYWxlU3RyfSwgJHt2bmFtZX0pWzFdID09PSAke3RvTnVtfSR7ZG5hbWV9WzFdKSlgXG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIFByb3h5IHNjYWxlIHJlYWN0aW9ucyB0byBlbnN1cmUgdGhhdCBhbiBpbmZpbml0ZSBsb29wIGRvZXNuJ3Qgb2NjdXJcbiAgICAvLyB3aGVuIGFuIGludGVydmFsIHNlbGVjdGlvbiBmaWx0ZXIgdG91Y2hlcyB0aGUgc2NhbGUuXG4gICAgaWYgKCFoYXNTY2FsZXMpIHtcbiAgICAgIHNpZ25hbHMucHVzaCh7XG4gICAgICAgIG5hbWU6IG5hbWUgKyBTQ0FMRV9UUklHR0VSLFxuICAgICAgICB1cGRhdGU6IHNjYWxlVHJpZ2dlcnMubWFwKCh0KSA9PiB0LmV4cHIpLmpvaW4oJyAmJiAnKSArXG4gICAgICAgICAgYCA/ICR7bmFtZSArIFNDQUxFX1RSSUdHRVJ9IDoge31gXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBPbmx5IGFkZCBhbiBpbnRlcnZhbCB0byB0aGUgc3RvcmUgaWYgaXQgaGFzIHZhbGlkIGRhdGEgZXh0ZW50cy4gRGF0YSBleHRlbnRzXG4gICAgLy8gYXJlIHNldCB0byBudWxsIGlmIHBpeGVsIGV4dGVudHMgYXJlIGVxdWFsIHRvIGFjY291bnQgZm9yIGludGVydmFscyBvdmVyXG4gICAgLy8gb3JkaW5hbC9ub21pbmFsIGRvbWFpbnMgd2hpY2gsIHdoZW4gaW52ZXJ0ZWQsIHdpbGwgc3RpbGwgcHJvZHVjZSBhIHZhbGlkIGRhdHVtLlxuICAgIHJldHVybiBzaWduYWxzLmNvbmNhdCh7XG4gICAgICBuYW1lOiBuYW1lICsgVFVQTEUsXG4gICAgICBvbjogW3tcbiAgICAgICAgZXZlbnRzOiB0dXBsZVRyaWdnZXJzLm1hcCgodCkgPT4gKHtzaWduYWw6IHR9KSksXG4gICAgICAgIHVwZGF0ZTogdHVwbGVUcmlnZ2Vycy5qb2luKCcgJiYgJykgK1xuICAgICAgICAgIGAgPyB7dW5pdDogJHt1bml0TmFtZShtb2RlbCl9LCBpbnRlcnZhbHM6IFske2ludGVydmFscy5qb2luKCcsICcpfV19IDogbnVsbGBcbiAgICAgIH1dXG4gICAgfSk7XG4gIH0sXG5cbiAgbW9kaWZ5RXhwcjogZnVuY3Rpb24obW9kZWwsIHNlbENtcHQpIHtcbiAgICBjb25zdCB0cGwgPSBzZWxDbXB0Lm5hbWUgKyBUVVBMRTtcbiAgICByZXR1cm4gdHBsICsgJywgJyArXG4gICAgICAoc2VsQ21wdC5yZXNvbHZlID09PSAnZ2xvYmFsJyA/ICd0cnVlJyA6IGB7dW5pdDogJHt1bml0TmFtZShtb2RlbCl9fWApO1xuICB9LFxuXG4gIG1hcmtzOiBmdW5jdGlvbihtb2RlbCwgc2VsQ21wdCwgbWFya3MpIHtcbiAgICBjb25zdCBuYW1lID0gc2VsQ21wdC5uYW1lO1xuICAgIGNvbnN0IHt4aSwgeWl9ID0gcG9zaXRpb25hbFByb2plY3Rpb25zKHNlbENtcHQpO1xuICAgIGNvbnN0IHN0b3JlID0gYGRhdGEoJHtzdHJpbmdWYWx1ZShzZWxDbXB0Lm5hbWUgKyBTVE9SRSl9KWA7XG5cbiAgICAvLyBEbyBub3QgYWRkIGEgYnJ1c2ggaWYgd2UncmUgYmluZGluZyB0byBzY2FsZXMuXG4gICAgaWYgKHNjYWxlcy5oYXMoc2VsQ21wdCkpIHtcbiAgICAgIHJldHVybiBtYXJrcztcbiAgICB9XG5cbiAgICBjb25zdCB1cGRhdGU6IGFueSA9IHtcbiAgICAgIHg6IHhpICE9PSBudWxsID8ge3NpZ25hbDogYCR7bmFtZX1feFswXWB9IDoge3ZhbHVlOiAwfSxcbiAgICAgIHk6IHlpICE9PSBudWxsID8ge3NpZ25hbDogYCR7bmFtZX1feVswXWB9IDoge3ZhbHVlOiAwfSxcbiAgICAgIHgyOiB4aSAhPT0gbnVsbCA/IHtzaWduYWw6IGAke25hbWV9X3hbMV1gfSA6IHtmaWVsZDoge2dyb3VwOiAnd2lkdGgnfX0sXG4gICAgICB5MjogeWkgIT09IG51bGwgPyB7c2lnbmFsOiBgJHtuYW1lfV95WzFdYH0gOiB7ZmllbGQ6IHtncm91cDogJ2hlaWdodCd9fVxuICAgIH07XG5cbiAgICAvLyBJZiB0aGUgc2VsZWN0aW9uIGlzIHJlc29sdmVkIHRvIGdsb2JhbCwgb25seSBhIHNpbmdsZSBpbnRlcnZhbCBpcyBpblxuICAgIC8vIHRoZSBzdG9yZS4gV3JhcCBicnVzaCBtYXJrJ3MgZW5jb2RpbmdzIHdpdGggYSBwcm9kdWN0aW9uIHJ1bGUgdG8gdGVzdFxuICAgIC8vIHRoaXMgYmFzZWQgb24gdGhlIGB1bml0YCBwcm9wZXJ0eS4gSGlkZSB0aGUgYnJ1c2ggbWFyayBpZiBpdCBjb3JyZXNwb25kc1xuICAgIC8vIHRvIGEgdW5pdCBkaWZmZXJlbnQgZnJvbSB0aGUgb25lIGluIHRoZSBzdG9yZS5cbiAgICBpZiAoc2VsQ21wdC5yZXNvbHZlID09PSAnZ2xvYmFsJykge1xuICAgICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cyh1cGRhdGUpKSB7XG4gICAgICAgIHVwZGF0ZVtrZXldID0gW3tcbiAgICAgICAgICB0ZXN0OiBgJHtzdG9yZX0ubGVuZ3RoICYmICR7c3RvcmV9WzBdLnVuaXQgPT09ICR7dW5pdE5hbWUobW9kZWwpfWAsXG4gICAgICAgICAgLi4udXBkYXRlW2tleV1cbiAgICAgICAgfSwge3ZhbHVlOiAwfV07XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gVHdvIGJydXNoIG1hcmtzIGVuc3VyZSB0aGF0IGZpbGwgY29sb3JzIGFuZCBvdGhlciBhZXN0aGV0aWMgY2hvaWNlcyBkb1xuICAgIC8vIG5vdCBpbnRlcmVmZXJlIHdpdGggdGhlIGNvcmUgbWFya3MsIGJ1dCB0aGF0IHRoZSBicnVzaGVkIHJlZ2lvbiBjYW4gc3RpbGxcbiAgICAvLyBiZSBpbnRlcmFjdGVkIHdpdGggKGUuZy4sIGRyYWdnaW5nIGl0IGFyb3VuZCkuXG4gICAgY29uc3Qge2ZpbGwsIGZpbGxPcGFjaXR5LCAuLi5zdHJva2V9ID0gc2VsQ21wdC5tYXJrO1xuICAgIGNvbnN0IHZnU3Ryb2tlID0ga2V5cyhzdHJva2UpLnJlZHVjZSgoZGVmLCBrKSA9PiB7XG4gICAgICBkZWZba10gPSBbe1xuICAgICAgICB0ZXN0OiBbXG4gICAgICAgICAgeGkgIT09IG51bGwgJiYgYCR7bmFtZX1feFswXSAhPT0gJHtuYW1lfV94WzFdYCxcbiAgICAgICAgICB5aSAhPSBudWxsICYmIGAke25hbWV9X3lbMF0gIT09ICR7bmFtZX1feVsxXWAsXG4gICAgICAgIF0uZmlsdGVyKHggPT4geCkuam9pbignICYmICcpLFxuICAgICAgICB2YWx1ZTogc3Ryb2tlW2tdXG4gICAgICB9LCB7dmFsdWU6IG51bGx9XTtcbiAgICAgIHJldHVybiBkZWY7XG4gICAgfSwge30pO1xuXG4gICAgcmV0dXJuIFt7XG4gICAgICBuYW1lOiBuYW1lICsgQlJVU0ggKyAnX2JnJyxcbiAgICAgIHR5cGU6ICdyZWN0JyxcbiAgICAgIGNsaXA6IHRydWUsXG4gICAgICBlbmNvZGU6IHtcbiAgICAgICAgZW50ZXI6IHtcbiAgICAgICAgICBmaWxsOiB7dmFsdWU6IGZpbGx9LFxuICAgICAgICAgIGZpbGxPcGFjaXR5OiB7dmFsdWU6IGZpbGxPcGFjaXR5fVxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGU6IHVwZGF0ZVxuICAgICAgfVxuICAgIH0gYXMgYW55XS5jb25jYXQobWFya3MsIHtcbiAgICAgIG5hbWU6IG5hbWUgKyBCUlVTSCxcbiAgICAgIHR5cGU6ICdyZWN0JyxcbiAgICAgIGNsaXA6IHRydWUsXG4gICAgICBlbmNvZGU6IHtcbiAgICAgICAgZW50ZXI6IHtcbiAgICAgICAgICBmaWxsOiB7dmFsdWU6ICd0cmFuc3BhcmVudCd9XG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZTogey4uLnVwZGF0ZSwgLi4udmdTdHJva2V9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn07XG5leHBvcnQgZGVmYXVsdCBpbnRlcnZhbDtcblxuLyoqXG4gKiBSZXR1cm5zIHRoZSB2aXN1YWwgYW5kIGRhdGEgc2lnbmFscyBmb3IgYW4gaW50ZXJ2YWwgc2VsZWN0aW9uLlxuICovXG5mdW5jdGlvbiBjaGFubmVsU2lnbmFscyhtb2RlbDogVW5pdE1vZGVsLCBzZWxDbXB0OiBTZWxlY3Rpb25Db21wb25lbnQsIGNoYW5uZWw6ICd4J3wneScpOiBhbnkge1xuICBjb25zdCB2bmFtZSA9IGNoYW5uZWxTaWduYWxOYW1lKHNlbENtcHQsIGNoYW5uZWwsICd2aXN1YWwnKTtcbiAgY29uc3QgZG5hbWUgPSBjaGFubmVsU2lnbmFsTmFtZShzZWxDbXB0LCBjaGFubmVsLCAnZGF0YScpO1xuICBjb25zdCBoYXNTY2FsZXMgPSBzY2FsZXMuaGFzKHNlbENtcHQpO1xuICBjb25zdCBzY2FsZU5hbWUgPSBtb2RlbC5zY2FsZU5hbWUoY2hhbm5lbCk7XG4gIGNvbnN0IHNjYWxlU3RyID0gc3RyaW5nVmFsdWUoc2NhbGVOYW1lKTtcbiAgY29uc3Qgc2NhbGUgPSBtb2RlbC5nZXRTY2FsZUNvbXBvbmVudChjaGFubmVsKTtcbiAgY29uc3Qgc2NhbGVUeXBlID0gc2NhbGUgPyBzY2FsZS5nZXQoJ3R5cGUnKSA6IHVuZGVmaW5lZDtcbiAgY29uc3Qgc2l6ZSA9IG1vZGVsLmdldFNpemVTaWduYWxSZWYoY2hhbm5lbCA9PT0gWCA/ICd3aWR0aCcgOiAnaGVpZ2h0Jykuc2lnbmFsO1xuICBjb25zdCBjb29yZCA9IGAke2NoYW5uZWx9KHVuaXQpYDtcblxuICBjb25zdCBvbiA9IGV2ZW50cyhzZWxDbXB0LCBmdW5jdGlvbihkZWY6IGFueVtdLCBldnQ6IFZnRXZlbnRTdHJlYW0pIHtcbiAgICByZXR1cm4gZGVmLmNvbmNhdChcbiAgICAgIHtldmVudHM6IGV2dC5iZXR3ZWVuWzBdLCB1cGRhdGU6IGBbJHtjb29yZH0sICR7Y29vcmR9XWB9LCAgICAgICAgICAgLy8gQnJ1c2ggU3RhcnRcbiAgICAgIHtldmVudHM6IGV2dCwgdXBkYXRlOiBgWyR7dm5hbWV9WzBdLCBjbGFtcCgke2Nvb3JkfSwgMCwgJHtzaXplfSldYH0gLy8gQnJ1c2ggRW5kXG4gICAgKTtcbiAgfSk7XG5cbiAgLy8gUmVhY3QgdG8gcGFuL3pvb21zIG9mIGNvbnRpbnVvdXMgc2NhbGVzLiBOb24tY29udGludW91cyBzY2FsZXNcbiAgLy8gKGJpbi1saW5lYXIsIGJhbmQsIHBvaW50KSBjYW5ub3QgYmUgcGFuL3pvb21lZCBhbmQgYW55IG90aGVyIGNoYW5nZXNcbiAgLy8gdG8gdGhlaXIgZG9tYWlucyAoZS5nLiwgZmlsdGVyaW5nKSBzaG91bGQgY2xlYXIgdGhlIGJydXNoZXMuXG4gIG9uLnB1c2goe1xuICAgIGV2ZW50czoge3NpZ25hbDogc2VsQ21wdC5uYW1lICsgU0NBTEVfVFJJR0dFUn0sXG4gICAgdXBkYXRlOiBoYXNDb250aW51b3VzRG9tYWluKHNjYWxlVHlwZSkgJiYgIWlzQmluU2NhbGUoc2NhbGVUeXBlKSA/XG4gICAgICBgW3NjYWxlKCR7c2NhbGVTdHJ9LCAke2RuYW1lfVswXSksIHNjYWxlKCR7c2NhbGVTdHJ9LCAke2RuYW1lfVsxXSldYCA6IGBbMCwgMF1gXG4gIH0pO1xuXG4gIHJldHVybiBoYXNTY2FsZXMgPyBbe25hbWU6IGRuYW1lLCBvbjogW119XSA6IFt7XG4gICAgbmFtZTogdm5hbWUsIHZhbHVlOiBbXSwgb246IG9uXG4gIH0sIHtcbiAgICBuYW1lOiBkbmFtZSxcbiAgICBvbjogW3tldmVudHM6IHtzaWduYWw6IHZuYW1lfSwgdXBkYXRlOiBgJHt2bmFtZX1bMF0gPT09ICR7dm5hbWV9WzFdID8gbnVsbCA6IGludmVydCgke3NjYWxlU3RyfSwgJHt2bmFtZX0pYH1dXG4gIH1dO1xufVxuXG5mdW5jdGlvbiBldmVudHMoc2VsQ21wdDogU2VsZWN0aW9uQ29tcG9uZW50LCBjYjogRnVuY3Rpb24pIHtcbiAgcmV0dXJuIHNlbENtcHQuZXZlbnRzLnJlZHVjZShmdW5jdGlvbihvbjogYW55W10sIGV2dDogVmdFdmVudFN0cmVhbSkge1xuICAgIGlmICghZXZ0LmJldHdlZW4pIHtcbiAgICAgIHdhcm4oYCR7ZXZ0fSBpcyBub3QgYW4gb3JkZXJlZCBldmVudCBzdHJlYW0gZm9yIGludGVydmFsIHNlbGVjdGlvbnNgKTtcbiAgICAgIHJldHVybiBvbjtcbiAgICB9XG4gICAgcmV0dXJuIGNiKG9uLCBldnQpO1xuICB9LCBbXSk7XG59XG4iXX0=","import * as log from '../../../log';\nimport { isPathMark } from '../../../mark';\nimport { positionalProjections } from '../selection';\nvar VORONOI = 'voronoi';\nvar nearest = {\n    has: function (selCmpt) {\n        return selCmpt.type !== 'interval' && selCmpt.nearest;\n    },\n    marks: function (model, selCmpt, marks) {\n        var _a = positionalProjections(selCmpt), x = _a.x, y = _a.y;\n        var markType = model.mark;\n        if (isPathMark(markType)) {\n            log.warn(log.message.nearestNotSupportForContinuous(markType));\n            return marks;\n        }\n        var cellDef = {\n            name: model.getName(VORONOI),\n            type: 'path',\n            from: { data: model.getName('marks') },\n            encode: {\n                enter: {\n                    fill: { value: 'transparent' },\n                    strokeWidth: { value: 0.35 },\n                    stroke: { value: 'transparent' },\n                    isVoronoi: { value: true }\n                }\n            },\n            transform: [{\n                    type: 'voronoi',\n                    x: { expr: (x || (!x && !y)) ? 'datum.datum.x || 0' : '0' },\n                    y: { expr: (y || (!x && !y)) ? 'datum.datum.y || 0' : '0' },\n                    size: [model.getSizeSignalRef('width'), model.getSizeSignalRef('height')]\n                }]\n        };\n        var index = 0;\n        var exists = false;\n        marks.forEach(function (mark, i) {\n            var name = mark.name || '';\n            if (name === model.component.mark[0].name) {\n                index = i;\n            }\n            else if (name.indexOf(VORONOI) >= 0) {\n                exists = true;\n            }\n        });\n        if (!exists) {\n            marks.splice(index + 1, 0, cellDef);\n        }\n        return marks;\n    }\n};\nexport default nearest;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmVhcmVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9jb21waWxlL3NlbGVjdGlvbi90cmFuc2Zvcm1zL25lYXJlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxLQUFLLEdBQUcsTUFBTSxjQUFjLENBQUM7QUFDcEMsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUN6QyxPQUFPLEVBQUMscUJBQXFCLEVBQUMsTUFBTSxjQUFjLENBQUM7QUFHbkQsSUFBTSxPQUFPLEdBQUcsU0FBUyxDQUFDO0FBRTFCLElBQU0sT0FBTyxHQUFxQjtJQUNoQyxHQUFHLEVBQUUsVUFBUyxPQUFPO1FBQ25CLE9BQU8sT0FBTyxDQUFDLElBQUksS0FBSyxVQUFVLElBQUksT0FBTyxDQUFDLE9BQU8sQ0FBQztJQUN4RCxDQUFDO0lBRUQsS0FBSyxFQUFFLFVBQVMsS0FBSyxFQUFFLE9BQU8sRUFBRSxLQUFLO1FBQzdCLElBQUEsbUNBQXVDLEVBQXRDLFFBQUMsRUFBRSxRQUFDLENBQW1DO1FBQzlDLElBQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUM7UUFDNUIsSUFBSSxVQUFVLENBQUMsUUFBUSxDQUFDLEVBQUU7WUFDeEIsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLDhCQUE4QixDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7WUFDL0QsT0FBTyxLQUFLLENBQUM7U0FDZDtRQUVELElBQU0sT0FBTyxHQUFHO1lBQ2QsSUFBSSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDO1lBQzVCLElBQUksRUFBRSxNQUFNO1lBQ1osSUFBSSxFQUFFLEVBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUM7WUFDcEMsTUFBTSxFQUFFO2dCQUNOLEtBQUssRUFBRTtvQkFDTCxJQUFJLEVBQUUsRUFBQyxLQUFLLEVBQUUsYUFBYSxFQUFDO29CQUM1QixXQUFXLEVBQUUsRUFBQyxLQUFLLEVBQUUsSUFBSSxFQUFDO29CQUMxQixNQUFNLEVBQUUsRUFBQyxLQUFLLEVBQUUsYUFBYSxFQUFDO29CQUM5QixTQUFTLEVBQUUsRUFBQyxLQUFLLEVBQUUsSUFBSSxFQUFDO2lCQUN6QjthQUNGO1lBQ0QsU0FBUyxFQUFFLENBQUM7b0JBQ1YsSUFBSSxFQUFFLFNBQVM7b0JBQ2YsQ0FBQyxFQUFFLEVBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsR0FBRyxFQUFDO29CQUN6RCxDQUFDLEVBQUUsRUFBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLG9CQUFvQixDQUFDLENBQUMsQ0FBQyxHQUFHLEVBQUM7b0JBQ3pELElBQUksRUFBRSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsRUFBRSxLQUFLLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLENBQUM7aUJBQzFFLENBQUM7U0FDSCxDQUFDO1FBRUYsSUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDO1FBQ2QsSUFBSSxNQUFNLEdBQUcsS0FBSyxDQUFDO1FBQ25CLEtBQUssQ0FBQyxPQUFPLENBQUMsVUFBQyxJQUFJLEVBQUUsQ0FBQztZQUNwQixJQUFNLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxJQUFJLEVBQUUsQ0FBQztZQUM3QixJQUFJLElBQUksS0FBSyxLQUFLLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUU7Z0JBQ3pDLEtBQUssR0FBRyxDQUFDLENBQUM7YUFDWDtpQkFBTSxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO2dCQUNyQyxNQUFNLEdBQUcsSUFBSSxDQUFDO2FBQ2Y7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxNQUFNLEVBQUU7WUFDWCxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1NBQ3JDO1FBRUQsT0FBTyxLQUFLLENBQUM7SUFDZixDQUFDO0NBQ0YsQ0FBQztBQUVGLGVBQWUsT0FBTyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgbG9nIGZyb20gJy4uLy4uLy4uL2xvZyc7XG5pbXBvcnQge2lzUGF0aE1hcmt9IGZyb20gJy4uLy4uLy4uL21hcmsnO1xuaW1wb3J0IHtwb3NpdGlvbmFsUHJvamVjdGlvbnN9IGZyb20gJy4uL3NlbGVjdGlvbic7XG5pbXBvcnQge1RyYW5zZm9ybUNvbXBpbGVyfSBmcm9tICcuL3RyYW5zZm9ybXMnO1xuXG5jb25zdCBWT1JPTk9JID0gJ3Zvcm9ub2knO1xuXG5jb25zdCBuZWFyZXN0OlRyYW5zZm9ybUNvbXBpbGVyID0ge1xuICBoYXM6IGZ1bmN0aW9uKHNlbENtcHQpIHtcbiAgICByZXR1cm4gc2VsQ21wdC50eXBlICE9PSAnaW50ZXJ2YWwnICYmIHNlbENtcHQubmVhcmVzdDtcbiAgfSxcblxuICBtYXJrczogZnVuY3Rpb24obW9kZWwsIHNlbENtcHQsIG1hcmtzKSB7XG4gICAgY29uc3Qge3gsIHl9ID0gcG9zaXRpb25hbFByb2plY3Rpb25zKHNlbENtcHQpO1xuICAgIGNvbnN0IG1hcmtUeXBlID0gbW9kZWwubWFyaztcbiAgICBpZiAoaXNQYXRoTWFyayhtYXJrVHlwZSkpIHtcbiAgICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLm5lYXJlc3ROb3RTdXBwb3J0Rm9yQ29udGludW91cyhtYXJrVHlwZSkpO1xuICAgICAgcmV0dXJuIG1hcmtzO1xuICAgIH1cblxuICAgIGNvbnN0IGNlbGxEZWYgPSB7XG4gICAgICBuYW1lOiBtb2RlbC5nZXROYW1lKFZPUk9OT0kpLFxuICAgICAgdHlwZTogJ3BhdGgnLFxuICAgICAgZnJvbToge2RhdGE6IG1vZGVsLmdldE5hbWUoJ21hcmtzJyl9LFxuICAgICAgZW5jb2RlOiB7XG4gICAgICAgIGVudGVyOiB7XG4gICAgICAgICAgZmlsbDoge3ZhbHVlOiAndHJhbnNwYXJlbnQnfSxcbiAgICAgICAgICBzdHJva2VXaWR0aDoge3ZhbHVlOiAwLjM1fSxcbiAgICAgICAgICBzdHJva2U6IHt2YWx1ZTogJ3RyYW5zcGFyZW50J30sXG4gICAgICAgICAgaXNWb3Jvbm9pOiB7dmFsdWU6IHRydWV9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB0cmFuc2Zvcm06IFt7XG4gICAgICAgIHR5cGU6ICd2b3Jvbm9pJyxcbiAgICAgICAgeDoge2V4cHI6ICh4IHx8ICgheCAmJiAheSkpID8gJ2RhdHVtLmRhdHVtLnggfHwgMCcgOiAnMCd9LFxuICAgICAgICB5OiB7ZXhwcjogKHkgfHwgKCF4ICYmICF5KSkgPyAnZGF0dW0uZGF0dW0ueSB8fCAwJyA6ICcwJ30sXG4gICAgICAgIHNpemU6IFttb2RlbC5nZXRTaXplU2lnbmFsUmVmKCd3aWR0aCcpLCBtb2RlbC5nZXRTaXplU2lnbmFsUmVmKCdoZWlnaHQnKV1cbiAgICAgIH1dXG4gICAgfTtcblxuICAgIGxldCBpbmRleCA9IDA7XG4gICAgbGV0IGV4aXN0cyA9IGZhbHNlO1xuICAgIG1hcmtzLmZvckVhY2goKG1hcmssIGkpID0+IHtcbiAgICAgIGNvbnN0IG5hbWUgPSBtYXJrLm5hbWUgfHwgJyc7XG4gICAgICBpZiAobmFtZSA9PT0gbW9kZWwuY29tcG9uZW50Lm1hcmtbMF0ubmFtZSkge1xuICAgICAgICBpbmRleCA9IGk7XG4gICAgICB9IGVsc2UgaWYgKG5hbWUuaW5kZXhPZihWT1JPTk9JKSA+PSAwKSB7XG4gICAgICAgIGV4aXN0cyA9IHRydWU7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAoIWV4aXN0cykge1xuICAgICAgbWFya3Muc3BsaWNlKGluZGV4ICsgMSwgMCwgY2VsbERlZik7XG4gICAgfVxuXG4gICAgcmV0dXJuIG1hcmtzO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBuZWFyZXN0O1xuIl19","import { stringValue } from 'vega-util';\nimport { accessPathWithDatum } from '../../util';\nimport { TUPLE, unitName } from './selection';\nimport nearest from './transforms/nearest';\nexport function signals(model, selCmpt) {\n    var proj = selCmpt.project;\n    var datum = nearest.has(selCmpt) ?\n        '(item().isVoronoi ? datum.datum : datum)' : 'datum';\n    var bins = [];\n    var encodings = proj.map(function (p) { return stringValue(p.channel); }).filter(function (e) { return e; }).join(', ');\n    var fields = proj.map(function (p) { return stringValue(p.field); }).join(', ');\n    var values = proj.map(function (p) {\n        var channel = p.channel;\n        var fieldDef = model.fieldDef(channel);\n        // Binned fields should capture extents, for a range test against the raw field.\n        return (fieldDef && fieldDef.bin) ? (bins.push(p.field),\n            \"[\" + accessPathWithDatum(model.vgField(channel, {}), datum) + \", \" +\n                (accessPathWithDatum(model.vgField(channel, { binSuffix: 'end' }), datum) + \"]\")) :\n            \"\" + accessPathWithDatum(p.field, datum);\n    }).join(', ');\n    // Only add a discrete selection to the store if a datum is present _and_\n    // the interaction isn't occurring on a group mark. This guards against\n    // polluting interactive state with invalid values in faceted displays\n    // as the group marks are also data-driven. We force the update to account\n    // for constant null states but varying toggles (e.g., shift-click in\n    // whitespace followed by a click in whitespace; the store should only\n    // be cleared on the second click).\n    return [{\n            name: selCmpt.name + TUPLE,\n            value: {},\n            on: [{\n                    events: selCmpt.events,\n                    update: \"datum && item().mark.marktype !== 'group' ? \" +\n                        (\"{unit: \" + unitName(model) + \", encodings: [\" + encodings + \"], \") +\n                        (\"fields: [\" + fields + \"], values: [\" + values + \"]\") +\n                        (bins.length ? ', ' + bins.map(function (b) { return stringValue('bin_' + b) + \": 1\"; }).join(', ') : '') +\n                        '} : null',\n                    force: true\n                }]\n        }];\n}\nvar multi = {\n    predicate: 'vlMulti',\n    scaleDomain: 'vlMultiDomain',\n    signals: signals,\n    modifyExpr: function (model, selCmpt) {\n        var tpl = selCmpt.name + TUPLE;\n        return tpl + ', ' +\n            (selCmpt.resolve === 'global' ? 'null' : \"{unit: \" + unitName(model) + \"}\");\n    }\n};\nexport default multi;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXVsdGkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9zZWxlY3Rpb24vbXVsdGkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFDLFdBQVcsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUV0QyxPQUFPLEVBQUMsbUJBQW1CLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFFL0MsT0FBTyxFQUF3QyxLQUFLLEVBQUUsUUFBUSxFQUFDLE1BQU0sYUFBYSxDQUFDO0FBQ25GLE9BQU8sT0FBTyxNQUFNLHNCQUFzQixDQUFDO0FBRTNDLE1BQU0sa0JBQWtCLEtBQWdCLEVBQUUsT0FBMkI7SUFDbkUsSUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQztJQUM3QixJQUFNLEtBQUssR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDbEMsMENBQTBDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQztJQUN2RCxJQUFNLElBQUksR0FBYSxFQUFFLENBQUM7SUFDMUIsSUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxVQUFDLENBQUMsSUFBSyxPQUFBLFdBQVcsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQXRCLENBQXNCLENBQUMsQ0FBQyxNQUFNLENBQUMsVUFBQyxDQUFDLElBQUssT0FBQSxDQUFDLEVBQUQsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3RGLElBQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBQyxDQUFDLElBQUssT0FBQSxXQUFXLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxFQUFwQixDQUFvQixDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2hFLElBQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBQyxDQUFDO1FBQ3hCLElBQU0sT0FBTyxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUM7UUFDMUIsSUFBTSxRQUFRLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUN6QyxnRkFBZ0Y7UUFDaEYsT0FBTyxDQUFDLFFBQVEsSUFBSSxRQUFRLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDO1lBQ3JELE1BQUksbUJBQW1CLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsRUFBRSxDQUFDLEVBQUUsS0FBSyxDQUFDLE9BQUk7aUJBQ3ZELG1CQUFtQixDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLEVBQUMsU0FBUyxFQUFFLEtBQUssRUFBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLE1BQUcsQ0FBQSxDQUFDLENBQUMsQ0FBQztZQUNuRixLQUFHLG1CQUFtQixDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFHLENBQUM7SUFDN0MsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBRWQseUVBQXlFO0lBQ3pFLHVFQUF1RTtJQUN2RSxzRUFBc0U7SUFDdEUsMEVBQTBFO0lBQzFFLHFFQUFxRTtJQUNyRSxzRUFBc0U7SUFDdEUsbUNBQW1DO0lBQ25DLE9BQU8sQ0FBQztZQUNOLElBQUksRUFBRSxPQUFPLENBQUMsSUFBSSxHQUFHLEtBQUs7WUFDMUIsS0FBSyxFQUFFLEVBQUU7WUFDVCxFQUFFLEVBQUUsQ0FBQztvQkFDSCxNQUFNLEVBQUUsT0FBTyxDQUFDLE1BQU07b0JBQ3RCLE1BQU0sRUFBRSw4Q0FBOEM7eUJBQ3BELFlBQVUsUUFBUSxDQUFDLEtBQUssQ0FBQyxzQkFBaUIsU0FBUyxRQUFLLENBQUE7eUJBQ3hELGNBQVksTUFBTSxvQkFBZSxNQUFNLE1BQUcsQ0FBQTt3QkFDMUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLEdBQUcsQ0FBQyxVQUFDLENBQUMsSUFBSyxPQUFHLFdBQVcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLFFBQUssRUFBL0IsQ0FBK0IsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO3dCQUN2RixVQUFVO29CQUNaLEtBQUssRUFBRSxJQUFJO2lCQUNaLENBQUM7U0FDSCxDQUFDLENBQUM7QUFDTCxDQUFDO0FBRUQsSUFBTSxLQUFLLEdBQXFCO0lBQzlCLFNBQVMsRUFBRSxTQUFTO0lBQ3BCLFdBQVcsRUFBRSxlQUFlO0lBRTVCLE9BQU8sRUFBRSxPQUFPO0lBRWhCLFVBQVUsRUFBRSxVQUFTLEtBQUssRUFBRSxPQUFPO1FBQ2pDLElBQU0sR0FBRyxHQUFHLE9BQU8sQ0FBQyxJQUFJLEdBQUcsS0FBSyxDQUFDO1FBQ2pDLE9BQU8sR0FBRyxHQUFHLElBQUk7WUFDZixDQUFDLE9BQU8sQ0FBQyxPQUFPLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLFlBQVUsUUFBUSxDQUFDLEtBQUssQ0FBQyxNQUFHLENBQUMsQ0FBQztJQUMzRSxDQUFDO0NBQ0YsQ0FBQztBQUVGLGVBQWUsS0FBSyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtzdHJpbmdWYWx1ZX0gZnJvbSAndmVnYS11dGlsJztcblxuaW1wb3J0IHthY2Nlc3NQYXRoV2l0aERhdHVtfSBmcm9tICcuLi8uLi91dGlsJztcbmltcG9ydCB7VW5pdE1vZGVsfSBmcm9tICcuLi91bml0JztcbmltcG9ydCB7U2VsZWN0aW9uQ29tcGlsZXIsIFNlbGVjdGlvbkNvbXBvbmVudCwgVFVQTEUsIHVuaXROYW1lfSBmcm9tICcuL3NlbGVjdGlvbic7XG5pbXBvcnQgbmVhcmVzdCBmcm9tICcuL3RyYW5zZm9ybXMvbmVhcmVzdCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBzaWduYWxzKG1vZGVsOiBVbml0TW9kZWwsIHNlbENtcHQ6IFNlbGVjdGlvbkNvbXBvbmVudCkge1xuICBjb25zdCBwcm9qID0gc2VsQ21wdC5wcm9qZWN0O1xuICBjb25zdCBkYXR1bSA9IG5lYXJlc3QuaGFzKHNlbENtcHQpID9cbiAgICAnKGl0ZW0oKS5pc1Zvcm9ub2kgPyBkYXR1bS5kYXR1bSA6IGRhdHVtKScgOiAnZGF0dW0nO1xuICBjb25zdCBiaW5zOiBzdHJpbmdbXSA9IFtdO1xuICBjb25zdCBlbmNvZGluZ3MgPSBwcm9qLm1hcCgocCkgPT4gc3RyaW5nVmFsdWUocC5jaGFubmVsKSkuZmlsdGVyKChlKSA9PiBlKS5qb2luKCcsICcpO1xuICBjb25zdCBmaWVsZHMgPSBwcm9qLm1hcCgocCkgPT4gc3RyaW5nVmFsdWUocC5maWVsZCkpLmpvaW4oJywgJyk7XG4gIGNvbnN0IHZhbHVlcyA9IHByb2oubWFwKChwKSA9PiB7XG4gICAgY29uc3QgY2hhbm5lbCA9IHAuY2hhbm5lbDtcbiAgICBjb25zdCBmaWVsZERlZiA9IG1vZGVsLmZpZWxkRGVmKGNoYW5uZWwpO1xuICAgIC8vIEJpbm5lZCBmaWVsZHMgc2hvdWxkIGNhcHR1cmUgZXh0ZW50cywgZm9yIGEgcmFuZ2UgdGVzdCBhZ2FpbnN0IHRoZSByYXcgZmllbGQuXG4gICAgcmV0dXJuIChmaWVsZERlZiAmJiBmaWVsZERlZi5iaW4pID8gKGJpbnMucHVzaChwLmZpZWxkKSxcbiAgICAgIGBbJHthY2Nlc3NQYXRoV2l0aERhdHVtKG1vZGVsLnZnRmllbGQoY2hhbm5lbCwge30pLCBkYXR1bSl9LCBgICtcbiAgICAgICAgICBgJHthY2Nlc3NQYXRoV2l0aERhdHVtKG1vZGVsLnZnRmllbGQoY2hhbm5lbCwge2JpblN1ZmZpeDogJ2VuZCd9KSwgZGF0dW0pfV1gKSA6XG4gICAgICBgJHthY2Nlc3NQYXRoV2l0aERhdHVtKHAuZmllbGQsIGRhdHVtKX1gO1xuICB9KS5qb2luKCcsICcpO1xuXG4gIC8vIE9ubHkgYWRkIGEgZGlzY3JldGUgc2VsZWN0aW9uIHRvIHRoZSBzdG9yZSBpZiBhIGRhdHVtIGlzIHByZXNlbnQgX2FuZF9cbiAgLy8gdGhlIGludGVyYWN0aW9uIGlzbid0IG9jY3VycmluZyBvbiBhIGdyb3VwIG1hcmsuIFRoaXMgZ3VhcmRzIGFnYWluc3RcbiAgLy8gcG9sbHV0aW5nIGludGVyYWN0aXZlIHN0YXRlIHdpdGggaW52YWxpZCB2YWx1ZXMgaW4gZmFjZXRlZCBkaXNwbGF5c1xuICAvLyBhcyB0aGUgZ3JvdXAgbWFya3MgYXJlIGFsc28gZGF0YS1kcml2ZW4uIFdlIGZvcmNlIHRoZSB1cGRhdGUgdG8gYWNjb3VudFxuICAvLyBmb3IgY29uc3RhbnQgbnVsbCBzdGF0ZXMgYnV0IHZhcnlpbmcgdG9nZ2xlcyAoZS5nLiwgc2hpZnQtY2xpY2sgaW5cbiAgLy8gd2hpdGVzcGFjZSBmb2xsb3dlZCBieSBhIGNsaWNrIGluIHdoaXRlc3BhY2U7IHRoZSBzdG9yZSBzaG91bGQgb25seVxuICAvLyBiZSBjbGVhcmVkIG9uIHRoZSBzZWNvbmQgY2xpY2spLlxuICByZXR1cm4gW3tcbiAgICBuYW1lOiBzZWxDbXB0Lm5hbWUgKyBUVVBMRSxcbiAgICB2YWx1ZToge30sXG4gICAgb246IFt7XG4gICAgICBldmVudHM6IHNlbENtcHQuZXZlbnRzLFxuICAgICAgdXBkYXRlOiBgZGF0dW0gJiYgaXRlbSgpLm1hcmsubWFya3R5cGUgIT09ICdncm91cCcgPyBgICtcbiAgICAgICAgYHt1bml0OiAke3VuaXROYW1lKG1vZGVsKX0sIGVuY29kaW5nczogWyR7ZW5jb2RpbmdzfV0sIGAgK1xuICAgICAgICBgZmllbGRzOiBbJHtmaWVsZHN9XSwgdmFsdWVzOiBbJHt2YWx1ZXN9XWAgK1xuICAgICAgICAoYmlucy5sZW5ndGggPyAnLCAnICsgYmlucy5tYXAoKGIpID0+IGAke3N0cmluZ1ZhbHVlKCdiaW5fJyArIGIpfTogMWApLmpvaW4oJywgJykgOiAnJykgK1xuICAgICAgICAnfSA6IG51bGwnLFxuICAgICAgZm9yY2U6IHRydWVcbiAgICB9XVxuICB9XTtcbn1cblxuY29uc3QgbXVsdGk6U2VsZWN0aW9uQ29tcGlsZXIgPSB7XG4gIHByZWRpY2F0ZTogJ3ZsTXVsdGknLFxuICBzY2FsZURvbWFpbjogJ3ZsTXVsdGlEb21haW4nLFxuXG4gIHNpZ25hbHM6IHNpZ25hbHMsXG5cbiAgbW9kaWZ5RXhwcjogZnVuY3Rpb24obW9kZWwsIHNlbENtcHQpIHtcbiAgICBjb25zdCB0cGwgPSBzZWxDbXB0Lm5hbWUgKyBUVVBMRTtcbiAgICByZXR1cm4gdHBsICsgJywgJyArXG4gICAgICAoc2VsQ21wdC5yZXNvbHZlID09PSAnZ2xvYmFsJyA/ICdudWxsJyA6IGB7dW5pdDogJHt1bml0TmFtZShtb2RlbCl9fWApO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBtdWx0aTtcbiJdfQ==","import { stringValue } from 'vega-util';\nimport { signals as multiSignals } from './multi';\nimport { STORE, TUPLE, unitName } from './selection';\nvar single = {\n    predicate: 'vlSingle',\n    scaleDomain: 'vlSingleDomain',\n    signals: multiSignals,\n    topLevelSignals: function (model, selCmpt, signals) {\n        var hasSignal = signals.filter(function (s) { return s.name === selCmpt.name; });\n        var data = \"data(\" + stringValue(selCmpt.name + STORE) + \")\";\n        var values = data + \"[0].values\";\n        return hasSignal.length ? signals : signals.concat({\n            name: selCmpt.name,\n            update: data + \".length && {\" +\n                selCmpt.project.map(function (p, i) { return p.field + \": \" + values + \"[\" + i + \"]\"; }).join(', ') + '}'\n        });\n    },\n    modifyExpr: function (model, selCmpt) {\n        var tpl = selCmpt.name + TUPLE;\n        return tpl + ', ' +\n            (selCmpt.resolve === 'global' ? 'true' : \"{unit: \" + unitName(model) + \"}\");\n    }\n};\nexport default single;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2luZ2xlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvc2VsZWN0aW9uL3NpbmdsZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsV0FBVyxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBRXRDLE9BQU8sRUFBQyxPQUFPLElBQUksWUFBWSxFQUFDLE1BQU0sU0FBUyxDQUFDO0FBQ2hELE9BQU8sRUFBb0IsS0FBSyxFQUFFLEtBQUssRUFBRSxRQUFRLEVBQUMsTUFBTSxhQUFhLENBQUM7QUFHdEUsSUFBTSxNQUFNLEdBQXFCO0lBQy9CLFNBQVMsRUFBRSxVQUFVO0lBQ3JCLFdBQVcsRUFBRSxnQkFBZ0I7SUFFN0IsT0FBTyxFQUFFLFlBQVk7SUFFckIsZUFBZSxFQUFFLFVBQVMsS0FBSyxFQUFFLE9BQU8sRUFBRSxPQUFPO1FBQy9DLElBQU0sU0FBUyxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUMsVUFBQyxDQUFDLElBQUssT0FBQSxDQUFDLENBQUMsSUFBSSxLQUFLLE9BQU8sQ0FBQyxJQUFJLEVBQXZCLENBQXVCLENBQUMsQ0FBQztRQUNqRSxJQUFNLElBQUksR0FBRyxVQUFRLFdBQVcsQ0FBQyxPQUFPLENBQUMsSUFBSSxHQUFHLEtBQUssQ0FBQyxNQUFHLENBQUM7UUFDMUQsSUFBTSxNQUFNLEdBQU0sSUFBSSxlQUFZLENBQUM7UUFDbkMsT0FBTyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUM7WUFDakQsSUFBSSxFQUFFLE9BQU8sQ0FBQyxJQUFJO1lBQ2xCLE1BQU0sRUFBSyxJQUFJLGlCQUFjO2dCQUMzQixPQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFDLENBQUMsRUFBRSxDQUFDLElBQUssT0FBRyxDQUFDLENBQUMsS0FBSyxVQUFLLE1BQU0sU0FBSSxDQUFDLE1BQUcsRUFBN0IsQ0FBNkIsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxHQUFHO1NBQ2hGLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxVQUFVLEVBQUUsVUFBUyxLQUFLLEVBQUUsT0FBTztRQUNqQyxJQUFNLEdBQUcsR0FBRyxPQUFPLENBQUMsSUFBSSxHQUFHLEtBQUssQ0FBQztRQUNqQyxPQUFPLEdBQUcsR0FBRyxJQUFJO1lBQ2YsQ0FBQyxPQUFPLENBQUMsT0FBTyxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxZQUFVLFFBQVEsQ0FBQyxLQUFLLENBQUMsTUFBRyxDQUFDLENBQUM7SUFDM0UsQ0FBQztDQUNGLENBQUM7QUFFRixlQUFlLE1BQU0sQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7c3RyaW5nVmFsdWV9IGZyb20gJ3ZlZ2EtdXRpbCc7XG5cbmltcG9ydCB7c2lnbmFscyBhcyBtdWx0aVNpZ25hbHN9IGZyb20gJy4vbXVsdGknO1xuaW1wb3J0IHtTZWxlY3Rpb25Db21waWxlciwgU1RPUkUsIFRVUExFLCB1bml0TmFtZX0gZnJvbSAnLi9zZWxlY3Rpb24nO1xuXG5cbmNvbnN0IHNpbmdsZTpTZWxlY3Rpb25Db21waWxlciA9IHtcbiAgcHJlZGljYXRlOiAndmxTaW5nbGUnLFxuICBzY2FsZURvbWFpbjogJ3ZsU2luZ2xlRG9tYWluJyxcblxuICBzaWduYWxzOiBtdWx0aVNpZ25hbHMsXG5cbiAgdG9wTGV2ZWxTaWduYWxzOiBmdW5jdGlvbihtb2RlbCwgc2VsQ21wdCwgc2lnbmFscykge1xuICAgIGNvbnN0IGhhc1NpZ25hbCA9IHNpZ25hbHMuZmlsdGVyKChzKSA9PiBzLm5hbWUgPT09IHNlbENtcHQubmFtZSk7XG4gICAgY29uc3QgZGF0YSA9IGBkYXRhKCR7c3RyaW5nVmFsdWUoc2VsQ21wdC5uYW1lICsgU1RPUkUpfSlgO1xuICAgIGNvbnN0IHZhbHVlcyA9IGAke2RhdGF9WzBdLnZhbHVlc2A7XG4gICAgcmV0dXJuIGhhc1NpZ25hbC5sZW5ndGggPyBzaWduYWxzIDogc2lnbmFscy5jb25jYXQoe1xuICAgICAgbmFtZTogc2VsQ21wdC5uYW1lLFxuICAgICAgdXBkYXRlOiBgJHtkYXRhfS5sZW5ndGggJiYge2AgK1xuICAgICAgICBzZWxDbXB0LnByb2plY3QubWFwKChwLCBpKSA9PiBgJHtwLmZpZWxkfTogJHt2YWx1ZXN9WyR7aX1dYCkuam9pbignLCAnKSArICd9J1xuICAgIH0pO1xuICB9LFxuXG4gIG1vZGlmeUV4cHI6IGZ1bmN0aW9uKG1vZGVsLCBzZWxDbXB0KSB7XG4gICAgY29uc3QgdHBsID0gc2VsQ21wdC5uYW1lICsgVFVQTEU7XG4gICAgcmV0dXJuIHRwbCArICcsICcgK1xuICAgICAgKHNlbENtcHQucmVzb2x2ZSA9PT0gJ2dsb2JhbCcgPyAndHJ1ZScgOiBge3VuaXQ6ICR7dW5pdE5hbWUobW9kZWwpfX1gKTtcbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgc2luZ2xlO1xuIl19","import { stringValue } from 'vega-util';\nimport { accessPathWithDatum, varName } from '../../../util';\nimport { TUPLE } from '../selection';\nimport nearest from './nearest';\nvar inputBindings = {\n    has: function (selCmpt) {\n        return selCmpt.type === 'single' && selCmpt.resolve === 'global' &&\n            selCmpt.bind && selCmpt.bind !== 'scales';\n    },\n    topLevelSignals: function (model, selCmpt, signals) {\n        var name = selCmpt.name;\n        var proj = selCmpt.project;\n        var bind = selCmpt.bind;\n        var datum = nearest.has(selCmpt) ?\n            '(item().isVoronoi ? datum.datum : datum)' : 'datum';\n        proj.forEach(function (p) {\n            var sgname = varName(name + \"_\" + p.field);\n            var hasSignal = signals.filter(function (s) { return s.name === sgname; });\n            if (!hasSignal.length) {\n                signals.unshift({\n                    name: sgname,\n                    value: '',\n                    on: [{\n                            events: selCmpt.events,\n                            update: \"datum && item().mark.marktype !== 'group' ? \" + accessPathWithDatum(p.field, datum) + \" : null\"\n                        }],\n                    bind: bind[p.field] || bind[p.channel] || bind\n                });\n            }\n        });\n        return signals;\n    },\n    signals: function (model, selCmpt, signals) {\n        var name = selCmpt.name;\n        var proj = selCmpt.project;\n        var signal = signals.filter(function (s) { return s.name === name + TUPLE; })[0];\n        var fields = proj.map(function (p) { return stringValue(p.field); }).join(', ');\n        var values = proj.map(function (p) { return varName(name + \"_\" + p.field); });\n        if (values.length) {\n            signal.update = values.join(' && ') + \" ? {fields: [\" + fields + \"], values: [\" + values.join(', ') + \"]} : null\";\n        }\n        delete signal.value;\n        delete signal.on;\n        return signals;\n    }\n};\nexport default inputBindings;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5wdXRzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvc2VsZWN0aW9uL3RyYW5zZm9ybXMvaW5wdXRzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBQyxXQUFXLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDdEMsT0FBTyxFQUFDLG1CQUFtQixFQUFFLE9BQU8sRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUMzRCxPQUFPLEVBQUMsS0FBSyxFQUFDLE1BQU0sY0FBYyxDQUFDO0FBQ25DLE9BQU8sT0FBTyxNQUFNLFdBQVcsQ0FBQztBQUloQyxJQUFNLGFBQWEsR0FBcUI7SUFDdEMsR0FBRyxFQUFFLFVBQVMsT0FBTztRQUNuQixPQUFPLE9BQU8sQ0FBQyxJQUFJLEtBQUssUUFBUSxJQUFJLE9BQU8sQ0FBQyxPQUFPLEtBQUssUUFBUTtZQUM5RCxPQUFPLENBQUMsSUFBSSxJQUFJLE9BQU8sQ0FBQyxJQUFJLEtBQUssUUFBUSxDQUFDO0lBQzlDLENBQUM7SUFFRCxlQUFlLEVBQUUsVUFBUyxLQUFLLEVBQUUsT0FBTyxFQUFFLE9BQU87UUFDL0MsSUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQztRQUMxQixJQUFNLElBQUksR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDO1FBQzdCLElBQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUM7UUFDMUIsSUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1lBQ2xDLDBDQUEwQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUM7UUFFdkQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxVQUFTLENBQUM7WUFDckIsSUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFJLElBQUksU0FBSSxDQUFDLENBQUMsS0FBTyxDQUFDLENBQUM7WUFDN0MsSUFBTSxTQUFTLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxVQUFDLENBQUMsSUFBSyxPQUFBLENBQUMsQ0FBQyxJQUFJLEtBQUssTUFBTSxFQUFqQixDQUFpQixDQUFDLENBQUM7WUFDM0QsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUU7Z0JBQ3JCLE9BQU8sQ0FBQyxPQUFPLENBQUM7b0JBQ2QsSUFBSSxFQUFFLE1BQU07b0JBQ1osS0FBSyxFQUFFLEVBQUU7b0JBQ1QsRUFBRSxFQUFFLENBQUM7NEJBQ0gsTUFBTSxFQUFFLE9BQU8sQ0FBQyxNQUFNOzRCQUN0QixNQUFNLEVBQUUsaURBQStDLG1CQUFtQixDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsS0FBSyxDQUFDLFlBQVM7eUJBQ3BHLENBQUM7b0JBQ0YsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxJQUFJO2lCQUMvQyxDQUFDLENBQUM7YUFDSjtRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsT0FBTyxPQUFPLENBQUM7SUFDakIsQ0FBQztJQUVELE9BQU8sRUFBRSxVQUFTLEtBQUssRUFBRSxPQUFPLEVBQUUsT0FBTztRQUN2QyxJQUFNLElBQUksR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDO1FBQzFCLElBQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUM7UUFDN0IsSUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxVQUFDLENBQUMsSUFBSyxPQUFBLENBQUMsQ0FBQyxJQUFJLEtBQUssSUFBSSxHQUFHLEtBQUssRUFBdkIsQ0FBdUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2pFLElBQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBQyxDQUFDLElBQUssT0FBQSxXQUFXLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxFQUFwQixDQUFvQixDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2hFLElBQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBQyxDQUFDLElBQUssT0FBQSxPQUFPLENBQUksSUFBSSxTQUFJLENBQUMsQ0FBQyxLQUFPLENBQUMsRUFBN0IsQ0FBNkIsQ0FBQyxDQUFDO1FBRTlELElBQUksTUFBTSxDQUFDLE1BQU0sRUFBRTtZQUNqQixNQUFNLENBQUMsTUFBTSxHQUFNLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLHFCQUFnQixNQUFNLG9CQUFlLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGNBQVcsQ0FBQztTQUN6RztRQUVELE9BQU8sTUFBTSxDQUFDLEtBQUssQ0FBQztRQUNwQixPQUFPLE1BQU0sQ0FBQyxFQUFFLENBQUM7UUFFakIsT0FBTyxPQUFPLENBQUM7SUFDakIsQ0FBQztDQUNGLENBQUM7QUFFRixlQUFlLGFBQWEsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7c3RyaW5nVmFsdWV9IGZyb20gJ3ZlZ2EtdXRpbCc7XG5pbXBvcnQge2FjY2Vzc1BhdGhXaXRoRGF0dW0sIHZhck5hbWV9IGZyb20gJy4uLy4uLy4uL3V0aWwnO1xuaW1wb3J0IHtUVVBMRX0gZnJvbSAnLi4vc2VsZWN0aW9uJztcbmltcG9ydCBuZWFyZXN0IGZyb20gJy4vbmVhcmVzdCc7XG5pbXBvcnQge1RyYW5zZm9ybUNvbXBpbGVyfSBmcm9tICcuL3RyYW5zZm9ybXMnO1xuXG5cbmNvbnN0IGlucHV0QmluZGluZ3M6VHJhbnNmb3JtQ29tcGlsZXIgPSB7XG4gIGhhczogZnVuY3Rpb24oc2VsQ21wdCkge1xuICAgIHJldHVybiBzZWxDbXB0LnR5cGUgPT09ICdzaW5nbGUnICYmIHNlbENtcHQucmVzb2x2ZSA9PT0gJ2dsb2JhbCcgJiZcbiAgICAgIHNlbENtcHQuYmluZCAmJiBzZWxDbXB0LmJpbmQgIT09ICdzY2FsZXMnO1xuICB9LFxuXG4gIHRvcExldmVsU2lnbmFsczogZnVuY3Rpb24obW9kZWwsIHNlbENtcHQsIHNpZ25hbHMpIHtcbiAgICBjb25zdCBuYW1lID0gc2VsQ21wdC5uYW1lO1xuICAgIGNvbnN0IHByb2ogPSBzZWxDbXB0LnByb2plY3Q7XG4gICAgY29uc3QgYmluZCA9IHNlbENtcHQuYmluZDtcbiAgICBjb25zdCBkYXR1bSA9IG5lYXJlc3QuaGFzKHNlbENtcHQpID9cbiAgICAgICcoaXRlbSgpLmlzVm9yb25vaSA/IGRhdHVtLmRhdHVtIDogZGF0dW0pJyA6ICdkYXR1bSc7XG5cbiAgICBwcm9qLmZvckVhY2goZnVuY3Rpb24ocCkge1xuICAgICAgY29uc3Qgc2duYW1lID0gdmFyTmFtZShgJHtuYW1lfV8ke3AuZmllbGR9YCk7XG4gICAgICBjb25zdCBoYXNTaWduYWwgPSBzaWduYWxzLmZpbHRlcigocykgPT4gcy5uYW1lID09PSBzZ25hbWUpO1xuICAgICAgaWYgKCFoYXNTaWduYWwubGVuZ3RoKSB7XG4gICAgICAgIHNpZ25hbHMudW5zaGlmdCh7XG4gICAgICAgICAgbmFtZTogc2duYW1lLFxuICAgICAgICAgIHZhbHVlOiAnJyxcbiAgICAgICAgICBvbjogW3tcbiAgICAgICAgICAgIGV2ZW50czogc2VsQ21wdC5ldmVudHMsXG4gICAgICAgICAgICB1cGRhdGU6IGBkYXR1bSAmJiBpdGVtKCkubWFyay5tYXJrdHlwZSAhPT0gJ2dyb3VwJyA/ICR7YWNjZXNzUGF0aFdpdGhEYXR1bShwLmZpZWxkLCBkYXR1bSl9IDogbnVsbGBcbiAgICAgICAgICB9XSxcbiAgICAgICAgICBiaW5kOiBiaW5kW3AuZmllbGRdIHx8IGJpbmRbcC5jaGFubmVsXSB8fCBiaW5kXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHNpZ25hbHM7XG4gIH0sXG5cbiAgc2lnbmFsczogZnVuY3Rpb24obW9kZWwsIHNlbENtcHQsIHNpZ25hbHMpIHtcbiAgICBjb25zdCBuYW1lID0gc2VsQ21wdC5uYW1lO1xuICAgIGNvbnN0IHByb2ogPSBzZWxDbXB0LnByb2plY3Q7XG4gICAgY29uc3Qgc2lnbmFsID0gc2lnbmFscy5maWx0ZXIoKHMpID0+IHMubmFtZSA9PT0gbmFtZSArIFRVUExFKVswXTtcbiAgICBjb25zdCBmaWVsZHMgPSBwcm9qLm1hcCgocCkgPT4gc3RyaW5nVmFsdWUocC5maWVsZCkpLmpvaW4oJywgJyk7XG4gICAgY29uc3QgdmFsdWVzID0gcHJvai5tYXAoKHApID0+IHZhck5hbWUoYCR7bmFtZX1fJHtwLmZpZWxkfWApKTtcblxuICAgIGlmICh2YWx1ZXMubGVuZ3RoKSB7XG4gICAgICBzaWduYWwudXBkYXRlID0gYCR7dmFsdWVzLmpvaW4oJyAmJiAnKX0gPyB7ZmllbGRzOiBbJHtmaWVsZHN9XSwgdmFsdWVzOiBbJHt2YWx1ZXMuam9pbignLCAnKX1dfSA6IG51bGxgO1xuICAgIH1cblxuICAgIGRlbGV0ZSBzaWduYWwudmFsdWU7XG4gICAgZGVsZXRlIHNpZ25hbC5vbjtcblxuICAgIHJldHVybiBzaWduYWxzO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBpbnB1dEJpbmRpbmdzO1xuIl19","import * as log from '../../../log';\nimport { keys } from '../../../util';\nimport { TimeUnitNode } from '../../data/timeunit';\nvar project = {\n    has: function (selDef) {\n        var def = selDef;\n        return def.fields !== undefined || def.encodings !== undefined;\n    },\n    parse: function (model, selDef, selCmpt) {\n        var channels = {};\n        var timeUnits = {};\n        // TODO: find a possible channel mapping for these fields.\n        (selDef.fields || []).forEach(function (field) { return channels[field] = null; });\n        (selDef.encodings || []).forEach(function (channel) {\n            var fieldDef = model.fieldDef(channel);\n            if (fieldDef) {\n                if (fieldDef.timeUnit) {\n                    var tuField = model.vgField(channel);\n                    channels[tuField] = channel;\n                    // Construct TimeUnitComponents which will be combined into a\n                    // TimeUnitNode. This node may need to be inserted into the\n                    // dataflow if the selection is used across views that do not\n                    // have these time units defined.\n                    timeUnits[tuField] = {\n                        as: tuField,\n                        field: fieldDef.field,\n                        timeUnit: fieldDef.timeUnit\n                    };\n                }\n                else {\n                    channels[fieldDef.field] = channel;\n                }\n            }\n            else {\n                log.warn(log.message.cannotProjectOnChannelWithoutField(channel));\n            }\n        });\n        var projection = selCmpt.project || (selCmpt.project = []);\n        for (var field in channels) {\n            if (channels.hasOwnProperty(field)) {\n                projection.push({ field: field, channel: channels[field] });\n            }\n        }\n        var fields = selCmpt.fields || (selCmpt.fields = {});\n        projection.filter(function (p) { return p.channel; }).forEach(function (p) { return fields[p.channel] = p.field; });\n        if (keys(timeUnits).length) {\n            selCmpt.timeUnit = new TimeUnitNode(null, timeUnits);\n        }\n    }\n};\nexport default project;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvamVjdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9jb21waWxlL3NlbGVjdGlvbi90cmFuc2Zvcm1zL3Byb2plY3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxLQUFLLEdBQUcsTUFBTSxjQUFjLENBQUM7QUFFcEMsT0FBTyxFQUFDLElBQUksRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUNuQyxPQUFPLEVBQW9CLFlBQVksRUFBQyxNQUFNLHFCQUFxQixDQUFDO0FBSXBFLElBQU0sT0FBTyxHQUFzQjtJQUNqQyxHQUFHLEVBQUUsVUFBUyxNQUF5QztRQUNyRCxJQUFNLEdBQUcsR0FBRyxNQUFzQixDQUFDO1FBQ25DLE9BQU8sR0FBRyxDQUFDLE1BQU0sS0FBSyxTQUFTLElBQUksR0FBRyxDQUFDLFNBQVMsS0FBSyxTQUFTLENBQUM7SUFDakUsQ0FBQztJQUVELEtBQUssRUFBRSxVQUFTLEtBQUssRUFBRSxNQUFNLEVBQUUsT0FBTztRQUNwQyxJQUFNLFFBQVEsR0FBRyxFQUFFLENBQUM7UUFDcEIsSUFBTSxTQUFTLEdBQXVDLEVBQUUsQ0FBQztRQUV6RCwwREFBMEQ7UUFDMUQsQ0FBQyxNQUFNLENBQUMsTUFBTSxJQUFJLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFDLEtBQUssSUFBSyxPQUFBLFFBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxJQUFJLEVBQXRCLENBQXNCLENBQUMsQ0FBQztRQUVqRSxDQUFDLE1BQU0sQ0FBQyxTQUFTLElBQUksRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQUMsT0FBeUI7WUFDekQsSUFBTSxRQUFRLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUN6QyxJQUFJLFFBQVEsRUFBRTtnQkFDWixJQUFJLFFBQVEsQ0FBQyxRQUFRLEVBQUU7b0JBQ3JCLElBQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7b0JBQ3ZDLFFBQVEsQ0FBQyxPQUFPLENBQUMsR0FBRyxPQUFPLENBQUM7b0JBRTVCLDZEQUE2RDtvQkFDN0QsMkRBQTJEO29CQUMzRCw2REFBNkQ7b0JBQzdELGlDQUFpQztvQkFDakMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxHQUFHO3dCQUNuQixFQUFFLEVBQUUsT0FBTzt3QkFDWCxLQUFLLEVBQUUsUUFBUSxDQUFDLEtBQUs7d0JBQ3JCLFFBQVEsRUFBRSxRQUFRLENBQUMsUUFBUTtxQkFDNUIsQ0FBQztpQkFDSDtxQkFBTTtvQkFDTCxRQUFRLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxHQUFHLE9BQU8sQ0FBQztpQkFDcEM7YUFDRjtpQkFBTTtnQkFDTCxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsa0NBQWtDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQzthQUNuRTtRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBTSxVQUFVLEdBQUcsT0FBTyxDQUFDLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDN0QsS0FBSyxJQUFNLEtBQUssSUFBSSxRQUFRLEVBQUU7WUFDNUIsSUFBSSxRQUFRLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxFQUFFO2dCQUNsQyxVQUFVLENBQUMsSUFBSSxDQUFDLEVBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsUUFBUSxDQUFDLEtBQUssQ0FBQyxFQUFDLENBQUMsQ0FBQzthQUMzRDtTQUNGO1FBRUQsSUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDLENBQUM7UUFDdkQsVUFBVSxDQUFDLE1BQU0sQ0FBQyxVQUFDLENBQUMsSUFBSyxPQUFBLENBQUMsQ0FBQyxPQUFPLEVBQVQsQ0FBUyxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQUMsQ0FBQyxJQUFLLE9BQUEsTUFBTSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUEzQixDQUEyQixDQUFDLENBQUM7UUFFaEYsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsTUFBTSxFQUFFO1lBQzFCLE9BQU8sQ0FBQyxRQUFRLEdBQUcsSUFBSSxZQUFZLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxDQUFDO1NBQ3REO0lBQ0gsQ0FBQztDQUNGLENBQUM7QUFFRixlQUFlLE9BQU8sQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7U2luZ2xlRGVmQ2hhbm5lbH0gZnJvbSAnLi4vLi4vLi4vY2hhbm5lbCc7XG5pbXBvcnQgKiBhcyBsb2cgZnJvbSAnLi4vLi4vLi4vbG9nJztcbmltcG9ydCB7U2VsZWN0aW9uRGVmfSBmcm9tICcuLi8uLi8uLi9zZWxlY3Rpb24nO1xuaW1wb3J0IHtrZXlzfSBmcm9tICcuLi8uLi8uLi91dGlsJztcbmltcG9ydCB7VGltZVVuaXRDb21wb25lbnQsIFRpbWVVbml0Tm9kZX0gZnJvbSAnLi4vLi4vZGF0YS90aW1ldW5pdCc7XG5pbXBvcnQge1NlbGVjdGlvbkNvbXBvbmVudH0gZnJvbSAnLi4vc2VsZWN0aW9uJztcbmltcG9ydCB7VHJhbnNmb3JtQ29tcGlsZXJ9IGZyb20gJy4vdHJhbnNmb3Jtcyc7XG5cbmNvbnN0IHByb2plY3Q6IFRyYW5zZm9ybUNvbXBpbGVyID0ge1xuICBoYXM6IGZ1bmN0aW9uKHNlbERlZjogU2VsZWN0aW9uQ29tcG9uZW50IHwgU2VsZWN0aW9uRGVmKSB7XG4gICAgY29uc3QgZGVmID0gc2VsRGVmIGFzIFNlbGVjdGlvbkRlZjtcbiAgICByZXR1cm4gZGVmLmZpZWxkcyAhPT0gdW5kZWZpbmVkIHx8IGRlZi5lbmNvZGluZ3MgIT09IHVuZGVmaW5lZDtcbiAgfSxcblxuICBwYXJzZTogZnVuY3Rpb24obW9kZWwsIHNlbERlZiwgc2VsQ21wdCkge1xuICAgIGNvbnN0IGNoYW5uZWxzID0ge307XG4gICAgY29uc3QgdGltZVVuaXRzOiB7W2tleTogc3RyaW5nXTogVGltZVVuaXRDb21wb25lbnR9ID0ge307XG5cbiAgICAvLyBUT0RPOiBmaW5kIGEgcG9zc2libGUgY2hhbm5lbCBtYXBwaW5nIGZvciB0aGVzZSBmaWVsZHMuXG4gICAgKHNlbERlZi5maWVsZHMgfHwgW10pLmZvckVhY2goKGZpZWxkKSA9PiBjaGFubmVsc1tmaWVsZF0gPSBudWxsKTtcblxuICAgIChzZWxEZWYuZW5jb2RpbmdzIHx8IFtdKS5mb3JFYWNoKChjaGFubmVsOiBTaW5nbGVEZWZDaGFubmVsKSA9PiB7XG4gICAgICBjb25zdCBmaWVsZERlZiA9IG1vZGVsLmZpZWxkRGVmKGNoYW5uZWwpO1xuICAgICAgaWYgKGZpZWxkRGVmKSB7XG4gICAgICAgIGlmIChmaWVsZERlZi50aW1lVW5pdCkge1xuICAgICAgICAgIGNvbnN0IHR1RmllbGQgPSBtb2RlbC52Z0ZpZWxkKGNoYW5uZWwpO1xuICAgICAgICAgIGNoYW5uZWxzW3R1RmllbGRdID0gY2hhbm5lbDtcblxuICAgICAgICAgIC8vIENvbnN0cnVjdCBUaW1lVW5pdENvbXBvbmVudHMgd2hpY2ggd2lsbCBiZSBjb21iaW5lZCBpbnRvIGFcbiAgICAgICAgICAvLyBUaW1lVW5pdE5vZGUuIFRoaXMgbm9kZSBtYXkgbmVlZCB0byBiZSBpbnNlcnRlZCBpbnRvIHRoZVxuICAgICAgICAgIC8vIGRhdGFmbG93IGlmIHRoZSBzZWxlY3Rpb24gaXMgdXNlZCBhY3Jvc3Mgdmlld3MgdGhhdCBkbyBub3RcbiAgICAgICAgICAvLyBoYXZlIHRoZXNlIHRpbWUgdW5pdHMgZGVmaW5lZC5cbiAgICAgICAgICB0aW1lVW5pdHNbdHVGaWVsZF0gPSB7XG4gICAgICAgICAgICBhczogdHVGaWVsZCxcbiAgICAgICAgICAgIGZpZWxkOiBmaWVsZERlZi5maWVsZCxcbiAgICAgICAgICAgIHRpbWVVbml0OiBmaWVsZERlZi50aW1lVW5pdFxuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2hhbm5lbHNbZmllbGREZWYuZmllbGRdID0gY2hhbm5lbDtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuY2Fubm90UHJvamVjdE9uQ2hhbm5lbFdpdGhvdXRGaWVsZChjaGFubmVsKSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCBwcm9qZWN0aW9uID0gc2VsQ21wdC5wcm9qZWN0IHx8IChzZWxDbXB0LnByb2plY3QgPSBbXSk7XG4gICAgZm9yIChjb25zdCBmaWVsZCBpbiBjaGFubmVscykge1xuICAgICAgaWYgKGNoYW5uZWxzLmhhc093blByb3BlcnR5KGZpZWxkKSkge1xuICAgICAgICBwcm9qZWN0aW9uLnB1c2goe2ZpZWxkOiBmaWVsZCwgY2hhbm5lbDogY2hhbm5lbHNbZmllbGRdfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgZmllbGRzID0gc2VsQ21wdC5maWVsZHMgfHwgKHNlbENtcHQuZmllbGRzID0ge30pO1xuICAgIHByb2plY3Rpb24uZmlsdGVyKChwKSA9PiBwLmNoYW5uZWwpLmZvckVhY2goKHApID0+IGZpZWxkc1twLmNoYW5uZWxdID0gcC5maWVsZCk7XG5cbiAgICBpZiAoa2V5cyh0aW1lVW5pdHMpLmxlbmd0aCkge1xuICAgICAgc2VsQ21wdC50aW1lVW5pdCA9IG5ldyBUaW1lVW5pdE5vZGUobnVsbCwgdGltZVVuaXRzKTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IHByb2plY3Q7XG4iXX0=","import { TUPLE, unitName } from '../selection';\nvar TOGGLE = '_toggle';\nvar toggle = {\n    has: function (selCmpt) {\n        return selCmpt.type === 'multi' && selCmpt.toggle;\n    },\n    signals: function (model, selCmpt, signals) {\n        return signals.concat({\n            name: selCmpt.name + TOGGLE,\n            value: false,\n            on: [{ events: selCmpt.events, update: selCmpt.toggle }]\n        });\n    },\n    modifyExpr: function (model, selCmpt, expr) {\n        var tpl = selCmpt.name + TUPLE;\n        var signal = selCmpt.name + TOGGLE;\n        return signal + \" ? null : \" + tpl + \", \" +\n            (selCmpt.resolve === 'global' ?\n                signal + \" ? null : true, \" :\n                signal + \" ? null : {unit: \" + unitName(model) + \"}, \") +\n            (signal + \" ? \" + tpl + \" : null\");\n    }\n};\nexport default toggle;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9nZ2xlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvc2VsZWN0aW9uL3RyYW5zZm9ybXMvdG9nZ2xlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBQyxLQUFLLEVBQUUsUUFBUSxFQUFDLE1BQU0sY0FBYyxDQUFDO0FBSTdDLElBQU0sTUFBTSxHQUFHLFNBQVMsQ0FBQztBQUV6QixJQUFNLE1BQU0sR0FBcUI7SUFDL0IsR0FBRyxFQUFFLFVBQVMsT0FBTztRQUNuQixPQUFPLE9BQU8sQ0FBQyxJQUFJLEtBQUssT0FBTyxJQUFJLE9BQU8sQ0FBQyxNQUFNLENBQUM7SUFDcEQsQ0FBQztJQUVELE9BQU8sRUFBRSxVQUFTLEtBQUssRUFBRSxPQUFPLEVBQUUsT0FBTztRQUN2QyxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUM7WUFDcEIsSUFBSSxFQUFFLE9BQU8sQ0FBQyxJQUFJLEdBQUcsTUFBTTtZQUMzQixLQUFLLEVBQUUsS0FBSztZQUNaLEVBQUUsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLE9BQU8sQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLE9BQU8sQ0FBQyxNQUFNLEVBQUMsQ0FBQztTQUN2RCxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsVUFBVSxFQUFFLFVBQVMsS0FBSyxFQUFFLE9BQU8sRUFBRSxJQUFJO1FBQ3ZDLElBQU0sR0FBRyxHQUFHLE9BQU8sQ0FBQyxJQUFJLEdBQUcsS0FBSyxDQUFDO1FBQ2pDLElBQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxJQUFJLEdBQUcsTUFBTSxDQUFDO1FBRXJDLE9BQVUsTUFBTSxrQkFBYSxHQUFHLE9BQUk7WUFDbEMsQ0FBQyxPQUFPLENBQUMsT0FBTyxLQUFLLFFBQVEsQ0FBQyxDQUFDO2dCQUMxQixNQUFNLHFCQUFrQixDQUFDLENBQUM7Z0JBQzFCLE1BQU0seUJBQW9CLFFBQVEsQ0FBQyxLQUFLLENBQUMsUUFBSyxDQUFDO2FBQ2pELE1BQU0sV0FBTSxHQUFHLFlBQVMsQ0FBQSxDQUFDO0lBQ2hDLENBQUM7Q0FDRixDQUFDO0FBRUYsZUFBZSxNQUFNLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCB7VFVQTEUsIHVuaXROYW1lfSBmcm9tICcuLi9zZWxlY3Rpb24nO1xuaW1wb3J0IHtUcmFuc2Zvcm1Db21waWxlcn0gZnJvbSAnLi90cmFuc2Zvcm1zJztcblxuXG5jb25zdCBUT0dHTEUgPSAnX3RvZ2dsZSc7XG5cbmNvbnN0IHRvZ2dsZTpUcmFuc2Zvcm1Db21waWxlciA9IHtcbiAgaGFzOiBmdW5jdGlvbihzZWxDbXB0KSB7XG4gICAgcmV0dXJuIHNlbENtcHQudHlwZSA9PT0gJ211bHRpJyAmJiBzZWxDbXB0LnRvZ2dsZTtcbiAgfSxcblxuICBzaWduYWxzOiBmdW5jdGlvbihtb2RlbCwgc2VsQ21wdCwgc2lnbmFscykge1xuICAgIHJldHVybiBzaWduYWxzLmNvbmNhdCh7XG4gICAgICBuYW1lOiBzZWxDbXB0Lm5hbWUgKyBUT0dHTEUsXG4gICAgICB2YWx1ZTogZmFsc2UsXG4gICAgICBvbjogW3tldmVudHM6IHNlbENtcHQuZXZlbnRzLCB1cGRhdGU6IHNlbENtcHQudG9nZ2xlfV1cbiAgICB9KTtcbiAgfSxcblxuICBtb2RpZnlFeHByOiBmdW5jdGlvbihtb2RlbCwgc2VsQ21wdCwgZXhwcikge1xuICAgIGNvbnN0IHRwbCA9IHNlbENtcHQubmFtZSArIFRVUExFO1xuICAgIGNvbnN0IHNpZ25hbCA9IHNlbENtcHQubmFtZSArIFRPR0dMRTtcblxuICAgIHJldHVybiBgJHtzaWduYWx9ID8gbnVsbCA6ICR7dHBsfSwgYCArXG4gICAgICAoc2VsQ21wdC5yZXNvbHZlID09PSAnZ2xvYmFsJyA/XG4gICAgICAgIGAke3NpZ25hbH0gPyBudWxsIDogdHJ1ZSwgYCA6XG4gICAgICAgIGAke3NpZ25hbH0gPyBudWxsIDoge3VuaXQ6ICR7dW5pdE5hbWUobW9kZWwpfX0sIGApICtcbiAgICAgIGAke3NpZ25hbH0gPyAke3RwbH0gOiBudWxsYDtcbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgdG9nZ2xlO1xuIl19","import { selector as parseSelector } from 'vega-event-selector';\nimport { X, Y } from '../../../channel';\nimport { BRUSH as INTERVAL_BRUSH } from '../interval';\nimport { channelSignalName, positionalProjections } from '../selection';\nimport scalesCompiler, { domain } from './scales';\nvar ANCHOR = '_translate_anchor';\nvar DELTA = '_translate_delta';\nvar translate = {\n    has: function (selCmpt) {\n        return selCmpt.type === 'interval' && selCmpt.translate;\n    },\n    signals: function (model, selCmpt, signals) {\n        var name = selCmpt.name;\n        var hasScales = scalesCompiler.has(selCmpt);\n        var anchor = name + ANCHOR;\n        var _a = positionalProjections(selCmpt), x = _a.x, y = _a.y;\n        var events = parseSelector(selCmpt.translate, 'scope');\n        if (!hasScales) {\n            events = events.map(function (e) { return (e.between[0].markname = name + INTERVAL_BRUSH, e); });\n        }\n        signals.push({\n            name: anchor,\n            value: {},\n            on: [{\n                    events: events.map(function (e) { return e.between[0]; }),\n                    update: '{x: x(unit), y: y(unit)' +\n                        (x !== null ? ', extent_x: ' + (hasScales ? domain(model, X) :\n                            \"slice(\" + channelSignalName(selCmpt, 'x', 'visual') + \")\") : '') +\n                        (y !== null ? ', extent_y: ' + (hasScales ? domain(model, Y) :\n                            \"slice(\" + channelSignalName(selCmpt, 'y', 'visual') + \")\") : '') + '}'\n                }]\n        }, {\n            name: name + DELTA,\n            value: {},\n            on: [{\n                    events: events,\n                    update: \"{x: \" + anchor + \".x - x(unit), y: \" + anchor + \".y - y(unit)}\"\n                }]\n        });\n        if (x !== null) {\n            onDelta(model, selCmpt, X, 'width', signals);\n        }\n        if (y !== null) {\n            onDelta(model, selCmpt, Y, 'height', signals);\n        }\n        return signals;\n    }\n};\nexport default translate;\nfunction onDelta(model, selCmpt, channel, size, signals) {\n    var name = selCmpt.name;\n    var hasScales = scalesCompiler.has(selCmpt);\n    var signal = signals.filter(function (s) {\n        return s.name === channelSignalName(selCmpt, channel, hasScales ? 'data' : 'visual');\n    })[0];\n    var anchor = name + ANCHOR;\n    var delta = name + DELTA;\n    var sizeSg = model.getSizeSignalRef(size).signal;\n    var scaleCmpt = model.getScaleComponent(channel);\n    var scaleType = scaleCmpt.get('type');\n    var sign = hasScales && channel === X ? '-' : ''; // Invert delta when panning x-scales.\n    var extent = anchor + \".extent_\" + channel;\n    var offset = \"\" + sign + delta + \".\" + channel + \" / \" + (hasScales ? \"\" + sizeSg : \"span(\" + extent + \")\");\n    var panFn = !hasScales ? 'panLinear' :\n        scaleType === 'log' ? 'panLog' :\n            scaleType === 'pow' ? 'panPow' : 'panLinear';\n    var update = panFn + \"(\" + extent + \", \" + offset +\n        (hasScales && scaleType === 'pow' ? \", \" + (scaleCmpt.get('exponent') || 1) : '') + ')';\n    signal.on.push({\n        events: { signal: delta },\n        update: hasScales ? update : \"clampRange(\" + update + \", 0, \" + sizeSg + \")\"\n    });\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNsYXRlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvc2VsZWN0aW9uL3RyYW5zZm9ybXMvdHJhbnNsYXRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBQyxRQUFRLElBQUksYUFBYSxFQUFDLE1BQU0scUJBQXFCLENBQUM7QUFFOUQsT0FBTyxFQUFlLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxrQkFBa0IsQ0FBQztBQUVwRCxPQUFPLEVBQUMsS0FBSyxJQUFJLGNBQWMsRUFBQyxNQUFNLGFBQWEsQ0FBQztBQUNwRCxPQUFPLEVBQUMsaUJBQWlCLEVBQUUscUJBQXFCLEVBQXFCLE1BQU0sY0FBYyxDQUFDO0FBRTFGLE9BQU8sY0FBYyxFQUFFLEVBQUMsTUFBTSxFQUFDLE1BQU0sVUFBVSxDQUFDO0FBSWhELElBQU0sTUFBTSxHQUFHLG1CQUFtQixDQUFDO0FBQ25DLElBQU0sS0FBSyxHQUFHLGtCQUFrQixDQUFDO0FBRWpDLElBQU0sU0FBUyxHQUFxQjtJQUNsQyxHQUFHLEVBQUUsVUFBUyxPQUFPO1FBQ25CLE9BQU8sT0FBTyxDQUFDLElBQUksS0FBSyxVQUFVLElBQUksT0FBTyxDQUFDLFNBQVMsQ0FBQztJQUMxRCxDQUFDO0lBRUQsT0FBTyxFQUFFLFVBQVMsS0FBSyxFQUFFLE9BQU8sRUFBRSxPQUFPO1FBQ3ZDLElBQU0sSUFBSSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUM7UUFDMUIsSUFBTSxTQUFTLEdBQUcsY0FBYyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUM5QyxJQUFNLE1BQU0sR0FBRyxJQUFJLEdBQUcsTUFBTSxDQUFDO1FBQ3ZCLElBQUEsbUNBQXVDLEVBQXRDLFFBQUMsRUFBRSxRQUFDLENBQW1DO1FBQzlDLElBQUksTUFBTSxHQUFHLGFBQWEsQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBRXZELElB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QUc7S0FDbkUsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7c2VsZWN0b3IgYXMgcGFyc2VTZWxlY3Rvcn0gZnJvbSAndmVnYS1ldmVudC1zZWxlY3Rvcic7XG5cbmltcG9ydCB7U2NhbGVDaGFubmVsLCBYLCBZfSBmcm9tICcuLi8uLi8uLi9jaGFubmVsJztcbmltcG9ydCB7VmdTaWduYWx9IGZyb20gJy4uLy4uLy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7QlJVU0ggYXMgSU5URVJWQUxfQlJVU0h9IGZyb20gJy4uL2ludGVydmFsJztcbmltcG9ydCB7Y2hhbm5lbFNpZ25hbE5hbWUsIHBvc2l0aW9uYWxQcm9qZWN0aW9ucywgU2VsZWN0aW9uQ29tcG9uZW50fSBmcm9tICcuLi9zZWxlY3Rpb24nO1xuaW1wb3J0IHtVbml0TW9kZWx9IGZyb20gJy4vLi4vLi4vdW5pdCc7XG5pbXBvcnQgc2NhbGVzQ29tcGlsZXIsIHtkb21haW59IGZyb20gJy4vc2NhbGVzJztcbmltcG9ydCB7VHJhbnNmb3JtQ29tcGlsZXJ9IGZyb20gJy4vdHJhbnNmb3Jtcyc7XG5cblxuY29uc3QgQU5DSE9SID0gJ190cmFuc2xhdGVfYW5jaG9yJztcbmNvbnN0IERFTFRBID0gJ190cmFuc2xhdGVfZGVsdGEnO1xuXG5jb25zdCB0cmFuc2xhdGU6VHJhbnNmb3JtQ29tcGlsZXIgPSB7XG4gIGhhczogZnVuY3Rpb24oc2VsQ21wdCkge1xuICAgIHJldHVybiBzZWxDbXB0LnR5cGUgPT09ICdpbnRlcnZhbCcgJiYgc2VsQ21wdC50cmFuc2xhdGU7XG4gIH0sXG5cbiAgc2lnbmFsczogZnVuY3Rpb24obW9kZWwsIHNlbENtcHQsIHNpZ25hbHMpIHtcbiAgICBjb25zdCBuYW1lID0gc2VsQ21wdC5uYW1lO1xuICAgIGNvbnN0IGhhc1NjYWxlcyA9IHNjYWxlc0NvbXBpbGVyLmhhcyhzZWxDbXB0KTtcbiAgICBjb25zdCBhbmNob3IgPSBuYW1lICsgQU5DSE9SO1xuICAgIGNvbnN0IHt4LCB5fSA9IHBvc2l0aW9uYWxQcm9qZWN0aW9ucyhzZWxDbXB0KTtcbiAgICBsZXQgZXZlbnRzID0gcGFyc2VTZWxlY3RvcihzZWxDbXB0LnRyYW5zbGF0ZSwgJ3Njb3BlJyk7XG5cbiAgICBpZiAoIWhhc1NjYWxlcykge1xuICAgICAgZXZlbnRzID0gZXZlbnRzLm1hcCgoZSkgPT4gKGUuYmV0d2VlblswXS5tYXJrbmFtZSA9IG5hbWUgKyBJTlRFUlZBTF9CUlVTSCwgZSkpO1xuICAgIH1cblxuICAgIHNpZ25hbHMucHVzaCh7XG4gICAgICBuYW1lOiBhbmNob3IsXG4gICAgICB2YWx1ZToge30sXG4gICAgICBvbjogW3tcbiAgICAgICAgZXZlbnRzOiBldmVudHMubWFwKChlKSA9PiBlLmJldHdlZW5bMF0pLFxuICAgICAgICB1cGRhdGU6ICd7eDogeCh1bml0KSwgeTogeSh1bml0KScgK1xuICAgICAgICAgICh4ICE9PSBudWxsID8gJywgZXh0ZW50X3g6ICcgKyAoaGFzU2NhbGVzID8gZG9tYWluKG1vZGVsLCBYKSA6XG4gICAgICAgICAgICAgIGBzbGljZSgke2NoYW5uZWxTaWduYWxOYW1lKHNlbENtcHQsICd4JywgJ3Zpc3VhbCcpfSlgKSA6ICcnKSArXG5cbiAgICAgICAgICAoeSAhPT0gbnVsbCA/ICcsIGV4dGVudF95OiAnICsgKGhhc1NjYWxlcyA/IGRvbWFpbihtb2RlbCwgWSkgOlxuICAgICAgICAgICAgICBgc2xpY2UoJHtjaGFubmVsU2lnbmFsTmFtZShzZWxDbXB0LCAneScsICd2aXN1YWwnKX0pYCkgOiAnJykgKyAnfSdcbiAgICAgIH1dXG4gICAgfSwge1xuICAgICAgbmFtZTogbmFtZSArIERFTFRBLFxuICAgICAgdmFsdWU6IHt9LFxuICAgICAgb246IFt7XG4gICAgICAgIGV2ZW50czogZXZlbnRzLFxuICAgICAgICB1cGRhdGU6IGB7eDogJHthbmNob3J9LnggLSB4KHVuaXQpLCB5OiAke2FuY2hvcn0ueSAtIHkodW5pdCl9YFxuICAgICAgfV1cbiAgICB9KTtcblxuICAgIGlmICh4ICE9PSBudWxsKSB7XG4gICAgICBvbkRlbHRhKG1vZGVsLCBzZWxDbXB0LCBYLCAnd2lkdGgnLCBzaWduYWxzKTtcbiAgICB9XG5cbiAgICBpZiAoeSAhPT0gbnVsbCkge1xuICAgICAgb25EZWx0YShtb2RlbCwgc2VsQ21wdCwgWSwgJ2hlaWdodCcsIHNpZ25hbHMpO1xuICAgIH1cblxuICAgIHJldHVybiBzaWduYWxzO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCB0cmFuc2xhdGU7XG5cbmZ1bmN0aW9uIG9uRGVsdGEobW9kZWw6IFVuaXRNb2RlbCwgc2VsQ21wdDogU2VsZWN0aW9uQ29tcG9uZW50LCBjaGFubmVsOiBTY2FsZUNoYW5uZWwsIHNpemU6ICd3aWR0aCcgfCAnaGVpZ2h0Jywgc2lnbmFsczogVmdTaWduYWxbXSkge1xuICBjb25zdCBuYW1lID0gc2VsQ21wdC5uYW1lO1xuICBjb25zdCBoYXNTY2FsZXMgPSBzY2FsZXNDb21waWxlci5oYXMoc2VsQ21wdCk7XG4gIGNvbnN0IHNpZ25hbCA9IHNpZ25hbHMuZmlsdGVyKHMgPT4ge1xuICAgIHJldHVybiBzLm5hbWUgPT09IGNoYW5uZWxTaWduYWxOYW1lKHNlbENtcHQsIGNoYW5uZWwsIGhhc1NjYWxlcyA/ICdkYXRhJyA6ICd2aXN1YWwnKTtcbiAgfSlbMF07XG4gIGNvbnN0IGFuY2hvciA9IG5hbWUgKyBBTkNIT1I7XG4gIGNvbnN0IGRlbHRhID0gbmFtZSArIERFTFRBO1xuICBjb25zdCBzaXplU2cgPSBtb2RlbC5nZXRTaXplU2lnbmFsUmVmKHNpemUpLnNpZ25hbDtcbiAgY29uc3Qgc2NhbGVDbXB0ID0gbW9kZWwuZ2V0U2NhbGVDb21wb25lbnQoY2hhbm5lbCk7XG4gIGNvbnN0IHNjYWxlVHlwZSA9IHNjYWxlQ21wdC5nZXQoJ3R5cGUnKTtcbiAgY29uc3Qgc2lnbiA9IGhhc1NjYWxlcyAmJiBjaGFubmVsID09PSBYID8gJy0nIDogJyc7IC8vIEludmVydCBkZWx0YSB3aGVuIHBhbm5pbmcgeC1zY2FsZXMuXG4gIGNvbnN0IGV4dGVudCA9IGAke2FuY2hvcn0uZXh0ZW50XyR7Y2hhbm5lbH1gO1xuICBjb25zdCBvZmZzZXQgPSBgJHtzaWdufSR7ZGVsdGF9LiR7Y2hhbm5lbH0gLyBgICsgKGhhc1NjYWxlcyA/IGAke3NpemVTZ31gIDogYHNwYW4oJHtleHRlbnR9KWApO1xuICBjb25zdCBwYW5GbiA9ICFoYXNTY2FsZXMgPyAncGFuTGluZWFyJyA6XG4gICAgc2NhbGVUeXBlID09PSAnbG9nJyA/ICdwYW5Mb2cnIDpcbiAgICBzY2FsZVR5cGUgPT09ICdwb3cnID8gJ3BhblBvdycgOiAncGFuTGluZWFyJztcbiAgY29uc3QgdXBkYXRlID0gYCR7cGFuRm59KCR7ZXh0ZW50fSwgJHtvZmZzZXR9YCArXG4gICAgKGhhc1NjYWxlcyAmJiBzY2FsZVR5cGUgPT09ICdwb3cnID8gYCwgJHtzY2FsZUNtcHQuZ2V0KCdleHBvbmVudCcpIHx8IDF9YCA6ICcnKSArICcpJztcblxuICBzaWduYWwub24ucHVzaCh7XG4gICAgZXZlbnRzOiB7c2lnbmFsOiBkZWx0YX0sXG4gICAgdXBkYXRlOiBoYXNTY2FsZXMgPyB1cGRhdGUgOiBgY2xhbXBSYW5nZSgke3VwZGF0ZX0sIDAsICR7c2l6ZVNnfSlgXG4gIH0pO1xufVxuIl19","import { selector as parseSelector } from 'vega-event-selector';\nimport { stringValue } from 'vega-util';\nimport { X, Y } from '../../../channel';\nimport { BRUSH as INTERVAL_BRUSH } from '../interval';\nimport { channelSignalName, positionalProjections } from '../selection';\nimport { default as scalesCompiler, domain } from './scales';\nvar ANCHOR = '_zoom_anchor';\nvar DELTA = '_zoom_delta';\nvar zoom = {\n    has: function (selCmpt) {\n        return selCmpt.type === 'interval' && selCmpt.zoom;\n    },\n    signals: function (model, selCmpt, signals) {\n        var name = selCmpt.name;\n        var hasScales = scalesCompiler.has(selCmpt);\n        var delta = name + DELTA;\n        var _a = positionalProjections(selCmpt), x = _a.x, y = _a.y;\n        var sx = stringValue(model.scaleName(X));\n        var sy = stringValue(model.scaleName(Y));\n        var events = parseSelector(selCmpt.zoom, 'scope');\n        if (!hasScales) {\n            events = events.map(function (e) { return (e.markname = name + INTERVAL_BRUSH, e); });\n        }\n        signals.push({\n            name: name + ANCHOR,\n            on: [{\n                    events: events,\n                    update: !hasScales ? \"{x: x(unit), y: y(unit)}\" :\n                        '{' + [\n                            (sx ? \"x: invert(\" + sx + \", x(unit))\" : ''),\n                            (sy ? \"y: invert(\" + sy + \", y(unit))\" : '')\n                        ].filter(function (expr) { return !!expr; }).join(', ') + '}'\n                }]\n        }, {\n            name: delta,\n            on: [{\n                    events: events,\n                    force: true,\n                    update: 'pow(1.001, event.deltaY * pow(16, event.deltaMode))'\n                }]\n        });\n        if (x !== null) {\n            onDelta(model, selCmpt, 'x', 'width', signals);\n        }\n        if (y !== null) {\n            onDelta(model, selCmpt, 'y', 'height', signals);\n        }\n        return signals;\n    }\n};\nexport default zoom;\nfunction onDelta(model, selCmpt, channel, size, signals) {\n    var name = selCmpt.name;\n    var hasScales = scalesCompiler.has(selCmpt);\n    var signal = signals.filter(function (s) {\n        return s.name === channelSignalName(selCmpt, channel, hasScales ? 'data' : 'visual');\n    })[0];\n    var sizeSg = model.getSizeSignalRef(size).signal;\n    var scaleCmpt = model.getScaleComponent(channel);\n    var scaleType = scaleCmpt.get('type');\n    var base = hasScales ? domain(model, channel) : signal.name;\n    var delta = name + DELTA;\n    var anchor = \"\" + name + ANCHOR + \".\" + channel;\n    var zoomFn = !hasScales ? 'zoomLinear' :\n        scaleType === 'log' ? 'zoomLog' :\n            scaleType === 'pow' ? 'zoomPow' : 'zoomLinear';\n    var update = zoomFn + \"(\" + base + \", \" + anchor + \", \" + delta +\n        (hasScales && scaleType === 'pow' ? \", \" + (scaleCmpt.get('exponent') || 1) : '') + ')';\n    signal.on.push({\n        events: { signal: delta },\n        update: hasScales ? update : \"clampRange(\" + update + \", 0, \" + sizeSg + \")\"\n    });\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiem9vbS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9jb21waWxlL3NlbGVjdGlvbi90cmFuc2Zvcm1zL3pvb20udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFDLFFBQVEsSUFBSSxhQUFhLEVBQUMsTUFBTSxxQkFBcUIsQ0FBQztBQUM5RCxPQUFPLEVBQUMsV0FBVyxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBQ3RDLE9BQU8sRUFBZSxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sa0JBQWtCLENBQUM7QUFFcEQsT0FBTyxFQUFDLEtBQUssSUFBSSxjQUFjLEVBQUMsTUFBTSxhQUFhLENBQUM7QUFDcEQsT0FBTyxFQUFDLGlCQUFpQixFQUFFLHFCQUFxQixFQUFxQixNQUFNLGNBQWMsQ0FBQztBQUUxRixPQUFPLEVBQUMsT0FBTyxJQUFJLGNBQWMsRUFBRSxNQUFNLEVBQUMsTUFBTSxVQUFVLENBQUM7QUFJM0QsSUFBTSxNQUFNLEdBQUcsY0FBYyxDQUFDO0FBQzlCLElBQU0sS0FBSyxHQUFHLGFBQWEsQ0FBQztBQUU1QixJQUFNLElBQUksR0FBcUI7SUFDN0IsR0FBRyxFQUFFLFVBQVMsT0FBTztRQUNuQixPQUFPLE9BQU8sQ0FBQyxJQUFJLEtBQUssVUFBVSxJQUFJLE9BQU8sQ0FBQyxJQUFJLENBQUM7SUFDckQsQ0FBQztJQUVELE9BQU8sRUFBRSxVQUFTLEtBQUssRUFBRSxPQUFPLEVBQUUsT0FBTztRQUN2QyxJQUFNLElBQUksR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDO1FBQzFCLElBQU0sU0FBUyxHQUFHLGNBQWMsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDOUMsSUFBTSxLQUFLLEdBQUcsSUFBSSxHQUFHLEtBQUssQ0FBQztRQUNyQixJQUFBLG1DQUF1QyxFQUF0QyxRQUFDLEVBQUUsUUFBQyxDQUFtQztRQUM5QyxJQUFNLEVBQUUsR0FBRyxXQUFXLENBQUMsS0FBSyxD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LENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUM7SUFDOUQsSUFBTSxLQUFLLEdBQUcsSUFBSSxHQUFHLEtBQUssQ0FBQztJQUMzQixJQUFNLE1BQU0sR0FBRyxLQUFHLElBQUksR0FBRyxNQUFNLFNBQUksT0FBUyxDQUFDO0lBQzdDLElBQU0sTUFBTSxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUN4QyxTQUFTLEtBQUssS0FBSyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUNqQyxTQUFTLEtBQUssS0FBSyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQztJQUNqRCxJQUFNLE1BQU0sR0FBTSxNQUFNLFNBQUksSUFBSSxVQUFLLE1BQU0sVUFBSyxLQUFPO1FBQ3JELENBQUMsU0FBUyxJQUFJLFNBQVMsS0FBSyxLQUFLLENBQUMsQ0FBQyxDQUFDLFFBQUssU0FBUyxDQUFDLEdBQUcsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxDQUFDO0lBRXhGLE1BQU0sQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDO1FBQ2IsTUFBTSxFQUFFLEVBQUMsTUFBTSxFQUFFLEtBQUssRUFBQztRQUN2QixNQUFNLEVBQUUsU0FBUyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLGdCQUFjLE1BQU0sYUFBUSxNQUFNLE1BQUc7S0FDbkUsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7c2VsZWN0b3IgYXMgcGFyc2VTZWxlY3Rvcn0gZnJvbSAndmVnYS1ldmVudC1zZWxlY3Rvcic7XG5pbXBvcnQge3N0cmluZ1ZhbHVlfSBmcm9tICd2ZWdhLXV0aWwnO1xuaW1wb3J0IHtTY2FsZUNoYW5uZWwsIFgsIFl9IGZyb20gJy4uLy4uLy4uL2NoYW5uZWwnO1xuaW1wb3J0IHtWZ1NpZ25hbH0gZnJvbSAnLi4vLi4vLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtCUlVTSCBhcyBJTlRFUlZBTF9CUlVTSH0gZnJvbSAnLi4vaW50ZXJ2YWwnO1xuaW1wb3J0IHtjaGFubmVsU2lnbmFsTmFtZSwgcG9zaXRpb25hbFByb2plY3Rpb25zLCBTZWxlY3Rpb25Db21wb25lbnR9IGZyb20gJy4uL3NlbGVjdGlvbic7XG5pbXBvcnQge1VuaXRNb2RlbH0gZnJvbSAnLi8uLi8uLi91bml0JztcbmltcG9ydCB7ZGVmYXVsdCBhcyBzY2FsZXNDb21waWxlciwgZG9tYWlufSBmcm9tICcuL3NjYWxlcyc7XG5pbXBvcnQge1RyYW5zZm9ybUNvbXBpbGVyfSBmcm9tICcuL3RyYW5zZm9ybXMnO1xuXG5cbmNvbnN0IEFOQ0hPUiA9ICdfem9vbV9hbmNob3InO1xuY29uc3QgREVMVEEgPSAnX3pvb21fZGVsdGEnO1xuXG5jb25zdCB6b29tOlRyYW5zZm9ybUNvbXBpbGVyID0ge1xuICBoYXM6IGZ1bmN0aW9uKHNlbENtcHQpIHtcbiAgICByZXR1cm4gc2VsQ21wdC50eXBlID09PSAnaW50ZXJ2YWwnICYmIHNlbENtcHQuem9vbTtcbiAgfSxcblxuICBzaWduYWxzOiBmdW5jdGlvbihtb2RlbCwgc2VsQ21wdCwgc2lnbmFscykge1xuICAgIGNvbnN0IG5hbWUgPSBzZWxDbXB0Lm5hbWU7XG4gICAgY29uc3QgaGFzU2NhbGVzID0gc2NhbGVzQ29tcGlsZXIuaGFzKHNlbENtcHQpO1xuICAgIGNvbnN0IGRlbHRhID0gbmFtZSArIERFTFRBO1xuICAgIGNvbnN0IHt4LCB5fSA9IHBvc2l0aW9uYWxQcm9qZWN0aW9ucyhzZWxDbXB0KTtcbiAgICBjb25zdCBzeCA9IHN0cmluZ1ZhbHVlKG1vZGVsLnNjYWxlTmFtZShYKSk7XG4gICAgY29uc3Qgc3kgPSBzdHJpbmdWYWx1ZShtb2RlbC5zY2FsZU5hbWUoWSkpO1xuICAgIGxldCBldmVudHMgPSBwYXJzZVNlbGVjdG9yKHNlbENtcHQuem9vbSwgJ3Njb3BlJyk7XG5cbiAgICBpZiAoIWhhc1NjYWxlcykge1xuICAgICAgZXZlbnRzID0gZXZlbnRzLm1hcCgoZSkgPT4gKGUubWFya25hbWUgPSBuYW1lICsgSU5URVJWQUxfQlJVU0gsIGUpKTtcbiAgICB9XG5cbiAgICBzaWduYWxzLnB1c2goe1xuICAgICAgbmFtZTogbmFtZSArIEFOQ0hPUixcbiAgICAgIG9uOiBbe1xuICAgICAgICBldmVudHM6IGV2ZW50cyxcbiAgICAgICAgdXBkYXRlOiAhaGFzU2NhbGVzID8gYHt4OiB4KHVuaXQpLCB5OiB5KHVuaXQpfWAgOlxuICAgICAgICAgICd7JyArIFtcbiAgICAgICAgICAgIChzeCA/IGB4OiBpbnZlcnQoJHtzeH0sIHgodW5pdCkpYCA6ICcnKSxcbiAgICAgICAgICAgIChzeSA/IGB5OiBpbnZlcnQoJHtzeX0sIHkodW5pdCkpYCA6ICcnKVxuICAgICAgICAgIF0uZmlsdGVyKChleHByKSA9PiAhIWV4cHIpLmpvaW4oJywgJykgKyAnfSdcbiAgICAgIH1dXG4gICAgfSwge1xuICAgICAgbmFtZTogZGVsdGEsXG4gICAgICBvbjogW3tcbiAgICAgICAgZXZlbnRzOiBldmVudHMsXG4gICAgICAgIGZvcmNlOiB0cnVlLFxuICAgICAgICB1cGRhdGU6ICdwb3coMS4wMDEsIGV2ZW50LmRlbHRhWSAqIHBvdygxNiwgZXZlbnQuZGVsdGFNb2RlKSknXG4gICAgICB9XVxuICAgIH0pO1xuXG4gICAgaWYgKHggIT09IG51bGwpIHtcbiAgICAgIG9uRGVsdGEobW9kZWwsIHNlbENtcHQsICd4JywgJ3dpZHRoJywgc2lnbmFscyk7XG4gICAgfVxuXG4gICAgaWYgKHkgIT09IG51bGwpIHtcbiAgICAgIG9uRGVsdGEobW9kZWwsIHNlbENtcHQsICd5JywgJ2hlaWdodCcsIHNpZ25hbHMpO1xuICAgIH1cblxuICAgIHJldHVybiBzaWduYWxzO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCB6b29tO1xuXG5mdW5jdGlvbiBvbkRlbHRhKG1vZGVsOiBVbml0TW9kZWwsIHNlbENtcHQ6IFNlbGVjdGlvbkNvbXBvbmVudCwgY2hhbm5lbDogU2NhbGVDaGFubmVsLCBzaXplOiAnd2lkdGgnIHwgJ2hlaWdodCcsIHNpZ25hbHM6IFZnU2lnbmFsW10pIHtcbiAgY29uc3QgbmFtZSA9IHNlbENtcHQubmFtZTtcbiAgY29uc3QgaGFzU2NhbGVzID0gc2NhbGVzQ29tcGlsZXIuaGFzKHNlbENtcHQpO1xuICBjb25zdCBzaWduYWwgPSBzaWduYWxzLmZpbHRlcihzID0+IHtcbiAgICByZXR1cm4gcy5uYW1lID09PSBjaGFubmVsU2lnbmFsTmFtZShzZWxDbXB0LCBjaGFubmVsLCBoYXNTY2FsZXMgPyAnZGF0YScgOiAndmlzdWFsJyk7XG4gIH0pWzBdO1xuICBjb25zdCBzaXplU2cgPSBtb2RlbC5nZXRTaXplU2lnbmFsUmVmKHNpemUpLnNpZ25hbDtcbiAgY29uc3Qgc2NhbGVDbXB0ID0gbW9kZWwuZ2V0U2NhbGVDb21wb25lbnQoY2hhbm5lbCk7XG4gIGNvbnN0IHNjYWxlVHlwZSA9IHNjYWxlQ21wdC5nZXQoJ3R5cGUnKTtcbiAgY29uc3QgYmFzZSA9IGhhc1NjYWxlcyA/IGRvbWFpbihtb2RlbCwgY2hhbm5lbCkgOiBzaWduYWwubmFtZTtcbiAgY29uc3QgZGVsdGEgPSBuYW1lICsgREVMVEE7XG4gIGNvbnN0IGFuY2hvciA9IGAke25hbWV9JHtBTkNIT1J9LiR7Y2hhbm5lbH1gO1xuICBjb25zdCB6b29tRm4gPSAhaGFzU2NhbGVzID8gJ3pvb21MaW5lYXInIDpcbiAgICBzY2FsZVR5cGUgPT09ICdsb2cnID8gJ3pvb21Mb2cnIDpcbiAgICBzY2FsZVR5cGUgPT09ICdwb3cnID8gJ3pvb21Qb3cnIDogJ3pvb21MaW5lYXInO1xuICBjb25zdCB1cGRhdGUgPSBgJHt6b29tRm59KCR7YmFzZX0sICR7YW5jaG9yfSwgJHtkZWx0YX1gICtcbiAgICAoaGFzU2NhbGVzICYmIHNjYWxlVHlwZSA9PT0gJ3BvdycgPyBgLCAke3NjYWxlQ21wdC5nZXQoJ2V4cG9uZW50JykgfHwgMX1gIDogJycpICsgJyknO1xuXG4gIHNpZ25hbC5vbi5wdXNoKHtcbiAgICBldmVudHM6IHtzaWduYWw6IGRlbHRhfSxcbiAgICB1cGRhdGU6IGhhc1NjYWxlcyA/IHVwZGF0ZSA6IGBjbGFtcFJhbmdlKCR7dXBkYXRlfSwgMCwgJHtzaXplU2d9KWBcbiAgfSk7XG59XG4iXX0=","import inputs from './inputs';\nimport nearest from './nearest';\nimport project from './project';\nimport scales from './scales';\nimport toggle from './toggle';\nimport translate from './translate';\nimport zoom from './zoom';\nvar compilers = { project: project, toggle: toggle, scales: scales,\n    translate: translate, zoom: zoom, inputs: inputs, nearest: nearest };\nexport function forEachTransform(selCmpt, cb) {\n    for (var t in compilers) {\n        if (compilers[t].has(selCmpt)) {\n            cb(compilers[t]);\n        }\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNmb3Jtcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9jb21waWxlL3NlbGVjdGlvbi90cmFuc2Zvcm1zL3RyYW5zZm9ybXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBaUJBLE9BQU8sTUFBTSxNQUFNLFVBQVUsQ0FBQztBQUM5QixPQUFPLE9BQU8sTUFBTSxXQUFXLENBQUM7QUFDaEMsT0FBTyxPQUFPLE1BQU0sV0FBVyxDQUFDO0FBQ2hDLE9BQU8sTUFBTSxNQUFNLFVBQVUsQ0FBQztBQUM5QixPQUFPLE1BQU0sTUFBTSxVQUFVLENBQUM7QUFDOUIsT0FBTyxTQUFTLE1BQU0sYUFBYSxDQUFDO0FBQ3BDLE9BQU8sSUFBSSxNQUFNLFFBQVEsQ0FBQztBQUMxQixJQUFNLFNBQVMsR0FBNEIsRUFBQyxPQUFPLFNBQUEsRUFBRSxNQUFNLFFBQUEsRUFBRSxNQUFNLFFBQUE7SUFDakUsU0FBUyxXQUFBLEVBQUUsSUFBSSxNQUFBLEVBQUUsTUFBTSxRQUFBLEVBQUUsT0FBTyxTQUFBLEVBQUMsQ0FBQztBQUVwQyxNQUFNLDJCQUEyQixPQUEyQixFQUFFLEVBQW1DO0lBQy9GLEtBQUssSUFBTSxDQUFDLElBQUksU0FBUyxFQUFFO1FBQ3pCLElBQUksU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsRUFBRTtZQUM3QixFQUFFLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDbEI7S0FDRjtBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1NlbGVjdGlvbkRlZn0gZnJvbSAnLi4vLi4vLi4vc2VsZWN0aW9uJztcbmltcG9ydCB7RGljdH0gZnJvbSAnLi4vLi4vLi4vdXRpbCc7XG5pbXBvcnQge1ZnU2lnbmFsfSBmcm9tICcuLi8uLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge01vZGVsfSBmcm9tICcuLi8uLi9tb2RlbCc7XG5pbXBvcnQge1VuaXRNb2RlbH0gZnJvbSAnLi4vLi4vdW5pdCc7XG5pbXBvcnQge1NlbGVjdGlvbkNvbXBvbmVudH0gZnJvbSAnLi4vc2VsZWN0aW9uJztcblxuXG5leHBvcnQgaW50ZXJmYWNlIFRyYW5zZm9ybUNvbXBpbGVyIHtcbiAgaGFzOiAoc2VsQ21wdDogU2VsZWN0aW9uQ29tcG9uZW50IHwgU2VsZWN0aW9uRGVmKSA9PiBib29sZWFuO1xuICBwYXJzZT86IChtb2RlbDogVW5pdE1vZGVsLCBkZWY6IFNlbGVjdGlvbkRlZiwgc2VsQ21wdDogU2VsZWN0aW9uQ29tcG9uZW50KSA9PiB2b2lkO1xuICBzaWduYWxzPzogKG1vZGVsOiBVbml0TW9kZWwsIHNlbENtcHQ6IFNlbGVjdGlvbkNvbXBvbmVudCwgc2lnbmFsczogVmdTaWduYWxbXSkgPT4gVmdTaWduYWxbXTtcbiAgdG9wTGV2ZWxTaWduYWxzPzogKG1vZGVsOiBNb2RlbCwgc2VsQ21wdDogU2VsZWN0aW9uQ29tcG9uZW50LCBzaWduYWxzOiBWZ1NpZ25hbFtdKSA9PiBWZ1NpZ25hbFtdO1xuICBtb2RpZnlFeHByPzogKG1vZGVsOiBVbml0TW9kZWwsIHNlbENtcHQ6IFNlbGVjdGlvbkNvbXBvbmVudCwgZXhwcjogc3RyaW5nKSA9PiBzdHJpbmc7XG4gIG1hcmtzPzogKG1vZGVsOiBVbml0TW9kZWwsIHNlbENtcHQ6U2VsZWN0aW9uQ29tcG9uZW50LCBtYXJrczogYW55W10pID0+IGFueVtdO1xufVxuXG5pbXBvcnQgaW5wdXRzIGZyb20gJy4vaW5wdXRzJztcbmltcG9ydCBuZWFyZXN0IGZyb20gJy4vbmVhcmVzdCc7XG5pbXBvcnQgcHJvamVjdCBmcm9tICcuL3Byb2plY3QnO1xuaW1wb3J0IHNjYWxlcyBmcm9tICcuL3NjYWxlcyc7XG5pbXBvcnQgdG9nZ2xlIGZyb20gJy4vdG9nZ2xlJztcbmltcG9ydCB0cmFuc2xhdGUgZnJvbSAnLi90cmFuc2xhdGUnO1xuaW1wb3J0IHpvb20gZnJvbSAnLi96b29tJztcbmNvbnN0IGNvbXBpbGVyczogRGljdDxUcmFuc2Zvcm1Db21waWxlcj4gPSB7cHJvamVjdCwgdG9nZ2xlLCBzY2FsZXMsXG4gIHRyYW5zbGF0ZSwgem9vbSwgaW5wdXRzLCBuZWFyZXN0fTtcblxuZXhwb3J0IGZ1bmN0aW9uIGZvckVhY2hUcmFuc2Zvcm0oc2VsQ21wdDogU2VsZWN0aW9uQ29tcG9uZW50LCBjYjogKHR4OiBUcmFuc2Zvcm1Db21waWxlcikgPT4gdm9pZCkge1xuICBmb3IgKGNvbnN0IHQgaW4gY29tcGlsZXJzKSB7XG4gICAgaWYgKGNvbXBpbGVyc1t0XS5oYXMoc2VsQ21wdCkpIHtcbiAgICAgIGNiKGNvbXBpbGVyc1t0XSk7XG4gICAgfVxuICB9XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { selector as parseSelector } from 'vega-event-selector';\nimport { isString, stringValue } from 'vega-util';\nimport { X, Y } from '../../channel';\nimport { warn } from '../../log';\nimport { SELECTION_ID } from '../../selection';\nimport { accessPathWithDatum, logicalExpr, varName } from '../../util';\nimport { isFacetModel, isUnitModel } from '../model';\nimport intervalCompiler from './interval';\nimport multiCompiler from './multi';\nimport singleCompiler from './single';\nimport { forEachTransform } from './transforms/transforms';\nexport var STORE = '_store';\nexport var TUPLE = '_tuple';\nexport var MODIFY = '_modify';\nexport var SELECTION_DOMAIN = '_selection_domain_';\nexport function parseUnitSelection(model, selDefs) {\n    var selCmpts = {};\n    var selectionConfig = model.config.selection;\n    var _loop_1 = function (name_1) {\n        if (!selDefs.hasOwnProperty(name_1)) {\n            return \"continue\";\n        }\n        var selDef = selDefs[name_1];\n        var cfg = selectionConfig[selDef.type];\n        // Set default values from config if a property hasn't been specified,\n        // or if it is true. E.g., \"translate\": true should use the default\n        // event handlers for translate. However, true may be a valid value for\n        // a property (e.g., \"nearest\": true).\n        for (var key in cfg) {\n            // A selection should contain either `encodings` or `fields`, only use\n            // default values for these two values if neither of them is specified.\n            if ((key === 'encodings' && selDef.fields) || (key === 'fields' && selDef.encodings)) {\n                continue;\n            }\n            if (key === 'mark') {\n                selDef[key] = tslib_1.__assign({}, cfg[key], selDef[key]);\n            }\n            if (selDef[key] === undefined || selDef[key] === true) {\n                selDef[key] = cfg[key] || selDef[key];\n            }\n        }\n        name_1 = varName(name_1);\n        var selCmpt = selCmpts[name_1] = tslib_1.__assign({}, selDef, { name: name_1, events: isString(selDef.on) ? parseSelector(selDef.on, 'scope') : selDef.on });\n        forEachTransform(selCmpt, function (txCompiler) {\n            if (txCompiler.parse) {\n                txCompiler.parse(model, selDef, selCmpt);\n            }\n        });\n    };\n    for (var name_1 in selDefs) {\n        _loop_1(name_1);\n    }\n    return selCmpts;\n}\nexport function assembleUnitSelectionSignals(model, signals) {\n    forEachSelection(model, function (selCmpt, selCompiler) {\n        var name = selCmpt.name;\n        var modifyExpr = selCompiler.modifyExpr(model, selCmpt);\n        signals.push.apply(signals, selCompiler.signals(model, selCmpt));\n        forEachTransform(selCmpt, function (txCompiler) {\n            if (txCompiler.signals) {\n                signals = txCompiler.signals(model, selCmpt, signals);\n            }\n            if (txCompiler.modifyExpr) {\n                modifyExpr = txCompiler.modifyExpr(model, selCmpt, modifyExpr);\n            }\n        });\n        signals.push({\n            name: name + MODIFY,\n            on: [{\n                    events: { signal: name + TUPLE },\n                    update: \"modify(\" + stringValue(selCmpt.name + STORE) + \", \" + modifyExpr + \")\"\n                }]\n        });\n    });\n    var facetModel = getFacetModel(model);\n    if (signals.length && facetModel) {\n        var name_2 = stringValue(facetModel.getName('cell'));\n        signals.unshift({\n            name: 'facet',\n            value: {},\n            on: [{\n                    events: parseSelector('mousemove', 'scope'),\n                    update: \"isTuple(facet) ? facet : group(\" + name_2 + \").datum\"\n                }]\n        });\n    }\n    return signals;\n}\nexport function assembleTopLevelSignals(model, signals) {\n    var needsUnit = false;\n    forEachSelection(model, function (selCmpt, selCompiler) {\n        if (selCompiler.topLevelSignals) {\n            signals = selCompiler.topLevelSignals(model, selCmpt, signals);\n        }\n        forEachTransform(selCmpt, function (txCompiler) {\n            if (txCompiler.topLevelSignals) {\n                signals = txCompiler.topLevelSignals(model, selCmpt, signals);\n            }\n        });\n        needsUnit = true;\n    });\n    if (needsUnit) {\n        var hasUnit = signals.filter(function (s) { return s.name === 'unit'; });\n        if (!(hasUnit.length)) {\n            signals.unshift({\n                name: 'unit',\n                value: {},\n                on: [{ events: 'mousemove', update: 'isTuple(group()) ? group() : unit' }]\n            });\n        }\n    }\n    return signals;\n}\nexport function assembleUnitSelectionData(model, data) {\n    forEachSelection(model, function (selCmpt) {\n        var contains = data.filter(function (d) { return d.name === selCmpt.name + STORE; });\n        if (!contains.length) {\n            data.push({ name: selCmpt.name + STORE });\n        }\n    });\n    return data;\n}\nexport function assembleUnitSelectionMarks(model, marks) {\n    forEachSelection(model, function (selCmpt, selCompiler) {\n        marks = selCompiler.marks ? selCompiler.marks(model, selCmpt, marks) : marks;\n        forEachTransform(selCmpt, function (txCompiler) {\n            if (txCompiler.marks) {\n                marks = txCompiler.marks(model, selCmpt, marks);\n            }\n        });\n    });\n    return marks;\n}\nexport function assembleLayerSelectionMarks(model, marks) {\n    model.children.forEach(function (child) {\n        if (isUnitModel(child)) {\n            marks = assembleUnitSelectionMarks(child, marks);\n        }\n    });\n    return marks;\n}\nexport function selectionPredicate(model, selections, dfnode) {\n    var stores = [];\n    function expr(name) {\n        var vname = varName(name);\n        var selCmpt = model.getSelectionComponent(vname, name);\n        var store = stringValue(vname + STORE);\n        if (selCmpt.timeUnit) {\n            var child = dfnode || model.component.data.raw;\n            var tunode = selCmpt.timeUnit.clone();\n            if (child.parent) {\n                tunode.insertAsParentOf(child);\n            }\n            else {\n                child.parent = tunode;\n            }\n        }\n        if (selCmpt.empty !== 'none') {\n            stores.push(store);\n        }\n        return compiler(selCmpt.type).predicate + (\"(\" + store + \", datum\") +\n            (selCmpt.resolve === 'global' ? ')' : \", \" + stringValue(selCmpt.resolve) + \")\");\n    }\n    var predicateStr = logicalExpr(selections, expr);\n    return (stores.length\n        ? '!(' + stores.map(function (s) { return \"length(data(\" + s + \"))\"; }).join(' || ') + ') || '\n        : '') + (\"(\" + predicateStr + \")\");\n}\n// Selections are parsed _after_ scales. If a scale domain is set to\n// use a selection, the SELECTION_DOMAIN constant is used as the\n// domainRaw.signal during scale.parse and then replaced with the necessary\n// selection expression function during scale.assemble. To not pollute the\n// type signatures to account for this setup, the selection domain definition\n// is coerced to a string and appended to SELECTION_DOMAIN.\nexport function isRawSelectionDomain(domainRaw) {\n    return domainRaw.signal.indexOf(SELECTION_DOMAIN) >= 0;\n}\nexport function selectionScaleDomain(model, domainRaw) {\n    var selDomain = JSON.parse(domainRaw.signal.replace(SELECTION_DOMAIN, ''));\n    var name = varName(selDomain.selection);\n    var selCmpt = model.component.selection && model.component.selection[name];\n    if (selCmpt) {\n        warn('Use \"bind\": \"scales\" to setup a binding for scales and selections within the same view.');\n    }\n    else {\n        selCmpt = model.getSelectionComponent(name, selDomain.selection);\n        if (!selDomain.encoding && !selDomain.field) {\n            selDomain.field = selCmpt.project[0].field;\n            if (selCmpt.project.length > 1) {\n                warn('A \"field\" or \"encoding\" must be specified when using a selection as a scale domain. ' +\n                    (\"Using \\\"field\\\": \" + stringValue(selDomain.field) + \".\"));\n            }\n        }\n        return {\n            signal: compiler(selCmpt.type).scaleDomain +\n                (\"(\" + stringValue(name + STORE) + \", \" + stringValue(selDomain.encoding || null) + \", \") +\n                stringValue(selDomain.field || null) +\n                (selCmpt.resolve === 'global' ? ')' : \", \" + stringValue(selCmpt.resolve) + \")\")\n        };\n    }\n    return { signal: 'null' };\n}\n// Utility functions\nfunction forEachSelection(model, cb) {\n    var selections = model.component.selection;\n    for (var name_3 in selections) {\n        if (selections.hasOwnProperty(name_3)) {\n            var sel = selections[name_3];\n            cb(sel, compiler(sel.type));\n        }\n    }\n}\nfunction compiler(type) {\n    switch (type) {\n        case 'single':\n            return singleCompiler;\n        case 'multi':\n            return multiCompiler;\n        case 'interval':\n            return intervalCompiler;\n    }\n    return null;\n}\nfunction getFacetModel(model) {\n    var parent = model.parent;\n    while (parent) {\n        if (isFacetModel(parent)) {\n            break;\n        }\n        parent = parent.parent;\n    }\n    return parent;\n}\nexport function unitName(model) {\n    var name = stringValue(model.name);\n    var facet = getFacetModel(model);\n    if (facet) {\n        name += (facet.facet.row ? \" + '_' + (\" + accessPathWithDatum(facet.vgField('row'), 'facet') + \")\" : '')\n            + (facet.facet.column ? \" + '_' + (\" + accessPathWithDatum(facet.vgField('column'), 'facet') + \")\" : '');\n    }\n    return name;\n}\nexport function requiresSelectionId(model) {\n    var identifier = false;\n    forEachSelection(model, function (selCmpt) {\n        identifier = identifier || selCmpt.project.some(function (proj) { return proj.field === SELECTION_ID; });\n    });\n    return identifier;\n}\nexport function channelSignalName(selCmpt, channel, range) {\n    var sgNames = selCmpt._signalNames || (selCmpt._signalNames = {});\n    if (sgNames[channel] && sgNames[channel][range]) {\n        return sgNames[channel][range];\n    }\n    sgNames[channel] = sgNames[channel] || {};\n    var basename = varName(selCmpt.name + '_' + (range === 'visual' ? channel : selCmpt.fields[channel]));\n    var name = basename;\n    var counter = 1;\n    while (sgNames[name]) {\n        name = basename + \"_\" + counter++;\n    }\n    return (sgNames[name] = sgNames[channel][range] = name);\n}\nexport function positionalProjections(selCmpt) {\n    var x = null;\n    var xi = null;\n    var y = null;\n    var yi = null;\n    selCmpt.project.forEach(function (p, i) {\n        if (p.channel === X) {\n            x = p;\n            xi = i;\n        }\n        else if (p.channel === Y) {\n            y = p;\n            yi = i;\n        }\n    });\n    return { x: x, xi: xi, y: y, yi: yi };\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VsZWN0aW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvc2VsZWN0aW9uL3NlbGVjdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFDLFFBQVEsSUFBSSxhQUFhLEVBQUMsTUFBTSxxQkFBcUIsQ0FBQztBQUM5RCxPQUFPLEVBQUMsUUFBUSxFQUFFLFdBQVcsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUNoRCxPQUFPLEVBQXdCLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDMUQsT0FBTyxFQUFDLElBQUksRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUUvQixPQUFPLEVBQWMsWUFBWSxFQUFtRCxNQUFNLGlCQUFpQixDQUFDO0FBQzVHLE9BQU8sRUFBQyxtQkFBbUIsRUFBUSxXQUFXLEVBQUUsT0FBTyxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBTTNFLE9BQU8sRUFBQyxZQUFZLEVBQUUsV0FBVyxFQUFRLE1BQU0sVUFBVSxDQUFDO0FBRTFELE9BQU8sZ0JBQWdCLE1BQU0sWUFBWSxDQUFDO0FBQzFDLE9BQU8sYUFBYSxNQUFNLFNBQVMsQ0FBQztBQUVwQyxPQUFPLGNBQWMsTUFBTSxVQUFVLENBQUM7QUFDdEMsT0FBTyxFQUFDLGdCQUFnQixFQUFDLE1BQU0seUJBQXlCLENBQUM7QUFHekQsTUFBTSxDQUFDLElBQU0sS0FBSyxHQUFHLFFBQVEsQ0FBQztBQUM5QixNQUFNLENBQUMsSUFBTSxLQUFLLEdBQUcsUUFBUSxDQUFDO0FBQzlCLE1BQU0sQ0FBQyxJQUFNLE1BQU0sR0FBRyxTQUFTLENBQUM7QUFDaEMsTUFBTSxDQUFDLElBQU0sZ0JBQWdCLEdBQUcsb0JBQW9CLENBQUM7QUF1Q3JELE1BQU0sNkJBQTZCLEtBQWdCLEVBQUUsT0FBMkI7SUFDOUUsSUFBTSxRQUFRLEdBQTZCLEVBQUUsQ0FBQztJQUM5QyxJQUFNLGVBQWUsR0FBRyxLQUFLLENBQUMsTUFB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T0FBTyxDQUFDLE9BQU8sQ0FBQyxVQUFDLENBQUMsRUFBRSxDQUFDO1FBQzNCLElBQUksQ0FBQyxDQUFDLE9BQU8sS0FBSyxDQUFDLEVBQUU7WUFDbkIsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNOLEVBQUUsR0FBRyxDQUFDLENBQUM7U0FDUjthQUFNLElBQUksQ0FBQyxDQUFDLE9BQU8sS0FBSyxDQUFDLEVBQUU7WUFDMUIsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNOLEVBQUUsR0FBRyxDQUFDLENBQUM7U0FDUjtJQUNILENBQUMsQ0FBQyxDQUFDO0lBQ0gsT0FBTyxFQUFDLENBQUMsR0FBQSxFQUFFLEVBQUUsSUFBQSxFQUFFLENBQUMsR0FBQSxFQUFFLEVBQUUsSUFBQSxFQUFDLENBQUM7QUFDeEIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7c2VsZWN0b3IgYXMgcGFyc2VTZWxlY3Rvcn0gZnJvbSAndmVnYS1ldmVudC1zZWxlY3Rvcic7XG5pbXBvcnQge2lzU3RyaW5nLCBzdHJpbmdWYWx1ZX0gZnJvbSAndmVnYS11dGlsJztcbmltcG9ydCB7Q2hhbm5lbCwgU2NhbGVDaGFubmVsLCBYLCBZfSBmcm9tICcuLi8uLi9jaGFubmVsJztcbmltcG9ydCB7d2Fybn0gZnJvbSAnLi4vLi4vbG9nJztcbmltcG9ydCB7TG9naWNhbE9wZXJhbmR9IGZyb20gJy4uLy4uL2xvZ2ljYWwnO1xuaW1wb3J0IHtCcnVzaENvbmZpZywgU0VMRUNUSU9OX0lELCBTZWxlY3Rpb25EZWYsIFNlbGVjdGlvblJlc29sdXRpb24sIFNlbGVjdGlvblR5cGV9IGZyb20gJy4uLy4uL3NlbGVjdGlvbic7XG5pbXBvcnQge2FjY2Vzc1BhdGhXaXRoRGF0dW0sIERpY3QsIGxvZ2ljYWxFeHByLCB2YXJOYW1lfSBmcm9tICcuLi8uLi91dGlsJztcbmltcG9ydCB7VmdCaW5kaW5nLCBWZ0RhdGEsIFZnRXZlbnRTdHJlYW0sIFZnU2lnbmFsUmVmfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge0RhdGFGbG93Tm9kZX0gZnJvbSAnLi4vZGF0YS9kYXRhZmxvdyc7XG5pbXBvcnQge1RpbWVVbml0Tm9kZX0gZnJvbSAnLi4vZGF0YS90aW1ldW5pdCc7XG5pbXBvcnQge0ZhY2V0TW9kZWx9IGZyb20gJy4uL2ZhY2V0JztcbmltcG9ydCB7TGF5ZXJNb2RlbH0gZnJvbSAnLi4vbGF5ZXInO1xuaW1wb3J0IHtpc0ZhY2V0TW9kZWwsIGlzVW5pdE1vZGVsLCBNb2RlbH0gZnJvbSAnLi4vbW9kZWwnO1xuaW1wb3J0IHtVbml0TW9kZWx9IGZyb20gJy4uL3VuaXQnO1xuaW1wb3J0IGludGVydmFsQ29tcGlsZXIgZnJvbSAnLi9pbnRlcnZhbCc7XG5pbXBvcnQgbXVsdGlDb21waWxlciBmcm9tICcuL211bHRpJztcbmltcG9ydCB7U2VsZWN0aW9uQ29tcG9uZW50fSBmcm9tICcuL3NlbGVjdGlvbic7XG5pbXBvcnQgc2luZ2xlQ29tcGlsZXIgZnJvbSAnLi9zaW5nbGUnO1xuaW1wb3J0IHtmb3JFYWNoVHJhbnNmb3JtfSBmcm9tICcuL3RyYW5zZm9ybXMvdHJhbnNmb3Jtcyc7XG5cblxuZXhwb3J0IGNvbnN0IFNUT1JFID0gJ19zdG9yZSc7XG5leHBvcnQgY29uc3QgVFVQTEUgPSAnX3R1cGxlJztcbmV4cG9ydCBjb25zdCBNT0RJRlkgPSAnX21vZGlmeSc7XG5leHBvcnQgY29uc3QgU0VMRUNUSU9OX0RPTUFJTiA9ICdfc2VsZWN0aW9uX2RvbWFpbl8nO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNlbGVjdGlvbkNvbXBvbmVudCB7XG4gIG5hbWU6IHN0cmluZztcbiAgdHlwZTogU2VsZWN0aW9uVHlwZTtcbiAgZXZlbnRzOiBWZ0V2ZW50U3RyZWFtO1xuICAvLyBwcmVkaWNhdGU/OiBzdHJpbmc7XG4gIGJpbmQ/OiAnc2NhbGVzJyB8IFZnQmluZGluZyB8IHtba2V5OiBzdHJpbmddOiBWZ0JpbmRpbmd9O1xuICByZXNvbHZlOiBTZWxlY3Rpb25SZXNvbHV0aW9uO1xuICBlbXB0eTogJ2FsbCcgfCAnbm9uZSc7XG4gIG1hcms/OiBCcnVzaENvbmZpZztcblxuICBfc2lnbmFsTmFtZXM6IHt9O1xuXG4gIC8vIFRyYW5zZm9ybXNcbiAgcHJvamVjdD86IFByb2plY3RDb21wb25lbnRbXTtcbiAgZmllbGRzPzogYW55O1xuICB0aW1lVW5pdD86IFRpbWVVbml0Tm9kZTtcbiAgc2NhbGVzPzogQ2hhbm5lbFtdO1xuICB0b2dnbGU/OiBhbnk7XG4gIHRyYW5zbGF0ZT86IGFueTtcbiAgem9vbT86IGFueTtcbiAgbmVhcmVzdD86IGFueTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQcm9qZWN0Q29tcG9uZW50IHtcbiAgZmllbGQ/OiBzdHJpbmc7XG4gIGNoYW5uZWw/OiBTY2FsZUNoYW5uZWw7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VsZWN0aW9uQ29tcGlsZXIge1xuICBzaWduYWxzOiAobW9kZWw6IFVuaXRNb2RlbCwgc2VsQ21wdDogU2VsZWN0aW9uQ29tcG9uZW50KSA9PiBhbnlbXTtcbiAgdG9wTGV2ZWxTaWduYWxzPzogKG1vZGVsOiBNb2RlbCwgc2VsQ21wdDogU2VsZWN0aW9uQ29tcG9uZW50LCBzaWduYWxzOiBhbnlbXSkgPT4gYW55W107XG4gIG1vZGlmeUV4cHI6IChtb2RlbDogVW5pdE1vZGVsLCBzZWxDbXB0OiBTZWxlY3Rpb25Db21wb25lbnQpID0+IHN0cmluZztcbiAgbWFya3M/OiAobW9kZWw6IFVuaXRNb2RlbCwgc2VsQ21wdDpTZWxlY3Rpb25Db21wb25lbnQsIG1hcmtzOiBhbnlbXSkgPT4gYW55W107XG4gIHByZWRpY2F0ZTogc3RyaW5nOyAgLy8gVmVnYSBleHByIHN0cmluZyB0byBkZXRlcm1pbmUgaW5jbHVzaW9uIGluIHNlbGVjdGlvbi5cbiAgc2NhbGVEb21haW46IHN0cmluZzsgIC8vIFZlZ2EgZXhwciBzdHJpbmcgdG8gbWF0ZXJpYWxpemUgYSBzY2FsZSBkb21haW4uXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVVuaXRTZWxlY3Rpb24obW9kZWw6IFVuaXRNb2RlbCwgc2VsRGVmczogRGljdDxTZWxlY3Rpb25EZWY+KSB7XG4gIGNvbnN0IHNlbENtcHRzOiBEaWN0PFNlbGVjdGlvbkNvbXBvbmVudD4gPSB7fTtcbiAgY29uc3Qgc2VsZWN0aW9uQ29uZmlnID0gbW9kZWwuY29uZmlnLnNlbGVjdGlvbjtcblxuICBmb3IgKGxldCBuYW1lIGluIHNlbERlZnMpIHtcbiAgICBpZiAoIXNlbERlZnMuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGNvbnN0IHNlbERlZiA9IHNlbERlZnNbbmFtZV07XG4gICAgY29uc3QgY2ZnID0gc2VsZWN0aW9uQ29uZmlnW3NlbERlZi50eXBlXTtcblxuICAgIC8vIFNldCBkZWZhdWx0IHZhbHVlcyBmcm9tIGNvbmZpZyBpZiBhIHByb3BlcnR5IGhhc24ndCBiZWVuIHNwZWNpZmllZCxcbiAgICAvLyBvciBpZiBpdCBpcyB0cnVlLiBFLmcuLCBcInRyYW5zbGF0ZVwiOiB0cnVlIHNob3VsZCB1c2UgdGhlIGRlZmF1bHRcbiAgICAvLyBldmVudCBoYW5kbGVycyBmb3IgdHJhbnNsYXRlLiBIb3dldmVyLCB0cnVlIG1heSBiZSBhIHZhbGlkIHZhbHVlIGZvclxuICAgIC8vIGEgcHJvcGVydHkgKGUuZy4sIFwibmVhcmVzdFwiOiB0cnVlKS5cbiAgICBmb3IgKGNvbnN0IGtleSBpbiBjZmcpIHtcbiAgICAgIC8vIEEgc2VsZWN0aW9uIHNob3VsZCBjb250YWluIGVpdGhlciBgZW5jb2RpbmdzYCBvciBgZmllbGRzYCwgb25seSB1c2VcbiAgICAgIC8vIGRlZmF1bHQgdmFsdWVzIGZvciB0aGVzZSB0d28gdmFsdWVzIGlmIG5laXRoZXIgb2YgdGhlbSBpcyBzcGVjaWZpZWQuXG4gICAgICBpZiAoKGtleSA9PT0gJ2VuY29kaW5ncycgJiYgc2VsRGVmLmZpZWxkcykgfHwgKGtleSA9PT0gJ2ZpZWxkcycgJiYgc2VsRGVmLmVuY29kaW5ncykpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChrZXkgPT09ICdtYXJrJykge1xuICAgICAgICBzZWxEZWZba2V5XSA9IHsuLi5jZmdba2V5XSwgLi4uc2VsRGVmW2tleV19O1xuICAgICAgfVxuXG4gICAgICBpZiAoc2VsRGVmW2tleV0gPT09IHVuZGVmaW5lZCB8fCBzZWxEZWZba2V5XSA9PT0gdHJ1ZSkge1xuICAgICAgICBzZWxEZWZba2V5XSA9IGNmZ1trZXldIHx8IHNlbERlZltrZXldO1xuICAgICAgfVxuICAgIH1cblxuICAgIG5hbWUgPSB2YXJOYW1lKG5hbWUpO1xuICAgIGNvbnN0IHNlbENtcHQgPSBzZWxDbXB0c1tuYW1lXSA9IHtcbiAgICAgIC4uLnNlbERlZixcbiAgICAgIG5hbWU6IG5hbWUsXG4gICAgICBldmVudHM6IGlzU3RyaW5nKHNlbERlZi5vbikgPyBwYXJzZVNlbGVjdG9yKHNlbERlZi5vbiwgJ3Njb3BlJykgOiBzZWxEZWYub24sXG4gICAgfSBhcyBTZWxlY3Rpb25Db21wb25lbnQ7XG5cbiAgICBmb3JFYWNoVHJhbnNmb3JtKHNlbENtcHQsIHR4Q29tcGlsZXIgPT4ge1xuICAgICAgaWYgKHR4Q29tcGlsZXIucGFyc2UpIHtcbiAgICAgICAgdHhDb21waWxlci5wYXJzZShtb2RlbCwgc2VsRGVmLCBzZWxDbXB0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBzZWxDbXB0cztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFzc2VtYmxlVW5pdFNlbGVjdGlvblNpZ25hbHMobW9kZWw6IFVuaXRNb2RlbCwgc2lnbmFsczogYW55W10pIHtcbiAgZm9yRWFjaFNlbGVjdGlvbihtb2RlbCwgKHNlbENtcHQsIHNlbENvbXBpbGVyKSA9PiB7XG4gICAgY29uc3QgbmFtZSA9IHNlbENtcHQubmFtZTtcbiAgICBsZXQgbW9kaWZ5RXhwciA9IHNlbENvbXBpbGVyLm1vZGlmeUV4cHIobW9kZWwsIHNlbENtcHQpO1xuXG4gICAgc2lnbmFscy5wdXNoLmFwcGx5KHNpZ25hbHMsIHNlbENvbXBpbGVyLnNpZ25hbHMobW9kZWwsIHNlbENtcHQpKTtcblxuICAgIGZvckVhY2hUcmFuc2Zvcm0oc2VsQ21wdCwgdHhDb21waWxlciA9PiB7XG4gICAgICBpZiAodHhDb21waWxlci5zaWduYWxzKSB7XG4gICAgICAgIHNpZ25hbHMgPSB0eENvbXBpbGVyLnNpZ25hbHMobW9kZWwsIHNlbENtcHQsIHNpZ25hbHMpO1xuICAgICAgfVxuICAgICAgaWYgKHR4Q29tcGlsZXIubW9kaWZ5RXhwcikge1xuICAgICAgICBtb2RpZnlFeHByID0gdHhDb21waWxlci5tb2RpZnlFeHByKG1vZGVsLCBzZWxDbXB0LCBtb2RpZnlFeHByKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHNpZ25hbHMucHVzaCh7XG4gICAgICBuYW1lOiBuYW1lICsgTU9ESUZZLFxuICAgICAgb246IFt7XG4gICAgICAgIGV2ZW50czoge3NpZ25hbDogbmFtZSArIFRVUExFfSxcbiAgICAgICAgdXBkYXRlOiBgbW9kaWZ5KCR7c3RyaW5nVmFsdWUoc2VsQ21wdC5uYW1lICsgU1RPUkUpfSwgJHttb2RpZnlFeHByfSlgXG4gICAgICB9XVxuICAgIH0pO1xuICB9KTtcblxuICBjb25zdCBmYWNldE1vZGVsID0gZ2V0RmFjZXRNb2RlbChtb2RlbCk7XG4gIGlmIChzaWduYWxzLmxlbmd0aCAmJiBmYWNldE1vZGVsKSB7XG4gICAgY29uc3QgbmFtZSA9IHN0cmluZ1ZhbHVlKGZhY2V0TW9kZWwuZ2V0TmFtZSgnY2VsbCcpKTtcbiAgICBzaWduYWxzLnVuc2hpZnQoe1xuICAgICAgbmFtZTogJ2ZhY2V0JyxcbiAgICAgIHZhbHVlOiB7fSxcbiAgICAgIG9uOiBbe1xuICAgICAgICBldmVudHM6IHBhcnNlU2VsZWN0b3IoJ21vdXNlbW92ZScsICdzY29wZScpLFxuICAgICAgICB1cGRhdGU6IGBpc1R1cGxlKGZhY2V0KSA/IGZhY2V0IDogZ3JvdXAoJHtuYW1lfSkuZGF0dW1gXG4gICAgICB9XVxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHNpZ25hbHM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhc3NlbWJsZVRvcExldmVsU2lnbmFscyhtb2RlbDogVW5pdE1vZGVsLCBzaWduYWxzOiBhbnlbXSkge1xuICBsZXQgbmVlZHNVbml0ID0gZmFsc2U7XG4gIGZvckVhY2hTZWxlY3Rpb24obW9kZWwsIChzZWxDbXB0LCBzZWxDb21waWxlcikgPT4ge1xuICAgIGlmIChzZWxDb21waWxlci50b3BMZXZlbFNpZ25hbHMpIHtcbiAgICAgIHNpZ25hbHMgPSBzZWxDb21waWxlci50b3BMZXZlbFNpZ25hbHMobW9kZWwsIHNlbENtcHQsIHNpZ25hbHMpO1xuICAgIH1cblxuICAgIGZvckVhY2hUcmFuc2Zvcm0oc2VsQ21wdCwgdHhDb21waWxlciA9PiB7XG4gICAgICBpZiAodHhDb21waWxlci50b3BMZXZlbFNpZ25hbHMpIHtcbiAgICAgICAgc2lnbmFscyA9IHR4Q29tcGlsZXIudG9wTGV2ZWxTaWduYWxzKG1vZGVsLCBzZWxDbXB0LCBzaWduYWxzKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIG5lZWRzVW5pdCA9IHRydWU7XG4gIH0pO1xuXG4gIGlmIChuZWVkc1VuaXQpIHtcbiAgICBjb25zdCBoYXNVbml0ID0gc2lnbmFscy5maWx0ZXIoKHMpID0+IHMubmFtZSA9PT0gJ3VuaXQnKTtcbiAgICBpZiAoIShoYXNVbml0Lmxlbmd0aCkpIHtcbiAgICAgIHNpZ25hbHMudW5zaGlmdCh7XG4gICAgICAgIG5hbWU6ICd1bml0JyxcbiAgICAgICAgdmFsdWU6IHt9LFxuICAgICAgICBvbjogW3tldmVudHM6ICdtb3VzZW1vdmUnLCB1cGRhdGU6ICdpc1R1cGxlKGdyb3VwKCkpID8gZ3JvdXAoKSA6IHVuaXQnfV1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBzaWduYWxzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXNzZW1ibGVVbml0U2VsZWN0aW9uRGF0YShtb2RlbDogVW5pdE1vZGVsLCBkYXRhOiBWZ0RhdGFbXSk6IFZnRGF0YVtdIHtcbiAgZm9yRWFjaFNlbGVjdGlvbihtb2RlbCwgc2VsQ21wdCA9PiB7XG4gICAgY29uc3QgY29udGFpbnMgPSBkYXRhLmZpbHRlcigoZCkgPT4gZC5uYW1lID09PSBzZWxDbXB0Lm5hbWUgKyBTVE9SRSk7XG4gICAgaWYgKCFjb250YWlucy5sZW5ndGgpIHtcbiAgICAgIGRhdGEucHVzaCh7bmFtZTogc2VsQ21wdC5uYW1lICsgU1RPUkV9KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBkYXRhO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXNzZW1ibGVVbml0U2VsZWN0aW9uTWFya3MobW9kZWw6IFVuaXRNb2RlbCwgbWFya3M6IGFueVtdKTogYW55W10ge1xuICBmb3JFYWNoU2VsZWN0aW9uKG1vZGVsLCAoc2VsQ21wdCwgc2VsQ29tcGlsZXIpID0+IHtcbiAgICBtYXJrcyA9IHNlbENvbXBpbGVyLm1hcmtzID8gc2VsQ29tcGlsZXIubWFya3MobW9kZWwsIHNlbENtcHQsIG1hcmtzKSA6IG1hcmtzO1xuICAgIGZvckVhY2hUcmFuc2Zvcm0oc2VsQ21wdCwgKHR4Q29tcGlsZXIpID0+IHtcbiAgICAgIGlmICh0eENvbXBpbGVyLm1hcmtzKSB7XG4gICAgICAgIG1hcmtzID0gdHhDb21waWxlci5tYXJrcyhtb2RlbCwgc2VsQ21wdCwgbWFya3MpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcblxuICByZXR1cm4gbWFya3M7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhc3NlbWJsZUxheWVyU2VsZWN0aW9uTWFya3MobW9kZWw6IExheWVyTW9kZWwsIG1hcmtzOiBhbnlbXSk6IGFueVtdIHtcbiAgbW9kZWwuY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB7XG4gICAgaWYgKGlzVW5pdE1vZGVsKGNoaWxkKSkge1xuICAgICAgbWFya3MgPSBhc3NlbWJsZVVuaXRTZWxlY3Rpb25NYXJrcyhjaGlsZCwgbWFya3MpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIG1hcmtzO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2VsZWN0aW9uUHJlZGljYXRlKG1vZGVsOiBNb2RlbCwgc2VsZWN0aW9uczogTG9naWNhbE9wZXJhbmQ8c3RyaW5nPiwgZGZub2RlPzogRGF0YUZsb3dOb2RlKTogc3RyaW5nIHtcbiAgY29uc3Qgc3RvcmVzOiBzdHJpbmdbXSA9IFtdO1xuICBmdW5jdGlvbiBleHByKG5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3Qgdm5hbWUgPSB2YXJOYW1lKG5hbWUpO1xuICAgIGNvbnN0IHNlbENtcHQgPSBtb2RlbC5nZXRTZWxlY3Rpb25Db21wb25lbnQodm5hbWUsIG5hbWUpO1xuICAgIGNvbnN0IHN0b3JlID0gc3RyaW5nVmFsdWUodm5hbWUgKyBTVE9SRSk7XG5cbiAgICBpZiAoc2VsQ21wdC50aW1lVW5pdCkge1xuICAgICAgY29uc3QgY2hpbGQgPSBkZm5vZGUgfHwgbW9kZWwuY29tcG9uZW50LmRhdGEucmF3O1xuICAgICAgY29uc3QgdHVub2RlID0gc2VsQ21wdC50aW1lVW5pdC5jbG9uZSgpO1xuICAgICAgaWYgKGNoaWxkLnBhcmVudCkge1xuICAgICAgICB0dW5vZGUuaW5zZXJ0QXNQYXJlbnRPZihjaGlsZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjaGlsZC5wYXJlbnQgPSB0dW5vZGU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHNlbENtcHQuZW1wdHkgIT09ICdub25lJykge1xuICAgICAgc3RvcmVzLnB1c2goc3RvcmUpO1xuICAgIH1cblxuICAgIHJldHVybiBjb21waWxlcihzZWxDbXB0LnR5cGUpLnByZWRpY2F0ZSArIGAoJHtzdG9yZX0sIGRhdHVtYCArXG4gICAgICAoc2VsQ21wdC5yZXNvbHZlID09PSAnZ2xvYmFsJyA/ICcpJyA6IGAsICR7c3RyaW5nVmFsdWUoc2VsQ21wdC5yZXNvbHZlKX0pYCk7XG4gIH1cblxuICBjb25zdCBwcmVkaWNhdGVTdHIgPSBsb2dpY2FsRXhwcihzZWxlY3Rpb25zLCBleHByKTtcbiAgcmV0dXJuIChzdG9yZXMubGVuZ3RoXG4gICAgPyAnISgnICsgc3RvcmVzLm1hcCgocykgPT4gYGxlbmd0aChkYXRhKCR7c30pKWApLmpvaW4oJyB8fCAnKSArICcpIHx8ICdcbiAgICA6ICcnXG4gICkgKyBgKCR7cHJlZGljYXRlU3RyfSlgO1xufVxuXG4vLyBTZWxlY3Rpb25zIGFyZSBwYXJzZWQgX2FmdGVyXyBzY2FsZXMuIElmIGEgc2NhbGUgZG9tYWluIGlzIHNldCB0b1xuLy8gdXNlIGEgc2VsZWN0aW9uLCB0aGUgU0VMRUNUSU9OX0RPTUFJTiBjb25zdGFudCBpcyB1c2VkIGFzIHRoZVxuLy8gZG9tYWluUmF3LnNpZ25hbCBkdXJpbmcgc2NhbGUucGFyc2UgYW5kIHRoZW4gcmVwbGFjZWQgd2l0aCB0aGUgbmVjZXNzYXJ5XG4vLyBzZWxlY3Rpb24gZXhwcmVzc2lvbiBmdW5jdGlvbiBkdXJpbmcgc2NhbGUuYXNzZW1ibGUuIFRvIG5vdCBwb2xsdXRlIHRoZVxuLy8gdHlwZSBzaWduYXR1cmVzIHRvIGFjY291bnQgZm9yIHRoaXMgc2V0dXAsIHRoZSBzZWxlY3Rpb24gZG9tYWluIGRlZmluaXRpb25cbi8vIGlzIGNvZXJjZWQgdG8gYSBzdHJpbmcgYW5kIGFwcGVuZGVkIHRvIFNFTEVDVElPTl9ET01BSU4uXG5leHBvcnQgZnVuY3Rpb24gaXNSYXdTZWxlY3Rpb25Eb21haW4oZG9tYWluUmF3OiBWZ1NpZ25hbFJlZikge1xuICByZXR1cm4gZG9tYWluUmF3LnNpZ25hbC5pbmRleE9mKFNFTEVDVElPTl9ET01BSU4pID49IDA7XG59XG5leHBvcnQgZnVuY3Rpb24gc2VsZWN0aW9uU2NhbGVEb21haW4obW9kZWw6IE1vZGVsLCBkb21haW5SYXc6IFZnU2lnbmFsUmVmKTogVmdTaWduYWxSZWYge1xuICBjb25zdCBzZWxEb21haW4gPSBKU09OLnBhcnNlKGRvbWFpblJhdy5zaWduYWwucmVwbGFjZShTRUxFQ1RJT05fRE9NQUlOLCAnJykpO1xuICBjb25zdCBuYW1lID0gdmFyTmFtZShzZWxEb21haW4uc2VsZWN0aW9uKTtcblxuICBsZXQgc2VsQ21wdCA9IG1vZGVsLmNvbXBvbmVudC5zZWxlY3Rpb24gJiYgbW9kZWwuY29tcG9uZW50LnNlbGVjdGlvbltuYW1lXTtcbiAgaWYgKHNlbENtcHQpIHtcbiAgICB3YXJuKCdVc2UgXCJiaW5kXCI6IFwic2NhbGVzXCIgdG8gc2V0dXAgYSBiaW5kaW5nIGZvciBzY2FsZXMgYW5kIHNlbGVjdGlvbnMgd2l0aGluIHRoZSBzYW1lIHZpZXcuJyk7XG4gIH0gZWxzZSB7XG4gICAgc2VsQ21wdCA9IG1vZGVsLmdldFNlbGVjdGlvbkNvbXBvbmVudChuYW1lLCBzZWxEb21haW4uc2VsZWN0aW9uKTtcbiAgICBpZiAoIXNlbERvbWFpbi5lbmNvZGluZyAmJiAhc2VsRG9tYWluLmZpZWxkKSB7XG4gICAgICBzZWxEb21haW4uZmllbGQgPSBzZWxDbXB0LnByb2plY3RbMF0uZmllbGQ7XG4gICAgICBpZiAoc2VsQ21wdC5wcm9qZWN0Lmxlbmd0aCA+IDEpIHtcbiAgICAgICAgd2FybignQSBcImZpZWxkXCIgb3IgXCJlbmNvZGluZ1wiIG11c3QgYmUgc3BlY2lmaWVkIHdoZW4gdXNpbmcgYSBzZWxlY3Rpb24gYXMgYSBzY2FsZSBkb21haW4uICcgK1xuICAgICAgICBgVXNpbmcgXCJmaWVsZFwiOiAke3N0cmluZ1ZhbHVlKHNlbERvbWFpbi5maWVsZCl9LmApO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgc2lnbmFsOiBjb21waWxlcihzZWxDbXB0LnR5cGUpLnNjYWxlRG9tYWluICtcbiAgICAgICAgYCgke3N0cmluZ1ZhbHVlKG5hbWUgKyBTVE9SRSl9LCAke3N0cmluZ1ZhbHVlKHNlbERvbWFpbi5lbmNvZGluZyB8fCBudWxsKX0sIGAgK1xuICAgICAgICAgIHN0cmluZ1ZhbHVlKHNlbERvbWFpbi5maWVsZCB8fCBudWxsKSArXG4gICAgICAgICAgKHNlbENtcHQucmVzb2x2ZSA9PT0gJ2dsb2JhbCcgPyAnKScgOiBgLCAke3N0cmluZ1ZhbHVlKHNlbENtcHQucmVzb2x2ZSl9KWApXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB7c2lnbmFsOiAnbnVsbCd9O1xufVxuXG4vLyBVdGlsaXR5IGZ1bmN0aW9uc1xuXG5mdW5jdGlvbiBmb3JFYWNoU2VsZWN0aW9uKG1vZGVsOiBNb2RlbCwgY2I6IChzZWxDbXB0OiBTZWxlY3Rpb25Db21wb25lbnQsIHNlbENvbXBpbGVyOiBTZWxlY3Rpb25Db21waWxlcikgPT4gdm9pZCkge1xuICBjb25zdCBzZWxlY3Rpb25zID0gbW9kZWwuY29tcG9uZW50LnNlbGVjdGlvbjtcbiAgZm9yIChjb25zdCBuYW1lIGluIHNlbGVjdGlvbnMpIHtcbiAgICBpZiAoc2VsZWN0aW9ucy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgICAgY29uc3Qgc2VsID0gc2VsZWN0aW9uc1tuYW1lXTtcbiAgICAgIGNiKHNlbCwgY29tcGlsZXIoc2VsLnR5cGUpKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gY29tcGlsZXIodHlwZTogU2VsZWN0aW9uVHlwZSk6IFNlbGVjdGlvbkNvbXBpbGVyIHtcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSAnc2luZ2xlJzpcbiAgICAgIHJldHVybiBzaW5nbGVDb21waWxlcjtcbiAgICBjYXNlICdtdWx0aSc6XG4gICAgICByZXR1cm4gbXVsdGlDb21waWxlcjtcbiAgICBjYXNlICdpbnRlcnZhbCc6XG4gICAgICByZXR1cm4gaW50ZXJ2YWxDb21waWxlcjtcbiAgfVxuICByZXR1cm4gbnVsbDtcbn1cblxuZnVuY3Rpb24gZ2V0RmFjZXRNb2RlbChtb2RlbDogTW9kZWwpOiBGYWNldE1vZGVsIHtcbiAgbGV0IHBhcmVudCA9IG1vZGVsLnBhcmVudDtcbiAgd2hpbGUgKHBhcmVudCkge1xuICAgIGlmIChpc0ZhY2V0TW9kZWwocGFyZW50KSkge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnQ7XG4gIH1cblxuICByZXR1cm4gcGFyZW50IGFzIEZhY2V0TW9kZWw7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1bml0TmFtZShtb2RlbDogTW9kZWwpIHtcbiAgbGV0IG5hbWUgPSBzdHJpbmdWYWx1ZShtb2RlbC5uYW1lKTtcbiAgY29uc3QgZmFjZXQgPSBnZXRGYWNldE1vZGVsKG1vZGVsKTtcbiAgaWYgKGZhY2V0KSB7XG4gICAgbmFtZSArPSAoZmFjZXQuZmFjZXQucm93ID8gYCArICdfJyArICgke2FjY2Vzc1BhdGhXaXRoRGF0dW0oZmFjZXQudmdGaWVsZCgncm93JyksICdmYWNldCcpfSlgIDogJycpXG4gICAgICArIChmYWNldC5mYWNldC5jb2x1bW4gPyBgICsgJ18nICsgKCR7YWNjZXNzUGF0aFdpdGhEYXR1bShmYWNldC52Z0ZpZWxkKCdjb2x1bW4nKSwgJ2ZhY2V0Jyl9KWAgOiAnJyk7XG4gIH1cbiAgcmV0dXJuIG5hbWU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXF1aXJlc1NlbGVjdGlvbklkKG1vZGVsOiBNb2RlbCkge1xuICBsZXQgaWRlbnRpZmllciA9IGZhbHNlO1xuICBmb3JFYWNoU2VsZWN0aW9uKG1vZGVsLCAoc2VsQ21wdCkgPT4ge1xuICAgIGlkZW50aWZpZXIgPSBpZGVudGlmaWVyIHx8IHNlbENtcHQucHJvamVjdC5zb21lKChwcm9qKSA9PiBwcm9qLmZpZWxkID09PSBTRUxFQ1RJT05fSUQpO1xuICB9KTtcbiAgcmV0dXJuIGlkZW50aWZpZXI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGFubmVsU2lnbmFsTmFtZShzZWxDbXB0OiBTZWxlY3Rpb25Db21wb25lbnQsIGNoYW5uZWw6IENoYW5uZWwsIHJhbmdlOiAndmlzdWFsJyB8ICdkYXRhJykge1xuICBjb25zdCBzZ05hbWVzID0gc2VsQ21wdC5fc2lnbmFsTmFtZXMgfHwgKHNlbENtcHQuX3NpZ25hbE5hbWVzID0ge30pO1xuICBpZiAoc2dOYW1lc1tjaGFubmVsXSAmJiBzZ05hbWVzW2NoYW5uZWxdW3JhbmdlXSkge1xuICAgIHJldHVybiBzZ05hbWVzW2NoYW5uZWxdW3JhbmdlXTtcbiAgfVxuXG4gIHNnTmFtZXNbY2hhbm5lbF0gPSBzZ05hbWVzW2NoYW5uZWxdIHx8IHt9O1xuICBjb25zdCBiYXNlbmFtZSA9IHZhck5hbWUoc2VsQ21wdC5uYW1lICsgJ18nICsgKHJhbmdlID09PSAndmlzdWFsJyA/IGNoYW5uZWwgOiBzZWxDbXB0LmZpZWxkc1tjaGFubmVsXSkpO1xuICBsZXQgbmFtZSA9IGJhc2VuYW1lO1xuICBsZXQgY291bnRlciA9IDE7XG4gIHdoaWxlIChzZ05hbWVzW25hbWVdKSB7XG4gICAgbmFtZSA9IGAke2Jhc2VuYW1lfV8ke2NvdW50ZXIrK31gO1xuICB9XG5cbiAgcmV0dXJuIChzZ05hbWVzW25hbWVdID0gc2dOYW1lc1tjaGFubmVsXVtyYW5nZV0gPSBuYW1lKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBvc2l0aW9uYWxQcm9qZWN0aW9ucyhzZWxDbXB0OiBTZWxlY3Rpb25Db21wb25lbnQpIHtcbiAgbGV0IHg6UHJvamVjdENvbXBvbmVudCA9IG51bGw7XG4gIGxldCB4aTpudW1iZXIgPSBudWxsO1xuICBsZXQgeTpQcm9qZWN0Q29tcG9uZW50ID0gbnVsbDtcbiAgbGV0IHlpOiBudW1iZXIgPSBudWxsO1xuXG4gIHNlbENtcHQucHJvamVjdC5mb3JFYWNoKChwLCBpKSA9PiB7XG4gICAgaWYgKHAuY2hhbm5lbCA9PT0gWCkge1xuICAgICAgeCA9IHA7XG4gICAgICB4aSA9IGk7XG4gICAgfSBlbHNlIGlmIChwLmNoYW5uZWwgPT09IFkpIHtcbiAgICAgIHkgPSBwO1xuICAgICAgeWkgPSBpO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiB7eCwgeGksIHksIHlpfTtcbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { isArray, isString } from 'vega-util';\nimport { selectionPredicate } from './compile/selection/selection';\nimport { dateTimeExpr, isDateTime } from './datetime';\nimport { vgField } from './fielddef';\nimport { fieldExpr as timeUnitFieldExpr, getLocalTimeUnit, isLocalSingleTimeUnit, isUtcSingleTimeUnit, normalizeTimeUnit } from './timeunit';\nimport { logicalExpr } from './util';\nexport function isSelectionPredicate(predicate) {\n    return predicate && predicate['selection'];\n}\nexport function isFieldEqualPredicate(predicate) {\n    return predicate && !!predicate.field && predicate.equal !== undefined;\n}\nexport function isFieldLTPredicate(predicate) {\n    return predicate && !!predicate.field && predicate.lt !== undefined;\n}\nexport function isFieldLTEPredicate(predicate) {\n    return predicate && !!predicate.field && predicate.lte !== undefined;\n}\nexport function isFieldGTPredicate(predicate) {\n    return predicate && !!predicate.field && predicate.gt !== undefined;\n}\nexport function isFieldGTEPredicate(predicate) {\n    return predicate && !!predicate.field && predicate.gte !== undefined;\n}\nexport function isFieldRangePredicate(predicate) {\n    if (predicate && predicate.field) {\n        if (isArray(predicate.range) && predicate.range.length === 2) {\n            return true;\n        }\n    }\n    return false;\n}\nexport function isFieldOneOfPredicate(predicate) {\n    return predicate && !!predicate.field && (isArray(predicate.oneOf) ||\n        isArray(predicate.in) // backward compatibility\n    );\n}\nexport function isFieldPredicate(predicate) {\n    return isFieldOneOfPredicate(predicate) || isFieldEqualPredicate(predicate) || isFieldRangePredicate(predicate) || isFieldLTPredicate(predicate) || isFieldGTPredicate(predicate) || isFieldLTEPredicate(predicate) || isFieldGTEPredicate(predicate);\n}\n/**\n * Converts a predicate into an expression.\n */\n// model is only used for selection filters.\nexport function expression(model, filterOp, node) {\n    return logicalExpr(filterOp, function (predicate) {\n        if (isString(predicate)) {\n            return predicate;\n        }\n        else if (isSelectionPredicate(predicate)) {\n            return selectionPredicate(model, predicate.selection, node);\n        }\n        else { // Filter Object\n            return fieldFilterExpression(predicate);\n        }\n    });\n}\n// This method is used by Voyager.  Do not change its behavior without changing Voyager.\nexport function fieldFilterExpression(predicate, useInRange) {\n    if (useInRange === void 0) { useInRange = true; }\n    var fieldExpr = predicate.timeUnit ?\n        // For timeUnit, cast into integer with time() so we can use ===, inrange, indexOf to compare values directly.\n        // TODO: We calculate timeUnit on the fly here. Consider if we would like to consolidate this with timeUnit pipeline\n        // TODO: support utc\n        ('time(' + timeUnitFieldExpr(predicate.timeUnit, predicate.field) + ')') :\n        vgField(predicate, { expr: 'datum' });\n    if (isFieldEqualPredicate(predicate)) {\n        return fieldExpr + '===' + valueExpr(predicate.equal, predicate.timeUnit);\n    }\n    else if (isFieldLTPredicate(predicate)) {\n        var upper = predicate.lt;\n        return fieldExpr + \"<\" + valueExpr(upper, predicate.timeUnit);\n    }\n    else if (isFieldGTPredicate(predicate)) {\n        var lower = predicate.gt;\n        return fieldExpr + \">\" + valueExpr(lower, predicate.timeUnit);\n    }\n    else if (isFieldLTEPredicate(predicate)) {\n        var upper = predicate.lte;\n        return fieldExpr + \"<=\" + valueExpr(upper, predicate.timeUnit);\n    }\n    else if (isFieldGTEPredicate(predicate)) {\n        var lower = predicate.gte;\n        return fieldExpr + \">=\" + valueExpr(lower, predicate.timeUnit);\n    }\n    else if (isFieldOneOfPredicate(predicate)) {\n        // \"oneOf\" was formerly \"in\" -- so we need to add backward compatibility\n        var oneOf = predicate.oneOf || predicate['in'];\n        return 'indexof([' +\n            oneOf.map(function (v) { return valueExpr(v, predicate.timeUnit); }).join(',') +\n            '], ' + fieldExpr + ') !== -1';\n    }\n    else if (isFieldRangePredicate(predicate)) {\n        var lower = predicate.range[0];\n        var upper = predicate.range[1];\n        if (lower !== null && upper !== null && useInRange) {\n            return 'inrange(' + fieldExpr + ', [' +\n                valueExpr(lower, predicate.timeUnit) + ', ' +\n                valueExpr(upper, predicate.timeUnit) + '])';\n        }\n        var exprs = [];\n        if (lower !== null) {\n            exprs.push(fieldExpr + \" >= \" + valueExpr(lower, predicate.timeUnit));\n        }\n        if (upper !== null) {\n            exprs.push(fieldExpr + \" <= \" + valueExpr(upper, predicate.timeUnit));\n        }\n        return exprs.length > 0 ? exprs.join(' && ') : 'true';\n    }\n    /* istanbul ignore next: it should never reach here */\n    throw new Error(\"Invalid field predicate: \" + JSON.stringify(predicate));\n}\nfunction valueExpr(v, timeUnit) {\n    if (isDateTime(v)) {\n        var expr = dateTimeExpr(v, true);\n        return 'time(' + expr + ')';\n    }\n    if (isLocalSingleTimeUnit(timeUnit)) {\n        var datetime = {};\n        datetime[timeUnit] = v;\n        var expr = dateTimeExpr(datetime, true);\n        return 'time(' + expr + ')';\n    }\n    else if (isUtcSingleTimeUnit(timeUnit)) {\n        return valueExpr(v, getLocalTimeUnit(timeUnit));\n    }\n    return JSON.stringify(v);\n}\nexport function normalizePredicate(f) {\n    if (isFieldPredicate(f) && f.timeUnit) {\n        return tslib_1.__assign({}, f, { timeUnit: normalizeTimeUnit(f.timeUnit) });\n    }\n    return f;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJlZGljYXRlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3ByZWRpY2F0ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFDLE9BQU8sRUFBRSxRQUFRLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFHNUMsT0FBTyxFQUFDLGtCQUFrQixFQUFDLE1BQU0sK0JBQStCLENBQUM7QUFDakUsT0FBTyxFQUFXLFlBQVksRUFBRSxVQUFVLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDOUQsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLFlBQVksQ0FBQztBQUVuQyxPQUFPLEVBQUMsU0FBUyxJQUFJLGlCQUFpQixFQUFFLGdCQUFnQixFQUFFLHFCQUFxQixFQUFFLG1CQUFtQixFQUFFLGlCQUFpQixFQUFXLE1BQU0sWUFBWSxDQUFDO0FBQ3JKLE9BQU8sRUFBQyxXQUFXLEVBQUMsTUFBTSxRQUFRLENBQUM7QUFzQm5DLE1BQU0sK0JBQStCLFNBQW9DO0lBQ3ZFLE9BQU8sU0FBUyxJQUFJLFNBQVMsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUM3QyxDQUFDO0FBd0JELE1BQU0sZ0NBQWdDLFNBQWM7SUFDbEQsT0FBTyxTQUFTLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxLQUFLLElBQUksU0FBUyxDQUFDLEtBQUssS0FBSyxTQUFTLENBQUM7QUFDekUsQ0FBQztBQVVELE1BQU0sNkJBQTZCLFNBQWM7SUFDL0MsT0FBTyxTQUFTLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxLQUFLLElBQUksU0FBUyxDQUFDLEVBQUUsS0FBSyxTQUFTLENBQUM7QUFDdEUsQ0FBQztBQVdELE1BQU0sOEJBQThCLFNBQWM7SUFDaEQsT0FBTyxTQUFTLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxLQUFLLElBQUksU0FBUyxDQUFDLEdBQUcsS0FBSyxTQUFTLENBQUM7QUFDdkUsQ0FBQztBQVdELE1BQU0sNkJBQTZCLFNBQWM7SUFDL0MsT0FBTyxT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QUFNLFFBQVEsR0FBYSxFQUFFLENBQUM7UUFDOUIsUUFBUSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUN2QixJQUFNLElBQUksR0FBRyxZQUFZLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDO1FBQzFDLE9BQU8sT0FBTyxHQUFHLElBQUksR0FBRyxHQUFHLENBQUM7S0FDN0I7U0FBTSxJQUFJLG1CQUFtQixDQUFDLFFBQVEsQ0FBQyxFQUFFO1FBQ3hDLE9BQU8sU0FBUyxDQUFDLENBQUMsRUFBRSxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO0tBQ2pEO0lBQ0QsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQzNCLENBQUM7QUFFRCxNQUFNLDZCQUE2QixDQUFZO0lBQzdDLElBQUksZ0JBQWdCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsRUFBRTtRQUNyQyw0QkFDSyxDQUFDLElBQ0osUUFBUSxFQUFFLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFDdkM7S0FDSDtJQUNELE9BQU8sQ0FBQyxDQUFDO0FBQ1gsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7aXNBcnJheSwgaXNTdHJpbmd9IGZyb20gJ3ZlZ2EtdXRpbCc7XG5pbXBvcnQge0RhdGFGbG93Tm9kZX0gZnJvbSAnLi9jb21waWxlL2RhdGEvZGF0YWZsb3cnO1xuaW1wb3J0IHtNb2RlbH0gZnJvbSAnLi9jb21waWxlL21vZGVsJztcbmltcG9ydCB7c2VsZWN0aW9uUHJlZGljYXRlfSBmcm9tICcuL2NvbXBpbGUvc2VsZWN0aW9uL3NlbGVjdGlvbic7XG5pbXBvcnQge0RhdGVUaW1lLCBkYXRlVGltZUV4cHIsIGlzRGF0ZVRpbWV9IGZyb20gJy4vZGF0ZXRpbWUnO1xuaW1wb3J0IHt2Z0ZpZWxkfSBmcm9tICcuL2ZpZWxkZGVmJztcbmltcG9ydCB7TG9naWNhbE9wZXJhbmR9IGZyb20gJy4vbG9naWNhbCc7XG5pbXBvcnQge2ZpZWxkRXhwciBhcyB0aW1lVW5pdEZpZWxkRXhwciwgZ2V0TG9jYWxUaW1lVW5pdCwgaXNMb2NhbFNpbmdsZVRpbWVVbml0LCBpc1V0Y1NpbmdsZVRpbWVVbml0LCBub3JtYWxpemVUaW1lVW5pdCwgVGltZVVuaXR9IGZyb20gJy4vdGltZXVuaXQnO1xuaW1wb3J0IHtsb2dpY2FsRXhwcn0gZnJvbSAnLi91dGlsJztcblxuZXhwb3J0IHR5cGUgUHJlZGljYXRlID1cbiAgLy8gYSkgRmllbGRQcmVkaWNhdGUgKGJ1dCB3ZSBkb24ndCB0eXBlIEZpZWxkRmlsdGVyIGhlcmUgc28gdGhlIHNjaGVtYSBoYXMgbm8gbmVzdGluZ1xuICAvLyBhbmQgdGh1cyB0aGUgZG9jdW1lbnRhdGlvbiBzaG93cyBhbGwgb2YgdGhlIHR5cGVzIGNsZWFybHkpXG4gIEZpZWxkRXF1YWxQcmVkaWNhdGUgfCBGaWVsZFJhbmdlUHJlZGljYXRlIHwgRmllbGRPbmVPZlByZWRpY2F0ZSB8IEZpZWxkTFRQcmVkaWNhdGUgfCBGaWVsZEdUUHJlZGljYXRlIHwgRmllbGRMVEVQcmVkaWNhdGUgfCBGaWVsZEdURVByZWRpY2F0ZSB8XG4gIC8vIGIpIFNlbGVjdGlvbiBQcmVkaWNhdGVcbiAgU2VsZWN0aW9uUHJlZGljYXRlIHxcbiAgLy8gYykgVmVnYSBFeHByZXNzaW9uIHN0cmluZ1xuICBzdHJpbmc7XG5cblxuXG5leHBvcnQgdHlwZSBGaWVsZFByZWRpY2F0ZSA9IEZpZWxkRXF1YWxQcmVkaWNhdGUgfCBGaWVsZExUUHJlZGljYXRlIHwgRmllbGRHVFByZWRpY2F0ZSB8IEZpZWxkTFRFUHJlZGljYXRlIHwgRmllbGRHVEVQcmVkaWNhdGUgfEZpZWxkUmFuZ2VQcmVkaWNhdGUgfCBGaWVsZE9uZU9mUHJlZGljYXRlO1xuXG5leHBvcnQgaW50ZXJmYWNlIFNlbGVjdGlvblByZWRpY2F0ZSB7XG4gIC8qKlxuICAgKiBGaWx0ZXIgdXNpbmcgYSBzZWxlY3Rpb24gbmFtZS5cbiAgICovXG4gIHNlbGVjdGlvbjogTG9naWNhbE9wZXJhbmQ8c3RyaW5nPjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU2VsZWN0aW9uUHJlZGljYXRlKHByZWRpY2F0ZTogTG9naWNhbE9wZXJhbmQ8UHJlZGljYXRlPik6IHByZWRpY2F0ZSBpcyBTZWxlY3Rpb25QcmVkaWNhdGUge1xuICByZXR1cm4gcHJlZGljYXRlICYmIHByZWRpY2F0ZVsnc2VsZWN0aW9uJ107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmllbGRQcmVkaWNhdGVCYXNlIHtcbiAgLy8gVE9ETzogc3VwcG9ydCBhZ2dyZWdhdGVcblxuICAvKipcbiAgICogVGltZSB1bml0IGZvciB0aGUgZmllbGQgdG8gYmUgZmlsdGVyZWQuXG4gICAqL1xuICB0aW1lVW5pdD86IFRpbWVVbml0O1xuXG4gIC8qKlxuICAgKiBGaWVsZCB0byBiZSBmaWx0ZXJlZC5cbiAgICovXG4gIGZpZWxkOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmllbGRFcXVhbFByZWRpY2F0ZSBleHRlbmRzIEZpZWxkUHJlZGljYXRlQmFzZSB7XG4gIC8qKlxuICAgKiBUaGUgdmFsdWUgdGhhdCB0aGUgZmllbGQgc2hvdWxkIGJlIGVxdWFsIHRvLlxuICAgKi9cbiAgZXF1YWw6IHN0cmluZyB8IG51bWJlciB8IGJvb2xlYW4gfCBEYXRlVGltZTtcblxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNGaWVsZEVxdWFsUHJlZGljYXRlKHByZWRpY2F0ZTogYW55KTogcHJlZGljYXRlIGlzIEZpZWxkRXF1YWxQcmVkaWNhdGUge1xuICByZXR1cm4gcHJlZGljYXRlICYmICEhcHJlZGljYXRlLmZpZWxkICYmIHByZWRpY2F0ZS5lcXVhbCAhPT0gdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZpZWxkTFRQcmVkaWNhdGUgZXh0ZW5kcyBGaWVsZFByZWRpY2F0ZUJhc2Uge1xuICAvKipcbiAgICogVGhlIHZhbHVlIHRoYXQgdGhlIGZpZWxkIHNob3VsZCBiZSBsZXNzIHRoYW4uXG4gICAqL1xuICBsdDogc3RyaW5nIHwgbnVtYmVyIHwgRGF0ZVRpbWU7XG5cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRmllbGRMVFByZWRpY2F0ZShwcmVkaWNhdGU6IGFueSk6IHByZWRpY2F0ZSBpcyBGaWVsZExUUHJlZGljYXRlIHtcbiAgcmV0dXJuIHByZWRpY2F0ZSAmJiAhIXByZWRpY2F0ZS5maWVsZCAmJiBwcmVkaWNhdGUubHQgIT09IHVuZGVmaW5lZDtcbn1cblxuXG5leHBvcnQgaW50ZXJmYWNlIEZpZWxkTFRFUHJlZGljYXRlIGV4dGVuZHMgRmllbGRQcmVkaWNhdGVCYXNlIHtcbiAgLyoqXG4gICAqIFRoZSB2YWx1ZSB0aGF0IHRoZSBmaWVsZCBzaG91bGQgYmUgbGVzcyB0aGFuIG9yIGVxdWFscyB0by5cbiAgICovXG4gIGx0ZTogc3RyaW5nIHwgbnVtYmVyIHwgRGF0ZVRpbWU7XG5cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRmllbGRMVEVQcmVkaWNhdGUocHJlZGljYXRlOiBhbnkpOiBwcmVkaWNhdGUgaXMgRmllbGRMVEVQcmVkaWNhdGUge1xuICByZXR1cm4gcHJlZGljYXRlICYmICEhcHJlZGljYXRlLmZpZWxkICYmIHByZWRpY2F0ZS5sdGUgIT09IHVuZGVmaW5lZDtcbn1cblxuXG5leHBvcnQgaW50ZXJmYWNlIEZpZWxkR1RQcmVkaWNhdGUgZXh0ZW5kcyBGaWVsZFByZWRpY2F0ZUJhc2Uge1xuICAvKipcbiAgICogVGhlIHZhbHVlIHRoYXQgdGhlIGZpZWxkIHNob3VsZCBiZSBncmVhdGVyIHRoYW4uXG4gICAqL1xuICBndDogc3RyaW5nIHwgbnVtYmVyIHwgRGF0ZVRpbWU7XG5cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRmllbGRHVFByZWRpY2F0ZShwcmVkaWNhdGU6IGFueSk6IHByZWRpY2F0ZSBpcyBGaWVsZEdUUHJlZGljYXRlIHtcbiAgcmV0dXJuIHByZWRpY2F0ZSAmJiAhIXByZWRpY2F0ZS5maWVsZCAmJiBwcmVkaWNhdGUuZ3QgIT09IHVuZGVmaW5lZDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGaWVsZEdURVByZWRpY2F0ZSBleHRlbmRzIEZpZWxkUHJlZGljYXRlQmFzZSB7XG4gIC8qKlxuICAgKiBUaGUgdmFsdWUgdGhhdCB0aGUgZmllbGQgc2hvdWxkIGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbHMgdG8uXG4gICAqL1xuICBndGU6IHN0cmluZyB8IG51bWJlciB8IERhdGVUaW1lO1xuXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0ZpZWxkR1RFUHJlZGljYXRlKHByZWRpY2F0ZTogYW55KTogcHJlZGljYXRlIGlzIEZpZWxkR1RFUHJlZGljYXRlIHtcbiAgcmV0dXJuIHByZWRpY2F0ZSAmJiAhIXByZWRpY2F0ZS5maWVsZCAmJiBwcmVkaWNhdGUuZ3RlICE9PSB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmllbGRSYW5nZVByZWRpY2F0ZSBleHRlbmRzIEZpZWxkUHJlZGljYXRlQmFzZSB7XG4gIC8qKlxuICAgKiBBbiBhcnJheSBvZiBpbmNsdXNpdmUgbWluaW11bSBhbmQgbWF4aW11bSB2YWx1ZXNcbiAgICogZm9yIGEgZmllbGQgdmFsdWUgb2YgYSBkYXRhIGl0ZW0gdG8gYmUgaW5jbHVkZWQgaW4gdGhlIGZpbHRlcmVkIGRhdGEuXG4gICAqIEBtYXhJdGVtcyAyXG4gICAqIEBtaW5JdGVtcyAyXG4gICAqL1xuICByYW5nZTogKG51bWJlcnxEYXRlVGltZXxudWxsKVtdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNGaWVsZFJhbmdlUHJlZGljYXRlKHByZWRpY2F0ZTogYW55KTogcHJlZGljYXRlIGlzIEZpZWxkUmFuZ2VQcmVkaWNhdGUge1xuICBpZiAocHJlZGljYXRlICYmIHByZWRpY2F0ZS5maWVsZCkge1xuICAgIGlmIChpc0FycmF5KHByZWRpY2F0ZS5yYW5nZSkgJiYgcHJlZGljYXRlLnJhbmdlLmxlbmd0aCA9PT0gMikge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGaWVsZE9uZU9mUHJlZGljYXRlIGV4dGVuZHMgRmllbGRQcmVkaWNhdGVCYXNlIHtcbiAgLyoqXG4gICAqIEEgc2V0IG9mIHZhbHVlcyB0aGF0IHRoZSBgZmllbGRgJ3MgdmFsdWUgc2hvdWxkIGJlIGEgbWVtYmVyIG9mLFxuICAgKiBmb3IgYSBkYXRhIGl0ZW0gaW5jbHVkZWQgaW4gdGhlIGZpbHRlcmVkIGRhdGEuXG4gICAqL1xuICBvbmVPZjogc3RyaW5nW10gfCBudW1iZXJbXSB8IGJvb2xlYW5bXSB8IERhdGVUaW1lW107XG5cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRmllbGRPbmVPZlByZWRpY2F0ZShwcmVkaWNhdGU6IGFueSk6IHByZWRpY2F0ZSBpcyBGaWVsZE9uZU9mUHJlZGljYXRlIHtcbiAgcmV0dXJuIHByZWRpY2F0ZSAmJiAhIXByZWRpY2F0ZS5maWVsZCAmJiAoXG4gICAgaXNBcnJheShwcmVkaWNhdGUub25lT2YpIHx8XG4gICAgaXNBcnJheShwcmVkaWNhdGUuaW4pIC8vIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRmllbGRQcmVkaWNhdGUocHJlZGljYXRlOiBQcmVkaWNhdGUpOiBwcmVkaWNhdGUgaXMgRmllbGRPbmVPZlByZWRpY2F0ZSB8IEZpZWxkRXF1YWxQcmVkaWNhdGUgfCBGaWVsZFJhbmdlUHJlZGljYXRlIHwgRmllbGRMVFByZWRpY2F0ZSB8IEZpZWxkR1RQcmVkaWNhdGUgfCBGaWVsZExURVByZWRpY2F0ZSB8IEZpZWxkR1RFUHJlZGljYXRlIHtcbiAgcmV0dXJuIGlzRmllbGRPbmVPZlByZWRpY2F0ZShwcmVkaWNhdGUpIHx8IGlzRmllbGRFcXVhbFByZWRpY2F0ZShwcmVkaWNhdGUpIHx8IGlzRmllbGRSYW5nZVByZWRpY2F0ZShwcmVkaWNhdGUpIHx8IGlzRmllbGRMVFByZWRpY2F0ZShwcmVkaWNhdGUpIHx8IGlzRmllbGRHVFByZWRpY2F0ZShwcmVkaWNhdGUpIHx8IGlzRmllbGRMVEVQcmVkaWNhdGUocHJlZGljYXRlKSB8fCBpc0ZpZWxkR1RFUHJlZGljYXRlKHByZWRpY2F0ZSk7XG59XG5cbi8qKlxuICogQ29udmVydHMgYSBwcmVkaWNhdGUgaW50byBhbiBleHByZXNzaW9uLlxuICovXG4vLyBtb2RlbCBpcyBvbmx5IHVzZWQgZm9yIHNlbGVjdGlvbiBmaWx0ZXJzLlxuZXhwb3J0IGZ1bmN0aW9uIGV4cHJlc3Npb24obW9kZWw6IE1vZGVsLCBmaWx0ZXJPcDogTG9naWNhbE9wZXJhbmQ8UHJlZGljYXRlPiwgbm9kZT86IERhdGFGbG93Tm9kZSk6IHN0cmluZyB7XG4gIHJldHVybiBsb2dpY2FsRXhwcihmaWx0ZXJPcCwgKHByZWRpY2F0ZTogUHJlZGljYXRlKSA9PiB7XG4gICAgaWYgKGlzU3RyaW5nKHByZWRpY2F0ZSkpIHtcbiAgICAgIHJldHVybiBwcmVkaWNhdGU7XG4gICAgfSBlbHNlIGlmIChpc1NlbGVjdGlvblByZWRpY2F0ZShwcmVkaWNhdGUpKSB7XG4gICAgICByZXR1cm4gc2VsZWN0aW9uUHJlZGljYXRlKG1vZGVsLCBwcmVkaWNhdGUuc2VsZWN0aW9uLCBub2RlKTtcbiAgICB9IGVsc2UgeyAvLyBGaWx0ZXIgT2JqZWN0XG4gICAgICByZXR1cm4gZmllbGRGaWx0ZXJFeHByZXNzaW9uKHByZWRpY2F0ZSk7XG4gICAgfVxuICB9KTtcbn1cblxuLy8gVGhpcyBtZXRob2QgaXMgdXNlZCBieSBWb3lhZ2VyLiAgRG8gbm90IGNoYW5nZSBpdHMgYmVoYXZpb3Igd2l0aG91dCBjaGFuZ2luZyBWb3lhZ2VyLlxuZXhwb3J0IGZ1bmN0aW9uIGZpZWxkRmlsdGVyRXhwcmVzc2lvbihwcmVkaWNhdGU6IEZpZWxkUHJlZGljYXRlLCB1c2VJblJhbmdlPXRydWUpIHtcbiAgY29uc3QgZmllbGRFeHByID0gcHJlZGljYXRlLnRpbWVVbml0ID9cbiAgICAvLyBGb3IgdGltZVVuaXQsIGNhc3QgaW50byBpbnRlZ2VyIHdpdGggdGltZSgpIHNvIHdlIGNhbiB1c2UgPT09LCBpbnJhbmdlLCBpbmRleE9mIHRvIGNvbXBhcmUgdmFsdWVzIGRpcmVjdGx5LlxuICAgICAgLy8gVE9ETzogV2UgY2FsY3VsYXRlIHRpbWVVbml0IG9uIHRoZSBmbHkgaGVyZS4gQ29uc2lkZXIgaWYgd2Ugd291bGQgbGlrZSB0byBjb25zb2xpZGF0ZSB0aGlzIHdpdGggdGltZVVuaXQgcGlwZWxpbmVcbiAgICAgIC8vIFRPRE86IHN1cHBvcnQgdXRjXG4gICAgKCd0aW1lKCcgKyB0aW1lVW5pdEZpZWxkRXhwcihwcmVkaWNhdGUudGltZVVuaXQsIHByZWRpY2F0ZS5maWVsZCkgKyAnKScpIDpcbiAgICB2Z0ZpZWxkKHByZWRpY2F0ZSwge2V4cHI6ICdkYXR1bSd9KTtcblxuICBpZiAoaXNGaWVsZEVxdWFsUHJlZGljYXRlKHByZWRpY2F0ZSkpIHtcbiAgICByZXR1cm4gZmllbGRFeHByICsgJz09PScgKyB2YWx1ZUV4cHIocHJlZGljYXRlLmVxdWFsLCBwcmVkaWNhdGUudGltZVVuaXQpO1xuICB9IGVsc2UgaWYgKGlzRmllbGRMVFByZWRpY2F0ZShwcmVkaWNhdGUpKSB7XG4gICAgY29uc3QgdXBwZXIgPSBwcmVkaWNhdGUubHQ7XG4gICAgcmV0dXJuIGAke2ZpZWxkRXhwcn08JHt2YWx1ZUV4cHIodXBwZXIsIHByZWRpY2F0ZS50aW1lVW5pdCl9YDtcbiAgfSBlbHNlIGlmIChpc0ZpZWxkR1RQcmVkaWNhdGUocHJlZGljYXRlKSkge1xuICAgIGNvbnN0IGxvd2VyID0gcHJlZGljYXRlLmd0O1xuICAgIHJldHVybiBgJHtmaWVsZEV4cHJ9PiR7dmFsdWVFeHByKGxvd2VyLCBwcmVkaWNhdGUudGltZVVuaXQpfWA7XG4gIH0gZWxzZSBpZiAoaXNGaWVsZExURVByZWRpY2F0ZShwcmVkaWNhdGUpKSB7XG4gICAgY29uc3QgdXBwZXIgPSBwcmVkaWNhdGUubHRlO1xuICAgIHJldHVybiBgJHtmaWVsZEV4cHJ9PD0ke3ZhbHVlRXhwcih1cHBlciwgcHJlZGljYXRlLnRpbWVVbml0KX1gO1xuICB9IGVsc2UgaWYgKGlzRmllbGRHVEVQcmVkaWNhdGUocHJlZGljYXRlKSkge1xuICAgIGNvbnN0IGxvd2VyID0gcHJlZGljYXRlLmd0ZTtcbiAgICByZXR1cm4gYCR7ZmllbGRFeHByfT49JHt2YWx1ZUV4cHIobG93ZXIsIHByZWRpY2F0ZS50aW1lVW5pdCl9YDtcbiAgfSBlbHNlIGlmIChpc0ZpZWxkT25lT2ZQcmVkaWNhdGUocHJlZGljYXRlKSkge1xuICAgIC8vIFwib25lT2ZcIiB3YXMgZm9ybWVybHkgXCJpblwiIC0tIHNvIHdlIG5lZWQgdG8gYWRkIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcbiAgICBjb25zdCBvbmVPZjogRmllbGRPbmVPZlByZWRpY2F0ZVtdID0gcHJlZGljYXRlLm9uZU9mIHx8IHByZWRpY2F0ZVsnaW4nXTtcbiAgICByZXR1cm4gJ2luZGV4b2YoWycgK1xuICAgICAgb25lT2YubWFwKCh2KSA9PiB2YWx1ZUV4cHIodiwgcHJlZGljYXRlLnRpbWVVbml0KSkuam9pbignLCcpICtcbiAgICAgICddLCAnICsgZmllbGRFeHByICsgJykgIT09IC0xJztcbiAgfSBlbHNlIGlmIChpc0ZpZWxkUmFuZ2VQcmVkaWNhdGUocHJlZGljYXRlKSkge1xuICAgIGNvbnN0IGxvd2VyID0gcHJlZGljYXRlLnJhbmdlWzBdO1xuICAgIGNvbnN0IHVwcGVyID0gcHJlZGljYXRlLnJhbmdlWzFdO1xuXG4gICAgaWYgKGxvd2VyICE9PSBudWxsICYmIHVwcGVyICE9PSBudWxsICYmIHVzZUluUmFuZ2UpIHtcbiAgICAgIHJldHVybiAnaW5yYW5nZSgnICsgZmllbGRFeHByICsgJywgWycgK1xuICAgICAgICB2YWx1ZUV4cHIobG93ZXIsIHByZWRpY2F0ZS50aW1lVW5pdCkgKyAnLCAnICtcbiAgICAgICAgdmFsdWVFeHByKHVwcGVyLCBwcmVkaWNhdGUudGltZVVuaXQpICsgJ10pJztcbiAgICB9XG5cbiAgICBjb25zdCBleHBycyA9IFtdO1xuICAgIGlmIChsb3dlciAhPT0gbnVsbCkge1xuICAgICAgZXhwcnMucHVzaChgJHtmaWVsZEV4cHJ9ID49ICR7dmFsdWVFeHByKGxvd2VyLCBwcmVkaWNhdGUudGltZVVuaXQpfWApO1xuICAgIH1cbiAgICBpZiAodXBwZXIgIT09IG51bGwpIHtcbiAgICAgIGV4cHJzLnB1c2goYCR7ZmllbGRFeHByfSA8PSAke3ZhbHVlRXhwcih1cHBlciwgcHJlZGljYXRlLnRpbWVVbml0KX1gKTtcbiAgICB9XG5cbiAgICByZXR1cm4gZXhwcnMubGVuZ3RoID4gMCA/IGV4cHJzLmpvaW4oJyAmJiAnKSA6ICd0cnVlJztcbiAgfVxuXG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBpdCBzaG91bGQgbmV2ZXIgcmVhY2ggaGVyZSAqL1xuICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgZmllbGQgcHJlZGljYXRlOiAke0pTT04uc3RyaW5naWZ5KHByZWRpY2F0ZSl9YCk7XG59XG5cbmZ1bmN0aW9uIHZhbHVlRXhwcih2OiBhbnksIHRpbWVVbml0OiBUaW1lVW5pdCk6IHN0cmluZyB7XG4gIGlmIChpc0RhdGVUaW1lKHYpKSB7XG4gICAgY29uc3QgZXhwciA9IGRhdGVUaW1lRXhwcih2LCB0cnVlKTtcbiAgICByZXR1cm4gJ3RpbWUoJyArIGV4cHIgKyAnKSc7XG4gIH1cbiAgaWYgKGlzTG9jYWxTaW5nbGVUaW1lVW5pdCh0aW1lVW5pdCkpIHtcbiAgICBjb25zdCBkYXRldGltZTogRGF0ZVRpbWUgPSB7fTtcbiAgICBkYXRldGltZVt0aW1lVW5pdF0gPSB2O1xuICAgIGNvbnN0IGV4cHIgPSBkYXRlVGltZUV4cHIoZGF0ZXRpbWUsIHRydWUpO1xuICAgIHJldHVybiAndGltZSgnICsgZXhwciArICcpJztcbiAgfSBlbHNlIGlmIChpc1V0Y1NpbmdsZVRpbWVVbml0KHRpbWVVbml0KSkge1xuICAgIHJldHVybiB2YWx1ZUV4cHIodiwgZ2V0TG9jYWxUaW1lVW5pdCh0aW1lVW5pdCkpO1xuICB9XG4gIHJldHVybiBKU09OLnN0cmluZ2lmeSh2KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZVByZWRpY2F0ZShmOiBQcmVkaWNhdGUpOiBQcmVkaWNhdGUge1xuICBpZiAoaXNGaWVsZFByZWRpY2F0ZShmKSAmJiBmLnRpbWVVbml0KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLmYsXG4gICAgICB0aW1lVW5pdDogbm9ybWFsaXplVGltZVVuaXQoZi50aW1lVW5pdClcbiAgICB9O1xuICB9XG4gIHJldHVybiBmO1xufVxuIl19","import { normalizeLogicalOperand } from './logical';\nimport { normalizePredicate } from './predicate';\nexport function isFilter(t) {\n    return t['filter'] !== undefined;\n}\nexport function isLookup(t) {\n    return t['lookup'] !== undefined;\n}\nexport function isWindow(t) {\n    return t['window'] !== undefined;\n}\nexport function isCalculate(t) {\n    return t['calculate'] !== undefined;\n}\nexport function isBin(t) {\n    return !!t['bin'];\n}\nexport function isTimeUnit(t) {\n    return t['timeUnit'] !== undefined;\n}\nexport function isAggregate(t) {\n    return t['aggregate'] !== undefined;\n}\nexport function isStack(t) {\n    return t['stack'] !== undefined;\n}\nexport function normalizeTransform(transform) {\n    return transform.map(function (t) {\n        if (isFilter(t)) {\n            return {\n                filter: normalizeLogicalOperand(t.filter, normalizePredicate)\n            };\n        }\n        return t;\n    });\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhbnNmb3JtLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3RyYW5zZm9ybS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFJQSxPQUFPLEVBQWlCLHVCQUF1QixFQUFDLE1BQU0sV0FBVyxDQUFDO0FBQ2xFLE9BQU8sRUFBQyxrQkFBa0IsRUFBWSxNQUFNLGFBQWEsQ0FBQztBQTJCMUQsTUFBTSxtQkFBbUIsQ0FBWTtJQUNuQyxPQUFPLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxTQUFTLENBQUM7QUFDbkMsQ0FBQztBQWdPRCxNQUFNLG1CQUFtQixDQUFZO0lBQ25DLE9BQU8sQ0FBQyxDQUFDLFFBQVEsQ0FBQyxLQUFLLFNBQVMsQ0FBQztBQUNuQyxDQUFDO0FBRUQsTUFBTSxtQkFBbUIsQ0FBWTtJQUNuQyxPQUFPLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxTQUFTLENBQUM7QUFDbkMsQ0FBQztBQUVELE1BQU0sc0JBQXNCLENBQVk7SUFDdEMsT0FBTyxDQUFDLENBQUMsV0FBVyxDQUFDLEtBQUssU0FBUyxDQUFDO0FBQ3RDLENBQUM7QUFFRCxNQUFNLGdCQUFnQixDQUFZO0lBQ2hDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUNwQixDQUFDO0FBRUQsTUFBTSxxQkFBcUIsQ0FBWTtJQUNyQyxPQUFPLENBQUMsQ0FBQyxVQUFVLENBQUMsS0FBSyxTQUFTLENBQUM7QUFDckMsQ0FBQztBQUVELE1BQU0sc0JBQXNCLENBQVk7SUFDdEMsT0FBTyxDQUFDLENBQUMsV0FBVyxDQUFDLEtBQUssU0FBUyxDQUFDO0FBQ3RDLENBQUM7QUFFRCxNQUFNLGtCQUFrQixDQUFZO0lBQ2xDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLFNBQVMsQ0FBQztBQUNsQyxDQUFDO0FBSUQsTUFBTSw2QkFBNkIsU0FBc0I7SUFDdkQsT0FBTyxTQUFTLENBQUMsR0FBRyxDQUFDLFVBQUEsQ0FBQztRQUNwQixJQUFJLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBRTtZQUNmLE9BQU87Z0JBQ0wsTUFBTSxFQUFFLHVCQUF1QixDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUUsa0JBQWtCLENBQUM7YUFDOUQsQ0FBQztTQUNIO1FBQ0QsT0FBTyxDQUFDLENBQUM7SUFDWCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0FnZ3JlZ2F0ZU9wfSBmcm9tICd2ZWdhJztcblxuaW1wb3J0IHtCaW5QYXJhbXN9IGZyb20gJy4vYmluJztcbmltcG9ydCB7RGF0YX0gZnJvbSAnLi9kYXRhJztcbmltcG9ydCB7TG9naWNhbE9wZXJhbmQsIG5vcm1hbGl6ZUxvZ2ljYWxPcGVyYW5kfSBmcm9tICcuL2xvZ2ljYWwnO1xuaW1wb3J0IHtub3JtYWxpemVQcmVkaWNhdGUsIFByZWRpY2F0ZX0gZnJvbSAnLi9wcmVkaWNhdGUnO1xuaW1wb3J0IHtTb3J0RmllbGR9IGZyb20gJy4vc29ydCc7XG5pbXBvcnQge1RpbWVVbml0fSBmcm9tICcuL3RpbWV1bml0JztcblxuZXhwb3J0IGludGVyZmFjZSBGaWx0ZXJUcmFuc2Zvcm0ge1xuICAvKipcbiAgICogVGhlIGBmaWx0ZXJgIHByb3BlcnR5IG11c3QgYmUgb25lIG9mIHRoZSBwcmVkaWNhdGUgZGVmaW5pdGlvbnM6XG4gICAqXG4gICAqIDEpIGFuIFtleHByZXNzaW9uXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3R5cGVzLmh0bWwjZXhwcmVzc2lvbikgc3RyaW5nLFxuICAgKiB3aGVyZSBgZGF0dW1gIGNhbiBiZSB1c2VkIHRvIHJlZmVyIHRvIHRoZSBjdXJyZW50IGRhdGEgb2JqZWN0XG4gICAqXG4gICAqIDIpIG9uZSBvZiB0aGUgZmllbGQgcHJlZGljYXRlczogW2BlcXVhbGBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvZmlsdGVyLmh0bWwjZXF1YWwtcHJlZGljYXRlKSxcbiAgICogW2BsdGBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvZmlsdGVyLmh0bWwjbHQtcHJlZGljYXRlKSxcbiAgICogW2BsdGVgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL2ZpbHRlci5odG1sI2x0ZS1wcmVkaWNhdGUpLFxuICAgKiBbYGd0YF0oaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby92ZWdhLWxpdGUvZG9jcy9maWx0ZXIuaHRtbCNndC1wcmVkaWNhdGUpLFxuICAgKiBbYGd0ZWBdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvZmlsdGVyLmh0bWwjZ3RlLXByZWRpY2F0ZSksXG4gICAqIFtgcmFuZ2VgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL2ZpbHRlci5odG1sI3JhbmdlLXByZWRpY2F0ZSksXG4gICAqIG9yIFtgb25lT2ZgXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL2ZpbHRlci5odG1sI29uZS1vZi1wcmVkaWNhdGUpLlxuICAgKlxuICAgKiAzKSBhIFtzZWxlY3Rpb24gcHJlZGljYXRlXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL2ZpbHRlci5odG1sI3NlbGVjdGlvbi1wcmVkaWNhdGUpXG4gICAqXG4gICAqIDQpIGEgbG9naWNhbCBvcGVyYW5kIHRoYXQgY29tYmluZXMgKDEpLCAoMiksIG9yICgzKS5cbiAgICovXG4gIC8vIFRPRE86IGh0dHBzOi8vZ2l0aHViLmNvbS92ZWdhL3ZlZ2EtbGl0ZS9pc3N1ZXMvMjkwMVxuICBmaWx0ZXI6IExvZ2ljYWxPcGVyYW5kPFByZWRpY2F0ZT47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0ZpbHRlcih0OiBUcmFuc2Zvcm0pOiB0IGlzIEZpbHRlclRyYW5zZm9ybSB7XG4gIHJldHVybiB0WydmaWx0ZXInXSAhPT0gdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENhbGN1bGF0ZVRyYW5zZm9ybSB7XG4gIC8qKlxuICAgKiBBIFtleHByZXNzaW9uXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3R5cGVzLmh0bWwjZXhwcmVzc2lvbikgc3RyaW5nLiBVc2UgdGhlIHZhcmlhYmxlIGBkYXR1bWAgdG8gcmVmZXIgdG8gdGhlIGN1cnJlbnQgZGF0YSBvYmplY3QuXG4gICAqL1xuICBjYWxjdWxhdGU6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIGZpZWxkIGZvciBzdG9yaW5nIHRoZSBjb21wdXRlZCBmb3JtdWxhIHZhbHVlLlxuICAgKi9cbiAgYXM6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBCaW5UcmFuc2Zvcm0ge1xuICAvKipcbiAgICogQW4gb2JqZWN0IGluZGljYXRpbmcgYmluIHByb3BlcnRpZXMsIG9yIHNpbXBseSBgdHJ1ZWAgZm9yIHVzaW5nIGRlZmF1bHQgYmluIHBhcmFtZXRlcnMuXG4gICAqL1xuICBiaW46IGJvb2xlYW4gfCBCaW5QYXJhbXM7XG5cbiAgLyoqXG4gICAqIFRoZSBkYXRhIGZpZWxkIHRvIGJpbi5cbiAgICovXG4gIGZpZWxkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBvdXRwdXQgZmllbGRzIGF0IHdoaWNoIHRvIHdyaXRlIHRoZSBzdGFydCBhbmQgZW5kIGJpbiB2YWx1ZXMuXG4gICAqL1xuICBhczogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRpbWVVbml0VHJhbnNmb3JtIHtcbiAgLyoqXG4gICAqIFRoZSB0aW1lVW5pdC5cbiAgICovXG4gIHRpbWVVbml0OiBUaW1lVW5pdDtcblxuICAvKipcbiAgICogVGhlIGRhdGEgZmllbGQgdG8gYXBwbHkgdGltZSB1bml0LlxuICAgKi9cbiAgZmllbGQ6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIG91dHB1dCBmaWVsZCB0byB3cml0ZSB0aGUgdGltZVVuaXQgdmFsdWUuXG4gICAqL1xuICBhczogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFnZ3JlZ2F0ZVRyYW5zZm9ybSB7XG4gIC8qKlxuICAgKiBBcnJheSBvZiBvYmplY3RzIHRoYXQgZGVmaW5lIGZpZWxkcyB0byBhZ2dyZWdhdGUuXG4gICAqL1xuICBhZ2dyZWdhdGU6IEFnZ3JlZ2F0ZWRGaWVsZERlZltdO1xuXG4gIC8qKlxuICAgKiBUaGUgZGF0YSBmaWVsZHMgdG8gZ3JvdXAgYnkuIElmIG5vdCBzcGVjaWZpZWQsIGEgc2luZ2xlIGdyb3VwIGNvbnRhaW5pbmcgYWxsIGRhdGEgb2JqZWN0cyB3aWxsIGJlIHVzZWQuXG4gICAqL1xuICBncm91cGJ5Pzogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQWdncmVnYXRlZEZpZWxkRGVmIHtcbiAgLyoqXG4gICAqIFRoZSBhZ2dyZWdhdGlvbiBvcGVyYXRpb25zIHRvIGFwcGx5IHRvIHRoZSBmaWVsZHMsIHN1Y2ggYXMgc3VtLCBhdmVyYWdlIG9yIGNvdW50LlxuICAgKiBTZWUgdGhlIFtmdWxsIGxpc3Qgb2Ygc3VwcG9ydGVkIGFnZ3JlZ2F0aW9uIG9wZXJhdGlvbnNdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3MvYWdncmVnYXRlLmh0bWwjb3BzKVxuICAgKiBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cbiAgICovXG4gIG9wOiBBZ2dyZWdhdGVPcDtcblxuICAvKipcbiAgICogVGhlIGRhdGEgZmllbGQgZm9yIHdoaWNoIHRvIGNvbXB1dGUgYWdncmVnYXRlIGZ1bmN0aW9uLiBUaGlzIGlzIHJlcXVpcmVkIGZvciBhbGwgYWdncmVnYXRpb24gb3BlcmF0aW9ucyBleGNlcHQgYFwiY291bnRcImAuXG4gICAqL1xuICBmaWVsZD86IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIG91dHB1dCBmaWVsZCBuYW1lcyB0byB1c2UgZm9yIGVhY2ggYWdncmVnYXRlZCBmaWVsZC5cbiAgICovXG4gIGFzOiBzdHJpbmc7XG59XG5cblxuLyoqXG4gKiBAaGlkZVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFN0YWNrVHJhbnNmb3JtIHtcbiAgLyoqXG4gICAqIFRoZSBmaWVsZCB3aGljaCBpcyBzdGFja2VkLlxuICAgKi9cbiAgc3RhY2s6IHN0cmluZztcbiAgLyoqXG4gICAqIFRoZSBkYXRhIGZpZWxkcyB0byBncm91cCBieS5cbiAgICovXG4gIGdyb3VwYnk6IHN0cmluZ1tdO1xuICAvKipcbiAgICogTW9kZSBmb3Igc3RhY2tpbmcgbWFya3MuXG4gICAqIF9fRGVmYXVsdCB2YWx1ZTpfXyBgXCJ6ZXJvXCJgXG4gICAqL1xuICBvZmZzZXQ/OiAnemVybycgfCAnY2VudGVyJyB8ICdub3JtYWxpemUnO1xuICAvKipcbiAgICogRmllbGQgdGhhdCBkZXRlcm1pbmVzIHRoZSBvcmRlciBvZiBsZWF2ZXMgaW4gdGhlIHN0YWNrZWQgY2hhcnRzLlxuICAgKi9cbiAgc29ydD86IFNvcnRGaWVsZFtdO1xuICAvKipcbiAgICogT3V0cHV0IGZpZWxkIG5hbWVzLiBUaGlzIGNhbiBiZSBlaXRoZXIgYSBzdHJpbmcgb3IgYW4gYXJyYXkgb2Ygc3RyaW5ncyB3aXRoXG4gICAqIHR3byBlbGVtZW50cyBkZW5vdGluZyB0aGUgbmFtZSBmb3IgdGhlIGZpZWxkcyBmb3Igc3RhY2sgc3RhcnQgYW5kIHN0YWNrIGVuZFxuICAgKiByZXNwZWN0aXZlbHkuXG4gICAqIElmIGEgc2luZ2xlIHN0cmluZyhlZy5cInZhbFwiKSBpcyBwcm92aWRlZCwgdGhlIGVuZCBmaWVsZCB3aWxsIGJlIFwidmFsX2VuZFwiLlxuICAgKi9cbiAgYXM6IHN0cmluZyB8IHN0cmluZ1tdO1xuXG59XG5cblxuZXhwb3J0IHR5cGUgV2luZG93T25seU9wID1cbiAgJ3Jvd19udW1iZXInIHxcbiAgICdyYW5rJyB8XG4gICAnZGVuc2VfcmFuaycgfFxuICAgJ3BlcmNlbnRfcmFuaycgfFxuICAgJ2N1bWVfZGlzdCcgfFxuICAgJ250aWxlJyB8XG4gICAnbGFnJyB8XG4gICAnbGVhZCcgfFxuICAgJ2ZpcnN0X3ZhbHVlJyB8XG4gICAnbGFzdF92YWx1ZScgfFxuICAgJ250aF92YWx1ZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2luZG93RmllbGREZWYge1xuICAvKipcbiAgICogVGhlIHdpbmRvdyBvciBhZ2dyZWdhdGlvbiBvcGVyYXRpb25zIHRvIGFwcGx5IHdpdGhpbiBhIHdpbmRvdywgaW5jbHVkaW5nIGByYW5rYCwgYGxlYWRgLCBgc3VtYCwgYGF2ZXJhZ2VgIG9yIGBjb3VudGAuIFNlZSB0aGUgbGlzdCBvZiBhbGwgc3VwcG9ydGVkIG9wZXJhdGlvbnMgW2hlcmVdKGh0dHBzOi8vdmVnYS5naXRodWIuaW8vdmVnYS1saXRlL2RvY3Mvd2luZG93Lmh0bWwjb3BzKS5cbiAgICovXG4gIG9wOiBBZ2dyZWdhdGVPcCB8IFdpbmRvd09ubHlPcDtcblxuICAvKipcbiAgICogUGFyYW1ldGVyIHZhbHVlcyBmb3IgdGhlIHdpbmRvdyBmdW5jdGlvbnMuIFBhcmFtZXRlciB2YWx1ZXMgY2FuIGJlIG9taXR0ZWQgZm9yIG9wZXJhdGlvbnMgdGhhdCBkbyBub3QgYWNjZXB0IGEgcGFyYW1ldGVyLlxuICAgKlxuICAgKiBTZWUgdGhlIGxpc3Qgb2YgYWxsIHN1cHBvcnRlZCBvcGVyYXRpb25zIGFuZCB0aGVpciBwYXJhbWV0ZXJzIFtoZXJlXShodHRwczovL3ZlZ2EuZ2l0aHViLmlvL3ZlZ2EtbGl0ZS9kb2NzL3RyYW5zZm9ybXMvd2luZG93Lmh0bWwpLlxuICAgKi9cbiAgcGFyYW0/OiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBkYXRhIGZpZWxkIGZvciB3aGljaCB0byBjb21wdXRlIHRoZSBhZ2dyZWdhdGUgb3Igd2luZG93IGZ1bmN0aW9uLiBUaGlzIGNhbiBiZSBvbWl0dGVkIGZvciB3aW5kb3cgZnVuY3Rpb25zIHRoYXQgZG8gbm90IG9wZXJhdGUgb3ZlciBhIGZpZWxkIHN1Y2ggYXMgYGNvdW50YCwgYHJhbmtgLCBgZGVuc2VfcmFua2AuXG4gICAqL1xuICBmaWVsZD86IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIG91dHB1dCBuYW1lIGZvciB0aGUgd2luZG93IG9wZXJhdGlvbi5cbiAgICovXG4gIGFzOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgV2luZG93VHJhbnNmb3JtIHtcbiAgLyoqXG4gICAqIFRoZSBkZWZpbml0aW9uIG9mIHRoZSBmaWVsZHMgaW4gdGhlIHdpbmRvdywgYW5kIHdoYXQgY2FsY3VsYXRpb25zIHRvIHVzZS5cbiAgICovXG4gIHdpbmRvdzogV2luZG93RmllbGREZWZbXTtcblxuICAvKipcbiAgICogQSBmcmFtZSBzcGVjaWZpY2F0aW9uIGFzIGEgdHdvLWVsZW1lbnQgYXJyYXkgaW5kaWNhdGluZyBob3cgdGhlIHNsaWRpbmcgd2luZG93IHNob3VsZCBwcm9jZWVkLiBUaGUgYXJyYXkgZW50cmllcyBzaG91bGQgZWl0aGVyIGJlIGEgbnVtYmVyIGluZGljYXRpbmcgdGhlIG9mZnNldCBmcm9tIHRoZSBjdXJyZW50IGRhdGEgb2JqZWN0LCBvciBudWxsIHRvIGluZGljYXRlIHVuYm91bmRlZCByb3dzIHByZWNlZGluZyBvciBmb2xsb3dpbmcgdGhlIGN1cnJlbnQgZGF0YSBvYmplY3QuIFRoZSBkZWZhdWx0IHZhbHVlIGlzIGBbbnVsbCwgMF1gLCBpbmRpY2F0aW5nIHRoYXQgdGhlIHNsaWRpbmcgd2luZG93IGluY2x1ZGVzIHRoZSBjdXJyZW50IG9iamVjdCBhbmQgYWxsIHByZWNlZGluZyBvYmplY3RzLiBUaGUgdmFsdWUgYFstNSwgNV1gIGluZGljYXRlcyB0aGF0IHRoZSB3aW5kb3cgc2hvdWxkIGluY2x1ZGUgZml2ZSBvYmplY3RzIHByZWNlZGluZyBhbmQgZml2ZSBvYmplY3RzIGZvbGxvd2luZyB0aGUgY3VycmVudCBvYmplY3QuIEZpbmFsbHksIGBbbnVsbCwgbnVsbF1gIGluZGljYXRlcyB0aGF0IHRoZSB3aW5kb3cgZnJhbWUgc2hvdWxkIGFsd2F5cyBpbmNsdWRlIGFsbCBkYXRhIG9iamVjdHMuIFRoZSBvbmx5IG9wZXJhdG9ycyBhZmZlY3RlZCBhcmUgdGhlIGFnZ3JlZ2F0aW9uIG9wZXJhdGlvbnMgYW5kIHRoZSBgZmlyc3RfdmFsdWVgLCBgbGFzdF92YWx1ZWAsIGFuZCBgbnRoX3ZhbHVlYCB3aW5kb3cgb3BlcmF0aW9ucy4gVGhlIG90aGVyIHdpbmRvdyBvcGVyYXRpb25zIGFyZSBub3QgYWZmZWN0ZWQgYnkgdGhpcy5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fOiAgYFtudWxsLCAwXWAgKGluY2x1ZGVzIHRoZSBjdXJyZW50IG9iamVjdCBhbmQgYWxsIHByZWNlZGluZyBvYmplY3RzKVxuICAgKi9cbiAgZnJhbWU/OiAobnVsbCB8IG51bWJlcilbXTtcblxuICAvKipcbiAgICogSW5kaWNhdGVzIGlmIHRoZSBzbGlkaW5nIHdpbmRvdyBmcmFtZSBzaG91bGQgaWdub3JlIHBlZXIgdmFsdWVzLiAoUGVlciB2YWx1ZXMgYXJlIHRob3NlIGNvbnNpZGVyZWQgaWRlbnRpY2FsIGJ5IHRoZSBzb3J0IGNyaXRlcmlhKS4gVGhlIGRlZmF1bHQgaXMgZmFsc2UsIGNhdXNpbmcgdGhlIHdpbmRvdyBmcmFtZSB0byBleHBhbmQgdG8gaW5jbHVkZSBhbGwgcGVlciB2YWx1ZXMuIElmIHNldCB0byB0cnVlLCB0aGUgd2luZG93IGZyYW1lIHdpbGwgYmUgZGVmaW5lZCBieSBvZmZzZXQgdmFsdWVzIG9ubHkuIFRoaXMgc2V0dGluZyBvbmx5IGFmZmVjdHMgdGhvc2Ugb3BlcmF0aW9ucyB0aGF0IGRlcGVuZCBvbiB0aGUgd2luZG93IGZyYW1lLCBuYW1lbHkgYWdncmVnYXRpb24gb3BlcmF0aW9ucyBhbmQgdGhlIGZpcnN0X3ZhbHVlLCBsYXN0X3ZhbHVlLCBhbmQgbnRoX3ZhbHVlIHdpbmRvdyBvcGVyYXRpb25zLlxuICAgKlxuICAgKiBfX0RlZmF1bHQgdmFsdWU6X18gYGZhbHNlYFxuICAgKi9cbiAgaWdub3JlUGVlcnM/OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGUgZGF0YSBmaWVsZHMgZm9yIHBhcnRpdGlvbmluZyB0aGUgZGF0YSBvYmplY3RzIGludG8gc2VwYXJhdGUgd2luZG93cy4gSWYgdW5zcGVjaWZpZWQsIGFsbCBkYXRhIHBvaW50cyB3aWxsIGJlIGEgc2luZ2xlIGdyb3VwLlxuICAgKi9cbiAgZ3JvdXBieT86IHN0cmluZ1tdO1xuXG4gIC8qKlxuICAgKiBBIHNvcnQgZmllbGQgZGVmaW5pdGlvbiBmb3Igc29ydGluZyBkYXRhIG9iamVjdHMgd2l0aGluIGEgd2luZG93LiBJZiB0d28gZGF0YSBvYmplY3RzIGFyZSBjb25zaWRlcmVkIGVxdWFsIGJ5IHRoZSBjb21wYXJhdG9yLCB0aGV5IGFyZSBjb25zaWRlcmVkIOKAnHBlZXLigJ0gdmFsdWVzIG9mIGVxdWFsIHJhbmsuIElmIHNvcnQgaXMgbm90IHNwZWNpZmllZCwgdGhlIG9yZGVyIGlzIHVuZGVmaW5lZDogZGF0YSBvYmplY3RzIGFyZSBwcm9jZXNzZWQgaW4gdGhlIG9yZGVyIHRoZXkgYXJlIG9ic2VydmVkIGFuZCBub25lIGFyZSBjb25zaWRlcmVkIHBlZXJzICh0aGUgaWdub3JlUGVlcnMgcGFyYW1ldGVyIGlzIGlnbm9yZWQgYW5kIHRyZWF0ZWQgYXMgaWYgc2V0IHRvIGB0cnVlYCkuXG4gICAqL1xuICBzb3J0PzogU29ydEZpZWxkW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTG9va3VwRGF0YSB7XG4gIC8qKlxuICAgKiBTZWNvbmRhcnkgZGF0YSBzb3VyY2UgdG8gbG9va3VwIGluLlxuICAgKi9cbiAgZGF0YTogRGF0YTtcbiAgLyoqXG4gICAqIEtleSBpbiBkYXRhIHRvIGxvb2t1cC5cbiAgICovXG4gIGtleTogc3RyaW5nO1xuICAvKipcbiAgICogRmllbGRzIGluIGZvcmVpZ24gZGF0YSB0byBsb29rdXAuXG4gICAqIElmIG5vdCBzcGVjaWZpZWQsIHRoZSBlbnRpcmUgb2JqZWN0IGlzIHF1ZXJpZWQuXG4gICAqL1xuICBmaWVsZHM/OiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMb29rdXBUcmFuc2Zvcm0ge1xuICAvKipcbiAgICogS2V5IGluIHByaW1hcnkgZGF0YSBzb3VyY2UuXG4gICAqL1xuICBsb29rdXA6IHN0cmluZztcblxuICAvKipcbiAgICogU2Vjb25kYXJ5IGRhdGEgcmVmZXJlbmNlLlxuICAgKi9cbiAgZnJvbTogTG9va3VwRGF0YTtcblxuICAvKipcbiAgICogVGhlIGZpZWxkIG9yIGZpZWxkcyBmb3Igc3RvcmluZyB0aGUgY29tcHV0ZWQgZm9ybXVsYSB2YWx1ZS5cbiAgICogSWYgYGZyb20uZmllbGRzYCBpcyBzcGVjaWZpZWQsIHRoZSB0cmFuc2Zvcm0gd2lsbCB1c2UgdGhlIHNhbWUgbmFtZXMgZm9yIGBhc2AuXG4gICAqIElmIGBmcm9tLmZpZWxkc2AgaXMgbm90IHNwZWNpZmllZCwgYGFzYCBoYXMgdG8gYmUgYSBzdHJpbmcgYW5kIHdlIHB1dCB0aGUgd2hvbGUgb2JqZWN0IGludG8gdGhlIGRhdGEgdW5kZXIgdGhlIHNwZWNpZmllZCBuYW1lLlxuICAgKi9cbiAgYXM/OiBzdHJpbmcgfCBzdHJpbmdbXTtcblxuICAvKipcbiAgICogVGhlIGRlZmF1bHQgdmFsdWUgdG8gdXNlIGlmIGxvb2t1cCBmYWlscy5cbiAgICpcbiAgICogX19EZWZhdWx0IHZhbHVlOl9fIGBudWxsYFxuICAgKi9cbiAgZGVmYXVsdD86IHN0cmluZztcbn1cblxuXG5cbmV4cG9ydCBmdW5jdGlvbiBpc0xvb2t1cCh0OiBUcmFuc2Zvcm0pOiB0IGlzIExvb2t1cFRyYW5zZm9ybSB7XG4gIHJldHVybiB0Wydsb29rdXAnXSAhPT0gdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNXaW5kb3codDogVHJhbnNmb3JtKTogdCBpcyBXaW5kb3dUcmFuc2Zvcm0ge1xuICByZXR1cm4gdFsnd2luZG93J10gIT09IHVuZGVmaW5lZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQ2FsY3VsYXRlKHQ6IFRyYW5zZm9ybSk6IHQgaXMgQ2FsY3VsYXRlVHJhbnNmb3JtIHtcbiAgcmV0dXJuIHRbJ2NhbGN1bGF0ZSddICE9PSB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0Jpbih0OiBUcmFuc2Zvcm0pOiB0IGlzIEJpblRyYW5zZm9ybSB7XG4gIHJldHVybiAhIXRbJ2JpbiddO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNUaW1lVW5pdCh0OiBUcmFuc2Zvcm0pOiB0IGlzIFRpbWVVbml0VHJhbnNmb3JtIHtcbiAgcmV0dXJuIHRbJ3RpbWVVbml0J10gIT09IHVuZGVmaW5lZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQWdncmVnYXRlKHQ6IFRyYW5zZm9ybSk6IHQgaXMgQWdncmVnYXRlVHJhbnNmb3JtIHtcbiAgcmV0dXJuIHRbJ2FnZ3JlZ2F0ZSddICE9PSB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1N0YWNrKHQ6IFRyYW5zZm9ybSk6IHQgaXMgU3RhY2tUcmFuc2Zvcm0ge1xuICByZXR1cm4gdFsnc3RhY2snXSAhPT0gdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgdHlwZSBUcmFuc2Zvcm0gPSBGaWx0ZXJUcmFuc2Zvcm0gfCBDYWxjdWxhdGVUcmFuc2Zvcm0gfCBMb29rdXBUcmFuc2Zvcm0gfCBCaW5UcmFuc2Zvcm0gfCBUaW1lVW5pdFRyYW5zZm9ybSB8IEFnZ3JlZ2F0ZVRyYW5zZm9ybSB8IFdpbmRvd1RyYW5zZm9ybSB8IFN0YWNrVHJhbnNmb3JtO1xuXG5leHBvcnQgZnVuY3Rpb24gbm9ybWFsaXplVHJhbnNmb3JtKHRyYW5zZm9ybTogVHJhbnNmb3JtW10pIHtcbiAgcmV0dXJuIHRyYW5zZm9ybS5tYXAodCA9PiB7XG4gICAgaWYgKGlzRmlsdGVyKHQpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBmaWx0ZXI6IG5vcm1hbGl6ZUxvZ2ljYWxPcGVyYW5kKHQuZmlsdGVyLCBub3JtYWxpemVQcmVkaWNhdGUpXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gdDtcbiAgfSk7XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { binToString } from '../../bin';\nimport { normalizeBin, vgField } from '../../fielddef';\nimport { duplicate, flatten, keys, vals } from '../../util';\nimport { binFormatExpression, binRequiresRange } from '../common';\nimport { isUnitModel } from '../model';\nimport { DataFlowNode } from './dataflow';\nfunction rangeFormula(model, fieldDef, channel, config) {\n    if (binRequiresRange(fieldDef, channel)) {\n        // read format from axis or legend, if there is no format then use config.numberFormat\n        var guide = isUnitModel(model) ? (model.axis(channel) || model.legend(channel) || {}) : {};\n        var startField = vgField(fieldDef, { expr: 'datum', });\n        var endField = vgField(fieldDef, { expr: 'datum', binSuffix: 'end' });\n        return {\n            formulaAs: vgField(fieldDef, { binSuffix: 'range' }),\n            formula: binFormatExpression(startField, endField, guide.format, config)\n        };\n    }\n    return {};\n}\nfunction binKey(bin, field) {\n    return binToString(bin) + \"_\" + field;\n}\nfunction getSignalsFromModel(model, key) {\n    return {\n        signal: model.getName(key + \"_bins\"),\n        extentSignal: model.getName(key + \"_extent\")\n    };\n}\nfunction isBinTransform(t) {\n    return 'as' in t;\n}\nfunction createBinComponent(t, model) {\n    var as;\n    if (isBinTransform(t)) {\n        as = [t.as, t.as + \"_end\"];\n    }\n    else {\n        as = [vgField(t, {}), vgField(t, { binSuffix: 'end' })];\n    }\n    var bin = normalizeBin(t.bin, undefined) || {};\n    var key = binKey(bin, t.field);\n    var _a = getSignalsFromModel(model, key), signal = _a.signal, extentSignal = _a.extentSignal;\n    var binComponent = tslib_1.__assign({ bin: bin, field: t.field, as: as }, signal ? { signal: signal } : {}, extentSignal ? { extentSignal: extentSignal } : {});\n    return { key: key, binComponent: binComponent };\n}\nvar BinNode = /** @class */ (function (_super) {\n    tslib_1.__extends(BinNode, _super);\n    function BinNode(parent, bins) {\n        var _this = _super.call(this, parent) || this;\n        _this.bins = bins;\n        return _this;\n    }\n    BinNode.prototype.clone = function () {\n        return new BinNode(null, duplicate(this.bins));\n    };\n    BinNode.makeFromEncoding = function (parent, model) {\n        var bins = model.reduceFieldDef(function (binComponentIndex, fieldDef, channel) {\n            if (fieldDef.bin) {\n                var _a = createBinComponent(fieldDef, model), key = _a.key, binComponent = _a.binComponent;\n                binComponentIndex[key] = tslib_1.__assign({}, binComponent, binComponentIndex[key], rangeFormula(model, fieldDef, channel, model.config));\n            }\n            return binComponentIndex;\n        }, {});\n        if (keys(bins).length === 0) {\n            return null;\n        }\n        return new BinNode(parent, bins);\n    };\n    /**\n     * Creates a bin node from BinTransform.\n     * The optional parameter should provide\n     */\n    BinNode.makeFromTransform = function (parent, t, model) {\n        var _a;\n        var _b = createBinComponent(t, model), key = _b.key, binComponent = _b.binComponent;\n        return new BinNode(parent, (_a = {},\n            _a[key] = binComponent,\n            _a));\n    };\n    BinNode.prototype.merge = function (other) {\n        this.bins = tslib_1.__assign({}, this.bins, other.bins);\n        other.remove();\n    };\n    BinNode.prototype.producedFields = function () {\n        var out = {};\n        vals(this.bins).forEach(function (c) {\n            c.as.forEach(function (f) { return out[f] = true; });\n        });\n        return out;\n    };\n    BinNode.prototype.dependentFields = function () {\n        var out = {};\n        vals(this.bins).forEach(function (c) {\n            out[c.field] = true;\n        });\n        return out;\n    };\n    BinNode.prototype.assemble = function () {\n        return flatten(vals(this.bins).map(function (bin) {\n            var transform = [];\n            var binTrans = tslib_1.__assign({ type: 'bin', field: bin.field, as: bin.as, signal: bin.signal }, bin.bin);\n            if (!bin.bin.extent && bin.extentSignal) {\n                transform.push({\n                    type: 'extent',\n                    field: bin.field,\n                    signal: bin.extentSignal\n                });\n                binTrans.extent = { signal: bin.extentSignal };\n            }\n            transform.push(binTrans);\n            if (bin.formula) {\n                transform.push({\n                    type: 'formula',\n                    expr: bin.formula,\n                    as: bin.formulaAs\n                });\n            }\n            return transform;\n        }));\n    };\n    return BinNode;\n}(DataFlowNode));\nexport { BinNode };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmluLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvZGF0YS9iaW4udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBWSxXQUFXLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFHakQsT0FBTyxFQUFXLFlBQVksRUFBRSxPQUFPLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUUvRCxPQUFPLEVBQU8sU0FBUyxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBRWhFLE9BQU8sRUFBQyxtQkFBbUIsRUFBRSxnQkFBZ0IsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUNoRSxPQUFPLEVBQUMsV0FBVyxFQUF3QixNQUFNLFVBQVUsQ0FBQztBQUM1RCxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBR3hDLHNCQUFzQixLQUFxQixFQUFFLFFBQTBCLEVBQUUsT0FBZ0IsRUFBRSxNQUFjO0lBQ3JHLElBQUksZ0JBQWdCLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxFQUFFO1FBQ3ZDLHNGQUFzRjtRQUV0RixJQUFNLEtBQUssR0FBRyxXQUFXLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxLQUFLLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7UUFFN0YsSUFBTSxVQUFVLEdBQUcsT0FBTyxDQUFDLFFBQVEsRUFBRSxFQUFDLElBQUksRUFBRSxPQUFPLEdBQUUsQ0FBQyxDQUFDO1FBQ3ZELElBQU0sUUFBUSxHQUFHLE9BQU8sQ0FBQyxRQUFRLEVBQUUsRUFBQyxJQUFJLEVBQUUsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQUMsQ0FBQyxDQUFDO1FBRXRFLE9BQU87WUFDTCxTQUFTLEVBQUUsT0FB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QUFDO0lBQ0gsY0FBQztBQUFELENBQUMsQUFuR0QsQ0FBNkIsWUFBWSxHQW1HeEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0JpblBhcmFtcywgYmluVG9TdHJpbmd9IGZyb20gJy4uLy4uL2Jpbic7XG5pbXBvcnQge0NoYW5uZWx9IGZyb20gJy4uLy4uL2NoYW5uZWwnO1xuaW1wb3J0IHtDb25maWd9IGZyb20gJy4uLy4uL2NvbmZpZyc7XG5pbXBvcnQge0ZpZWxkRGVmLCBub3JtYWxpemVCaW4sIHZnRmllbGR9IGZyb20gJy4uLy4uL2ZpZWxkZGVmJztcbmltcG9ydCB7QmluVHJhbnNmb3JtfSBmcm9tICcuLi8uLi90cmFuc2Zvcm0nO1xuaW1wb3J0IHtEaWN0LCBkdXBsaWNhdGUsIGZsYXR0ZW4sIGtleXMsIHZhbHN9IGZyb20gJy4uLy4uL3V0aWwnO1xuaW1wb3J0IHtWZ0JpblRyYW5zZm9ybSwgVmdUcmFuc2Zvcm19IGZyb20gJy4uLy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7YmluRm9ybWF0RXhwcmVzc2lvbiwgYmluUmVxdWlyZXNSYW5nZX0gZnJvbSAnLi4vY29tbW9uJztcbmltcG9ydCB7aXNVbml0TW9kZWwsIE1vZGVsLCBNb2RlbFdpdGhGaWVsZH0gZnJvbSAnLi4vbW9kZWwnO1xuaW1wb3J0IHtEYXRhRmxvd05vZGV9IGZyb20gJy4vZGF0YWZsb3cnO1xuXG5cbmZ1bmN0aW9uIHJhbmdlRm9ybXVsYShtb2RlbDogTW9kZWxXaXRoRmllbGQsIGZpZWxkRGVmOiBGaWVsZERlZjxzdHJpbmc+LCBjaGFubmVsOiBDaGFubmVsLCBjb25maWc6IENvbmZpZykge1xuICAgIGlmIChiaW5SZXF1aXJlc1JhbmdlKGZpZWxkRGVmLCBjaGFubmVsKSkge1xuICAgICAgLy8gcmVhZCBmb3JtYXQgZnJvbSBheGlzIG9yIGxlZ2VuZCwgaWYgdGhlcmUgaXMgbm8gZm9ybWF0IHRoZW4gdXNlIGNvbmZpZy5udW1iZXJGb3JtYXRcblxuICAgICAgY29uc3QgZ3VpZGUgPSBpc1VuaXRNb2RlbChtb2RlbCkgPyAobW9kZWwuYXhpcyhjaGFubmVsKSB8fCBtb2RlbC5sZWdlbmQoY2hhbm5lbCkgfHwge30pIDoge307XG5cbiAgICAgIGNvbnN0IHN0YXJ0RmllbGQgPSB2Z0ZpZWxkKGZpZWxkRGVmLCB7ZXhwcjogJ2RhdHVtJyx9KTtcbiAgICAgIGNvbnN0IGVuZEZpZWxkID0gdmdGaWVsZChmaWVsZERlZiwge2V4cHI6ICdkYXR1bScsIGJpblN1ZmZpeDogJ2VuZCd9KTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZm9ybXVsYUFzOiB2Z0ZpZWxkKGZpZWxkRGVmLCB7YmluU3VmZml4OiAncmFuZ2UnfSksXG4gICAgICAgIGZvcm11bGE6IGJpbkZvcm1hdEV4cHJlc3Npb24oc3RhcnRGaWVsZCwgZW5kRmllbGQsIGd1aWRlLmZvcm1hdCwgY29uZmlnKVxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHt9O1xufVxuXG5mdW5jdGlvbiBiaW5LZXkoYmluOiBCaW5QYXJhbXMsIGZpZWxkOiBzdHJpbmcpIHtcbiAgcmV0dXJuIGAke2JpblRvU3RyaW5nKGJpbil9XyR7ZmllbGR9YDtcbn1cblxuZnVuY3Rpb24gZ2V0U2lnbmFsc0Zyb21Nb2RlbChtb2RlbDogTW9kZWwsIGtleTogc3RyaW5nKSB7XG4gIHJldHVybiB7XG4gICAgc2lnbmFsOiBtb2RlbC5nZXROYW1lKGAke2tleX1fYmluc2ApLFxuICAgIGV4dGVudFNpZ25hbDogbW9kZWwuZ2V0TmFtZShgJHtrZXl9X2V4dGVudGApXG4gIH07XG59XG5cbmZ1bmN0aW9uIGlzQmluVHJhbnNmb3JtKHQ6IEZpZWxkRGVmPHN0cmluZz4gfCBCaW5UcmFuc2Zvcm0pOiB0IGlzIEJpblRyYW5zZm9ybSB7XG4gIHJldHVybiAnYXMnIGluIHQ7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUJpbkNvbXBvbmVudCh0OiBGaWVsZERlZjxzdHJpbmc+IHwgQmluVHJhbnNmb3JtLCBtb2RlbDogTW9kZWwpIHtcbiAgbGV0IGFzOiBbc3RyaW5nLCBzdHJpbmddO1xuXG4gIGlmIChpc0JpblRyYW5zZm9ybSh0KSkge1xuICAgIGFzID0gW3QuYXMsIGAke3QuYXN9X2VuZGBdO1xuICB9IGVsc2Uge1xuICAgIGFzID0gW3ZnRmllbGQodCwge30pLCB2Z0ZpZWxkKHQsIHtiaW5TdWZmaXg6ICdlbmQnfSldO1xuICB9XG5cbiAgY29uc3QgYmluID0gbm9ybWFsaXplQmluKHQuYmluLCB1bmRlZmluZWQpIHx8IHt9O1xuICBjb25zdCBrZXkgPSBiaW5LZXkoYmluLCB0LmZpZWxkKTtcbiAgY29uc3Qge3NpZ25hbCwgZXh0ZW50U2lnbmFsfSA9IGdldFNpZ25hbHNGcm9tTW9kZWwobW9kZWwsIGtleSk7XG5cbiAgY29uc3QgYmluQ29tcG9uZW50OiBCaW5Db21wb25lbnQgPSB7XG4gICAgYmluOiBiaW4sXG4gICAgZmllbGQ6IHQuZmllbGQsXG4gICAgYXM6IGFzLFxuICAgIC4uLnNpZ25hbCA/IHtzaWduYWx9IDoge30sXG4gICAgLi4uZXh0ZW50U2lnbmFsID8ge2V4dGVudFNpZ25hbH0gOiB7fVxuICB9O1xuXG4gIHJldHVybiB7a2V5LCBiaW5Db21wb25lbnR9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEJpbkNvbXBvbmVudCB7XG4gIGJpbjogQmluUGFyYW1zO1xuICBmaWVsZDogc3RyaW5nO1xuICBleHRlbnRTaWduYWw/OiBzdHJpbmc7XG4gIHNpZ25hbD86IHN0cmluZztcbiAgYXM6IHN0cmluZ1tdO1xuXG4gIC8vIFJhbmdlIEZvcm11bGFcblxuICBmb3JtdWxhPzogc3RyaW5nO1xuICBmb3JtdWxhQXM/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBCaW5Ob2RlIGV4dGVuZHMgRGF0YUZsb3dOb2RlIHtcbiAgcHVibGljIGNsb25lKCkge1xuICAgIHJldHVybiBuZXcgQmluTm9kZShudWxsLCBkdXBsaWNhdGUodGhpcy5iaW5zKSk7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihwYXJlbnQ6IERhdGFGbG93Tm9kZSwgcHJpdmF0ZSBiaW5zOiBEaWN0PEJpbkNvbXBvbmVudD4pIHtcbiAgICBzdXBlcihwYXJlbnQpO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBtYWtlRnJvbUVuY29kaW5nKHBhcmVudDogRGF0YUZsb3dOb2RlLCBtb2RlbDogTW9kZWxXaXRoRmllbGQpIHtcbiAgICBjb25zdCBiaW5zID0gbW9kZWwucmVkdWNlRmllbGREZWYoKGJpbkNvbXBvbmVudEluZGV4OiBEaWN0PEJpbkNvbXBvbmVudD4sIGZpZWxkRGVmLCBjaGFubmVsKSA9PiB7XG4gICAgICBpZiAoZmllbGREZWYuYmluKSB7XG4gICAgICAgIGNvbnN0IHtrZXksIGJpbkNvbXBvbmVudH0gPSBjcmVhdGVCaW5Db21wb25lbnQoZmllbGREZWYsIG1vZGVsKTtcbiAgICAgICAgYmluQ29tcG9uZW50SW5kZXhba2V5XSA9IHtcbiAgICAgICAgICAuLi5iaW5Db21wb25lbnQsXG4gICAgICAgICAgLi4uYmluQ29tcG9uZW50SW5kZXhba2V5XSxcbiAgICAgICAgICAuLi5yYW5nZUZvcm11bGEobW9kZWwsIGZpZWxkRGVmLCBjaGFubmVsLCBtb2RlbC5jb25maWcpXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gYmluQ29tcG9uZW50SW5kZXg7XG4gICAgfSwge30pO1xuXG4gICAgaWYgKGtleXMoYmlucykubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IEJpbk5vZGUocGFyZW50LCBiaW5zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgYmluIG5vZGUgZnJvbSBCaW5UcmFuc2Zvcm0uXG4gICAqIFRoZSBvcHRpb25hbCBwYXJhbWV0ZXIgc2hvdWxkIHByb3ZpZGVcbiAgICovXG4gIHB1YmxpYyBzdGF0aWMgbWFrZUZyb21UcmFuc2Zvcm0ocGFyZW50OiBEYXRhRmxvd05vZGUsIHQ6IEJpblRyYW5zZm9ybSwgbW9kZWw6IE1vZGVsKSB7XG4gICAgY29uc3Qge2tleSwgYmluQ29tcG9uZW50fSA9IGNyZWF0ZUJpbkNvbXBvbmVudCh0LCBtb2RlbCk7XG4gICAgcmV0dXJuIG5ldyBCaW5Ob2RlKHBhcmVudCwge1xuICAgICAgW2tleV06IGJpbkNvbXBvbmVudFxuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIG1lcmdlKG90aGVyOiBCaW5Ob2RlKSB7XG4gICAgdGhpcy5iaW5zID0gey4uLnRoaXMuYmlucywgLi4ub3RoZXIuYmluc307XG4gICAgb3RoZXIucmVtb3ZlKCk7XG4gIH1cblxuICBwdWJsaWMgcHJvZHVjZWRGaWVsZHMoKSB7XG4gICAgY29uc3Qgb3V0ID0ge307XG5cbiAgICB2YWxzKHRoaXMuYmlucykuZm9yRWFjaChjID0+IHtcbiAgICAgIGMuYXMuZm9yRWFjaChmID0+IG91dFtmXSA9IHRydWUpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIG91dDtcbiAgfVxuXG4gIHB1YmxpYyBkZXBlbmRlbnRGaWVsZHMoKSB7XG4gICAgY29uc3Qgb3V0ID0ge307XG5cbiAgICB2YWxzKHRoaXMuYmlucykuZm9yRWFjaChjID0+IHtcbiAgICAgIG91dFtjLmZpZWxkXSA9IHRydWU7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gb3V0O1xuICB9XG5cbiAgcHVibGljIGFzc2VtYmxlKCk6IFZnVHJhbnNmb3JtW10ge1xuICAgIHJldHVybiBmbGF0dGVuKHZhbHModGhpcy5iaW5zKS5tYXAoYmluID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zZm9ybTogVmdUcmFuc2Zvcm1bXSA9IFtdO1xuXG4gICAgICBjb25zdCBiaW5UcmFuczogVmdCaW5UcmFuc2Zvcm0gPSB7XG4gICAgICAgICAgdHlwZTogJ2JpbicsXG4gICAgICAgICAgZmllbGQ6IGJpbi5maWVsZCxcbiAgICAgICAgICBhczogYmluLmFzLFxuICAgICAgICAgIHNpZ25hbDogYmluLnNpZ25hbCxcbiAgICAgICAgICAuLi5iaW4uYmluXG4gICAgICB9O1xuXG4gICAgICBpZiAoIWJpbi5iaW4uZXh0ZW50ICYmIGJpbi5leHRlbnRTaWduYWwpIHtcbiAgICAgICAgdHJhbnNmb3JtLnB1c2goe1xuICAgICAgICAgIHR5cGU6ICdleHRlbnQnLFxuICAgICAgICAgIGZpZWxkOiBiaW4uZmllbGQsXG4gICAgICAgICAgc2lnbmFsOiBiaW4uZXh0ZW50U2lnbmFsXG4gICAgICAgIH0pO1xuICAgICAgICBiaW5UcmFucy5leHRlbnQgPSB7c2lnbmFsOiBiaW4uZXh0ZW50U2lnbmFsfTtcbiAgICAgIH1cblxuICAgICAgdHJhbnNmb3JtLnB1c2goYmluVHJhbnMpO1xuXG4gICAgICBpZiAoYmluLmZvcm11bGEpIHtcbiAgICAgICAgdHJhbnNmb3JtLnB1c2goe1xuICAgICAgICAgIHR5cGU6ICdmb3JtdWxhJyxcbiAgICAgICAgICBleHByOiBiaW4uZm9ybXVsYSxcbiAgICAgICAgICBhczogYmluLmZvcm11bGFBc1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRyYW5zZm9ybTtcbiAgICB9KSk7XG4gIH1cbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { expression } from '../../predicate';\nimport { duplicate } from '../../util';\nimport { DataFlowNode } from './dataflow';\nvar FilterNode = /** @class */ (function (_super) {\n    tslib_1.__extends(FilterNode, _super);\n    function FilterNode(parent, model, filter) {\n        var _this = _super.call(this, parent) || this;\n        _this.model = model;\n        _this.filter = filter;\n        _this.expr = expression(_this.model, _this.filter, _this);\n        return _this;\n    }\n    FilterNode.prototype.clone = function () {\n        return new FilterNode(null, this.model, duplicate(this.filter));\n    };\n    FilterNode.prototype.assemble = function () {\n        return {\n            type: 'filter',\n            expr: this.expr\n        };\n    };\n    return FilterNode;\n}(DataFlowNode));\nexport { FilterNode };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsdGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvZGF0YS9maWx0ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBLE9BQU8sRUFBQyxVQUFVLEVBQVksTUFBTSxpQkFBaUIsQ0FBQztBQUN0RCxPQUFPLEVBQUMsU0FBUyxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBR3JDLE9BQU8sRUFBQyxZQUFZLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFFeEM7SUFBZ0Msc0NBQVk7SUFNMUMsb0JBQVksTUFBb0IsRUFBbUIsS0FBWSxFQUFVLE1BQWlDO1FBQTFHLFlBQ0Usa0JBQU0sTUFBTSxDQUFDLFNBRWQ7UUFIa0QsV0FBSyxHQUFMLEtBQUssQ0FBTztRQUFVLFlBQU0sR0FBTixNQUFNLENBQTJCO1FBRXhHLEtBQUksQ0FBQyxJQUFJLEdBQUcsVUFBVSxDQUFDLEtBQUksQ0FBQyxLQUFLLEVBQUUsS0FBSSxDQUFDLE1BQU0sRUFBRSxLQUFJLENBQUMsQ0FBQzs7SUFDeEQsQ0FBQztJQVBNLDBCQUFLLEdBQVo7UUFDRSxPQUFPLElBQUksVUFBVSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsS0FBSyxFQUFFLFNBQVMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUNsRSxDQUFDO0lBT00sNkJBQVEsR0FBZjtRQUNFLE9BQU87WUFDTCxJQUFJLEVBQUUsUUFBUTtZQUNkLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSTtTQUNoQixDQUFDO0lBQ0osQ0FBQztJQUNILGlCQUFDO0FBQUQsQ0FBQyxBQWpCRCxDQUFnQyxZQUFZLEdBaUIzQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7TG9naWNhbE9wZXJhbmR9IGZyb20gJy4uLy4uL2xvZ2ljYWwnO1xuaW1wb3J0IHtleHByZXNzaW9uLCBQcmVkaWNhdGV9IGZyb20gJy4uLy4uL3ByZWRpY2F0ZSc7XG5pbXBvcnQge2R1cGxpY2F0ZX0gZnJvbSAnLi4vLi4vdXRpbCc7XG5pbXBvcnQge1ZnRmlsdGVyVHJhbnNmb3JtfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge01vZGVsfSBmcm9tICcuLi9tb2RlbCc7XG5pbXBvcnQge0RhdGFGbG93Tm9kZX0gZnJvbSAnLi9kYXRhZmxvdyc7XG5cbmV4cG9ydCBjbGFzcyBGaWx0ZXJOb2RlIGV4dGVuZHMgRGF0YUZsb3dOb2RlIHtcbiAgcHJpdmF0ZSBleHByOiBzdHJpbmc7XG4gIHB1YmxpYyBjbG9uZSgpIHtcbiAgICByZXR1cm4gbmV3IEZpbHRlck5vZGUobnVsbCwgdGhpcy5tb2RlbCwgZHVwbGljYXRlKHRoaXMuZmlsdGVyKSk7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihwYXJlbnQ6IERhdGFGbG93Tm9kZSwgcHJpdmF0ZSByZWFkb25seSBtb2RlbDogTW9kZWwsIHByaXZhdGUgZmlsdGVyOiBMb2dpY2FsT3BlcmFuZDxQcmVkaWNhdGU+KSB7XG4gICAgc3VwZXIocGFyZW50KTtcbiAgICB0aGlzLmV4cHIgPSBleHByZXNzaW9uKHRoaXMubW9kZWwsIHRoaXMuZmlsdGVyLCB0aGlzKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3NlbWJsZSgpOiBWZ0ZpbHRlclRyYW5zZm9ybSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdmaWx0ZXInLFxuICAgICAgZXhwcjogdGhpcy5leHByXG4gICAgfTtcbiAgfVxufVxuIl19","import * as tslib_1 from \"tslib\";\nimport { LATITUDE, LATITUDE2, LONGITUDE, LONGITUDE2, SHAPE } from '../../channel';\nimport { GEOJSON } from '../../type';\nimport { duplicate } from '../../util';\nimport { DataFlowNode } from './dataflow';\nvar GeoJSONNode = /** @class */ (function (_super) {\n    tslib_1.__extends(GeoJSONNode, _super);\n    function GeoJSONNode(parent, fields, geojson, signal) {\n        var _this = _super.call(this, parent) || this;\n        _this.fields = fields;\n        _this.geojson = geojson;\n        _this.signal = signal;\n        return _this;\n    }\n    GeoJSONNode.prototype.clone = function () {\n        return new GeoJSONNode(null, duplicate(this.fields), this.geojson, this.signal);\n    };\n    GeoJSONNode.parseAll = function (parent, model) {\n        var geoJsonCounter = 0;\n        [[LONGITUDE, LATITUDE], [LONGITUDE2, LATITUDE2]].forEach(function (coordinates) {\n            var pair = coordinates.map(function (channel) { return model.channelHasField(channel) ? model.fieldDef(channel).field : undefined; });\n            if (pair[0] || pair[1]) {\n                parent = new GeoJSONNode(parent, pair, null, model.getName(\"geojson_\" + geoJsonCounter++));\n            }\n        });\n        if (model.channelHasField(SHAPE)) {\n            var fieldDef = model.fieldDef(SHAPE);\n            if (fieldDef.type === GEOJSON) {\n                parent = new GeoJSONNode(parent, null, fieldDef.field, model.getName(\"geojson_\" + geoJsonCounter++));\n            }\n        }\n        return parent;\n    };\n    GeoJSONNode.prototype.assemble = function () {\n        return tslib_1.__assign({ type: 'geojson' }, (this.fields ? { fields: this.fields } : {}), (this.geojson ? { geojson: this.geojson } : {}), { signal: this.signal });\n    };\n    return GeoJSONNode;\n}(DataFlowNode));\nexport { GeoJSONNode };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VvanNvbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21waWxlL2RhdGEvZ2VvanNvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFxQixRQUFRLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQ3BHLE9BQU8sRUFBQyxPQUFPLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDbkMsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLFlBQVksQ0FBQztBQUdyQyxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBRXhDO0lBQWlDLHVDQUFZO0lBNEIzQyxxQkFBWSxNQUFvQixFQUFVLE1BQWlCLEVBQVUsT0FBZ0IsRUFBVSxNQUFlO1FBQTlHLFlBQ0Usa0JBQU0sTUFBTSxDQUFDLFNBQ2Q7UUFGeUMsWUFBTSxHQUFOLE1BQU0sQ0FBVztRQUFVLGFBQU8sR0FBUCxPQUFPLENBQVM7UUFBVSxZQUFNLEdBQU4sTUFBTSxDQUFTOztJQUU5RyxDQUFDO0lBN0JNLDJCQUFLLEdBQVo7UUFDRSxPQUFPLElBQUksV0FBVyxDQUFDLElBQUksRUFBRSxTQUFTLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ2xGLENBQUM7SUFFYSxvQkFBUSxHQUF0QixVQUF1QixNQUFvQixFQUFFLEtBQWdCO1FBQzNELElBQUksY0FBYyxHQUFHLENBQUMsQ0FBQztRQUV2QixDQUFDLENBQUMsU0FBUyxFQUFFLFFBQVEsQ0FBQyxFQUFFLENBQUMsVUFBVSxFQUFFLFNBQVMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQUMsV0FBaUM7WUFDekYsSUFBTSxJQUFJLEdBQUcsV0FBVyxDQUFDLEdBQUcsQ0FDMUIsVUFBQSxPQUFPLElBQUksT0FBQSxLQUFLLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUExRSxDQUEwRSxDQUN0RixDQUFDO1lBRUYsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFO2dCQUN0QixNQUFNLEdBQUcsSUFBSSxXQUFXLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxDQUFDLE9BQU8sQ0FBQyxhQUFXLGNBQWMsRUFBSSxDQUFDLENBQUMsQ0FBQzthQUM1RjtRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBSSxLQUFLLENBQUMsZUFBZSxDQUFDLEtBQUssQ0FBQyxFQUFFO1lBQ2hDLElBQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDdkMsSUFBSSxRQUFRLENBQUMsSUFBSSxLQUFLLE9BQU8sRUFBRTtnQkFDN0IsTUFBTSxHQUFHLElBQUksV0FBVyxDQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsUUFBUSxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLGFBQVcsY0FBYyxFQUFJLENBQUMsQ0FBQyxDQUFDO2FBQ3RHO1NBQ0Y7UUFFRCxPQUFPLE1BQU0sQ0FBQztJQUNoQixDQUFDO0lBTU0sOEJBQVEsR0FBZjtRQUNFLDBCQUNFLElBQUksRUFBRSxTQUFTLElBQ1osQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUMxQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxPQUFPLEVBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLElBQ2hELE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxJQUNuQjtJQUNKLENBQUM7SUFDSCxrQkFBQztBQUFELENBQUMsQUF4Q0QsQ0FBaUMsWUFBWSxHQXdDNUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0dlb1Bvc2l0aW9uQ2hhbm5lbCwgTEFUSVRVREUsIExBVElUVURFMiwgTE9OR0lUVURFLCBMT05HSVRVREUyLCBTSEFQRX0gZnJvbSAnLi4vLi4vY2hhbm5lbCc7XG5pbXBvcnQge0dFT0pTT059IGZyb20gJy4uLy4uL3R5cGUnO1xuaW1wb3J0IHtkdXBsaWNhdGV9IGZyb20gJy4uLy4uL3V0aWwnO1xuaW1wb3J0IHtWZ0dlb0pTT05UcmFuc2Zvcm19IGZyb20gJy4uLy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7VW5pdE1vZGVsfSBmcm9tICcuLi91bml0JztcbmltcG9ydCB7RGF0YUZsb3dOb2RlfSBmcm9tICcuL2RhdGFmbG93JztcblxuZXhwb3J0IGNsYXNzIEdlb0pTT05Ob2RlIGV4dGVuZHMgRGF0YUZsb3dOb2RlIHtcbiAgcHVibGljIGNsb25lKCkge1xuICAgIHJldHVybiBuZXcgR2VvSlNPTk5vZGUobnVsbCwgZHVwbGljYXRlKHRoaXMuZmllbGRzKSwgdGhpcy5nZW9qc29uLCB0aGlzLnNpZ25hbCk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIHBhcnNlQWxsKHBhcmVudDogRGF0YUZsb3dOb2RlLCBtb2RlbDogVW5pdE1vZGVsKTogRGF0YUZsb3dOb2RlIHtcbiAgICBsZXQgZ2VvSnNvbkNvdW50ZXIgPSAwO1xuXG4gICAgW1tMT05HSVRVREUsIExBVElUVURFXSwgW0xPTkdJVFVERTIsIExBVElUVURFMl1dLmZvckVhY2goKGNvb3JkaW5hdGVzOiBHZW9Qb3NpdGlvbkNoYW5uZWxbXSkgPT4ge1xuICAgICAgY29uc3QgcGFpciA9IGNvb3JkaW5hdGVzLm1hcChcbiAgICAgICAgY2hhbm5lbCA9PiBtb2RlbC5jaGFubmVsSGFzRmllbGQoY2hhbm5lbCkgPyBtb2RlbC5maWVsZERlZihjaGFubmVsKS5maWVsZCA6IHVuZGVmaW5lZFxuICAgICAgKTtcblxuICAgICAgaWYgKHBhaXJbMF0gfHwgcGFpclsxXSkge1xuICAgICAgICBwYXJlbnQgPSBuZXcgR2VvSlNPTk5vZGUocGFyZW50LCBwYWlyLCBudWxsLCBtb2RlbC5nZXROYW1lKGBnZW9qc29uXyR7Z2VvSnNvbkNvdW50ZXIrK31gKSk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAobW9kZWwuY2hhbm5lbEhhc0ZpZWxkKFNIQVBFKSkge1xuICAgICAgY29uc3QgZmllbGREZWYgPSBtb2RlbC5maWVsZERlZihTSEFQRSk7XG4gICAgICBpZiAoZmllbGREZWYudHlwZSA9PT0gR0VPSlNPTikge1xuICAgICAgICBwYXJlbnQgPSBuZXcgR2VvSlNPTk5vZGUocGFyZW50LCBudWxsLCBmaWVsZERlZi5maWVsZCwgbW9kZWwuZ2V0TmFtZShgZ2VvanNvbl8ke2dlb0pzb25Db3VudGVyKyt9YCkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBwYXJlbnQ7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihwYXJlbnQ6IERhdGFGbG93Tm9kZSwgcHJpdmF0ZSBmaWVsZHM/OiBzdHJpbmdbXSwgcHJpdmF0ZSBnZW9qc29uPzogc3RyaW5nLCBwcml2YXRlIHNpZ25hbD86IHN0cmluZykge1xuICAgIHN1cGVyKHBhcmVudCk7XG4gIH1cblxuICBwdWJsaWMgYXNzZW1ibGUoKTogVmdHZW9KU09OVHJhbnNmb3JtIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogJ2dlb2pzb24nLFxuICAgICAgLi4uKHRoaXMuZmllbGRzID8ge2ZpZWxkczogdGhpcy5maWVsZHN9IDoge30pLFxuICAgICAgLi4uKHRoaXMuZ2VvanNvbiA/IHtnZW9qc29uOiB0aGlzLmdlb2pzb259IDoge30pLFxuICAgICAgc2lnbmFsOiB0aGlzLnNpZ25hbFxuICAgIH07XG4gIH1cbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { LATITUDE, LATITUDE2, LONGITUDE, LONGITUDE2 } from '../../channel';\nimport { duplicate } from '../../util';\nimport { DataFlowNode } from './dataflow';\nvar GeoPointNode = /** @class */ (function (_super) {\n    tslib_1.__extends(GeoPointNode, _super);\n    function GeoPointNode(parent, projection, fields, as) {\n        var _this = _super.call(this, parent) || this;\n        _this.projection = projection;\n        _this.fields = fields;\n        _this.as = as;\n        return _this;\n    }\n    GeoPointNode.prototype.clone = function () {\n        return new GeoPointNode(null, this.projection, duplicate(this.fields), duplicate(this.as));\n    };\n    GeoPointNode.parseAll = function (parent, model) {\n        if (!model.projectionName()) {\n            return parent;\n        }\n        [[LONGITUDE, LATITUDE], [LONGITUDE2, LATITUDE2]].forEach(function (coordinates) {\n            var pair = coordinates.map(function (channel) { return model.channelHasField(channel) ? model.fieldDef(channel).field : undefined; });\n            var suffix = coordinates[0] === LONGITUDE2 ? '2' : '';\n            if (pair[0] || pair[1]) {\n                parent = new GeoPointNode(parent, model.projectionName(), pair, [model.getName('x' + suffix), model.getName('y' + suffix)]);\n            }\n        });\n        return parent;\n    };\n    GeoPointNode.prototype.assemble = function () {\n        return {\n            type: 'geopoint',\n            projection: this.projection,\n            fields: this.fields,\n            as: this.as\n        };\n    };\n    return GeoPointNode;\n}(DataFlowNode));\nexport { GeoPointNode };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VvcG9pbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9kYXRhL2dlb3BvaW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQXFCLFFBQVEsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUM3RixPQUFPLEVBQUMsU0FBUyxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBR3JDLE9BQU8sRUFBQyxZQUFZLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFHeEM7SUFBa0Msd0NBQVk7SUFLNUMsc0JBQVksTUFBb0IsRUFBVSxVQUFrQixFQUFVLE1BQWdCLEVBQVUsRUFBWTtRQUE1RyxZQUNFLGtCQUFNLE1BQU0sQ0FBQyxTQUNkO1FBRnlDLGdCQUFVLEdBQVYsVUFBVSxDQUFRO1FBQVUsWUFBTSxHQUFOLE1BQU0sQ0FBVTtRQUFVLFFBQUUsR0FBRixFQUFFLENBQVU7O0lBRTVHLENBQUM7SUFOTSw0QkFBSyxHQUFaO1FBQ0UsT0FBTyxJQUFJLFlBQVksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFVBQVUsRUFBRSxTQUFTLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUM3RixDQUFDO0lBTWEscUJBQVEsR0FBdEIsVUFBdUIsTUFBb0IsRUFBRSxLQUFnQjtRQUMzRCxJQUFJLENBQUMsS0FBSyxDQUFDLGNBQWMsRUFBRSxFQUFFO1lBQzNCLE9BQU8sTUFBTSxDQUFDO1NBQ2Y7UUFFRCxDQUFDLENBQUMsU0FBUyxFQUFFLFFBQVEsQ0FBQyxFQUFFLENBQUMsVUFBVSxFQUFFLFNBQVMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLFVBQUMsV0FBaUM7WUFDekYsSUFBTSxJQUFJLEdBQUcsV0FBVyxDQUFDLEdBQUcsQ0FDMUIsVUFBQSxPQUFPLElBQUksT0FBQSxLQUFLLENBQUMsZUFBZSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUExRSxDQUEwRSxDQUN0RixDQUFDO1lBRUYsSUFBTSxNQUFNLEdBQUcsV0FBVyxDQUFDLENBQUMsQ0FBQyxLQUFLLFVBQVUsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFFeEQsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFO2dCQUN0QixNQUFNLEdBQUcsSUFBSSxZQUFZLENBQ3ZCLE1BQU0sRUFDTixLQUFLLENBQUMsY0FBYyxFQUFFLEVBQ3RCLElBQUksRUFDSixDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxHQUFHLE1BQU0sQ0FBQyxFQUFFLEtBQUssQ0FBQyxPQUFPLENBQUMsR0FBRyxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQzNELENBQUM7YUFDSDtRQUNILENBQUMsQ0FBQyxDQUFDO1FBRUgsT0FBTyxNQUFNLENBQUM7SUFDaEIsQ0FBQztJQUVNLCtCQUFRLEdBQWY7UUFDRSxPQUFPO1lBQ0wsSUFBSSxFQUFFLFVBQVU7WUFDaEIsVUFBVSxFQUFFLElBQUksQ0FBQyxVQUFVO1lBQzNCLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTTtZQUNuQixFQUFFLEVBQUUsSUFBSSxDQUFDLEVBQUU7U0FDWixDQUFDO0lBQ0osQ0FBQztJQUNILG1CQUFDO0FBQUQsQ0FBQyxBQTFDRCxDQUFrQyxZQUFZLEdBMEM3QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7R2VvUG9zaXRpb25DaGFubmVsLCBMQVRJVFVERSwgTEFUSVRVREUyLCBMT05HSVRVREUsIExPTkdJVFVERTJ9IGZyb20gJy4uLy4uL2NoYW5uZWwnO1xuaW1wb3J0IHtkdXBsaWNhdGV9IGZyb20gJy4uLy4uL3V0aWwnO1xuaW1wb3J0IHtWZ0dlb1BvaW50VHJhbnNmb3JtfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge1VuaXRNb2RlbH0gZnJvbSAnLi4vdW5pdCc7XG5pbXBvcnQge0RhdGFGbG93Tm9kZX0gZnJvbSAnLi9kYXRhZmxvdyc7XG5cblxuZXhwb3J0IGNsYXNzIEdlb1BvaW50Tm9kZSBleHRlbmRzIERhdGFGbG93Tm9kZSB7XG4gIHB1YmxpYyBjbG9uZSgpIHtcbiAgICByZXR1cm4gbmV3IEdlb1BvaW50Tm9kZShudWxsLCB0aGlzLnByb2plY3Rpb24sIGR1cGxpY2F0ZSh0aGlzLmZpZWxkcyksIGR1cGxpY2F0ZSh0aGlzLmFzKSk7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihwYXJlbnQ6IERhdGFGbG93Tm9kZSwgcHJpdmF0ZSBwcm9qZWN0aW9uOiBzdHJpbmcsIHByaXZhdGUgZmllbGRzOiBzdHJpbmdbXSwgcHJpdmF0ZSBhczogc3RyaW5nW10pIHtcbiAgICBzdXBlcihwYXJlbnQpO1xuICB9XG5cbiAgcHVibGljIHN0YXRpYyBwYXJzZUFsbChwYXJlbnQ6IERhdGFGbG93Tm9kZSwgbW9kZWw6IFVuaXRNb2RlbCk6IERhdGFGbG93Tm9kZSB7XG4gICAgaWYgKCFtb2RlbC5wcm9qZWN0aW9uTmFtZSgpKSB7XG4gICAgICByZXR1cm4gcGFyZW50O1xuICAgIH1cblxuICAgIFtbTE9OR0lUVURFLCBMQVRJVFVERV0sIFtMT05HSVRVREUyLCBMQVRJVFVERTJdXS5mb3JFYWNoKChjb29yZGluYXRlczogR2VvUG9zaXRpb25DaGFubmVsW10pID0+IHtcbiAgICAgIGNvbnN0IHBhaXIgPSBjb29yZGluYXRlcy5tYXAoXG4gICAgICAgIGNoYW5uZWwgPT4gbW9kZWwuY2hhbm5lbEhhc0ZpZWxkKGNoYW5uZWwpID8gbW9kZWwuZmllbGREZWYoY2hhbm5lbCkuZmllbGQgOiB1bmRlZmluZWRcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHN1ZmZpeCA9IGNvb3JkaW5hdGVzWzBdID09PSBMT05HSVRVREUyID8gJzInIDogJyc7XG5cbiAgICAgIGlmIChwYWlyWzBdIHx8IHBhaXJbMV0pIHtcbiAgICAgICAgcGFyZW50ID0gbmV3IEdlb1BvaW50Tm9kZShcbiAgICAgICAgICBwYXJlbnQsXG4gICAgICAgICAgbW9kZWwucHJvamVjdGlvbk5hbWUoKSxcbiAgICAgICAgICBwYWlyLFxuICAgICAgICAgIFttb2RlbC5nZXROYW1lKCd4JyArIHN1ZmZpeCksIG1vZGVsLmdldE5hbWUoJ3knICsgc3VmZml4KV1cbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBwYXJlbnQ7XG4gIH1cblxuICBwdWJsaWMgYXNzZW1ibGUoKTogVmdHZW9Qb2ludFRyYW5zZm9ybSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdnZW9wb2ludCcsXG4gICAgICBwcm9qZWN0aW9uOiB0aGlzLnByb2plY3Rpb24sXG4gICAgICBmaWVsZHM6IHRoaXMuZmllbGRzLFxuICAgICAgYXM6IHRoaXMuYXNcbiAgICB9O1xuICB9XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { SELECTION_ID } from '../../selection';\nimport { DataFlowNode } from './dataflow';\nvar IdentifierNode = /** @class */ (function (_super) {\n    tslib_1.__extends(IdentifierNode, _super);\n    function IdentifierNode(parent) {\n        return _super.call(this, parent) || this;\n    }\n    IdentifierNode.prototype.clone = function () {\n        return new IdentifierNode(null);\n    };\n    IdentifierNode.prototype.producedFields = function () {\n        var _a;\n        return _a = {}, _a[SELECTION_ID] = true, _a;\n    };\n    IdentifierNode.prototype.assemble = function () {\n        return { type: 'identifier', as: SELECTION_ID };\n    };\n    return IdentifierNode;\n}(DataFlowNode));\nexport { IdentifierNode };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZW50aWZpZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9kYXRhL2luZGVudGlmaWVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFHN0MsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLFlBQVksQ0FBQztBQUV4QztJQUFvQywwQ0FBWTtJQUs5Qyx3QkFBWSxNQUFvQjtlQUM5QixrQkFBTSxNQUFNLENBQUM7SUFDZixDQUFDO0lBTk0sOEJBQUssR0FBWjtRQUNFLE9BQU8sSUFBSSxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbEMsQ0FBQztJQU1NLHVDQUFjLEdBQXJCOztRQUNFLGdCQUFRLEdBQUMsWUFBWSxJQUFHLElBQUksS0FBRTtJQUNoQyxDQUFDO0lBRU0saUNBQVEsR0FBZjtRQUNFLE9BQU8sRUFBQyxJQUFJLEVBQUUsWUFBWSxFQUFFLEVBQUUsRUFBRSxZQUFZLEVBQUMsQ0FBQztJQUNoRCxDQUFDO0lBQ0gscUJBQUM7QUFBRCxDQUFDLEFBaEJELENBQW9DLFlBQVksR0FnQi9DIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtTRUxFQ1RJT05fSUR9IGZyb20gJy4uLy4uL3NlbGVjdGlvbic7XG5pbXBvcnQge1N0cmluZ1NldH0gZnJvbSAnLi4vLi4vdXRpbCc7XG5pbXBvcnQge1ZnSWRlbnRpZmllclRyYW5zZm9ybX0gZnJvbSAnLi4vLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtEYXRhRmxvd05vZGV9IGZyb20gJy4vZGF0YWZsb3cnO1xuXG5leHBvcnQgY2xhc3MgSWRlbnRpZmllck5vZGUgZXh0ZW5kcyBEYXRhRmxvd05vZGUge1xuICBwdWJsaWMgY2xvbmUoKSB7XG4gICAgcmV0dXJuIG5ldyBJZGVudGlmaWVyTm9kZShudWxsKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHBhcmVudDogRGF0YUZsb3dOb2RlKSB7XG4gICAgc3VwZXIocGFyZW50KTtcbiAgfVxuXG4gIHB1YmxpYyBwcm9kdWNlZEZpZWxkcygpOiBTdHJpbmdTZXQge1xuICAgIHJldHVybiB7W1NFTEVDVElPTl9JRF06IHRydWV9O1xuICB9XG5cbiAgcHVibGljIGFzc2VtYmxlKCk6IFZnSWRlbnRpZmllclRyYW5zZm9ybSB7XG4gICAgcmV0dXJuIHt0eXBlOiAnaWRlbnRpZmllcicsIGFzOiBTRUxFQ1RJT05fSUR9O1xuICB9XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { Split } from '../split';\n/**\n * Class to track interesting properties (see https://15721.courses.cs.cmu.edu/spring2016/papers/graefe-ieee1995.pdf)\n * about how fields have been parsed or whether they have been derived in a transforms. We use this to not parse the\n * same field again (or differently).\n */\nvar AncestorParse = /** @class */ (function (_super) {\n    tslib_1.__extends(AncestorParse, _super);\n    function AncestorParse(explicit, implicit, parseNothing) {\n        if (explicit === void 0) { explicit = {}; }\n        if (implicit === void 0) { implicit = {}; }\n        if (parseNothing === void 0) { parseNothing = false; }\n        var _this = _super.call(this, explicit, implicit) || this;\n        _this.explicit = explicit;\n        _this.implicit = implicit;\n        _this.parseNothing = parseNothing;\n        return _this;\n    }\n    AncestorParse.prototype.clone = function () {\n        var clone = _super.prototype.clone.call(this);\n        clone.parseNothing = this.parseNothing;\n        return clone;\n    };\n    return AncestorParse;\n}(Split));\nexport { AncestorParse };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9kYXRhL2luZGV4LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQSxPQUFPLEVBQUMsS0FBSyxFQUFDLE1BQU0sVUFBVSxDQUFDO0FBa0QvQjs7OztHQUlHO0FBQ0g7SUFBbUMseUNBQW1CO0lBQ3BELHVCQUNrQixRQUFvQyxFQUNwQyxRQUFvQyxFQUM3QyxZQUFvQjtRQUZYLHlCQUFBLEVBQUEsYUFBb0M7UUFDcEMseUJBQUEsRUFBQSxhQUFvQztRQUM3Qyw2QkFBQSxFQUFBLG9CQUFvQjtRQUg3QixZQUtFLGtCQUFNLFFBQVEsRUFBRSxRQUFRLENBQUMsU0FDMUI7UUFMaUIsY0FBUSxHQUFSLFFBQVEsQ0FBNEI7UUFDcEMsY0FBUSxHQUFSLFFBQVEsQ0FBNEI7UUFDN0Msa0JBQVksR0FBWixZQUFZLENBQVE7O0lBRzdCLENBQUM7SUFFTSw2QkFBSyxHQUFaO1FBQ0UsSUFBTSxLQUFLLEdBQUcsaUJBQU0sS0FBSyxXQUFtQixDQUFDO1FBQzdDLEtBQUssQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDLFlBQVksQ0FBQztRQUN2QyxPQUFPLEtBQUssQ0FBQztJQUNmLENBQUM7SUFDSCxvQkFBQztBQUFELENBQUMsQUFkRCxDQUFtQyxLQUFLLEdBY3ZDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtEaWN0fSBmcm9tICcuLi8uLi91dGlsJztcbmltcG9ydCB7U3BsaXR9IGZyb20gJy4uL3NwbGl0JztcbmltcG9ydCB7T3V0cHV0Tm9kZX0gZnJvbSAnLi9kYXRhZmxvdyc7XG5pbXBvcnQge0ZhY2V0Tm9kZX0gZnJvbSAnLi9mYWNldCc7XG5pbXBvcnQge1NvdXJjZU5vZGV9IGZyb20gJy4vc291cmNlJztcblxuZXhwb3J0IGludGVyZmFjZSBEYXRhQ29tcG9uZW50IHtcbiAgLyoqXG4gICAqIEEgZGljdGlvbmFyeSBvZiBzb3VyY2VzIGluZGV4ZWQgYnkgYSBoYXNoLlxuICAgKi9cbiAgc291cmNlczogRGljdDxTb3VyY2VOb2RlPjtcblxuICAvKipcbiAgICogUmVnaXN0cnkgb2Ygb3V0cHV0IG5vZGVzLlxuICAgKi9cbiAgb3V0cHV0Tm9kZXM6IERpY3Q8T3V0cHV0Tm9kZSB8IEZhY2V0Tm9kZT47XG5cbiAgLyoqXG4gICAqIEhvdyBvZnRlbiBpcyBhbiBvdXRwdXQgbm9kZSB1c2VkLiBJZiBpdCBpcyBub3QgdXNlZCwgd2UgZG9uJ3QgbmVlZCB0b1xuICAgKiBpbnN0YW50aWF0ZSBpdCBpbiB0aGUgYXNzZW1ibGUgc3RlcC5cbiAgICovXG4gIG91dHB1dE5vZGVSZWZDb3VudHM6IERpY3Q8bnVtYmVyPjtcblxuICAvKipcbiAgICogVGhlIG91dHB1dCBub2RlIGJlZm9yZSBhZ2dyZWdhdGlvbi5cbiAgICovXG4gIHJhdz86IE91dHB1dE5vZGU7XG5cbiAgLyoqXG4gICAqIFRoZSBtYWluIG91dHB1dCBub2RlLlxuICAgKi9cbiAgbWFpbj86IE91dHB1dE5vZGU7XG5cbiAgLyoqXG4gICAqIEZvciBmYWNldHMsIHdlIHN0b3JlIHRoZSByZWZlcmVuY2UgdG8gdGhlIHJvb3Qgbm9kZS5cbiAgICovXG4gIGZhY2V0Um9vdD86IEZhY2V0Tm9kZTtcblxuICAvKipcbiAgICogVHJ1ZSBpZiB0aGUgZGF0YSBmb3IgdGhpcyBtb2RlbCBpcyBmYWNldGVkLlxuICAgKiBBIGRhdGFzZXQgaXMgZmFjZXRlZCBpZiBhIHBhcmVudCBtb2RlbCBpcyBhIGZhY2V0IGFuZCBubyBuZXcgZGF0YXNldCBpc1xuICAgKiBkZWZpbmVkICh3aGljaCB3b3VsZCBtYWtlIHRoZSBkYXRhIHVuZmFjZXRlZCBhZ2FpbikuXG4gICAqL1xuICBpc0ZhY2V0ZWQ6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFBhcnNlIHByb3BlcnRpZXMgcGFzc2VkIGRvd24gZnJvbSBhbmNlc3RvcnMuIEhlbHBzIHVzIHRvIGtlZXAgdHJhY2sgb2Ygd2hhdCBoYXMgYmVlbiBwYXJzZWQgb3IgaXMgZGVyaXZlZC5cbiAgICovXG4gIGFuY2VzdG9yUGFyc2U/OiBBbmNlc3RvclBhcnNlO1xufVxuXG4vKipcbiAqIENsYXNzIHRvIHRyYWNrIGludGVyZXN0aW5nIHByb3BlcnRpZXMgKHNlZSBodHRwczovLzE1NzIxLmNvdXJzZXMuY3MuY211LmVkdS9zcHJpbmcyMDE2L3BhcGVycy9ncmFlZmUtaWVlZTE5OTUucGRmKVxuICogYWJvdXQgaG93IGZpZWxkcyBoYXZlIGJlZW4gcGFyc2VkIG9yIHdoZXRoZXIgdGhleSBoYXZlIGJlZW4gZGVyaXZlZCBpbiBhIHRyYW5zZm9ybXMuIFdlIHVzZSB0aGlzIHRvIG5vdCBwYXJzZSB0aGVcbiAqIHNhbWUgZmllbGQgYWdhaW4gKG9yIGRpZmZlcmVudGx5KS5cbiAqL1xuZXhwb3J0IGNsYXNzIEFuY2VzdG9yUGFyc2UgZXh0ZW5kcyBTcGxpdDxEaWN0PHN0cmluZz4+IHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIHJlYWRvbmx5IGV4cGxpY2l0OiBQYXJ0aWFsPERpY3Q8c3RyaW5nPj4gPSB7fSxcbiAgICBwdWJsaWMgcmVhZG9ubHkgaW1wbGljaXQ6IFBhcnRpYWw8RGljdDxzdHJpbmc+PiA9IHt9LFxuICAgIHB1YmxpYyBwYXJzZU5vdGhpbmcgPSBmYWxzZVxuICApIHtcbiAgICBzdXBlcihleHBsaWNpdCwgaW1wbGljaXQpO1xuICB9XG5cbiAgcHVibGljIGNsb25lKCk6IEFuY2VzdG9yUGFyc2Uge1xuICAgIGNvbnN0IGNsb25lID0gc3VwZXIuY2xvbmUoKSBhcyBBbmNlc3RvclBhcnNlO1xuICAgIGNsb25lLnBhcnNlTm90aGluZyA9IHRoaXMucGFyc2VOb3RoaW5nO1xuICAgIHJldHVybiBjbG9uZTtcbiAgfVxufVxuIl19","import * as tslib_1 from \"tslib\";\nimport { isString, toSet } from 'vega-util';\nimport * as log from '../../log';\nimport { DataFlowNode, OutputNode } from './dataflow';\nimport { SourceNode } from './source';\nvar LookupNode = /** @class */ (function (_super) {\n    tslib_1.__extends(LookupNode, _super);\n    function LookupNode(parent, transform, secondary) {\n        var _this = _super.call(this, parent) || this;\n        _this.transform = transform;\n        _this.secondary = secondary;\n        return _this;\n    }\n    LookupNode.make = function (parent, model, transform, counter) {\n        var sources = model.component.data.sources;\n        var s = new SourceNode(transform.from.data);\n        var fromSource = sources[s.hash()];\n        if (!fromSource) {\n            sources[s.hash()] = s;\n            fromSource = s;\n        }\n        var fromOutputName = model.getName(\"lookup_\" + counter);\n        var fromOutputNode = new OutputNode(fromSource, fromOutputName, 'lookup', model.component.data.outputNodeRefCounts);\n        model.component.data.outputNodes[fromOutputName] = fromOutputNode;\n        return new LookupNode(parent, transform, fromOutputNode.getSource());\n    };\n    LookupNode.prototype.producedFields = function () {\n        return toSet(this.transform.from.fields || ((this.transform.as instanceof Array) ? this.transform.as : [this.transform.as]));\n    };\n    LookupNode.prototype.assemble = function () {\n        var foreign;\n        if (this.transform.from.fields) {\n            // lookup a few fields and add create a flat output\n            foreign = tslib_1.__assign({ values: this.transform.from.fields }, this.transform.as ? { as: ((this.transform.as instanceof Array) ? this.transform.as : [this.transform.as]) } : {});\n        }\n        else {\n            // lookup full record and nest it\n            var asName = this.transform.as;\n            if (!isString(asName)) {\n                log.warn(log.message.NO_FIELDS_NEEDS_AS);\n                asName = '_lookup';\n            }\n            foreign = {\n                as: [asName]\n            };\n        }\n        return tslib_1.__assign({ type: 'lookup', from: this.secondary, key: this.transform.from.key, fields: [this.transform.lookup] }, foreign, (this.transform.default ? { default: this.transform.default } : {}));\n    };\n    return LookupNode;\n}(DataFlowNode));\nexport { LookupNode };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9va3VwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvZGF0YS9sb29rdXAudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBQyxRQUFRLEVBQUUsS0FBSyxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBQzFDLE9BQU8sS0FBSyxHQUFHLE1BQU0sV0FBVyxDQUFDO0FBS2pDLE9BQU8sRUFBQyxZQUFZLEVBQUUsVUFBVSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQ3BELE9BQU8sRUFBQyxVQUFVLEVBQUMsTUFBTSxVQUFVLENBQUM7QUFFcEM7SUFBZ0Msc0NBQVk7SUFDMUMsb0JBQVksTUFBb0IsRUFBa0IsU0FBMEIsRUFBa0IsU0FBaUI7UUFBL0csWUFDRSxrQkFBTSxNQUFNLENBQUMsU0FDZDtRQUZpRCxlQUFTLEdBQVQsU0FBUyxDQUFpQjtRQUFrQixlQUFTLEdBQVQsU0FBUyxDQUFROztJQUUvRyxDQUFDO0lBRWEsZUFBSSxHQUFsQixVQUFtQixNQUFvQixFQUFFLEtBQVksRUFBRSxTQUEwQixFQUFFLE9BQWU7UUFDaEcsSUFBTSxPQUFPLEdBQUcsS0FBSyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDO1FBQzdDLElBQU0sQ0FBQyxHQUFHLElBQUksVUFBVSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDOUMsSUFBSSxVQUFVLEdBQUcsT0FBTyxDQUFDLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO1FBQ25DLElBQUksQ0FBQyxVQUFVLEVBQUU7WUFDZixPQUFPLENBQUMsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ3RCLFVBQVUsR0FBRyxDQUFDLENBQUM7U0FDaEI7UUFFRCxJQUFNLGNBQWMsR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLFlBQVUsT0FBUyxDQUFDLENBQUM7UUFDMUQsSUFBTSxjQUFjLEdBQUcsSUFBSSxVQUFVLENBQUMsVUFBVSxFQUFFLGNBQWMsRUFBRSxRQUFRLEVBQUUsS0FBSyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsbUJBQW1CLENBQUMsQ0FBQztRQUV0SCxLQUFLLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsY0FBYyxDQUFDLEdBQUcsY0FBYyxDQUFDO1FBRWxFLE9BQU8sSUFBSSxVQUFVLENBQUMsTUFBTSxFQUFFLFNBQVMsRUFBRSxjQUFjLENBQUMsU0FBUyxFQUFFLENBQUMsQ0FBQztJQUN2RSxDQUFDO0lBRU0sbUNBQWMsR0FBckI7UUFDRSxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxNQUFNLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxZQUFZLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUMvSCxDQUFDO0lBRU0sNkJBQVEsR0FBZjtRQUNFLElBQUksT0FBbUMsQ0FBQztRQUV4QyxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRTtZQUM5QixtREFBbUQ7WUFDbkQsT0FBTyxzQkFDTCxNQUFNLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsTUFBTSxJQUM5QixJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxZQUFZLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUNwSCxDQUFDO1NBQ0g7YUFBTTtZQUNMLGlDQUFpQztZQUNqQyxJQUFJLE1BQU0sR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLEVBQUUsQ0FBQztZQUMvQixJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxFQUFFO2dCQUNyQixHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsa0JBQWtCLENBQUMsQ0FBQztnQkFDekMsTUFBTSxHQUFHLFNBQVMsQ0FBQzthQUNwQjtZQUVELE9BQU8sR0FBRztnQkFDUixFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUM7YUFDYixDQUFDO1NBQ0g7UUFFRCwwQkFDRSxJQUFJLEVBQUUsUUFBUSxFQUNkLElBQUksRUFBRSxJQUFJLENBQUMsU0FBUyxFQUNwQixHQUFHLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUM1QixNQUFNLEVBQUUsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxJQUM1QixPQUFPLEVBQ1AsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLEVBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQ3BFO0lBQ0osQ0FBQztJQUNILGlCQUFDO0FBQUQsQ0FBQyxBQXpERCxDQUFnQyxZQUFZLEdBeUQzQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7aXNTdHJpbmcsIHRvU2V0fSBmcm9tICd2ZWdhLXV0aWwnO1xuaW1wb3J0ICogYXMgbG9nIGZyb20gJy4uLy4uL2xvZyc7XG5pbXBvcnQge0xvb2t1cFRyYW5zZm9ybX0gZnJvbSAnLi4vLi4vdHJhbnNmb3JtJztcbmltcG9ydCB7U3RyaW5nU2V0fSBmcm9tICcuLi8uLi91dGlsJztcbmltcG9ydCB7VmdMb29rdXBUcmFuc2Zvcm19IGZyb20gJy4uLy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7TW9kZWx9IGZyb20gJy4uL21vZGVsJztcbmltcG9ydCB7RGF0YUZsb3dOb2RlLCBPdXRwdXROb2RlfSBmcm9tICcuL2RhdGFmbG93JztcbmltcG9ydCB7U291cmNlTm9kZX0gZnJvbSAnLi9zb3VyY2UnO1xuXG5leHBvcnQgY2xhc3MgTG9va3VwTm9kZSBleHRlbmRzIERhdGFGbG93Tm9kZSB7XG4gIGNvbnN0cnVjdG9yKHBhcmVudDogRGF0YUZsb3dOb2RlLCBwdWJsaWMgcmVhZG9ubHkgdHJhbnNmb3JtOiBMb29rdXBUcmFuc2Zvcm0sIHB1YmxpYyByZWFkb25seSBzZWNvbmRhcnk6IHN0cmluZykge1xuICAgIHN1cGVyKHBhcmVudCk7XG4gIH1cblxuICBwdWJsaWMgc3RhdGljIG1ha2UocGFyZW50OiBEYXRhRmxvd05vZGUsIG1vZGVsOiBNb2RlbCwgdHJhbnNmb3JtOiBMb29rdXBUcmFuc2Zvcm0sIGNvdW50ZXI6IG51bWJlcikge1xuICAgIGNvbnN0IHNvdXJjZXMgPSBtb2RlbC5jb21wb25lbnQuZGF0YS5zb3VyY2VzO1xuICAgIGNvbnN0IHMgPSBuZXcgU291cmNlTm9kZSh0cmFuc2Zvcm0uZnJvbS5kYXRhKTtcbiAgICBsZXQgZnJvbVNvdXJjZSA9IHNvdXJjZXNbcy5oYXNoKCldO1xuICAgIGlmICghZnJvbVNvdXJjZSkge1xuICAgICAgc291cmNlc1tzLmhhc2goKV0gPSBzO1xuICAgICAgZnJvbVNvdXJjZSA9IHM7XG4gICAgfVxuXG4gICAgY29uc3QgZnJvbU91dHB1dE5hbWUgPSBtb2RlbC5nZXROYW1lKGBsb29rdXBfJHtjb3VudGVyfWApO1xuICAgIGNvbnN0IGZyb21PdXRwdXROb2RlID0gbmV3IE91dHB1dE5vZGUoZnJvbVNvdXJjZSwgZnJvbU91dHB1dE5hbWUsICdsb29rdXAnLCBtb2RlbC5jb21wb25lbnQuZGF0YS5vdXRwdXROb2RlUmVmQ291bnRzKTtcblxuICAgIG1vZGVsLmNvbXBvbmVudC5kYXRhLm91dHB1dE5vZGVzW2Zyb21PdXRwdXROYW1lXSA9IGZyb21PdXRwdXROb2RlO1xuXG4gICAgcmV0dXJuIG5ldyBMb29rdXBOb2RlKHBhcmVudCwgdHJhbnNmb3JtLCBmcm9tT3V0cHV0Tm9kZS5nZXRTb3VyY2UoKSk7XG4gIH1cblxuICBwdWJsaWMgcHJvZHVjZWRGaWVsZHMoKTogU3RyaW5nU2V0IHtcbiAgICByZXR1cm4gdG9TZXQodGhpcy50cmFuc2Zvcm0uZnJvbS5maWVsZHMgfHwgKCh0aGlzLnRyYW5zZm9ybS5hcyBpbnN0YW5jZW9mIEFycmF5KSA/IHRoaXMudHJhbnNmb3JtLmFzIDogW3RoaXMudHJhbnNmb3JtLmFzXSkpO1xuICB9XG5cbiAgcHVibGljIGFzc2VtYmxlKCk6IFZnTG9va3VwVHJhbnNmb3JtIHtcbiAgICBsZXQgZm9yZWlnbjogUGFydGlhbDxWZ0xvb2t1cFRyYW5zZm9ybT47XG5cbiAgICBpZiAodGhpcy50cmFuc2Zvcm0uZnJvbS5maWVsZHMpIHtcbiAgICAgIC8vIGxvb2t1cCBhIGZldyBmaWVsZHMgYW5kIGFkZCBjcmVhdGUgYSBmbGF0IG91dHB1dFxuICAgICAgZm9yZWlnbiA9IHtcbiAgICAgICAgdmFsdWVzOiB0aGlzLnRyYW5zZm9ybS5mcm9tLmZpZWxkcyxcbiAgICAgICAgLi4uIHRoaXMudHJhbnNmb3JtLmFzID8ge2FzOiAoKHRoaXMudHJhbnNmb3JtLmFzIGluc3RhbmNlb2YgQXJyYXkpID8gdGhpcy50cmFuc2Zvcm0uYXMgOiBbdGhpcy50cmFuc2Zvcm0uYXNdKX0gOiB7fVxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gbG9va3VwIGZ1bGwgcmVjb3JkIGFuZCBuZXN0IGl0XG4gICAgICBsZXQgYXNOYW1lID0gdGhpcy50cmFuc2Zvcm0uYXM7XG4gICAgICBpZiAoIWlzU3RyaW5nKGFzTmFtZSkpIHtcbiAgICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuTk9fRklFTERTX05FRURTX0FTKTtcbiAgICAgICAgYXNOYW1lID0gJ19sb29rdXAnO1xuICAgICAgfVxuXG4gICAgICBmb3JlaWduID0ge1xuICAgICAgICBhczogW2FzTmFtZV1cbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdsb29rdXAnLFxuICAgICAgZnJvbTogdGhpcy5zZWNvbmRhcnksXG4gICAgICBrZXk6IHRoaXMudHJhbnNmb3JtLmZyb20ua2V5LFxuICAgICAgZmllbGRzOiBbdGhpcy50cmFuc2Zvcm0ubG9va3VwXSxcbiAgICAgIC4uLmZvcmVpZ24sXG4gICAgICAuLi4odGhpcy50cmFuc2Zvcm0uZGVmYXVsdCA/IHtkZWZhdWx0OiB0aGlzLnRyYW5zZm9ybS5kZWZhdWx0fSA6IHt9KVxuICAgIH07XG4gIH1cbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { vgField } from '../../fielddef';\nimport { duplicate } from '../../util';\nimport { DataFlowNode } from './dataflow';\n/**\n * A class for the window transform nodes\n */\nvar WindowTransformNode = /** @class */ (function (_super) {\n    tslib_1.__extends(WindowTransformNode, _super);\n    function WindowTransformNode(parent, transform) {\n        var _this = _super.call(this, parent) || this;\n        _this.transform = transform;\n        return _this;\n    }\n    WindowTransformNode.prototype.clone = function () {\n        return new WindowTransformNode(this.parent, duplicate(this.transform));\n    };\n    WindowTransformNode.prototype.producedFields = function () {\n        var _this = this;\n        var out = {};\n        this.transform.window.forEach(function (windowFieldDef) {\n            out[_this.getDefaultName(windowFieldDef)] = true;\n        });\n        return out;\n    };\n    WindowTransformNode.prototype.getDefaultName = function (windowFieldDef) {\n        return windowFieldDef.as || vgField(windowFieldDef);\n    };\n    WindowTransformNode.prototype.assemble = function () {\n        var fields = [];\n        var ops = [];\n        var as = [];\n        var params = [];\n        for (var _i = 0, _a = this.transform.window; _i < _a.length; _i++) {\n            var window_1 = _a[_i];\n            ops.push(window_1.op);\n            as.push(this.getDefaultName(window_1));\n            params.push(window_1.param === undefined ? null : window_1.param);\n            fields.push(window_1.field === undefined ? null : window_1.field);\n        }\n        var frame = this.transform.frame;\n        var groupby = this.transform.groupby;\n        var sortFields = [];\n        var sortOrder = [];\n        if (this.transform.sort !== undefined) {\n            for (var _b = 0, _c = this.transform.sort; _b < _c.length; _b++) {\n                var sortField = _c[_b];\n                sortFields.push(sortField.field);\n                sortOrder.push(sortField.order === undefined ? null : sortField.order);\n            }\n        }\n        var sort = {\n            field: sortFields,\n            order: sortOrder,\n        };\n        var ignorePeers = this.transform.ignorePeers;\n        var result = {\n            type: 'window',\n            params: params,\n            as: as,\n            ops: ops,\n            fields: fields,\n            sort: sort,\n        };\n        if (ignorePeers !== undefined) {\n            result.ignorePeers = ignorePeers;\n        }\n        if (groupby !== undefined) {\n            result.groupby = groupby;\n        }\n        if (frame !== undefined) {\n            result.frame = frame;\n        }\n        return result;\n    };\n    return WindowTransformNode;\n}(DataFlowNode));\nexport { WindowTransformNode };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2luZG93LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvZGF0YS93aW5kb3cudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBLE9BQU8sRUFBQyxPQUFPLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUV2QyxPQUFPLEVBQUMsU0FBUyxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBRXJDLE9BQU8sRUFBQyxZQUFZLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFFeEM7O0dBRUc7QUFDSDtJQUF5QywrQ0FBWTtJQUtuRCw2QkFBWSxNQUFvQixFQUFVLFNBQTBCO1FBQXBFLFlBQ0Usa0JBQU0sTUFBTSxDQUFDLFNBQ2Q7UUFGeUMsZUFBUyxHQUFULFNBQVMsQ0FBaUI7O0lBRXBFLENBQUM7SUFOTSxtQ0FBSyxHQUFaO1FBQ0ksT0FBTyxJQUFJLG1CQUFtQixDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsU0FBUyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO0lBQzNFLENBQUM7SUFNTSw0Q0FBYyxHQUFyQjtRQUFBLGlCQU9DO1FBTkMsSUFBTSxHQUFHLEdBQUcsRUFBRSxDQUFDO1FBQ2YsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQUEsY0FBYztZQUMxQyxHQUFHLENBQUMsS0FBSSxDQUFDLGNBQWMsQ0FBQyxjQUFjLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQztRQUNsRCxDQUFDLENBQUMsQ0FBQztRQUVILE9BQU8sR0FBRyxDQUFDO0lBQ2IsQ0FBQztJQUVPLDRDQUFjLEdBQXRCLFVBQXVCLGNBQThCO1FBQ25ELE9BQU8sY0FBYyxDQUFDLEVBQUUsSUFBSSxPQUFPLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDdEQsQ0FBQztJQUVNLHNDQUFRLEdBQWY7UUFDRSxJQUFNLE1BQU0sR0FBYSxFQUFFLENBQUM7UUFDNUIsSUFBTSxHQUFHLEdBQW1DLEVBQUUsQ0FBQztRQUMvQyxJQUFNLEVBQUUsR0FBRyxFQUFFLENBQUM7UUFDZCxJQUFNLE1BQU0sR0FBRyxFQUFFLENBQUM7UUFDbEIsS0FBcUIsVUFBcUIsRUFBckIsS0FBQSxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sRUFBckIsY0FBcUIsRUFBckIsSUFBcUIsRUFBRTtZQUF2QyxJQUFNLFFBQU0sU0FBQTtZQUNmLEdBQUcsQ0FBQyxJQUFJLENBQUMsUUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQ3BCLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxRQUFNLENBQUMsQ0FBQyxDQUFDO1lBQ3JDLE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBTSxDQUFDLEtBQUssS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsUUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzlELE1BQU0sQ0FBQyxJQUFJLENBQUMsUUFBTSxDQUFDLEtBQUssS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsUUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQy9EO1FBRUQsSUFBTSxLQUFLLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUM7UUFDbkMsSUFBTSxPQUFPLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUM7UUFDdkMsSUFBTSxVQUFVLEdBQWEsRUFBRSxDQUFDO1FBQ2hDLElBQU0sU0FBUyxHQUF3QixFQUFFLENBQUM7UUFDMUMsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksS0FBSyxTQUFTLEVBQUU7WUFDckMsS0FBd0IsVUFBbUIsRUFBbkIsS0FBQSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksRUFBbkIsY0FBbUIsRUFBbkIsSUFBbUIsRUFBRTtnQkFBeEMsSUFBTSxTQUFTLFNBQUE7Z0JBQ2xCLFVBQVUsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO2dCQUNqQyxTQUFTLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxLQUEwQixDQUFDLENBQUM7YUFDN0Y7U0FDRjtRQUNELElBQU0sSUFBSSxHQUFpQjtZQUN6QixLQUFLLEVBQUUsVUFBVTtZQUNqQixLQUFLLEVBQUUsU0FBUztTQUNqQixDQUFDO1FBQ0YsSUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUM7UUFFL0MsSUFBTSxNQUFNLEdBQXNCO1lBQ2hDLElBQUksRUFBRSxRQUFRO1lBQ2QsTUFBTSxRQUFBO1lBQ04sRUFBRSxJQUFBO1lBQ0YsR0FBRyxLQUFBO1lBQ0gsTUFBTSxRQUFBO1lBQ04sSUFBSSxNQUFBO1NBQ0wsQ0FBQztRQUVGLElBQUksV0FBVyxLQUFLLFNBQVMsRUFBRTtZQUM3QixNQUFNLENBQUMsV0FBVyxHQUFHLFdBQVcsQ0FBQztTQUNsQztRQUVELElBQUksT0FBTyxLQUFLLFNBQVMsRUFBRTtZQUN6QixNQUFNLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztTQUMxQjtRQUVELElBQUksS0FBSyxLQUFLLFNBQVMsRUFBRTtZQUN2QixNQUFNLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztTQUN0QjtRQUVELE9BQU8sTUFBTSxDQUFDO0lBQ2hCLENBQUM7SUFDSCwwQkFBQztBQUFELENBQUMsQUF6RUQsQ0FBeUMsWUFBWSxHQXlFcEQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0FnZ3JlZ2F0ZU9wfSBmcm9tICd2ZWdhJztcbmltcG9ydCB7dmdGaWVsZH0gZnJvbSAnLi4vLi4vZmllbGRkZWYnO1xuaW1wb3J0IHtXaW5kb3dGaWVsZERlZiwgV2luZG93T25seU9wLCBXaW5kb3dUcmFuc2Zvcm19IGZyb20gJy4uLy4uL3RyYW5zZm9ybSc7XG5pbXBvcnQge2R1cGxpY2F0ZX0gZnJvbSAnLi4vLi4vdXRpbCc7XG5pbXBvcnQge1ZnQ29tcGFyYXRvciwgVmdDb21wYXJhdG9yT3JkZXIsIFZnV2luZG93VHJhbnNmb3JtfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge0RhdGFGbG93Tm9kZX0gZnJvbSAnLi9kYXRhZmxvdyc7XG5cbi8qKlxuICogQSBjbGFzcyBmb3IgdGhlIHdpbmRvdyB0cmFuc2Zvcm0gbm9kZXNcbiAqL1xuZXhwb3J0IGNsYXNzIFdpbmRvd1RyYW5zZm9ybU5vZGUgZXh0ZW5kcyBEYXRhRmxvd05vZGUge1xuICBwdWJsaWMgY2xvbmUoKSB7XG4gICAgICByZXR1cm4gbmV3IFdpbmRvd1RyYW5zZm9ybU5vZGUodGhpcy5wYXJlbnQsIGR1cGxpY2F0ZSh0aGlzLnRyYW5zZm9ybSkpO1xuICB9XG5cbiAgY29uc3RydWN0b3IocGFyZW50OiBEYXRhRmxvd05vZGUsIHByaXZhdGUgdHJhbnNmb3JtOiBXaW5kb3dUcmFuc2Zvcm0pIHtcbiAgICBzdXBlcihwYXJlbnQpO1xuICB9XG5cbiAgcHVibGljIHByb2R1Y2VkRmllbGRzKCkge1xuICAgIGNvbnN0IG91dCA9IHt9O1xuICAgIHRoaXMudHJhbnNmb3JtLndpbmRvdy5mb3JFYWNoKHdpbmRvd0ZpZWxkRGVmID0+IHtcbiAgICAgIG91dFt0aGlzLmdldERlZmF1bHROYW1lKHdpbmRvd0ZpZWxkRGVmKV0gPSB0cnVlO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIG91dDtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0RGVmYXVsdE5hbWUod2luZG93RmllbGREZWY6IFdpbmRvd0ZpZWxkRGVmKTogc3RyaW5nIHtcbiAgICByZXR1cm4gd2luZG93RmllbGREZWYuYXMgfHwgdmdGaWVsZCh3aW5kb3dGaWVsZERlZik7XG4gIH1cblxuICBwdWJsaWMgYXNzZW1ibGUoKTogVmdXaW5kb3dUcmFuc2Zvcm0ge1xuICAgIGNvbnN0IGZpZWxkczogc3RyaW5nW10gPSBbXTtcbiAgICBjb25zdCBvcHM6IChBZ2dyZWdhdGVPcCB8IFdpbmRvd09ubHlPcClbXSA9IFtdO1xuICAgIGNvbnN0IGFzID0gW107XG4gICAgY29uc3QgcGFyYW1zID0gW107XG4gICAgZm9yIChjb25zdCB3aW5kb3cgb2YgdGhpcy50cmFuc2Zvcm0ud2luZG93KSB7XG4gICAgICBvcHMucHVzaCh3aW5kb3cub3ApO1xuICAgICAgYXMucHVzaCh0aGlzLmdldERlZmF1bHROYW1lKHdpbmRvdykpO1xuICAgICAgcGFyYW1zLnB1c2god2luZG93LnBhcmFtID09PSB1bmRlZmluZWQgPyBudWxsIDogd2luZG93LnBhcmFtKTtcbiAgICAgIGZpZWxkcy5wdXNoKHdpbmRvdy5maWVsZCA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IHdpbmRvdy5maWVsZCk7XG4gICAgfVxuXG4gICAgY29uc3QgZnJhbWUgPSB0aGlzLnRyYW5zZm9ybS5mcmFtZTtcbiAgICBjb25zdCBncm91cGJ5ID0gdGhpcy50cmFuc2Zvcm0uZ3JvdXBieTtcbiAgICBjb25zdCBzb3J0RmllbGRzOiBzdHJpbmdbXSA9IFtdO1xuICAgIGNvbnN0IHNvcnRPcmRlcjogVmdDb21wYXJhdG9yT3JkZXJbXSA9IFtdO1xuICAgIGlmICh0aGlzLnRyYW5zZm9ybS5zb3J0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGZvciAoY29uc3Qgc29ydEZpZWxkIG9mIHRoaXMudHJhbnNmb3JtLnNvcnQpIHtcbiAgICAgICAgc29ydEZpZWxkcy5wdXNoKHNvcnRGaWVsZC5maWVsZCk7XG4gICAgICAgIHNvcnRPcmRlci5wdXNoKHNvcnRGaWVsZC5vcmRlciA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IHNvcnRGaWVsZC5vcmRlciBhcyBWZ0NvbXBhcmF0b3JPcmRlcik7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHNvcnQ6IFZnQ29tcGFyYXRvciA9IHtcbiAgICAgIGZpZWxkOiBzb3J0RmllbGRzLFxuICAgICAgb3JkZXI6IHNvcnRPcmRlcixcbiAgICB9O1xuICAgIGNvbnN0IGlnbm9yZVBlZXJzID0gdGhpcy50cmFuc2Zvcm0uaWdub3JlUGVlcnM7XG5cbiAgICBjb25zdCByZXN1bHQ6IFZnV2luZG93VHJhbnNmb3JtID0ge1xuICAgICAgdHlwZTogJ3dpbmRvdycsXG4gICAgICBwYXJhbXMsXG4gICAgICBhcyxcbiAgICAgIG9wcyxcbiAgICAgIGZpZWxkcyxcbiAgICAgIHNvcnQsXG4gICAgfTtcblxuICAgIGlmIChpZ25vcmVQZWVycyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXN1bHQuaWdub3JlUGVlcnMgPSBpZ25vcmVQZWVycztcbiAgICB9XG5cbiAgICBpZiAoZ3JvdXBieSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXN1bHQuZ3JvdXBieSA9IGdyb3VwYnk7XG4gICAgfVxuXG4gICAgaWYgKGZyYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJlc3VsdC5mcmFtZSA9IGZyYW1lO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { MAIN, RAW } from '../../data';\nimport * as log from '../../log';\nimport { isAggregate, isBin, isCalculate, isFilter, isLookup, isStack, isTimeUnit, isWindow } from '../../transform';\nimport { keys } from '../../util';\nimport { isFacetModel, isLayerModel, isUnitModel } from '../model';\nimport { requiresSelectionId } from '../selection/selection';\nimport { AggregateNode } from './aggregate';\nimport { BinNode } from './bin';\nimport { CalculateNode } from './calculate';\nimport { OutputNode } from './dataflow';\nimport { FacetNode } from './facet';\nimport { FilterNode } from './filter';\nimport { FilterInvalidNode } from './filterinvalid';\nimport { ParseNode } from './formatparse';\nimport { GeoJSONNode } from './geojson';\nimport { GeoPointNode } from './geopoint';\nimport { IdentifierNode } from './indentifier';\nimport { AncestorParse } from './index';\nimport { LookupNode } from './lookup';\nimport { SourceNode } from './source';\nimport { StackNode } from './stack';\nimport { TimeUnitNode } from './timeunit';\nimport { WindowTransformNode } from './window';\nfunction parseRoot(model, sources) {\n    if (model.data || !model.parent) {\n        // if the model defines a data source or is the root, create a source node\n        var source = new SourceNode(model.data);\n        var hash = source.hash();\n        if (hash in sources) {\n            // use a reference if we already have a source\n            return sources[hash];\n        }\n        else {\n            // otherwise add a new one\n            sources[hash] = source;\n            return source;\n        }\n    }\n    else {\n        // If we don't have a source defined (overriding parent's data), use the parent's facet root or main.\n        return model.parent.component.data.facetRoot ? model.parent.component.data.facetRoot : model.parent.component.data.main;\n    }\n}\n/**\n * Parses a transforms array into a chain of connected dataflow nodes.\n */\nexport function parseTransformArray(head, model, ancestorParse) {\n    var lookupCounter = 0;\n    model.transforms.forEach(function (t) {\n        if (isCalculate(t)) {\n            head = new CalculateNode(head, t);\n            ancestorParse.set(t.as, 'derived', false);\n        }\n        else if (isFilter(t)) {\n            head = ParseNode.makeImplicitFromFilterTransform(head, t, ancestorParse) || head;\n            head = new FilterNode(head, model, t.filter);\n        }\n        else if (isBin(t)) {\n            head = BinNode.makeFromTransform(head, t, model);\n            ancestorParse.set(t.as, 'number', false);\n        }\n        else if (isTimeUnit(t)) {\n            head = TimeUnitNode.makeFromTransform(head, t);\n            ancestorParse.set(t.as, 'date', false);\n        }\n        else if (isAggregate(t)) {\n            var agg = head = AggregateNode.makeFromTransform(head, t);\n            if (requiresSelectionId(model)) {\n                head = new IdentifierNode(head);\n            }\n            for (var _i = 0, _a = keys(agg.producedFields()); _i < _a.length; _i++) {\n                var field = _a[_i];\n                ancestorParse.set(field, 'derived', false);\n            }\n        }\n        else if (isLookup(t)) {\n            var lookup = head = LookupNode.make(head, model, t, lookupCounter++);\n            for (var _b = 0, _c = keys(lookup.producedFields()); _b < _c.length; _b++) {\n                var field = _c[_b];\n                ancestorParse.set(field, 'derived', false);\n            }\n        }\n        else if (isWindow(t)) {\n            var window_1 = head = new WindowTransformNode(head, t);\n            for (var _d = 0, _e = keys(window_1.producedFields()); _d < _e.length; _d++) {\n                var field = _e[_d];\n                ancestorParse.set(field, 'derived', false);\n            }\n        }\n        else if (isStack(t)) {\n            var stack = head = StackNode.makeFromTransform(head, t);\n            for (var _f = 0, _g = keys(stack.producedFields()); _f < _g.length; _f++) {\n                var field = _g[_f];\n                ancestorParse.set(field, 'derived', false);\n            }\n        }\n        else {\n            log.warn(log.message.invalidTransformIgnored(t));\n            return;\n        }\n    });\n    return head;\n}\n/*\nDescription of the dataflow (http://asciiflow.com/):\n     +--------+\n     | Source |\n     +---+----+\n         |\n         v\n     FormatParse\n     (explicit)\n         |\n         v\n     Transforms\n(Filter, Calculate, Binning, TimeUnit, Aggregate, Window, ...)\n         |\n         v\n     FormatParse\n     (implicit)\n         |\n         v\n Binning (in `encoding`)\n         |\n         v\n Timeunit (in `encoding`)\n         |\n         v\nFormula From Sort Array\n         |\n         v\n      +--+--+\n      | Raw |\n      +-----+\n         |\n         v\n  Aggregate (in `encoding`)\n         |\n         v\n  Stack (in `encoding`)\n         |\n         v\n  Invalid Filter\n         |\n         v\n   +----------+\n   |   Main   |\n   +----------+\n         |\n         v\n     +-------+\n     | Facet |----> \"column\", \"column-layout\", and \"row\"\n     +-------+\n         |\n         v\n  ...Child data...\n*/\nexport function parseData(model) {\n    var head = parseRoot(model, model.component.data.sources);\n    var _a = model.component.data, outputNodes = _a.outputNodes, outputNodeRefCounts = _a.outputNodeRefCounts;\n    var ancestorParse = model.parent ? model.parent.component.data.ancestorParse.clone() : new AncestorParse();\n    // format.parse: null means disable parsing\n    if (model.data && model.data.format && model.data.format.parse === null) {\n        ancestorParse.parseNothing = true;\n    }\n    head = ParseNode.makeExplicit(head, model, ancestorParse) || head;\n    // Default discrete selections require an identifier transform to\n    // uniquely identify data points as the _id field is volatile. Add\n    // this transform at the head of our pipeline such that the identifier\n    // field is available for all subsequent datasets. Additional identifier\n    // transforms will be necessary when new tuples are constructed\n    // (e.g., post-aggregation).\n    if (requiresSelectionId(model) && (isUnitModel(model) || isLayerModel(model))) {\n        head = new IdentifierNode(head);\n    }\n    // HACK: This is equivalent for merging bin extent for union scale.\n    // FIXME(https://github.com/vega/vega-lite/issues/2270): Correctly merge extent / bin node for shared bin scale\n    var parentIsLayer = model.parent && isLayerModel(model.parent);\n    if (isUnitModel(model) || isFacetModel(model)) {\n        if (parentIsLayer) {\n            head = BinNode.makeFromEncoding(head, model) || head;\n        }\n    }\n    if (model.transforms.length > 0) {\n        head = parseTransformArray(head, model, ancestorParse);\n    }\n    head = ParseNode.makeImplicitFromEncoding(head, model, ancestorParse) || head;\n    if (isUnitModel(model)) {\n        head = GeoJSONNode.parseAll(head, model);\n        head = GeoPointNode.parseAll(head, model);\n    }\n    if (isUnitModel(model) || isFacetModel(model)) {\n        if (!parentIsLayer) {\n            head = BinNode.makeFromEncoding(head, model) || head;\n        }\n        head = TimeUnitNode.makeFromEncoding(head, model) || head;\n        head = CalculateNode.parseAllForSortIndex(head, model);\n    }\n    // add an output node pre aggregation\n    var rawName = model.getName(RAW);\n    var raw = new OutputNode(head, rawName, RAW, outputNodeRefCounts);\n    outputNodes[rawName] = raw;\n    head = raw;\n    if (isUnitModel(model)) {\n        var agg = AggregateNode.makeFromEncoding(head, model);\n        if (agg) {\n            head = agg;\n            if (requiresSelectionId(model)) {\n                head = new IdentifierNode(head);\n            }\n        }\n        head = StackNode.makeFromEncoding(head, model) || head;\n    }\n    if (isUnitModel(model)) {\n        head = FilterInvalidNode.make(head, model) || head;\n    }\n    // output node for marks\n    var mainName = model.getName(MAIN);\n    var main = new OutputNode(head, mainName, MAIN, outputNodeRefCounts);\n    outputNodes[mainName] = main;\n    head = main;\n    // add facet marker\n    var facetRoot = null;\n    if (isFacetModel(model)) {\n        var facetName = model.getName('facet');\n        facetRoot = new FacetNode(head, model, facetName, main.getSource());\n        outputNodes[facetName] = facetRoot;\n        head = facetRoot;\n    }\n    return tslib_1.__assign({}, model.component.data, { outputNodes: outputNodes,\n        outputNodeRefCounts: outputNodeRefCounts,\n        raw: raw,\n        main: main,\n        facetRoot: facetRoot,\n        ancestorParse: ancestorParse });\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyc2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9kYXRhL3BhcnNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUMsSUFBSSxFQUFFLEdBQUcsRUFBQyxNQUFNLFlBQVksQ0FBQztBQUNyQyxPQUFPLEtBQUssR0FBRyxNQUFNLFdBQVcsQ0FBQztBQUNqQyxPQUFPLEVBQUMsV0FBVyxFQUFFLEtBQUssRUFBRSxXQUFXLEVBQUUsUUFBUSxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBQyxNQUFNLGlCQUFpQixDQUFDO0FBQ25ILE9BQU8sRUFBTyxJQUFJLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDdEMsT0FBTyxFQUFDLFlBQVksRUFBRSxZQUFZLEVBQUUsV0FBVyxFQUFRLE1BQU0sVUFBVSxDQUFDO0FBQ3hFLE9BQU8sRUFBQyxtQkFBbUIsRUFBQyxNQUFNLHdCQUF3QixDQUFDO0FBQzNELE9BQU8sRUFBQyxhQUFhLEVBQUMsTUFBTSxhQUFhLENBQUM7QUFDMUMsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLE9BQU8sQ0FBQztBQUM5QixPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0sYUFBYSxDQUFDO0FBQzFDLE9BQU8sRUFBZSxVQUFVLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDcEQsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLFNBQVMsQ0FBQztBQUNsQyxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0sVUFBVSxDQUFDO0FBQ3BDLE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLGlCQUFpQixDQUFDO0FBQ2xELE9BQU8sRUFBQyxTQUFTLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDeEMsT0FBTyxFQUFDLFdBQVcsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUN0QyxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQ3hDLE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDN0MsT0FBTyxFQUFDLGFBQWEsRUFBZ0IsTUFBTSxTQUFTLENBQUM7QUFDckQsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLFVBQVUsQ0FBQztBQUNwQyxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0sVUFBVSxDQUFDO0FBQ3BDLE9BQU8sRUFBQyxTQUFTLEVBQUMsTUFBTSxTQUFTLENBQUM7QUFDbEMsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLFlBQVksQ0FBQztBQUN4QyxPQUFPLEVBQUMsbUJBQW1CLEVBQUMsTUFBTSxVQUFVLENBQUM7QUFFN0MsbUJBQW1CLEtBQVksRUFBRSxPQUF5QjtJQUN4RCxJQUFJLEtBQUssQ0FBQyxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFO1FBQy9CLDBFQUEwRTtRQUMxRSxJQUFNLE1BQU0sR0FBRyxJQUFJLFVBQVUsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDMUMsSUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksRUFBRSxDQUFDO1FBQzNCLElBQUksSUFBSSxJQUFJLE9BQU8sRUFBRTtZQUNuQiw4Q0FBOEM7WUFDOUMsT0FBTyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDdEI7YUFBTTtZQUNMLDBCQUEwQjtZQUMxQixPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsTUFBTSxDQUFDO1lBQ3ZCLE9BQU8sTUFBTSxDQUFDO1NBQ2Y7S0FDRjtTQUFNO1FBQ0wscUdBQXFHO1FBQ3JHLE9BQU8sS0FBSyxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztLQUN6SDtBQUNILENBQUM7QUFHRDs7R0FFRztBQUNILE1BQU0sOEJBQThCLElBQWtCLEVBQUUsS0FBWSxFQUFFLGFBQTRCO0lBQ2hHLElBQUksYUFBYSxHQUFHLENBQUMsQ0FBQztJQUV0QixLQUFLLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxVQUFBLENBQUM7UUFDeEIsSUFBSSxXQUFXLENBQUMsQ0FBQyxDQUFDLEVBQUU7WUFDbEIsSUFBSSxHQUFHLElBQUksYUFBYSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztZQUNsQyxhQUFhLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsU0FBUyxFQUFFLEtBQUssQ0FBQyxDQUFDO1NBQzNDO2FBQU0sSUFBSSxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUU7WUFDdEIsSUFBSSxHQUFHLFNBQVMsQ0FBQywrQkFBK0IsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLGFBQWEsQ0FBQyxJQUFJLElBQUksQ0FBQztZQUVqRixJQUFJLEdBQUcsSUFBSSxVQUFVLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUM7U0FDOUM7YUFBTSxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRTtZQUNuQixJQUFJLEdBQUcsT0FBTyxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFFakQsYUFBYSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLFFBQVEsRUFBRSxLQUFLLENBQUMsQ0FBQztTQUMxQzthQUFNLElBQUksVUFBVSxDQUFDLENBQUMsQ0FBQyxFQUFFO1lBQ3hCLElBQUksR0FBRyxZQUFZLENBQUMsaUJBQWlCLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBRS9DLGFBQWEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxNQUFNLEVBQUUsS0FBSyxDQUFDLENBQUM7U0FDeEM7YUFBTSxJQUFJLFdBQVcsQ0FBQyxDQUFDLENBQUMsRUFBRTtZQUN6QixJQUFNLEdBQUcsR0FBRyxJQUFJLEdBQUcsYUFBYSxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztZQUU1RCxJQUFJLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxFQUFFO2dCQUM5QixJQUFJLEdBQUcsSUFBSSxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDakM7WUFFRCxLQUFvQixVQUEwQixFQUExQixLQUFBLElBQUksQ0FBQyxHQUFHLENBQUMsY0FBYyxFQUFFLENBQUMsRUFBMUIsY0FBMEIsRUFBMUIsSUFBMEIsRUFBRTtnQkFBM0MsSUFBTSxLQUFLLFNBQUE7Z0JBQ2QsYUFBYSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsU0FBUyxFQUFFLEtBQUssQ0FBQyxDQUFDO2FBQzVDO1NBQ0Y7YUFBTSxJQUFJLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBRTtZQUN0QixJQUFNLE1BQU0sR0FBRyxJQUFJLEdBQUcsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxhQUFhLEVBQUUsQ0FBQyxDQUFDO1lBRXZFLEtBQW9CLFVBQTZCLEVBQTdCLEtBQUEsSUFBSSxDQUFDLE1BQU0sQ0FBQyxjQUFjLEVBQUUsQ0FBQyxFQUE3QixjQUE2QixFQUE3QixJQUE2QixFQUFFO2dCQUE5QyxJQUFNLEtBQUssU0FBQTtnQkFDZCxhQUFhLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxTQUFTLEVBQUUsS0FBSyxDQUFDLENBQUM7YUFDNUM7U0FDRjthQUFNLElBQUksUUFBUSxDQUFDLENBQUMsQ0FBQyxFQUFFO1lBQ3RCLElBQU0sUUFBTSxHQUFHLElBQUksR0FBRyxJQUFJLG1CQUFtQixDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztZQUV2RCxLQUFvQixVQUE2QixFQUE3QixLQUFBLElBQUksQ0FBQyxRQUFNLENBQUMsY0FBYyxFQUFFLENBQUMsRUFBN0IsY0FBNkIsRUFBN0IsSUFBNkIsRUFBRTtnQkFBOUMsSUFBTSxLQUFLLFNBQUE7Z0JBQ2QsYUFBYSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsU0FBUyxFQUFFLEtBQUssQ0FBQyxDQUFDO2FBQzVDO1NBQ0Y7YUFBTSxJQUFJLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRTtZQUNyQixJQUFNLEtBQUssR0FBRyxJQUFJLEdBQUcsU0FBUyxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQztZQUUxRCxLQUFvQixVQUE0QixFQUE1QixLQUFBLElBQUksQ0FBQyxLQUFLLENBQUMsY0FBYyxFQUFFLENBQUMsRUFBNUIsY0FBNEIsRUFBNUIsSUFBNEIsRUFBRTtnQkFBN0MsSUFBTSxLQUFLLFNBQUE7Z0JBQ2QsYUFBYSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsU0FBUyxFQUFFLEtBQUssQ0FBQyxDQUFDO2FBQzVDO1NBQ0Y7YUFBTTtZQUNMLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2pELE9BQU87U0FDUjtJQUNILENBQUMsQ0FBQyxDQUFDO0lBRUgsT0FBTyxJQUFJLENBQUM7QUFDZCxDQUFDO0FBRUQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0VBcURFO0FBRUYsTUFBTSxvQkFBb0IsS0FBWTtJQUNwQyxJQUFJLElBQUksR0FBRyxTQUFTLENBQUMsS0FBSyxFQUFFLEtBQUssQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBRXBELElBQUEseUJBQXlELEVBQXhELDRCQUFXLEVBQUUsNENBQW1CLENBQXlCO0lBQ2hFLElBQU0sYUFBYSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksYUFBYSxFQUFFLENBQUM7SUFFN0csMkNBQTJDO0lBQzNDLElBQUksS0FBSyxDQUFDLElBQUksSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEtBQUssSUFBSSxFQUFFO1FBQ3ZFLGFBQWEsQ0FBQyxZQUFZLEdBQUcsSUFBSSxDQUFDO0tBQ25DO0lBRUQsSUFBSSxHQUFHLFNBQVMsQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxhQUFhLENBQUMsSUFBSSxJQUFJLENBQUM7SUFFbEUsaUVBQWlFO0lBQ2pFLGtFQUFrRTtJQUNsRSxzRUFBc0U7SUFDdEUsd0VBQXdFO0lBQ3hFLCtEQUErRDtJQUMvRCw0QkFBNEI7SUFDNUIsSUFBSSxtQkFBbUIsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsSUFBSSxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTtRQUM3RSxJQUFJLEdBQUcsSUFBSSxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7S0FDakM7SUFFRCxtRUFBbUU7SUFDbkUsK0dBQStHO0lBQy9HLElBQU0sYUFBYSxHQUFHLEtBQUssQ0FBQyxNQUFNLElBQUksWUFBWSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNqRSxJQUFJLFdBQVcsQ0FBQyxLQUFLLENBQUMsSUFBSSxZQUFZLENBQUMsS0FBSyxDQUFDLEVBQUU7UUFDN0MsSUFBSSxhQUFhLEVBQUU7WUFDakIsSUFBSSxHQUFHLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLElBQUksSUFBSSxDQUFDO1NBQ3REO0tBQ0Y7SUFFRCxJQUFJLEtBQUssQ0FBQyxVQUFVLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtRQUMvQixJQUFJLEdBQUcsbUJBQW1CLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxhQUFhLENBQUMsQ0FBQztLQUN4RDtJQUVELElBQUksR0FBRyxTQUFTLENBQUMsd0JBQXdCLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxhQUFhLENBQUMsSUFBSSxJQUFJLENBQUM7SUFFOUUsSUFBSSxXQUFXLENBQUMsS0FBSyxDQUFDLEVBQUU7UUFDdEIsSUFBSSxHQUFHLFdBQVcsQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ3pDLElBQUksR0FBRyxZQUFZLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztLQUMzQztJQUVELElBQUksV0FBVyxDQUFDLEtBQUssQ0FBQyxJQUFJLFlBQVksQ0FBQyxLQUFLLENBQUMsRUFBRTtRQUU3QyxJQUFJLENBQUMsYUFBYSxFQUFFO1lBQ2xCLElBQUksR0FBRyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxJQUFJLElBQUksQ0FBQztTQUN0RDtRQUVELElBQUksR0FBRyxZQUFZLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxJQUFJLElBQUksQ0FBQztRQUMxRCxJQUFJLEdBQUcsYUFBYSxDQUFDLG9CQUFvQixDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztLQUN4RDtJQUVELHFDQUFxQztJQUNyQyxJQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ25DLElBQU0sR0FBRyxHQUFHLElBQUksVUFBVSxDQUFDLElBQUksRUFBRSxPQUFPLEVBQUUsR0FBRyxFQUFFLG1CQUFtQixDQUFDLENBQUM7SUFDcEUsV0FBVyxDQUFDLE9BQU8sQ0FBQyxHQUFHLEdBQUcsQ0FBQztJQUMzQixJQUFJLEdBQUcsR0FBRyxDQUFDO0lBRVgsSUFBSSxXQUFXLENBQUMsS0FBSyxDQUFDLEVBQUU7UUFDdEIsSUFBTSxHQUFHLEdBQUcsYUFBYSxDQUFDLGdCQUFnQixDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztRQUN4RCxJQUFJLEdBQUcsRUFBRTtZQUNQLElBQUksR0FBRyxHQUFHLENBQUM7WUFFWCxJQUFJLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxFQUFFO2dCQUM5QixJQUFJLEdBQUcsSUFBSSxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDakM7U0FDRjtRQUVELElBQUksR0FBRyxTQUFTLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxJQUFJLElBQUksQ0FBQztLQUN4RDtJQUVELElBQUksV0FBVyxDQUFDLEtBQUssQ0FBQyxFQUFFO1FBQ3RCLElBQUksR0FBRyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxJQUFJLElBQUksQ0FBQztLQUNwRDtJQUVELHdCQUF3QjtJQUN4QixJQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3JDLElBQU0sSUFBSSxHQUFHLElBQUksVUFBVSxDQUFDLElBQUksRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLG1CQUFtQixDQUFDLENBQUM7SUFDdkUsV0FBVyxDQUFDLFFBQVEsQ0FBQyxHQUFHLElBQUksQ0FBQztJQUM3QixJQUFJLEdBQUcsSUFBSSxDQUFDO0lBRVosbUJBQW1CO0lBQ25CLElBQUksU0FBUyxHQUFHLElBQUksQ0FBQztJQUNyQixJQUFJLFlBQVksQ0FBQyxLQUFLLENBQUMsRUFBRTtRQUN2QixJQUFNLFNBQVMsR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3pDLFNBQVMsR0FBRyxJQUFJLFNBQVMsQ0FBQyxJQUFJLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUMsQ0FBQztRQUNwRSxXQUFXLENBQUMsU0FBUyxDQUFDLEdBQUcsU0FBUyxDQUFDO1FBQ25DLElBQUksR0FBRyxTQUFTLENBQUM7S0FDbEI7SUFFRCw0QkFDSyxLQUFLLENBQUMsU0FBUyxDQUFDLElBQUksSUFDdkIsV0FBVyxhQUFBO1FBQ1gsbUJBQW1CLHFCQUFBO1FBQ25CLEdBQUcsS0FBQTtRQUNILElBQUksTUFBQTtRQUNKLFNBQVMsV0FBQTtRQUNULGFBQWEsZUFBQSxJQUNiO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7TUFJTiwgUkFXfSBmcm9tICcuLi8uLi9kYXRhJztcbmltcG9ydCAqIGFzIGxvZyBmcm9tICcuLi8uLi9sb2cnO1xuaW1wb3J0IHtpc0FnZ3JlZ2F0ZSwgaXNCaW4sIGlzQ2FsY3VsYXRlLCBpc0ZpbHRlciwgaXNMb29rdXAsIGlzU3RhY2ssIGlzVGltZVVuaXQsIGlzV2luZG93fSBmcm9tICcuLi8uLi90cmFuc2Zvcm0nO1xuaW1wb3J0IHtEaWN0LCBrZXlzfSBmcm9tICcuLi8uLi91dGlsJztcbmltcG9ydCB7aXNGYWNldE1vZGVsLCBpc0xheWVyTW9kZWwsIGlzVW5pdE1vZGVsLCBNb2RlbH0gZnJvbSAnLi4vbW9kZWwnO1xuaW1wb3J0IHtyZXF1aXJlc1NlbGVjdGlvbklkfSBmcm9tICcuLi9zZWxlY3Rpb24vc2VsZWN0aW9uJztcbmltcG9ydCB7QWdncmVnYXRlTm9kZX0gZnJvbSAnLi9hZ2dyZWdhdGUnO1xuaW1wb3J0IHtCaW5Ob2RlfSBmcm9tICcuL2Jpbic7XG5pbXBvcnQge0NhbGN1bGF0ZU5vZGV9IGZyb20gJy4vY2FsY3VsYXRlJztcbmltcG9ydCB7RGF0YUZsb3dOb2RlLCBPdXRwdXROb2RlfSBmcm9tICcuL2RhdGFmbG93JztcbmltcG9ydCB7RmFjZXROb2RlfSBmcm9tICcuL2ZhY2V0JztcbmltcG9ydCB7RmlsdGVyTm9kZX0gZnJvbSAnLi9maWx0ZXInO1xuaW1wb3J0IHtGaWx0ZXJJbnZhbGlkTm9kZX0gZnJvbSAnLi9maWx0ZXJpbnZhbGlkJztcbmltcG9ydCB7UGFyc2VOb2RlfSBmcm9tICcuL2Zvcm1hdHBhcnNlJztcbmltcG9ydCB7R2VvSlNPTk5vZGV9IGZyb20gJy4vZ2VvanNvbic7XG5pbXBvcnQge0dlb1BvaW50Tm9kZX0gZnJvbSAnLi9nZW9wb2ludCc7XG5pbXBvcnQge0lkZW50aWZpZXJOb2RlfSBmcm9tICcuL2luZGVudGlmaWVyJztcbmltcG9ydCB7QW5jZXN0b3JQYXJzZSwgRGF0YUNvbXBvbmVudH0gZnJvbSAnLi9pbmRleCc7XG5pbXBvcnQge0xvb2t1cE5vZGV9IGZyb20gJy4vbG9va3VwJztcbmltcG9ydCB7U291cmNlTm9kZX0gZnJvbSAnLi9zb3VyY2UnO1xuaW1wb3J0IHtTdGFja05vZGV9IGZyb20gJy4vc3RhY2snO1xuaW1wb3J0IHtUaW1lVW5pdE5vZGV9IGZyb20gJy4vdGltZXVuaXQnO1xuaW1wb3J0IHtXaW5kb3dUcmFuc2Zvcm1Ob2RlfSBmcm9tICcuL3dpbmRvdyc7XG5cbmZ1bmN0aW9uIHBhcnNlUm9vdChtb2RlbDogTW9kZWwsIHNvdXJjZXM6IERpY3Q8U291cmNlTm9kZT4pOiBEYXRhRmxvd05vZGUge1xuICBpZiAobW9kZWwuZGF0YSB8fCAhbW9kZWwucGFyZW50KSB7XG4gICAgLy8gaWYgdGhlIG1vZGVsIGRlZmluZXMgYSBkYXRhIHNvdXJjZSBvciBpcyB0aGUgcm9vdCwgY3JlYXRlIGEgc291cmNlIG5vZGVcbiAgICBjb25zdCBzb3VyY2UgPSBuZXcgU291cmNlTm9kZShtb2RlbC5kYXRhKTtcbiAgICBjb25zdCBoYXNoID0gc291cmNlLmhhc2goKTtcbiAgICBpZiAoaGFzaCBpbiBzb3VyY2VzKSB7XG4gICAgICAvLyB1c2UgYSByZWZlcmVuY2UgaWYgd2UgYWxyZWFkeSBoYXZlIGEgc291cmNlXG4gICAgICByZXR1cm4gc291cmNlc1toYXNoXTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gb3RoZXJ3aXNlIGFkZCBhIG5ldyBvbmVcbiAgICAgIHNvdXJjZXNbaGFzaF0gPSBzb3VyY2U7XG4gICAgICByZXR1cm4gc291cmNlO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICAvLyBJZiB3ZSBkb24ndCBoYXZlIGEgc291cmNlIGRlZmluZWQgKG92ZXJyaWRpbmcgcGFyZW50J3MgZGF0YSksIHVzZSB0aGUgcGFyZW50J3MgZmFjZXQgcm9vdCBvciBtYWluLlxuICAgIHJldHVybiBtb2RlbC5wYXJlbnQuY29tcG9uZW50LmRhdGEuZmFjZXRSb290ID8gbW9kZWwucGFyZW50LmNvbXBvbmVudC5kYXRhLmZhY2V0Um9vdCA6IG1vZGVsLnBhcmVudC5jb21wb25lbnQuZGF0YS5tYWluO1xuICB9XG59XG5cblxuLyoqXG4gKiBQYXJzZXMgYSB0cmFuc2Zvcm1zIGFycmF5IGludG8gYSBjaGFpbiBvZiBjb25uZWN0ZWQgZGF0YWZsb3cgbm9kZXMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVRyYW5zZm9ybUFycmF5KGhlYWQ6IERhdGFGbG93Tm9kZSwgbW9kZWw6IE1vZGVsLCBhbmNlc3RvclBhcnNlOiBBbmNlc3RvclBhcnNlKTogRGF0YUZsb3dOb2RlIHtcbiAgbGV0IGxvb2t1cENvdW50ZXIgPSAwO1xuXG4gIG1vZGVsLnRyYW5zZm9ybXMuZm9yRWFjaCh0ID0+IHtcbiAgICBpZiAoaXNDYWxjdWxhdGUodCkpIHtcbiAgICAgIGhlYWQgPSBuZXcgQ2FsY3VsYXRlTm9kZShoZWFkLCB0KTtcbiAgICAgIGFuY2VzdG9yUGFyc2Uuc2V0KHQuYXMsICdkZXJpdmVkJywgZmFsc2UpO1xuICAgIH0gZWxzZSBpZiAoaXNGaWx0ZXIodCkpIHtcbiAgICAgIGhlYWQgPSBQYXJzZU5vZGUubWFrZUltcGxpY2l0RnJvbUZpbHRlclRyYW5zZm9ybShoZWFkLCB0LCBhbmNlc3RvclBhcnNlKSB8fCBoZWFkO1xuXG4gICAgICBoZWFkID0gbmV3IEZpbHRlck5vZGUoaGVhZCwgbW9kZWwsIHQuZmlsdGVyKTtcbiAgICB9IGVsc2UgaWYgKGlzQmluKHQpKSB7XG4gICAgICBoZWFkID0gQmluTm9kZS5tYWtlRnJvbVRyYW5zZm9ybShoZWFkLCB0LCBtb2RlbCk7XG5cbiAgICAgIGFuY2VzdG9yUGFyc2Uuc2V0KHQuYXMsICdudW1iZXInLCBmYWxzZSk7XG4gICAgfSBlbHNlIGlmIChpc1RpbWVVbml0KHQpKSB7XG4gICAgICBoZWFkID0gVGltZVVuaXROb2RlLm1ha2VGcm9tVHJhbnNmb3JtKGhlYWQsIHQpO1xuXG4gICAgICBhbmNlc3RvclBhcnNlLnNldCh0LmFzLCAnZGF0ZScsIGZhbHNlKTtcbiAgICB9IGVsc2UgaWYgKGlzQWdncmVnYXRlKHQpKSB7XG4gICAgICBjb25zdCBhZ2cgPSBoZWFkID0gQWdncmVnYXRlTm9kZS5tYWtlRnJvbVRyYW5zZm9ybShoZWFkLCB0KTtcblxuICAgICAgaWYgKHJlcXVpcmVzU2VsZWN0aW9uSWQobW9kZWwpKSB7XG4gICAgICAgIGhlYWQgPSBuZXcgSWRlbnRpZmllck5vZGUoaGVhZCk7XG4gICAgICB9XG5cbiAgICAgIGZvciAoY29uc3QgZmllbGQgb2Yga2V5cyhhZ2cucHJvZHVjZWRGaWVsZHMoKSkpIHtcbiAgICAgICAgYW5jZXN0b3JQYXJzZS5zZXQoZmllbGQsICdkZXJpdmVkJywgZmFsc2UpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoaXNMb29rdXAodCkpIHtcbiAgICAgIGNvbnN0IGxvb2t1cCA9IGhlYWQgPSBMb29rdXBOb2RlLm1ha2UoaGVhZCwgbW9kZWwsIHQsIGxvb2t1cENvdW50ZXIrKyk7XG5cbiAgICAgIGZvciAoY29uc3QgZmllbGQgb2Yga2V5cyhsb29rdXAucHJvZHVjZWRGaWVsZHMoKSkpIHtcbiAgICAgICAgYW5jZXN0b3JQYXJzZS5zZXQoZmllbGQsICdkZXJpdmVkJywgZmFsc2UpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoaXNXaW5kb3codCkpIHtcbiAgICAgIGNvbnN0IHdpbmRvdyA9IGhlYWQgPSBuZXcgV2luZG93VHJhbnNmb3JtTm9kZShoZWFkLCB0KTtcblxuICAgICAgZm9yIChjb25zdCBmaWVsZCBvZiBrZXlzKHdpbmRvdy5wcm9kdWNlZEZpZWxkcygpKSkge1xuICAgICAgICBhbmNlc3RvclBhcnNlLnNldChmaWVsZCwgJ2Rlcml2ZWQnLCBmYWxzZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChpc1N0YWNrKHQpKSB7XG4gICAgICBjb25zdCBzdGFjayA9IGhlYWQgPSBTdGFja05vZGUubWFrZUZyb21UcmFuc2Zvcm0oaGVhZCwgdCk7XG5cbiAgICAgIGZvciAoY29uc3QgZmllbGQgb2Yga2V5cyhzdGFjay5wcm9kdWNlZEZpZWxkcygpKSkge1xuICAgICAgICBhbmNlc3RvclBhcnNlLnNldChmaWVsZCwgJ2Rlcml2ZWQnLCBmYWxzZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLmludmFsaWRUcmFuc2Zvcm1JZ25vcmVkKHQpKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBoZWFkO1xufVxuXG4vKlxuRGVzY3JpcHRpb24gb2YgdGhlIGRhdGFmbG93IChodHRwOi8vYXNjaWlmbG93LmNvbS8pOlxuICAgICArLS0tLS0tLS0rXG4gICAgIHwgU291cmNlIHxcbiAgICAgKy0tLSstLS0tK1xuICAgICAgICAgfFxuICAgICAgICAgdlxuICAgICBGb3JtYXRQYXJzZVxuICAgICAoZXhwbGljaXQpXG4gICAgICAgICB8XG4gICAgICAgICB2XG4gICAgIFRyYW5zZm9ybXNcbihGaWx0ZXIsIENhbGN1bGF0ZSwgQmlubmluZywgVGltZVVuaXQsIEFnZ3JlZ2F0ZSwgV2luZG93LCAuLi4pXG4gICAgICAgICB8XG4gICAgICAgICB2XG4gICAgIEZvcm1hdFBhcnNlXG4gICAgIChpbXBsaWNpdClcbiAgICAgICAgIHxcbiAgICAgICAgIHZcbiBCaW5uaW5nIChpbiBgZW5jb2RpbmdgKVxuICAgICAgICAgfFxuICAgICAgICAgdlxuIFRpbWV1bml0IChpbiBgZW5jb2RpbmdgKVxuICAgICAgICAgfFxuICAgICAgICAgdlxuRm9ybXVsYSBGcm9tIFNvcnQgQXJyYXlcbiAgICAgICAgIHxcbiAgICAgICAgIHZcbiAgICAgICstLSstLStcbiAgICAgIHwgUmF3IHxcbiAgICAgICstLS0tLStcbiAgICAgICAgIHxcbiAgICAgICAgIHZcbiAgQWdncmVnYXRlIChpbiBgZW5jb2RpbmdgKVxuICAgICAgICAgfFxuICAgICAgICAgdlxuICBTdGFjayAoaW4gYGVuY29kaW5nYClcbiAgICAgICAgIHxcbiAgICAgICAgIHZcbiAgSW52YWxpZCBGaWx0ZXJcbiAgICAgICAgIHxcbiAgICAgICAgIHZcbiAgICstLS0tLS0tLS0tK1xuICAgfCAgIE1haW4gICB8XG4gICArLS0tLS0tLS0tLStcbiAgICAgICAgIHxcbiAgICAgICAgIHZcbiAgICAgKy0tLS0tLS0rXG4gICAgIHwgRmFjZXQgfC0tLS0+IFwiY29sdW1uXCIsIFwiY29sdW1uLWxheW91dFwiLCBhbmQgXCJyb3dcIlxuICAgICArLS0tLS0tLStcbiAgICAgICAgIHxcbiAgICAgICAgIHZcbiAgLi4uQ2hpbGQgZGF0YS4uLlxuKi9cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlRGF0YShtb2RlbDogTW9kZWwpOiBEYXRhQ29tcG9uZW50IHtcbiAgbGV0IGhlYWQgPSBwYXJzZVJvb3QobW9kZWwsIG1vZGVsLmNvbXBvbmVudC5kYXRhLnNvdXJjZXMpO1xuXG4gIGNvbnN0IHtvdXRwdXROb2Rlcywgb3V0cHV0Tm9kZVJlZkNvdW50c30gPSBtb2RlbC5jb21wb25lbnQuZGF0YTtcbiAgY29uc3QgYW5jZXN0b3JQYXJzZSA9IG1vZGVsLnBhcmVudCA/IG1vZGVsLnBhcmVudC5jb21wb25lbnQuZGF0YS5hbmNlc3RvclBhcnNlLmNsb25lKCkgOiBuZXcgQW5jZXN0b3JQYXJzZSgpO1xuXG4gIC8vIGZvcm1hdC5wYXJzZTogbnVsbCBtZWFucyBkaXNhYmxlIHBhcnNpbmdcbiAgaWYgKG1vZGVsLmRhdGEgJiYgbW9kZWwuZGF0YS5mb3JtYXQgJiYgbW9kZWwuZGF0YS5mb3JtYXQucGFyc2UgPT09IG51bGwpIHtcbiAgICBhbmNlc3RvclBhcnNlLnBhcnNlTm90aGluZyA9IHRydWU7XG4gIH1cblxuICBoZWFkID0gUGFyc2VOb2RlLm1ha2VFeHBsaWNpdChoZWFkLCBtb2RlbCwgYW5jZXN0b3JQYXJzZSkgfHwgaGVhZDtcblxuICAvLyBEZWZhdWx0IGRpc2NyZXRlIHNlbGVjdGlvbnMgcmVxdWlyZSBhbiBpZGVudGlmaWVyIHRyYW5zZm9ybSB0b1xuICAvLyB1bmlxdWVseSBpZGVudGlmeSBkYXRhIHBvaW50cyBhcyB0aGUgX2lkIGZpZWxkIGlzIHZvbGF0aWxlLiBBZGRcbiAgLy8gdGhpcyB0cmFuc2Zvcm0gYXQgdGhlIGhlYWQgb2Ygb3VyIHBpcGVsaW5lIHN1Y2ggdGhhdCB0aGUgaWRlbnRpZmllclxuICAvLyBmaWVsZCBpcyBhdmFpbGFibGUgZm9yIGFsbCBzdWJzZXF1ZW50IGRhdGFzZXRzLiBBZGRpdGlvbmFsIGlkZW50aWZpZXJcbiAgLy8gdHJhbnNmb3JtcyB3aWxsIGJlIG5lY2Vzc2FyeSB3aGVuIG5ldyB0dXBsZXMgYXJlIGNvbnN0cnVjdGVkXG4gIC8vIChlLmcuLCBwb3N0LWFnZ3JlZ2F0aW9uKS5cbiAgaWYgKHJlcXVpcmVzU2VsZWN0aW9uSWQobW9kZWwpICYmIChpc1VuaXRNb2RlbChtb2RlbCkgfHwgaXNMYXllck1vZGVsKG1vZGVsKSkpIHtcbiAgICBoZWFkID0gbmV3IElkZW50aWZpZXJOb2RlKGhlYWQpO1xuICB9XG5cbiAgLy8gSEFDSzogVGhpcyBpcyBlcXVpdmFsZW50IGZvciBtZXJnaW5nIGJpbiBleHRlbnQgZm9yIHVuaW9uIHNjYWxlLlxuICAvLyBGSVhNRShodHRwczovL2dpdGh1Yi5jb20vdmVnYS92ZWdhLWxpdGUvaXNzdWVzLzIyNzApOiBDb3JyZWN0bHkgbWVyZ2UgZXh0ZW50IC8gYmluIG5vZGUgZm9yIHNoYXJlZCBiaW4gc2NhbGVcbiAgY29uc3QgcGFyZW50SXNMYXllciA9IG1vZGVsLnBhcmVudCAmJiBpc0xheWVyTW9kZWwobW9kZWwucGFyZW50KTtcbiAgaWYgKGlzVW5pdE1vZGVsKG1vZGVsKSB8fCBpc0ZhY2V0TW9kZWwobW9kZWwpKSB7XG4gICAgaWYgKHBhcmVudElzTGF5ZXIpIHtcbiAgICAgIGhlYWQgPSBCaW5Ob2RlLm1ha2VGcm9tRW5jb2RpbmcoaGVhZCwgbW9kZWwpIHx8IGhlYWQ7XG4gICAgfVxuICB9XG5cbiAgaWYgKG1vZGVsLnRyYW5zZm9ybXMubGVuZ3RoID4gMCkge1xuICAgIGhlYWQgPSBwYXJzZVRyYW5zZm9ybUFycmF5KGhlYWQsIG1vZGVsLCBhbmNlc3RvclBhcnNlKTtcbiAgfVxuXG4gIGhlYWQgPSBQYXJzZU5vZGUubWFrZUltcGxpY2l0RnJvbUVuY29kaW5nKGhlYWQsIG1vZGVsLCBhbmNlc3RvclBhcnNlKSB8fCBoZWFkO1xuXG4gIGlmIChpc1VuaXRNb2RlbChtb2RlbCkpIHtcbiAgICBoZWFkID0gR2VvSlNPTk5vZGUucGFyc2VBbGwoaGVhZCwgbW9kZWwpO1xuICAgIGhlYWQgPSBHZW9Qb2ludE5vZGUucGFyc2VBbGwoaGVhZCwgbW9kZWwpO1xuICB9XG5cbiAgaWYgKGlzVW5pdE1vZGVsKG1vZGVsKSB8fCBpc0ZhY2V0TW9kZWwobW9kZWwpKSB7XG5cbiAgICBpZiAoIXBhcmVudElzTGF5ZXIpIHtcbiAgICAgIGhlYWQgPSBCaW5Ob2RlLm1ha2VGcm9tRW5jb2RpbmcoaGVhZCwgbW9kZWwpIHx8IGhlYWQ7XG4gICAgfVxuXG4gICAgaGVhZCA9IFRpbWVVbml0Tm9kZS5tYWtlRnJvbUVuY29kaW5nKGhlYWQsIG1vZGVsKSB8fCBoZWFkO1xuICAgIGhlYWQgPSBDYWxjdWxhdGVOb2RlLnBhcnNlQWxsRm9yU29ydEluZGV4KGhlYWQsIG1vZGVsKTtcbiAgfVxuXG4gIC8vIGFkZCBhbiBvdXRwdXQgbm9kZSBwcmUgYWdncmVnYXRpb25cbiAgY29uc3QgcmF3TmFtZSA9IG1vZGVsLmdldE5hbWUoUkFXKTtcbiAgY29uc3QgcmF3ID0gbmV3IE91dHB1dE5vZGUoaGVhZCwgcmF3TmFtZSwgUkFXLCBvdXRwdXROb2RlUmVmQ291bnRzKTtcbiAgb3V0cHV0Tm9kZXNbcmF3TmFtZV0gPSByYXc7XG4gIGhlYWQgPSByYXc7XG5cbiAgaWYgKGlzVW5pdE1vZGVsKG1vZGVsKSkge1xuICAgIGNvbnN0IGFnZyA9IEFnZ3JlZ2F0ZU5vZGUubWFrZUZyb21FbmNvZGluZyhoZWFkLCBtb2RlbCk7XG4gICAgaWYgKGFnZykge1xuICAgICAgaGVhZCA9IGFnZztcblxuICAgICAgaWYgKHJlcXVpcmVzU2VsZWN0aW9uSWQobW9kZWwpKSB7XG4gICAgICAgIGhlYWQgPSBuZXcgSWRlbnRpZmllck5vZGUoaGVhZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaGVhZCA9IFN0YWNrTm9kZS5tYWtlRnJvbUVuY29kaW5nKGhlYWQsIG1vZGVsKSB8fCBoZWFkO1xuICB9XG5cbiAgaWYgKGlzVW5pdE1vZGVsKG1vZGVsKSkge1xuICAgIGhlYWQgPSBGaWx0ZXJJbnZhbGlkTm9kZS5tYWtlKGhlYWQsIG1vZGVsKSB8fCBoZWFkO1xuICB9XG5cbiAgLy8gb3V0cHV0IG5vZGUgZm9yIG1hcmtzXG4gIGNvbnN0IG1haW5OYW1lID0gbW9kZWwuZ2V0TmFtZShNQUlOKTtcbiAgY29uc3QgbWFpbiA9IG5ldyBPdXRwdXROb2RlKGhlYWQsIG1haW5OYW1lLCBNQUlOLCBvdXRwdXROb2RlUmVmQ291bnRzKTtcbiAgb3V0cHV0Tm9kZXNbbWFpbk5hbWVdID0gbWFpbjtcbiAgaGVhZCA9IG1haW47XG5cbiAgLy8gYWRkIGZhY2V0IG1hcmtlclxuICBsZXQgZmFjZXRSb290ID0gbnVsbDtcbiAgaWYgKGlzRmFjZXRNb2RlbChtb2RlbCkpIHtcbiAgICBjb25zdCBmYWNldE5hbWUgPSBtb2RlbC5nZXROYW1lKCdmYWNldCcpO1xuICAgIGZhY2V0Um9vdCA9IG5ldyBGYWNldE5vZGUoaGVhZCwgbW9kZWwsIGZhY2V0TmFtZSwgbWFpbi5nZXRTb3VyY2UoKSk7XG4gICAgb3V0cHV0Tm9kZXNbZmFjZXROYW1lXSA9IGZhY2V0Um9vdDtcbiAgICBoZWFkID0gZmFjZXRSb290O1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICAuLi5tb2RlbC5jb21wb25lbnQuZGF0YSxcbiAgICBvdXRwdXROb2RlcyxcbiAgICBvdXRwdXROb2RlUmVmQ291bnRzLFxuICAgIHJhdyxcbiAgICBtYWluLFxuICAgIGZhY2V0Um9vdCxcbiAgICBhbmNlc3RvclBhcnNlXG4gIH07XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { keys } from '../util';\nimport { parseData } from './data/parse';\nimport { assembleLayoutSignals } from './layoutsize/assemble';\nimport { Model } from './model';\nvar BaseConcatModel = /** @class */ (function (_super) {\n    tslib_1.__extends(BaseConcatModel, _super);\n    function BaseConcatModel(spec, parent, parentGivenName, config, repeater, resolve) {\n        return _super.call(this, spec, parent, parentGivenName, config, repeater, resolve) || this;\n    }\n    BaseConcatModel.prototype.parseData = function () {\n        this.component.data = parseData(this);\n        this.children.forEach(function (child) {\n            child.parseData();\n        });\n    };\n    BaseConcatModel.prototype.parseSelection = function () {\n        var _this = this;\n        // Merge selections up the hierarchy so that they may be referenced\n        // across unit specs. Persist their definitions within each child\n        // to assemble signals which remain within output Vega unit groups.\n        this.component.selection = {};\n        var _loop_1 = function (child) {\n            child.parseSelection();\n            keys(child.component.selection).forEach(function (key) {\n                _this.component.selection[key] = child.component.selection[key];\n            });\n        };\n        for (var _i = 0, _a = this.children; _i < _a.length; _i++) {\n            var child = _a[_i];\n            _loop_1(child);\n        }\n    };\n    BaseConcatModel.prototype.parseMarkGroup = function () {\n        for (var _i = 0, _a = this.children; _i < _a.length; _i++) {\n            var child = _a[_i];\n            child.parseMarkGroup();\n        }\n    };\n    BaseConcatModel.prototype.parseAxisAndHeader = function () {\n        for (var _i = 0, _a = this.children; _i < _a.length; _i++) {\n            var child = _a[_i];\n            child.parseAxisAndHeader();\n        }\n        // TODO(#2415): support shared axes\n    };\n    BaseConcatModel.prototype.assembleSelectionTopLevelSignals = function (signals) {\n        return this.children.reduce(function (sg, child) { return child.assembleSelectionTopLevelSignals(sg); }, signals);\n    };\n    BaseConcatModel.prototype.assembleSelectionSignals = function () {\n        this.children.forEach(function (child) { return child.assembleSelectionSignals(); });\n        return [];\n    };\n    BaseConcatModel.prototype.assembleLayoutSignals = function () {\n        return this.children.reduce(function (signals, child) {\n            return signals.concat(child.assembleLayoutSignals());\n        }, assembleLayoutSignals(this));\n    };\n    BaseConcatModel.prototype.assembleSelectionData = function (data) {\n        return this.children.reduce(function (db, child) { return child.assembleSelectionData(db); }, data);\n    };\n    BaseConcatModel.prototype.assembleMarks = function () {\n        // only children have marks\n        return this.children.map(function (child) {\n            var title = child.assembleTitle();\n            var style = child.assembleGroupStyle();\n            var layoutSizeEncodeEntry = child.assembleLayoutSize();\n            return tslib_1.__assign({ type: 'group', name: child.getName('group') }, (title ? { title: title } : {}), (style ? { style: style } : {}), (layoutSizeEncodeEntry ? {\n                encode: {\n                    update: layoutSizeEncodeEntry\n                }\n            } : {}), child.assembleGroup());\n        });\n    };\n    return BaseConcatModel;\n}(Model));\nexport { BaseConcatModel };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZWNvbmNhdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21waWxlL2Jhc2Vjb25jYXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUdBLE9BQU8sRUFBQyxJQUFJLEVBQUMsTUFBTSxTQUFTLENBQUM7QUFFN0IsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLGNBQWMsQ0FBQztBQUN2QyxPQUFPLEVBQUMscUJBQXFCLEVBQUMsTUFBTSx1QkFBdUIsQ0FBQztBQUM1RCxPQUFPLEVBQUMsS0FBSyxFQUFDLE1BQU0sU0FBUyxDQUFDO0FBRzlCO0lBQThDLDJDQUFLO0lBQ2pELHlCQUFZLElBQWMsRUFBRSxNQUFhLEVBQUUsZUFBdUIsRUFBRSxNQUFjLEVBQUUsUUFBdUIsRUFBRSxPQUFnQjtlQUMzSCxrQkFBTSxJQUFJLEVBQUUsTUFBTSxFQUFFLGVBQWUsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLE9BQU8sQ0FBQztJQUNqRSxDQUFDO0lBRU0sbUNBQVMsR0FBaEI7UUFDRSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsVUFBQyxLQUFLO1lBQzFCLEtBQUssQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNwQixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFDTSx3Q0FBYyxHQUFyQjtRQUFBLGlCQVdDO1FBVkMsbUVBQW1FO1FBQ25FLGlFQUFpRTtRQUNqRSxtRUFBbUU7UUFDbkUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDO2dDQUNuQixLQUFLO1lBQ2QsS0FBSyxDQUFDLGNBQWMsRUFBRSxDQUFDO1lBQ3ZCLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFDLEdBQUc7Z0JBQzFDLEtBQUksQ0FBQyxTQUFTLENBQUMs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LEVBQUUsRUFDeEI7UUFDSixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFDSCxzQkFBQztBQUFELENBQUMsQUE3RUQsQ0FBOEMsS0FBSyxHQTZFbEQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NvbmZpZ30gZnJvbSAnLi4vY29uZmlnJztcbmltcG9ydCB7UmVzb2x2ZX0gZnJvbSAnLi4vcmVzb2x2ZSc7XG5pbXBvcnQge0Jhc2VTcGVjfSBmcm9tICcuLi9zcGVjJztcbmltcG9ydCB7a2V5c30gZnJvbSAnLi4vdXRpbCc7XG5pbXBvcnQge1ZnRGF0YSwgVmdTaWduYWx9IGZyb20gJy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7cGFyc2VEYXRhfSBmcm9tICcuL2RhdGEvcGFyc2UnO1xuaW1wb3J0IHthc3NlbWJsZUxheW91dFNpZ25hbHN9IGZyb20gJy4vbGF5b3V0c2l6ZS9hc3NlbWJsZSc7XG5pbXBvcnQge01vZGVsfSBmcm9tICcuL21vZGVsJztcbmltcG9ydCB7UmVwZWF0ZXJWYWx1ZX0gZnJvbSAnLi9yZXBlYXRlcic7XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBCYXNlQ29uY2F0TW9kZWwgZXh0ZW5kcyBNb2RlbCB7XG4gIGNvbnN0cnVjdG9yKHNwZWM6IEJhc2VTcGVjLCBwYXJlbnQ6IE1vZGVsLCBwYXJlbnRHaXZlbk5hbWU6IHN0cmluZywgY29uZmlnOiBDb25maWcsIHJlcGVhdGVyOiBSZXBlYXRlclZhbHVlLCByZXNvbHZlOiBSZXNvbHZlKSB7XG4gICAgc3VwZXIoc3BlYywgcGFyZW50LCBwYXJlbnRHaXZlbk5hbWUsIGNvbmZpZywgcmVwZWF0ZXIsIHJlc29sdmUpO1xuICB9XG5cbiAgcHVibGljIHBhcnNlRGF0YSgpIHtcbiAgICB0aGlzLmNvbXBvbmVudC5kYXRhID0gcGFyc2VEYXRhKHRoaXMpO1xuICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHtcbiAgICAgIGNoaWxkLnBhcnNlRGF0YSgpO1xuICAgIH0pO1xuICB9XG4gIHB1YmxpYyBwYXJzZVNlbGVjdGlvbigpIHtcbiAgICAvLyBNZXJnZSBzZWxlY3Rpb25zIHVwIHRoZSBoaWVyYXJjaHkgc28gdGhhdCB0aGV5IG1heSBiZSByZWZlcmVuY2VkXG4gICAgLy8gYWNyb3NzIHVuaXQgc3BlY3MuIFBlcnNpc3QgdGhlaXIgZGVmaW5pdGlvbnMgd2l0aGluIGVhY2ggY2hpbGRcbiAgICAvLyB0byBhc3NlbWJsZSBzaWduYWxzIHdoaWNoIHJlbWFpbiB3aXRoaW4gb3V0cHV0IFZlZ2EgdW5pdCBncm91cHMuXG4gICAgdGhpcy5jb21wb25lbnQuc2VsZWN0aW9uID0ge307XG4gICAgZm9yIChjb25zdCBjaGlsZCBvZiB0aGlzLmNoaWxkcmVuKSB7XG4gICAgICBjaGlsZC5wYXJzZVNlbGVjdGlvbigpO1xuICAgICAga2V5cyhjaGlsZC5jb21wb25lbnQuc2VsZWN0aW9uKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgdGhpcy5jb21wb25lbnQuc2VsZWN0aW9uW2tleV0gPSBjaGlsZC5jb21wb25lbnQuc2VsZWN0aW9uW2tleV07XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgcGFyc2VNYXJrR3JvdXAoKSB7XG4gICAgZm9yIChjb25zdCBjaGlsZCBvZiB0aGlzLmNoaWxkcmVuKSB7XG4gICAgICBjaGlsZC5wYXJzZU1hcmtHcm91cCgpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBwYXJzZUF4aXNBbmRIZWFkZXIoKSB7XG4gICAgZm9yIChjb25zdCBjaGlsZCBvZiB0aGlzLmNoaWxkcmVuKSB7XG4gICAgICBjaGlsZC5wYXJzZUF4aXNBbmRIZWFkZXIoKTtcbiAgICB9XG5cbiAgICAvLyBUT0RPKCMyNDE1KTogc3VwcG9ydCBzaGFyZWQgYXhlc1xuICB9XG5cbiAgcHVibGljIGFzc2VtYmxlU2VsZWN0aW9uVG9wTGV2ZWxTaWduYWxzKHNpZ25hbHM6IGFueVtdKTogVmdTaWduYWxbXSB7XG4gICAgcmV0dXJuIHRoaXMuY2hpbGRyZW4ucmVkdWNlKChzZywgY2hpbGQpID0+IGNoaWxkLmFzc2VtYmxlU2VsZWN0aW9uVG9wTGV2ZWxTaWduYWxzKHNnKSwgc2lnbmFscyk7XG4gIH1cblxuICBwdWJsaWMgYXNzZW1ibGVTZWxlY3Rpb25TaWduYWxzKCk6IFZnU2lnbmFsW10ge1xuICAgIHRoaXMuY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IGNoaWxkLmFzc2VtYmxlU2VsZWN0aW9uU2lnbmFscygpKTtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICBwdWJsaWMgYXNzZW1ibGVMYXlvdXRTaWduYWxzKCk6IFZnU2lnbmFsW10ge1xuICAgIHJldHVybiB0aGlzLmNoaWxkcmVuLnJlZHVjZSgoc2lnbmFscywgY2hpbGQpID0+IHtcbiAgICAgIHJldHVybiBzaWduYWxzLmNvbmNhdChjaGlsZC5hc3NlbWJsZUxheW91dFNpZ25hbHMoKSk7XG4gICAgfSwgYXNzZW1ibGVMYXlvdXRTaWduYWxzKHRoaXMpKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3NlbWJsZVNlbGVjdGlvbkRhdGEoZGF0YTogVmdEYXRhW10pOiBWZ0RhdGFbXSB7XG4gICAgcmV0dXJuIHRoaXMuY2hpbGRyZW4ucmVkdWNlKChkYiwgY2hpbGQpID0+IGNoaWxkLmFzc2VtYmxlU2VsZWN0aW9uRGF0YShkYiksIGRhdGEpO1xuICB9XG5cbiAgcHVibGljIGFzc2VtYmxlTWFya3MoKTogYW55W10ge1xuICAgIC8vIG9ubHkgY2hpbGRyZW4gaGF2ZSBtYXJrc1xuICAgIHJldHVybiB0aGlzLmNoaWxkcmVuLm1hcChjaGlsZCA9PiB7XG4gICAgICBjb25zdCB0aXRsZSA9IGNoaWxkLmFzc2VtYmxlVGl0bGUoKTtcbiAgICAgIGNvbnN0IHN0eWxlID0gY2hpbGQuYXNzZW1ibGVHcm91cFN0eWxlKCk7XG4gICAgICBjb25zdCBsYXlvdXRTaXplRW5jb2RlRW50cnkgPSBjaGlsZC5hc3NlbWJsZUxheW91dFNpemUoKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdncm91cCcsXG4gICAgICAgIG5hbWU6IGNoaWxkLmdldE5hbWUoJ2dyb3VwJyksXG4gICAgICAgIC4uLih0aXRsZSA/IHt0aXRsZX0gOiB7fSksXG4gICAgICAgIC4uLihzdHlsZSA/IHtzdHlsZX0gOiB7fSksXG4gICAgICAgIC4uLihsYXlvdXRTaXplRW5jb2RlRW50cnkgPyB7XG4gICAgICAgICAgZW5jb2RlOiB7XG4gICAgICAgICAgICB1cGRhdGU6IGxheW91dFNpemVFbmNvZGVFbnRyeVxuICAgICAgICAgIH1cbiAgICAgICAgfSA6IHt9KSxcbiAgICAgICAgLi4uY2hpbGQuYXNzZW1ibGVHcm91cCgpXG4gICAgICB9O1xuICAgIH0pO1xuICB9XG59XG4iXX0=","import { defaultScaleConfig, hasDiscreteDomain } from '../../scale';\nimport { isVgRangeStep } from '../../vega.schema';\nimport { mergeValuesWithExplicit } from '../split';\nexport function parseLayerLayoutSize(model) {\n    parseChildrenLayoutSize(model);\n    var layoutSizeCmpt = model.component.layoutSize;\n    layoutSizeCmpt.setWithExplicit('width', parseNonUnitLayoutSizeForChannel(model, 'width'));\n    layoutSizeCmpt.setWithExplicit('height', parseNonUnitLayoutSizeForChannel(model, 'height'));\n}\nexport var parseRepeatLayoutSize = parseLayerLayoutSize;\nexport function parseConcatLayoutSize(model) {\n    parseChildrenLayoutSize(model);\n    var layoutSizeCmpt = model.component.layoutSize;\n    var sizeTypeToMerge = model.isVConcat ? 'width' : 'height';\n    layoutSizeCmpt.setWithExplicit(sizeTypeToMerge, parseNonUnitLayoutSizeForChannel(model, sizeTypeToMerge));\n}\nexport function parseChildrenLayoutSize(model) {\n    for (var _i = 0, _a = model.children; _i < _a.length; _i++) {\n        var child = _a[_i];\n        child.parseLayoutSize();\n    }\n}\nfunction parseNonUnitLayoutSizeForChannel(model, sizeType) {\n    var channel = sizeType === 'width' ? 'x' : 'y';\n    var resolve = model.component.resolve;\n    var mergedSize;\n    // Try to merge layout size\n    for (var _i = 0, _a = model.children; _i < _a.length; _i++) {\n        var child = _a[_i];\n        var childSize = child.component.layoutSize.getWithExplicit(sizeType);\n        var scaleResolve = resolve.scale[channel];\n        if (scaleResolve === 'independent' && childSize.value === 'range-step') {\n            // Do not merge independent scales with range-step as their size depends\n            // on the scale domains, which can be different between scales.\n            mergedSize = undefined;\n            break;\n        }\n        if (mergedSize) {\n            if (scaleResolve === 'independent' && mergedSize.value !== childSize.value) {\n                // For independent scale, only merge if all the sizes are the same.\n                // If the values are different, abandon the merge!\n                mergedSize = undefined;\n                break;\n            }\n            mergedSize = mergeValuesWithExplicit(mergedSize, childSize, sizeType, '');\n        }\n        else {\n            mergedSize = childSize;\n        }\n    }\n    if (mergedSize) {\n        // If merged, rename size and set size of all children.\n        for (var _b = 0, _c = model.children; _b < _c.length; _b++) {\n            var child = _c[_b];\n            model.renameLayoutSize(child.getName(sizeType), model.getName(sizeType));\n            child.component.layoutSize.set(sizeType, 'merged', false);\n        }\n        return mergedSize;\n    }\n    else {\n        // Otherwise, there is no merged size.\n        return {\n            explicit: false,\n            value: undefined\n        };\n    }\n}\nexport function parseUnitLayoutSize(model) {\n    var layoutSizeComponent = model.component.layoutSize;\n    if (!layoutSizeComponent.explicit.width) {\n        var width = defaultUnitSize(model, 'width');\n        layoutSizeComponent.set('width', width, false);\n    }\n    if (!layoutSizeComponent.explicit.height) {\n        var height = defaultUnitSize(model, 'height');\n        layoutSizeComponent.set('height', height, false);\n    }\n}\nfunction defaultUnitSize(model, sizeType) {\n    var channel = sizeType === 'width' ? 'x' : 'y';\n    var config = model.config;\n    var scaleComponent = model.getScaleComponent(channel);\n    if (scaleComponent) {\n        var scaleType = scaleComponent.get('type');\n        var range = scaleComponent.get('range');\n        if (hasDiscreteDomain(scaleType) && isVgRangeStep(range)) {\n            // For discrete domain with range.step, use dynamic width/height\n            return 'range-step';\n        }\n        else {\n            return config.view[sizeType];\n        }\n    }\n    else if (model.hasProjection) {\n        return config.view[sizeType];\n    }\n    else {\n        // No scale - set default size\n        if (sizeType === 'width' && model.mark === 'text') {\n            // width for text mark without x-field is a bit wider than typical range step\n            return config.scale.textXRangeStep;\n        }\n        // Set width/height equal to rangeStep config or if rangeStep is null, use value from default scale config.\n        return config.scale.rangeStep || defaultScaleConfig.rangeStep;\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyc2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9sYXlvdXRzaXplL3BhcnNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBQyxrQkFBa0IsRUFBRSxpQkFBaUIsRUFBQyxNQUFNLGFBQWEsQ0FBQztBQUNsRSxPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0sbUJBQW1CLENBQUM7QUFHaEQsT0FBTyxFQUFXLHVCQUF1QixFQUFDLE1BQU0sVUFBVSxDQUFDO0FBSTNELE1BQU0sK0JBQStCLEtBQVk7SUFDL0MsdUJBQXVCLENBQUMsS0FBSyxDQUFDLENBQUM7SUFFL0IsSUFBTSxjQUFjLEdBQUcsS0FBSyxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUM7SUFDbEQsY0FBYyxDQUFDLGVBQWUsQ0FBQyxPQUFPLEVBQUUsZ0NBQWdDLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUM7SUFDMUYsY0FBYyxDQUFDLGVBQWUsQ0FBQyxRQUFRLEVBQUUsZ0NBQWdDLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUM7QUFDOUYsQ0FBQztBQUVELE1BQU0sQ0FBQyxJQUFNLHFCQUFxQixHQUFHLG9CQUFvQixDQUFDO0FBRTFELE1BQU0sZ0NBQWdDLEtBQWtCO0lBQ3RELHVCQUF1QixDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQy9CLElBQU0sY0FBYyxHQUFHLEtBQUssQ0FBQyxTQUFTLENBQUMsVUFBVSxDQUFDO0lBRWxELElBQU0sZUFBZSxHQUFHLEtBQUssQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDO0lBQzdELGNBQWMsQ0FBQyxlQUFlLENBQUMsZUFBZSxFQUFFLGdDQUFnQyxDQUFDLEtBQUssRUFBRSxlQUFlLENBQUMsQ0FBQyxDQUFDO0FBQzVHLENBQUM7QUFFRCxNQUFNLGtDQUFrQyxLQUFZO0lBQ2xELEtBQW9CLFVB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Q0FBQztBQUVELHlCQUF5QixLQUFnQixFQUFFLFFBQTRCO0lBQ3JFLElBQU0sT0FBTyxHQUFHLFFBQVEsS0FBSyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDO0lBQ2pELElBQU0sTUFBTSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUM7SUFDNUIsSUFBTSxjQUFjLEdBQUcsS0FBSyxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBRXhELElBQUksY0FBYyxFQUFFO1FBQ2xCLElBQU0sU0FBUyxHQUFHLGNBQWMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDN0MsSUFBTSxLQUFLLEdBQUcsY0FBYyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUUxQyxJQUFJLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxJQUFJLGFBQWEsQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUN4RCxnRUFBZ0U7WUFDaEUsT0FBTyxZQUFZLENBQUM7U0FDckI7YUFBTTtZQUNMLE9BQU8sTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztTQUM5QjtLQUNGO1NBQU0sSUFBSSxLQUFLLENBQUMsYUFBYSxFQUFFO1FBQzlCLE9BQU8sTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztLQUM5QjtTQUFNO1FBQ0wsOEJBQThCO1FBQzlCLElBQUksUUFBUSxLQUFLLE9BQU8sSUFBSSxLQUFLLENBQUMsSUFBSSxLQUFLLE1BQU0sRUFBRTtZQUNqRCw2RUFBNkU7WUFDN0UsT0FBTyxNQUFNLENBQUMsS0FBSyxDQUFDLGNBQWMsQ0FBQztTQUNwQztRQUVELDJHQUEyRztRQUMzRyxPQUFPLE1BQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxJQUFJLGtCQUFrQixDQUFDLFNBQVMsQ0FBQztLQUMvRDtBQUVILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2RlZmF1bHRTY2FsZUNvbmZpZywgaGFzRGlzY3JldGVEb21haW59IGZyb20gJy4uLy4uL3NjYWxlJztcbmltcG9ydCB7aXNWZ1JhbmdlU3RlcH0gZnJvbSAnLi4vLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtDb25jYXRNb2RlbH0gZnJvbSAnLi4vY29uY2F0JztcbmltcG9ydCB7TW9kZWx9IGZyb20gJy4uL21vZGVsJztcbmltcG9ydCB7RXhwbGljaXQsIG1lcmdlVmFsdWVzV2l0aEV4cGxpY2l0fSBmcm9tICcuLi9zcGxpdCc7XG5pbXBvcnQge1VuaXRNb2RlbH0gZnJvbSAnLi4vdW5pdCc7XG5pbXBvcnQge0xheW91dFNpemUsIExheW91dFNpemVJbmRleH0gZnJvbSAnLi9jb21wb25lbnQnO1xuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VMYXllckxheW91dFNpemUobW9kZWw6IE1vZGVsKSB7XG4gIHBhcnNlQ2hpbGRyZW5MYXlvdXRTaXplKG1vZGVsKTtcblxuICBjb25zdCBsYXlvdXRTaXplQ21wdCA9IG1vZGVsLmNvbXBvbmVudC5sYXlvdXRTaXplO1xuICBsYXlvdXRTaXplQ21wdC5zZXRXaXRoRXhwbGljaXQoJ3dpZHRoJywgcGFyc2VOb25Vbml0TGF5b3V0U2l6ZUZvckNoYW5uZWwobW9kZWwsICd3aWR0aCcpKTtcbiAgbGF5b3V0U2l6ZUNtcHQuc2V0V2l0aEV4cGxpY2l0KCdoZWlnaHQnLCBwYXJzZU5vblVuaXRMYXlvdXRTaXplRm9yQ2hhbm5lbChtb2RlbCwgJ2hlaWdodCcpKTtcbn1cblxuZXhwb3J0IGNvbnN0IHBhcnNlUmVwZWF0TGF5b3V0U2l6ZSA9IHBhcnNlTGF5ZXJMYXlvdXRTaXplO1xuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VDb25jYXRMYXlvdXRTaXplKG1vZGVsOiBDb25jYXRNb2RlbCkge1xuICBwYXJzZUNoaWxkcmVuTGF5b3V0U2l6ZShtb2RlbCk7XG4gIGNvbnN0IGxheW91dFNpemVDbXB0ID0gbW9kZWwuY29tcG9uZW50LmxheW91dFNpemU7XG5cbiAgY29uc3Qgc2l6ZVR5cGVUb01lcmdlID0gbW9kZWwuaXNWQ29uY2F0ID8gJ3dpZHRoJyA6ICdoZWlnaHQnO1xuICBsYXlvdXRTaXplQ21wdC5zZXRXaXRoRXhwbGljaXQoc2l6ZVR5cGVUb01lcmdlLCBwYXJzZU5vblVuaXRMYXlvdXRTaXplRm9yQ2hhbm5lbChtb2RlbCwgc2l6ZVR5cGVUb01lcmdlKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZUNoaWxkcmVuTGF5b3V0U2l6ZShtb2RlbDogTW9kZWwpIHtcbiAgZm9yIChjb25zdCBjaGlsZCBvZiBtb2RlbC5jaGlsZHJlbikge1xuICAgIGNoaWxkLnBhcnNlTGF5b3V0U2l6ZSgpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHBhcnNlTm9uVW5pdExheW91dFNpemVGb3JDaGFubmVsKG1vZGVsOiBNb2RlbCwgc2l6ZVR5cGU6ICd3aWR0aCcgfCAnaGVpZ2h0Jyk6IEV4cGxpY2l0PExheW91dFNpemU+IHtcbiAgY29uc3QgY2hhbm5lbCA9IHNpemVUeXBlID09PSAnd2lkdGgnID8gJ3gnIDogJ3knO1xuICBjb25zdCByZXNvbHZlID0gbW9kZWwuY29tcG9uZW50LnJlc29sdmU7XG5cbiAgbGV0IG1lcmdlZFNpemU6IEV4cGxpY2l0PExheW91dFNpemU+O1xuICAvLyBUcnkgdG8gbWVyZ2UgbGF5b3V0IHNpemVcbiAgZm9yIChjb25zdCBjaGlsZCBvZiBtb2RlbC5jaGlsZHJlbikge1xuICAgIGNvbnN0IGNoaWxkU2l6ZSA9IGNoaWxkLmNvbXBvbmVudC5sYXlvdXRTaXplLmdldFdpdGhFeHBsaWNpdChzaXplVHlwZSk7XG4gICAgY29uc3Qgc2NhbGVSZXNvbHZlID0gcmVzb2x2ZS5zY2FsZVtjaGFubmVsXTtcbiAgICBpZiAoc2NhbGVSZXNvbHZlID09PSAnaW5kZXBlbmRlbnQnICYmIGNoaWxkU2l6ZS52YWx1ZSA9PT0gJ3JhbmdlLXN0ZXAnKSB7XG4gICAgICAvLyBEbyBub3QgbWVyZ2UgaW5kZXBlbmRlbnQgc2NhbGVzIHdpdGggcmFuZ2Utc3RlcCBhcyB0aGVpciBzaXplIGRlcGVuZHNcbiAgICAgIC8vIG9uIHRoZSBzY2FsZSBkb21haW5zLCB3aGljaCBjYW4gYmUgZGlmZmVyZW50IGJldHdlZW4gc2NhbGVzLlxuICAgICAgbWVyZ2VkU2l6ZSA9IHVuZGVmaW5lZDtcbiAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGlmIChtZXJnZWRTaXplKSB7XG4gICAgICBpZiAoc2NhbGVSZXNvbHZlID09PSAnaW5kZXBlbmRlbnQnICYmIG1lcmdlZFNpemUudmFsdWUgIT09IGNoaWxkU2l6ZS52YWx1ZSkge1xuICAgICAgICAvLyBGb3IgaW5kZXBlbmRlbnQgc2NhbGUsIG9ubHkgbWVyZ2UgaWYgYWxsIHRoZSBzaXplcyBhcmUgdGhlIHNhbWUuXG4gICAgICAgIC8vIElmIHRoZSB2YWx1ZXMgYXJlIGRpZmZlcmVudCwgYWJhbmRvbiB0aGUgbWVyZ2UhXG4gICAgICAgIG1lcmdlZFNpemUgPSB1bmRlZmluZWQ7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgbWVyZ2VkU2l6ZSA9IG1lcmdlVmFsdWVzV2l0aEV4cGxpY2l0PExheW91dFNpemVJbmRleCwgTGF5b3V0U2l6ZT4oXG4gICAgICAgIG1lcmdlZFNpemUsIGNoaWxkU2l6ZSwgc2l6ZVR5cGUsICcnXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICBtZXJnZWRTaXplID0gY2hpbGRTaXplO1xuICAgIH1cbiAgfVxuXG4gIGlmIChtZXJnZWRTaXplKSB7XG4gICAgLy8gSWYgbWVyZ2VkLCByZW5hbWUgc2l6ZSBhbmQgc2V0IHNpemUgb2YgYWxsIGNoaWxkcmVuLlxuICAgIGZvciAoY29uc3QgY2hpbGQgb2YgbW9kZWwuY2hpbGRyZW4pIHtcbiAgICAgIG1vZGVsLnJlbmFtZUxheW91dFNpemUoY2hpbGQuZ2V0TmFtZShzaXplVHlwZSksIG1vZGVsLmdldE5hbWUoc2l6ZVR5cGUpKTtcbiAgICAgIGNoaWxkLmNvbXBvbmVudC5sYXlvdXRTaXplLnNldChzaXplVHlwZSwgJ21lcmdlZCcsIGZhbHNlKTtcbiAgICB9XG4gICAgcmV0dXJuIG1lcmdlZFNpemU7XG4gIH0gZWxzZSB7XG4gICAgLy8gT3RoZXJ3aXNlLCB0aGVyZSBpcyBubyBtZXJnZWQgc2l6ZS5cbiAgICByZXR1cm4ge1xuICAgICAgZXhwbGljaXQ6IGZhbHNlLFxuICAgICAgdmFsdWU6IHVuZGVmaW5lZFxuICAgIH07XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlVW5pdExheW91dFNpemUobW9kZWw6IFVuaXRNb2RlbCkge1xuICBjb25zdCBsYXlvdXRTaXplQ29tcG9uZW50ID0gbW9kZWwuY29tcG9uZW50LmxheW91dFNpemU7XG4gIGlmICghbGF5b3V0U2l6ZUNvbXBvbmVudC5leHBsaWNpdC53aWR0aCkge1xuICAgIGNvbnN0IHdpZHRoID0gZGVmYXVsdFVuaXRTaXplKG1vZGVsLCAnd2lkdGgnKTtcbiAgICBsYXlvdXRTaXplQ29tcG9uZW50LnNldCgnd2lkdGgnLCB3aWR0aCwgZmFsc2UpO1xuICB9XG5cbiAgaWYgKCFsYXlvdXRTaXplQ29tcG9uZW50LmV4cGxpY2l0LmhlaWdodCkge1xuICAgIGNvbnN0IGhlaWdodCA9IGRlZmF1bHRVbml0U2l6ZShtb2RlbCwgJ2hlaWdodCcpO1xuICAgIGxheW91dFNpemVDb21wb25lbnQuc2V0KCdoZWlnaHQnLCBoZWlnaHQsIGZhbHNlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBkZWZhdWx0VW5pdFNpemUobW9kZWw6IFVuaXRNb2RlbCwgc2l6ZVR5cGU6ICd3aWR0aCcgfCAnaGVpZ2h0Jyk6IExheW91dFNpemUge1xuICBjb25zdCBjaGFubmVsID0gc2l6ZVR5cGUgPT09ICd3aWR0aCcgPyAneCcgOiAneSc7XG4gIGNvbnN0IGNvbmZpZyA9IG1vZGVsLmNvbmZpZztcbiAgY29uc3Qgc2NhbGVDb21wb25lbnQgPSBtb2RlbC5nZXRTY2FsZUNvbXBvbmVudChjaGFubmVsKTtcblxuICBpZiAoc2NhbGVDb21wb25lbnQpIHtcbiAgICBjb25zdCBzY2FsZVR5cGUgPSBzY2FsZUNvbXBvbmVudC5nZXQoJ3R5cGUnKTtcbiAgICBjb25zdCByYW5nZSA9IHNjYWxlQ29tcG9uZW50LmdldCgncmFuZ2UnKTtcblxuICAgIGlmIChoYXNEaXNjcmV0ZURvbWFpbihzY2FsZVR5cGUpICYmIGlzVmdSYW5nZVN0ZXAocmFuZ2UpKSB7XG4gICAgICAvLyBGb3IgZGlzY3JldGUgZG9tYWluIHdpdGggcmFuZ2Uuc3RlcCwgdXNlIGR5bmFtaWMgd2lkdGgvaGVpZ2h0XG4gICAgICByZXR1cm4gJ3JhbmdlLXN0ZXAnO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gY29uZmlnLnZpZXdbc2l6ZVR5cGVdO1xuICAgIH1cbiAgfSBlbHNlIGlmIChtb2RlbC5oYXNQcm9qZWN0aW9uKSB7XG4gICAgcmV0dXJuIGNvbmZpZy52aWV3W3NpemVUeXBlXTtcbiAgfSBlbHNlIHtcbiAgICAvLyBObyBzY2FsZSAtIHNldCBkZWZhdWx0IHNpemVcbiAgICBpZiAoc2l6ZVR5cGUgPT09ICd3aWR0aCcgJiYgbW9kZWwubWFyayA9PT0gJ3RleHQnKSB7XG4gICAgICAvLyB3aWR0aCBmb3IgdGV4dCBtYXJrIHdpdGhvdXQgeC1maWVsZCBpcyBhIGJpdCB3aWRlciB0aGFuIHR5cGljYWwgcmFuZ2Ugc3RlcFxuICAgICAgcmV0dXJuIGNvbmZpZy5zY2FsZS50ZXh0WFJhbmdlU3RlcDtcbiAgICB9XG5cbiAgICAvLyBTZXQgd2lkdGgvaGVpZ2h0IGVxdWFsIHRvIHJhbmdlU3RlcCBjb25maWcgb3IgaWYgcmFuZ2VTdGVwIGlzIG51bGwsIHVzZSB2YWx1ZSBmcm9tIGRlZmF1bHQgc2NhbGUgY29uZmlnLlxuICAgIHJldHVybiBjb25maWcuc2NhbGUucmFuZ2VTdGVwIHx8IGRlZmF1bHRTY2FsZUNvbmZpZy5yYW5nZVN0ZXA7XG4gIH1cblxufVxuIl19","import * as tslib_1 from \"tslib\";\nimport * as log from '../log';\nimport { isVConcatSpec } from '../spec';\nimport { BaseConcatModel } from './baseconcat';\nimport { buildModel } from './buildmodel';\nimport { parseConcatLayoutSize } from './layoutsize/parse';\nvar ConcatModel = /** @class */ (function (_super) {\n    tslib_1.__extends(ConcatModel, _super);\n    function ConcatModel(spec, parent, parentGivenName, repeater, config) {\n        var _this = _super.call(this, spec, parent, parentGivenName, config, repeater, spec.resolve) || this;\n        _this.type = 'concat';\n        if (spec.resolve && spec.resolve.axis && (spec.resolve.axis.x === 'shared' || spec.resolve.axis.y === 'shared')) {\n            log.warn(log.message.CONCAT_CANNOT_SHARE_AXIS);\n        }\n        _this.isVConcat = isVConcatSpec(spec);\n        _this.children = (isVConcatSpec(spec) ? spec.vconcat : spec.hconcat).map(function (child, i) {\n            return buildModel(child, _this, _this.getName('concat_' + i), undefined, repeater, config, false);\n        });\n        return _this;\n    }\n    ConcatModel.prototype.parseLayoutSize = function () {\n        parseConcatLayoutSize(this);\n    };\n    ConcatModel.prototype.parseAxisGroup = function () {\n        return null;\n    };\n    ConcatModel.prototype.assembleLayout = function () {\n        // TODO: allow customization\n        return tslib_1.__assign({ padding: { row: 10, column: 10 }, offset: 10 }, (this.isVConcat ? { columns: 1 } : {}), { bounds: 'full', \n            // Use align each so it can work with multiple plots with different size\n            align: 'each' });\n    };\n    return ConcatModel;\n}(BaseConcatModel));\nexport { ConcatModel };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uY2F0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvbXBpbGUvY29uY2F0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQSxPQUFPLEtBQUssR0FBRyxNQUFNLFFBQVEsQ0FBQztBQUM5QixPQUFPLEVBQUMsYUFBYSxFQUF1QixNQUFNLFNBQVMsQ0FBQztBQUU1RCxPQUFPLEVBQUMsZUFBZSxFQUFDLE1BQU0sY0FBYyxDQUFDO0FBQzdDLE9BQU8sRUFBQyxVQUFVLEVBQUMsTUFBTSxjQUFjLENBQUM7QUFDeEMsT0FBTyxFQUFDLHFCQUFxQixFQUFDLE1BQU0sb0JBQW9CLENBQUM7QUFJekQ7SUFBaUMsdUNBQWU7SUFPOUMscUJBQVksSUFBMEIsRUFBRSxNQUFhLEVBQUUsZUFBdUIsRUFBRSxRQUF1QixFQUFFLE1BQWM7UUFBdkgsWUFDRSxrQkFBTSxJQUFJLEVBQUUsTUFBTSxFQUFFLGVBQWUsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsU0FXckU7UUFsQmUsVUFBSSxHQUFhLFFBQVEsQ0FBQztRQVN4QyxJQUFJLElBQUksQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssUUFBUSxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxRQUFRLENBQUMsRUFBRTtZQUMvRyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsd0JBQXdCLENBQUMsQ0FBQztTQUNoRDtRQUVELEtBQUksQ0FBQyxTQUFTLEdBQUcsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBRXJDLEtBQUksQ0FBQyxRQUFRLEdBQUcsQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBQyxLQUFLLEVBQUUsQ0FBQztZQUMvRSxPQUFPLFVBQVUsQ0FBQyxLQUFLLEVBQUUsS0FBSSxFQUFFLEtBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxHQUFHLENBQUMsQ0FBQyxFQUFFLFNBQVMsRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQ2xHLENBQUMsQ0FBQyxDQUFDOztJQUNMLENBQUM7SUFFTSxxQ0FBZSxHQUF0QjtRQUNFLHFCQUFxQixDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFHTSxvQ0FBYyxHQUFyQjtRQUNFLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVNLG9DQUFjLEdBQXJCO1FBQ0UsNEJBQTRCO1FBQzVCLDBCQUNFLE9BQU8sRUFBRSxFQUFDLEdBQUcsRUFBRSxFQUFFLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBQyxFQUM5QixNQUFNLEVBQUUsRUFBRSxJQUNQLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBQyxPQUFPLEVBQUUsQ0FBQyxFQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxJQUN2QyxNQUFNLEVBQUUsTUFBTTtZQUNkLHdFQUF3RTtZQUN4RSxLQUFLLEVBQUUsTUFBTSxJQUNiO0lBQ0osQ0FBQztJQUNILGtCQUFDO0FBQUQsQ0FBQyxBQXpDRCxDQUFpQyxlQUFlLEdBeUMvQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29uZmlnfSBmcm9tICcuLi9jb25maWcnO1xuaW1wb3J0ICogYXMgbG9nIGZyb20gJy4uL2xvZyc7XG5pbXBvcnQge2lzVkNvbmNhdFNwZWMsIE5vcm1hbGl6ZWRDb25jYXRTcGVjfSBmcm9tICcuLi9zcGVjJztcbmltcG9ydCB7VmdMYXlvdXR9IGZyb20gJy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7QmFzZUNvbmNhdE1vZGVsfSBmcm9tICcuL2Jhc2Vjb25jYXQnO1xuaW1wb3J0IHtidWlsZE1vZGVsfSBmcm9tICcuL2J1aWxkbW9kZWwnO1xuaW1wb3J0IHtwYXJzZUNvbmNhdExheW91dFNpemV9IGZyb20gJy4vbGF5b3V0c2l6ZS9wYXJzZSc7XG5pbXBvcnQge01vZGVsfSBmcm9tICcuL21vZGVsJztcbmltcG9ydCB7UmVwZWF0ZXJWYWx1ZX0gZnJvbSAnLi9yZXBlYXRlcic7XG5cbmV4cG9ydCBjbGFzcyBDb25jYXRNb2RlbCBleHRlbmRzIEJhc2VDb25jYXRNb2RlbCB7XG4gIHB1YmxpYyByZWFkb25seSB0eXBlOiAnY29uY2F0JyA9ICdjb25jYXQnO1xuXG4gIHB1YmxpYyByZWFkb25seSBjaGlsZHJlbjogTW9kZWxbXTtcblxuICBwdWJsaWMgcmVhZG9ubHkgaXNWQ29uY2F0OiBib29sZWFuO1xuXG4gIGNvbnN0cnVjdG9yKHNwZWM6IE5vcm1hbGl6ZWRDb25jYXRTcGVjLCBwYXJlbnQ6IE1vZGVsLCBwYXJlbnRHaXZlbk5hbWU6IHN0cmluZywgcmVwZWF0ZXI6IFJlcGVhdGVyVmFsdWUsIGNvbmZpZzogQ29uZmlnKSB7XG4gICAgc3VwZXIoc3BlYywgcGFyZW50LCBwYXJlbnRHaXZlbk5hbWUsIGNvbmZpZywgcmVwZWF0ZXIsIHNwZWMucmVzb2x2ZSk7XG5cbiAgICBpZiAoc3BlYy5yZXNvbHZlICYmIHNwZWMucmVzb2x2ZS5heGlzICYmIChzcGVjLnJlc29sdmUuYXhpcy54ID09PSAnc2hhcmVkJyB8fCBzcGVjLnJlc29sdmUuYXhpcy55ID09PSAnc2hhcmVkJykpIHtcbiAgICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLkNPTkNBVF9DQU5OT1RfU0hBUkVfQVhJUyk7XG4gICAgfVxuXG4gICAgdGhpcy5pc1ZDb25jYXQgPSBpc1ZDb25jYXRTcGVjKHNwZWMpO1xuXG4gICAgdGhpcy5jaGlsZHJlbiA9IChpc1ZDb25jYXRTcGVjKHNwZWMpID8gc3BlYy52Y29uY2F0IDogc3BlYy5oY29uY2F0KS5tYXAoKGNoaWxkLCBpKSA9PiB7XG4gICAgICByZXR1cm4gYnVpbGRNb2RlbChjaGlsZCwgdGhpcywgdGhpcy5nZXROYW1lKCdjb25jYXRfJyArIGkpLCB1bmRlZmluZWQsIHJlcGVhdGVyLCBjb25maWcsIGZhbHNlKTtcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBwYXJzZUxheW91dFNpemUoKSB7XG4gICAgcGFyc2VDb25jYXRMYXlvdXRTaXplKHRoaXMpO1xuICB9XG5cblxuICBwdWJsaWMgcGFyc2VBeGlzR3JvdXAoKTogdm9pZCB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBwdWJsaWMgYXNzZW1ibGVMYXlvdXQoKTogVmdMYXlvdXQge1xuICAgIC8vIFRPRE86IGFsbG93IGN1c3RvbWl6YXRpb25cbiAgICByZXR1cm4ge1xuICAgICAgcGFkZGluZzoge3JvdzogMTAsIGNvbHVtbjogMTB9LFxuICAgICAgb2Zmc2V0OiAxMCxcbiAgICAgIC4uLih0aGlzLmlzVkNvbmNhdCA/IHtjb2x1bW5zOiAxfSA6IHt9KSxcbiAgICAgIGJvdW5kczogJ2Z1bGwnLFxuICAgICAgLy8gVXNlIGFsaWduIGVhY2ggc28gaXQgY2FuIHdvcmsgd2l0aCBtdWx0aXBsZSBwbG90cyB3aXRoIGRpZmZlcmVudCBzaXplXG4gICAgICBhbGlnbjogJ2VhY2gnXG4gICAgfTtcbiAgfVxufVxuIl19","import * as tslib_1 from \"tslib\";\nimport { isUrlData } from '../../data';\nimport { vals } from '../../util';\nimport { AggregateNode } from './aggregate';\nimport { BinNode } from './bin';\nimport { CalculateNode } from './calculate';\nimport { OutputNode } from './dataflow';\nimport { FacetNode } from './facet';\nimport { FilterNode } from './filter';\nimport { FilterInvalidNode } from './filterinvalid';\nimport { ParseNode } from './formatparse';\nimport { GeoJSONNode } from './geojson';\nimport { GeoPointNode } from './geopoint';\nimport { IdentifierNode } from './indentifier';\nimport { LookupNode } from './lookup';\nimport { SourceNode } from './source';\nimport { StackNode } from './stack';\nimport { TimeUnitNode } from './timeunit';\nimport { WindowTransformNode } from './window';\n/**\n * Print debug information for dataflow tree.\n */\n// tslint:disable-next-line\nfunction debug(node) {\n    console.log(\"\" + node.constructor.name + (node.debugName ? \" (\" + node.debugName + \")\" : '') + \" -> \" + (node.children.map(function (c) {\n        return \"\" + c.constructor.name + (c.debugName ? \" (\" + c.debugName + \")\" : '');\n    })));\n    console.log(node);\n    node.children.forEach(debug);\n}\nfunction makeWalkTree(data) {\n    // to name datasources\n    var datasetIndex = 0;\n    /**\n     * Recursively walk down the tree.\n     */\n    function walkTree(node, dataSource) {\n        if (node instanceof SourceNode) {\n            // If the source is a named data source or a data source with values, we need\n            // to put it in a different data source. Otherwise, Vega may override the data.\n            if (!isUrlData(node.data)) {\n                data.push(dataSource);\n                var newData = {\n                    name: null,\n                    source: dataSource.name,\n                    transform: []\n                };\n                dataSource = newData;\n            }\n        }\n        if (node instanceof ParseNode) {\n            if (node.parent instanceof SourceNode && !dataSource.source) {\n                // If node's parent is a root source and the data source does not refer to another data source, use normal format parse\n                dataSource.format = tslib_1.__assign({}, dataSource.format || {}, { parse: node.assembleFormatParse() });\n                // add calculates for all nested fields\n                dataSource.transform = dataSource.transform.concat(node.assembleTransforms(true));\n            }\n            else {\n                // Otherwise use Vega expression to parse\n                dataSource.transform = dataSource.transform.concat(node.assembleTransforms());\n            }\n        }\n        if (node instanceof FacetNode) {\n            if (!dataSource.name) {\n                dataSource.name = \"data_\" + datasetIndex++;\n            }\n            if (!dataSource.source || dataSource.transform.length > 0) {\n                data.push(dataSource);\n                node.data = dataSource.name;\n            }\n            else {\n                node.data = dataSource.source;\n            }\n            node.assemble().forEach(function (d) { return data.push(d); });\n            // break here because the rest of the tree has to be taken care of by the facet.\n            return;\n        }\n        if (node instanceof FilterNode ||\n            node instanceof CalculateNode ||\n            node instanceof GeoPointNode ||\n            node instanceof GeoJSONNode ||\n            node instanceof AggregateNode ||\n            node instanceof LookupNode ||\n            node instanceof WindowTransformNode ||\n            node instanceof IdentifierNode) {\n            dataSource.transform.push(node.assemble());\n        }\n        if (node instanceof FilterInvalidNode ||\n            node instanceof BinNode ||\n            node instanceof TimeUnitNode ||\n            node instanceof StackNode) {\n            dataSource.transform = dataSource.transform.concat(node.assemble());\n        }\n        if (node instanceof AggregateNode) {\n            if (!dataSource.name) {\n                dataSource.name = \"data_\" + datasetIndex++;\n            }\n        }\n        if (node instanceof OutputNode) {\n            if (dataSource.source && dataSource.transform.length === 0) {\n                node.setSource(dataSource.source);\n            }\n            else if (node.parent instanceof OutputNode) {\n                // Note that an output node may be required but we still do not assemble a\n                // separate data source for it.\n                node.setSource(dataSource.name);\n            }\n            else {\n                if (!dataSource.name) {\n                    dataSource.name = \"data_\" + datasetIndex++;\n                }\n                // Here we set the name of the datasource we generated. From now on\n                // other assemblers can use it.\n                node.setSource(dataSource.name);\n                // if this node has more than one child, we will add a datasource automatically\n                if (node.numChildren() === 1) {\n                    data.push(dataSource);\n                    var newData = {\n                        name: null,\n                        source: dataSource.name,\n                        transform: []\n                    };\n                    dataSource = newData;\n                }\n            }\n        }\n        switch (node.numChildren()) {\n            case 0:\n                // done\n                if (node instanceof OutputNode && (!dataSource.source || dataSource.transform.length > 0)) {\n                    // do not push empty datasources that are simply references\n                    data.push(dataSource);\n                }\n                break;\n            case 1:\n                walkTree(node.children[0], dataSource);\n                break;\n            default:\n                if (!dataSource.name) {\n                    dataSource.name = \"data_\" + datasetIndex++;\n                }\n                var source_1 = dataSource.name;\n                if (!dataSource.source || dataSource.transform.length > 0) {\n                    data.push(dataSource);\n                }\n                else {\n                    source_1 = dataSource.source;\n                }\n                node.children.forEach(function (child) {\n                    var newData = {\n                        name: null,\n                        source: source_1,\n                        transform: []\n                    };\n                    walkTree(child, newData);\n                });\n                break;\n        }\n    }\n    return walkTree;\n}\n/**\n * Assemble data sources that are derived from faceted data.\n */\nexport function assembleFacetData(root) {\n    var data = [];\n    var walkTree = makeWalkTree(data);\n    root.children.forEach(function (child) { return walkTree(child, {\n        source: root.name,\n        name: null,\n        transform: []\n    }); });\n    return data;\n}\n/**\n * Create Vega Data array from a given compiled model and append all of them to the given array\n *\n * @param  model\n * @param  data array\n * @return modified data array\n */\nexport function assembleRootData(dataComponent, datasets) {\n    var roots = vals(dataComponent.sources);\n    var data = [];\n    // roots.forEach(debug);\n    var walkTree = makeWalkTree(data);\n    var sourceIndex = 0;\n    roots.forEach(function (root) {\n        // assign a name if the source does not have a name yet\n        if (!root.hasName()) {\n            root.dataName = \"source_\" + sourceIndex++;\n        }\n        var newData = root.assemble();\n        walkTree(root, newData);\n    });\n    // remove empty transform arrays for cleaner output\n    data.forEach(function (d) {\n        if (d.transform.length === 0) {\n            delete d.transform;\n        }\n    });\n    // move sources without transforms (the ones that are potentially used in lookups) to the beginning\n    var whereTo = 0;\n    for (var i = 0; i < data.length; i++) {\n        var d = data[i];\n        if ((d.transform || []).length === 0 && !d.source) {\n            data.splice(whereTo++, 0, data.splice(i, 1)[0]);\n        }\n    }\n    // now fix the from references in lookup transforms\n    for (var _i = 0, data_1 = data; _i < data_1.length; _i++) {\n        var d = data_1[_i];\n        for (var _a = 0, _b = d.transform || []; _a < _b.length; _a++) {\n            var t = _b[_a];\n            if (t.type === 'lookup') {\n                t.from = dataComponent.outputNodes[t.from].getSource();\n            }\n        }\n    }\n    // inline values for datasets that are in the datastore\n    for (var _c = 0, data_2 = data; _c < data_2.length; _c++) {\n        var d = data_2[_c];\n        if (d.name in datasets) {\n            d.values = datasets[d.name];\n        }\n    }\n    return data;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXNzZW1ibGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9kYXRhL2Fzc2VtYmxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQWdCLFNBQVMsRUFBQyxNQUFNLFlBQVksQ0FBQztBQUNwRCxPQUFPLEVBQU8sSUFBSSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBR3RDLE9BQU8sRUFBQyxhQUFhLEVBQUMsTUFBTSxhQUFhLENBQUM7QUFDMUMsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLE9BQU8sQ0FBQztBQUM5QixPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0sYUFBYSxDQUFDO0FBQzFDLE9BQU8sRUFBZSxVQUFVLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDcEQsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLFNBQVMsQ0FBQztBQUNsQyxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0sVUFBVSxDQUFDO0FBQ3BDLE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLGlCQUFpQixDQUFDO0FBQ2xELE9BQU8sRUFBQyxTQUFTLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDeEMsT0FBTyxFQUFDLFdBQVcsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUN0QyxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQ3hDLE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDN0MsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLFVBQVUsQ0FBQztBQUNwQyxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0sVUFBVSxDQUFDO0FBQ3BDLE9BQU8sRUFBQyxTQUFTLEVBQUMsTUFBTSxTQUFTLENBQUM7QUFDbEMsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLFlBQVksQ0FBQztBQUN4QyxPQUFPLEVBQUMsbUJBQW1CLEVBQUMsTUFBTSxVQUFVLENBQUM7QUFFN0M7O0dBRUc7QUFDSCwyQkFBMkI7QUFD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SUFBTSxDQUFDLGFBQUE7UUFDVixLQUFnQixVQUFpQixFQUFqQixLQUFBLENBQUMsQ0FBQyxTQUFTLElBQUksRUFBRSxFQUFqQixjQUFpQixFQUFqQixJQUFpQixFQUFFO1lBQTlCLElBQU0sQ0FBQyxTQUFBO1lBQ1YsSUFBSSxDQUFDLENBQUMsSUFBSSxLQUFLLFFBQVEsRUFBRTtnQkFDdkIsQ0FBQyxDQUFDLElBQUksR0FBRyxhQUFhLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQzthQUN4RDtTQUNGO0tBQ0Y7SUFFRCx1REFBdUQ7SUFDdkQsS0FBZ0IsVUFBSSxFQUFKLGFBQUksRUFBSixrQkFBSSxFQUFKLElBQUksRUFBRTtRQUFqQixJQUFNLENBQUMsYUFBQTtRQUNWLElBQUksQ0FBQyxDQUFDLElBQUksSUFBSSxRQUFRLEVBQUU7WUFDdEIsQ0FBQyxDQUFDLE1BQU0sR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQzdCO0tBQ0Y7SUFFRCxPQUFPLElBQUksQ0FBQztBQUNkLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0lubGluZURhdGFzZXQsIGlzVXJsRGF0YX0gZnJvbSAnLi4vLi4vZGF0YSc7XG5pbXBvcnQge0RpY3QsIHZhbHN9IGZyb20gJy4uLy4uL3V0aWwnO1xuaW1wb3J0IHtWZ0RhdGF9IGZyb20gJy4uLy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7RGF0YUNvbXBvbmVudH0gZnJvbSAnLi8nO1xuaW1wb3J0IHtBZ2dyZWdhdGVOb2RlfSBmcm9tICcuL2FnZ3JlZ2F0ZSc7XG5pbXBvcnQge0Jpbk5vZGV9IGZyb20gJy4vYmluJztcbmltcG9ydCB7Q2FsY3VsYXRlTm9kZX0gZnJvbSAnLi9jYWxjdWxhdGUnO1xuaW1wb3J0IHtEYXRhRmxvd05vZGUsIE91dHB1dE5vZGV9IGZyb20gJy4vZGF0YWZsb3cnO1xuaW1wb3J0IHtGYWNldE5vZGV9IGZyb20gJy4vZmFjZXQnO1xuaW1wb3J0IHtGaWx0ZXJOb2RlfSBmcm9tICcuL2ZpbHRlcic7XG5pbXBvcnQge0ZpbHRlckludmFsaWROb2RlfSBmcm9tICcuL2ZpbHRlcmludmFsaWQnO1xuaW1wb3J0IHtQYXJzZU5vZGV9IGZyb20gJy4vZm9ybWF0cGFyc2UnO1xuaW1wb3J0IHtHZW9KU09OTm9kZX0gZnJvbSAnLi9nZW9qc29uJztcbmltcG9ydCB7R2VvUG9pbnROb2RlfSBmcm9tICcuL2dlb3BvaW50JztcbmltcG9ydCB7SWRlbnRpZmllck5vZGV9IGZyb20gJy4vaW5kZW50aWZpZXInO1xuaW1wb3J0IHtMb29rdXBOb2RlfSBmcm9tICcuL2xvb2t1cCc7XG5pbXBvcnQge1NvdXJjZU5vZGV9IGZyb20gJy4vc291cmNlJztcbmltcG9ydCB7U3RhY2tOb2RlfSBmcm9tICcuL3N0YWNrJztcbmltcG9ydCB7VGltZVVuaXROb2RlfSBmcm9tICcuL3RpbWV1bml0JztcbmltcG9ydCB7V2luZG93VHJhbnNmb3JtTm9kZX0gZnJvbSAnLi93aW5kb3cnO1xuXG4vKipcbiAqIFByaW50IGRlYnVnIGluZm9ybWF0aW9uIGZvciBkYXRhZmxvdyB0cmVlLlxuICovXG4vLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmVcbmZ1bmN0aW9uIGRlYnVnKG5vZGU6IERhdGFGbG93Tm9kZSkge1xuICBjb25zb2xlLmxvZyhgJHsobm9kZS5jb25zdHJ1Y3RvciBhcyBhbnkpLm5hbWV9JHtub2RlLmRlYnVnTmFtZSA/IGAgKCR7bm9kZS5kZWJ1Z05hbWV9KWAgOiAnJ30gLT4gJHtcbiAgICAobm9kZS5jaGlsZHJlbi5tYXAoYyA9PiB7XG4gICAgICByZXR1cm4gYCR7KGMuY29uc3RydWN0b3IgYXMgYW55KS5uYW1lfSR7Yy5kZWJ1Z05hbWUgPyBgICgke2MuZGVidWdOYW1lfSlgIDogJyd9YDtcbiAgICB9KSlcbiAgfWApO1xuICBjb25zb2xlLmxvZyhub2RlKTtcbiAgbm9kZS5jaGlsZHJlbi5mb3JFYWNoKGRlYnVnKTtcbn1cblxuZnVuY3Rpb24gbWFrZVdhbGtUcmVlKGRhdGE6IFZnRGF0YVtdKSB7XG4gIC8vIHRvIG5hbWUgZGF0YXNvdXJjZXNcbiAgbGV0IGRhdGFzZXRJbmRleCA9IDA7XG5cbiAgLyoqXG4gICAqIFJlY3Vyc2l2ZWx5IHdhbGsgZG93biB0aGUgdHJlZS5cbiAgICovXG4gIGZ1bmN0aW9uIHdhbGtUcmVlKG5vZGU6IERhdGFGbG93Tm9kZSwgZGF0YVNvdXJjZTogVmdEYXRhKSB7XG4gICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBTb3VyY2VOb2RlKSB7XG4gICAgICAvLyBJZiB0aGUgc291cmNlIGlzIGEgbmFtZWQgZGF0YSBzb3VyY2Ugb3IgYSBkYXRhIHNvdXJjZSB3aXRoIHZhbHVlcywgd2UgbmVlZFxuICAgICAgLy8gdG8gcHV0IGl0IGluIGEgZGlmZmVyZW50IGRhdGEgc291cmNlLiBPdGhlcndpc2UsIFZlZ2EgbWF5IG92ZXJyaWRlIHRoZSBkYXRhLlxuICAgICAgaWYgKCFpc1VybERhdGEobm9kZS5kYXRhKSkge1xuICAgICAgICBkYXRhLnB1c2goZGF0YVNvdXJjZSk7XG4gICAgICAgIGNvbnN0IG5ld0RhdGE6IFZnRGF0YSA9IHtcbiAgICAgICAgICBuYW1lOiBudWxsLFxuICAgICAgICAgIHNvdXJjZTogZGF0YVNvdXJjZS5uYW1lLFxuICAgICAgICAgIHRyYW5zZm9ybTogW11cbiAgICAgICAgfTtcbiAgICAgICAgZGF0YVNvdXJjZSA9IG5ld0RhdGE7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBQYXJzZU5vZGUpIHtcbiAgICAgIGlmIChub2RlLnBhcmVudCBpbnN0YW5jZW9mIFNvdXJjZU5vZGUgJiYgIWRhdGFTb3VyY2Uuc291cmNlKSB7XG4gICAgICAgIC8vIElmIG5vZGUncyBwYXJlbnQgaXMgYSByb290IHNvdXJjZSBhbmQgdGhlIGRhdGEgc291cmNlIGRvZXMgbm90IHJlZmVyIHRvIGFub3RoZXIgZGF0YSBzb3VyY2UsIHVzZSBub3JtYWwgZm9ybWF0IHBhcnNlXG4gICAgICAgIGRhdGFTb3VyY2UuZm9ybWF0ID0ge1xuICAgICAgICAgIC4uLmRhdGFTb3VyY2UuZm9ybWF0IHx8IHt9LFxuICAgICAgICAgIHBhcnNlOiBub2RlLmFzc2VtYmxlRm9ybWF0UGFyc2UoKVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIGFkZCBjYWxjdWxhdGVzIGZvciBhbGwgbmVzdGVkIGZpZWxkc1xuICAgICAgICBkYXRhU291cmNlLnRyYW5zZm9ybSA9IGRhdGFTb3VyY2UudHJhbnNmb3JtLmNvbmNhdChub2RlLmFzc2VtYmxlVHJhbnNmb3Jtcyh0cnVlKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBPdGhlcndpc2UgdXNlIFZlZ2EgZXhwcmVzc2lvbiB0byBwYXJzZVxuICAgICAgICBkYXRhU291cmNlLnRyYW5zZm9ybSA9IGRhdGFTb3VyY2UudHJhbnNmb3JtLmNvbmNhdChub2RlLmFzc2VtYmxlVHJhbnNmb3JtcygpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobm9kZSBpbnN0YW5jZW9mIEZhY2V0Tm9kZSkge1xuICAgICAgaWYgKCFkYXRhU291cmNlLm5hbWUpIHtcbiAgICAgICAgZGF0YVNvdXJjZS5uYW1lID0gYGRhdGFfJHtkYXRhc2V0SW5kZXgrK31gO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWRhdGFTb3VyY2Uuc291cmNlIHx8IGRhdGFTb3VyY2UudHJhbnNmb3JtLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZGF0YS5wdXNoKGRhdGFTb3VyY2UpO1xuICAgICAgICBub2RlLmRhdGEgPSBkYXRhU291cmNlLm5hbWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBub2RlLmRhdGEgPSBkYXRhU291cmNlLnNvdXJjZTtcbiAgICAgIH1cblxuICAgICAgbm9kZS5hc3NlbWJsZSgpLmZvckVhY2goZCA9PiBkYXRhLnB1c2goZCkpO1xuXG4gICAgICAvLyBicmVhayBoZXJlIGJlY2F1c2UgdGhlIHJlc3Qgb2YgdGhlIHRyZWUgaGFzIHRvIGJlIHRha2VuIGNhcmUgb2YgYnkgdGhlIGZhY2V0LlxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChub2RlIGluc3RhbmNlb2YgRmlsdGVyTm9kZSB8fFxuICAgICAgbm9kZSBpbnN0YW5jZW9mIENhbGN1bGF0ZU5vZGUgfHxcbiAgICAgIG5vZGUgaW5zdGFuY2VvZiBHZW9Qb2ludE5vZGUgfHxcbiAgICAgIG5vZGUgaW5zdGFuY2VvZiBHZW9KU09OTm9kZSB8fFxuICAgICAgbm9kZSBpbnN0YW5jZW9mIEFnZ3JlZ2F0ZU5vZGUgfHxcbiAgICAgIG5vZGUgaW5zdGFuY2VvZiBMb29rdXBOb2RlIHx8XG4gICAgICBub2RlIGluc3RhbmNlb2YgV2luZG93VHJhbnNmb3JtTm9kZSB8fFxuICAgICAgbm9kZSBpbnN0YW5jZW9mIElkZW50aWZpZXJOb2RlKSB7XG4gICAgICBkYXRhU291cmNlLnRyYW5zZm9ybS5wdXNoKG5vZGUuYXNzZW1ibGUoKSk7XG4gICAgfVxuXG4gICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBGaWx0ZXJJbnZhbGlkTm9kZSB8fFxuICAgICAgbm9kZSBpbnN0YW5jZW9mIEJpbk5vZGUgfHxcbiAgICAgIG5vZGUgaW5zdGFuY2VvZiBUaW1lVW5pdE5vZGUgfHxcbiAgICAgIG5vZGUgaW5zdGFuY2VvZiBTdGFja05vZGUpIHtcbiAgICAgIGRhdGFTb3VyY2UudHJhbnNmb3JtID0gZGF0YVNvdXJjZS50cmFuc2Zvcm0uY29uY2F0KG5vZGUuYXNzZW1ibGUoKSk7XG4gICAgfVxuXG4gICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBBZ2dyZWdhdGVOb2RlKSB7XG4gICAgICBpZiAoIWRhdGFTb3VyY2UubmFtZSkge1xuICAgICAgICBkYXRhU291cmNlLm5hbWUgPSBgZGF0YV8ke2RhdGFzZXRJbmRleCsrfWA7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBPdXRwdXROb2RlKSB7XG4gICAgICBpZiAoZGF0YVNvdXJjZS5zb3VyY2UgJiYgZGF0YVNvdXJjZS50cmFuc2Zvcm0ubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIG5vZGUuc2V0U291cmNlKGRhdGFTb3VyY2Uuc291cmNlKTtcbiAgICAgIH0gZWxzZSBpZiAobm9kZS5wYXJlbnQgaW5zdGFuY2VvZiBPdXRwdXROb2RlKSB7XG4gICAgICAgIC8vIE5vdGUgdGhhdCBhbiBvdXRwdXQgbm9kZSBtYXkgYmUgcmVxdWlyZWQgYnV0IHdlIHN0aWxsIGRvIG5vdCBhc3NlbWJsZSBhXG4gICAgICAgIC8vIHNlcGFyYXRlIGRhdGEgc291cmNlIGZvciBpdC5cbiAgICAgICAgbm9kZS5zZXRTb3VyY2UoZGF0YVNvdXJjZS5uYW1lKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghZGF0YVNvdXJjZS5uYW1lKSB7XG4gICAgICAgICAgZGF0YVNvdXJjZS5uYW1lID0gYGRhdGFfJHtkYXRhc2V0SW5kZXgrK31gO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSGVyZSB3ZSBzZXQgdGhlIG5hbWUgb2YgdGhlIGRhdGFzb3VyY2Ugd2UgZ2VuZXJhdGVkLiBGcm9tIG5vdyBvblxuICAgICAgICAvLyBvdGhlciBhc3NlbWJsZXJzIGNhbiB1c2UgaXQuXG4gICAgICAgIG5vZGUuc2V0U291cmNlKGRhdGFTb3VyY2UubmFtZSk7XG5cbiAgICAgICAgLy8gaWYgdGhpcyBub2RlIGhhcyBtb3JlIHRoYW4gb25lIGNoaWxkLCB3ZSB3aWxsIGFkZCBhIGRhdGFzb3VyY2UgYXV0b21hdGljYWxseVxuICAgICAgICBpZiAobm9kZS5udW1DaGlsZHJlbigpID09PSAxKSB7XG4gICAgICAgICAgZGF0YS5wdXNoKGRhdGFTb3VyY2UpO1xuICAgICAgICAgIGNvbnN0IG5ld0RhdGE6IFZnRGF0YSA9IHtcbiAgICAgICAgICAgIG5hbWU6IG51bGwsXG4gICAgICAgICAgICBzb3VyY2U6IGRhdGFTb3VyY2UubmFtZSxcbiAgICAgICAgICAgIHRyYW5zZm9ybTogW11cbiAgICAgICAgICB9O1xuICAgICAgICAgIGRhdGFTb3VyY2UgPSBuZXdEYXRhO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgc3dpdGNoIChub2RlLm51bUNoaWxkcmVuKCkpIHtcbiAgICAgIGNhc2UgMDpcbiAgICAgICAgLy8gZG9uZVxuICAgICAgICBpZiAobm9kZSBpbnN0YW5jZW9mIE91dHB1dE5vZGUgJiYgKCFkYXRhU291cmNlLnNvdXJjZSB8fCBkYXRhU291cmNlLnRyYW5zZm9ybS5sZW5ndGggPiAwKSkge1xuICAgICAgICAgIC8vIGRvIG5vdCBwdXNoIGVtcHR5IGRhdGFzb3VyY2VzIHRoYXQgYXJlIHNpbXBseSByZWZlcmVuY2VzXG4gICAgICAgICAgZGF0YS5wdXNoKGRhdGFTb3VyY2UpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAxOlxuICAgICAgICB3YWxrVHJlZShub2RlLmNoaWxkcmVuWzBdLCBkYXRhU291cmNlKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBpZiAoIWRhdGFTb3VyY2UubmFtZSkge1xuICAgICAgICAgIGRhdGFTb3VyY2UubmFtZSA9IGBkYXRhXyR7ZGF0YXNldEluZGV4Kyt9YDtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBzb3VyY2UgPSBkYXRhU291cmNlLm5hbWU7XG4gICAgICAgIGlmICghZGF0YVNvdXJjZS5zb3VyY2UgfHwgZGF0YVNvdXJjZS50cmFuc2Zvcm0ubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGRhdGEucHVzaChkYXRhU291cmNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzb3VyY2UgPSBkYXRhU291cmNlLnNvdXJjZTtcbiAgICAgICAgfVxuXG4gICAgICAgIG5vZGUuY2hpbGRyZW4uZm9yRWFjaChjaGlsZCA9PiB7XG4gICAgICAgICAgY29uc3QgbmV3RGF0YTogVmdEYXRhID0ge1xuICAgICAgICAgICAgbmFtZTogbnVsbCxcbiAgICAgICAgICAgIHNvdXJjZTogc291cmNlLFxuICAgICAgICAgICAgdHJhbnNmb3JtOiBbXVxuICAgICAgICAgIH07XG4gICAgICAgICAgd2Fsa1RyZWUoY2hpbGQsIG5ld0RhdGEpO1xuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHdhbGtUcmVlO1xufVxuXG4vKipcbiAqIEFzc2VtYmxlIGRhdGEgc291cmNlcyB0aGF0IGFyZSBkZXJpdmVkIGZyb20gZmFjZXRlZCBkYXRhLlxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzZW1ibGVGYWNldERhdGEocm9vdDogRmFjZXROb2RlKTogVmdEYXRhW10ge1xuICBjb25zdCBkYXRhOiBWZ0RhdGFbXSA9IFtdO1xuICBjb25zdCB3YWxrVHJlZSA9IG1ha2VXYWxrVHJlZShkYXRhKTtcblxuICByb290LmNoaWxkcmVuLmZvckVhY2goY2hpbGQgPT4gd2Fsa1RyZWUoY2hpbGQsIHtcbiAgICBzb3VyY2U6IHJvb3QubmFtZSxcbiAgICBuYW1lOiBudWxsLFxuICAgIHRyYW5zZm9ybTogW11cbiAgfSkpO1xuXG4gIHJldHVybiBkYXRhO1xufVxuXG4vKipcbiAqIENyZWF0ZSBWZWdhIERhdGEgYXJyYXkgZnJvbSBhIGdpdmVuIGNvbXBpbGVkIG1vZGVsIGFuZCBhcHBlbmQgYWxsIG9mIHRoZW0gdG8gdGhlIGdpdmVuIGFycmF5XG4gKlxuICogQHBhcmFtICBtb2RlbFxuICogQHBhcmFtICBkYXRhIGFycmF5XG4gKiBAcmV0dXJuIG1vZGlmaWVkIGRhdGEgYXJyYXlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2VtYmxlUm9vdERhdGEoZGF0YUNvbXBvbmVudDogRGF0YUNvbXBvbmVudCwgZGF0YXNldHM6IERpY3Q8SW5saW5lRGF0YXNldD4pOiBWZ0RhdGFbXSB7XG4gIGNvbnN0IHJvb3RzOiBTb3VyY2VOb2RlW10gPSB2YWxzKGRhdGFDb21wb25lbnQuc291cmNlcyk7XG4gIGNvbnN0IGRhdGE6IFZnRGF0YVtdID0gW107XG5cbiAgLy8gcm9vdHMuZm9yRWFjaChkZWJ1Zyk7XG5cbiAgY29uc3Qgd2Fsa1RyZWUgPSBtYWtlV2Fsa1RyZWUoZGF0YSk7XG5cbiAgbGV0IHNvdXJjZUluZGV4ID0gMDtcblxuICByb290cy5mb3JFYWNoKHJvb3QgPT4ge1xuICAgIC8vIGFzc2lnbiBhIG5hbWUgaWYgdGhlIHNvdXJjZSBkb2VzIG5vdCBoYXZlIGEgbmFtZSB5ZXRcbiAgICBpZiAoIXJvb3QuaGFzTmFtZSgpKSB7XG4gICAgICByb290LmRhdGFOYW1lID0gYHNvdXJjZV8ke3NvdXJjZUluZGV4Kyt9YDtcbiAgICB9XG5cbiAgICBjb25zdCBuZXdEYXRhOiBWZ0RhdGEgPSByb290LmFzc2VtYmxlKCk7XG5cbiAgICB3YWxrVHJlZShyb290LCBuZXdEYXRhKTtcbiAgfSk7XG5cbiAgLy8gcmVtb3ZlIGVtcHR5IHRyYW5zZm9ybSBhcnJheXMgZm9yIGNsZWFuZXIgb3V0cHV0XG4gIGRhdGEuZm9yRWFjaChkID0+IHtcbiAgICBpZiAoZC50cmFuc2Zvcm0ubGVuZ3RoID09PSAwKSB7XG4gICAgICBkZWxldGUgZC50cmFuc2Zvcm07XG4gICAgfVxuICB9KTtcblxuICAvLyBtb3ZlIHNvdXJjZXMgd2l0aG91dCB0cmFuc2Zvcm1zICh0aGUgb25lcyB0aGF0IGFyZSBwb3RlbnRpYWxseSB1c2VkIGluIGxvb2t1cHMpIHRvIHRoZSBiZWdpbm5pbmdcbiAgbGV0IHdoZXJlVG8gPSAwO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBkID0gZGF0YVtpXTtcbiAgICBpZiAoKGQudHJhbnNmb3JtIHx8IFtdKS5sZW5ndGggPT09IDAgJiYgIWQuc291cmNlKSB7XG4gICAgICBkYXRhLnNwbGljZSh3aGVyZVRvKyssIDAsIGRhdGEuc3BsaWNlKGksIDEpWzBdKTtcbiAgICB9XG4gIH1cblxuICAvLyBub3cgZml4IHRoZSBmcm9tIHJlZmVyZW5jZXMgaW4gbG9va3VwIHRyYW5zZm9ybXNcbiAgZm9yIChjb25zdCBkIG9mIGRhdGEpIHtcbiAgICBmb3IgKGNvbnN0IHQgb2YgZC50cmFuc2Zvcm0gfHwgW10pIHtcbiAgICAgIGlmICh0LnR5cGUgPT09ICdsb29rdXAnKSB7XG4gICAgICAgIHQuZnJvbSA9IGRhdGFDb21wb25lbnQub3V0cHV0Tm9kZXNbdC5mcm9tXS5nZXRTb3VyY2UoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBpbmxpbmUgdmFsdWVzIGZvciBkYXRhc2V0cyB0aGF0IGFyZSBpbiB0aGUgZGF0YXN0b3JlXG4gIGZvciAoY29uc3QgZCBvZiBkYXRhKSB7XG4gICAgaWYgKGQubmFtZSBpbiBkYXRhc2V0cykge1xuICAgICAgZC52YWx1ZXMgPSBkYXRhc2V0c1tkLm5hbWVdO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBkYXRhO1xufVxuIl19","import * as tslib_1 from \"tslib\";\nimport { isArray } from 'vega-util';\nimport { hasConditionalFieldDef, isConditionalDef, isFieldDef, isRepeatRef } from '../fielddef';\nimport * as log from '../log';\nimport { isSortField } from '../sort';\nexport function replaceRepeaterInFacet(facet, repeater) {\n    return replaceRepeater(facet, repeater);\n}\nexport function replaceRepeaterInEncoding(encoding, repeater) {\n    return replaceRepeater(encoding, repeater);\n}\n/**\n * Replaces repeated value and returns if the repeated value is valid.\n */\nfunction replaceRepeat(o, repeater) {\n    if (isRepeatRef(o.field)) {\n        if (o.field.repeat in repeater) {\n            // any needed to calm down ts compiler\n            return tslib_1.__assign({}, o, { field: repeater[o.field.repeat] });\n        }\n        else {\n            log.warn(log.message.noSuchRepeatedValue(o.field.repeat));\n            return undefined;\n        }\n    }\n    return o;\n}\n/**\n * Replace repeater values in a field def with the concrete field name.\n */\nfunction replaceRepeaterInFieldDef(fieldDef, repeater) {\n    fieldDef = replaceRepeat(fieldDef, repeater);\n    if (fieldDef === undefined) {\n        // the field def should be ignored\n        return undefined;\n    }\n    if (fieldDef.sort && isSortField(fieldDef.sort)) {\n        var sort = replaceRepeat(fieldDef.sort, repeater);\n        fieldDef = tslib_1.__assign({}, fieldDef, (sort ? { sort: sort } : {}));\n    }\n    return fieldDef;\n}\nfunction replaceRepeaterInChannelDef(channelDef, repeater) {\n    if (isFieldDef(channelDef)) {\n        var fd = replaceRepeaterInFieldDef(channelDef, repeater);\n        if (fd) {\n            return fd;\n        }\n        else if (isConditionalDef(channelDef)) {\n            return { condition: channelDef.condition };\n        }\n    }\n    else {\n        if (hasConditionalFieldDef(channelDef)) {\n            var fd = replaceRepeaterInFieldDef(channelDef.condition, repeater);\n            if (fd) {\n                return tslib_1.__assign({}, channelDef, { condition: fd });\n            }\n            else {\n                var condition = channelDef.condition, channelDefWithoutCondition = tslib_1.__rest(channelDef, [\"condition\"]);\n                return channelDefWithoutCondition;\n            }\n        }\n        return channelDef;\n    }\n    return undefined;\n}\nfunction replaceRepeater(mapping, repeater) {\n    var out = {};\n    for (var channel in mapping) {\n        if (mapping.hasOwnProperty(channel)) {\n            var channelDef = mapping[channel];\n            if (isArray(channelDef)) {\n                // array cannot have condition\n                out[channel] = channelDef.map(function (cd) { return replaceRepeaterInChannelDef(cd, repeater); })\n                    .filter(function (cd) { return cd; });\n            }\n            else {\n                var cd = replaceRepeaterInChannelDef(channelDef, repeater);\n                if (cd) {\n                    out[channel] = cd;\n                }\n            }\n        }\n    }\n    return out;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVwZWF0ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29tcGlsZS9yZXBlYXRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUdsQyxPQUFPLEVBQVEsc0JBQXNCLEVBQUUsZ0JBQWdCLEVBQUUsVUFBVSxFQUFFLFdBQVcsRUFBVyxNQUFNLGFBQWEsQ0FBQztBQUUvRyxPQUFPLEtBQUssR0FBRyxNQUFNLFFBQVEsQ0FBQztBQUM5QixPQUFPLEVBQUMsV0FBVyxFQUFDLE1BQU0sU0FBUyxDQUFDO0FBT3BDLE1BQU0saUNBQWlDLEtBQTBCLEVBQUUsUUFBdUI7SUFDeEYsT0FBTyxlQUFlLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBeUIsQ0FBQztBQUNsRSxDQUFDO0FBRUQsTUFBTSxvQ0FBb0MsUUFBeUIsRUFBRSxRQUF1QjtJQUMxRixPQUFPLGVBQWUsQ0FBQyxRQUFRLEVBQUUsUUFBUSxDQUFxQixDQUFDO0FBQ2pFLENBQUM7QUFFRDs7R0FFRztBQUNILHVCQUFrRCxDQUFJLEVBQUUsUUFBdUI7SUFDN0UsSUFBSSxXQUFXLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxFQUFFO1FBQ3hCLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQyxNQUFNLElBQUksUUFBUSxFQUFFO1lBQzlCLHNDQUFzQztZQUN0Qyw0QkFBVyxDQUFRLElBQUUsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFFO1NBQ3ZEO2FBQU07WUFDTCxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1lBQzFELE9BQU8sU0FBUyxDQUFDO1NBQ2xCO0tBQ0Y7SUFDRCxPQUFPLENBQUMsQ0FBQztBQUNYLENBQUM7QUFFRDs7R0FFRztBQUNILG1DQUFtQyxRQUE4QixFQUFFLFFBQXVCO0lBQ3hGLFFBQVEsR0FBRyxhQUFhLENBQUMsUUFBUSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBRTdDLElBQUksUUFBUSxLQUFLLFNBQVMsRUFBRTtRQUMxQixrQ0FBa0M7UUFDbEMsT0FBTyxTQUFTLENBQUM7S0FDbEI7SUFFRCxJQUFJLFFBQVEsQ0FBQyxJQUFJLElBQUksV0FBVyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsRUFBRTtRQUMvQyxJQUFNLElBQUksR0FBRyxhQUFhLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxRQUFRLENBQUMsQ0FBQztRQUNwRCxRQUFRLHdCQUNILFFBQVEsRUFDUixDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBQyxJQUFJLE1BQUEsRUFBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FDeEIsQ0FBQztLQUNIO0lBRUQsT0FBTyxRQUFpQyxDQUFDO0FBQzNDLENBQUM7QUFFRCxxQ0FBcUMsVUFBNkIsRUFBRSxRQUF1QjtJQUN6RixJQUFJLFVBQVUsQ0FBQyxVQUFVLENBQUMsRUFBRTtRQUMxQixJQUFNLEVBQUUsR0FBRyx5QkFBeUIsQ0FBQyxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDM0QsSUFBSSxFQUFFLEVBQUU7WUFDTixPQUFPLEVBQUUsQ0FBQztTQUNYO2FBQU0sSUFBSSxnQkFBZ0IsQ0FBQyxVQUFVLENBQUMsRUFBRTtZQUN2QyxPQUFPLEVBQUMsU0FBUyxFQUFFLFVBQVUsQ0FBQyxTQUFTLEVBQUMsQ0FBQztTQUMxQztLQUNGO1NBQU07UUFDTCxJQUFJLHNCQUFzQixDQUFDLFVBQVUsQ0FBQyxFQUFFO1lBQ3RDLElBQU0sRUFBRSxHQUFHLHlCQUF5QixDQUFDLFVBQVUsQ0FBQyxTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDckUsSUFBSSxFQUFFLEVBQUU7Z0JBQ04sT0FBTyxxQkFDRixVQUFVLElBQ2IsU0FBUyxFQUFFLEVBQUUsR0FDUSxDQUFDO2FBQ3pCO2lCQUFNO2dCQUNFLElBQUEsZ0NBQVMsRUFBRSxzRUFBNkIsQ0FBZTtnQkFDOUQsT0FBTywwQkFBZ0QsQ0FBQzthQUN6RDtTQUNGO1FBQ0QsT0FBTyxVQUFzQixDQUFDO0tBQy9CO0lBQ0QsT0FBTyxTQUFTLENBQUM7QUFDbkIsQ0FBQztBQUlELHlCQUF5QixPQUErQixFQUFFLFFBQXVCO0lBQy9FLElBQU0sR0FBRyxHQUE0QixFQUFFLENBQUM7SUFDeEMsS0FBSyxJQUFNLE9BQU8sSUFBSSxPQUFPLEVBQUU7UUFDN0IsSUFBSSxPQUFPLENBQUMsY0FBYyxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ25DLElBQU0sVUFBVSxHQUE0QyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7WUFFN0UsSUFBSSxPQUFPLENBQUMsVUFBVSxDQUFDLEVBQUU7Z0JBQ3ZCLDhCQUE4QjtnQkFDOUIsR0FBRyxDQUFDLE9BQU8sQ0FBQyxHQUFHLFVBQVUsQ0FBQyxHQUFHLENBQUMsVUFBQSxFQUFFLElBQUksT0FBQSwyQkFBMkIsQ0FBQyxFQUFFLEVBQUUsUUFBUSxDQUFDLEVBQXpDLENBQXlDLENBQUM7cUJBQzNFLE1BQU0sQ0FBQyxVQUFBLEVBQUUsSUFBSSxPQUFBLEVBQUUsRUFBRixDQUFFLENBQUMsQ0FBQzthQUNyQjtpQkFBTTtnQkFDTCxJQUFNLEVBQUUsR0FBRywyQkFBMkIsQ0FBQyxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUM7Z0JBQzdELElBQUksRUFBRSxFQUFFO29CQUNOLEdBQUcsQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLENBQUM7aUJBQ25CO2FBQ0Y7U0FDRjtLQUNGO0lBQ0QsT0FBTyxHQUFHLENBQUM7QUFDYixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtpc0FycmF5fSBmcm9tICd2ZWdhLXV0aWwnO1xuaW1wb3J0IHtFbmNvZGluZ30gZnJvbSAnLi4vZW5jb2RpbmcnO1xuaW1wb3J0IHtGYWNldE1hcHBpbmd9IGZyb20gJy4uL2ZhY2V0JztcbmltcG9ydCB7RmllbGQsIGhhc0NvbmRpdGlvbmFsRmllbGREZWYsIGlzQ29uZGl0aW9uYWxEZWYsIGlzRmllbGREZWYsIGlzUmVwZWF0UmVmLCBWYWx1ZURlZn0gZnJvbSAnLi4vZmllbGRkZWYnO1xuaW1wb3J0IHtDaGFubmVsRGVmLCBTY2FsZUZpZWxkRGVmfSBmcm9tICcuLi9maWVsZGRlZic7XG5pbXBvcnQgKiBhcyBsb2cgZnJvbSAnLi4vbG9nJztcbmltcG9ydCB7aXNTb3J0RmllbGR9IGZyb20gJy4uL3NvcnQnO1xuXG5leHBvcnQgdHlwZSBSZXBlYXRlclZhbHVlID0ge1xuICByb3c/OiBzdHJpbmcsXG4gIGNvbHVtbj86IHN0cmluZ1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlcGxhY2VSZXBlYXRlckluRmFjZXQoZmFjZXQ6IEZhY2V0TWFwcGluZzxGaWVsZD4sIHJlcGVhdGVyOiBSZXBlYXRlclZhbHVlKTogRmFjZXRNYXBwaW5nPHN0cmluZz4ge1xuICByZXR1cm4gcmVwbGFjZVJlcGVhdGVyKGZhY2V0LCByZXBlYXRlcikgYXMgRmFjZXRNYXBwaW5nPHN0cmluZz47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlUmVwZWF0ZXJJbkVuY29kaW5nKGVuY29kaW5nOiBFbmNvZGluZzxGaWVsZD4sIHJlcGVhdGVyOiBSZXBlYXRlclZhbHVlKTogRW5jb2Rpbmc8c3RyaW5nPiB7XG4gIHJldHVybiByZXBsYWNlUmVwZWF0ZXIoZW5jb2RpbmcsIHJlcGVhdGVyKSBhcyBFbmNvZGluZzxzdHJpbmc+O1xufVxuXG4vKipcbiAqIFJlcGxhY2VzIHJlcGVhdGVkIHZhbHVlIGFuZCByZXR1cm5zIGlmIHRoZSByZXBlYXRlZCB2YWx1ZSBpcyB2YWxpZC5cbiAqL1xuZnVuY3Rpb24gcmVwbGFjZVJlcGVhdDxUIGV4dGVuZHMge2ZpZWxkPzogRmllbGR9PihvOiBULCByZXBlYXRlcjogUmVwZWF0ZXJWYWx1ZSk6IFQge1xuICBpZiAoaXNSZXBlYXRSZWYoby5maWVsZCkpIHtcbiAgICBpZiAoby5maWVsZC5yZXBlYXQgaW4gcmVwZWF0ZXIpIHtcbiAgICAgIC8vIGFueSBuZWVkZWQgdG8gY2FsbSBkb3duIHRzIGNvbXBpbGVyXG4gICAgICByZXR1cm4gey4uLm8gYXMgYW55LCBmaWVsZDogcmVwZWF0ZXJbby5maWVsZC5yZXBlYXRdfTtcbiAgICB9IGVsc2Uge1xuICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2Uubm9TdWNoUmVwZWF0ZWRWYWx1ZShvLmZpZWxkLnJlcGVhdCkpO1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG87XG59XG5cbi8qKlxuICogUmVwbGFjZSByZXBlYXRlciB2YWx1ZXMgaW4gYSBmaWVsZCBkZWYgd2l0aCB0aGUgY29uY3JldGUgZmllbGQgbmFtZS5cbiAqL1xuZnVuY3Rpb24gcmVwbGFjZVJlcGVhdGVySW5GaWVsZERlZihmaWVsZERlZjogU2NhbGVGaWVsZERlZjxGaWVsZD4sIHJlcGVhdGVyOiBSZXBlYXRlclZhbHVlKTogU2NhbGVGaWVsZERlZjxzdHJpbmc+IHtcbiAgZmllbGREZWYgPSByZXBsYWNlUmVwZWF0KGZpZWxkRGVmLCByZXBlYXRlcik7XG5cbiAgaWYgKGZpZWxkRGVmID09PSB1bmRlZmluZWQpIHtcbiAgICAvLyB0aGUgZmllbGQgZGVmIHNob3VsZCBiZSBpZ25vcmVkXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIGlmIChmaWVsZERlZi5zb3J0ICYmIGlzU29ydEZpZWxkKGZpZWxkRGVmLnNvcnQpKSB7XG4gICAgY29uc3Qgc29ydCA9IHJlcGxhY2VSZXBlYXQoZmllbGREZWYuc29ydCwgcmVwZWF0ZXIpO1xuICAgIGZpZWxkRGVmID0ge1xuICAgICAgLi4uZmllbGREZWYsXG4gICAgICAuLi4oc29ydCA/IHtzb3J0fSA6IHt9KVxuICAgIH07XG4gIH1cblxuICByZXR1cm4gZmllbGREZWYgYXMgU2NhbGVGaWVsZERlZjxzdHJpbmc+O1xufVxuXG5mdW5jdGlvbiByZXBsYWNlUmVwZWF0ZXJJbkNoYW5uZWxEZWYoY2hhbm5lbERlZjogQ2hhbm5lbERlZjxGaWVsZD4sIHJlcGVhdGVyOiBSZXBlYXRlclZhbHVlKTogQ2hhbm5lbERlZjxzdHJpbmc+IHtcbiAgaWYgKGlzRmllbGREZWYoY2hhbm5lbERlZikpIHtcbiAgICBjb25zdCBmZCA9IHJlcGxhY2VSZXBlYXRlckluRmllbGREZWYoY2hhbm5lbERlZiwgcmVwZWF0ZXIpO1xuICAgIGlmIChmZCkge1xuICAgICAgcmV0dXJuIGZkO1xuICAgIH0gZWxzZSBpZiAoaXNDb25kaXRpb25hbERlZihjaGFubmVsRGVmKSkge1xuICAgICAgcmV0dXJuIHtjb25kaXRpb246IGNoYW5uZWxEZWYuY29uZGl0aW9ufTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaWYgKGhhc0NvbmRpdGlvbmFsRmllbGREZWYoY2hhbm5lbERlZikpIHtcbiAgICAgIGNvbnN0IGZkID0gcmVwbGFjZVJlcGVhdGVySW5GaWVsZERlZihjaGFubmVsRGVmLmNvbmRpdGlvbiwgcmVwZWF0ZXIpO1xuICAgICAgaWYgKGZkKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4uY2hhbm5lbERlZixcbiAgICAgICAgICBjb25kaXRpb246IGZkXG4gICAgICAgIH0gYXMgQ2hhbm5lbERlZjxzdHJpbmc+O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3Qge2NvbmRpdGlvbiwgLi4uY2hhbm5lbERlZldpdGhvdXRDb25kaXRpb259ID0gY2hhbm5lbERlZjtcbiAgICAgICAgcmV0dXJuIGNoYW5uZWxEZWZXaXRob3V0Q29uZGl0aW9uIGFzIENoYW5uZWxEZWY8c3RyaW5nPjtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNoYW5uZWxEZWYgYXMgVmFsdWVEZWY7XG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxudHlwZSBFbmNvZGluZ09yRmFjZXQ8Rj4gPSBFbmNvZGluZzxGPiB8IEZhY2V0TWFwcGluZzxGPjtcblxuZnVuY3Rpb24gcmVwbGFjZVJlcGVhdGVyKG1hcHBpbmc6IEVuY29kaW5nT3JGYWNldDxGaWVsZD4sIHJlcGVhdGVyOiBSZXBlYXRlclZhbHVlKTogRW5jb2RpbmdPckZhY2V0PHN0cmluZz4ge1xuICBjb25zdCBvdXQ6IEVuY29kaW5nT3JGYWNldDxzdHJpbmc+ID0ge307XG4gIGZvciAoY29uc3QgY2hhbm5lbCBpbiBtYXBwaW5nKSB7XG4gICAgaWYgKG1hcHBpbmcuaGFzT3duUHJvcGVydHkoY2hhbm5lbCkpIHtcbiAgICAgIGNvbnN0IGNoYW5uZWxEZWY6IENoYW5uZWxEZWY8RmllbGQ+IHwgQ2hhbm5lbERlZjxGaWVsZD5bXSA9IG1hcHBpbmdbY2hhbm5lbF07XG5cbiAgICAgIGlmIChpc0FycmF5KGNoYW5uZWxEZWYpKSB7XG4gICAgICAgIC8vIGFycmF5IGNhbm5vdCBoYXZlIGNvbmRpdGlvblxuICAgICAgICBvdXRbY2hhbm5lbF0gPSBjaGFubmVsRGVmLm1hcChjZCA9PiByZXBsYWNlUmVwZWF0ZXJJbkNoYW5uZWxEZWYoY2QsIHJlcGVhdGVyKSlcbiAgICAgICAgICAuZmlsdGVyKGNkID0+IGNkKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGNkID0gcmVwbGFjZVJlcGVhdGVySW5DaGFubmVsRGVmKGNoYW5uZWxEZWYsIHJlcGVhdGVyKTtcbiAgICAgICAgaWYgKGNkKSB7XG4gICAgICAgICAgb3V0W2NoYW5uZWxdID0gY2Q7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIG91dDtcbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { COLUMN, ROW } from '../channel';\nimport { reduce } from '../encoding';\nimport { normalize, title as fieldDefTitle, vgField } from '../fielddef';\nimport * as log from '../log';\nimport { hasDiscreteDomain } from '../scale';\nimport { contains } from '../util';\nimport { isVgRangeStep } from '../vega.schema';\nimport { assembleAxis } from './axis/assemble';\nimport { buildModel } from './buildmodel';\nimport { assembleFacetData } from './data/assemble';\nimport { parseData } from './data/parse';\nimport { getHeaderType } from './layout/header';\nimport { parseChildrenLayoutSize } from './layoutsize/parse';\nimport { ModelWithField } from './model';\nimport { replaceRepeaterInFacet } from './repeater';\nimport { parseGuideResolve } from './resolve';\nimport { assembleDomain, getFieldFromDomain } from './scale/domain';\nvar FacetModel = /** @class */ (function (_super) {\n    tslib_1.__extends(FacetModel, _super);\n    function FacetModel(spec, parent, parentGivenName, repeater, config) {\n        var _this = _super.call(this, spec, parent, parentGivenName, config, repeater, spec.resolve) || this;\n        _this.type = 'facet';\n        _this.child = buildModel(spec.spec, _this, _this.getName('child'), undefined, repeater, config, false);\n        _this.children = [_this.child];\n        var facet = replaceRepeaterInFacet(spec.facet, repeater);\n        _this.facet = _this.initFacet(facet);\n        return _this;\n    }\n    FacetModel.prototype.initFacet = function (facet) {\n        // clone to prevent side effect to the original spec\n        return reduce(facet, function (normalizedFacet, fieldDef, channel) {\n            if (!contains([ROW, COLUMN], channel)) {\n                // Drop unsupported channel\n                log.warn(log.message.incompatibleChannel(channel, 'facet'));\n                return normalizedFacet;\n            }\n            if (fieldDef.field === undefined) {\n                log.warn(log.message.emptyFieldDef(fieldDef, channel));\n                return normalizedFacet;\n            }\n            // Convert type to full, lowercase type, or augment the fieldDef with a default type if missing.\n            normalizedFacet[channel] = normalize(fieldDef, channel);\n            return normalizedFacet;\n        }, {});\n    };\n    FacetModel.prototype.channelHasField = function (channel) {\n        return !!this.facet[channel];\n    };\n    FacetModel.prototype.fieldDef = function (channel) {\n        return this.facet[channel];\n    };\n    FacetModel.prototype.parseData = function () {\n        this.component.data = parseData(this);\n        this.child.parseData();\n    };\n    FacetModel.prototype.parseLayoutSize = function () {\n        parseChildrenLayoutSize(this);\n    };\n    FacetModel.prototype.parseSelection = function () {\n        // As a facet has a single child, the selection components are the same.\n        // The child maintains its selections to assemble signals, which remain\n        // within its unit.\n        this.child.parseSelection();\n        this.component.selection = this.child.component.selection;\n    };\n    FacetModel.prototype.parseMarkGroup = function () {\n        this.child.parseMarkGroup();\n    };\n    FacetModel.prototype.parseAxisAndHeader = function () {\n        this.child.parseAxisAndHeader();\n        this.parseHeader('column');\n        this.parseHeader('row');\n        this.mergeChildAxis('x');\n        this.mergeChildAxis('y');\n    };\n    FacetModel.prototype.parseHeader = function (channel) {\n        if (this.channelHasField(channel)) {\n            var fieldDef = this.facet[channel];\n            var header = fieldDef.header || {};\n            var title = fieldDef.title !== undefined ? fieldDef.title :\n                header.title !== undefined ? header.title : fieldDefTitle(fieldDef, this.config);\n            if (this.child.component.layoutHeaders[channel].title) {\n                // merge title with child to produce \"Title / Subtitle / Sub-subtitle\"\n                title += ' / ' + this.child.component.layoutHeaders[channel].title;\n                this.child.component.layoutHeaders[channel].title = null;\n            }\n            this.component.layoutHeaders[channel] = {\n                title: title,\n                facetFieldDef: fieldDef,\n                // TODO: support adding label to footer as well\n                header: [this.makeHeaderComponent(channel, true)]\n            };\n        }\n    };\n    FacetModel.prototype.makeHeaderComponent = function (channel, labels) {\n        var sizeType = channel === 'row' ? 'height' : 'width';\n        return {\n            labels: labels,\n            sizeSignal: this.child.component.layoutSize.get(sizeType) ? this.child.getSizeSignalRef(sizeType) : undefined,\n            axes: []\n        };\n    };\n    FacetModel.prototype.mergeChildAxis = function (channel) {\n        var child = this.child;\n        if (child.component.axes[channel]) {\n            var _a = this.component, layoutHeaders = _a.layoutHeaders, resolve = _a.resolve;\n            resolve.axis[channel] = parseGuideResolve(resolve, channel);\n            if (resolve.axis[channel] === 'shared') {\n                // For shared axis, move the axes to facet's header or footer\n                var headerChannel = channel === 'x' ? 'column' : 'row';\n                var layoutHeader = layoutHeaders[headerChannel];\n                for (var _i = 0, _b = child.component.axes[channel]; _i < _b.length; _i++) {\n                    var axisComponent = _b[_i];\n                    var headerType = getHeaderType(axisComponent.get('orient'));\n                    layoutHeader[headerType] = layoutHeader[headerType] ||\n                        [this.makeHeaderComponent(headerChannel, false)];\n                    var mainAxis = assembleAxis(axisComponent, 'main', this.config, { header: true });\n                    // LayoutHeader no longer keep track of property precedence, thus let's combine.\n                    layoutHeader[headerType][0].axes.push(mainAxis);\n                    axisComponent.mainExtracted = true;\n                }\n            }\n            else {\n                // Otherwise do nothing for independent axes\n            }\n        }\n    };\n    FacetModel.prototype.assembleSelectionTopLevelSignals = function (signals) {\n        return this.child.assembleSelectionTopLevelSignals(signals);\n    };\n    FacetModel.prototype.assembleSelectionSignals = function () {\n        this.child.assembleSelectionSignals();\n        return [];\n    };\n    FacetModel.prototype.assembleSelectionData = function (data) {\n        return this.child.assembleSelectionData(data);\n    };\n    FacetModel.prototype.getLayoutBandMixins = function (headerType) {\n        var bandMixins = {};\n        var bandType = headerType === 'header' ? 'headerBand' : 'footerBand';\n        for (var _i = 0, _a = ['row', 'column']; _i < _a.length; _i++) {\n            var channel = _a[_i];\n            var layoutHeaderComponent = this.component.layoutHeaders[channel];\n            var headerComponent = layoutHeaderComponent[headerType];\n            if (headerComponent && headerComponent[0]) {\n                var sizeType = channel === 'row' ? 'height' : 'width';\n                if (!this.child.component.layoutSize.get(sizeType)) {\n                    // If facet child does not have size signal, then apply headerBand\n                    bandMixins[bandType] = bandMixins[bandType] || {};\n                    bandMixins[bandType][channel] = 0.5;\n                }\n            }\n        }\n        return bandMixins;\n    };\n    FacetModel.prototype.assembleLayout = function () {\n        var columns = this.channelHasField('column') ? this.columnDistinctSignal() : 1;\n        // TODO: determine default align based on shared / independent scales\n        return tslib_1.__assign({ padding: { row: 10, column: 10 } }, this.getLayoutBandMixins('header'), this.getLayoutBandMixins('footer'), { \n            // TODO: support offset for rowHeader/rowFooter/rowTitle/columnHeader/columnFooter/columnTitle\n            offset: 10, columns: columns, bounds: 'full', align: 'all' });\n    };\n    FacetModel.prototype.assembleLayoutSignals = function () {\n        // FIXME(https://github.com/vega/vega-lite/issues/1193): this can be incorrect if we have independent scales.\n        return this.child.assembleLayoutSignals();\n    };\n    FacetModel.prototype.columnDistinctSignal = function () {\n        if (this.parent && (this.parent instanceof FacetModel)) {\n            // For nested facet, we will add columns to group mark instead\n            // See discussion in https://github.com/vega/vega/issues/952\n            // and https://github.com/vega/vega-view/releases/tag/v1.2.6\n            return undefined;\n        }\n        else {\n            // In facetNode.assemble(), the name is always this.getName('column') + '_layout'.\n            var facetLayoutDataName = this.getName('column_domain');\n            return { signal: \"length(data('\" + facetLayoutDataName + \"'))\" };\n        }\n    };\n    FacetModel.prototype.assembleGroup = function (signals) {\n        if (this.parent && (this.parent instanceof FacetModel)) {\n            // Provide number of columns for layout.\n            // See discussion in https://github.com/vega/vega/issues/952\n            // and https://github.com/vega/vega-view/releases/tag/v1.2.6\n            return tslib_1.__assign({}, (this.channelHasField('column') ? {\n                encode: {\n                    update: {\n                        // TODO(https://github.com/vega/vega-lite/issues/2759):\n                        // Correct the signal for facet of concat of facet_column\n                        columns: { field: vgField(this.facet.column, { prefix: 'distinct' }) }\n                    }\n                }\n            } : {}), _super.prototype.assembleGroup.call(this, signals));\n        }\n        return _super.prototype.assembleGroup.call(this, signals);\n    };\n    /**\n     * Aggregate cardinality for calculating size\n     */\n    FacetModel.prototype.getCardinalityAggregateForChild = function () {\n        var fields = [];\n        var ops = [];\n        if (this.child instanceof FacetModel) {\n            if (this.child.channelHasField('column')) {\n                fields.push(vgField(this.child.facet.column));\n                ops.push('distinct');\n            }\n        }\n        else {\n            for (var _i = 0, _a = ['x', 'y']; _i < _a.length; _i++) {\n                var channel = _a[_i];\n                var childScaleComponent = this.child.component.scales[channel];\n                if (childScaleComponent && !childScaleComponent.merged) {\n                    var type = childScaleComponent.get('type');\n                    var range = childScaleComponent.get('range');\n                    if (hasDiscreteDomain(type) && isVgRangeStep(range)) {\n                        var domain = assembleDomain(this.child, channel);\n                        var field = getFieldFromDomain(domain);\n                        if (field) {\n                            fields.push(field);\n                            ops.push('distinct');\n                        }\n                        else {\n                            log.warn('Unknown field for ${channel}.  Cannot calculate view size.');\n                        }\n                    }\n                }\n            }\n        }\n        return fields.length ? { fields: fields, ops: ops } : undefined;\n    };\n    FacetModel.prototype.assembleMarks = function () {\n        var _a = this, child = _a.child, facet = _a.facet;\n        var facetRoot = this.component.data.facetRoot;\n        var data = assembleFacetData(facetRoot);\n        // If we facet by two dimensions, we need to add a cross operator to the aggregation\n        // so that we create all groups\n        var hasRow = this.channelHasField(ROW);\n        var hasColumn = this.channelHasField(COLUMN);\n        var layoutSizeEncodeEntry = child.assembleLayoutSize();\n        var aggregateMixins = {};\n        if (hasRow && hasColumn) {\n            aggregateMixins.aggregate = { cross: true };\n        }\n        var cardinalityAggregateForChild = this.getCardinalityAggregateForChild();\n        if (cardinalityAggregateForChild) {\n            aggregateMixins.aggregate = tslib_1.__assign({}, aggregateMixins.aggregate, cardinalityAggregateForChild);\n        }\n        var title = child.assembleTitle();\n        var style = child.assembleGroupStyle();\n        var markGroup = tslib_1.__assign({ name: this.getName('cell'), type: 'group' }, (title ? { title: title } : {}), (style ? { style: style } : {}), { from: {\n                facet: tslib_1.__assign({ name: facetRoot.name, data: facetRoot.data, groupby: [].concat(hasRow ? [this.vgField(ROW)] : [], hasColumn ? [this.vgField(COLUMN)] : []) }, aggregateMixins)\n            }, sort: {\n                field: [].concat(hasRow ? [this.vgField(ROW, { expr: 'datum', })] : [], hasColumn ? [this.vgField(COLUMN, { expr: 'datum' })] : []),\n                order: [].concat(hasRow ? [(facet.row.sort) || 'ascending'] : [], hasColumn ? [(facet.column.sort) || 'ascending'] : [])\n            } }, (data.length > 0 ? { data: data } : {}), (layoutSizeEncodeEntry ? { encode: { update: layoutSizeEncodeEntry } } : {}), child.assembleGroup());\n        return [markGroup];\n    };\n    FacetModel.prototype.getMapping = function () {\n        return this.facet;\n    };\n    return FacetModel;\n}(ModelWithField));\nexport { FacetModel };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmFjZXQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29tcGlsZS9mYWNldC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQ0EsT0FBTyxFQUFVLE1BQU0sRUFBRSxHQUFHLEVBQWUsTUFBTSxZQUFZLENBQUM7QUFFOUQsT0FBTyxFQUFDLE1BQU0sRUFBQyxNQUFNLGFBQWEsQ0FBQztBQUVuQyxPQUFPLEVBQVcsU0FBUyxFQUFFLEtBQUssSUFBSSxhQUFhLEVBQUUsT0FBTyxFQUFDLE1BQU0sYUFBYSxDQUFDO0FBQ2pGLE9BQU8sS0FBSyxHQUFHLE1BQU0sUUFBUSxDQUFDO0FBQzlCLE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLFVBQVUsQ0FBQztBQUUzQyxPQUFPLEVBQUMsUUFBUSxFQUFDLE1BQU0sU0FBUyxDQUFDO0FBQ2pDLE9BQU8sRUFBQyxhQUFhLEVBQTBELE1BQU0sZ0JBQWdCLENBQUM7QUFDdEcsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLGlCQUFpQixDQUFDO0FBQzdDLE9BQU8sRUFBQyxVQUFVLEVBQUMsTUFBTSxjQUFjLENBQUM7QUFDeEMsT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFDbEQsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLGNBQWMsQ0FBQztBQUN2QyxPQUFPLEVBQUMsYUFBYSxFQUFpQyxNQUFNLGlCQUFpQixDQUFDO0FBQzlFLE9BQU8sRUFBQyx1QkFBdUIsRUFBQyxNQUFNLG9CQUFvQixDQUFDO0FBQzNELE9BQU8sRUFBUSxjQUFjLEVBQUMsTUFBTSxTQUFTLENBQUM7QUFDOUMsT0FBTyxFQUFnQixzQkFBc0IsRUFBQyxNQUFNLFlBQVksQ0FBQztBQUNqRSxPQUFPLEVBQUMsaUJBQWlCLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDNUMsT0FBTyxFQUFDLGNBQWMsRUFBRSxrQkFBa0IsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBRWxFO0lBQWdDLHNDQUFjO0lBUTVDLG9CQUFZLElBQXlCLEVBQUUsTUFBYSxFQUFFLGVBQXVCLEVBQUUsUUFBdUIsRUFBRSxNQUFjO1FBQXRILFlBQ0Usa0JBQU0sSUFBSSxFQUFFLE1BQU0sRUFBRSxlQUFlLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLFNBU3JFO1FBakJlLFVBQUksR0FBWSxPQUFPLENBQUM7UUFXdEMsS0FBSSxDQUFDLEtBQUssR0FBRyxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxLQUFJLEVBQUUsS0FBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNwRyxLQUFJLENBQUMsUUFBUSxHQUFHLENBQUMsS0FBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBRTdCLElBQU0sS0FBSyxHQUF5QixzQkFBc0IsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBRWpGLEtBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQzs7SUFDckMsQ0FBQztJQUVPLDhCQUFTLEdBQWpCLFVBQWtCLEtBQTJCO1FBQzNDLG9EQUFvRDtRQUNwRCxPQUFPLE1BQU0sQ0FBQyxLQUFLLEVBQUUsVUFBUyxlQUFlLEVBQUUsUUFBMEIsRUFBRSxPQUFnQjtZQUN6RixJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxFQUFFLE9BQU8sQ0FBQyxFQUFFO2dCQUNyQywyQkFBMkI7Z0JBQzNCLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQztnQkFDNUQsT0FBTyxlQUFlLENBQUM7YUFDeEI7WUFFRCxJQUFJLFFBQVEsQ0FBQyxLQUFLLEtBQUssU0FBUyxFQUFFO2dCQUNoQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDO2dCQUN2RCxPQUFPLGVBQWUsQ0FBQzthQUN4QjtZQUVELGdHQUFnRztZQUNoRyxlQUFlLENBQUMsT0FBTyxDQUFDLEdBQUcsU0FBUyxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQztZQUN4RCxPQUFPLGVBQWUsQ0FBQztRQUN6QixDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7SUFDVCxDQUFDO0lBRU0sb0NBQWUsR0FBdEIsVUFBdUIsT0FBZ0I7UUFDckMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUMvQixDQUFDO0lBRU0sNkJBQVEsR0FBZixVQUFnQixPQUFnQjtRQUM5QixPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDN0IsQ0FBQztJQUVNLDhCQUFTLEdBQWhCO1FBQ0UsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLEdBQUcsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3RDLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDekIsQ0FBQztJQUVNLG9DQUFlLEdBQXRCO1FBQ0UsdUJBQXVCLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDaEMsQ0FBQztJQUVNLG1DQUFjLEdBQXJCO1FBQ0Usd0VBQXdFO1FBQ3hFLHVFQUF1RTtRQUN2RSxtQkFBbUI7UUFDbkIsSUFBSSxDQUFDLEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQztRQUM1QixJQUFJLENBQUMsU0FBUyxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUM7SUFDNUQsQ0FBQztJQUVNLG1DQUFjLEdBQXJCO1FBQ0UsSUFBSSxDQUFDLEtBQUssQ0FBQyxjQUFjLEVBQUUsQ0FBQztJQUM5QixDQUFDO0lBRU0sdUNBQWtCLEdBQXpCO1FBQ0UsSUFBSSxDQUFDLEtBQUssQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1FBRWhDLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDM0IsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUV4QixJQUFJLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3pCLElBQUksQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDM0IsQ0FBQztJQUVPLGdDQUFXLEdBQW5CLFVBQW9CLE9BQXNCO1FBRXhDLElBQUksSUFBSSxDQUFDLGVBQWUsQ0FBQyxPQUFPLENBQUMsRUFBRTtZQUNqQyxJQUFNLFFBQVEsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3JDLElBQU0sTUFBTSxHQUFHLFFBQVEsQ0FBQyxNQUFNLElBQUksRUFBRSxDQUFDO1lBQ3JDLElBQUksS0FBSyxHQUFHLFFBQVEsQ0FBQyxLQUFLLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUM7Z0JBQ3pELE1BQU0sQ0FBQyxLQUFLLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUVuRixJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxLQUFLLEVBQUU7Z0JBQ3JELHNFQUFzRTtnQkFDdEUsS0FBSyxJQUFJLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDO2dCQUNuRSxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQzthQUMxRDtZQUVELElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxHQUFHO2dCQUN0QyxLQUFLLE9BQUE7Z0JBQ0wsYUFBYSxFQUFFLFFBQVE7Z0JBQ3ZCLCtDQUErQztnQkFDL0MsTUFBTSxFQUFFLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQzthQUNsRCxDQUFDO1NBQ0g7SUFDSCxDQUFDO0lBRU8sd0NBQW1CLEdBQTNCLFVBQTRCLE9BQXNCLEVBQUUsTUFBZTtRQUNqRSxJQUFNLFFBQVEsR0FBRyxPQUFPLEtBQUssS0FBSyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQztRQUV4RCxPQUFPO1lBQ0wsTUFBTSxRQUFBO1lBQ04sVUFBVSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVM7WUFDN0csSUFBSSxFQUFFLEVBQUU7U0FDVCxDQUFDO0lBQ0osQ0FBQztJQUVPLG1DQUFjLEdBQXRCLFVBQXVCLE9BQWtCO1FBQ2hDLElBQUEsa0JBQUssQ0FBUztRQUNyQixJQUFJLEtBQUssQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQzNCLElBQUEsbUJBQXlDLEVBQXhDLGdDQUFhLEVBQUUsb0JBQU8sQ0FBbUI7WUFDaEQsT0FBTyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxpQkFBaUIsQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7WUFFNUQsSUFBSSxPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLFFBQVEsRUFBRTtnQkFDdEMsNkRBQTZEO2dCQUM3RCxJQUFNLGFBQWEsR0FBRyxPQUFPLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQztnQkFFekQsSUFBTSxZQUFZLEdBQUcsYUFBYSxDQUFDLGFBQWEsQ0FBQyxDQUFDO2dCQUNsRCxLQUE0QixVQUE2QixFQUE3QixLQUFBLEtBQUssQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUE3QixjQUE2QixFQUE3QixJQUE2QixFQUFFO29CQUF0RCxJQUFNLGFBQWEsU0FBQTtvQkFDdEIsSUFBTSxVQUFVLEdBQUcsYUFBYSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztvQkFDOUQsWUFBWSxDQUFDLFVBQVUsQ0FBQyxHQUFHLFlBQVksQ0FBQyxVQUFVLENBQUM7d0JBQ25ELENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLGFBQWEsRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDO29CQUVqRCxJQUFNLFFBQVEsR0FBRyxZQUFZLENBQUMsYUFBYSxFQUFFLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBQyxDQUFDLENBQUM7b0JBQ2xGLGdGQUFnRjtvQkFDaEYsWUFBWSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7b0JBQ2hELGFBQWEsQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDO2lCQUNwQzthQUNGO2lCQUFNO2dCQUNMLDRDQUE0QzthQUM3QztTQUNGO0lBQ0gsQ0FBQztJQUVNLHFEQUFnQyxHQUF2QyxVQUF3QyxPQUFjO1FBQ3BELE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxnQ0FBZ0MsQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUM5RCxDQUFDO0lBRU0sNkNBQXdCLEdBQS9CO1FBQ0UsSUFBSSxDQUFDLEtBQUssQ0FBQyx3QkFBd0IsRUFBRSxDQUFDO1FBQ3RDLE9BQU8sRUFBRSxDQUFDO0lBQ1osQ0FBQztJQUVNLDBDQUFxQixHQUE1QixVQUE2QixJQUFjO1FBQ3pDLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxxQkFBcUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNoRCxDQUFDO0lBRU8sd0NBQW1CLEdBQTNCLFVBQTRCLFVBQStCO1FBSXpELElBQU0sVUFBVSxHQUFHLEVBQUUsQ0FBQztRQUV0QixJQUFNLFFBQVEsR0FBRyxVQUFVLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLFlBQVksQ0FBQztRQUV2RSxLQUFzQixVQUF5QyxFQUF6QyxLQUFBLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBeUIsRUFBekMsY0FBeUMsRUFBekMsSUFBeUMsRUFBRTtZQUE1RCxJQUFNLE9BQU8sU0FBQTtZQUNoQixJQUFNLHFCQUFxQixHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3BFLElBQU0sZUFBZSxHQUFHLHFCQUFxQixDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQzFELElBQUksZUFBZSxJQUFJLGVBQWUsQ0FBQyxDQUFDLENBQUMsRUFBRTtnQkFDekMsSUFBTSxRQUFRLEdBQUcsT0FBTyxLQUFLLEtBQUssQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUM7Z0JBRXhELElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxFQUFFO29CQUNsRCxrRUFBa0U7b0JBQ2xFLFVBQVUsQ0FBQyxRQUFRLENBQUMsR0FBRyxVQUFVLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDO29CQUNsRCxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsR0FBRyxDQUFDO2lCQUNyQzthQUNGO1NBQ0Y7UUFDRCxPQUFPLFVBQVUsQ0FBQztJQUNwQixDQUFDO0lBRU0sbUNBQWMsR0FBckI7UUFDRSxJQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRWpGLHFFQUFxRTtRQUVyRSwwQkFDRSxPQUFPLEVBQUUsRUFBQyxHQUFHLEVBQUUsRUFBRSxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUMsSUFDM0IsSUFBSSxDQUFDLG1CQUFtQixDQUFDLFFBQVEsQ0FBQyxFQUNsQyxJQUFJLENBQUMsbUJBQW1CLENBQUMsUUFBUSxDQUFDO1lBRXJDLDhGQUE4RjtZQUM5RixNQUFNLEVBQUUsRUFBRSxFQUNWLE9BQU8sU0FBQSxFQUNQLE1BQU0sRUFBRSxNQUFNLEVBQ2QsS0FBSyxFQUFFLEtBQUssSUFDWjtJQUNKLENBQUM7SUFFTSwwQ0FBcUIsR0FBNUI7UUFDRSw2R0FBNkc7UUFDN0csT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLHFCQUFxQixFQUFFLENBQUM7SUFDNUMsQ0FBQztJQUVPLHlDQUFvQixHQUE1QjtRQUNFLElBQUksSUFBSSxDQUFDLE1BQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLFlBQVksVUFBVSxDQUFDLEVBQUU7WUFDdEQsOERBQThEO1lBQzlELDREQUE0RDtZQUM1RCw0REFBNEQ7WUFDNUQsT0FBTyxTQUFTLENBQUM7U0FDbEI7YUFBTTtZQUNMLGtGQUFrRjtZQUNsRixJQUFNLG1CQUFtQixHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsZUFBZSxDQUFDLENBQUM7WUFDMUQsT0FBTyxFQUFDLE1BQU0sRUFBRSxrQkFBZ0IsbUJBQW1CLFFBQUssRUFBQyxDQUFDO1NBQzNEO0lBQ0gsQ0FBQztJQUVNLGtDQUFhLEdBQXBCLFVBQXFCLE9BQW1CO1FBQ3RDLElBQUksSUFBSSxDQUFDLE1BQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLFlBQVksVUFBVSxDQUFDLEVBQUU7WUFDdEQsd0NBQXdDO1lBQ3hDLDREQUE0RDtZQUM1RCw0REFBNEQ7WUFDNUQsNEJBQ0ssQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFDbkMsTUFBTSxFQUFFO29CQUNOLE1BQU0sRUFBRTt3QkFDTix1REFBdUQ7d0JBQ3ZELHlEQUF5RDt3QkFDekQsT0FBTyxFQUFFLEVBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxFQUFDLE1BQU0sRUFBRSxVQUFVLEVBQUMsQ0FBQyxFQUFDO3FCQUNuRTtpQkFDRjthQUNGLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUNKLGlCQUFNLGFBQWEsWUFBQyxPQUFPLENBQUMsRUFDL0I7U0FDSDtRQUNELE9BQU8saUJBQU0sYUFBYSxZQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3RDLENBQUM7SUFFRDs7T0FFRztJQUNLLG9EQUErQixHQUF2QztRQUNFLElBQU0sTUFBTSxHQUFhLEVBQUUsQ0FBQztRQUM1QixJQUFNLEdBQUcsR0FBa0IsRUFBRSxDQUFDO1FBQzlCLElBQUksSUFBSSxDQUFDLEtBQUssWUFBWSxVQUFVLEVBQUU7WUFDcEMsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLGVBQWUsQ0FBQyxRQUFRLENBQUMsRUFBRTtnQkFDeEMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztnQkFDOUMsR0FBRyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQzthQUN0QjtTQUNGO2FBQU07WUFDTCxLQUFzQixVQUE0QixFQUE1QixLQUFBLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBbUIsRUFBNUIsY0FBNEIsRUFBNUIsSUFBNEIsRUFBRTtnQkFBL0MsSUFBTSxPQUFPLFNBQUE7Z0JBQ2hCLElBQU0sbUJBQW1CLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO2dCQUNqRSxJQUFJLG1CQUFtQixJQUFJLENBQUMsbUJBQW1CLENBQUMsTUFBTSxFQUFFO29CQUN0RCxJQUFNLElBQUksR0FBRyxtQkFBbUIsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7b0JBQzdDLElBQU0sS0FBSyxHQUFHLG1CQUFtQixDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQztvQkFFL0MsSUFBSSxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsSUFBSSxhQUFhLENBQUMsS0FBSyxDQUFDLEVBQUU7d0JBQ25ELElBQU0sTUFBTSxHQUFHLGNBQWMsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDO3dCQUNuRCxJQUFNLEtBQUssR0FBRyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsQ0FBQzt3QkFDekMsSUFBSSxLQUFLLEVBQUU7NEJBQ1QsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQzs0QkFDbkIsR0FBRyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQzt5QkFDdEI7NkJBQU07NEJBQ0wsR0FBRyxDQUFDLElBQUksQ0FBQyw0REFBNEQsQ0FBQyxDQUFDO3lCQUN4RTtxQkFDRjtpQkFDRjthQUNGO1NBQ0Y7UUFDRCxPQUFPLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUMsTUFBTSxRQUFBLEVBQUUsR0FBRyxLQUFBLEVBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO0lBQ25ELENBQUM7SUFFTSxrQ0FBYSxHQUFwQjtRQUNRLElBQUEsU0FBcUIsRUFBcEIsZ0JBQUssRUFBRSxnQkFBSyxDQUFTO1FBQzVCLElBQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQztRQUNoRCxJQUFNLElBQUksR0FBRyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUUxQyxvRkFBb0Y7UUFDcEYsK0JBQStCO1FBQy9CLElBQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDekMsSUFBTSxTQUFTLEdBQUcsSUFBSSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUMvQyxJQUFNLHFCQUFxQixHQUFHLEtBQUssQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO1FBRXpELElBQU0sZUFBZSxHQUFRLEVBQUUsQ0FBQztRQUNoQyxJQUFJLE1BQU0sSUFBSSxTQUFTLEVBQUU7WUFDdkIsZUFBZSxDQUFDLFNBQVMsR0FBRyxFQUFDLEtBQUssRUFBRSxJQUFJLEVBQUMsQ0FBQztTQUMzQztRQUNELElBQU0sNEJBQTRCLEdBQUcsSUFBSSxDQUFDLCtCQUErQixFQUFFLENBQUM7UUFDNUUsSUFBSSw0QkFBNEIsRUFBRTtZQUNoQyxlQUFlLENBQUMsU0FBUyx3QkFDcEIsZUFBZSxDQUFDLFNBQVMsRUFDekIsNEJBQTRCLENBQ2hDLENBQUM7U0FDSDtRQUVELElBQU0sS0FBSyxHQUFHLEtBQUssQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUNwQyxJQUFNLEtBQUssR0FBRyxLQUFLLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztRQUV6QyxJQUFNLFNBQVMsc0JBQ2IsSUFBSSxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQzFCLElBQUksRUFBRSxPQUFPLElBQ1YsQ0FBQyxLQUFLLENBQUEsQ0FBQyxDQUFDLEVBQUMsS0FBSyxPQUFBLEVBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQ3JCLENBQUMsS0FBSyxDQUFBLENBQUMsQ0FBQyxFQUFDLEtBQUssT0FBQSxFQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxJQUN4QixJQUFJLEVBQUU7Z0JBQ0osS0FBSyxxQkFDSCxJQUFJLEVBQUUsU0FBUyxDQUFDLElBQUksRUFDcEIsSUFBSSxFQUFFLFNBQVMsQ0FBQyxJQUFJLEVBQ3BCLE9BQU8sRUFBRSxFQUFFLENBQUMsTUFBTSxDQUNoQixNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQ2pDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FDeEMsSUFDRSxlQUFlLENBQ25CO2FBQ0YsRUFDRCxJQUFJLEVBQUU7Z0JBQ0osS0FBSyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQ2QsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLEVBQUMsSUFBSSxFQUFFLE9BQU8sR0FBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUNuRCxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEVBQUUsRUFBQyxJQUFJLEVBQUUsT0FBTyxFQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQ3pEO2dCQUNELEtBQUssRUFBRSxFQUFFLENBQUMsTUFBTSxDQUNkLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBRSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsRUFDaEQsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFFLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUN2RDthQUNGLElBQ0UsQ0FBQyxJQUFJLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBQyxJQUFJLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUNyQyxDQUFDLHFCQUFxQixDQUFDLENBQUMsQ0FBQyxFQUFDLE1BQU0sRUFBRSxFQUFDLE1BQU0sRUFBRSxxQkFBcUIsRUFBQyxFQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUN4RSxLQUFLLENBQUMsYUFBYSxFQUFFLENBQ3pCLENBQUM7UUFFRixPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDckIsQ0FBQztJQUVTLCtCQUFVLEdBQXBCO1FBQ0UsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDO0lBQ3BCLENBQUM7SUFDSCxpQkFBQztBQUFELENBQUMsQUExVUQsQ0FBZ0MsY0FBYyxHQTBVN0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0FnZ3JlZ2F0ZU9wfSBmcm9tICd2ZWdhJztcbmltcG9ydCB7Q2hhbm5lbCwgQ09MVU1OLCBST1csIFNjYWxlQ2hhbm5lbH0gZnJvbSAnLi4vY2hhbm5lbCc7XG5pbXBvcnQge0NvbmZpZ30gZnJvbSAnLi4vY29uZmlnJztcbmltcG9ydCB7cmVkdWNlfSBmcm9tICcuLi9lbmNvZGluZyc7XG5pbXBvcnQge0ZhY2V0TWFwcGluZ30gZnJvbSAnLi4vZmFjZXQnO1xuaW1wb3J0IHtGaWVsZERlZiwgbm9ybWFsaXplLCB0aXRsZSBhcyBmaWVsZERlZlRpdGxlLCB2Z0ZpZWxkfSBmcm9tICcuLi9maWVsZGRlZic7XG5pbXBvcnQgKiBhcyBsb2cgZnJvbSAnLi4vbG9nJztcbmltcG9ydCB7aGFzRGlzY3JldGVEb21haW59IGZyb20gJy4uL3NjYWxlJztcbmltcG9ydCB7Tm9ybWFsaXplZEZhY2V0U3BlY30gZnJvbSAnLi4vc3BlYyc7XG5pbXBvcnQge2NvbnRhaW5zfSBmcm9tICcuLi91dGlsJztcbmltcG9ydCB7aXNWZ1JhbmdlU3RlcCwgUm93Q29sLCBWZ0F4aXMsIFZnRGF0YSwgVmdMYXlvdXQsIFZnTWFya0dyb3VwLCBWZ1NpZ25hbH0gZnJvbSAnLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHthc3NlbWJsZUF4aXN9IGZyb20gJy4vYXhpcy9hc3NlbWJsZSc7XG5pbXBvcnQge2J1aWxkTW9kZWx9IGZyb20gJy4vYnVpbGRtb2RlbCc7XG5pbXBvcnQge2Fzc2VtYmxlRmFjZXREYXRhfSBmcm9tICcuL2RhdGEvYXNzZW1ibGUnO1xuaW1wb3J0IHtwYXJzZURhdGF9IGZyb20gJy4vZGF0YS9wYXJzZSc7XG5pbXBvcnQge2dldEhlYWRlclR5cGUsIEhlYWRlckNoYW5uZWwsIEhlYWRlckNvbXBvbmVudH0gZnJvbSAnLi9sYXlvdXQvaGVhZGVyJztcbmltcG9ydCB7cGFyc2VDaGlsZHJlbkxheW91dFNpemV9IGZyb20gJy4vbGF5b3V0c2l6ZS9wYXJzZSc7XG5pbXBvcnQge01vZGVsLCBNb2RlbFdpdGhGaWVsZH0gZnJvbSAnLi9tb2RlbCc7XG5pbXBvcnQge1JlcGVhdGVyVmFsdWUsIHJlcGxhY2VSZXBlYXRlckluRmFjZXR9IGZyb20gJy4vcmVwZWF0ZXInO1xuaW1wb3J0IHtwYXJzZUd1aWRlUmVzb2x2ZX0gZnJvbSAnLi9yZXNvbHZlJztcbmltcG9ydCB7YXNzZW1ibGVEb21haW4sIGdldEZpZWxkRnJvbURvbWFpbn0gZnJvbSAnLi9zY2FsZS9kb21haW4nO1xuXG5leHBvcnQgY2xhc3MgRmFjZXRNb2RlbCBleHRlbmRzIE1vZGVsV2l0aEZpZWxkIHtcbiAgcHVibGljIHJlYWRvbmx5IHR5cGU6ICdmYWNldCcgPSAnZmFjZXQnO1xuICBwdWJsaWMgcmVhZG9ubHkgZmFjZXQ6IEZhY2V0TWFwcGluZzxzdHJpbmc+O1xuXG4gIHB1YmxpYyByZWFkb25seSBjaGlsZDogTW9kZWw7XG5cbiAgcHVibGljIHJlYWRvbmx5IGNoaWxkcmVuOiBNb2RlbFtdO1xuXG4gIGNvbnN0cnVjdG9yKHNwZWM6IE5vcm1hbGl6ZWRGYWNldFNwZWMsIHBhcmVudDogTW9kZWwsIHBhcmVudEdpdmVuTmFtZTogc3RyaW5nLCByZXBlYXRlcjogUmVwZWF0ZXJWYWx1ZSwgY29uZmlnOiBDb25maWcpIHtcbiAgICBzdXBlcihzcGVjLCBwYXJlbnQsIHBhcmVudEdpdmVuTmFtZSwgY29uZmlnLCByZXBlYXRlciwgc3BlYy5yZXNvbHZlKTtcblxuXG4gICAgdGhpcy5jaGlsZCA9IGJ1aWxkTW9kZWwoc3BlYy5zcGVjLCB0aGlzLCB0aGlzLmdldE5hbWUoJ2NoaWxkJyksIHVuZGVmaW5lZCwgcmVwZWF0ZXIsIGNvbmZpZywgZmFsc2UpO1xuICAgIHRoaXMuY2hpbGRyZW4gPSBbdGhpcy5jaGlsZF07XG5cbiAgICBjb25zdCBmYWNldDogRmFjZXRNYXBwaW5nPHN0cmluZz4gPSByZXBsYWNlUmVwZWF0ZXJJbkZhY2V0KHNwZWMuZmFjZXQsIHJlcGVhdGVyKTtcblxuICAgIHRoaXMuZmFjZXQgPSB0aGlzLmluaXRGYWNldChmYWNldCk7XG4gIH1cblxuICBwcml2YXRlIGluaXRGYWNldChmYWNldDogRmFjZXRNYXBwaW5nPHN0cmluZz4pOiBGYWNldE1hcHBpbmc8c3RyaW5nPiB7XG4gICAgLy8gY2xvbmUgdG8gcHJldmVudCBzaWRlIGVmZmVjdCB0byB0aGUgb3JpZ2luYWwgc3BlY1xuICAgIHJldHVybiByZWR1Y2UoZmFjZXQsIGZ1bmN0aW9uKG5vcm1hbGl6ZWRGYWNldCwgZmllbGREZWY6IEZpZWxkRGVmPHN0cmluZz4sIGNoYW5uZWw6IENoYW5uZWwpIHtcbiAgICAgIGlmICghY29udGFpbnMoW1JPVywgQ09MVU1OXSwgY2hhbm5lbCkpIHtcbiAgICAgICAgLy8gRHJvcCB1bnN1cHBvcnRlZCBjaGFubmVsXG4gICAgICAgIGxvZy53YXJuKGxvZy5tZXNzYWdlLmluY29tcGF0aWJsZUNoYW5uZWwoY2hhbm5lbCwgJ2ZhY2V0JykpO1xuICAgICAgICByZXR1cm4gbm9ybWFsaXplZEZhY2V0O1xuICAgICAgfVxuXG4gICAgICBpZiAoZmllbGREZWYuZmllbGQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBsb2cud2Fybihsb2cubWVzc2FnZS5lbXB0eUZpZWxkRGVmKGZpZWxkRGVmLCBjaGFubmVsKSk7XG4gICAgICAgIHJldHVybiBub3JtYWxpemVkRmFjZXQ7XG4gICAgICB9XG5cbiAgICAgIC8vIENvbnZlcnQgdHlwZSB0byBmdWxsLCBsb3dlcmNhc2UgdHlwZSwgb3IgYXVnbWVudCB0aGUgZmllbGREZWYgd2l0aCBhIGRlZmF1bHQgdHlwZSBpZiBtaXNzaW5nLlxuICAgICAgbm9ybWFsaXplZEZhY2V0W2NoYW5uZWxdID0gbm9ybWFsaXplKGZpZWxkRGVmLCBjaGFubmVsKTtcbiAgICAgIHJldHVybiBub3JtYWxpemVkRmFjZXQ7XG4gICAgfSwge30pO1xuICB9XG5cbiAgcHVibGljIGNoYW5uZWxIYXNGaWVsZChjaGFubmVsOiBDaGFubmVsKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICEhdGhpcy5mYWNldFtjaGFubmVsXTtcbiAgfVxuXG4gIHB1YmxpYyBmaWVsZERlZihjaGFubmVsOiBDaGFubmVsKTogRmllbGREZWY8c3RyaW5nPiB7XG4gICAgcmV0dXJuIHRoaXMuZmFjZXRbY2hhbm5lbF07XG4gIH1cblxuICBwdWJsaWMgcGFyc2VEYXRhKCkge1xuICAgIHRoaXMuY29tcG9uZW50LmRhdGEgPSBwYXJzZURhdGEodGhpcyk7XG4gICAgdGhpcy5jaGlsZC5wYXJzZURhdGEoKTtcbiAgfVxuXG4gIHB1YmxpYyBwYXJzZUxheW91dFNpemUoKSB7XG4gICAgcGFyc2VDaGlsZHJlbkxheW91dFNpemUodGhpcyk7XG4gIH1cblxuICBwdWJsaWMgcGFyc2VTZWxlY3Rpb24oKSB7XG4gICAgLy8gQXMgYSBmYWNldCBoYXMgYSBzaW5nbGUgY2hpbGQsIHRoZSBzZWxlY3Rpb24gY29tcG9uZW50cyBhcmUgdGhlIHNhbWUuXG4gICAgLy8gVGhlIGNoaWxkIG1haW50YWlucyBpdHMgc2VsZWN0aW9ucyB0byBhc3NlbWJsZSBzaWduYWxzLCB3aGljaCByZW1haW5cbiAgICAvLyB3aXRoaW4gaXRzIHVuaXQuXG4gICAgdGhpcy5jaGlsZC5wYXJzZVNlbGVjdGlvbigpO1xuICAgIHRoaXMuY29tcG9uZW50LnNlbGVjdGlvbiA9IHRoaXMuY2hpbGQuY29tcG9uZW50LnNlbGVjdGlvbjtcbiAgfVxuXG4gIHB1YmxpYyBwYXJzZU1hcmtHcm91cCgpIHtcbiAgICB0aGlzLmNoaWxkLnBhcnNlTWFya0dyb3VwKCk7XG4gIH1cblxuICBwdWJsaWMgcGFyc2VBeGlzQW5kSGVhZGVyKCkge1xuICAgIHRoaXMuY2hpbGQucGFyc2VBeGlzQW5kSGVhZGVyKCk7XG5cbiAgICB0aGlzLnBhcnNlSGVhZGVyKCdjb2x1bW4nKTtcbiAgICB0aGlzLnBhcnNlSGVhZGVyKCdyb3cnKTtcblxuICAgIHRoaXMubWVyZ2VDaGlsZEF4aXMoJ3gnKTtcbiAgICB0aGlzLm1lcmdlQ2hpbGRBeGlzKCd5Jyk7XG4gIH1cblxuICBwcml2YXRlIHBhcnNlSGVhZGVyKGNoYW5uZWw6IEhlYWRlckNoYW5uZWwpIHtcblxuICAgIGlmICh0aGlzLmNoYW5uZWxIYXNGaWVsZChjaGFubmVsKSkge1xuICAgICAgY29uc3QgZmllbGREZWYgPSB0aGlzLmZhY2V0W2NoYW5uZWxdO1xuICAgICAgY29uc3QgaGVhZGVyID0gZmllbGREZWYuaGVhZGVyIHx8IHt9O1xuICAgICAgbGV0IHRpdGxlID0gZmllbGREZWYudGl0bGUgIT09IHVuZGVmaW5lZCA/IGZpZWxkRGVmLnRpdGxlIDpcbiAgICAgICAgaGVhZGVyLnRpdGxlICE9PSB1bmRlZmluZWQgPyBoZWFkZXIudGl0bGUgOiBmaWVsZERlZlRpdGxlKGZpZWxkRGVmLCB0aGlzLmNvbmZpZyk7XG5cbiAgICAgIGlmICh0aGlzLmNoaWxkLmNvbXBvbmVudC5sYXlvdXRIZWFkZXJzW2NoYW5uZWxdLnRpdGxlKSB7XG4gICAgICAgIC8vIG1lcmdlIHRpdGxlIHdpdGggY2hpbGQgdG8gcHJvZHVjZSBcIlRpdGxlIC8gU3VidGl0bGUgLyBTdWItc3VidGl0bGVcIlxuICAgICAgICB0aXRsZSArPSAnIC8gJyArIHRoaXMuY2hpbGQuY29tcG9uZW50LmxheW91dEhlYWRlcnNbY2hhbm5lbF0udGl0bGU7XG4gICAgICAgIHRoaXMuY2hpbGQuY29tcG9uZW50LmxheW91dEhlYWRlcnNbY2hhbm5lbF0udGl0bGUgPSBudWxsO1xuICAgICAgfVxuXG4gICAgICB0aGlzLmNvbXBvbmVudC5sYXlvdXRIZWFkZXJzW2NoYW5uZWxdID0ge1xuICAgICAgICB0aXRsZSxcbiAgICAgICAgZmFjZXRGaWVsZERlZjogZmllbGREZWYsXG4gICAgICAgIC8vIFRPRE86IHN1cHBvcnQgYWRkaW5nIGxhYmVsIHRvIGZvb3RlciBhcyB3ZWxsXG4gICAgICAgIGhlYWRlcjogW3RoaXMubWFrZUhlYWRlckNvbXBvbmVudChjaGFubmVsLCB0cnVlKV1cbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBtYWtlSGVhZGVyQ29tcG9uZW50KGNoYW5uZWw6IEhlYWRlckNoYW5uZWwsIGxhYmVsczogYm9vbGVhbik6IEhlYWRlckNvbXBvbmVudCB7XG4gICAgY29uc3Qgc2l6ZVR5cGUgPSBjaGFubmVsID09PSAncm93JyA/ICdoZWlnaHQnIDogJ3dpZHRoJztcblxuICAgIHJldHVybiB7XG4gICAgICBsYWJlbHMsXG4gICAgICBzaXplU2lnbmFsOiB0aGlzLmNoaWxkLmNvbXBvbmVudC5sYXlvdXRTaXplLmdldChzaXplVHlwZSkgPyB0aGlzLmNoaWxkLmdldFNpemVTaWduYWxSZWYoc2l6ZVR5cGUpIDogdW5kZWZpbmVkLFxuICAgICAgYXhlczogW11cbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBtZXJnZUNoaWxkQXhpcyhjaGFubmVsOiAneCcgfCAneScpIHtcbiAgICBjb25zdCB7Y2hpbGR9ID0gdGhpcztcbiAgICBpZiAoY2hpbGQuY29tcG9uZW50LmF4ZXNbY2hhbm5lbF0pIHtcbiAgICAgIGNvbnN0IHtsYXlvdXRIZWFkZXJzLCByZXNvbHZlfSA9IHRoaXMuY29tcG9uZW50O1xuICAgICAgcmVzb2x2ZS5heGlzW2NoYW5uZWxdID0gcGFyc2VHdWlkZVJlc29sdmUocmVzb2x2ZSwgY2hhbm5lbCk7XG5cbiAgICAgIGlmIChyZXNvbHZlLmF4aXNbY2hhbm5lbF0gPT09ICdzaGFyZWQnKSB7XG4gICAgICAgIC8vIEZvciBzaGFyZWQgYXhpcywgbW92ZSB0aGUgYXhlcyB0byBmYWNldCdzIGhlYWRlciBvciBmb290ZXJcbiAgICAgICAgY29uc3QgaGVhZGVyQ2hhbm5lbCA9IGNoYW5uZWwgPT09ICd4JyA/ICdjb2x1bW4nIDogJ3Jvdyc7XG5cbiAgICAgICAgY29uc3QgbGF5b3V0SGVhZGVyID0gbGF5b3V0SGVhZGVyc1toZWFkZXJDaGFubmVsXTtcbiAgICAgICAgZm9yIChjb25zdCBheGlzQ29tcG9uZW50IG9mIGNoaWxkLmNvbXBvbmVudC5heGVzW2NoYW5uZWxdKSB7XG4gICAgICAgICAgY29uc3QgaGVhZGVyVHlwZSA9IGdldEhlYWRlclR5cGUoYXhpc0NvbXBvbmVudC5nZXQoJ29yaWVudCcpKTtcbiAgICAgICAgICBsYXlvdXRIZWFkZXJbaGVhZGVyVHlwZV0gPSBsYXlvdXRIZWFkZXJbaGVhZGVyVHlwZV0gfHxcbiAgICAgICAgICBbdGhpcy5tYWtlSGVhZGVyQ29tcG9uZW50KGhlYWRlckNoYW5uZWwsIGZhbHNlKV07XG5cbiAgICAgICAgICBjb25zdCBtYWluQXhpcyA9IGFzc2VtYmxlQXhpcyhheGlzQ29tcG9uZW50LCAnbWFpbicsIHRoaXMuY29uZmlnLCB7aGVhZGVyOiB0cnVlfSk7XG4gICAgICAgICAgLy8gTGF5b3V0SGVhZGVyIG5vIGxvbmdlciBrZWVwIHRyYWNrIG9mIHByb3BlcnR5IHByZWNlZGVuY2UsIHRodXMgbGV0J3MgY29tYmluZS5cbiAgICAgICAgICBsYXlvdXRIZWFkZXJbaGVhZGVyVHlwZV1bMF0uYXhlcy5wdXNoKG1haW5BeGlzKTtcbiAgICAgICAgICBheGlzQ29tcG9uZW50Lm1haW5FeHRyYWN0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBPdGhlcndpc2UgZG8gbm90aGluZyBmb3IgaW5kZXBlbmRlbnQgYXhlc1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBhc3NlbWJsZVNlbGVjdGlvblRvcExldmVsU2lnbmFscyhzaWduYWxzOiBhbnlbXSk6IFZnU2lnbmFsW10ge1xuICAgIHJldHVybiB0aGlzLmNoaWxkLmFzc2VtYmxlU2VsZWN0aW9uVG9wTGV2ZWxTaWduYWxzKHNpZ25hbHMpO1xuICB9XG5cbiAgcHVibGljIGFzc2VtYmxlU2VsZWN0aW9uU2lnbmFscygpOiBWZ1NpZ25hbFtdIHtcbiAgICB0aGlzLmNoaWxkLmFzc2VtYmxlU2VsZWN0aW9uU2lnbmFscygpO1xuICAgIHJldHVybiBbXTtcbiAgfVxuXG4gIHB1YmxpYyBhc3NlbWJsZVNlbGVjdGlvbkRhdGEoZGF0YTogVmdEYXRhW10pOiBWZ0RhdGFbXSB7XG4gICAgcmV0dXJuIHRoaXMuY2hpbGQuYXNzZW1ibGVTZWxlY3Rpb25EYXRhKGRhdGEpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRMYXlvdXRCYW5kTWl4aW5zKGhlYWRlclR5cGU6ICdoZWFkZXInIHwgJ2Zvb3RlcicpOiB7XG4gICAgaGVhZGVyQmFuZD86IFJvd0NvbDxudW1iZXI+LFxuICAgIGZvb3RlckJhbmQ/OiBSb3dDb2w8bnVtYmVyPlxuICB9IHtcbiAgICBjb25zdCBiYW5kTWl4aW5zID0ge307XG5cbiAgICBjb25zdCBiYW5kVHlwZSA9IGhlYWRlclR5cGUgPT09ICdoZWFkZXInID8gJ2hlYWRlckJhbmQnIDogJ2Zvb3RlckJhbmQnO1xuXG4gICAgZm9yIChjb25zdCBjaGFubmVsIG9mIFsncm93JywgJ2NvbHVtbiddIGFzICgncm93JyB8ICdjb2x1bW4nKVtdKSB7XG4gICAgICBjb25zdCBsYXlvdXRIZWFkZXJDb21wb25lbnQgPSB0aGlzLmNvbXBvbmVudC5sYXlvdXRIZWFkZXJzW2NoYW5uZWxdO1xuICAgICAgY29uc3QgaGVhZGVyQ29tcG9uZW50ID0gbGF5b3V0SGVhZGVyQ29tcG9uZW50W2hlYWRlclR5cGVdO1xuICAgICAgaWYgKGhlYWRlckNvbXBvbmVudCAmJiBoZWFkZXJDb21wb25lbnRbMF0pIHtcbiAgICAgICAgY29uc3Qgc2l6ZVR5cGUgPSBjaGFubmVsID09PSAncm93JyA/ICdoZWlnaHQnIDogJ3dpZHRoJztcblxuICAgICAgICBpZiAoIXRoaXMuY2hpbGQuY29tcG9uZW50LmxheW91dFNpemUuZ2V0KHNpemVUeXBlKSkge1xuICAgICAgICAgIC8vIElmIGZhY2V0IGNoaWxkIGRvZXMgbm90IGhhdmUgc2l6ZSBzaWduYWwsIHRoZW4gYXBwbHkgaGVhZGVyQmFuZFxuICAgICAgICAgIGJhbmRNaXhpbnNbYmFuZFR5cGVdID0gYmFuZE1peGluc1tiYW5kVHlwZV0gfHwge307XG4gICAgICAgICAgYmFuZE1peGluc1tiYW5kVHlwZV1bY2hhbm5lbF0gPSAwLjU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGJhbmRNaXhpbnM7XG4gIH1cblxuICBwdWJsaWMgYXNzZW1ibGVMYXlvdXQoKTogVmdMYXlvdXQge1xuICAgIGNvbnN0IGNvbHVtbnMgPSB0aGlzLmNoYW5uZWxIYXNGaWVsZCgnY29sdW1uJykgPyB0aGlzLmNvbHVtbkRpc3RpbmN0U2lnbmFsKCkgOiAxO1xuXG4gICAgLy8gVE9ETzogZGV0ZXJtaW5lIGRlZmF1bHQgYWxpZ24gYmFzZWQgb24gc2hhcmVkIC8gaW5kZXBlbmRlbnQgc2NhbGVzXG5cbiAgICByZXR1cm4ge1xuICAgICAgcGFkZGluZzoge3JvdzogMTAsIGNvbHVtbjogMTB9LFxuICAgICAgLi4udGhpcy5nZXRMYXlvdXRCYW5kTWl4aW5zKCdoZWFkZXInKSxcbiAgICAgIC4uLnRoaXMuZ2V0TGF5b3V0QmFuZE1peGlucygnZm9vdGVyJyksXG5cbiAgICAgIC8vIFRPRE86IHN1cHBvcnQgb2Zmc2V0IGZvciByb3dIZWFkZXIvcm93Rm9vdGVyL3Jvd1RpdGxlL2NvbHVtbkhlYWRlci9jb2x1bW5Gb290ZXIvY29sdW1uVGl0bGVcbiAgICAgIG9mZnNldDogMTAsXG4gICAgICBjb2x1bW5zLFxuICAgICAgYm91bmRzOiAnZnVsbCcsXG4gICAgICBhbGlnbjogJ2FsbCdcbiAgICB9O1xuICB9XG5cbiAgcHVibGljIGFzc2VtYmxlTGF5b3V0U2lnbmFscygpOiBWZ1NpZ25hbFtdIHtcbiAgICAvLyBGSVhNRShodHRwczovL2dpdGh1Yi5jb20vdmVnYS92ZWdhLWxpdGUvaXNzdWVzLzExOTMpOiB0aGlzIGNhbiBiZSBpbmNvcnJlY3QgaWYgd2UgaGF2ZSBpbmRlcGVuZGVudCBzY2FsZXMuXG4gICAgcmV0dXJuIHRoaXMuY2hpbGQuYXNzZW1ibGVMYXlvdXRTaWduYWxzKCk7XG4gIH1cblxuICBwcml2YXRlIGNvbHVtbkRpc3RpbmN0U2lnbmFsKCkge1xuICAgIGlmICh0aGlzLnBhcmVudCAmJiAodGhpcy5wYXJlbnQgaW5zdGFuY2VvZiBGYWNldE1vZGVsKSkge1xuICAgICAgLy8gRm9yIG5lc3RlZCBmYWNldCwgd2Ugd2lsbCBhZGQgY29sdW1ucyB0byBncm91cCBtYXJrIGluc3RlYWRcbiAgICAgIC8vIFNlZSBkaXNjdXNzaW9uIGluIGh0dHBzOi8vZ2l0aHViLmNvbS92ZWdhL3ZlZ2EvaXNzdWVzLzk1MlxuICAgICAgLy8gYW5kIGh0dHBzOi8vZ2l0aHViLmNvbS92ZWdhL3ZlZ2Etdmlldy9yZWxlYXNlcy90YWcvdjEuMi42XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBJbiBmYWNldE5vZGUuYXNzZW1ibGUoKSwgdGhlIG5hbWUgaXMgYWx3YXlzIHRoaXMuZ2V0TmFtZSgnY29sdW1uJykgKyAnX2xheW91dCcuXG4gICAgICBjb25zdCBmYWNldExheW91dERhdGFOYW1lID0gdGhpcy5nZXROYW1lKCdjb2x1bW5fZG9tYWluJyk7XG4gICAgICByZXR1cm4ge3NpZ25hbDogYGxlbmd0aChkYXRhKCcke2ZhY2V0TGF5b3V0RGF0YU5hbWV9JykpYH07XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGFzc2VtYmxlR3JvdXAoc2lnbmFsczogVmdTaWduYWxbXSkge1xuICAgIGlmICh0aGlzLnBhcmVudCAmJiAodGhpcy5wYXJlbnQgaW5zdGFuY2VvZiBGYWNldE1vZGVsKSkge1xuICAgICAgLy8gUHJvdmlkZSBudW1iZXIgb2YgY29sdW1ucyBmb3IgbGF5b3V0LlxuICAgICAgLy8gU2VlIGRpc2N1c3Npb24gaW4gaHR0cHM6Ly9naXRodWIuY29tL3ZlZ2EvdmVnYS9pc3N1ZXMvOTUyXG4gICAgICAvLyBhbmQgaHR0cHM6Ly9naXRodWIuY29tL3ZlZ2EvdmVnYS12aWV3L3JlbGVhc2VzL3RhZy92MS4yLjZcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLih0aGlzLmNoYW5uZWxIYXNGaWVsZCgnY29sdW1uJykgPyB7XG4gICAgICAgICAgZW5jb2RlOiB7XG4gICAgICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICAgICAgLy8gVE9ETyhodHRwczovL2dpdGh1Yi5jb20vdmVnYS92ZWdhLWxpdGUvaXNzdWVzLzI3NTkpOlxuICAgICAgICAgICAgICAvLyBDb3JyZWN0IHRoZSBzaWduYWwgZm9yIGZhY2V0IG9mIGNvbmNhdCBvZiBmYWNldF9jb2x1bW5cbiAgICAgICAgICAgICAgY29sdW1uczoge2ZpZWxkOiB2Z0ZpZWxkKHRoaXMuZmFjZXQuY29sdW1uLCB7cHJlZml4OiAnZGlzdGluY3QnfSl9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IDoge30pLFxuICAgICAgICAuLi5zdXBlci5hc3NlbWJsZUdyb3VwKHNpZ25hbHMpXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gc3VwZXIuYXNzZW1ibGVHcm91cChzaWduYWxzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBZ2dyZWdhdGUgY2FyZGluYWxpdHkgZm9yIGNhbGN1bGF0aW5nIHNpemVcbiAgICovXG4gIHByaXZhdGUgZ2V0Q2FyZGluYWxpdHlBZ2dyZWdhdGVGb3JDaGlsZCgpIHtcbiAgICBjb25zdCBmaWVsZHM6IHN0cmluZ1tdID0gW107XG4gICAgY29uc3Qgb3BzOiBBZ2dyZWdhdGVPcFtdID0gW107XG4gICAgaWYgKHRoaXMuY2hpbGQgaW5zdGFuY2VvZiBGYWNldE1vZGVsKSB7XG4gICAgICBpZiAodGhpcy5jaGlsZC5jaGFubmVsSGFzRmllbGQoJ2NvbHVtbicpKSB7XG4gICAgICAgIGZpZWxkcy5wdXNoKHZnRmllbGQodGhpcy5jaGlsZC5mYWNldC5jb2x1bW4pKTtcbiAgICAgICAgb3BzLnB1c2goJ2Rpc3RpbmN0Jyk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAoY29uc3QgY2hhbm5lbCBvZiBbJ3gnLCAneSddIGFzIFNjYWxlQ2hhbm5lbFtdKSB7XG4gICAgICAgIGNvbnN0IGNoaWxkU2NhbGVDb21wb25lbnQgPSB0aGlzLmNoaWxkLmNvbXBvbmVudC5zY2FsZXNbY2hhbm5lbF07XG4gICAgICAgIGlmIChjaGlsZFNjYWxlQ29tcG9uZW50ICYmICFjaGlsZFNjYWxlQ29tcG9uZW50Lm1lcmdlZCkge1xuICAgICAgICAgIGNvbnN0IHR5cGUgPSBjaGlsZFNjYWxlQ29tcG9uZW50LmdldCgndHlwZScpO1xuICAgICAgICAgIGNvbnN0IHJhbmdlID0gY2hpbGRTY2FsZUNvbXBvbmVudC5nZXQoJ3JhbmdlJyk7XG5cbiAgICAgICAgICBpZiAoaGFzRGlzY3JldGVEb21haW4odHlwZSkgJiYgaXNWZ1JhbmdlU3RlcChyYW5nZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IGRvbWFpbiA9IGFzc2VtYmxlRG9tYWluKHRoaXMuY2hpbGQsIGNoYW5uZWwpO1xuICAgICAgICAgICAgY29uc3QgZmllbGQgPSBnZXRGaWVsZEZyb21Eb21haW4oZG9tYWluKTtcbiAgICAgICAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICAgICAgICBmaWVsZHMucHVzaChmaWVsZCk7XG4gICAgICAgICAgICAgIG9wcy5wdXNoKCdkaXN0aW5jdCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgbG9nLndhcm4oJ1Vua25vd24gZmllbGQgZm9yICR7Y2hhbm5lbH0uICBDYW5ub3QgY2FsY3VsYXRlIHZpZXcgc2l6ZS4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZpZWxkcy5sZW5ndGggPyB7ZmllbGRzLCBvcHN9IDogdW5kZWZpbmVkO1xuICB9XG5cbiAgcHVibGljIGFzc2VtYmxlTWFya3MoKTogVmdNYXJrR3JvdXBbXSB7XG4gICAgY29uc3Qge2NoaWxkLCBmYWNldH0gPSB0aGlzO1xuICAgIGNvbnN0IGZhY2V0Um9vdCA9IHRoaXMuY29tcG9uZW50LmRhdGEuZmFjZXRSb290O1xuICAgIGNvbnN0IGRhdGEgPSBhc3NlbWJsZUZhY2V0RGF0YShmYWNldFJvb3QpO1xuXG4gICAgLy8gSWYgd2UgZmFjZXQgYnkgdHdvIGRpbWVuc2lvbnMsIHdlIG5lZWQgdG8gYWRkIGEgY3Jvc3Mgb3BlcmF0b3IgdG8gdGhlIGFnZ3JlZ2F0aW9uXG4gICAgLy8gc28gdGhhdCB3ZSBjcmVhdGUgYWxsIGdyb3Vwc1xuICAgIGNvbnN0IGhhc1JvdyA9IHRoaXMuY2hhbm5lbEhhc0ZpZWxkKFJPVyk7XG4gICAgY29uc3QgaGFzQ29sdW1uID0gdGhpcy5jaGFubmVsSGFzRmllbGQoQ09MVU1OKTtcbiAgICBjb25zdCBsYXlvdXRTaXplRW5jb2RlRW50cnkgPSBjaGlsZC5hc3NlbWJsZUxheW91dFNpemUoKTtcblxuICAgIGNvbnN0IGFnZ3JlZ2F0ZU1peGluczogYW55ID0ge307XG4gICAgaWYgKGhhc1JvdyAmJiBoYXNDb2x1bW4pIHtcbiAgICAgIGFnZ3JlZ2F0ZU1peGlucy5hZ2dyZWdhdGUgPSB7Y3Jvc3M6IHRydWV9O1xuICAgIH1cbiAgICBjb25zdCBjYXJkaW5hbGl0eUFnZ3JlZ2F0ZUZvckNoaWxkID0gdGhpcy5nZXRDYXJkaW5hbGl0eUFnZ3JlZ2F0ZUZvckNoaWxkKCk7XG4gICAgaWYgKGNhcmRpbmFsaXR5QWdncmVnYXRlRm9yQ2hpbGQpIHtcbiAgICAgIGFnZ3JlZ2F0ZU1peGlucy5hZ2dyZWdhdGUgPSB7XG4gICAgICAgIC4uLmFnZ3JlZ2F0ZU1peGlucy5hZ2dyZWdhdGUsXG4gICAgICAgIC4uLmNhcmRpbmFsaXR5QWdncmVnYXRlRm9yQ2hpbGRcbiAgICAgIH07XG4gICAgfVxuXG4gICAgY29uc3QgdGl0bGUgPSBjaGlsZC5hc3NlbWJsZVRpdGxlKCk7XG4gICAgY29uc3Qgc3R5bGUgPSBjaGlsZC5hc3NlbWJsZUdyb3VwU3R5bGUoKTtcblxuICAgIGNvbnN0IG1hcmtHcm91cCA9IHtcbiAgICAgIG5hbWU6IHRoaXMuZ2V0TmFtZSgnY2VsbCcpLFxuICAgICAgdHlwZTogJ2dyb3VwJyxcbiAgICAgIC4uLih0aXRsZT8ge3RpdGxlfSA6IHt9KSxcbiAgICAgIC4uLihzdHlsZT8ge3N0eWxlfSA6IHt9KSxcbiAgICAgIGZyb206IHtcbiAgICAgICAgZmFjZXQ6IHtcbiAgICAgICAgICBuYW1lOiBmYWNldFJvb3QubmFtZSxcbiAgICAgICAgICBkYXRhOiBmYWNldFJvb3QuZGF0YSxcbiAgICAgICAgICBncm91cGJ5OiBbXS5jb25jYXQoXG4gICAgICAgICAgICBoYXNSb3cgPyBbdGhpcy52Z0ZpZWxkKFJPVyldIDogW10sXG4gICAgICAgICAgICBoYXNDb2x1bW4gPyBbdGhpcy52Z0ZpZWxkKENPTFVNTildIDogW11cbiAgICAgICAgICApLFxuICAgICAgICAgIC4uLmFnZ3JlZ2F0ZU1peGluc1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgc29ydDoge1xuICAgICAgICBmaWVsZDogW10uY29uY2F0KFxuICAgICAgICAgIGhhc1JvdyA/IFt0aGlzLnZnRmllbGQoUk9XLCB7ZXhwcjogJ2RhdHVtJyx9KV0gOiBbXSxcbiAgICAgICAgICBoYXNDb2x1bW4gPyBbdGhpcy52Z0ZpZWxkKENPTFVNTiwge2V4cHI6ICdkYXR1bSd9KV0gOiBbXVxuICAgICAgICApLFxuICAgICAgICBvcmRlcjogW10uY29uY2F0KFxuICAgICAgICAgIGhhc1JvdyA/IFsgKGZhY2V0LnJvdy5zb3J0KSB8fCAnYXNjZW5kaW5nJ10gOiBbXSxcbiAgICAgICAgICBoYXNDb2x1bW4gPyBbIChmYWNldC5jb2x1bW4uc29ydCkgfHwgJ2FzY2VuZGluZyddIDogW11cbiAgICAgICAgKVxuICAgICAgfSxcbiAgICAgIC4uLihkYXRhLmxlbmd0aCA+IDAgPyB7ZGF0YTogZGF0YX0gOiB7fSksXG4gICAgICAuLi4obGF5b3V0U2l6ZUVuY29kZUVudHJ5ID8ge2VuY29kZToge3VwZGF0ZTogbGF5b3V0U2l6ZUVuY29kZUVudHJ5fX0gOiB7fSksXG4gICAgICAuLi5jaGlsZC5hc3NlbWJsZUdyb3VwKClcbiAgICB9O1xuXG4gICAgcmV0dXJuIFttYXJrR3JvdXBdO1xuICB9XG5cbiAgcHJvdGVjdGVkIGdldE1hcHBpbmcoKSB7XG4gICAgcmV0dXJuIHRoaXMuZmFjZXQ7XG4gIH1cbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { duplicate } from '../../util';\nimport { Split } from '../split';\nfunction isFalseOrNull(v) {\n    return v === false || v === null;\n}\nvar AxisComponent = /** @class */ (function (_super) {\n    tslib_1.__extends(AxisComponent, _super);\n    function AxisComponent(explicit, implicit, mainExtracted) {\n        if (explicit === void 0) { explicit = {}; }\n        if (implicit === void 0) { implicit = {}; }\n        if (mainExtracted === void 0) { mainExtracted = false; }\n        var _this = _super.call(this) || this;\n        _this.explicit = explicit;\n        _this.implicit = implicit;\n        _this.mainExtracted = mainExtracted;\n        return _this;\n    }\n    AxisComponent.prototype.clone = function () {\n        return new AxisComponent(duplicate(this.explicit), duplicate(this.implicit), this.mainExtracted);\n    };\n    AxisComponent.prototype.hasAxisPart = function (part) {\n        // FIXME(https://github.com/vega/vega-lite/issues/2552) this method can be wrong if users use a Vega theme.\n        if (part === 'axis') { // always has the axis container part\n            return true;\n        }\n        if (part === 'grid' || part === 'title') {\n            return !!this.get(part);\n        }\n        // Other parts are enabled by default, so they should not be false or null.\n        return !isFalseOrNull(this.get(part));\n    };\n    return AxisComponent;\n}(Split));\nexport { AxisComponent };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvYXhpcy9jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUVBLE9BQU8sRUFBQyxTQUFTLEVBQU8sTUFBTSxZQUFZLENBQUM7QUFFM0MsT0FBTyxFQUFDLEtBQUssRUFBQyxNQUFNLFVBQVUsQ0FBQztBQUcvQix1QkFBdUIsQ0FBaUI7SUFDdEMsT0FBTyxDQUFDLEtBQUssS0FBSyxJQUFJLENBQUMsS0FBSyxJQUFJLENBQUM7QUFDbkMsQ0FBQztBQU9EO0lBQW1DLHlDQUF5QjtJQUMxRCx1QkFDa0IsUUFBMEMsRUFDMUMsUUFBMEMsRUFDbkQsYUFBcUI7UUFGWix5QkFBQSxFQUFBLGFBQTBDO1FBQzFDLHlCQUFBLEVBQUEsYUFBMEM7UUFDbkQsOEJBQUEsRUFBQSxxQkFBcUI7UUFIOUIsWUFLRSxpQkFBTyxTQUNSO1FBTGlCLGNBQVEsR0FBUixRQUFRLENBQWtDO1FBQzFDLGNBQVEsR0FBUixRQUFRLENBQWtDO1FBQ25ELG1CQUFhLEdBQWIsYUFBYSxDQUFROztJQUc5QixDQUFDO0lBRU0sNkJBQUssR0FBWjtRQUNFLE9BQU8sSUFBSSxhQUFhLENBQ3RCLFNBQVMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQ3hCLFNBQVMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsSUFBSSxDQUFDLGFBQWEsQ0FDN0MsQ0FBQztJQUNKLENBQUM7SUFFTSxtQ0FBVyxHQUFsQixVQUFtQixJQUFjO1FBQy9CLDJHQUEyRztRQUUzRyxJQUFJLElBQUksS0FBSyxNQUFNLEVBQUUsRUFBRSxxQ0FBcUM7WUFDMUQsT0FBTyxJQUFJLENBQUM7U0FDYjtRQUVELElBQUksSUFBSSxLQUFLLE1BQU0sSUFBSSxJQUFJLEtBQUssT0FBTyxFQUFFO1lBQ3ZDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDekI7UUFDRCwyRUFBMkU7UUFDM0UsT0FBTyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDeEMsQ0FBQztJQUNILG9CQUFDO0FBQUQsQ0FBQyxBQTdCRCxDQUFtQyxLQUFLLEdBNkJ2QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7QXhpcywgQXhpc1BhcnR9IGZyb20gJy4uLy4uL2F4aXMnO1xuaW1wb3J0IHtGaWVsZERlZkJhc2V9IGZyb20gJy4uLy4uL2ZpZWxkZGVmJztcbmltcG9ydCB7ZHVwbGljYXRlLCBPbWl0fSBmcm9tICcuLi8uLi91dGlsJztcbmltcG9ydCB7VmdBeGlzfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge1NwbGl0fSBmcm9tICcuLi9zcGxpdCc7XG5cblxuZnVuY3Rpb24gaXNGYWxzZU9yTnVsbCh2OiBib29sZWFuIHwgbnVsbCkge1xuICByZXR1cm4gdiA9PT0gZmFsc2UgfHwgdiA9PT0gbnVsbDtcbn1cblxuZXhwb3J0IHR5cGUgQXhpc0NvbXBvbmVudFByb3BzID0gT21pdDxWZ0F4aXMsICd0aXRsZSc+ICYge1xuXG4gIHRpdGxlOiBzdHJpbmcgfCBGaWVsZERlZkJhc2U8c3RyaW5nPltdO1xufTtcblxuZXhwb3J0IGNsYXNzIEF4aXNDb21wb25lbnQgZXh0ZW5kcyBTcGxpdDxBeGlzQ29tcG9uZW50UHJvcHM+IHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIHJlYWRvbmx5IGV4cGxpY2l0OiBQYXJ0aWFsPEF4aXNDb21wb25lbnRQcm9wcz4gPSB7fSxcbiAgICBwdWJsaWMgcmVhZG9ubHkgaW1wbGljaXQ6IFBhcnRpYWw8QXhpc0NvbXBvbmVudFByb3BzPiA9IHt9LFxuICAgIHB1YmxpYyBtYWluRXh0cmFjdGVkID0gZmFsc2VcbiAgKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIHB1YmxpYyBjbG9uZSgpIHtcbiAgICByZXR1cm4gbmV3IEF4aXNDb21wb25lbnQoXG4gICAgICBkdXBsaWNhdGUodGhpcy5leHBsaWNpdCksXG4gICAgICBkdXBsaWNhdGUodGhpcy5pbXBsaWNpdCksIHRoaXMubWFpbkV4dHJhY3RlZFxuICAgICk7XG4gIH1cblxuICBwdWJsaWMgaGFzQXhpc1BhcnQocGFydDogQXhpc1BhcnQpIHtcbiAgICAvLyBGSVhNRShodHRwczovL2dpdGh1Yi5jb20vdmVnYS92ZWdhLWxpdGUvaXNzdWVzLzI1NTIpIHRoaXMgbWV0aG9kIGNhbiBiZSB3cm9uZyBpZiB1c2VycyB1c2UgYSBWZWdhIHRoZW1lLlxuXG4gICAgaWYgKHBhcnQgPT09ICdheGlzJykgeyAvLyBhbHdheXMgaGFzIHRoZSBheGlzIGNvbnRhaW5lciBwYXJ0XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAocGFydCA9PT0gJ2dyaWQnIHx8IHBhcnQgPT09ICd0aXRsZScpIHtcbiAgICAgIHJldHVybiAhIXRoaXMuZ2V0KHBhcnQpO1xuICAgIH1cbiAgICAvLyBPdGhlciBwYXJ0cyBhcmUgZW5hYmxlZCBieSBkZWZhdWx0LCBzbyB0aGV5IHNob3VsZCBub3QgYmUgZmFsc2Ugb3IgbnVsbC5cbiAgICByZXR1cm4gIWlzRmFsc2VPck51bGwodGhpcy5nZXQocGFydCkpO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXhpc0NvbXBvbmVudEluZGV4IHtcbiAgeD86IEF4aXNDb21wb25lbnRbXTtcbiAgeT86IEF4aXNDb21wb25lbnRbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBeGlzSW5kZXgge1xuICB4PzogQXhpcztcbiAgeT86IEF4aXM7XG59XG4iXX0=","export function getAxisConfig(property, config, channel, orient, scaleType) {\n    if (orient === void 0) { orient = ''; }\n    // configTypes to loop, starting from higher precedence\n    var configTypes = (scaleType === 'band' ? ['axisBand'] : []).concat([\n        channel === 'x' ? 'axisX' : 'axisY',\n        'axis' + orient.substr(0, 1).toUpperCase() + orient.substr(1),\n        'axis'\n    ]);\n    for (var _i = 0, configTypes_1 = configTypes; _i < configTypes_1.length; _i++) {\n        var configType = configTypes_1[_i];\n        if (config[configType] && config[configType][property] !== undefined) {\n            return config[configType][property];\n        }\n    }\n    return undefined;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlnLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvYXhpcy9jb25maWcudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBSUEsTUFBTSx3QkFBd0IsUUFBZ0IsRUFBRSxNQUFjLEVBQUUsT0FBNkIsRUFBRSxNQUFtQixFQUFFLFNBQW9CO0lBQXpDLHVCQUFBLEVBQUEsV0FBbUI7SUFDaEgsdURBQXVEO0lBQ3ZELElBQU0sV0FBVyxHQUFHLENBQUMsU0FBUyxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDO1FBQ3BFLE9BQU8sS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsT0FBTztRQUNuQyxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFFLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7UUFDNUQsTUFBTTtLQUNQLENBQUMsQ0FBQztJQUNILEtBQXlCLFVBQVcsRUFBWCwyQkFBVyxFQUFYLHlCQUFXLEVBQVgsSUFBVyxFQUFFO1FBQWpDLElBQU0sVUFBVSxvQkFBQTtRQUNuQixJQUFJLE1BQU0sQ0FBQyxVQUFVLENBQUMsSUFBSSxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsUUFBUSxDQUFDLEtBQUssU0FBUyxFQUFFO1lBQ3BFLE9BQU8sTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1NBQ3JDO0tBQ0Y7SUFFRCxPQUFPLFNBQVMsQ0FBQztBQUNuQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtQb3NpdGlvblNjYWxlQ2hhbm5lbH0gZnJvbSAnLi4vLi4vY2hhbm5lbCc7XG5pbXBvcnQge0NvbmZpZ30gZnJvbSAnLi4vLi4vY29uZmlnJztcbmltcG9ydCB7U2NhbGVUeXBlfSBmcm9tICcuLi8uLi9zY2FsZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBeGlzQ29uZmlnKHByb3BlcnR5OiBzdHJpbmcsIGNvbmZpZzogQ29uZmlnLCBjaGFubmVsOiBQb3NpdGlvblNjYWxlQ2hhbm5lbCwgb3JpZW50OiBzdHJpbmcgPSAnJywgc2NhbGVUeXBlOiBTY2FsZVR5cGUpIHtcbiAgLy8gY29uZmlnVHlwZXMgdG8gbG9vcCwgc3RhcnRpbmcgZnJvbSBoaWdoZXIgcHJlY2VkZW5jZVxuICBjb25zdCBjb25maWdUeXBlcyA9IChzY2FsZVR5cGUgPT09ICdiYW5kJyA/IFsnYXhpc0JhbmQnXSA6IFtdKS5jb25jYXQoW1xuICAgIGNoYW5uZWwgPT09ICd4JyA/ICdheGlzWCcgOiAnYXhpc1knLFxuICAgICdheGlzJyArIG9yaWVudC5zdWJzdHIoMCwxKS50b1VwcGVyQ2FzZSgpICsgb3JpZW50LnN1YnN0cigxKSwgLy8gYXhpc1RvcCwgYXhpc0JvdHRvbSwgLi4uXG4gICAgJ2F4aXMnXG4gIF0pO1xuICBmb3IgKGNvbnN0IGNvbmZpZ1R5cGUgb2YgY29uZmlnVHlwZXMpIHtcbiAgICBpZiAoY29uZmlnW2NvbmZpZ1R5cGVdICYmIGNvbmZpZ1tjb25maWdUeXBlXVtwcm9wZXJ0eV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIGNvbmZpZ1tjb25maWdUeXBlXVtwcm9wZXJ0eV07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { X } from '../../channel';\nimport { isTimeFieldDef } from '../../fielddef';\nimport { ScaleType } from '../../scale';\nimport { NOMINAL, ORDINAL } from '../../type';\nimport { contains, keys } from '../../util';\nimport { timeFormatExpression } from '../common';\nimport { getAxisConfig } from './config';\nexport function labels(model, channel, specifiedLabelsSpec, orient) {\n    var fieldDef = model.fieldDef(channel) ||\n        (channel === 'x' ? model.fieldDef('x2') :\n            channel === 'y' ? model.fieldDef('y2') :\n                undefined);\n    var axis = model.axis(channel);\n    var config = model.config;\n    var labelsSpec = {};\n    // Text\n    if (isTimeFieldDef(fieldDef)) {\n        var isUTCScale = model.getScaleComponent(channel).get('type') === ScaleType.UTC;\n        var expr = timeFormatExpression('datum.value', fieldDef.timeUnit, axis.format, config.axis.shortTimeLabels, config.timeFormat, isUTCScale);\n        if (expr) {\n            labelsSpec.text = { signal: expr };\n        }\n    }\n    // Label Angle\n    var angle = getAxisConfig('labelAngle', model.config, channel, orient, model.getScaleComponent(channel).get('type'));\n    if (angle === undefined) {\n        angle = labelAngle(axis, channel, fieldDef);\n        if (angle) {\n            labelsSpec.angle = { value: angle };\n        }\n    }\n    if (angle !== undefined) {\n        var align = labelAlign(angle, orient);\n        if (align) {\n            labelsSpec.align = { value: align };\n        }\n        labelsSpec.baseline = labelBaseline(angle, orient);\n    }\n    labelsSpec = tslib_1.__assign({}, labelsSpec, specifiedLabelsSpec);\n    return keys(labelsSpec).length === 0 ? undefined : labelsSpec;\n}\nexport function labelBaseline(angle, orient) {\n    if (orient === 'top' || orient === 'bottom') {\n        if (angle <= 45 || 315 <= angle) {\n            return { value: orient === 'top' ? 'bottom' : 'top' };\n        }\n        else if (135 <= angle && angle <= 225) {\n            return { value: orient === 'top' ? 'top' : 'bottom' };\n        }\n        else {\n            return { value: 'middle' };\n        }\n    }\n    else {\n        if ((angle <= 45 || 315 <= angle) || (135 <= angle && angle <= 225)) {\n            return { value: 'middle' };\n        }\n        else if (45 <= angle && angle <= 135) {\n            return { value: orient === 'left' ? 'top' : 'bottom' };\n        }\n        else {\n            return { value: orient === 'left' ? 'bottom' : 'top' };\n        }\n    }\n}\nexport function labelAngle(axis, channel, fieldDef) {\n    if (axis.labelAngle !== undefined) {\n        // Make angle within [0,360)\n        return ((axis.labelAngle % 360) + 360) % 360;\n    }\n    else {\n        if (channel === X && contains([NOMINAL, ORDINAL], fieldDef.type)) {\n            return 270;\n        }\n    }\n    return undefined;\n}\nexport function labelAlign(angle, orient) {\n    angle = ((angle % 360) + 360) % 360;\n    if (orient === 'top' || orient === 'bottom') {\n        if (angle % 180 === 0) {\n            return 'center';\n        }\n        else if (0 < angle && angle < 180) {\n            return orient === 'top' ? 'right' : 'left';\n        }\n        else {\n            return orient === 'top' ? 'left' : 'right';\n        }\n    }\n    else {\n        if ((angle + 90) % 180 === 0) {\n            return 'center';\n        }\n        else if (90 <= angle && angle < 270) {\n            return orient === 'left' ? 'left' : 'right';\n        }\n        else {\n            return orient === 'left' ? 'right' : 'left';\n        }\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW5jb2RlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvYXhpcy9lbmNvZGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBLE9BQU8sRUFBZ0MsQ0FBQyxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQy9ELE9BQU8sRUFBVyxjQUFjLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUN4RCxPQUFPLEVBQUMsU0FBUyxFQUFDLE1BQU0sYUFBYSxDQUFDO0FBQ3RDLE9BQU8sRUFBQyxPQUFPLEVBQUUsT0FBTyxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQzVDLE9BQU8sRUFBQyxRQUFRLEVBQUUsSUFBSSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBRTFDLE9BQU8sRUFBQyxvQkFBb0IsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUUvQyxPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0sVUFBVSxDQUFDO0FBRXZDLE1BQU0saUJBQWlCLEtBQWdCLEVBQUUsT0FBNkIsRUFBRSxtQkFBd0IsRUFBRSxNQUFrQjtJQUNsSCxJQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQztRQUN0QyxDQUNFLE9BQU8sS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztZQUN4QyxPQUFPLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7Z0JBQ3hDLFNBQVMsQ0FDVixDQUFDO0lBQ0osSUFBTSxJQUFJLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNqQyxJQUFNLE1BQU0sR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDO0lBRTVCLElBQUksVUFBVSxHQUFRLEVBQUUsQ0FBQztJQUV6QixPQUFPO0lBQ1AsSUFBSSxjQUFjLENBQUMsUUFBUSxDQUFDLEVBQUU7UUFD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Q0Y7U0FBTTtRQUNMLElBQUksQ0FBQyxLQUFLLEdBQUcsRUFBRSxDQUFDLEdBQUcsR0FBRyxLQUFLLENBQUMsRUFBRTtZQUM1QixPQUFPLFFBQVEsQ0FBQztTQUNqQjthQUFNLElBQUksRUFBRSxJQUFJLEtBQUssSUFBSSxLQUFLLEdBQUcsR0FBRyxFQUFFO1lBQ3JDLE9BQU8sTUFBTSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUM7U0FDN0M7YUFBTTtZQUNMLE9BQU8sTUFBTSxLQUFLLE1BQU0sQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUM7U0FDN0M7S0FDRjtBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0F4aXN9IGZyb20gJy4uLy4uL2F4aXMnO1xuaW1wb3J0IHtDaGFubmVsLCBQb3NpdGlvblNjYWxlQ2hhbm5lbCwgWH0gZnJvbSAnLi4vLi4vY2hhbm5lbCc7XG5pbXBvcnQge0ZpZWxkRGVmLCBpc1RpbWVGaWVsZERlZn0gZnJvbSAnLi4vLi4vZmllbGRkZWYnO1xuaW1wb3J0IHtTY2FsZVR5cGV9IGZyb20gJy4uLy4uL3NjYWxlJztcbmltcG9ydCB7Tk9NSU5BTCwgT1JESU5BTH0gZnJvbSAnLi4vLi4vdHlwZSc7XG5pbXBvcnQge2NvbnRhaW5zLCBrZXlzfSBmcm9tICcuLi8uLi91dGlsJztcbmltcG9ydCB7QXhpc09yaWVudCwgSG9yaXpvbnRhbEFsaWdufSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge3RpbWVGb3JtYXRFeHByZXNzaW9ufSBmcm9tICcuLi9jb21tb24nO1xuaW1wb3J0IHtVbml0TW9kZWx9IGZyb20gJy4uL3VuaXQnO1xuaW1wb3J0IHtnZXRBeGlzQ29uZmlnfSBmcm9tICcuL2NvbmZpZyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBsYWJlbHMobW9kZWw6IFVuaXRNb2RlbCwgY2hhbm5lbDogUG9zaXRpb25TY2FsZUNoYW5uZWwsIHNwZWNpZmllZExhYmVsc1NwZWM6IGFueSwgb3JpZW50OiBBeGlzT3JpZW50KSB7XG4gIGNvbnN0IGZpZWxkRGVmID0gbW9kZWwuZmllbGREZWYoY2hhbm5lbCkgfHxcbiAgICAoXG4gICAgICBjaGFubmVsID09PSAneCcgPyBtb2RlbC5maWVsZERlZigneDInKSA6XG4gICAgICBjaGFubmVsID09PSAneScgPyBtb2RlbC5maWVsZERlZigneTInKSA6XG4gICAgICB1bmRlZmluZWRcbiAgICApO1xuICBjb25zdCBheGlzID0gbW9kZWwuYXhpcyhjaGFubmVsKTtcbiAgY29uc3QgY29uZmlnID0gbW9kZWwuY29uZmlnO1xuXG4gIGxldCBsYWJlbHNTcGVjOiBhbnkgPSB7fTtcblxuICAvLyBUZXh0XG4gIGlmIChpc1RpbWVGaWVsZERlZihmaWVsZERlZikpIHtcbiAgICBjb25zdCBpc1VUQ1NjYWxlID0gbW9kZWwuZ2V0U2NhbGVDb21wb25lbnQoY2hhbm5lbCkuZ2V0KCd0eXBlJykgPT09IFNjYWxlVHlwZS5VVEM7XG5cbiAgICBjb25zdCBleHByID0gdGltZUZvcm1hdEV4cHJlc3Npb24oJ2RhdHVtLnZhbHVlJywgZmllbGREZWYudGltZVVuaXQsIGF4aXMuZm9ybWF0LCBjb25maWcuYXhpcy5zaG9ydFRpbWVMYWJlbHMsIGNvbmZpZy50aW1lRm9ybWF0LCBpc1VUQ1NjYWxlKTtcblxuICAgIGlmIChleHByKSB7XG4gICAgICBsYWJlbHNTcGVjLnRleHQgPSB7c2lnbmFsOiBleHByfTtcbiAgICB9XG4gIH1cblxuICAvLyBMYWJlbCBBbmdsZVxuICBsZXQgYW5nbGUgPSBnZXRBeGlzQ29uZmlnKCdsYWJlbEFuZ2xlJywgbW9kZWwuY29uZmlnLCBjaGFubmVsLCBvcmllbnQsIG1vZGVsLmdldFNjYWxlQ29tcG9uZW50KGNoYW5uZWwpLmdldCgndHlwZScpKTtcbiAgaWYgKGFuZ2xlID09PSB1bmRlZmluZWQpIHtcbiAgICBhbmdsZSA9IGxhYmVsQW5nbGUoYXhpcywgY2hhbm5lbCwgZmllbGREZWYpO1xuICAgIGlmIChhbmdsZSkge1xuICAgICAgbGFiZWxzU3BlYy5hbmdsZSA9IHt2YWx1ZTogYW5nbGV9O1xuICAgIH1cbiAgfVxuXG4gIGlmIChhbmdsZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgY29uc3QgYWxpZ24gPSBsYWJlbEFsaWduKGFuZ2xlLCBvcmllbnQpO1xuICAgIGlmIChhbGlnbikge1xuICAgICAgbGFiZWxzU3BlYy5hbGlnbiA9IHt2YWx1ZTogYWxpZ259O1xuICAgIH1cblxuICAgIGxhYmVsc1NwZWMuYmFzZWxpbmUgPSBsYWJlbEJhc2VsaW5lKGFuZ2xlLCBvcmllbnQpO1xuICB9XG5cbiAgbGFiZWxzU3BlYyA9IHtcbiAgICAuLi5sYWJlbHNTcGVjLFxuICAgIC4uLnNwZWNpZmllZExhYmVsc1NwZWNcbiAgfTtcblxuICByZXR1cm4ga2V5cyhsYWJlbHNTcGVjKS5sZW5ndGggPT09IDAgPyB1bmRlZmluZWQgOiBsYWJlbHNTcGVjO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbGFiZWxCYXNlbGluZShhbmdsZTogbnVtYmVyLCBvcmllbnQ6IEF4aXNPcmllbnQpIHtcbiAgaWYgKG9yaWVudCA9PT0gJ3RvcCcgfHwgb3JpZW50ID09PSAnYm90dG9tJykge1xuICAgIGlmIChhbmdsZSA8PSA0NSB8fCAzMTUgPD0gYW5nbGUpIHtcbiAgICAgIHJldHVybiB7dmFsdWU6IG9yaWVudCA9PT0gJ3RvcCcgPyAnYm90dG9tJyA6ICd0b3AnfTtcbiAgICB9IGVsc2UgaWYgKDEzNSA8PSBhbmdsZSAmJiBhbmdsZSA8PSAyMjUpIHtcbiAgICAgIHJldHVybiB7dmFsdWU6IG9yaWVudCA9PT0gJ3RvcCcgPyAndG9wJzogJ2JvdHRvbSd9O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4ge3ZhbHVlOiAnbWlkZGxlJ307XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGlmICgoYW5nbGUgPD0gNDUgfHwgMzE1IDw9IGFuZ2xlKSB8fCAoMTM1IDw9IGFuZ2xlICYmIGFuZ2xlIDw9IDIyNSkpIHtcbiAgICAgIHJldHVybiB7dmFsdWU6ICdtaWRkbGUnfTtcbiAgICB9IGVsc2UgaWYgKDQ1IDw9IGFuZ2xlICYmIGFuZ2xlIDw9IDEzNSkge1xuICAgICAgcmV0dXJuIHt2YWx1ZTogb3JpZW50ID09PSAnbGVmdCcgPyAndG9wJyA6ICdib3R0b20nfTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHt2YWx1ZTogb3JpZW50ID09PSAnbGVmdCcgPyAnYm90dG9tJyA6ICd0b3AnfTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxhYmVsQW5nbGUoYXhpczogQXhpcywgY2hhbm5lbDogQ2hhbm5lbCwgZmllbGREZWY6IEZpZWxkRGVmPHN0cmluZz4pIHtcbiAgaWYgKGF4aXMubGFiZWxBbmdsZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gTWFrZSBhbmdsZSB3aXRoaW4gWzAsMzYwKVxuICAgIHJldHVybiAoKGF4aXMubGFiZWxBbmdsZSAlIDM2MCkgKyAzNjApICUgMzYwO1xuICB9IGVsc2Uge1xuICAgIGlmIChjaGFubmVsID09PSBYICYmIGNvbnRhaW5zKFtOT01JTkFMLCBPUkRJTkFMXSwgZmllbGREZWYudHlwZSkpIHtcbiAgICAgIHJldHVybiAyNzA7XG4gICAgfVxuICB9XG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsYWJlbEFsaWduKGFuZ2xlOiBudW1iZXIsIG9yaWVudDogQXhpc09yaWVudCk6IEhvcml6b250YWxBbGlnbiB7XG4gIGFuZ2xlID0gKChhbmdsZSAlIDM2MCkgKyAzNjApICUgMzYwO1xuICBpZiAob3JpZW50ID09PSAndG9wJyB8fCBvcmllbnQgPT09ICdib3R0b20nKSB7XG4gICAgaWYgKGFuZ2xlICUgMTgwID09PSAwKSB7XG4gICAgICByZXR1cm4gJ2NlbnRlcic7XG4gICAgfSBlbHNlIGlmICgwIDwgYW5nbGUgJiYgYW5nbGUgPCAxODApIHtcbiAgICAgIHJldHVybiBvcmllbnQgPT09ICd0b3AnID8gJ3JpZ2h0JyA6ICdsZWZ0JztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG9yaWVudCA9PT0gJ3RvcCcgPyAnbGVmdCcgOiAncmlnaHQnO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAoKGFuZ2xlICsgOTApICUgMTgwID09PSAwKSB7XG4gICAgICByZXR1cm4gJ2NlbnRlcic7XG4gICAgfSBlbHNlIGlmICg5MCA8PSBhbmdsZSAmJiBhbmdsZSA8IDI3MCkge1xuICAgICAgcmV0dXJuIG9yaWVudCA9PT0gJ2xlZnQnID8gJ2xlZnQnIDogJ3JpZ2h0JztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG9yaWVudCA9PT0gJ2xlZnQnID8gJ3JpZ2h0JyA6ICdsZWZ0JztcbiAgICB9XG4gIH1cbn1cblxuIl19","import { truncate } from 'vega-util';\nimport { binToString } from '../../bin';\nimport { X, Y } from '../../channel';\nimport { dateTimeExpr, isDateTime } from '../../datetime';\nimport { title as fieldDefTitle } from '../../fielddef';\nimport * as log from '../../log';\nimport { hasDiscreteDomain, isSelectionDomain } from '../../scale';\nimport { QUANTITATIVE } from '../../type';\nimport { contains } from '../../util';\n// TODO: we need to refactor this method after we take care of config refactoring\n/**\n * Default rules for whether to show a grid should be shown for a channel.\n * If `grid` is unspecified, the default value is `true` for ordinal scales that are not binned\n */\nexport function grid(scaleType, fieldDef) {\n    return !hasDiscreteDomain(scaleType) && !fieldDef.bin;\n}\nexport function gridScale(model, channel) {\n    var gridChannel = channel === 'x' ? 'y' : 'x';\n    if (model.getScaleComponent(gridChannel)) {\n        return model.scaleName(gridChannel);\n    }\n    return undefined;\n}\nexport function labelFlush(fieldDef, channel, specifiedAxis) {\n    if (specifiedAxis.labelFlush !== undefined) {\n        return specifiedAxis.labelFlush;\n    }\n    if (channel === 'x' && contains(['quantitative', 'temporal'], fieldDef.type)) {\n        return true;\n    }\n    return undefined;\n}\nexport function labelOverlap(fieldDef, specifiedAxis, channel, scaleType) {\n    if (specifiedAxis.labelOverlap !== undefined) {\n        return specifiedAxis.labelOverlap;\n    }\n    // do not prevent overlap for nominal data because there is no way to infer what the missing labels are\n    if (fieldDef.type !== 'nominal') {\n        if (scaleType === 'log') {\n            return 'greedy';\n        }\n        return true;\n    }\n    return undefined;\n}\nexport function orient(channel) {\n    switch (channel) {\n        case X:\n            return 'bottom';\n        case Y:\n            return 'left';\n    }\n    /* istanbul ignore next: This should never happen. */\n    throw new Error(log.message.INVALID_CHANNEL_FOR_AXIS);\n}\nexport function tickCount(channel, fieldDef, scaleType, size) {\n    if (!hasDiscreteDomain(scaleType) && scaleType !== 'log' && !contains(['month', 'hours', 'day', 'quarter'], fieldDef.timeUnit)) {\n        if (fieldDef.bin) {\n            // for binned data, we don't want more ticks than maxbins\n            return { signal: \"ceil(\" + size.signal + \"/20)\" };\n        }\n        return { signal: \"ceil(\" + size.signal + \"/40)\" };\n    }\n    return undefined;\n}\nexport function title(maxLength, fieldDef, config) {\n    // if not defined, automatically determine axis title from field def\n    var fieldTitle = fieldDefTitle(fieldDef, config);\n    return maxLength ? truncate(fieldTitle, maxLength) : fieldTitle;\n}\nexport function values(specifiedAxis, model, fieldDef, channel) {\n    var vals = specifiedAxis.values;\n    if (specifiedAxis.values && isDateTime(vals[0])) {\n        return vals.map(function (dt) {\n            // normalize = true as end user won't put 0 = January\n            return { signal: dateTimeExpr(dt, true) };\n        });\n    }\n    if (!vals && fieldDef.bin && fieldDef.type === QUANTITATIVE) {\n        var domain = model.scaleDomain(channel);\n        if (domain && domain !== 'unaggregated' && !isSelectionDomain(domain)) { // explicit value\n            return vals;\n        }\n        var signal = model.getName(binToString(fieldDef.bin) + \"_\" + fieldDef.field + \"_bins\");\n        return { signal: \"sequence(\" + signal + \".start, \" + signal + \".stop + \" + signal + \".step, \" + signal + \".step)\" };\n    }\n    return vals;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvcGVydGllcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21waWxlL2F4aXMvcHJvcGVydGllcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsUUFBUSxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBRW5DLE9BQU8sRUFBQyxXQUFXLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDdEMsT0FBTyxFQUF1QixDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBRXpELE9BQU8sRUFBVyxZQUFZLEVBQUUsVUFBVSxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDbEUsT0FBTyxFQUFXLEtBQUssSUFBSSxhQUFhLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUNoRSxPQUFPLEtBQUssR0FBRyxNQUFNLFdBQVcsQ0FBQztBQUNqQyxPQUFPLEVBQUMsaUJBQWlCLEVBQUUsaUJBQWlCLEVBQVksTUFBTSxhQUFhLENBQUM7QUFDNUUsT0FBTyxFQUFDLFlBQVksRUFBQyxNQUFNLFlBQVksQ0FBQztBQUN4QyxPQUFPLEVBQUMsUUFBUSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBS3BDLGlGQUFpRjtBQUNqRjs7O0dBR0c7QUFDSCxNQUFNLGVBQWUsU0FBb0IsRUFBRSxRQUEwQjtJQUNuRSxPQUFPLENBQUMsaUJBQWlCLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDO0FBQ3hELENBQUM7QUFFRCxNQUFNLG9CQUFvQixLQUFnQixFQUFFLE9BQTZCO0lBQ3ZFLElBQU0sV0FBVyxHQUF5QixPQUFPLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztJQUN0RSxJQUFJLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxXQUFXLENBQUMsRUFBRTtRQUN4QyxPQUFPLEtBQUssQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUM7S0FDckM7SUFD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QVEsQ0FBQyxJQUFJLEtBQUssWUFBWSxFQUFFO1FBQzNELElBQU0sTUFBTSxHQUFHLEtBQUssQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDMUMsSUFBSSxNQUFNLElBQUksTUFBTSxLQUFLLGNBQWMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsaUJBQWlCO1lBQ3hGLE9BQU8sSUFBSSxDQUFDO1NBQ2I7UUFDRCxJQUFNLE1BQU0sR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFJLFdBQVcsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLFNBQUksUUFBUSxDQUFDLEtBQUssVUFBTyxDQUFDLENBQUM7UUFDcEYsT0FBTyxFQUFDLE1BQU0sRUFBRSxjQUFZLE1BQU0sZ0JBQVcsTUFBTSxnQkFBVyxNQUFNLGVBQVUsTUFBTSxXQUFRLEVBQUMsQ0FBQztLQUMvRjtJQUVELE9BQU8sSUFBSSxDQUFDO0FBQ2QsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7dHJ1bmNhdGV9IGZyb20gJ3ZlZ2EtdXRpbCc7XG5pbXBvcnQge0F4aXN9IGZyb20gJy4uLy4uL2F4aXMnO1xuaW1wb3J0IHtiaW5Ub1N0cmluZ30gZnJvbSAnLi4vLi4vYmluJztcbmltcG9ydCB7UG9zaXRpb25TY2FsZUNoYW5uZWwsIFgsIFl9IGZyb20gJy4uLy4uL2NoYW5uZWwnO1xuaW1wb3J0IHtDb25maWd9IGZyb20gJy4uLy4uL2NvbmZpZyc7XG5pbXBvcnQge0RhdGVUaW1lLCBkYXRlVGltZUV4cHIsIGlzRGF0ZVRpbWV9IGZyb20gJy4uLy4uL2RhdGV0aW1lJztcbmltcG9ydCB7RmllbGREZWYsIHRpdGxlIGFzIGZpZWxkRGVmVGl0bGV9IGZyb20gJy4uLy4uL2ZpZWxkZGVmJztcbmltcG9ydCAqIGFzIGxvZyBmcm9tICcuLi8uLi9sb2cnO1xuaW1wb3J0IHtoYXNEaXNjcmV0ZURvbWFpbiwgaXNTZWxlY3Rpb25Eb21haW4sIFNjYWxlVHlwZX0gZnJvbSAnLi4vLi4vc2NhbGUnO1xuaW1wb3J0IHtRVUFOVElUQVRJVkV9IGZyb20gJy4uLy4uL3R5cGUnO1xuaW1wb3J0IHtjb250YWluc30gZnJvbSAnLi4vLi4vdXRpbCc7XG5pbXBvcnQge1ZnU2lnbmFsUmVmfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge1VuaXRNb2RlbH0gZnJvbSAnLi4vdW5pdCc7XG5cblxuLy8gVE9ETzogd2UgbmVlZCB0byByZWZhY3RvciB0aGlzIG1ldGhvZCBhZnRlciB3ZSB0YWtlIGNhcmUgb2YgY29uZmlnIHJlZmFjdG9yaW5nXG4vKipcbiAqIERlZmF1bHQgcnVsZXMgZm9yIHdoZXRoZXIgdG8gc2hvdyBhIGdyaWQgc2hvdWxkIGJlIHNob3duIGZvciBhIGNoYW5uZWwuXG4gKiBJZiBgZ3JpZGAgaXMgdW5zcGVjaWZpZWQsIHRoZSBkZWZhdWx0IHZhbHVlIGlzIGB0cnVlYCBmb3Igb3JkaW5hbCBzY2FsZXMgdGhhdCBhcmUgbm90IGJpbm5lZFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ3JpZChzY2FsZVR5cGU6IFNjYWxlVHlwZSwgZmllbGREZWY6IEZpZWxkRGVmPHN0cmluZz4pIHtcbiAgcmV0dXJuICFoYXNEaXNjcmV0ZURvbWFpbihzY2FsZVR5cGUpICYmICFmaWVsZERlZi5iaW47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBncmlkU2NhbGUobW9kZWw6IFVuaXRNb2RlbCwgY2hhbm5lbDogUG9zaXRpb25TY2FsZUNoYW5uZWwpIHtcbiAgY29uc3QgZ3JpZENoYW5uZWw6IFBvc2l0aW9uU2NhbGVDaGFubmVsID0gY2hhbm5lbCA9PT0gJ3gnID8gJ3knIDogJ3gnO1xuICBpZiAobW9kZWwuZ2V0U2NhbGVDb21wb25lbnQoZ3JpZENoYW5uZWwpKSB7XG4gICAgcmV0dXJuIG1vZGVsLnNjYWxlTmFtZShncmlkQ2hhbm5lbCk7XG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGxhYmVsRmx1c2goZmllbGREZWY6IEZpZWxkRGVmPHN0cmluZz4sIGNoYW5uZWw6IFBvc2l0aW9uU2NhbGVDaGFubmVsLCBzcGVjaWZpZWRBeGlzOiBBeGlzKSB7XG4gIGlmIChzcGVjaWZpZWRBeGlzLmxhYmVsRmx1c2ggIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBzcGVjaWZpZWRBeGlzLmxhYmVsRmx1c2g7XG4gIH1cbiAgaWYgKGNoYW5uZWwgPT09ICd4JyAmJiBjb250YWlucyhbJ3F1YW50aXRhdGl2ZScsICd0ZW1wb3JhbCddLCBmaWVsZERlZi50eXBlKSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsYWJlbE92ZXJsYXAoZmllbGREZWY6IEZpZWxkRGVmPHN0cmluZz4sIHNwZWNpZmllZEF4aXM6IEF4aXMsIGNoYW5uZWw6IFBvc2l0aW9uU2NhbGVDaGFubmVsLCBzY2FsZVR5cGU6IFNjYWxlVHlwZSkge1xuICBpZiAoc3BlY2lmaWVkQXhpcy5sYWJlbE92ZXJsYXAgIT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiBzcGVjaWZpZWRBeGlzLmxhYmVsT3ZlcmxhcDtcbiAgfVxuXG4gIC8vIGRvIG5vdCBwcmV2ZW50IG92ZXJsYXAgZm9yIG5vbWluYWwgZGF0YSBiZWNhdXNlIHRoZXJlIGlzIG5vIHdheSB0byBpbmZlciB3aGF0IHRoZSBtaXNzaW5nIGxhYmVscyBhcmVcbiAgaWYgKGZpZWxkRGVmLnR5cGUgIT09ICdub21pbmFsJykge1xuICAgIGlmIChzY2FsZVR5cGUgPT09ICdsb2cnKSB7XG4gICAgICByZXR1cm4gJ2dyZWVkeSc7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG9yaWVudChjaGFubmVsOiBQb3NpdGlvblNjYWxlQ2hhbm5lbCkge1xuICBzd2l0Y2ggKGNoYW5uZWwpIHtcbiAgICBjYXNlIFg6XG4gICAgICByZXR1cm4gJ2JvdHRvbSc7XG4gICAgY2FzZSBZOlxuICAgICAgcmV0dXJuICdsZWZ0JztcbiAgfVxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dDogVGhpcyBzaG91bGQgbmV2ZXIgaGFwcGVuLiAqL1xuICB0aHJvdyBuZXcgRXJyb3IobG9nLm1lc3NhZ2UuSU5WQUxJRF9DSEFOTkVMX0ZPUl9BWElTKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRpY2tDb3VudChjaGFubmVsOiBQb3NpdGlvblNjYWxlQ2hhbm5lbCwgZmllbGREZWY6IEZpZWxkRGVmPHN0cmluZz4sIHNjYWxlVHlwZTogU2NhbGVUeXBlLCBzaXplOiBWZ1NpZ25hbFJlZikge1xuICBpZiAoIWhhc0Rpc2NyZXRlRG9tYWluKHNjYWxlVHlwZSkgJiYgc2NhbGVUeXBlICE9PSAnbG9nJyAmJiAhY29udGFpbnMoWydtb250aCcsICdob3VycycsICdkYXknLCAncXVhcnRlciddLCBmaWVsZERlZi50aW1lVW5pdCkpIHtcblxuICAgIGlmIChmaWVsZERlZi5iaW4pIHtcbiAgICAgIC8vIGZvciBiaW5uZWQgZGF0YSwgd2UgZG9uJ3Qgd2FudCBtb3JlIHRpY2tzIHRoYW4gbWF4Ymluc1xuICAgICAgcmV0dXJuIHtzaWduYWw6IGBjZWlsKCR7c2l6ZS5zaWduYWx9LzIwKWB9O1xuICAgIH1cbiAgICByZXR1cm4ge3NpZ25hbDogYGNlaWwoJHtzaXplLnNpZ25hbH0vNDApYH07XG4gIH1cblxuICByZXR1cm4gdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdGl0bGUobWF4TGVuZ3RoOiBudW1iZXIsIGZpZWxkRGVmOiBGaWVsZERlZjxzdHJpbmc+LCBjb25maWc6IENvbmZpZykge1xuICAvLyBpZiBub3QgZGVmaW5lZCwgYXV0b21hdGljYWxseSBkZXRlcm1pbmUgYXhpcyB0aXRsZSBmcm9tIGZpZWxkIGRlZlxuICBjb25zdCBmaWVsZFRpdGxlID0gZmllbGREZWZUaXRsZShmaWVsZERlZiwgY29uZmlnKTtcbiAgcmV0dXJuIG1heExlbmd0aCA/IHRydW5jYXRlKGZpZWxkVGl0bGUsIG1heExlbmd0aCkgOiBmaWVsZFRpdGxlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsdWVzKHNwZWNpZmllZEF4aXM6IEF4aXMsIG1vZGVsOiBVbml0TW9kZWwsIGZpZWxkRGVmOiBGaWVsZERlZjxzdHJpbmc+LCBjaGFubmVsOiBQb3NpdGlvblNjYWxlQ2hhbm5lbCkge1xuICBjb25zdCB2YWxzID0gc3BlY2lmaWVkQXhpcy52YWx1ZXM7XG4gIGlmIChzcGVjaWZpZWRBeGlzLnZhbHVlcyAmJiBpc0RhdGVUaW1lKHZhbHNbMF0pKSB7XG4gICAgcmV0dXJuICh2YWxzIGFzIERhdGVUaW1lW10pLm1hcCgoZHQpID0+IHtcbiAgICAgIC8vIG5vcm1hbGl6ZSA9IHRydWUgYXMgZW5kIHVzZXIgd29uJ3QgcHV0IDAgPSBKYW51YXJ5XG4gICAgICByZXR1cm4ge3NpZ25hbDogZGF0ZVRpbWVFeHByKGR0LCB0cnVlKX07XG4gICAgfSk7XG4gIH1cblxuICBpZiAoIXZhbHMgJiYgZmllbGREZWYuYmluICYmIGZpZWxkRGVmLnR5cGUgPT09IFFVQU5USVRBVElWRSkge1xuICAgIGNvbnN0IGRvbWFpbiA9IG1vZGVsLnNjYWxlRG9tYWluKGNoYW5uZWwpO1xuICAgIGlmIChkb21haW4gJiYgZG9tYWluICE9PSAndW5hZ2dyZWdhdGVkJyAmJiAhaXNTZWxlY3Rpb25Eb21haW4oZG9tYWluKSkgeyAvLyBleHBsaWNpdCB2YWx1ZVxuICAgICAgcmV0dXJuIHZhbHM7XG4gICAgfVxuICAgIGNvbnN0IHNpZ25hbCA9IG1vZGVsLmdldE5hbWUoYCR7YmluVG9TdHJpbmcoZmllbGREZWYuYmluKX1fJHtmaWVsZERlZi5maWVsZH1fYmluc2ApO1xuICAgIHJldHVybiB7c2lnbmFsOiBgc2VxdWVuY2UoJHtzaWduYWx9LnN0YXJ0LCAke3NpZ25hbH0uc3RvcCArICR7c2lnbmFsfS5zdGVwLCAke3NpZ25hbH0uc3RlcClgfTtcbiAgfVxuXG4gIHJldHVybiB2YWxzO1xufVxuIl19","import { AXIS_PARTS, isAxisProperty, VG_AXIS_PROPERTIES } from '../../axis';\nimport { POSITION_SCALE_CHANNELS, X, Y } from '../../channel';\nimport { toFieldDefBase } from '../../fielddef';\nimport { keys } from '../../util';\nimport { getSpecifiedOrDefaultValue, guideEncodeEntry, mergeTitle, mergeTitleComponent, mergeTitleFieldDefs, numberFormat } from '../common';\nimport { parseGuideResolve } from '../resolve';\nimport { defaultTieBreaker, mergeValuesWithExplicit } from '../split';\nimport { AxisComponent } from './component';\nimport { getAxisConfig } from './config';\nimport * as encode from './encode';\nimport * as properties from './properties';\nexport function parseUnitAxis(model) {\n    return POSITION_SCALE_CHANNELS.reduce(function (axis, channel) {\n        if (model.component.scales[channel] && model.axis(channel)) {\n            axis[channel] = [parseAxis(channel, model)];\n        }\n        return axis;\n    }, {});\n}\nvar OPPOSITE_ORIENT = {\n    bottom: 'top',\n    top: 'bottom',\n    left: 'right',\n    right: 'left'\n};\nexport function parseLayerAxis(model) {\n    var _a = model.component, axes = _a.axes, resolve = _a.resolve;\n    var axisCount = { top: 0, bottom: 0, right: 0, left: 0 };\n    for (var _i = 0, _b = model.children; _i < _b.length; _i++) {\n        var child = _b[_i];\n        child.parseAxisAndHeader();\n        for (var _c = 0, _d = keys(child.component.axes); _c < _d.length; _c++) {\n            var channel = _d[_c];\n            resolve.axis[channel] = parseGuideResolve(model.component.resolve, channel);\n            if (resolve.axis[channel] === 'shared') {\n                // If the resolve says shared (and has not been overridden)\n                // We will try to merge and see if there is a conflict\n                axes[channel] = mergeAxisComponents(axes[channel], child.component.axes[channel]);\n                if (!axes[channel]) {\n                    // If merge returns nothing, there is a conflict so we cannot make the axis shared.\n                    // Thus, mark axis as independent and remove the axis component.\n                    resolve.axis[channel] = 'independent';\n                    delete axes[channel];\n                }\n            }\n        }\n    }\n    // Move axes to layer's axis component and merge shared axes\n    for (var _e = 0, _f = [X, Y]; _e < _f.length; _e++) {\n        var channel = _f[_e];\n        for (var _g = 0, _h = model.children; _g < _h.length; _g++) {\n            var child = _h[_g];\n            if (!child.component.axes[channel]) {\n                // skip if the child does not have a particular axis\n                continue;\n            }\n            if (resolve.axis[channel] === 'independent') {\n                // If axes are independent, concat the axisComponent array.\n                axes[channel] = (axes[channel] || []).concat(child.component.axes[channel]);\n                // Automatically adjust orient\n                for (var _j = 0, _k = child.component.axes[channel]; _j < _k.length; _j++) {\n                    var axisComponent = _k[_j];\n                    var _l = axisComponent.getWithExplicit('orient'), orient = _l.value, explicit = _l.explicit;\n                    if (axisCount[orient] > 0 && !explicit) {\n                        // Change axis orient if the number do not match\n                        var oppositeOrient = OPPOSITE_ORIENT[orient];\n                        if (axisCount[orient] > axisCount[oppositeOrient]) {\n                            axisComponent.set('orient', oppositeOrient, false);\n                        }\n                    }\n                    axisCount[orient]++;\n                    // TODO(https://github.com/vega/vega-lite/issues/2634): automaticaly add extra offset?\n                }\n            }\n            // After merging, make sure to remove axes from child\n            delete child.component.axes[channel];\n        }\n    }\n}\nfunction mergeAxisComponents(mergedAxisCmpts, childAxisCmpts) {\n    if (mergedAxisCmpts) {\n        // FIXME: this is a bit wrong once we support multiple axes\n        if (mergedAxisCmpts.length !== childAxisCmpts.length) {\n            return undefined; // Cannot merge axis component with different number of axes.\n        }\n        var length_1 = mergedAxisCmpts.length;\n        for (var i = 0; i < length_1; i++) {\n            var merged = mergedAxisCmpts[i];\n            var child = childAxisCmpts[i];\n            if ((!!merged) !== (!!child)) {\n                return undefined;\n            }\n            else if (merged && child) {\n                var mergedOrient = merged.getWithExplicit('orient');\n                var childOrient = child.getWithExplicit('orient');\n                if (mergedOrient.explicit && childOrient.explicit && mergedOrient.value !== childOrient.value) {\n                    // TODO: throw warning if resolve is explicit (We don't have info about explicit/implicit resolve yet.)\n                    // Cannot merge due to inconsistent orient\n                    return undefined;\n                }\n                else {\n                    mergedAxisCmpts[i] = mergeAxisComponent(merged, child);\n                }\n            }\n        }\n    }\n    else {\n        // For first one, return a copy of the child\n        return childAxisCmpts.map(function (axisComponent) { return axisComponent.clone(); });\n    }\n    return mergedAxisCmpts;\n}\nfunction mergeAxisComponent(merged, child) {\n    var _loop_1 = function (prop) {\n        var mergedValueWithExplicit = mergeValuesWithExplicit(merged.getWithExplicit(prop), child.getWithExplicit(prop), prop, 'axis', \n        // Tie breaker function\n        function (v1, v2) {\n            switch (prop) {\n                case 'title':\n                    return mergeTitleComponent(v1, v2);\n                case 'gridScale':\n                    return {\n                        explicit: v1.explicit,\n                        value: v1.value || v2.value\n                    };\n            }\n            return defaultTieBreaker(v1, v2, prop, 'axis');\n        });\n        merged.setWithExplicit(prop, mergedValueWithExplicit);\n    };\n    for (var _i = 0, VG_AXIS_PROPERTIES_1 = VG_AXIS_PROPERTIES; _i < VG_AXIS_PROPERTIES_1.length; _i++) {\n        var prop = VG_AXIS_PROPERTIES_1[_i];\n        _loop_1(prop);\n    }\n    return merged;\n}\nfunction getFieldDefTitle(model, channel) {\n    var channel2 = channel === 'x' ? 'x2' : 'y2';\n    var fieldDef = model.fieldDef(channel);\n    var fieldDef2 = model.fieldDef(channel2);\n    var title1 = fieldDef ? fieldDef.title : undefined;\n    var title2 = fieldDef2 ? fieldDef2.title : undefined;\n    if (title1 && title2) {\n        return mergeTitle(title1, title2);\n    }\n    else if (title1) {\n        return title1;\n    }\n    else if (title2) {\n        return title2;\n    }\n    else if (title1 !== undefined) { // falsy value to disable config\n        return title1;\n    }\n    else if (title2 !== undefined) { // falsy value to disable config\n        return title2;\n    }\n    return undefined;\n}\nfunction parseAxis(channel, model) {\n    var axis = model.axis(channel);\n    var axisComponent = new AxisComponent();\n    // 1.2. Add properties\n    VG_AXIS_PROPERTIES.forEach(function (property) {\n        var value = getProperty(property, axis, channel, model);\n        if (value !== undefined) {\n            var explicit = \n            // specified axis.values is already respected, but may get transformed.\n            property === 'values' ? !!axis.values :\n                // both VL axis.encoding and axis.labelAngle affect VG axis.encode\n                property === 'encode' ? !!axis.encoding || !!axis.labelAngle :\n                    // title can be explicit if fieldDef.title is set\n                    property === 'title' && value === getFieldDefTitle(model, channel) ? true :\n                        // Otherwise, things are explicit if the returned value matches the specified property\n                        value === axis[property];\n            var configValue = getAxisConfig(property, model.config, channel, axisComponent.get('orient'), model.getScaleComponent(channel).get('type'));\n            // only set property if it is explicitly set or has no config value (otherwise we will accidentally override config)\n            if (explicit || configValue === undefined) {\n                // Do not apply implicit rule if there is a config value\n                axisComponent.set(property, value, explicit);\n            }\n            else if (property === 'grid' && configValue) {\n                // Grid is an exception because we need to set grid = true to generate another grid axis\n                axisComponent.set(property, configValue, false);\n            }\n        }\n    });\n    // 2) Add guide encode definition groups\n    var axisEncoding = axis.encoding || {};\n    var axisEncode = AXIS_PARTS.reduce(function (e, part) {\n        if (!axisComponent.hasAxisPart(part)) {\n            // No need to create encode for a disabled part.\n            return e;\n        }\n        var axisEncodingPart = guideEncodeEntry(axisEncoding[part] || {}, model);\n        var value = part === 'labels' ?\n            encode.labels(model, channel, axisEncodingPart, axisComponent.get('orient')) :\n            axisEncodingPart;\n        if (value !== undefined && keys(value).length > 0) {\n            e[part] = { update: value };\n        }\n        return e;\n    }, {});\n    // FIXME: By having encode as one property, we won't have fine grained encode merging.\n    if (keys(axisEncode).length > 0) {\n        axisComponent.set('encode', axisEncode, !!axis.encoding || axis.labelAngle !== undefined);\n    }\n    return axisComponent;\n}\nfunction getProperty(property, specifiedAxis, channel, model) {\n    var fieldDef = model.fieldDef(channel);\n    switch (property) {\n        case 'scale':\n            return model.scaleName(channel);\n        case 'gridScale':\n            return properties.gridScale(model, channel);\n        case 'format':\n            // We don't include temporal field here as we apply format in encode block\n            return numberFormat(fieldDef, specifiedAxis.format, model.config);\n        case 'grid': {\n            var scaleType = model.getScaleComponent(channel).get('type');\n            return getSpecifiedOrDefaultValue(specifiedAxis.grid, properties.grid(scaleType, fieldDef));\n        }\n        case 'labelFlush':\n            return properties.labelFlush(fieldDef, channel, specifiedAxis);\n        case 'labelOverlap': {\n            var scaleType = model.getScaleComponent(channel).get('type');\n            return properties.labelOverlap(fieldDef, specifiedAxis, channel, scaleType);\n        }\n        case 'orient':\n            return getSpecifiedOrDefaultValue(specifiedAxis.orient, properties.orient(channel));\n        case 'tickCount': {\n            var scaleType = model.getScaleComponent(channel).get('type');\n            var sizeType = channel === 'x' ? 'width' : channel === 'y' ? 'height' : undefined;\n            var size = sizeType ? model.getSizeSignalRef(sizeType)\n                : undefined;\n            return getSpecifiedOrDefaultValue(specifiedAxis.tickCount, properties.tickCount(channel, fieldDef, scaleType, size));\n        }\n        case 'title':\n            var channel2 = channel === 'x' ? 'x2' : 'y2';\n            var fieldDef2 = model.fieldDef(channel2);\n            // Keep undefined so we use default if title is unspecified.\n            // For other falsy value, keep them so we will hide the title.\n            var fieldDefTitle = getFieldDefTitle(model, channel);\n            var specifiedTitle = fieldDefTitle !== undefined ? fieldDefTitle :\n                specifiedAxis.title === undefined ? undefined : specifiedAxis.title;\n            return getSpecifiedOrDefaultValue(specifiedTitle, \n            // If title not specified, store base parts of fieldDef (and fieldDef2 if exists)\n            mergeTitleFieldDefs([toFieldDefBase(fieldDef)], fieldDef2 ? [toFieldDefBase(fieldDef2)] : []));\n        case 'values':\n            return properties.values(specifiedAxis, model, fieldDef, channel);\n    }\n    // Otherwise, return specified property.\n    return isAxisProperty(property) ? specifiedAxis[property] : undefined;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyc2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9heGlzL3BhcnNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBTyxVQUFVLEVBQWdCLGNBQWMsRUFBRSxrQkFBa0IsRUFBQyxNQUFNLFlBQVksQ0FBQztBQUM5RixPQUFPLEVBQUMsdUJBQXVCLEVBQXdCLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDbEYsT0FBTyxFQUFlLGNBQWMsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQzVELE9BQU8sRUFBQyxJQUFJLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFFaEMsT0FBTyxFQUFDLDBCQUEwQixFQUFFLGdCQUFnQixFQUFFLFVBQVUsRUFBRSxtQkFBbUIsRUFBRSxtQkFBbUIsRUFBRSxZQUFZLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFFM0ksT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQzdDLE9BQU8sRUFBQyxpQkFBaUIsRUFBWSx1QkFBdUIsRUFBQyxNQUFNLFVBQVUsQ0FBQztBQUU5RSxPQUFPLEVBQUMsYUFBYSxFQUF5QyxNQUFNLGFBQWEsQ0FBQztBQUNsRixPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0sVUFBVSxDQUFDO0FBQ3ZDLE9BQU8sS0FBSyxNQUFNLE1BQU0sVUFBVSxDQUFDO0FBQ25DLE9BQU8sS0FBSyxVQUFVLE1BQU0sY0FBYyxDQUFDO0FBRzNDLE1BQU0sd0JBQXdCLEtBQWdCO0lBQzVDLE9BQU8sdUJBQXVCLENBQUMsTUFBTSxDQUFDLFVBQVMsSUFBSSxFQUFFLE9BQU87UUFDMUQsSUFBSSxLQUFLLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxLQUFLLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQzFELElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQztTQUM3QztRQUNELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQyxFQUFFLEVBQXdCLENBQUMsQ0FBQztBQUMvQixDQUFDO0FBRUQsSUFBTSxlQUFlLEdBQW9DO0lBQ3ZELE1BQU0sRUFBRSxLQUFLO0lBQ2IsR0FBRyxFQUFFLFFBQVE7SUFDYixJQUFJLEVBQUUsT0FBTztJQUNiLEtBQUssRUFBRSxNQUFNO0NBQ2QsQ0FBQztBQUVGLE1BQU0seUJBQXlCLEtBQWlCO0lBQ3hDLElBQUEsb0JBQWlDLEVBQWhDLGNBQUksRUFBRSxvQkFBTyxDQUFvQjtJQUN4QyxJQUFNLFNBQVMsR0FHWCxFQUFDLEdBQUcsRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLEVBQUMsQ0FBQztJQUUzQyxLQUFvQixVQUFjLEVBQWQsS0FBQSxLQUFLLENBQUMsUUFBUSxFQUFkLGNBQWMsRUFBZCxJQUFjLEVBQUU7UUFBL0IsSUFBTSxLQUFLLFNBQUE7UUFDZCxLQUFLLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztRQUUzQixLQUFzQixVQUEwQixFQUExQixLQUFBLElBQUksQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUExQixjQUEwQixFQUExQixJQUEwQixFQUFFO1lBQTdDLElBQU0sT0FBTyxTQUFBO1lBQ2hCLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsaUJBQWlCLENBQUMsS0FBSyxDQUFDLFNBQVMsQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7WUFDNUUsSUFBSSxPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLFFBQVEsRUFBRTtnQkFDdEMsMkRBQTJEO2dCQUMzRCxzREFBc0Q7Z0JBRXRELElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxtQkFBbUIsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUUsS0FBSyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztnQkFFbEYsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBRTtvQkFDbEIsbUZBQW1GO29CQUNuRixnRUFBZ0U7b0JBQ2hFLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsYUFBYSxDQUFDO29CQUN0QyxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztpQkFDdEI7YUFDRjtTQUNGO0tBQ0Y7SUFFRCw0REFBNEQ7SUFDNUQsS0FBc0IsVUFBTSxFQUFOLE1BQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFOLGNBQU0sRUFBTixJQUFNLEVBQUU7UUFBekIsSUFBTSxPQUFPLFNBQUE7UUFDaEIsS0FBb0IsVUFBYyxFQUFkLEtBQUEsS0FBSyxDQUFDLFFBQVEsRUFBZCxjQUFjLEVBQWQsSUFBYyxFQUFFO1lBQS9CLElBQU0sS0FBSyxTQUFBO1lBQ2QsSUFBSSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFO2dCQUNsQyxvREFBb0Q7Z0JBQ3BELFNBQVM7YUFDVjtZQUVELElBQUksT0FBTyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsS0FBSyxhQUFhLEVBQUU7Z0JBQzNDLDJEQUEyRDtnQkFDM0QsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO2dCQUU1RSw4QkFBOEI7Z0JBQzlCLEtBQTRCLFVBQTZCLEVBQTdCLEtBQUEsS0FBSyxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQTdCLGNBQTZCLEVBQTdCLElBQTZCLEVBQUU7b0JBQXRELElBQU0sYUFBYSxTQUFBO29CQUNoQixJQUFBLDRDQUFtRSxFQUFsRSxpQkFBYSxFQUFFLHNCQUFRLENBQTRDO29CQUMxRSxJQUFJLFNBQVMsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUU7d0JBQ3RDLGdEQUFnRDt3QkFDaEQsSUFBTSxjQUFjLEdBQUcsZUFBZSxDQUFDLE1BQU0sQ0FBQyxDQUFDO3dCQUMvQyxJQUFJLFNBQVMsQ0FBQyxNQUFNLENBQUMsR0FBRyxTQUFTLENBQUMsY0FBYyxDQUFDLEVBQUU7NEJBQ2pELGFBQWEsQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLGNBQWMsRUFBRSxLQUFLLENBQUMsQ0FBQzt5QkFDcEQ7cUJBQ0Y7b0JBQ0QsU0FBUyxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUM7b0JBRXBCLHNGQUFzRjtpQkFDdkY7YUFDRjtZQUVELHFEQUFxRDtZQUNyRCxPQUFPLEtBQUssQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQ3RDO0tBQ0Y7QUFDSCxDQUFDO0FBRUQsNkJBQTZCLGVBQWdDLEVBQUUsY0FBK0I7SUFDNUYsSUFBSSxlQUFlLEVBQUU7UUFDbkIsMkRBQTJEO1FBQzNELElBQUksZUFBZSxDQUFDLE1BQU0sS0FBSyxjQUFjLENBQUMsTUFBTSxFQUFFO1lBQ3BELE9BQU8sU0FBUyxDQUFDLENBQUMsNkRBQTZEO1NBQ2hGO1FBQ0QsSUFBTSxRQUFNLEdBQUcsZUFBZSxDQUFDLE1BQU0sQ0FBQztRQUN0QyxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsUUFBTSxFQUFHLENBQUMsRUFBRSxFQUFFO1lBQ2hDLElBQU0sTUFBTSxHQUFHLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNsQyxJQUFNLEtBQUssR0FBRyxjQUFjLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFFaEMsSUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsRUFBRTtnQkFDNUIsT0FBTyxTQUFTLENBQUM7YUFDbEI7aUJBQU0sSUFBSSxNQUFNLElBQUksS0FBSyxFQUFFO2dCQUMxQixJQUFNLFlBQVksR0FBRyxNQUFNLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxDQUFDO2dCQUN0RCxJQUFNLFdBQVcsR0FBRyxLQUFLLENBQUMsZUFBZSxDQUFDLFFBQVEsQ0FBQyxDQUFDO2dCQUVwRCxJQUFJLFlBQVksQ0FBQyxRQUFRLElBQUksV0FBVyxDQUFDLFFBQVEsSUFBSSxZQUFZLENBQUMsS0FBSyxLQUFLLFdBQVcsQ0FBQyxLQUFLLEVBQUU7b0JBQzdGLHVHQUF1RztvQkFFdkcsMENBQTBDO29CQUMxQyxPQUFPLFNBQVMsQ0FBQztpQkFDbEI7cUJBQU07b0JBQ0wsZUFBZSxDQUFDLENBQUMsQ0FBQyxHQUFHLGtCQUFrQixDQUFDLE1BQU0sRUFBRSxLQUFLLENBQUMsQ0FBQztpQkFDeEQ7YUFDRjtTQUNGO0tBQ0Y7U0FBTTtRQUNMLDRDQUE0QztRQUM1QyxPQUFPLGNBQWMsQ0FBQyxHQUFHLENBQUMsVUFBQSxhQUFhLElBQUksT0FBQSxhQUFhLENBQUMsS0FBSyxFQUFFLEVBQXJCLENBQXFCLENBQUMsQ0FBQztLQUNuRTtJQUNELE9BQU8sZUFBZSxDQUFDO0FBQ3pCLENBQUM7QUFFRCw0QkFBNEIsTUFBcUIsRUFBRSxLQUFvQjs0QkFDMUQsSUFBSTtRQUNiLElBQU0sdUJBQXVCLEdBQUcsdUJBQXVCLENBQ3JELE1BQU0sQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLEVBQzVCLEtBQUssQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLEVBQzNCLElBQUksRUFBRSxNQUFNO1FBRVosdUJBQXVCO1FBQ3ZCLFVBQUMsRUFBaUIsRUFBRSxFQUFpQjtZQUNuQyxRQUFRLElBQUksRUFBRTtnQkFDWixLQUFLLE9BQU87b0JBQ1YsT0FBTyxtQkFBbUIsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7Z0JBQ3JDLEtBQUssV0FBVztvQkFDZCxPQUFPO3dCQUNMLFFBQVEsRUFBRSxFQUFFLENBQUMsUUFBUTt3QkFDckIsS0FBSyxFQUFFLEVBQUUsQ0FBQyxLQUFLLElBQUksRUFBRSxDQUFDLEtBQUs7cUJBQzVCLENBQUM7YUFDTDtZQUNELE9BQU8saUJBQWlCLENBQWMsRUFBRSxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFDOUQsQ0FBQyxDQUNGLENBQUM7UUFDRixNQUFNLENBQUMsZUFBZSxDQUFDLElBQUksRUFBRSx1QkFBdUIsQ0FBQyxDQUFDO0lBQ3hELENBQUM7SUFyQkQsS0FBbUIsVUFBa0IsRUFBbEIseUNBQWtCLEVBQWxCLGdDQUFrQixFQUFsQixJQUFrQjtRQUFoQyxJQUFNLElBQUksMkJBQUE7Z0JBQUosSUFBSTtLQXFCZDtJQUNELE9BQU8sTUFBTSxDQUFDO0FBQ2hCLENBQUM7QUFFRCwwQkFBMEIsS0FBZ0IsRUFBRSxPQUFrQjtJQUM1RCxJQUFNLFFBQVEsR0FBRyxPQUFPLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUMvQyxJQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3pDLElBQU0sU0FBUyxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsUUFBUSxDQUFDLENBQUM7SUFFM0MsSUFBTSxNQUFNLEdBQUcsUUFBUSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7SUFDckQsSUFBTSxNQUFNLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUM7SUFFdkQsSUFBSSxNQUFNLElBQUksTUFBTSxFQUFFO1FBQ3BCLE9BQU8sVUFBVSxDQUFDLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQztLQUNuQztTQUFNLElBQUksTUFBTSxFQUFFO1FBQ2pCLE9BQU8sTUFBTSxDQUFDO0tBQ2Y7U0FBTSxJQUFJLE1BQU0sRUFBRTtRQUNqQixPQUFPLE1BQU0sQ0FBQztLQUNmO1NBQU0sSUFBSSxNQUFNLEtBQUssU0FBUyxFQUFFLEVBQUUsZ0NBQWdDO1FBQ2pFLE9BQU8sTUFBTSxDQUFDO0tBQ2Y7U0FBTSxJQUFJLE1BQU0sS0FBSyxTQUFTLEVBQUUsRUFBRSxnQ0FBZ0M7UUFDakUsT0FBTyxNQUFNLENBQUM7S0FDZjtJQUVELE9BQU8sU0FBUyxDQUFDO0FBQ25CLENBQUM7QUFFRCxtQkFBbUIsT0FBNkIsRUFBRSxLQUFnQjtJQUNoRSxJQUFNLElBQUksR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBRWpDLElBQU0sYUFBYSxHQUFHLElBQUksYUFBYSxFQUFFLENBQUM7SUFFMUMsc0JBQXNCO0lBQ3RCLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxVQUFTLFFBQVE7UUFDMUMsSUFBTSxLQUFLLEdBQUcsV0FBVyxDQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBQzFELElBQUksS0FBSyxLQUFLLFNBQVMsRUFBRTtZQUN2QixJQUFNLFFBQVE7WUFDWix1RUFBdUU7WUFDdkUsUUFBUSxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztnQkFDdkMsa0VBQWtFO2dCQUNsRSxRQUFRLEtBQUssUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO29CQUM5RCxpREFBaUQ7b0JBQzdDLFFBQVEsS0FBSyxPQUFPLElBQUksS0FBSyxLQUFLLGdCQUFnQixDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7d0JBQy9FLHNGQUFzRjt3QkFDdEYsS0FBSyxLQUFLLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUUzQixJQUFNLFdBQVcsR0FBRyxhQUFhLENBQUMsUUFBUSxFQUFFLEtBQUssQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLGFBQWEsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLEVBQUUsS0FBSyxDQUFDLGlCQUFpQixDQUFDLE9BQU8sQ0FBQyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1lBRTlJLG9IQUFvSDtZQUNwSCxJQUFJLFFBQVEsSUFBSSxXQUFXLEtBQUssU0FBUyxFQUFFO2dCQUN6Qyx3REFBd0Q7Z0JBQ3hELGFBQWEsQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQzthQUM5QztpQkFBTSxJQUFJLFFBQVEsS0FBSyxNQUFNLElBQUksV0FBVyxFQUFFO2dCQUM3Qyx3RkFBd0Y7Z0JBQ3hGLGFBQWEsQ0FBQyxHQUFHLENBQUMsUUFBUSxFQUFFLFdBQVcsRUFBRSxLQUFLLENBQUMsQ0FBQzthQUNqRDtTQUNGO0lBQ0gsQ0FBQyxDQUFDLENBQUM7SUFFSCx3Q0FBd0M7SUFDeEMsSUFBTSxZQUFZLEdBQUcsSUFBSSxDQUFDLFFBQVEsSUFBSSxFQUFFLENBQUM7SUFDekMsSUFBTSxVQUFVLEdBQUcsVUFBVSxDQUFDLE1BQU0sQ0FBQyxVQUFDLENBQWUsRUFBRSxJQUFJO1FBQ3pELElBQUksQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxFQUFFO1lBQ3BDLGdEQUFnRDtZQUNoRCxPQUFPLENBQUMsQ0FBQztTQUNWO1FBRUQsSUFBTSxnQkFBZ0IsR0FBRyxnQkFBZ0IsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBRTNFLElBQU0sS0FBSyxHQUFHLElBQUksS0FBSyxRQUFRLENBQUMsQ0FBQztZQUMvQixNQUFNLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsYUFBYSxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDOUUsZ0JBQWdCLENBQUM7UUFFbkIsSUFBSSxLQUFLLEtBQUssU0FBUyxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO1lBQ2pELENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUMsQ0FBQztTQUMzQjtRQUNELE9BQU8sQ0FBQyxDQUFDO0lBQ1gsQ0FBQyxFQUFFLEVBQWtCLENBQUMsQ0FBQztJQUV2QixzRkFBc0Y7SUFDdEYsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRTtRQUMvQixhQUFhLENBQUMsR0FBRyxDQUFDLFFBQVEsRUFBRSxVQUFVLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLFVBQVUsS0FBSyxTQUFTLENBQUMsQ0FBQztLQUMzRjtJQUVELE9BQU8sYUFBYSxDQUFDO0FBQ3ZCLENBQUM7QUFFRCxxQkFBeUQsUUFBVyxFQUFFLGFBQW1CLEVBQUUsT0FBNkIsRUFBRSxLQUFnQjtJQUN4SSxJQUFNLFFBQVEsR0FBRyxLQUFLLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3pDLFFBQVEsUUFBUSxFQUFFO1FBQ2hCLEtBQUssT0FBTztZQUNWLE9BQU8sS0FBSyxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNsQyxLQUFLLFdBQVc7WUFDZCxPQUFPLFVBQVUsQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQzlDLEtBQUssUUFBUTtZQUNYLDBFQUEwRTtZQUMxRSxPQUFPLFlBQVksQ0FBQyxRQUFRLEVBQUUsYUFBYSxDQUFDLE1BQU0sRUFBRSxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDcEUsS0FBSyxNQUFNLENBQUMsQ0FBQztZQUNYLElBQU0sU0FBUyxHQUFHLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDL0QsT0FBTywwQkFBMEIsQ0FBQyxhQUFhLENBQUMsSUFBSSxFQUFFLFVBQVUsQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUM7U0FDN0Y7UUFDRCxLQUFLLFlBQVk7WUFDZixPQUFPLFVBQVUsQ0FBQyxVQUFVLENBQUMsUUFBUSxFQUFFLE9BQU8sRUFBRSxhQUFhLENBQUMsQ0FBQztRQUNqRSxLQUFLLGNBQWMsQ0FBQyxDQUFDO1lBQ25CLElBQU0sU0FBUyxHQUFHLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDL0QsT0FBTyxVQUFVLENBQUMsWUFBWSxDQUFDLFFBQVEsRUFBRSxhQUFhLEVBQUUsT0FBTyxFQUFFLFNBQVMsQ0FBQyxDQUFDO1NBQzdFO1FBQ0QsS0FBSyxRQUFRO1lBQ1gsT0FBTywwQkFBMEIsQ0FBQyxhQUFhLENBQUMsTUFBTSxFQUFFLFVBQVUsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztRQUN0RixLQUFLLFdBQVcsQ0FBQyxDQUFDO1lBQ2hCLElBQU0sU0FBUyxHQUFHLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxPQUFPLENBQUMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7WUFDL0QsSUFBTSxRQUFRLEdBQUcsT0FBTyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxPQUFPLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztZQUNwRixJQUFNLElBQUksR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUM7Z0JBQ3ZELENBQUMsQ0FBQyxTQUFTLENBQUM7WUFDYixPQUFPLDBCQUEwQixDQUFDLGFBQWEsQ0FBQyxTQUFTLEVBQUUsVUFBVSxDQUFDLFNBQVMsQ0FBQyxPQUFPLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO1NBQ3RIO1FBQ0QsS0FBSyxPQUFPO1lBQ1YsSUFBTSxRQUFRLEdBQUcsT0FBTyxLQUFLLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7WUFDL0MsSUFBTSxTQUFTLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUMzQyw0REFBNEQ7WUFDNUQsOERBQThEO1lBQzlELElBQU0sYUFBYSxHQUFHLGdCQUFnQixDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsQ0FBQztZQUN2RCxJQUFNLGNBQWMsR0FBRyxhQUFhLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQztnQkFDbEUsYUFBYSxDQUFDLEtBQUssS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQztZQUV0RSxPQUFPLDBCQUEwQixDQUMvQixjQUFjO1lBQ2QsaUZBQWlGO1lBQ2pGLG1CQUFtQixDQUNqQixDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUMxQixTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FDN0MsQ0FDRixDQUFDO1FBQ0osS0FBSyxRQUFRO1lBQ1gsT0FBTyxVQUFVLENBQUMsTUFBTSxDQUFDLGFBQWEsRUFBRSxLQUFLLEVBQUUsUUFBUSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0tBQ3JFO0lBQ0Qsd0NBQXdDO0lBQ3hDLE9BQU8sY0FBYyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztBQUN4RSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtBeGlzLCBBWElTX1BBUlRTLCBBeGlzRW5jb2RpbmcsIGlzQXhpc1Byb3BlcnR5LCBWR19BWElTX1BST1BFUlRJRVN9IGZyb20gJy4uLy4uL2F4aXMnO1xuaW1wb3J0IHtQT1NJVElPTl9TQ0FMRV9DSEFOTkVMUywgUG9zaXRpb25TY2FsZUNoYW5uZWwsIFgsIFl9IGZyb20gJy4uLy4uL2NoYW5uZWwnO1xuaW1wb3J0IHtGaWVsZERlZkJhc2UsIHRvRmllbGREZWZCYXNlfSBmcm9tICcuLi8uLi9maWVsZGRlZic7XG5pbXBvcnQge2tleXN9IGZyb20gJy4uLy4uL3V0aWwnO1xuaW1wb3J0IHtBeGlzT3JpZW50LCBWZ0F4aXMsIFZnQXhpc0VuY29kZX0gZnJvbSAnLi4vLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtnZXRTcGVjaWZpZWRPckRlZmF1bHRWYWx1ZSwgZ3VpZGVFbmNvZGVFbnRyeSwgbWVyZ2VUaXRsZSwgbWVyZ2VUaXRsZUNvbXBvbmVudCwgbWVyZ2VUaXRsZUZpZWxkRGVmcywgbnVtYmVyRm9ybWF0fSBmcm9tICcuLi9jb21tb24nO1xuaW1wb3J0IHtMYXllck1vZGVsfSBmcm9tICcuLi9sYXllcic7XG5pbXBvcnQge3BhcnNlR3VpZGVSZXNvbHZlfSBmcm9tICcuLi9yZXNvbHZlJztcbmltcG9ydCB7ZGVmYXVsdFRpZUJyZWFrZXIsIEV4cGxpY2l0LCBtZXJnZVZhbHVlc1dpdGhFeHBsaWNpdH0gZnJvbSAnLi4vc3BsaXQnO1xuaW1wb3J0IHtVbml0TW9kZWx9IGZyb20gJy4uL3VuaXQnO1xuaW1wb3J0IHtBeGlzQ29tcG9uZW50LCBBeGlzQ29tcG9uZW50SW5kZXgsIEF4aXNDb21wb25lbnRQcm9wc30gZnJvbSAnLi9jb21wb25lbnQnO1xuaW1wb3J0IHtnZXRBeGlzQ29uZmlnfSBmcm9tICcuL2NvbmZpZyc7XG5pbXBvcnQgKiBhcyBlbmNvZGUgZnJvbSAnLi9lbmNvZGUnO1xuaW1wb3J0ICogYXMgcHJvcGVydGllcyBmcm9tICcuL3Byb3BlcnRpZXMnO1xuXG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVVuaXRBeGlzKG1vZGVsOiBVbml0TW9kZWwpOiBBeGlzQ29tcG9uZW50SW5kZXgge1xuICByZXR1cm4gUE9TSVRJT05fU0NBTEVfQ0hBTk5FTFMucmVkdWNlKGZ1bmN0aW9uKGF4aXMsIGNoYW5uZWwpIHtcbiAgICBpZiAobW9kZWwuY29tcG9uZW50LnNjYWxlc1tjaGFubmVsXSAmJiBtb2RlbC5heGlzKGNoYW5uZWwpKSB7XG4gICAgICBheGlzW2NoYW5uZWxdID0gW3BhcnNlQXhpcyhjaGFubmVsLCBtb2RlbCldO1xuICAgIH1cbiAgICByZXR1cm4gYXhpcztcbiAgfSwge30gYXMgQXhpc0NvbXBvbmVudEluZGV4KTtcbn1cblxuY29uc3QgT1BQT1NJVEVfT1JJRU5UOiB7W0sgaW4gQXhpc09yaWVudF06IEF4aXNPcmllbnR9ID0ge1xuICBib3R0b206ICd0b3AnLFxuICB0b3A6ICdib3R0b20nLFxuICBsZWZ0OiAncmlnaHQnLFxuICByaWdodDogJ2xlZnQnXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gcGFyc2VMYXllckF4aXMobW9kZWw6IExheWVyTW9kZWwpIHtcbiAgY29uc3Qge2F4ZXMsIHJlc29sdmV9ID0gbW9kZWwuY29tcG9uZW50O1xuICBjb25zdCBheGlzQ291bnQ6IHtcbiAgICAvLyBVc2luZyBNYXBwZWQgVHlwZSB0byBkZWNsYXJlIHR5cGUgKGh0dHBzOi8vd3d3LnR5cGVzY3JpcHRsYW5nLm9yZy9kb2NzL2hhbmRib29rL2FkdmFuY2VkLXR5cGVzLmh0bWwjbWFwcGVkLXR5cGVzKVxuICAgIFtrIGluIEF4aXNPcmllbnRdOiBudW1iZXJcbiAgfSA9IHt0b3A6IDAsIGJvdHRvbTogMCwgcmlnaHQ6IDAsIGxlZnQ6IDB9O1xuXG4gIGZvciAoY29uc3QgY2hpbGQgb2YgbW9kZWwuY2hpbGRyZW4pIHtcbiAgICBjaGlsZC5wYXJzZUF4aXNBbmRIZWFkZXIoKTtcblxuICAgIGZvciAoY29uc3QgY2hhbm5lbCBvZiBrZXlzKGNoaWxkLmNvbXBvbmVudC5heGVzKSkge1xuICAgICAgcmVzb2x2ZS5heGlzW2NoYW5uZWxdID0gcGFyc2VHdWlkZVJlc29sdmUobW9kZWwuY29tcG9uZW50LnJlc29sdmUsIGNoYW5uZWwpO1xuICAgICAgaWYgKHJlc29sdmUuYXhpc1tjaGFubmVsXSA9PT0gJ3NoYXJlZCcpIHtcbiAgICAgICAgLy8gSWYgdGhlIHJlc29sdmUgc2F5cyBzaGFyZWQgKGFuZCBoYXMgbm90IGJlZW4gb3ZlcnJpZGRlbilcbiAgICAgICAgLy8gV2Ugd2lsbCB0cnkgdG8gbWVyZ2UgYW5kIHNlZSBpZiB0aGVyZSBpcyBhIGNvbmZsaWN0XG5cbiAgICAgICAgYXhlc1tjaGFubmVsXSA9IG1lcmdlQXhpc0NvbXBvbmVudHMoYXhlc1tjaGFubmVsXSwgY2hpbGQuY29tcG9uZW50LmF4ZXNbY2hhbm5lbF0pO1xuXG4gICAgICAgIGlmICghYXhlc1tjaGFubmVsXSkge1xuICAgICAgICAgIC8vIElmIG1lcmdlIHJldHVybnMgbm90aGluZywgdGhlcmUgaXMgYSBjb25mbGljdCBzbyB3ZSBjYW5ub3QgbWFrZSB0aGUgYXhpcyBzaGFyZWQuXG4gICAgICAgICAgLy8gVGh1cywgbWFyayBheGlzIGFzIGluZGVwZW5kZW50IGFuZCByZW1vdmUgdGhlIGF4aXMgY29tcG9uZW50LlxuICAgICAgICAgIHJlc29sdmUuYXhpc1tjaGFubmVsXSA9ICdpbmRlcGVuZGVudCc7XG4gICAgICAgICAgZGVsZXRlIGF4ZXNbY2hhbm5lbF07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBNb3ZlIGF4ZXMgdG8gbGF5ZXIncyBheGlzIGNvbXBvbmVudCBhbmQgbWVyZ2Ugc2hhcmVkIGF4ZXNcbiAgZm9yIChjb25zdCBjaGFubmVsIG9mIFtYLCBZXSkge1xuICAgIGZvciAoY29uc3QgY2hpbGQgb2YgbW9kZWwuY2hpbGRyZW4pIHtcbiAgICAgIGlmICghY2hpbGQuY29tcG9uZW50LmF4ZXNbY2hhbm5lbF0pIHtcbiAgICAgICAgLy8gc2tpcCBpZiB0aGUgY2hpbGQgZG9lcyBub3QgaGF2ZSBhIHBhcnRpY3VsYXIgYXhpc1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgaWYgKHJlc29sdmUuYXhpc1tjaGFubmVsXSA9PT0gJ2luZGVwZW5kZW50Jykge1xuICAgICAgICAvLyBJZiBheGVzIGFyZSBpbmRlcGVuZGVudCwgY29uY2F0IHRoZSBheGlzQ29tcG9uZW50IGFycmF5LlxuICAgICAgICBheGVzW2NoYW5uZWxdID0gKGF4ZXNbY2hhbm5lbF0gfHwgW10pLmNvbmNhdChjaGlsZC5jb21wb25lbnQuYXhlc1tjaGFubmVsXSk7XG5cbiAgICAgICAgLy8gQXV0b21hdGljYWxseSBhZGp1c3Qgb3JpZW50XG4gICAgICAgIGZvciAoY29uc3QgYXhpc0NvbXBvbmVudCBvZiBjaGlsZC5jb21wb25lbnQuYXhlc1tjaGFubmVsXSkge1xuICAgICAgICAgIGNvbnN0IHt2YWx1ZTogb3JpZW50LCBleHBsaWNpdH0gPSBheGlzQ29tcG9uZW50LmdldFdpdGhFeHBsaWNpdCgnb3JpZW50Jyk7XG4gICAgICAgICAgaWYgKGF4aXNDb3VudFtvcmllbnRdID4gMCAmJiAhZXhwbGljaXQpIHtcbiAgICAgICAgICAgIC8vIENoYW5nZSBheGlzIG9yaWVudCBpZiB0aGUgbnVtYmVyIGRvIG5vdCBtYXRjaFxuICAgICAgICAgICAgY29uc3Qgb3Bwb3NpdGVPcmllbnQgPSBPUFBPU0lURV9PUklFTlRbb3JpZW50XTtcbiAgICAgICAgICAgIGlmIChheGlzQ291bnRbb3JpZW50XSA+IGF4aXNDb3VudFtvcHBvc2l0ZU9yaWVudF0pIHtcbiAgICAgICAgICAgICAgYXhpc0NvbXBvbmVudC5zZXQoJ29yaWVudCcsIG9wcG9zaXRlT3JpZW50LCBmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGF4aXNDb3VudFtvcmllbnRdKys7XG5cbiAgICAgICAgICAvLyBUT0RPKGh0dHBzOi8vZ2l0aHViLmNvbS92ZWdhL3ZlZ2EtbGl0ZS9pc3N1ZXMvMjYzNCk6IGF1dG9tYXRpY2FseSBhZGQgZXh0cmEgb2Zmc2V0P1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIEFmdGVyIG1lcmdpbmcsIG1ha2Ugc3VyZSB0byByZW1vdmUgYXhlcyBmcm9tIGNoaWxkXG4gICAgICBkZWxldGUgY2hpbGQuY29tcG9uZW50LmF4ZXNbY2hhbm5lbF07XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIG1lcmdlQXhpc0NvbXBvbmVudHMobWVyZ2VkQXhpc0NtcHRzOiBBeGlzQ29tcG9uZW50W10sIGNoaWxkQXhpc0NtcHRzOiBBeGlzQ29tcG9uZW50W10pOiBBeGlzQ29tcG9uZW50W10ge1xuICBpZiAobWVyZ2VkQXhpc0NtcHRzKSB7XG4gICAgLy8gRklYTUU6IHRoaXMgaXMgYSBiaXQgd3Jvbmcgb25jZSB3ZSBzdXBwb3J0IG11bHRpcGxlIGF4ZXNcbiAgICBpZiAobWVyZ2VkQXhpc0NtcHRzLmxlbmd0aCAhPT0gY2hpbGRBeGlzQ21wdHMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkOyAvLyBDYW5ub3QgbWVyZ2UgYXhpcyBjb21wb25lbnQgd2l0aCBkaWZmZXJlbnQgbnVtYmVyIG9mIGF4ZXMuXG4gICAgfVxuICAgIGNvbnN0IGxlbmd0aCA9IG1lcmdlZEF4aXNDbXB0cy5sZW5ndGg7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGggOyBpKyspIHtcbiAgICAgIGNvbnN0IG1lcmdlZCA9IG1lcmdlZEF4aXNDbXB0c1tpXTtcbiAgICAgIGNvbnN0IGNoaWxkID0gY2hpbGRBeGlzQ21wdHNbaV07XG5cbiAgICAgIGlmICgoISFtZXJnZWQpICE9PSAoISFjaGlsZCkpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgIH0gZWxzZSBpZiAobWVyZ2VkICYmIGNoaWxkKSB7XG4gICAgICAgIGNvbnN0IG1lcmdlZE9yaWVudCA9IG1lcmdlZC5nZXRXaXRoRXhwbGljaXQoJ29yaWVudCcpO1xuICAgICAgICBjb25zdCBjaGlsZE9yaWVudCA9IGNoaWxkLmdldFdpdGhFeHBsaWNpdCgnb3JpZW50Jyk7XG5cbiAgICAgICAgaWYgKG1lcmdlZE9yaWVudC5leHBsaWNpdCAmJiBjaGlsZE9yaWVudC5leHBsaWNpdCAmJiBtZXJnZWRPcmllbnQudmFsdWUgIT09IGNoaWxkT3JpZW50LnZhbHVlKSB7XG4gICAgICAgICAgLy8gVE9ETzogdGhyb3cgd2FybmluZyBpZiByZXNvbHZlIGlzIGV4cGxpY2l0IChXZSBkb24ndCBoYXZlIGluZm8gYWJvdXQgZXhwbGljaXQvaW1wbGljaXQgcmVzb2x2ZSB5ZXQuKVxuXG4gICAgICAgICAgLy8gQ2Fubm90IG1lcmdlIGR1ZSB0byBpbmNvbnNpc3RlbnQgb3JpZW50XG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBtZXJnZWRBeGlzQ21wdHNbaV0gPSBtZXJnZUF4aXNDb21wb25lbnQobWVyZ2VkLCBjaGlsZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8gRm9yIGZpcnN0IG9uZSwgcmV0dXJuIGEgY29weSBvZiB0aGUgY2hpbGRcbiAgICByZXR1cm4gY2hpbGRBeGlzQ21wdHMubWFwKGF4aXNDb21wb25lbnQgPT4gYXhpc0NvbXBvbmVudC5jbG9uZSgpKTtcbiAgfVxuICByZXR1cm4gbWVyZ2VkQXhpc0NtcHRzO1xufVxuXG5mdW5jdGlvbiBtZXJnZUF4aXNDb21wb25lbnQobWVyZ2VkOiBBeGlzQ29tcG9uZW50LCBjaGlsZDogQXhpc0NvbXBvbmVudCk6IEF4aXNDb21wb25lbnQge1xuICBmb3IgKGNvbnN0IHByb3Agb2YgVkdfQVhJU19QUk9QRVJUSUVTKSB7XG4gICAgY29uc3QgbWVyZ2VkVmFsdWVXaXRoRXhwbGljaXQgPSBtZXJnZVZhbHVlc1dpdGhFeHBsaWNpdDxWZ0F4aXMsIGFueT4oXG4gICAgICBtZXJnZWQuZ2V0V2l0aEV4cGxpY2l0KHByb3ApLFxuICAgICAgY2hpbGQuZ2V0V2l0aEV4cGxpY2l0KHByb3ApLFxuICAgICAgcHJvcCwgJ2F4aXMnLFxuXG4gICAgICAvLyBUaWUgYnJlYWtlciBmdW5jdGlvblxuICAgICAgKHYxOiBFeHBsaWNpdDxhbnk+LCB2MjogRXhwbGljaXQ8YW55PikgPT4ge1xuICAgICAgICBzd2l0Y2ggKHByb3ApIHtcbiAgICAgICAgICBjYXNlICd0aXRsZSc6XG4gICAgICAgICAgICByZXR1cm4gbWVyZ2VUaXRsZUNvbXBvbmVudCh2MSwgdjIpO1xuICAgICAgICAgIGNhc2UgJ2dyaWRTY2FsZSc6XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBleHBsaWNpdDogdjEuZXhwbGljaXQsIC8vIGtlZXAgdGhlIG9sZCBleHBsaWNpdFxuICAgICAgICAgICAgICB2YWx1ZTogdjEudmFsdWUgfHwgdjIudmFsdWVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlZmF1bHRUaWVCcmVha2VyPFZnQXhpcywgYW55Pih2MSwgdjIsIHByb3AsICdheGlzJyk7XG4gICAgICB9XG4gICAgKTtcbiAgICBtZXJnZWQuc2V0V2l0aEV4cGxpY2l0KHByb3AsIG1lcmdlZFZhbHVlV2l0aEV4cGxpY2l0KTtcbiAgfVxuICByZXR1cm4gbWVyZ2VkO1xufVxuXG5mdW5jdGlvbiBnZXRGaWVsZERlZlRpdGxlKG1vZGVsOiBVbml0TW9kZWwsIGNoYW5uZWw6ICd4JyB8ICd5Jykge1xuICBjb25zdCBjaGFubmVsMiA9IGNoYW5uZWwgPT09ICd4JyA/ICd4MicgOiAneTInO1xuICBjb25zdCBmaWVsZERlZiA9IG1vZGVsLmZpZWxkRGVmKGNoYW5uZWwpO1xuICBjb25zdCBmaWVsZERlZjIgPSBtb2RlbC5maWVsZERlZihjaGFubmVsMik7XG5cbiAgY29uc3QgdGl0bGUxID0gZmllbGREZWYgPyBmaWVsZERlZi50aXRsZSA6IHVuZGVmaW5lZDtcbiAgY29uc3QgdGl0bGUyID0gZmllbGREZWYyID8gZmllbGREZWYyLnRpdGxlIDogdW5kZWZpbmVkO1xuXG4gIGlmICh0aXRsZTEgJiYgdGl0bGUyKSB7XG4gICAgcmV0dXJuIG1lcmdlVGl0bGUodGl0bGUxLCB0aXRsZTIpO1xuICB9IGVsc2UgaWYgKHRpdGxlMSkge1xuICAgIHJldHVybiB0aXRsZTE7XG4gIH0gZWxzZSBpZiAodGl0bGUyKSB7XG4gICAgcmV0dXJuIHRpdGxlMjtcbiAgfSBlbHNlIGlmICh0aXRsZTEgIT09IHVuZGVmaW5lZCkgeyAvLyBmYWxzeSB2YWx1ZSB0byBkaXNhYmxlIGNvbmZpZ1xuICAgIHJldHVybiB0aXRsZTE7XG4gIH0gZWxzZSBpZiAodGl0bGUyICE9PSB1bmRlZmluZWQpIHsgLy8gZmFsc3kgdmFsdWUgdG8gZGlzYWJsZSBjb25maWdcbiAgICByZXR1cm4gdGl0bGUyO1xuICB9XG5cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuZnVuY3Rpb24gcGFyc2VBeGlzKGNoYW5uZWw6IFBvc2l0aW9uU2NhbGVDaGFubmVsLCBtb2RlbDogVW5pdE1vZGVsKTogQXhpc0NvbXBvbmVudCB7XG4gIGNvbnN0IGF4aXMgPSBtb2RlbC5heGlzKGNoYW5uZWwpO1xuXG4gIGNvbnN0IGF4aXNDb21wb25lbnQgPSBuZXcgQXhpc0NvbXBvbmVudCgpO1xuXG4gIC8vIDEuMi4gQWRkIHByb3BlcnRpZXNcbiAgVkdfQVhJU19QUk9QRVJUSUVTLmZvckVhY2goZnVuY3Rpb24ocHJvcGVydHkpIHtcbiAgICBjb25zdCB2YWx1ZSA9IGdldFByb3BlcnR5KHByb3BlcnR5LCBheGlzLCBjaGFubmVsLCBtb2RlbCk7XG4gICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGNvbnN0IGV4cGxpY2l0ID1cbiAgICAgICAgLy8gc3BlY2lmaWVkIGF4aXMudmFsdWVzIGlzIGFscmVhZHkgcmVzcGVjdGVkLCBidXQgbWF5IGdldCB0cmFuc2Zvcm1lZC5cbiAgICAgICAgcHJvcGVydHkgPT09ICd2YWx1ZXMnID8gISFheGlzLnZhbHVlcyA6XG4gICAgICAgIC8vIGJvdGggVkwgYXhpcy5lbmNvZGluZyBhbmQgYXhpcy5sYWJlbEFuZ2xlIGFmZmVjdCBWRyBheGlzLmVuY29kZVxuICAgICAgICBwcm9wZXJ0eSA9PT0gJ2VuY29kZScgPyAhIWF4aXMuZW5jb2RpbmcgfHwgISFheGlzLmxhYmVsQW5nbGUgOlxuICAgICAgICAvLyB0aXRsZSBjYW4gYmUgZXhwbGljaXQgaWYgZmllbGREZWYudGl0bGUgaXMgc2V0XG4gICAgICAgICAgICBwcm9wZXJ0eSA9PT0gJ3RpdGxlJyAmJiB2YWx1ZSA9PT0gZ2V0RmllbGREZWZUaXRsZShtb2RlbCwgY2hhbm5lbCkgPyB0cnVlIDpcbiAgICAgICAgLy8gT3RoZXJ3aXNlLCB0aGluZ3MgYXJlIGV4cGxpY2l0IGlmIHRoZSByZXR1cm5lZCB2YWx1ZSBtYXRjaGVzIHRoZSBzcGVjaWZpZWQgcHJvcGVydHlcbiAgICAgICAgdmFsdWUgPT09IGF4aXNbcHJvcGVydHldO1xuXG4gICAgICBjb25zdCBjb25maWdWYWx1ZSA9IGdldEF4aXNDb25maWcocHJvcGVydHksIG1vZGVsLmNvbmZpZywgY2hhbm5lbCwgYXhpc0NvbXBvbmVudC5nZXQoJ29yaWVudCcpLCBtb2RlbC5nZXRTY2FsZUNvbXBvbmVudChjaGFubmVsKS5nZXQoJ3R5cGUnKSk7XG5cbiAgICAgIC8vIG9ubHkgc2V0IHByb3BlcnR5IGlmIGl0IGlzIGV4cGxpY2l0bHkgc2V0IG9yIGhhcyBubyBjb25maWcgdmFsdWUgKG90aGVyd2lzZSB3ZSB3aWxsIGFjY2lkZW50YWxseSBvdmVycmlkZSBjb25maWcpXG4gICAgICBpZiAoZXhwbGljaXQgfHwgY29uZmlnVmFsdWUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAvLyBEbyBub3QgYXBwbHkgaW1wbGljaXQgcnVsZSBpZiB0aGVyZSBpcyBhIGNvbmZpZyB2YWx1ZVxuICAgICAgICBheGlzQ29tcG9uZW50LnNldChwcm9wZXJ0eSwgdmFsdWUsIGV4cGxpY2l0KTtcbiAgICAgIH0gZWxzZSBpZiAocHJvcGVydHkgPT09ICdncmlkJyAmJiBjb25maWdWYWx1ZSkge1xuICAgICAgICAvLyBHcmlkIGlzIGFuIGV4Y2VwdGlvbiBiZWNhdXNlIHdlIG5lZWQgdG8gc2V0IGdyaWQgPSB0cnVlIHRvIGdlbmVyYXRlIGFub3RoZXIgZ3JpZCBheGlzXG4gICAgICAgIGF4aXNDb21wb25lbnQuc2V0KHByb3BlcnR5LCBjb25maWdWYWx1ZSwgZmFsc2UpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgLy8gMikgQWRkIGd1aWRlIGVuY29kZSBkZWZpbml0aW9uIGdyb3Vwc1xuICBjb25zdCBheGlzRW5jb2RpbmcgPSBheGlzLmVuY29kaW5nIHx8IHt9O1xuICBjb25zdCBheGlzRW5jb2RlID0gQVhJU19QQVJUUy5yZWR1Y2UoKGU6IFZnQXhpc0VuY29kZSwgcGFydCkgPT4ge1xuICAgIGlmICghYXhpc0NvbXBvbmVudC5oYXNBeGlzUGFydChwYXJ0KSkge1xuICAgICAgLy8gTm8gbmVlZCB0byBjcmVhdGUgZW5jb2RlIGZvciBhIGRpc2FibGVkIHBhcnQuXG4gICAgICByZXR1cm4gZTtcbiAgICB9XG5cbiAgICBjb25zdCBheGlzRW5jb2RpbmdQYXJ0ID0gZ3VpZGVFbmNvZGVFbnRyeShheGlzRW5jb2RpbmdbcGFydF0gfHwge30sIG1vZGVsKTtcblxuICAgIGNvbnN0IHZhbHVlID0gcGFydCA9PT0gJ2xhYmVscycgP1xuICAgICAgZW5jb2RlLmxhYmVscyhtb2RlbCwgY2hhbm5lbCwgYXhpc0VuY29kaW5nUGFydCwgYXhpc0NvbXBvbmVudC5nZXQoJ29yaWVudCcpKSA6XG4gICAgICBheGlzRW5jb2RpbmdQYXJ0O1xuXG4gICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQgJiYga2V5cyh2YWx1ZSkubGVuZ3RoID4gMCkge1xuICAgICAgZVtwYXJ0XSA9IHt1cGRhdGU6IHZhbHVlfTtcbiAgICB9XG4gICAgcmV0dXJuIGU7XG4gIH0sIHt9IGFzIFZnQXhpc0VuY29kZSk7XG5cbiAgLy8gRklYTUU6IEJ5IGhhdmluZyBlbmNvZGUgYXMgb25lIHByb3BlcnR5LCB3ZSB3b24ndCBoYXZlIGZpbmUgZ3JhaW5lZCBlbmNvZGUgbWVyZ2luZy5cbiAgaWYgKGtleXMoYXhpc0VuY29kZSkubGVuZ3RoID4gMCkge1xuICAgIGF4aXNDb21wb25lbnQuc2V0KCdlbmNvZGUnLCBheGlzRW5jb2RlLCAhIWF4aXMuZW5jb2RpbmcgfHwgYXhpcy5sYWJlbEFuZ2xlICE9PSB1bmRlZmluZWQpO1xuICB9XG5cbiAgcmV0dXJuIGF4aXNDb21wb25lbnQ7XG59XG5cbmZ1bmN0aW9uIGdldFByb3BlcnR5PEsgZXh0ZW5kcyBrZXlvZiBBeGlzQ29tcG9uZW50UHJvcHM+KHByb3BlcnR5OiBLLCBzcGVjaWZpZWRBeGlzOiBBeGlzLCBjaGFubmVsOiBQb3NpdGlvblNjYWxlQ2hhbm5lbCwgbW9kZWw6IFVuaXRNb2RlbCk6IEF4aXNDb21wb25lbnRQcm9wc1tLXSB7XG4gIGNvbnN0IGZpZWxkRGVmID0gbW9kZWwuZmllbGREZWYoY2hhbm5lbCk7XG4gIHN3aXRjaCAocHJvcGVydHkpIHtcbiAgICBjYXNlICdzY2FsZSc6XG4gICAgICByZXR1cm4gbW9kZWwuc2NhbGVOYW1lKGNoYW5uZWwpO1xuICAgIGNhc2UgJ2dyaWRTY2FsZSc6XG4gICAgICByZXR1cm4gcHJvcGVydGllcy5ncmlkU2NhbGUobW9kZWwsIGNoYW5uZWwpO1xuICAgIGNhc2UgJ2Zvcm1hdCc6XG4gICAgICAvLyBXZSBkb24ndCBpbmNsdWRlIHRlbXBvcmFsIGZpZWxkIGhlcmUgYXMgd2UgYXBwbHkgZm9ybWF0IGluIGVuY29kZSBibG9ja1xuICAgICAgcmV0dXJuIG51bWJlckZvcm1hdChmaWVsZERlZiwgc3BlY2lmaWVkQXhpcy5mb3JtYXQsIG1vZGVsLmNvbmZpZyk7XG4gICAgY2FzZSAnZ3JpZCc6IHtcbiAgICAgIGNvbnN0IHNjYWxlVHlwZSA9IG1vZGVsLmdldFNjYWxlQ29tcG9uZW50KGNoYW5uZWwpLmdldCgndHlwZScpO1xuICAgICAgcmV0dXJuIGdldFNwZWNpZmllZE9yRGVmYXVsdFZhbHVlKHNwZWNpZmllZEF4aXMuZ3JpZCwgcHJvcGVydGllcy5ncmlkKHNjYWxlVHlwZSwgZmllbGREZWYpKTtcbiAgICB9XG4gICAgY2FzZSAnbGFiZWxGbHVzaCc6XG4gICAgICByZXR1cm4gcHJvcGVydGllcy5sYWJlbEZsdXNoKGZpZWxkRGVmLCBjaGFubmVsLCBzcGVjaWZpZWRBeGlzKTtcbiAgICBjYXNlICdsYWJlbE92ZXJsYXAnOiB7XG4gICAgICBjb25zdCBzY2FsZVR5cGUgPSBtb2RlbC5nZXRTY2FsZUNvbXBvbmVudChjaGFubmVsKS5nZXQoJ3R5cGUnKTtcbiAgICAgIHJldHVybiBwcm9wZXJ0aWVzLmxhYmVsT3ZlcmxhcChmaWVsZERlZiwgc3BlY2lmaWVkQXhpcywgY2hhbm5lbCwgc2NhbGVUeXBlKTtcbiAgICB9XG4gICAgY2FzZSAnb3JpZW50JzpcbiAgICAgIHJldHVybiBnZXRTcGVjaWZpZWRPckRlZmF1bHRWYWx1ZShzcGVjaWZpZWRBeGlzLm9yaWVudCwgcHJvcGVydGllcy5vcmllbnQoY2hhbm5lbCkpO1xuICAgIGNhc2UgJ3RpY2tDb3VudCc6IHtcbiAgICAgIGNvbnN0IHNjYWxlVHlwZSA9IG1vZGVsLmdldFNjYWxlQ29tcG9uZW50KGNoYW5uZWwpLmdldCgndHlwZScpO1xuICAgICAgY29uc3Qgc2l6ZVR5cGUgPSBjaGFubmVsID09PSAneCcgPyAnd2lkdGgnIDogY2hhbm5lbCA9PT0gJ3knID8gJ2hlaWdodCcgOiB1bmRlZmluZWQ7XG4gICAgICBjb25zdCBzaXplID0gc2l6ZVR5cGUgPyBtb2RlbC5nZXRTaXplU2lnbmFsUmVmKHNpemVUeXBlKVxuICAgICAgIDogdW5kZWZpbmVkO1xuICAgICAgcmV0dXJuIGdldFNwZWNpZmllZE9yRGVmYXVsdFZhbHVlKHNwZWNpZmllZEF4aXMudGlja0NvdW50LCBwcm9wZXJ0aWVzLnRpY2tDb3VudChjaGFubmVsLCBmaWVsZERlZiwgc2NhbGVUeXBlLCBzaXplKSk7XG4gICAgfVxuICAgIGNhc2UgJ3RpdGxlJzpcbiAgICAgIGNvbnN0IGNoYW5uZWwyID0gY2hhbm5lbCA9PT0gJ3gnID8gJ3gyJyA6ICd5Mic7XG4gICAgICBjb25zdCBmaWVsZERlZjIgPSBtb2RlbC5maWVsZERlZihjaGFubmVsMik7XG4gICAgICAvLyBLZWVwIHVuZGVmaW5lZCBzbyB3ZSB1c2UgZGVmYXVsdCBpZiB0aXRsZSBpcyB1bnNwZWNpZmllZC5cbiAgICAgIC8vIEZvciBvdGhlciBmYWxzeSB2YWx1ZSwga2VlcCB0aGVtIHNvIHdlIHdpbGwgaGlkZSB0aGUgdGl0bGUuXG4gICAgICBjb25zdCBmaWVsZERlZlRpdGxlID0gZ2V0RmllbGREZWZUaXRsZShtb2RlbCwgY2hhbm5lbCk7XG4gICAgICBjb25zdCBzcGVjaWZpZWRUaXRsZSA9IGZpZWxkRGVmVGl0bGUgIT09IHVuZGVmaW5lZCA/IGZpZWxkRGVmVGl0bGUgOlxuICAgICAgICBzcGVjaWZpZWRBeGlzLnRpdGxlID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiBzcGVjaWZpZWRBeGlzLnRpdGxlO1xuXG4gICAgICByZXR1cm4gZ2V0U3BlY2lmaWVkT3JEZWZhdWx0VmFsdWU8c3RyaW5nIHwgRmllbGREZWZCYXNlPHN0cmluZz5bXT4oXG4gICAgICAgIHNwZWNpZmllZFRpdGxlLFxuICAgICAgICAvLyBJZiB0aXRsZSBub3Qgc3BlY2lmaWVkLCBzdG9yZSBiYXNlIHBhcnRzIG9mIGZpZWxkRGVmIChhbmQgZmllbGREZWYyIGlmIGV4aXN0cylcbiAgICAgICAgbWVyZ2VUaXRsZUZpZWxkRGVmcyhcbiAgICAgICAgICBbdG9GaWVsZERlZkJhc2UoZmllbGREZWYpXSxcbiAgICAgICAgICBmaWVsZERlZjIgPyBbdG9GaWVsZERlZkJhc2UoZmllbGREZWYyKV0gOiBbXVxuICAgICAgICApXG4gICAgICApO1xuICAgIGNhc2UgJ3ZhbHVlcyc6XG4gICAgICByZXR1cm4gcHJvcGVydGllcy52YWx1ZXMoc3BlY2lmaWVkQXhpcywgbW9kZWwsIGZpZWxkRGVmLCBjaGFubmVsKTtcbiAgfVxuICAvLyBPdGhlcndpc2UsIHJldHVybiBzcGVjaWZpZWQgcHJvcGVydHkuXG4gIHJldHVybiBpc0F4aXNQcm9wZXJ0eShwcm9wZXJ0eSkgPyBzcGVjaWZpZWRBeGlzW3Byb3BlcnR5XSA6IHVuZGVmaW5lZDtcbn1cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { isAggregate } from '../../encoding';\nimport { isContinuous, isFieldDef } from '../../fielddef';\nimport * as log from '../../log';\nimport { AREA, BAR, CIRCLE, isMarkDef, LINE, POINT, RECT, RULE, SQUARE, TEXT, TICK } from '../../mark';\nimport { QUANTITATIVE, TEMPORAL } from '../../type';\nimport { contains } from '../../util';\nimport { getMarkConfig } from '../common';\nexport function normalizeMarkDef(mark, encoding, config) {\n    var markDef = isMarkDef(mark) ? tslib_1.__assign({}, mark) : { type: mark };\n    // set orient, which can be overridden by rules as sometimes the specified orient is invalid.\n    var specifiedOrient = markDef.orient || getMarkConfig('orient', markDef, config);\n    markDef.orient = orient(markDef.type, encoding, specifiedOrient);\n    if (specifiedOrient !== undefined && specifiedOrient !== markDef.orient) {\n        log.warn(log.message.orientOverridden(markDef.orient, specifiedOrient));\n    }\n    // set opacity and filled if not specified in mark config\n    var specifiedOpacity = markDef.opacity !== undefined ? markDef.opacity : getMarkConfig('opacity', markDef, config);\n    if (specifiedOpacity === undefined) {\n        markDef.opacity = defaultOpacity(markDef.type, encoding);\n    }\n    var specifiedFilled = markDef.filled;\n    if (specifiedFilled === undefined) {\n        markDef.filled = filled(markDef, config);\n    }\n    return markDef;\n}\nfunction defaultOpacity(mark, encoding) {\n    if (contains([POINT, TICK, CIRCLE, SQUARE], mark)) {\n        // point-based marks\n        if (!isAggregate(encoding)) {\n            return 0.7;\n        }\n    }\n    return undefined;\n}\nfunction filled(markDef, config) {\n    var filledConfig = getMarkConfig('filled', markDef, config);\n    var mark = markDef.type;\n    return filledConfig !== undefined ? filledConfig : mark !== POINT && mark !== LINE && mark !== RULE;\n}\nfunction orient(mark, encoding, specifiedOrient) {\n    switch (mark) {\n        case POINT:\n        case CIRCLE:\n        case SQUARE:\n        case TEXT:\n        case RECT:\n            // orient is meaningless for these marks.\n            return undefined;\n    }\n    var yIsRange = encoding.y2;\n    var xIsRange = encoding.x2;\n    switch (mark) {\n        case BAR:\n            if (yIsRange || xIsRange) {\n                // Ranged bar does not always have clear orientation, so we allow overriding\n                if (specifiedOrient) {\n                    return specifiedOrient;\n                }\n                // If y is range and x is non-range, non-bin Q, y is likely a prebinned field\n                var xDef = encoding.x;\n                if (!xIsRange && isFieldDef(xDef) && xDef.type === QUANTITATIVE && !xDef.bin) {\n                    return 'horizontal';\n                }\n                // If x is range and y is non-range, non-bin Q, x is likely a prebinned field\n                var yDef = encoding.y;\n                if (!yIsRange && isFieldDef(yDef) && yDef.type === QUANTITATIVE && !yDef.bin) {\n                    return 'vertical';\n                }\n            }\n        /* tslint:disable */\n        case RULE: // intentionally fall through\n            // return undefined for line segment rule and bar with both axis ranged\n            if (xIsRange && yIsRange) {\n                return undefined;\n            }\n        case AREA: // intentionally fall through\n            // If there are range for both x and y, y (vertical) has higher precedence.\n            if (yIsRange) {\n                return 'vertical';\n            }\n            else if (xIsRange) {\n                return 'horizontal';\n            }\n            else if (mark === RULE) {\n                if (encoding.x && !encoding.y) {\n                    return 'vertical';\n                }\n                else if (encoding.y && !encoding.x) {\n                    return 'horizontal';\n                }\n            }\n        case LINE: // intentional fall through\n        case TICK: // Tick is opposite to bar, line, area and never have ranged mark.\n            /* tslint:enable */\n            var xIsContinuous = isFieldDef(encoding.x) && isContinuous(encoding.x);\n            var yIsContinuous = isFieldDef(encoding.y) && isContinuous(encoding.y);\n            if (xIsContinuous && !yIsContinuous) {\n                return mark !== 'tick' ? 'horizontal' : 'vertical';\n            }\n            else if (!xIsContinuous && yIsContinuous) {\n                return mark !== 'tick' ? 'vertical' : 'horizontal';\n            }\n            else if (xIsContinuous && yIsContinuous) {\n                var xDef = encoding.x; // we can cast here since they are surely fieldDef\n                var yDef = encoding.y;\n                var xIsTemporal = xDef.type === TEMPORAL;\n                var yIsTemporal = yDef.type === TEMPORAL;\n                // temporal without timeUnit is considered continuous, but better serves as dimension\n                if (xIsTemporal && !yIsTemporal) {\n                    return mark !== 'tick' ? 'vertical' : 'horizontal';\n                }\n                else if (!xIsTemporal && yIsTemporal) {\n                    return mark !== 'tick' ? 'horizontal' : 'vertical';\n                }\n                if (!xDef.aggregate && yDef.aggregate) {\n                    return mark !== 'tick' ? 'vertical' : 'horizontal';\n                }\n                else if (xDef.aggregate && !yDef.aggregate) {\n                    return mark !== 'tick' ? 'horizontal' : 'vertical';\n                }\n                if (specifiedOrient) {\n                    // When ambiguous, use user specified one.\n                    return specifiedOrient;\n                }\n                if (!(mark === LINE && encoding.order)) {\n                    // Except for connected scatterplot, we should log warning for unclear orientation of QxQ plots.\n                    log.warn(log.message.unclearOrientContinuous(mark));\n                }\n                return 'vertical';\n            }\n            else {\n                // For Discrete x Discrete case, return undefined.\n                log.warn(log.message.unclearOrientDiscreteOrEmpty(mark));\n                return undefined;\n            }\n    }\n    return 'vertical';\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5pdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21waWxlL21hcmsvaW5pdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBRUEsT0FBTyxFQUFXLFdBQVcsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ3JELE9BQU8sRUFBVyxZQUFZLEVBQUUsVUFBVSxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDbEUsT0FBTyxLQUFLLEdBQUcsTUFBTSxXQUFXLENBQUM7QUFDakMsT0FBTyxFQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQWlCLEtBQUssRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQ3BILE9BQU8sRUFBQyxZQUFZLEVBQUUsUUFBUSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQ2xELE9BQU8sRUFBQyxRQUFRLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDcEMsT0FBTyxFQUFDLGFBQWEsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUl4QyxNQUFNLDJCQUEyQixJQUFvQixFQUFFLFFBQTBCLEVBQUUsTUFBYztJQUMvRixJQUFNLE9BQU8sR0FBWSxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxzQkFBSyxJQUFJLEVBQUUsQ0FBQyxDQUFDLEVBQUMsSUFBSSxFQUFFLElBQUksRUFBQyxDQUFDO0lBRXBFLDZGQUE2RjtJQUM3RixJQUFNLGVBQWUsR0FBRyxPQUFPLENBQUMsTUFBTSxJQUFJLGFBQWEsQ0FBQyxRQUFRLEVBQUUsT0FBTyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ25GLE9BQU8sQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLEVBQUUsUUFBUSxFQUFFLGVBQWUsQ0FBQyxDQUFDO0lBQ2pFLElBQUksZUFBZSxLQUFLLFNBQVMsSUFBSSxlQUFlLEtBQUss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SUFBSSxDQUFDLENBQUMsSUFBSSxLQUFLLElBQUksSUFBSSxRQUFRLENBQUMsS0FBSyxDQUFDLEVBQUU7b0JBQ3RDLGdHQUFnRztvQkFDaEcsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLHVCQUF1QixDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7aUJBQ3JEO2dCQUNELE9BQU8sVUFBVSxDQUFDO2FBQ25CO2lCQUFNO2dCQUNMLGtEQUFrRDtnQkFDbEQsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLDRCQUE0QixDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7Z0JBQ3pELE9BQU8sU0FBUyxDQUFDO2FBQ2xCO0tBQ0o7SUFDRCxPQUFPLFVBQVUsQ0FBQztBQUNwQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQge0NvbmZpZ30gZnJvbSAnLi4vLi4vY29uZmlnJztcbmltcG9ydCB7RW5jb2RpbmcsIGlzQWdncmVnYXRlfSBmcm9tICcuLi8uLi9lbmNvZGluZyc7XG5pbXBvcnQge0ZpZWxkRGVmLCBpc0NvbnRpbnVvdXMsIGlzRmllbGREZWZ9IGZyb20gJy4uLy4uL2ZpZWxkZGVmJztcbmltcG9ydCAqIGFzIGxvZyBmcm9tICcuLi8uLi9sb2cnO1xuaW1wb3J0IHtBUkVBLCBCQVIsIENJUkNMRSwgaXNNYXJrRGVmLCBMSU5FLCBNYXJrLCBNYXJrRGVmLCBQT0lOVCwgUkVDVCwgUlVMRSwgU1FVQVJFLCBURVhULCBUSUNLfSBmcm9tICcuLi8uLi9tYXJrJztcbmltcG9ydCB7UVVBTlRJVEFUSVZFLCBURU1QT1JBTH0gZnJvbSAnLi4vLi4vdHlwZSc7XG5pbXBvcnQge2NvbnRhaW5zfSBmcm9tICcuLi8uLi91dGlsJztcbmltcG9ydCB7Z2V0TWFya0NvbmZpZ30gZnJvbSAnLi4vY29tbW9uJztcbmltcG9ydCB7T3JpZW50fSBmcm9tICcuLy4uLy4uL3ZlZ2Euc2NoZW1hJztcblxuXG5leHBvcnQgZnVuY3Rpb24gbm9ybWFsaXplTWFya0RlZihtYXJrOiBNYXJrIHwgTWFya0RlZiwgZW5jb2Rpbmc6IEVuY29kaW5nPHN0cmluZz4sIGNvbmZpZzogQ29uZmlnKSB7XG4gIGNvbnN0IG1hcmtEZWY6IE1hcmtEZWYgPSBpc01hcmtEZWYobWFyaykgPyB7Li4ubWFya30gOiB7dHlwZTogbWFya307XG5cbiAgLy8gc2V0IG9yaWVudCwgd2hpY2ggY2FuIGJlIG92ZXJyaWRkZW4gYnkgcnVsZXMgYXMgc29tZXRpbWVzIHRoZSBzcGVjaWZpZWQgb3JpZW50IGlzIGludmFsaWQuXG4gIGNvbnN0IHNwZWNpZmllZE9yaWVudCA9IG1hcmtEZWYub3JpZW50IHx8IGdldE1hcmtDb25maWcoJ29yaWVudCcsIG1hcmtEZWYsIGNvbmZpZyk7XG4gIG1hcmtEZWYub3JpZW50ID0gb3JpZW50KG1hcmtEZWYudHlwZSwgZW5jb2RpbmcsIHNwZWNpZmllZE9yaWVudCk7XG4gIGlmIChzcGVjaWZpZWRPcmllbnQgIT09IHVuZGVmaW5lZCAmJiBzcGVjaWZpZWRPcmllbnQgIT09IG1hcmtEZWYub3JpZW50KSB7XG4gICAgbG9nLndhcm4obG9nLm1lc3NhZ2Uub3JpZW50T3ZlcnJpZGRlbihtYXJrRGVmLm9yaWVudCxzcGVjaWZpZWRPcmllbnQpKTtcbiAgfVxuXG4gIC8vIHNldCBvcGFjaXR5IGFuZCBmaWxsZWQgaWYgbm90IHNwZWNpZmllZCBpbiBtYXJrIGNvbmZpZ1xuICBjb25zdCBzcGVjaWZpZWRPcGFjaXR5ID0gbWFya0RlZi5vcGFjaXR5ICE9PSB1bmRlZmluZWQgPyBtYXJrRGVmLm9wYWNpdHkgOiBnZXRNYXJrQ29uZmlnKCdvcGFjaXR5JywgbWFya0RlZiwgY29uZmlnKTtcbiAgaWYgKHNwZWNpZmllZE9wYWNpdHkgPT09IHVuZGVmaW5lZCkge1xuICAgIG1hcmtEZWYub3BhY2l0eSA9IGRlZmF1bHRPcGFjaXR5KG1hcmtEZWYudHlwZSwgZW5jb2RpbmcpO1xuICB9XG5cbiAgY29uc3Qgc3BlY2lmaWVkRmlsbGVkID0gbWFya0RlZi5maWxsZWQ7XG4gIGlmIChzcGVjaWZpZWRGaWxsZWQgPT09IHVuZGVmaW5lZCkge1xuICAgIG1hcmtEZWYuZmlsbGVkID0gZmlsbGVkKG1hcmtEZWYsIGNvbmZpZyk7XG4gIH1cbiAgcmV0dXJuIG1hcmtEZWY7XG59XG5cbmZ1bmN0aW9uIGRlZmF1bHRPcGFjaXR5KG1hcms6IE1hcmssIGVuY29kaW5nOiBFbmNvZGluZzxzdHJpbmc+KSB7XG4gIGlmIChjb250YWlucyhbUE9JTlQsIFRJQ0ssIENJUkNMRSwgU1FVQVJFXSwgbWFyaykpIHtcbiAgICAvLyBwb2ludC1iYXNlZCBtYXJrc1xuICAgIGlmICghaXNBZ2dyZWdhdGUoZW5jb2RpbmcpKSB7XG4gICAgICByZXR1cm4gMC43O1xuICAgIH1cbiAgfVxuICByZXR1cm4gdW5kZWZpbmVkO1xufVxuXG5mdW5jdGlvbiBmaWxsZWQobWFya0RlZjogTWFya0RlZiwgY29uZmlnOiBDb25maWcpIHtcbiAgY29uc3QgZmlsbGVkQ29uZmlnID0gZ2V0TWFya0NvbmZpZygnZmlsbGVkJywgbWFya0RlZiwgY29uZmlnKTtcbiAgY29uc3QgbWFyayA9IG1hcmtEZWYudHlwZTtcbiAgcmV0dXJuIGZpbGxlZENvbmZpZyAhPT0gdW5kZWZpbmVkID8gZmlsbGVkQ29uZmlnIDogbWFyayAhPT0gUE9JTlQgJiYgbWFyayAhPT0gTElORSAmJiBtYXJrICE9PSBSVUxFO1xufVxuXG5mdW5jdGlvbiBvcmllbnQobWFyazogTWFyaywgZW5jb2Rpbmc6IEVuY29kaW5nPHN0cmluZz4sIHNwZWNpZmllZE9yaWVudDogT3JpZW50KTogT3JpZW50IHtcbiAgc3dpdGNoIChtYXJrKSB7XG4gICAgY2FzZSBQT0lOVDpcbiAgICBjYXNlIENJUkNMRTpcbiAgICBjYXNlIFNRVUFSRTpcbiAgICBjYXNlIFRFWFQ6XG4gICAgY2FzZSBSRUNUOlxuICAgICAgLy8gb3JpZW50IGlzIG1lYW5pbmdsZXNzIGZvciB0aGVzZSBtYXJrcy5cbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICBjb25zdCB5SXNSYW5nZSA9IGVuY29kaW5nLnkyO1xuICBjb25zdCB4SXNSYW5nZSA9IGVuY29kaW5nLngyO1xuXG4gIHN3aXRjaCAobWFyaykge1xuICAgIGNhc2UgQkFSOlxuICAgICAgaWYgKHlJc1JhbmdlIHx8IHhJc1JhbmdlKSB7XG4gICAgICAgIC8vIFJhbmdlZCBiYXIgZG9lcyBub3QgYWx3YXlzIGhhdmUgY2xlYXIgb3JpZW50YXRpb24sIHNvIHdlIGFsbG93IG92ZXJyaWRpbmdcbiAgICAgICAgaWYgKHNwZWNpZmllZE9yaWVudCkge1xuICAgICAgICAgIHJldHVybiBzcGVjaWZpZWRPcmllbnQ7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiB5IGlzIHJhbmdlIGFuZCB4IGlzIG5vbi1yYW5nZSwgbm9uLWJpbiBRLCB5IGlzIGxpa2VseSBhIHByZWJpbm5lZCBmaWVsZFxuICAgICAgICBjb25zdCB4RGVmID0gZW5jb2RpbmcueDtcbiAgICAgICAgaWYgKCF4SXNSYW5nZSAmJiBpc0ZpZWxkRGVmKHhEZWYpICYmIHhEZWYudHlwZSA9PT0gUVVBTlRJVEFUSVZFICYmICF4RGVmLmJpbikge1xuICAgICAgICAgIHJldHVybiAnaG9yaXpvbnRhbCc7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiB4IGlzIHJhbmdlIGFuZCB5IGlzIG5vbi1yYW5nZSwgbm9uLWJpbiBRLCB4IGlzIGxpa2VseSBhIHByZWJpbm5lZCBmaWVsZFxuICAgICAgICBjb25zdCB5RGVmID0gZW5jb2RpbmcueTtcbiAgICAgICAgaWYgKCF5SXNSYW5nZSAmJiBpc0ZpZWxkRGVmKHlEZWYpICYmIHlEZWYudHlwZSA9PT0gUVVBTlRJVEFUSVZFICYmICF5RGVmLmJpbikge1xuICAgICAgICAgIHJldHVybiAndmVydGljYWwnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvKiB0c2xpbnQ6ZGlzYWJsZSAqL1xuICAgIGNhc2UgUlVMRTogLy8gaW50ZW50aW9uYWxseSBmYWxsIHRocm91Z2hcbiAgICAgIC8vIHJldHVybiB1bmRlZmluZWQgZm9yIGxpbmUgc2VnbWVudCBydWxlIGFuZCBiYXIgd2l0aCBib3RoIGF4aXMgcmFuZ2VkXG4gICAgICBpZiAoeElzUmFuZ2UgJiYgeUlzUmFuZ2UpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgIH1cblxuICAgIGNhc2UgQVJFQTogLy8gaW50ZW50aW9uYWxseSBmYWxsIHRocm91Z2hcbiAgICAgIC8vIElmIHRoZXJlIGFyZSByYW5nZSBmb3IgYm90aCB4IGFuZCB5LCB5ICh2ZXJ0aWNhbCkgaGFzIGhpZ2hlciBwcmVjZWRlbmNlLlxuICAgICAgaWYgKHlJc1JhbmdlKSB7XG4gICAgICAgIHJldHVybiAndmVydGljYWwnO1xuICAgICAgfSBlbHNlIGlmICh4SXNSYW5nZSkge1xuICAgICAgICByZXR1cm4gJ2hvcml6b250YWwnO1xuICAgICAgfSBlbHNlIGlmIChtYXJrID09PSBSVUxFKSB7XG4gICAgICAgIGlmIChlbmNvZGluZy54ICYmICFlbmNvZGluZy55KSB7XG4gICAgICAgICAgcmV0dXJuICd2ZXJ0aWNhbCc7XG4gICAgICAgIH0gZWxzZSBpZiAoZW5jb2RpbmcueSAmJiAhZW5jb2RpbmcueCkge1xuICAgICAgICAgIHJldHVybiAnaG9yaXpvbnRhbCc7XG4gICAgICAgIH1cbiAgICAgIH1cblxuXG4gICAgY2FzZSBMSU5FOiAvLyBpbnRlbnRpb25hbCBmYWxsIHRocm91Z2hcbiAgICBjYXNlIFRJQ0s6IC8vIFRpY2sgaXMgb3Bwb3NpdGUgdG8gYmFyLCBsaW5lLCBhcmVhIGFuZCBuZXZlciBoYXZlIHJhbmdlZCBtYXJrLlxuXG4gICAgICAvKiB0c2xpbnQ6ZW5hYmxlICovXG4gICAgICBjb25zdCB4SXNDb250aW51b3VzID0gaXNGaWVsZERlZihlbmNvZGluZy54KSAmJiBpc0NvbnRpbnVvdXMoZW5jb2RpbmcueCk7XG4gICAgICBjb25zdCB5SXNDb250aW51b3VzID0gaXNGaWVsZERlZihlbmNvZGluZy55KSAmJiBpc0NvbnRpbnVvdXMoZW5jb2RpbmcueSk7XG4gICAgICBpZiAoeElzQ29udGludW91cyAmJiAheUlzQ29udGludW91cykge1xuICAgICAgICByZXR1cm4gbWFyayAhPT0gJ3RpY2snID8gJ2hvcml6b250YWwnIDogJ3ZlcnRpY2FsJztcbiAgICAgIH0gZWxzZSBpZiAoIXhJc0NvbnRpbnVvdXMgJiYgeUlzQ29udGludW91cykge1xuICAgICAgICByZXR1cm4gbWFyayAhPT0gJ3RpY2snID8gJ3ZlcnRpY2FsJyA6ICdob3Jpem9udGFsJztcbiAgICAgIH0gZWxzZSBpZiAoeElzQ29udGludW91cyAmJiB5SXNDb250aW51b3VzKSB7XG4gICAgICAgIGNvbnN0IHhEZWYgPSBlbmNvZGluZy54IGFzIEZpZWxkRGVmPHN0cmluZz47IC8vIHdlIGNhbiBjYXN0IGhlcmUgc2luY2UgdGhleSBhcmUgc3VyZWx5IGZpZWxkRGVmXG4gICAgICAgIGNvbnN0IHlEZWYgPSBlbmNvZGluZy55IGFzIEZpZWxkRGVmPHN0cmluZz47XG5cbiAgICAgICAgY29uc3QgeElzVGVtcG9yYWwgPSB4RGVmLnR5cGUgPT09IFRFTVBPUkFMO1xuICAgICAgICBjb25zdCB5SXNUZW1wb3JhbCA9IHlEZWYudHlwZSA9PT0gVEVNUE9SQUw7XG5cbiAgICAgICAgLy8gdGVtcG9yYWwgd2l0aG91dCB0aW1lVW5pdCBpcyBjb25zaWRlcmVkIGNvbnRpbnVvdXMsIGJ1dCBiZXR0ZXIgc2VydmVzIGFzIGRpbWVuc2lvblxuICAgICAgICBpZiAoeElzVGVtcG9yYWwgJiYgIXlJc1RlbXBvcmFsKSB7XG4gICAgICAgICAgcmV0dXJuIG1hcmsgIT09ICd0aWNrJyA/ICd2ZXJ0aWNhbCcgOiAnaG9yaXpvbnRhbCc7XG4gICAgICAgIH0gZWxzZSBpZiAoIXhJc1RlbXBvcmFsICYmIHlJc1RlbXBvcmFsKSB7XG4gICAgICAgICAgcmV0dXJuIG1hcmsgIT09ICd0aWNrJyA/ICdob3Jpem9udGFsJyA6ICd2ZXJ0aWNhbCc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXhEZWYuYWdncmVnYXRlICYmIHlEZWYuYWdncmVnYXRlKSB7XG4gICAgICAgICAgcmV0dXJuIG1hcmsgIT09ICd0aWNrJyA/ICd2ZXJ0aWNhbCcgOiAnaG9yaXpvbnRhbCc7XG4gICAgICAgIH0gZWxzZSBpZiAoeERlZi5hZ2dyZWdhdGUgJiYgIXlEZWYuYWdncmVnYXRlKSB7XG4gICAgICAgICAgcmV0dXJuIG1hcmsgIT09ICd0aWNrJyA/ICdob3Jpem9udGFsJyA6ICd2ZXJ0aWNhbCc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc3BlY2lmaWVkT3JpZW50KSB7XG4gICAgICAgICAgLy8gV2hlbiBhbWJpZ3VvdXMsIHVzZSB1c2VyIHNwZWNpZmllZCBvbmUuXG4gICAgICAgICAgcmV0dXJuIHNwZWNpZmllZE9yaWVudDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghKG1hcmsgPT09IExJTkUgJiYgZW5jb2Rpbmcub3JkZXIpKSB7XG4gICAgICAgICAgLy8gRXhjZXB0IGZvciBjb25uZWN0ZWQgc2NhdHRlcnBsb3QsIHdlIHNob3VsZCBsb2cgd2FybmluZyBmb3IgdW5jbGVhciBvcmllbnRhdGlvbiBvZiBReFEgcGxvdHMuXG4gICAgICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UudW5jbGVhck9yaWVudENvbnRpbnVvdXMobWFyaykpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAndmVydGljYWwnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRm9yIERpc2NyZXRlIHggRGlzY3JldGUgY2FzZSwgcmV0dXJuIHVuZGVmaW5lZC5cbiAgICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UudW5jbGVhck9yaWVudERpc2NyZXRlT3JFbXB0eShtYXJrKSk7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICB9XG4gIH1cbiAgcmV0dXJuICd2ZXJ0aWNhbCc7XG59XG5cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport * as mixins from './mixins';\nexport var area = {\n    vgMark: 'area',\n    encodeEntry: function (model) {\n        return tslib_1.__assign({}, mixins.baseEncodeEntry(model, { size: 'ignore', orient: 'include' }), mixins.pointPosition('x', model, 'zeroOrMin'), mixins.pointPosition('y', model, 'zeroOrMin'), mixins.pointPosition2(model, 'zeroOrMin', model.markDef.orient === 'horizontal' ? 'x2' : 'y2'), mixins.defined(model));\n    }\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXJlYS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21waWxlL21hcmsvYXJlYS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBRUEsT0FBTyxLQUFLLE1BQU0sTUFBTSxVQUFVLENBQUM7QUFHbkMsTUFBTSxDQUFDLElBQU0sSUFBSSxHQUFpQjtJQUNoQyxNQUFNLEVBQUUsTUFBTTtJQUNkLFdBQVcsRUFBRSxVQUFDLEtBQWdCO1FBQzVCLDRCQUNLLE1BQU0sQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLEVBQUMsSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFDLENBQUMsRUFDbEUsTUFBTSxDQUFDLGFBQWEsQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLFdBQVcsQ0FBQyxFQUM3QyxNQUFNLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsV0FBVyxDQUFDLEVBQzdDLE1BQU0sQ0FBQyxjQUFjLENBQUMsS0FBSyxFQUFFLFdBQVcsRUFBRSxLQUFLLENBQUMsT0FBTyxDQUFDLE1BQU0sS0FBSyxZQUFZLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQzlGLE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQ3hCO0lBQ0osQ0FBQztDQUNGLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1VuaXRNb2RlbH0gZnJvbSAnLi4vdW5pdCc7XG5pbXBvcnQge01hcmtDb21waWxlcn0gZnJvbSAnLi9iYXNlJztcbmltcG9ydCAqIGFzIG1peGlucyBmcm9tICcuL21peGlucyc7XG5cblxuZXhwb3J0IGNvbnN0IGFyZWE6IE1hcmtDb21waWxlciA9IHtcbiAgdmdNYXJrOiAnYXJlYScsXG4gIGVuY29kZUVudHJ5OiAobW9kZWw6IFVuaXRNb2RlbCkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICAuLi5taXhpbnMuYmFzZUVuY29kZUVudHJ5KG1vZGVsLCB7c2l6ZTogJ2lnbm9yZScsIG9yaWVudDogJ2luY2x1ZGUnfSksXG4gICAgICAuLi5taXhpbnMucG9pbnRQb3NpdGlvbigneCcsIG1vZGVsLCAnemVyb09yTWluJyksXG4gICAgICAuLi5taXhpbnMucG9pbnRQb3NpdGlvbigneScsIG1vZGVsLCAnemVyb09yTWluJyksXG4gICAgICAuLi5taXhpbnMucG9pbnRQb3NpdGlvbjIobW9kZWwsICd6ZXJvT3JNaW4nLCBtb2RlbC5tYXJrRGVmLm9yaWVudCA9PT0gJ2hvcml6b250YWwnID8gJ3gyJyA6ICd5MicpLFxuICAgICAgLi4ubWl4aW5zLmRlZmluZWQobW9kZWwpXG4gICAgfTtcbiAgfVxufTtcbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { isNumber } from 'vega-util';\nimport { X, Y } from '../../channel';\nimport { isFieldDef } from '../../fielddef';\nimport * as log from '../../log';\nimport { hasDiscreteDomain, ScaleType } from '../../scale';\nimport { isVgRangeStep } from '../../vega.schema';\nimport * as mixins from './mixins';\nimport * as ref from './valueref';\nexport var bar = {\n    vgMark: 'rect',\n    encodeEntry: function (model) {\n        return tslib_1.__assign({}, mixins.baseEncodeEntry(model, { size: 'ignore', orient: 'ignore' }), x(model), y(model));\n    }\n};\nfunction x(model) {\n    var config = model.config, encoding = model.encoding, markDef = model.markDef, width = model.width;\n    var orient = markDef.orient;\n    var sizeDef = encoding.size;\n    var xDef = encoding.x;\n    var x2Def = encoding.x2;\n    var xScaleName = model.scaleName(X);\n    var xScale = model.getScaleComponent(X);\n    // x, x2, and width -- we must specify two of these in all conditions\n    if (orient === 'horizontal' || x2Def) {\n        return tslib_1.__assign({}, mixins.pointPosition('x', model, 'zeroOrMin'), mixins.pointPosition2(model, 'zeroOrMin', 'x2'));\n    }\n    else { // vertical\n        if (isFieldDef(xDef)) {\n            var xScaleType = xScale.get('type');\n            if (xDef.bin && !sizeDef && !hasDiscreteDomain(xScaleType)) {\n                return mixins.binnedPosition(xDef, 'x', model.scaleName('x'), markDef.binSpacing === undefined ? config.bar.binSpacing : markDef.binSpacing, xScale.get('reverse'));\n            }\n            else {\n                if (xScaleType === ScaleType.BAND) {\n                    return mixins.bandPosition(xDef, 'x', model);\n                }\n            }\n        }\n        // sized bin, normal point-ordinal axis, quantitative x-axis, or no x\n        return mixins.centeredBandPosition('x', model, tslib_1.__assign({}, ref.mid(width)), defaultSizeRef(markDef, xScaleName, xScale, config));\n    }\n}\nfunction y(model) {\n    var config = model.config, encoding = model.encoding, height = model.height, markDef = model.markDef;\n    var orient = markDef.orient;\n    var sizeDef = encoding.size;\n    var yDef = encoding.y;\n    var y2Def = encoding.y2;\n    var yScaleName = model.scaleName(Y);\n    var yScale = model.getScaleComponent(Y);\n    // y, y2 & height -- we must specify two of these in all conditions\n    if (orient === 'vertical' || y2Def) {\n        return tslib_1.__assign({}, mixins.pointPosition('y', model, 'zeroOrMin'), mixins.pointPosition2(model, 'zeroOrMin', 'y2'));\n    }\n    else {\n        if (isFieldDef(yDef)) {\n            var yScaleType = yScale.get('type');\n            if (yDef.bin && !sizeDef && !hasDiscreteDomain(yScaleType)) {\n                return mixins.binnedPosition(yDef, 'y', model.scaleName('y'), markDef.binSpacing === undefined ? config.bar.binSpacing : markDef.binSpacing, yScale.get('reverse'));\n            }\n            else if (yScaleType === ScaleType.BAND) {\n                return mixins.bandPosition(yDef, 'y', model);\n            }\n        }\n        return mixins.centeredBandPosition('y', model, ref.mid(height), defaultSizeRef(markDef, yScaleName, yScale, config));\n    }\n}\nfunction defaultSizeRef(markDef, scaleName, scale, config) {\n    if (markDef.size !== undefined) {\n        return { value: markDef.size };\n    }\n    else if (config.bar.discreteBandSize) {\n        return { value: config.bar.discreteBandSize };\n    }\n    else if (scale) {\n        var scaleType = scale.get('type');\n        if (scaleType === ScaleType.POINT) {\n            var scaleRange = scale.get('range');\n            if (isVgRangeStep(scaleRange) && isNumber(scaleRange.step)) {\n                return { value: scaleRange.step - 1 };\n            }\n            log.warn(log.message.BAR_WITH_POINT_SCALE_AND_RANGESTEP_NULL);\n        }\n        else if (scaleType === ScaleType.BAND) {\n            return ref.bandRef(scaleName);\n        }\n        else { // non-ordinal scale\n            return { value: config.bar.continuousBandSize };\n        }\n    }\n    else if (config.scale.rangeStep && config.scale.rangeStep !== null) {\n        return { value: config.scale.rangeStep - 1 };\n    }\n    return { value: 20 };\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBpbGUvbWFyay9iYXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBQyxRQUFRLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDbkMsT0FBTyxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFFbkMsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQzFDLE9BQU8sS0FBSyxHQUFHLE1BQU0sV0FBVyxDQUFDO0FBRWpDLE9BQU8sRUFBQyxpQkFBaUIsRUFBRSxTQUFTLEVBQUMsTUFBTSxhQUFhLENBQUM7QUFDekQsT0FBTyxFQUFDLGFBQWEsRUFBZ0IsTUFBTSxtQkFBbUIsQ0FBQztBQUsvRCxPQUFPLEtBQUssTUFBTSxNQUFNLFVBQVUsQ0FBQztBQUNuQyxPQUFPLEtBQUssR0FBRyxNQUFNLFlBQVksQ0FBQztBQUdsQyxNQUFNLENBQUMsSUFBTSxHQUFHLEdBQWlCO0lBQy9CLE1BQU0sRUFBRSxNQUFNO0lBQ2QsV0FBVyxFQUFFLFVBQUMsS0FBZ0I7UUFDNUIsNEJBQ0ssTUFBTSxDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsRUFBQyxJQUFJLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUMsQ0FBQyxFQUNqRSxDQUFDLENBQUMsS0FBSyxDQUFDLEVBQ1IsQ0FBQyxDQUFDLEtBQUssQ0FBQyxFQUNYO0lBQ0osQ0FBQztDQUNGLENBQUM7QUFFRixXQUFXLEtBQWdCO0lBQ2xCLElBQUEscUJBQU0sRUFBRSx5QkFBUSxFQUFFLHVCQUFPLEVBQUUsbUJBQUssQ0FBVTtJQUNqRCxJQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDO0lBQzlCLElBQU0sT0FBTyxHQUFHLFFBQVEsQ0FBQyxJQUFJLENBQUM7SUFFOUIsSUFBTSxJQUFJLEdBQUcsUUFBUSxDQUFDLENBQUMsQ0FBQztJ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QUFHLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDdEMsSUFBSSxhQUFhLENBQUMsVUFBVSxDQUFDLElBQUksUUFBUSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsRUFBRTtnQkFDMUQsT0FBTyxFQUFDLEtBQUssRUFBRSxVQUFVLENBQUMsSUFBSSxHQUFHLENBQUMsRUFBQyxDQUFDO2FBQ3JDO1lBQ0QsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLHVDQUF1QyxDQUFDLENBQUM7U0FDL0Q7YUFBTSxJQUFJLFNBQVMsS0FBSyxTQUFTLENBQUMsSUFBSSxFQUFFO1lBQ3ZDLE9BQU8sR0FBRyxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQztTQUMvQjthQUFNLEVBQUUsb0JBQW9CO1lBQzNCLE9BQU8sRUFBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxrQkFBa0IsRUFBQyxDQUFDO1NBQy9DO0tBQ0Y7U0FBTSxJQUFJLE1BQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxJQUFJLE1BQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxLQUFLLElBQUksRUFBRTtRQUNwRSxPQUFPLEVBQUMsS0FBSyxFQUFFLE1BQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxHQUFHLENBQUMsRUFBQyxDQUFDO0tBQzVDO0lBQ0QsT0FBTyxFQUFDLEtBQUssRUFBRSxFQUFFLEVBQUMsQ0FBQztBQUNyQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtpc051bWJlcn0gZnJvbSAndmVnYS11dGlsJztcbmltcG9ydCB7WCwgWX0gZnJvbSAnLi4vLi4vY2hhbm5lbCc7XG5pbXBvcnQge0NvbmZpZ30gZnJvbSAnLi4vLi4vY29uZmlnJztcbmltcG9ydCB7aXNGaWVsZERlZn0gZnJvbSAnLi4vLi4vZmllbGRkZWYnO1xuaW1wb3J0ICogYXMgbG9nIGZyb20gJy4uLy4uL2xvZyc7XG5pbXBvcnQge01hcmtEZWZ9IGZyb20gJy4uLy4uL21hcmsnO1xuaW1wb3J0IHtoYXNEaXNjcmV0ZURvbWFpbiwgU2NhbGVUeXBlfSBmcm9tICcuLi8uLi9zY2FsZSc7XG5pbXBvcnQge2lzVmdSYW5nZVN0ZXAsIFZnRW5jb2RlRW50cnl9IGZyb20gJy4uLy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7VmdWYWx1ZVJlZn0gZnJvbSAnLi4vLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtTY2FsZUNvbXBvbmVudH0gZnJvbSAnLi4vc2NhbGUvY29tcG9uZW50JztcbmltcG9ydCB7VW5pdE1vZGVsfSBmcm9tICcuLi91bml0JztcbmltcG9ydCB7TWFya0NvbXBpbGVyfSBmcm9tICcuL2Jhc2UnO1xuaW1wb3J0ICogYXMgbWl4aW5zIGZyb20gJy4vbWl4aW5zJztcbmltcG9ydCAqIGFzIHJlZiBmcm9tICcuL3ZhbHVlcmVmJztcblxuXG5leHBvcnQgY29uc3QgYmFyOiBNYXJrQ29tcGlsZXIgPSB7XG4gIHZnTWFyazogJ3JlY3QnLFxuICBlbmNvZGVFbnRyeTogKG1vZGVsOiBVbml0TW9kZWwpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgLi4ubWl4aW5zLmJhc2VFbmNvZGVFbnRyeShtb2RlbCwge3NpemU6ICdpZ25vcmUnLCBvcmllbnQ6ICdpZ25vcmUnfSksXG4gICAgICAuLi54KG1vZGVsKSxcbiAgICAgIC4uLnkobW9kZWwpLFxuICAgIH07XG4gIH1cbn07XG5cbmZ1bmN0aW9uIHgobW9kZWw6IFVuaXRNb2RlbCk6IFZnRW5jb2RlRW50cnkge1xuICBjb25zdCB7Y29uZmlnLCBlbmNvZGluZywgbWFya0RlZiwgd2lkdGh9ID0gbW9kZWw7XG4gIGNvbnN0IG9yaWVudCA9IG1hcmtEZWYub3JpZW50O1xuICBjb25zdCBzaXplRGVmID0gZW5jb2Rpbmcuc2l6ZTtcblxuICBjb25zdCB4RGVmID0gZW5jb2RpbmcueDtcbiAgY29uc3QgeDJEZWYgPSBlbmNvZGluZy54MjtcbiAgY29uc3QgeFNjYWxlTmFtZSA9IG1vZGVsLnNjYWxlTmFtZShYKTtcbiAgY29uc3QgeFNjYWxlID0gbW9kZWwuZ2V0U2NhbGVDb21wb25lbnQoWCk7XG4gIC8vIHgsIHgyLCBhbmQgd2lkdGggLS0gd2UgbXVzdCBzcGVjaWZ5IHR3byBvZiB0aGVzZSBpbiBhbGwgY29uZGl0aW9uc1xuICBpZiAob3JpZW50ID09PSAnaG9yaXpvbnRhbCcgfHwgeDJEZWYpIHtcbiAgICByZXR1cm4ge1xuICAgICAgLi4ubWl4aW5zLnBvaW50UG9zaXRpb24oJ3gnLCBtb2RlbCwgJ3plcm9Pck1pbicpLFxuICAgICAgLi4ubWl4aW5zLnBvaW50UG9zaXRpb24yKG1vZGVsLCAnemVyb09yTWluJywgJ3gyJyksXG4gICAgfTtcbiAgfSBlbHNlIHsgLy8gdmVydGljYWxcbiAgICBpZiAoaXNGaWVsZERlZih4RGVmKSkge1xuICAgICAgY29uc3QgeFNjYWxlVHlwZSA9IHhTY2FsZS5nZXQoJ3R5cGUnKTtcbiAgICAgIGlmICh4RGVmLmJpbiAmJiAhc2l6ZURlZiAmJiAhaGFzRGlzY3JldGVEb21haW4oeFNjYWxlVHlwZSkpIHtcbiAgICAgICAgcmV0dXJuIG1peGlucy5iaW5uZWRQb3NpdGlvbihcbiAgICAgICAgICB4RGVmLCAneCcsIG1vZGVsLnNjYWxlTmFtZSgneCcpLCBtYXJrRGVmLmJpblNwYWNpbmcgPT09IHVuZGVmaW5lZCA/IGNvbmZpZy5iYXIuYmluU3BhY2luZyA6IG1hcmtEZWYuYmluU3BhY2luZyxcbiAgICAgICAgICB4U2NhbGUuZ2V0KCdyZXZlcnNlJylcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh4U2NhbGVUeXBlID09PSBTY2FsZVR5cGUuQkFORCkge1xuICAgICAgICAgIHJldHVybiBtaXhpbnMuYmFuZFBvc2l0aW9uKHhEZWYsICd4JywgbW9kZWwpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIC8vIHNpemVkIGJpbiwgbm9ybWFsIHBvaW50LW9yZGluYWwgYXhpcywgcXVhbnRpdGF0aXZlIHgtYXhpcywgb3Igbm8geFxuXG4gICAgcmV0dXJuIG1peGlucy5jZW50ZXJlZEJhbmRQb3NpdGlvbigneCcsIG1vZGVsLFxuICAgICAgey4uLnJlZi5taWQod2lkdGgpfSxcbiAgICAgIGRlZmF1bHRTaXplUmVmKG1hcmtEZWYsIHhTY2FsZU5hbWUsIHhTY2FsZSwgY29uZmlnKVxuICAgICk7XG4gIH1cbn1cblxuZnVuY3Rpb24geShtb2RlbDogVW5pdE1vZGVsKSB7XG4gIGNvbnN0IHtjb25maWcsIGVuY29kaW5nLCBoZWlnaHQsIG1hcmtEZWZ9ID0gbW9kZWw7XG4gIGNvbnN0IG9yaWVudCA9IG1hcmtEZWYub3JpZW50O1xuICBjb25zdCBzaXplRGVmID0gZW5jb2Rpbmcuc2l6ZTtcblxuICBjb25zdCB5RGVmID0gZW5jb2RpbmcueTtcbiAgY29uc3QgeTJEZWYgPSBlbmNvZGluZy55MjtcbiAgY29uc3QgeVNjYWxlTmFtZSA9IG1vZGVsLnNjYWxlTmFtZShZKTtcbiAgY29uc3QgeVNjYWxlID0gbW9kZWwuZ2V0U2NhbGVDb21wb25lbnQoWSk7XG5cbiAgLy8geSwgeTIgJiBoZWlnaHQgLS0gd2UgbXVzdCBzcGVjaWZ5IHR3byBvZiB0aGVzZSBpbiBhbGwgY29uZGl0aW9uc1xuICBpZiAob3JpZW50ID09PSAndmVydGljYWwnIHx8IHkyRGVmKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLm1peGlucy5wb2ludFBvc2l0aW9uKCd5JywgbW9kZWwsICd6ZXJvT3JNaW4nKSxcbiAgICAgIC4uLm1peGlucy5wb2ludFBvc2l0aW9uMihtb2RlbCwgJ3plcm9Pck1pbicsICd5MicpLFxuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgaWYgKGlzRmllbGREZWYoeURlZikpIHtcbiAgICAgIGNvbnN0IHlTY2FsZVR5cGUgPSB5U2NhbGUuZ2V0KCd0eXBlJyk7XG4gICAgICBpZiAoeURlZi5iaW4gJiYgIXNpemVEZWYgJiYgIWhhc0Rpc2NyZXRlRG9tYWluKHlTY2FsZVR5cGUpKSB7XG4gICAgICAgIHJldHVybiBtaXhpbnMuYmlubmVkUG9zaXRpb24oXG4gICAgICAgICAgeURlZiwgJ3knLCBtb2RlbC5zY2FsZU5hbWUoJ3knKSxcbiAgICAgICAgICBtYXJrRGVmLmJpblNwYWNpbmcgPT09IHVuZGVmaW5lZCA/IGNvbmZpZy5iYXIuYmluU3BhY2luZyA6IG1hcmtEZWYuYmluU3BhY2luZyxcbiAgICAgICAgICB5U2NhbGUuZ2V0KCdyZXZlcnNlJylcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSBpZiAoeVNjYWxlVHlwZSA9PT0gU2NhbGVUeXBlLkJBTkQpIHtcbiAgICAgICAgcmV0dXJuIG1peGlucy5iYW5kUG9zaXRpb24oeURlZiwgJ3knLCBtb2RlbCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtaXhpbnMuY2VudGVyZWRCYW5kUG9zaXRpb24oJ3knLCBtb2RlbCwgcmVmLm1pZChoZWlnaHQpLFxuICAgICAgZGVmYXVsdFNpemVSZWYobWFya0RlZiwgeVNjYWxlTmFtZSwgeVNjYWxlLCBjb25maWcpXG4gICAgKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBkZWZhdWx0U2l6ZVJlZihtYXJrRGVmOiBNYXJrRGVmLCBzY2FsZU5hbWU6IHN0cmluZywgc2NhbGU6IFNjYWxlQ29tcG9uZW50LCBjb25maWc6IENvbmZpZyk6IFZnVmFsdWVSZWYge1xuICBpZiAobWFya0RlZi5zaXplICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4ge3ZhbHVlOiBtYXJrRGVmLnNpemV9O1xuICB9IGVsc2UgaWYgKGNvbmZpZy5iYXIuZGlzY3JldGVCYW5kU2l6ZSkge1xuICAgIHJldHVybiB7dmFsdWU6IGNvbmZpZy5iYXIuZGlzY3JldGVCYW5kU2l6ZX07XG4gIH0gZWxzZSBpZiAoc2NhbGUpIHtcbiAgICBjb25zdCBzY2FsZVR5cGUgPSBzY2FsZS5nZXQoJ3R5cGUnKTtcbiAgICBpZiAoc2NhbGVUeXBlID09PSBTY2FsZVR5cGUuUE9JTlQpIHtcbiAgICAgIGNvbnN0IHNjYWxlUmFuZ2UgPSBzY2FsZS5nZXQoJ3JhbmdlJyk7XG4gICAgICBpZiAoaXNWZ1JhbmdlU3RlcChzY2FsZVJhbmdlKSAmJiBpc051bWJlcihzY2FsZVJhbmdlLnN0ZXApKSB7XG4gICAgICAgIHJldHVybiB7dmFsdWU6IHNjYWxlUmFuZ2Uuc3RlcCAtIDF9O1xuICAgICAgfVxuICAgICAgbG9nLndhcm4obG9nLm1lc3NhZ2UuQkFSX1dJVEhfUE9JTlRfU0NBTEVfQU5EX1JBTkdFU1RFUF9OVUxMKTtcbiAgICB9IGVsc2UgaWYgKHNjYWxlVHlwZSA9PT0gU2NhbGVUeXBlLkJBTkQpIHtcbiAgICAgIHJldHVybiByZWYuYmFuZFJlZihzY2FsZU5hbWUpO1xuICAgIH0gZWxzZSB7IC8vIG5vbi1vcmRpbmFsIHNjYWxlXG4gICAgICByZXR1cm4ge3ZhbHVlOiBjb25maWcuYmFyLmNvbnRpbnVvdXNCYW5kU2l6ZX07XG4gICAgfVxuICB9IGVsc2UgaWYgKGNvbmZpZy5zY2FsZS5yYW5nZVN0ZXAgJiYgY29uZmlnLnNjYWxlLnJhbmdlU3RlcCAhPT0gbnVsbCkge1xuICAgIHJldHVybiB7dmFsdWU6IGNvbmZpZy5zY2FsZS5yYW5nZVN0ZXAgLSAxfTtcbiAgfVxuICByZXR1cm4ge3ZhbHVlOiAyMH07XG59XG5cbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport * as mixins from './mixins';\nimport { isFieldDef, vgField } from '../../fielddef';\nimport { GEOJSON } from '../../type';\nexport var geoshape = {\n    vgMark: 'shape',\n    encodeEntry: function (model) {\n        return tslib_1.__assign({}, mixins.baseEncodeEntry(model, { size: 'ignore', orient: 'ignore' }));\n    },\n    postEncodingTransform: function (model) {\n        var encoding = model.encoding;\n        var shapeDef = encoding.shape;\n        var transform = tslib_1.__assign({ type: 'geoshape', projection: model.projectionName() }, (shapeDef && isFieldDef(shapeDef) && shapeDef.type === GEOJSON ? { field: vgField(shapeDef, { expr: 'datum' }) } : {}));\n        return [transform];\n    }\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2Vvc2hhcGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9tYXJrL2dlb3NoYXBlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQSxPQUFPLEtBQUssTUFBTSxNQUFNLFVBQVUsQ0FBQztBQUVuQyxPQUFPLEVBQUMsVUFBVSxFQUFFLE9BQU8sRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ25ELE9BQU8sRUFBQyxPQUFPLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFJbkMsTUFBTSxDQUFDLElBQU0sUUFBUSxHQUFpQjtJQUNwQyxNQUFNLEVBQUUsT0FBTztJQUNmLFdBQVcsRUFBRSxVQUFDLEtBQWdCO1FBQzVCLDRCQUNLLE1BQU0sQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLEVBQUMsSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFDLENBQUMsRUFDcEU7SUFDSixDQUFDO0lBQ0QscUJBQXFCLEVBQUUsVUFBQyxLQUFnQjtRQUMvQixJQUFBLHlCQUFRLENBQVU7UUFDekIsSUFBTSxRQUFRLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQztRQUVoQyxJQUFNLFNBQVMsc0JBQ2IsSUFBSSxFQUFFLFVBQVUsRUFDaEIsVUFBVSxFQUFFLEtBQUssQ0FBQyxjQUFjLEVBQUUsSUFFL0IsQ0FBQyxRQUFRLElBQUksVUFBVSxDQUFDLFFBQVEsQ0FBQyxJQUFJLFFBQVEsQ0FBQyxJQUFJLEtBQUssT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsUUFBUSxFQUFFLEVBQUMsSUFBSSxFQUFFLE9BQU8sRUFBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQ3RILENBQUM7UUFDRixPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDckIsQ0FBQztDQUNGLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1VuaXRNb2RlbH0gZnJvbSAnLi4vdW5pdCc7XG5pbXBvcnQgKiBhcyBtaXhpbnMgZnJvbSAnLi9taXhpbnMnO1xuXG5pbXBvcnQge2lzRmllbGREZWYsIHZnRmllbGR9IGZyb20gJy4uLy4uL2ZpZWxkZGVmJztcbmltcG9ydCB7R0VPSlNPTn0gZnJvbSAnLi4vLi4vdHlwZSc7XG5pbXBvcnQge1ZnR2VvU2hhcGVUcmFuc2Zvcm0sIFZnUG9zdEVuY29kaW5nVHJhbnNmb3JtfSBmcm9tICcuLi8uLi92ZWdhLnNjaGVtYSc7XG5pbXBvcnQge01hcmtDb21waWxlcn0gZnJvbSAnLi9iYXNlJztcblxuZXhwb3J0IGNvbnN0IGdlb3NoYXBlOiBNYXJrQ29tcGlsZXIgPSB7XG4gIHZnTWFyazogJ3NoYXBlJyxcbiAgZW5jb2RlRW50cnk6IChtb2RlbDogVW5pdE1vZGVsKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLm1peGlucy5iYXNlRW5jb2RlRW50cnkobW9kZWwsIHtzaXplOiAnaWdub3JlJywgb3JpZW50OiAnaWdub3JlJ30pXG4gICAgfTtcbiAgfSxcbiAgcG9zdEVuY29kaW5nVHJhbnNmb3JtOiAobW9kZWw6IFVuaXRNb2RlbCk6IFZnUG9zdEVuY29kaW5nVHJhbnNmb3JtW10gPT4ge1xuICAgIGNvbnN0IHtlbmNvZGluZ30gPSBtb2RlbDtcbiAgICBjb25zdCBzaGFwZURlZiA9IGVuY29kaW5nLnNoYXBlO1xuXG4gICAgY29uc3QgdHJhbnNmb3JtOiBWZ0dlb1NoYXBlVHJhbnNmb3JtID0ge1xuICAgICAgdHlwZTogJ2dlb3NoYXBlJyxcbiAgICAgIHByb2plY3Rpb246IG1vZGVsLnByb2plY3Rpb25OYW1lKCksXG4gICAgICAvLyBhczogJ3NoYXBlJyxcbiAgICAgIC4uLihzaGFwZURlZiAmJiBpc0ZpZWxkRGVmKHNoYXBlRGVmKSAmJiBzaGFwZURlZi50eXBlID09PSBHRU9KU09OID8ge2ZpZWxkOiB2Z0ZpZWxkKHNoYXBlRGVmLCB7ZXhwcjogJ2RhdHVtJ30pfSA6IHt9KVxuICAgIH07XG4gICAgcmV0dXJuIFt0cmFuc2Zvcm1dO1xuICB9XG59O1xuIl19","import * as tslib_1 from \"tslib\";\nimport * as mixins from './mixins';\nimport * as ref from './valueref';\nexport var line = {\n    vgMark: 'line',\n    encodeEntry: function (model) {\n        var width = model.width, height = model.height;\n        return tslib_1.__assign({}, mixins.baseEncodeEntry(model, { size: 'ignore', orient: 'ignore' }), mixins.pointPosition('x', model, ref.mid(width)), mixins.pointPosition('y', model, ref.mid(height)), mixins.nonPosition('size', model, {\n            vgChannel: 'strokeWidth' // VL's line size is strokeWidth\n        }), mixins.defined(model));\n    }\n};\nexport var trail = {\n    vgMark: 'trail',\n    encodeEntry: function (model) {\n        var width = model.width, height = model.height;\n        return tslib_1.__assign({}, mixins.baseEncodeEntry(model, { size: 'include', orient: 'ignore' }), mixins.pointPosition('x', model, ref.mid(width)), mixins.pointPosition('y', model, ref.mid(height)), mixins.nonPosition('size', model), mixins.defined(model));\n    }\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGluZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21waWxlL21hcmsvbGluZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBRUEsT0FBTyxLQUFLLE1BQU0sTUFBTSxVQUFVLENBQUM7QUFDbkMsT0FBTyxLQUFLLEdBQUcsTUFBTSxZQUFZLENBQUM7QUFFbEMsTUFBTSxDQUFDLElBQU0sSUFBSSxHQUFpQjtJQUNoQyxNQUFNLEVBQUUsTUFBTTtJQUNkLFdBQVcsRUFBRSxVQUFDLEtBQWdCO1FBQ3JCLElBQUEsbUJBQUssRUFBRSxxQkFBTSxDQUFVO1FBRTlCLDRCQUNLLE1BQU0sQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLEVBQUMsSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFDLENBQUMsRUFDakUsTUFBTSxDQUFDLGFBQWEsQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLEdBQUcsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsRUFDaEQsTUFBTSxDQUFDLGFBQWEsQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLEdBQUcsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsRUFDakQsTUFBTSxDQUFDLFdBQVcsQ0FBQyxNQUFNLEVBQUUsS0FBSyxFQUFFO1lBQ25DLFNBQVMsRUFBRSxhQUFhLENBQUUsZ0NBQWdDO1NBQzNELENBQUMsRUFDQyxNQUFNLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUN4QjtJQUNKLENBQUM7Q0FDRixDQUFDO0FBR0YsTUFBTSxDQUFDLElBQU0sS0FBSyxHQUFpQjtJQUNqQyxNQUFNLEVBQUUsT0FBTztJQUNmLFdBQVcsRUFBRSxVQUFDLEtBQWdCO1FBQ3JCLElBQUEsbUJBQUssRUFBRSxxQkFBTSxDQUFVO1FBRTlCLDRCQUNLLE1BQU0sQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLEVBQUMsSUFBSSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFDLENBQUMsRUFDbEUsTUFBTSxDQUFDLGFBQWEsQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLEdBQUcsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsRUFDaEQsTUFBTSxDQUFDLGFBQWEsQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLEdBQUcsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsRUFDakQsTUFBTSxDQUFDLFdBQVcsQ0FBQyxNQUFNLEVBQUUsS0FBSyxDQUFDLEVBQ2pDLE1BQU0sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQ3hCO0lBQ0osQ0FBQztDQUNGLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1VuaXRNb2RlbH0gZnJvbSAnLi4vdW5pdCc7XG5pbXBvcnQge01hcmtDb21waWxlcn0gZnJvbSAnLi9iYXNlJztcbmltcG9ydCAqIGFzIG1peGlucyBmcm9tICcuL21peGlucyc7XG5pbXBvcnQgKiBhcyByZWYgZnJvbSAnLi92YWx1ZXJlZic7XG5cbmV4cG9ydCBjb25zdCBsaW5lOiBNYXJrQ29tcGlsZXIgPSB7XG4gIHZnTWFyazogJ2xpbmUnLFxuICBlbmNvZGVFbnRyeTogKG1vZGVsOiBVbml0TW9kZWwpID0+IHtcbiAgICBjb25zdCB7d2lkdGgsIGhlaWdodH0gPSBtb2RlbDtcblxuICAgIHJldHVybiB7XG4gICAgICAuLi5taXhpbnMuYmFzZUVuY29kZUVudHJ5KG1vZGVsLCB7c2l6ZTogJ2lnbm9yZScsIG9yaWVudDogJ2lnbm9yZSd9KSxcbiAgICAgIC4uLm1peGlucy5wb2ludFBvc2l0aW9uKCd4JywgbW9kZWwsIHJlZi5taWQod2lkdGgpKSxcbiAgICAgIC4uLm1peGlucy5wb2ludFBvc2l0aW9uKCd5JywgbW9kZWwsIHJlZi5taWQoaGVpZ2h0KSksXG4gICAgICAuLi5taXhpbnMubm9uUG9zaXRpb24oJ3NpemUnLCBtb2RlbCwge1xuICAgICAgICB2Z0NoYW5uZWw6ICdzdHJva2VXaWR0aCcgIC8vIFZMJ3MgbGluZSBzaXplIGlzIHN0cm9rZVdpZHRoXG4gICAgICB9KSxcbiAgICAgIC4uLm1peGlucy5kZWZpbmVkKG1vZGVsKVxuICAgIH07XG4gIH1cbn07XG5cblxuZXhwb3J0IGNvbnN0IHRyYWlsOiBNYXJrQ29tcGlsZXIgPSB7XG4gIHZnTWFyazogJ3RyYWlsJyxcbiAgZW5jb2RlRW50cnk6IChtb2RlbDogVW5pdE1vZGVsKSA9PiB7XG4gICAgY29uc3Qge3dpZHRoLCBoZWlnaHR9ID0gbW9kZWw7XG5cbiAgICByZXR1cm4ge1xuICAgICAgLi4ubWl4aW5zLmJhc2VFbmNvZGVFbnRyeShtb2RlbCwge3NpemU6ICdpbmNsdWRlJywgb3JpZW50OiAnaWdub3JlJ30pLFxuICAgICAgLi4ubWl4aW5zLnBvaW50UG9zaXRpb24oJ3gnLCBtb2RlbCwgcmVmLm1pZCh3aWR0aCkpLFxuICAgICAgLi4ubWl4aW5zLnBvaW50UG9zaXRpb24oJ3knLCBtb2RlbCwgcmVmLm1pZChoZWlnaHQpKSxcbiAgICAgIC4uLm1peGlucy5ub25Qb3NpdGlvbignc2l6ZScsIG1vZGVsKSxcbiAgICAgIC4uLm1peGlucy5kZWZpbmVkKG1vZGVsKVxuICAgIH07XG4gIH1cbn07XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { getMarkConfig } from '../common';\nimport * as mixins from './mixins';\nimport * as ref from './valueref';\nfunction encodeEntry(model, fixedShape) {\n    var config = model.config, width = model.width, height = model.height;\n    return tslib_1.__assign({}, mixins.baseEncodeEntry(model, { size: 'include', orient: 'ignore' }), mixins.pointPosition('x', model, ref.mid(width)), mixins.pointPosition('y', model, ref.mid(height)), mixins.nonPosition('size', model), shapeMixins(model, config, fixedShape));\n}\nexport function shapeMixins(model, config, fixedShape) {\n    if (fixedShape) {\n        return { shape: { value: fixedShape } };\n    }\n    return mixins.nonPosition('shape', model, { defaultValue: getMarkConfig('shape', model.markDef, config) });\n}\nexport var point = {\n    vgMark: 'symbol',\n    encodeEntry: function (model) {\n        return encodeEntry(model);\n    }\n};\nexport var circle = {\n    vgMark: 'symbol',\n    encodeEntry: function (model) {\n        return encodeEntry(model, 'circle');\n    }\n};\nexport var square = {\n    vgMark: 'symbol',\n    encodeEntry: function (model) {\n        return encodeEntry(model, 'square');\n    }\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG9pbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcGlsZS9tYXJrL3BvaW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFFQSxPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBR3hDLE9BQU8sS0FBSyxNQUFNLE1BQU0sVUFBVSxDQUFDO0FBQ25DLE9BQU8sS0FBSyxHQUFHLE1BQU0sWUFBWSxDQUFDO0FBR2xDLHFCQUFxQixLQUFnQixFQUFFLFVBQWdDO0lBQzlELElBQUEscUJBQU0sRUFBRSxtQkFBSyxFQUFFLHFCQUFNLENBQVU7SUFFdEMsNEJBQ0ssTUFBTSxDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsRUFBQyxJQUFJLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUMsQ0FBQyxFQUNsRSxNQUFNLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUNoRCxNQUFNLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUNqRCxNQUFNLENBQUMsV0FBVyxDQUFDLE1BQU0sRUFBRSxLQUFLLENBQUMsRUFDakMsV0FBVyxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsVUFBVSxDQUFDLEVBQ3pDO0FBQ0osQ0FBQztBQUVELE1BQU0sc0JBQXNCLEtBQWdCLEVBQUUsTUFBYyxFQUFFLFVBQWdDO0lBQzVGLElBQUksVUFBVSxFQUFFO1FBQ2QsT0FBTyxFQUFDLEtBQUssRUFBRSxFQUFDLEtBQUssRUFBRSxVQUFVLEVBQUMsRUFBQyxDQUFDO0tBQ3JDO0lBQ0QsT0FBTyxNQUFNLENBQUMsV0FBVyxDQUFDLE9BQU8sRUFBRSxLQUFLLEVBQUUsRUFBQyxZQUFZLEVBQUUsYUFBYSxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsT0FBTyxFQUFFLE1BQU0sQ0FBVyxFQUFDLENBQUMsQ0FBQztBQUNySCxDQUFDO0FBRUQsTUFBTSxDQUFDLElBQU0sS0FBSyxHQUFpQjtJQUNqQyxNQUFNLEVBQUUsUUFBUTtJQUNoQixXQUFXLEVBQUUsVUFBQyxLQUFnQjtRQUM1QixPQUFPLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUM1QixDQUFDO0NBQ0YsQ0FBQztBQUVGLE1BQU0sQ0FBQyxJQUFNLE1BQU0sR0FBaUI7SUFDbEMsTUFBTSxFQUFFLFFBQVE7SUFDaEIsV0FBVyxFQUFFLFVBQUMsS0FBZ0I7UUFDNUIsT0FBTyxXQUFXLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQ3RDLENBQUM7Q0FDRixDQUFDO0FBRUYsTUFBTSxDQUFDLElBQU0sTUFBTSxHQUFpQjtJQUNsQyxNQUFNLEVBQUUsUUFBUTtJQUNoQixXQUFXLEVBQUUsVUFBQyxLQUFnQjtRQUM1QixPQUFPLFdBQVcsQ0FBQyxLQUFLLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFDdEMsQ0FBQztDQUNGLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NvbmZpZ30gZnJvbSAnLi4vLi4vY29uZmlnJztcbmltcG9ydCB7VmdFbmNvZGVFbnRyeX0gZnJvbSAnLi4vLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtnZXRNYXJrQ29uZmlnfSBmcm9tICcuLi9jb21tb24nO1xuaW1wb3J0IHtVbml0TW9kZWx9IGZyb20gJy4uL3VuaXQnO1xuaW1wb3J0IHtNYXJrQ29tcGlsZXJ9IGZyb20gJy4vYmFzZSc7XG5pbXBvcnQgKiBhcyBtaXhpbnMgZnJvbSAnLi9taXhpbnMnO1xuaW1wb3J0ICogYXMgcmVmIGZyb20gJy4vdmFsdWVyZWYnO1xuXG5cbmZ1bmN0aW9uIGVuY29kZUVudHJ5KG1vZGVsOiBVbml0TW9kZWwsIGZpeGVkU2hhcGU/OiAnY2lyY2xlJyB8ICdzcXVhcmUnKSB7XG4gIGNvbnN0IHtjb25maWcsIHdpZHRoLCBoZWlnaHR9ID0gbW9kZWw7XG5cbiAgcmV0dXJuIHtcbiAgICAuLi5taXhpbnMuYmFzZUVuY29kZUVudHJ5KG1vZGVsLCB7c2l6ZTogJ2luY2x1ZGUnLCBvcmllbnQ6ICdpZ25vcmUnfSksXG4gICAgLi4ubWl4aW5zLnBvaW50UG9zaXRpb24oJ3gnLCBtb2RlbCwgcmVmLm1pZCh3aWR0aCkpLFxuICAgIC4uLm1peGlucy5wb2ludFBvc2l0aW9uKCd5JywgbW9kZWwsIHJlZi5taWQoaGVpZ2h0KSksXG4gICAgLi4ubWl4aW5zLm5vblBvc2l0aW9uKCdzaXplJywgbW9kZWwpLFxuICAgIC4uLnNoYXBlTWl4aW5zKG1vZGVsLCBjb25maWcsIGZpeGVkU2hhcGUpLFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc2hhcGVNaXhpbnMobW9kZWw6IFVuaXRNb2RlbCwgY29uZmlnOiBDb25maWcsIGZpeGVkU2hhcGU/OiAnY2lyY2xlJyB8ICdzcXVhcmUnKTogVmdFbmNvZGVFbnRyeSB7XG4gIGlmIChmaXhlZFNoYXBlKSB7XG4gICAgcmV0dXJuIHtzaGFwZToge3ZhbHVlOiBmaXhlZFNoYXBlfX07XG4gIH1cbiAgcmV0dXJuIG1peGlucy5ub25Qb3NpdGlvbignc2hhcGUnLCBtb2RlbCwge2RlZmF1bHRWYWx1ZTogZ2V0TWFya0NvbmZpZygnc2hhcGUnLCBtb2RlbC5tYXJrRGVmLCBjb25maWcpIGFzIHN0cmluZ30pO1xufVxuXG5leHBvcnQgY29uc3QgcG9pbnQ6IE1hcmtDb21waWxlciA9IHtcbiAgdmdNYXJrOiAnc3ltYm9sJyxcbiAgZW5jb2RlRW50cnk6IChtb2RlbDogVW5pdE1vZGVsKSA9PiB7XG4gICAgcmV0dXJuIGVuY29kZUVudHJ5KG1vZGVsKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGNpcmNsZTogTWFya0NvbXBpbGVyID0ge1xuICB2Z01hcms6ICdzeW1ib2wnLFxuICBlbmNvZGVFbnRyeTogKG1vZGVsOiBVbml0TW9kZWwpID0+IHtcbiAgICByZXR1cm4gZW5jb2RlRW50cnkobW9kZWwsICdjaXJjbGUnKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IHNxdWFyZTogTWFya0NvbXBpbGVyID0ge1xuICB2Z01hcms6ICdzeW1ib2wnLFxuICBlbmNvZGVFbnRyeTogKG1vZGVsOiBVbml0TW9kZWwpID0+IHtcbiAgICByZXR1cm4gZW5jb2RlRW50cnkobW9kZWwsICdzcXVhcmUnKTtcbiAgfVxufTtcbiJdfQ==","import * as tslib_1 from \"tslib\";\nimport { X, Y } from '../../channel';\nimport { isFieldDef } from '../../fielddef';\nimport * as log from '../../log';\nimport { RECT } from '../../mark';\nimport { hasDiscreteDomain, ScaleType } from '../../scale';\nimport * as mixins from './mixins';\nexport var rect = {\n    vgMark: 'rect',\n    encodeEntry: function (model) {\n        return tslib_1.__assign({}, mixins.baseEncodeEntry(model, { size: 'ignore', orient: 'ignore' }), x(model), y(model));\n    }\n};\nexport function x(model) {\n    var xDef = model.encoding.x;\n    var x2Def = model.encoding.x2;\n    var xScale = model.getScaleComponent(X);\n    var xScaleType = xScale ? xScale.get('type') : undefined;\n    if (isFieldDef(xDef) && xDef.bin && !x2Def) {\n        return mixins.binnedPosition(xDef, 'x', model.scaleName('x'), 0, xScale.get('reverse'));\n    }\n    else if (isFieldDef(xDef) && xScale && hasDiscreteDomain(xScaleType)) {\n        /* istanbul ignore else */\n        if (xScaleType === ScaleType.BAND) {\n            return mixins.bandPosition(xDef, 'x', model);\n        }\n        else {\n            // We don't support rect mark with point/ordinal scale\n            throw new Error(log.message.scaleTypeNotWorkWithMark(RECT, xScaleType));\n        }\n    }\n    else { // continuous scale or no scale\n        return tslib_1.__assign({}, mixins.pointPosition('x', model, 'zeroOrMax'), mixins.pointPosition2(model, 'zeroOrMin', 'x2'));\n    }\n}\nexport function y(model) {\n    var yDef = model.encoding.y;\n    var y2Def = model.encoding.y2;\n    var yScale = model.getScaleComponent(Y);\n    var yScaleType = yScale ? yScale.get('type') : undefined;\n    if (isFieldDef(yDef) && yDef.bin && !y2Def) {\n        return mixins.binnedPosition(yDef, 'y', model.scaleName('y'), 0, yScale.get('reverse'));\n    }\n    else if (isFieldDef(yDef) && yScale && hasDiscreteDomain(yScaleType)) {\n        /* istanbul ignore else */\n        if (yScaleType === ScaleType.BAND) {\n            return mixins.bandPosition(yDef, 'y', model);\n        }\n        else {\n            // We don't support rect mark with point/ordinal scale\n            throw new Error(log.message.scaleTypeNotWorkWithMark(RECT, yScaleType));\n        }\n    }\n    else { // continuous scale or no scale\n        return tslib_1.__assign({}, mixins.pointPosition('y', model, 'zeroOrMax'), mixins.pointPosition2(model, 'zeroOrMin', 'y2'));\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVjdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21waWxlL21hcmsvcmVjdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFDLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDbkMsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQzFDLE9BQU8sS0FBSyxHQUFHLE1BQU0sV0FBVyxDQUFDO0FBQ2pDLE9BQU8sRUFBQyxJQUFJLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFDaEMsT0FBTyxFQUFDLGlCQUFpQixFQUFFLFNBQVMsRUFBQyxNQUFNLGFBQWEsQ0FBQztBQUl6RCxPQUFPLEtBQUssTUFBTSxNQUFNLFVBQVUsQ0FBQztBQUVuQyxNQUFNLENBQUMsSUFBTSxJQUFJLEdBQWlCO0lBQ2hDLE1BQU0sRUFBRSxNQUFNO0lBQ2QsV0FBVyxFQUFFLFVBQUMsS0FBZ0I7UUFDNUIsNEJBQ0ssTUFBTSxDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsRUFBQyxJQUFJLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUMsQ0FBQyxFQUNqRSxDQUFDLENBQUMsS0FBSyxDQUFDLEVBQ1IsQ0FBQyxDQUFDLEtBQUssQ0FBQyxFQUNYO0lBQ0osQ0FBQztDQUNGLENBQUM7QUFFRixNQUFNLFlBQVksS0FBZ0I7SUFDaEMsSUFBTSxJQUFJLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7SUFDOUIsSUFBTSxLQUFLLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUM7SUFDaEMsSUFBTSxNQUFNLEdBQUcsS0FBSyxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzFDLElBQU0sVUFBVSxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO0lBRTNELElBQUksVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLEVBQUU7UUFDMUMsT0FBTyxNQUFNLENBQUMsY0FBYyxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsS0FBSyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO0tBQ3pGO1NBQU0sSUFBSSxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksTUFBTSxJQUFJLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxFQUFFO1FBQ3RFLDBCQUEwQjtRQUMxQixJQUFJLFVBQVUsS0FBSyxTQUFTLENBQUMsSUFBSSxFQUFFO1lBQ2pDLE9BQU8sTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO1NBQzlDO2FBQU07WUFDTCxzREFBc0Q7WUFDdEQsTUFBTSxJQUFJLEtBQUssQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLHdCQUF3QixDQUFDLElBQUksRUFBRSxVQUFVLENBQUMsQ0FBQyxDQUFDO1NBQ3pFO0tBQ0Y7U0FBTSxFQUFFLCtCQUErQjtRQUN0Qyw0QkFDSyxNQUFNLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsV0FBVyxDQUFDLEVBQzdDLE1BQU0sQ0FBQyxjQUFjLENBQUMsS0FBSyxFQUFFLFdBQVcsRUFBRSxJQUFJLENBQUMsRUFDbEQ7S0FDSDtBQUNILENBQUM7QUFFRCxNQUFNLFlBQVksS0FBZ0I7SUFDaEMsSUFBTSxJQUFJLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7SUFDOUIsSUFBTSxLQUFLLEdBQUcsS0FBSyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUM7SUFDaEMsSUFBTSxNQUFNLEdBQUcsS0FBSyxDQUFDLGlCQUFpQixDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzFDLElBQU0sVUFBVSxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO0lBRTNELElBQUksVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLEVBQUU7UUFDMUMsT0FBTyxNQUFNLENBQUMsY0FBYyxDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsS0FBSyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO0tBQ3pGO1NBQU0sSUFBSSxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksTUFBTSxJQUFJLGlCQUFpQixDQUFDLFVBQVUsQ0FBQyxFQUFFO1FBQ3RFLDBCQUEwQjtRQUMxQixJQUFJLFVBQVUsS0FBSyxTQUFTLENBQUMsSUFBSSxFQUFFO1lBQ2pDLE9BQU8sTUFBTSxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFFLEtBQUssQ0FBQyxDQUFDO1NBQzlDO2FBQU07WUFDTCxzREFBc0Q7WUFDdEQsTUFBTSxJQUFJLEtBQUssQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLHdCQUF3QixDQUFDLElBQUksRUFBRSxVQUFVLENBQUMsQ0FBQyxDQUFDO1NBQ3pFO0tBQ0Y7U0FBTSxFQUFFLCtCQUErQjtRQUN0Qyw0QkFDSyxNQUFNLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsV0FBVyxDQUFDLEVBQzdDLE1BQU0sQ0FBQyxjQUFjLENBQUMsS0FBSyxFQUFFLFdBQVcsRUFBRSxJQUFJLENBQUMsRUFDbEQ7S0FDSDtBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1gsIFl9IGZyb20gJy4uLy4uL2NoYW5uZWwnO1xuaW1wb3J0IHtpc0ZpZWxkRGVmfSBmcm9tICcuLi8uLi9maWVsZGRlZic7XG5pbXBvcnQgKiBhcyBsb2cgZnJvbSAnLi4vLi4vbG9nJztcbmltcG9ydCB7UkVDVH0gZnJvbSAnLi4vLi4vbWFyayc7XG5pbXBvcnQge2hhc0Rpc2NyZXRlRG9tYWluLCBTY2FsZVR5cGV9IGZyb20gJy4uLy4uL3NjYWxlJztcbmltcG9ydCB7VmdFbmNvZGVFbnRyeX0gZnJvbSAnLi4vLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtVbml0TW9kZWx9IGZyb20gJy4uL3VuaXQnO1xuaW1wb3J0IHtNYXJrQ29tcGlsZXJ9IGZyb20gJy4vYmFzZSc7XG5pbXBvcnQgKiBhcyBtaXhpbnMgZnJvbSAnLi9taXhpbnMnO1xuXG5leHBvcnQgY29uc3QgcmVjdDogTWFya0NvbXBpbGVyID0ge1xuICB2Z01hcms6ICdyZWN0JyxcbiAgZW5jb2RlRW50cnk6IChtb2RlbDogVW5pdE1vZGVsKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLm1peGlucy5iYXNlRW5jb2RlRW50cnkobW9kZWwsIHtzaXplOiAnaWdub3JlJywgb3JpZW50OiAnaWdub3JlJ30pLFxuICAgICAgLi4ueChtb2RlbCksXG4gICAgICAuLi55KG1vZGVsKSxcbiAgICB9O1xuICB9XG59O1xuXG5leHBvcnQgZnVuY3Rpb24geChtb2RlbDogVW5pdE1vZGVsKTogVmdFbmNvZGVFbnRyeSB7XG4gIGNvbnN0IHhEZWYgPSBtb2RlbC5lbmNvZGluZy54O1xuICBjb25zdCB4MkRlZiA9IG1vZGVsLmVuY29kaW5nLngyO1xuICBjb25zdCB4U2NhbGUgPSBtb2RlbC5nZXRTY2FsZUNvbXBvbmVudChYKTtcbiAgY29uc3QgeFNjYWxlVHlwZSA9IHhTY2FsZSA/IHhTY2FsZS5nZXQoJ3R5cGUnKSA6IHVuZGVmaW5lZDtcblxuICBpZiAoaXNGaWVsZERlZih4RGVmKSAmJiB4RGVmLmJpbiAmJiAheDJEZWYpIHtcbiAgICByZXR1cm4gbWl4aW5zLmJpbm5lZFBvc2l0aW9uKHhEZWYsICd4JywgbW9kZWwuc2NhbGVOYW1lKCd4JyksIDAsIHhTY2FsZS5nZXQoJ3JldmVyc2UnKSk7XG4gIH0gZWxzZSBpZiAoaXNGaWVsZERlZih4RGVmKSAmJiB4U2NhbGUgJiYgaGFzRGlzY3JldGVEb21haW4oeFNjYWxlVHlwZSkpIHtcbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICAgIGlmICh4U2NhbGVUeXBlID09PSBTY2FsZVR5cGUuQkFORCkge1xuICAgICAgcmV0dXJuIG1peGlucy5iYW5kUG9zaXRpb24oeERlZiwgJ3gnLCBtb2RlbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFdlIGRvbid0IHN1cHBvcnQgcmVjdCBtYXJrIHdpdGggcG9pbnQvb3JkaW5hbCBzY2FsZVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGxvZy5tZXNzYWdlLnNjYWxlVHlwZU5vdFdvcmtXaXRoTWFyayhSRUNULCB4U2NhbGVUeXBlKSk7XG4gICAgfVxuICB9IGVsc2UgeyAvLyBjb250aW51b3VzIHNjYWxlIG9yIG5vIHNjYWxlXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLm1peGlucy5wb2ludFBvc2l0aW9uKCd4JywgbW9kZWwsICd6ZXJvT3JNYXgnKSxcbiAgICAgIC4uLm1peGlucy5wb2ludFBvc2l0aW9uMihtb2RlbCwgJ3plcm9Pck1pbicsICd4MicpXG4gICAgfTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24geShtb2RlbDogVW5pdE1vZGVsKTogVmdFbmNvZGVFbnRyeSB7XG4gIGNvbnN0IHlEZWYgPSBtb2RlbC5lbmNvZGluZy55O1xuICBjb25zdCB5MkRlZiA9IG1vZGVsLmVuY29kaW5nLnkyO1xuICBjb25zdCB5U2NhbGUgPSBtb2RlbC5nZXRTY2FsZUNvbXBvbmVudChZKTtcbiAgY29uc3QgeVNjYWxlVHlwZSA9IHlTY2FsZSA/IHlTY2FsZS5nZXQoJ3R5cGUnKSA6IHVuZGVmaW5lZDtcblxuICBpZiAoaXNGaWVsZERlZih5RGVmKSAmJiB5RGVmLmJpbiAmJiAheTJEZWYpIHtcbiAgICByZXR1cm4gbWl4aW5zLmJpbm5lZFBvc2l0aW9uKHlEZWYsICd5JywgbW9kZWwuc2NhbGVOYW1lKCd5JyksIDAsIHlTY2FsZS5nZXQoJ3JldmVyc2UnKSk7XG4gIH0gZWxzZSBpZiAoaXNGaWVsZERlZih5RGVmKSAmJiB5U2NhbGUgJiYgaGFzRGlzY3JldGVEb21haW4oeVNjYWxlVHlwZSkpIHtcbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICAgIGlmICh5U2NhbGVUeXBlID09PSBTY2FsZVR5cGUuQkFORCkge1xuICAgICAgcmV0dXJuIG1peGlucy5iYW5kUG9zaXRpb24oeURlZiwgJ3knLCBtb2RlbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFdlIGRvbid0IHN1cHBvcnQgcmVjdCBtYXJrIHdpdGggcG9pbnQvb3JkaW5hbCBzY2FsZVxuICAgICAgdGhyb3cgbmV3IEVycm9yKGxvZy5tZXNzYWdlLnNjYWxlVHlwZU5vdFdvcmtXaXRoTWFyayhSRUNULCB5U2NhbGVUeXBlKSk7XG4gICAgfVxuICB9IGVsc2UgeyAvLyBjb250aW51b3VzIHNjYWxlIG9yIG5vIHNjYWxlXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLm1peGlucy5wb2ludFBvc2l0aW9uKCd5JywgbW9kZWwsICd6ZXJvT3JNYXgnKSxcbiAgICAgIC4uLm1peGlucy5wb2ludFBvc2l0aW9uMihtb2RlbCwgJ3plcm9Pck1pbicsICd5MicpXG4gICAgfTtcbiAgfVxufVxuIl19","import * as tslib_1 from \"tslib\";\nimport * as mixins from './mixins';\nimport * as ref from './valueref';\nexport var rule = {\n    vgMark: 'rule',\n    encodeEntry: function (model) {\n        var _config = model.config, markDef = model.markDef, width = model.width, height = model.height;\n        var orient = markDef.orient;\n        if (!model.encoding.x && !model.encoding.y && !model.encoding.latitude && !model.encoding.longitude) {\n            // Show nothing if we have none of x, y, lat, and long.\n            return {};\n        }\n        return tslib_1.__assign({}, mixins.baseEncodeEntry(model, { size: 'ignore', orient: 'ignore' }), mixins.pointPosition('x', model, orient === 'horizontal' ? 'zeroOrMin' : ref.mid(width)), mixins.pointPosition('y', model, orient === 'vertical' ? 'zeroOrMin' : ref.mid(height)), (orient !== 'vertical' ? mixins.pointPosition2(model, 'zeroOrMax', 'x2') : {}), (orient !== 'horizontal' ? mixins.pointPosition2(model, 'zeroOrMax', 'y2') : {}), mixins.nonPosition('size', model, {\n            vgChannel: 'strokeWidth',\n            defaultValue: markDef.size\n        }));\n    }\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicnVsZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21waWxlL21hcmsvcnVsZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBRUEsT0FBTyxLQUFLLE1BQU0sTUFBTSxVQUFVLENBQUM7QUFDbkMsT0FBTyxLQUFLLEdBQUcsTUFBTSxZQUFZLENBQUM7QUFFbEMsTUFBTSxDQUFDLElBQU0sSUFBSSxHQUFpQjtJQUNoQyxNQUFNLEVBQUUsTUFBTTtJQUNkLFdBQVcsRUFBRSxVQUFDLEtBQWdCO1FBQ3JCLElBQUEsc0JBQWUsRUFBRSx1QkFBTyxFQUFFLG1CQUFLLEVBQUUscUJBQU0sQ0FBVTtRQUN4RCxJQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDO1FBRTlCLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxRQUFRLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLFNBQVMsRUFBRTtZQUNuRyx1REFBdUQ7WUFDdkQsT0FBTyxFQUFFLENBQUM7U0FDWDtRQUVELDRCQUNLLE1BQU0sQ0FBQyxlQUFlLENBQUMsS0FBSyxFQUFFLEVBQUMsSUFBSSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFDLENBQUMsRUFDakUsTUFBTSxDQUFDLGFBQWEsQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLE1BQU0sS0FBSyxZQUFZLENBQUMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUN4RixNQUFNLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsTUFBTSxLQUFLLFVBQVUsQ0FBQyxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBR3ZGLENBQUMsTUFBTSxLQUFLLFVBQVUsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxLQUFLLEVBQUUsV0FBVyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFHOUUsQ0FBQyxNQUFNLEtBQUssWUFBWSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLEtBQUssRUFBRSxXQUFXLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUVoRixNQUFNLENBQUMsV0FBVyxDQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUU7WUFDbkMsU0FBUyxFQUFFLGFBQWE7WUFDeEIsWUFBWSxFQUFFLE9BQU8sQ0FBQyxJQUFJO1NBQzNCLENBQUMsRUFDRjtJQUNKLENBQUM7Q0FDRixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtVbml0TW9kZWx9IGZyb20gJy4uL3VuaXQnO1xuaW1wb3J0IHtNYXJrQ29tcGlsZXJ9IGZyb20gJy4vYmFzZSc7XG5pbXBvcnQgKiBhcyBtaXhpbnMgZnJvbSAnLi9taXhpbnMnO1xuaW1wb3J0ICogYXMgcmVmIGZyb20gJy4vdmFsdWVyZWYnO1xuXG5leHBvcnQgY29uc3QgcnVsZTogTWFya0NvbXBpbGVyID0ge1xuICB2Z01hcms6ICdydWxlJyxcbiAgZW5jb2RlRW50cnk6IChtb2RlbDogVW5pdE1vZGVsKSA9PiB7XG4gICAgY29uc3Qge2NvbmZpZzogX2NvbmZpZywgbWFya0RlZiwgd2lkdGgsIGhlaWdodH0gPSBtb2RlbDtcbiAgICBjb25zdCBvcmllbnQgPSBtYXJrRGVmLm9yaWVudDtcblxuICAgIGlmICghbW9kZWwuZW5jb2RpbmcueCAmJiAhbW9kZWwuZW5jb2RpbmcueSAmJiAhbW9kZWwuZW5jb2RpbmcubGF0aXR1ZGUgJiYgIW1vZGVsLmVuY29kaW5nLmxvbmdpdHVkZSkge1xuICAgICAgLy8gU2hvdyBub3RoaW5nIGlmIHdlIGhhdmUgbm9uZSBvZiB4LCB5LCBsYXQsIGFuZCBsb25nLlxuICAgICAgcmV0dXJuIHt9O1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAuLi5taXhpbnMuYmFzZUVuY29kZUVudHJ5KG1vZGVsLCB7c2l6ZTogJ2lnbm9yZScsIG9yaWVudDogJ2lnbm9yZSd9KSxcbiAgICAgIC4uLm1peGlucy5wb2ludFBvc2l0aW9uKCd4JywgbW9kZWwsIG9yaWVudCA9PT0gJ2hvcml6b250YWwnID8gJ3plcm9Pck1pbicgOiByZWYubWlkKHdpZHRoKSksXG4gICAgICAuLi5taXhpbnMucG9pbnRQb3NpdGlvbigneScsIG1vZGVsLCBvcmllbnQgPT09ICd2ZXJ0aWNhbCcgPyAnemVyb09yTWluJyA6IHJlZi5taWQoaGVpZ2h0KSksXG5cbiAgICAgIC8vIGluY2x1ZGUgeDIgZm9yIGhvcml6b250YWwgb3IgbGluZSBzZWdtZW50IHJ1bGVcbiAgICAgIC4uLihvcmllbnQgIT09ICd2ZXJ0aWNhbCcgPyBtaXhpbnMucG9pbnRQb3NpdGlvbjIobW9kZWwsICd6ZXJvT3JNYXgnLCAneDInKSA6IHt9KSxcblxuICAgICAgLy8gaW5jbHVkZSB5MiBmb3IgdmVydGljYWwgb3IgbGluZSBzZWdtZW50IHJ1bGVcbiAgICAgIC4uLihvcmllbnQgIT09ICdob3Jpem9udGFsJyA/IG1peGlucy5wb2ludFBvc2l0aW9uMihtb2RlbCwgJ3plcm9Pck1heCcsICd5MicpIDoge30pLFxuXG4gICAgICAuLi5taXhpbnMubm9uUG9zaXRpb24oJ3NpemUnLCBtb2RlbCwge1xuICAgICAgICB2Z0NoYW5uZWw6ICdzdHJva2VXaWR0aCcsICAvLyBWTCdzIHJ1bGUgc2l6ZSBpcyBzdHJva2VXaWR0aFxuICAgICAgICBkZWZhdWx0VmFsdWU6IG1hcmtEZWYuc2l6ZVxuICAgICAgfSlcbiAgICB9O1xuICB9XG59O1xuIl19","import * as tslib_1 from \"tslib\";\nimport { getMarkConfig } from '../common';\nimport * as mixins from './mixins';\nimport * as ref from './valueref';\nexport var text = {\n    vgMark: 'text',\n    encodeEntry: function (model) {\n        var config = model.config, encoding = model.encoding, width = model.width, height = model.height, markDef = model.markDef;\n        return tslib_1.__assign({}, mixins.baseEncodeEntry(model, { size: 'ignore', orient: 'ignore' }), mixins.pointPosition('x', model, ref.mid(width)), mixins.pointPosition('y', model, ref.mid(height)), mixins.text(model), mixins.nonPosition('size', model, tslib_1.__assign({}, (markDef.size ? { defaultValue: markDef.size } : {}), { vgChannel: 'fontSize' // VL's text size is fontSize\n         })), mixins.valueIfDefined('align', align(model.markDef, encoding, config)));\n    }\n};\nfunction align(markDef, encoding, config) {\n    var a = markDef.align || getMarkConfig('align', markDef, config);\n    if (a === undefined) {\n        return 'center';\n    }\n    // If there is a config, Vega-parser will process this already.\n    return undefined;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGV4dC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21waWxlL21hcmsvdGV4dC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBR0EsT0FBTyxFQUFDLGFBQWEsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUd4QyxPQUFPLEtBQUssTUFBTSxNQUFNLFVBQVUsQ0FBQztBQUNuQyxPQUFPLEtBQUssR0FBRyxNQUFNLFlBQVksQ0FBQztBQUdsQyxNQUFNLENBQUMsSUFBTSxJQUFJLEdBQWlCO0lBQ2hDLE1BQU0sRUFBRSxNQUFNO0lBRWQsV0FBVyxFQUFFLFVBQUMsS0FBZ0I7UUFDckIsSUFBQSxxQkFBTSxFQUFFLHlCQUFRLEVBQUUsbUJBQUssRUFBRSxxQkFBTSxFQUFFLHVCQUFPLENBQVU7UUFFekQsNEJBQ0ssTUFBTSxDQUFDLGVBQWUsQ0FBQyxLQUFLLEVBQUUsRUFBQyxJQUFJLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUMsQ0FBQyxFQUNqRSxNQUFNLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxFQUNoRCxNQUFNLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUNqRCxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxFQUNsQixNQUFNLENBQUMsV0FBVyxDQUFDLE1BQU0sRUFBRSxLQUFLLHVCQUM5QixDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUMsWUFBWSxFQUFFLE9BQU8sQ0FBQyxJQUFJLEVBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLElBQ3JELFNBQVMsRUFBRSxVQUFVLENBQUUsNkJBQTZCO1lBQ3BELEVBQ0MsTUFBTSxDQUFDLGNBQWMsQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLEtBQUssQ0FBQyxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sQ0FBQyxDQUFDLEVBQ3pFO0lBQ0osQ0FBQztDQUNGLENBQUM7QUFDRixlQUFlLE9BQWdCLEVBQUUsUUFBMEIsRUFBRSxNQUFjO0lBQ3pFLElBQU0sQ0FBQyxHQUFHLE9BQU8sQ0FBQyxLQUFLLElBQUksYUFBYSxDQUFDLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDbkUsSUFBSSxDQUFDLEtBQUssU0FBUyxFQUFFO1FBQ25CLE9BQU8sUUFBUSxDQUFDO0tBQ2pCO0lBQ0QsK0RBQStEO0lBQy9ELE9BQU8sU0FBUyxDQUFDO0FBQ25CLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NvbmZpZ30gZnJvbSAnLi4vLi4vY29uZmlnJztcbmltcG9ydCB7RW5jb2Rpbmd9IGZyb20gJy4uLy4uL2VuY29kaW5nJztcbmltcG9ydCB7TWFya0RlZn0gZnJvbSAnLi4vLi4vbWFyayc7XG5pbXBvcnQge2dldE1hcmtDb25maWd9IGZyb20gJy4uL2NvbW1vbic7XG5pbXBvcnQge1VuaXRNb2RlbH0gZnJvbSAnLi4vdW5pdCc7XG5pbXBvcnQge01hcmtDb21waWxlcn0gZnJvbSAnLi9iYXNlJztcbmltcG9ydCAqIGFzIG1peGlucyBmcm9tICcuL21peGlucyc7XG5pbXBvcnQgKiBhcyByZWYgZnJvbSAnLi92YWx1ZXJlZic7XG5cblxuZXhwb3J0IGNvbnN0IHRleHQ6IE1hcmtDb21waWxlciA9IHtcbiAgdmdNYXJrOiAndGV4dCcsXG5cbiAgZW5jb2RlRW50cnk6IChtb2RlbDogVW5pdE1vZGVsKSA9PiB7XG4gICAgY29uc3Qge2NvbmZpZywgZW5jb2RpbmcsIHdpZHRoLCBoZWlnaHQsIG1hcmtEZWZ9ID0gbW9kZWw7XG5cbiAgICByZXR1cm4ge1xuICAgICAgLi4ubWl4aW5zLmJhc2VFbmNvZGVFbnRyeShtb2RlbCwge3NpemU6ICdpZ25vcmUnLCBvcmllbnQ6ICdpZ25vcmUnfSksXG4gICAgICAuLi5taXhpbnMucG9pbnRQb3NpdGlvbigneCcsIG1vZGVsLCByZWYubWlkKHdpZHRoKSksXG4gICAgICAuLi5taXhpbnMucG9pbnRQb3NpdGlvbigneScsIG1vZGVsLCByZWYubWlkKGhlaWdodCkpLFxuICAgICAgLi4ubWl4aW5zLnRleHQobW9kZWwpLFxuICAgICAgLi4ubWl4aW5zLm5vblBvc2l0aW9uKCdzaXplJywgbW9kZWwsIHtcbiAgICAgICAgLi4uKG1hcmtEZWYuc2l6ZSA/IHtkZWZhdWx0VmFsdWU6IG1hcmtEZWYuc2l6ZX0gOiB7fSksXG4gICAgICAgIHZnQ2hhbm5lbDogJ2ZvbnRTaXplJyAgLy8gVkwncyB0ZXh0IHNpemUgaXMgZm9udFNpemVcbiAgICAgIH0pLFxuICAgICAgLi4ubWl4aW5zLnZhbHVlSWZEZWZpbmVkKCdhbGlnbicsIGFsaWduKG1vZGVsLm1hcmtEZWYsIGVuY29kaW5nLCBjb25maWcpKVxuICAgIH07XG4gIH1cbn07XG5mdW5jdGlvbiBhbGlnbihtYXJrRGVmOiBNYXJrRGVmLCBlbmNvZGluZzogRW5jb2Rpbmc8c3RyaW5nPiwgY29uZmlnOiBDb25maWcpIHtcbiAgY29uc3QgYSA9IG1hcmtEZWYuYWxpZ24gfHwgZ2V0TWFya0NvbmZpZygnYWxpZ24nLCBtYXJrRGVmLCBjb25maWcpO1xuICBpZiAoYSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgcmV0dXJuICdjZW50ZXInO1xuICB9XG4gIC8vIElmIHRoZXJlIGlzIGEgY29uZmlnLCBWZWdhLXBhcnNlciB3aWxsIHByb2Nlc3MgdGhpcyBhbHJlYWR5LlxuICByZXR1cm4gdW5kZWZpbmVkO1xufVxuIl19","import * as tslib_1 from \"tslib\";\nimport { isVgRangeStep } from '../../vega.schema';\nimport * as mixins from './mixins';\nimport * as ref from './valueref';\nexport var tick = {\n    vgMark: 'rect',\n    encodeEntry: function (model) {\n        var _a;\n        var config = model.config, markDef = model.markDef, width = model.width, height = model.height;\n        var orient = markDef.orient;\n        var vgSizeChannel = orient === 'horizontal' ? 'width' : 'height';\n        var vgThicknessChannel = orient === 'horizontal' ? 'height' : 'width';\n        return tslib_1.__assign({}, mixins.baseEncodeEntry(model, { size: 'ignore', orient: 'ignore' }), mixins.pointPosition('x', model, ref.mid(width), 'xc'), mixins.pointPosition('y', model, ref.mid(height), 'yc'), mixins.nonPosition('size', model, {\n            defaultValue: defaultSize(model),\n            vgChannel: vgSizeChannel\n        }), (_a = {}, _a[vgThicknessChannel] = { value: markDef.thickness || config.tick.thickness }, _a));\n    }\n};\nfunction defaultSize(model) {\n    var config = model.config, markDef = model.markDef;\n    var orient = markDef.orient;\n    var scale = model.getScaleComponent(orient === 'horizontal' ? 'x' : 'y');\n    if (markDef.size !== undefined) {\n        return markDef.size;\n    }\n    else if (config.tick.bandSize !== undefined) {\n        return config.tick.bandSize;\n    }\n    else {\n        var scaleRange = scale ? scale.get('range') : undefined;\n        var rangeStep = scaleRange && isVgRangeStep(scaleRange) ?\n            scaleRange.step :\n            config.scale.rangeStep;\n        if (typeof rangeStep !== 'number') {\n            // FIXME consolidate this log\n            throw new Error('Function does not handle non-numeric rangeStep');\n        }\n        return rangeStep / 1.5;\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGljay5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21waWxlL21hcmsvdGljay50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFDLGFBQWEsRUFBQyxNQUFNLG1CQUFtQixDQUFDO0FBR2hELE9BQU8sS0FBSyxNQUFNLE1BQU0sVUFBVSxDQUFDO0FBQ25DLE9BQU8sS0FBSyxHQUFHLE1BQU0sWUFBWSxDQUFDO0FBR2xDLE1BQU0sQ0FBQyxJQUFNLElBQUksR0FBaUI7SUFDaEMsTUFBTSxFQUFFLE1BQU07SUFFZCxXQUFXLEVBQUUsVUFBQyxLQUFnQjs7UUFDckIsSUFBQSxxQkFBTSxFQUFFLHVCQUFPLEVBQUUsbUJBQUssRUFBRSxxQkFBTSxDQUFVO1FBQy9DLElBQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUM7UUFFOUIsSUFBTSxhQUFhLEdBQUcsTUFBTSxLQUFLLFlBQVksQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUM7UUFDbkUsSUFBTSxrQkFBa0IsR0FBRyxNQUFNLEtBQUssWUFBWSxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQztRQUV4RSw0QkFDSyxNQUFNLENBQUMsZUFBZSxDQUFDLEtBQUssRUFBRSxFQUFDLElBQUksRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBQyxDQUFDLEVBRWpFLE1BQU0sQ0FBQyxhQUFhLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxHQUFHLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFFLElBQUksQ0FBQyxFQUN0RCxNQUFNLENBQUMsYUFBYSxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUUsR0FBRyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxJQUFJLENBQUMsRUFHdkQsTUFBTSxDQUFDLFdBQVcsQ0FBQyxNQUFNLEVBQUUsS0FBSyxFQUFFO1lBQ25DLFlBQVksRUFBRSxXQUFXLENBQUMsS0FBSyxDQUFDO1lBQ2hDLFNBQVMsRUFBRSxhQUFhO1NBQ3pCLENBQUMsZUFDRCxrQkFBa0IsSUFBRyxFQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsU0FBUyxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFDLE9BQ3pFO0lBQ0osQ0FBQztDQUNGLENBQUM7QUFFRixxQkFBcUIsS0FBZ0I7SUFDNUIsSUFBQSxxQkFBTSxFQUFFLHVCQUFPLENBQVU7SUFDaEMsSUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQztJQUM5QixJQUFNLEtBQUssR0FBRyxLQUFLLENBQUMsaUJBQWlCLENBQUMsTUFBTSxLQUFLLFlBQVksQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUUzRSxJQUFJLE9BQU8sQ0FBQyxJQUFJLEtBQUssU0FBUyxFQUFFO1FBQzlCLE9BQU8sT0FBTyxDQUFDLElBQUksQ0FBQztLQUNyQjtTQUFNLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLEtBQUssU0FBUyxFQUFFO1FBQzdDLE9BQU8sTUFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUM7S0FDN0I7U0FBTTtRQUNMLElBQU0sVUFBVSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDO1FBQzFELElBQU0sU0FBUyxHQUFHLFVBQVUsSUFBSSxhQUFhLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztZQUN6RCxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7WUFDakIsTUFBTSxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUM7UUFDekIsSUFBSSxPQUFPLFNBQVMsS0FBSyxRQUFRLEVBQUU7WUFDakMsNkJBQTZCO1lBQzdCLE1BQU0sSUFBSSxLQUFLLENBQUMsZ0RBQWdELENBQUMsQ0FBQztTQUNuRTtRQUNELE9BQU8sU0FBUyxHQUFHLEdBQUcsQ0FBQztLQUN4QjtBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2lzVmdSYW5nZVN0ZXB9IGZyb20gJy4uLy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7VW5pdE1vZGVsfSBmcm9tICcuLi91bml0JztcbmltcG9ydCB7TWFya0NvbXBpbGVyfSBmcm9tICcuL2Jhc2UnO1xuaW1wb3J0ICogYXMgbWl4aW5zIGZyb20gJy4vbWl4aW5zJztcbmltcG9ydCAqIGFzIHJlZiBmcm9tICcuL3ZhbHVlcmVmJztcblxuXG5leHBvcnQgY29uc3QgdGljazogTWFya0NvbXBpbGVyID0ge1xuICB2Z01hcms6ICdyZWN0JyxcblxuICBlbmNvZGVFbnRyeTogKG1vZGVsOiBVbml0TW9kZWwpID0+IHtcbiAgICBjb25zdCB7Y29uZmlnLCBtYXJrRGVmLCB3aWR0aCwgaGVpZ2h0fSA9IG1vZGVsO1xuICAgIGNvbnN0IG9yaWVudCA9IG1hcmtEZWYub3JpZW50O1xuXG4gICAgY29uc3QgdmdTaXplQ2hhbm5lbCA9IG9yaWVudCA9PT0gJ2hvcml6b250YWwnID8gJ3dpZHRoJyA6ICdoZWlnaHQnO1xuICAgIGNvbnN0IHZnVGhpY2tuZXNzQ2hhbm5lbCA9IG9yaWVudCA9PT0gJ2hvcml6b250YWwnID8gJ2hlaWdodCcgOiAnd2lkdGgnO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLm1peGlucy5iYXNlRW5jb2RlRW50cnkobW9kZWwsIHtzaXplOiAnaWdub3JlJywgb3JpZW50OiAnaWdub3JlJ30pLFxuXG4gICAgICAuLi5taXhpbnMucG9pbnRQb3NpdGlvbigneCcsIG1vZGVsLCByZWYubWlkKHdpZHRoKSwgJ3hjJyksXG4gICAgICAuLi5taXhpbnMucG9pbnRQb3NpdGlvbigneScsIG1vZGVsLCByZWYubWlkKGhlaWdodCksICd5YycpLFxuXG4gICAgICAvLyBzaXplIC8gdGhpY2tuZXNzID0+IHdpZHRoIC8gaGVpZ2h0XG4gICAgICAuLi5taXhpbnMubm9uUG9zaXRpb24oJ3NpemUnLCBtb2RlbCwge1xuICAgICAgICBkZWZhdWx0VmFsdWU6IGRlZmF1bHRTaXplKG1vZGVsKSxcbiAgICAgICAgdmdDaGFubmVsOiB2Z1NpemVDaGFubmVsXG4gICAgICB9KSxcbiAgICAgIFt2Z1RoaWNrbmVzc0NoYW5uZWxdOiB7dmFsdWU6IG1hcmtEZWYudGhpY2tuZXNzIHx8IGNvbmZpZy50aWNrLnRoaWNrbmVzc30sXG4gICAgfTtcbiAgfVxufTtcblxuZnVuY3Rpb24gZGVmYXVsdFNpemUobW9kZWw6IFVuaXRNb2RlbCk6IG51bWJlciB7XG4gIGNvbnN0IHtjb25maWcsIG1hcmtEZWZ9ID0gbW9kZWw7XG4gIGNvbnN0IG9yaWVudCA9IG1hcmtEZWYub3JpZW50O1xuICBjb25zdCBzY2FsZSA9IG1vZGVsLmdldFNjYWxlQ29tcG9uZW50KG9yaWVudCA9PT0gJ2hvcml6b250YWwnID8gJ3gnIDogJ3knKTtcblxuICBpZiAobWFya0RlZi5zaXplICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gbWFya0RlZi5zaXplO1xuICB9IGVsc2UgaWYgKGNvbmZpZy50aWNrLmJhbmRTaXplICE9PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gY29uZmlnLnRpY2suYmFuZFNpemU7XG4gIH0gZWxzZSB7XG4gICAgY29uc3Qgc2NhbGVSYW5nZSA9IHNjYWxlID8gc2NhbGUuZ2V0KCdyYW5nZScpIDogdW5kZWZpbmVkO1xuICAgIGNvbnN0IHJhbmdlU3RlcCA9IHNjYWxlUmFuZ2UgJiYgaXNWZ1JhbmdlU3RlcChzY2FsZVJhbmdlKSA/XG4gICAgICBzY2FsZVJhbmdlLnN0ZXAgOlxuICAgICAgY29uZmlnLnNjYWxlLnJhbmdlU3RlcDtcbiAgICBpZiAodHlwZW9mIHJhbmdlU3RlcCAhPT0gJ251bWJlcicpIHtcbiAgICAgIC8vIEZJWE1FIGNvbnNvbGlkYXRlIHRoaXMgbG9nXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Z1bmN0aW9uIGRvZXMgbm90IGhhbmRsZSBub24tbnVtZXJpYyByYW5nZVN0ZXAnKTtcbiAgICB9XG4gICAgcmV0dXJuIHJhbmdlU3RlcCAvIDEuNTtcbiAgfVxufVxuIl19","import * as tslib_1 from \"tslib\";\nimport { isArray } from 'vega-util';\nimport { MAIN } from '../../data';\nimport { isAggregate } from '../../encoding';\nimport { getFieldDef, isFieldDef, isValueDef, vgField } from '../../fielddef';\nimport { AREA, isPathMark, LINE, TRAIL } from '../../mark';\nimport { isSortField } from '../../sort';\nimport { contains, keys } from '../../util';\nimport { getStyles, sortParams } from '../common';\nimport { area } from './area';\nimport { bar } from './bar';\nimport { geoshape } from './geoshape';\nimport { line, trail } from './line';\nimport { circle, point, square } from './point';\nimport { rect } from './rect';\nimport { rule } from './rule';\nimport { text } from './text';\nimport { tick } from './tick';\nvar markCompiler = {\n    area: area,\n    bar: bar,\n    circle: circle,\n    geoshape: geoshape,\n    line: line,\n    point: point,\n    rect: rect,\n    rule: rule,\n    square: square,\n    text: text,\n    tick: tick,\n    trail: trail\n};\nexport function parseMarkGroup(model) {\n    if (contains([LINE, AREA, TRAIL], model.mark)) {\n        return parsePathMark(model);\n    }\n    else {\n        return getMarkGroups(model);\n    }\n}\nvar FACETED_PATH_PREFIX = 'faceted_path_';\nfunction parsePathMark(model) {\n    var details = pathGroupingFields(model.mark, model.encoding);\n    var pathMarks = getMarkGroups(model, {\n        // If has subfacet for line/area group, need to use faceted data from below.\n        fromPrefix: (details.length > 0 ? FACETED_PATH_PREFIX : '')\n    });\n    if (details.length > 0) { // have level of details - need to facet line into subgroups\n        // TODO: for non-stacked plot, map order to zindex. (Maybe rename order for layer to zindex?)\n        return [{\n                name: model.getName('pathgroup'),\n                type: 'group',\n                from: {\n                    facet: {\n                        name: FACETED_PATH_PREFIX + model.requestDataName(MAIN),\n                        data: model.requestDataName(MAIN),\n                        groupby: details,\n                    }\n                },\n                encode: {\n                    update: {\n                        width: { field: { group: 'width' } },\n                        height: { field: { group: 'height' } }\n                    }\n                },\n                marks: pathMarks\n            }];\n    }\n    else {\n        return pathMarks;\n    }\n}\nexport function getSort(model) {\n    var encoding = model.encoding, stack = model.stack, mark = model.mark, markDef = model.markDef;\n    var order = encoding.order;\n    if (!isArray(order) && isValueDef(order)) {\n        return undefined;\n    }\n    else if ((isArray(order) || isFieldDef(order)) && !stack) {\n        // Sort by the order field if it is specified and the field is not stacked. (For stacked field, order specify stack order.)\n        return sortParams(order, { expr: 'datum' });\n    }\n    else if (isPathMark(mark)) {\n        // For both line and area, we sort values based on dimension by default\n        var dimensionChannelDef = encoding[markDef.orient === 'horizontal' ? 'y' : 'x'];\n        if (isFieldDef(dimensionChannelDef)) {\n            var s = dimensionChannelDef.sort;\n            var sortField = isSortField(s) ?\n                vgField({\n                    // FIXME: this op might not already exist?\n                    // FIXME: what if dimensionChannel (x or y) contains custom domain?\n                    aggregate: isAggregate(model.encoding) ? s.op : undefined,\n                    field: s.field\n                }, { expr: 'datum' }) :\n                vgField(dimensionChannelDef, {\n                    // For stack with imputation, we only have bin_mid\n                    binSuffix: model.stack && model.stack.impute ? 'mid' : undefined,\n                    expr: 'datum'\n                });\n            return {\n                field: sortField,\n                order: 'descending'\n            };\n        }\n        return undefined;\n    }\n    return undefined;\n}\nfunction getMarkGroups(model, opt) {\n    if (opt === void 0) { opt = { fromPrefix: '' }; }\n    var mark = model.mark;\n    var clip = model.markDef.clip !== undefined ?\n        !!model.markDef.clip : scaleClip(model);\n    var style = getStyles(model.markDef);\n    var key = model.encoding.key;\n    var sort = getSort(model);\n    var postEncodingTransform = markCompiler[mark].postEncodingTransform ? markCompiler[mark].postEncodingTransform(model) : null;\n    return [tslib_1.__assign({ name: model.getName('marks'), type: markCompiler[mark].vgMark }, (clip ? { clip: true } : {}), (style ? { style: style } : {}), (key ? { key: { field: key.field } } : {}), (sort ? { sort: sort } : {}), { from: { data: opt.fromPrefix + model.requestDataName(MAIN) }, encode: {\n                update: markCompiler[mark].encodeEntry(model)\n            } }, (postEncodingTransform ? {\n            transform: postEncodingTransform\n        } : {}))];\n}\n/**\n * Returns list of path grouping fields\n * that the model's spec contains.\n */\nexport function pathGroupingFields(mark, encoding) {\n    return keys(encoding).reduce(function (details, channel) {\n        switch (channel) {\n            // x, y, x2, y2, lat, long, lat1, long2, order, tooltip, href, cursor should not cause lines to group\n            case 'x':\n            case 'y':\n            case 'order':\n            case 'tooltip':\n            case 'href':\n            case 'x2':\n            case 'y2':\n            case 'latitude':\n            case 'longitude':\n            case 'latitude2':\n            case 'longitude2':\n            // TODO: case 'cursor':\n            // text, shape, shouldn't be a part of line/trail/area\n            case 'text':\n            case 'shape':\n                return details;\n            case 'detail':\n            case 'key':\n                var channelDef = encoding[channel];\n                if (channelDef) {\n                    (isArray(channelDef) ? channelDef : [channelDef]).forEach(function (fieldDef) {\n                        if (!fieldDef.aggregate) {\n                            details.push(vgField(fieldDef, {}));\n                        }\n                    });\n                }\n                return details;\n            case 'size':\n                if (mark === 'trail') {\n                    // For trail, size should not group trail lines.\n                    return details;\n                }\n            // For line, it should group lines.\n            /* tslint:disable */\n            // intentional fall through\n            case 'color':\n            case 'fill':\n            case 'stroke':\n            case 'opacity':\n                // TODO strokeDashOffset:\n                /* tslint:enable */\n                var fieldDef = getFieldDef(encoding[channel]);\n                if (fieldDef && !fieldDef.aggregate) {\n                    details.push(vgField(fieldDef, {}));\n                }\n                return details;\n            default:\n                throw new Error(\"Bug: Channel \" + channel + \" unimplemented for line mark\");\n        }\n    }, []);\n}\n/**\n * If scales are bound to interval selections, we want to automatically clip\n * marks to account for panning/zooming interactions. We identify bound scales\n * by the domainRaw property, which gets added during scale parsing.\n */\nfunction scaleClip(model) {\n    var xScale = model.getScaleComponent('x');\n    var yScale = model.getScaleComponent('y');\n    return (xScale && xScale.get('domainRaw')) ||\n        (yScale && yScale.get('domainRaw')) ? true : false;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFyay5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21waWxlL21hcmsvbWFyay50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUNsQyxPQUFPLEVBQUMsSUFBSSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQ2hDLE9BQU8sRUFBVyxXQUFXLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUNyRCxPQUFPLEVBQUMsV0FBVyxFQUFFLFVBQVUsRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDNUUsT0FBTyxFQUFDLElBQUksRUFBRSxVQUFVLEVBQUUsSUFBSSxFQUFRLEtBQUssRUFBQyxNQUFNLFlBQVksQ0FBQztBQUMvRCxPQUFPLEVBQUMsV0FBVyxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQ3ZDLE9BQU8sRUFBQyxRQUFRLEVBQUUsSUFBSSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQzFDLE9BQU8sRUFBQyxTQUFTLEVBQUUsVUFBVSxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBRWhELE9BQU8sRUFBQyxJQUFJLEVBQUMsTUFBTSxRQUFRLENBQUM7QUFDNUIsT0FBTyxFQUFDLEdBQUcsRUFBQyxNQUFNLE9BQU8sQ0FBQztBQUUxQixPQUFPLEVBQUMsUUFBUSxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQ3BDLE9BQU8sRUFBQyxJQUFJLEVBQUUsS0FBSyxFQUFDLE1BQU0sUUFBUSxDQUFDO0FBQ25DLE9BQU8sRUFBQyxNQUFNLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBQyxNQUFNLFNBQVMsQ0FBQztBQUM5QyxPQUFPLEVBQUMsSUFBSSxFQUFDLE1BQU0sUUFBUSxDQUFDO0FBQzVCLE9BQU8sRUFBQyxJQUFJLEVBQUMsTUFBTSxRQUFRLENBQUM7QUFDNUIsT0FBTyxFQUFDLElBQUksRUFBQyxNQUFNLFFBQVEsQ0FBQztBQUM1QixPQUFP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LEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQztBQUN2RCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtpc0FycmF5fSBmcm9tICd2ZWdhLXV0aWwnO1xuaW1wb3J0IHtNQUlOfSBmcm9tICcuLi8uLi9kYXRhJztcbmltcG9ydCB7RW5jb2RpbmcsIGlzQWdncmVnYXRlfSBmcm9tICcuLi8uLi9lbmNvZGluZyc7XG5pbXBvcnQge2dldEZpZWxkRGVmLCBpc0ZpZWxkRGVmLCBpc1ZhbHVlRGVmLCB2Z0ZpZWxkfSBmcm9tICcuLi8uLi9maWVsZGRlZic7XG5pbXBvcnQge0FSRUEsIGlzUGF0aE1hcmssIExJTkUsIE1hcmssIFRSQUlMfSBmcm9tICcuLi8uLi9tYXJrJztcbmltcG9ydCB7aXNTb3J0RmllbGR9IGZyb20gJy4uLy4uL3NvcnQnO1xuaW1wb3J0IHtjb250YWlucywga2V5c30gZnJvbSAnLi4vLi4vdXRpbCc7XG5pbXBvcnQge2dldFN0eWxlcywgc29ydFBhcmFtc30gZnJvbSAnLi4vY29tbW9uJztcbmltcG9ydCB7VW5pdE1vZGVsfSBmcm9tICcuLi91bml0JztcbmltcG9ydCB7YXJlYX0gZnJvbSAnLi9hcmVhJztcbmltcG9ydCB7YmFyfSBmcm9tICcuL2Jhcic7XG5pbXBvcnQge01hcmtDb21waWxlcn0gZnJvbSAnLi9iYXNlJztcbmltcG9ydCB7Z2Vvc2hhcGV9IGZyb20gJy4vZ2Vvc2hhcGUnO1xuaW1wb3J0IHtsaW5lLCB0cmFpbH0gZnJvbSAnLi9saW5lJztcbmltcG9ydCB7Y2lyY2xlLCBwb2ludCwgc3F1YXJlfSBmcm9tICcuL3BvaW50JztcbmltcG9ydCB7cmVjdH0gZnJvbSAnLi9yZWN0JztcbmltcG9ydCB7cnVsZX0gZnJvbSAnLi9ydWxlJztcbmltcG9ydCB7dGV4dH0gZnJvbSAnLi90ZXh0JztcbmltcG9ydCB7dGlja30gZnJvbSAnLi90aWNrJztcblxuXG5jb25zdCBtYXJrQ29tcGlsZXI6IHtbbSBpbiBNYXJrXTogTWFya0NvbXBpbGVyfSA9IHtcbiAgYXJlYSxcbiAgYmFyLFxuICBjaXJjbGUsXG4gIGdlb3NoYXBlLFxuICBsaW5lLFxuICBwb2ludCxcbiAgcmVjdCxcbiAgcnVsZSxcbiAgc3F1YXJlLFxuICB0ZXh0LFxuICB0aWNrLFxuICB0cmFpbFxufTtcblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlTWFya0dyb3VwKG1vZGVsOiBVbml0TW9kZWwpOiBhbnlbXSB7XG4gIGlmIChjb250YWlucyhbTElORSwgQVJFQSwgVFJBSUxdLCBtb2RlbC5tYXJrKSkge1xuICAgIHJldHVybiBwYXJzZVBhdGhNYXJrKG1vZGVsKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZ2V0TWFya0dyb3Vwcyhtb2RlbCk7XG4gIH1cbn1cblxuY29uc3QgRkFDRVRFRF9QQVRIX1BSRUZJWCA9ICdmYWNldGVkX3BhdGhfJztcblxuZnVuY3Rpb24gcGFyc2VQYXRoTWFyayhtb2RlbDogVW5pdE1vZGVsKSB7XG4gIGNvbnN0IGRldGFpbHMgPSBwYXRoR3JvdXBpbmdGaWVsZHMobW9kZWwubWFyaywgbW9kZWwuZW5jb2RpbmcpO1xuXG4gIGNvbnN0IHBhdGhNYXJrcyA9IGdldE1hcmtHcm91cHMobW9kZWwsIHtcbiAgICAvLyBJZiBoYXMgc3ViZmFjZXQgZm9yIGxpbmUvYXJlYSBncm91cCwgbmVlZCB0byB1c2UgZmFjZXRlZCBkYXRhIGZyb20gYmVsb3cuXG4gICAgZnJvbVByZWZpeDogKGRldGFpbHMubGVuZ3RoID4gMCA/IEZBQ0VURURfUEFUSF9QUkVGSVggOiAnJylcbiAgfSk7XG5cbiAgaWYgKGRldGFpbHMubGVuZ3RoID4gMCkgeyAvLyBoYXZlIGxldmVsIG9mIGRldGFpbHMgLSBuZWVkIHRvIGZhY2V0IGxpbmUgaW50byBzdWJncm91cHNcbiAgICAvLyBUT0RPOiBmb3Igbm9uLXN0YWNrZWQgcGxvdCwgbWFwIG9yZGVyIHRvIHppbmRleC4gKE1heWJlIHJlbmFtZSBvcmRlciBmb3IgbGF5ZXIgdG8gemluZGV4PylcblxuICAgIHJldHVybiBbe1xuICAgICAgbmFtZTogbW9kZWwuZ2V0TmFtZSgncGF0aGdyb3VwJyksXG4gICAgICB0eXBlOiAnZ3JvdXAnLFxuICAgICAgZnJvbToge1xuICAgICAgICBmYWNldDoge1xuICAgICAgICAgIG5hbWU6IEZBQ0VURURfUEFUSF9QUkVGSVggKyBtb2RlbC5yZXF1ZXN0RGF0YU5hbWUoTUFJTiksXG4gICAgICAgICAgZGF0YTogbW9kZWwucmVxdWVzdERhdGFOYW1lKE1BSU4pLFxuICAgICAgICAgIGdyb3VwYnk6IGRldGFpbHMsXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBlbmNvZGU6IHtcbiAgICAgICAgdXBkYXRlOiB7XG4gICAgICAgICAgd2lkdGg6IHtmaWVsZDoge2dyb3VwOiAnd2lkdGgnfX0sXG4gICAgICAgICAgaGVpZ2h0OiB7ZmllbGQ6IHtncm91cDogJ2hlaWdodCd9fVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgbWFya3M6IHBhdGhNYXJrc1xuICAgIH1dO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBwYXRoTWFya3M7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNvcnQobW9kZWw6IFVuaXRNb2RlbCkge1xuICBjb25zdCB7ZW5jb2RpbmcsIHN0YWNrLCBtYXJrLCBtYXJrRGVmfSA9IG1vZGVsO1xuICBjb25zdCBvcmRlciA9IGVuY29kaW5nLm9yZGVyO1xuICBpZiAoIWlzQXJyYXkob3JkZXIpICYmIGlzVmFsdWVEZWYob3JkZXIpKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfSBlbHNlIGlmICgoaXNBcnJheShvcmRlcikgfHwgaXNGaWVsZERlZihvcmRlcikpICYmICFzdGFjaykge1xuICAgIC8vIFNvcnQgYnkgdGhlIG9yZGVyIGZpZWxkIGlmIGl0IGlzIHNwZWNpZmllZCBhbmQgdGhlIGZpZWxkIGlzIG5vdCBzdGFja2VkLiAoRm9yIHN0YWNrZWQgZmllbGQsIG9yZGVyIHNwZWNpZnkgc3RhY2sgb3JkZXIuKVxuICAgIHJldHVybiBzb3J0UGFyYW1zKG9yZGVyLCB7ZXhwcjogJ2RhdHVtJ30pO1xuICB9IGVsc2UgaWYgKGlzUGF0aE1hcmsobWFyaykpIHtcbiAgICAvLyBGb3IgYm90aCBsaW5lIGFuZCBhcmVhLCB3ZSBzb3J0IHZhbHVlcyBiYXNlZCBvbiBkaW1lbnNpb24gYnkgZGVmYXVsdFxuICAgIGNvbnN0IGRpbWVuc2lvbkNoYW5uZWxEZWYgPSBlbmNvZGluZ1ttYXJrRGVmLm9yaWVudCA9PT0gJ2hvcml6b250YWwnID8gJ3knIDogJ3gnXTtcbiAgICBpZiAoaXNGaWVsZERlZihkaW1lbnNpb25DaGFubmVsRGVmKSkge1xuICAgICAgY29uc3QgcyA9IGRpbWVuc2lvbkNoYW5uZWxEZWYuc29ydDtcbiAgICAgIGNvbnN0IHNvcnRGaWVsZCA9IGlzU29ydEZpZWxkKHMpID9cbiAgICAgICAgdmdGaWVsZCh7XG4gICAgICAgICAgLy8gRklYTUU6IHRoaXMgb3AgbWlnaHQgbm90IGFscmVhZHkgZXhpc3Q/XG4gICAgICAgICAgLy8gRklYTUU6IHdoYXQgaWYgZGltZW5zaW9uQ2hhbm5lbCAoeCBvciB5KSBjb250YWlucyBjdXN0b20gZG9tYWluP1xuICAgICAgICAgIGFnZ3JlZ2F0ZTogaXNBZ2dyZWdhdGUobW9kZWwuZW5jb2RpbmcpID8gcy5vcCA6IHVuZGVmaW5lZCxcbiAgICAgICAgICBmaWVsZDogcy5maWVsZFxuICAgICAgICB9LCB7ZXhwcjogJ2RhdHVtJ30pIDpcbiAgICAgICAgdmdGaWVsZChkaW1lbnNpb25DaGFubmVsRGVmLCB7XG4gICAgICAgICAgLy8gRm9yIHN0YWNrIHdpdGggaW1wdXRhdGlvbiwgd2Ugb25seSBoYXZlIGJpbl9taWRcbiAgICAgICAgICBiaW5TdWZmaXg6IG1vZGVsLnN0YWNrICYmIG1vZGVsLnN0YWNrLmltcHV0ZSA/ICdtaWQnIDogdW5kZWZpbmVkLFxuICAgICAgICAgIGV4cHI6ICdkYXR1bSdcbiAgICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGZpZWxkOiBzb3J0RmllbGQsXG4gICAgICAgIG9yZGVyOiAnZGVzY2VuZGluZydcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuZnVuY3Rpb24gZ2V0TWFya0dyb3Vwcyhtb2RlbDogVW5pdE1vZGVsLCBvcHQ6IHtcbiAgZnJvbVByZWZpeDogc3RyaW5nXG59ID0ge2Zyb21QcmVmaXg6ICcnfSkge1xuICBjb25zdCBtYXJrID0gbW9kZWwubWFyaztcblxuICBjb25zdCBjbGlwID0gbW9kZWwubWFya0RlZi5jbGlwICE9PSB1bmRlZmluZWQgP1xuICAgICEhbW9kZWwubWFya0RlZi5jbGlwIDogc2NhbGVDbGlwKG1vZGVsKTtcbiAgY29uc3Qgc3R5bGUgPSBnZXRTdHlsZXMobW9kZWwubWFya0RlZik7XG4gIGNvbnN0IGtleSA9IG1vZGVsLmVuY29kaW5nLmtleTtcbiAgY29uc3Qgc29ydCA9IGdldFNvcnQobW9kZWwpO1xuXG4gIGNvbnN0IHBvc3RFbmNvZGluZ1RyYW5zZm9ybSA9IG1hcmtDb21waWxlclttYXJrXS5wb3N0RW5jb2RpbmdUcmFuc2Zvcm0gPyBtYXJrQ29tcGlsZXJbbWFya10ucG9zdEVuY29kaW5nVHJhbnNmb3JtKG1vZGVsKSA6IG51bGw7XG5cbiAgcmV0dXJuIFt7XG4gICAgbmFtZTogbW9kZWwuZ2V0TmFtZSgnbWFya3MnKSxcbiAgICB0eXBlOiBtYXJrQ29tcGlsZXJbbWFya10udmdNYXJrLFxuICAgIC4uLihjbGlwID8ge2NsaXA6IHRydWV9IDoge30pLFxuICAgIC4uLihzdHlsZSA/IHtzdHlsZX0gOiB7fSksXG4gICAgLi4uKGtleSA/IHtrZXk6IHtmaWVsZDoga2V5LmZpZWxkfX0gOiB7fSksXG4gICAgLi4uKHNvcnQgPyB7c29ydH0gOiB7fSksXG4gICAgZnJvbToge2RhdGE6IG9wdC5mcm9tUHJlZml4ICsgbW9kZWwucmVxdWVzdERhdGFOYW1lKE1BSU4pfSxcbiAgICBlbmNvZGU6IHtcbiAgICAgIHVwZGF0ZTogbWFya0NvbXBpbGVyW21hcmtdLmVuY29kZUVudHJ5KG1vZGVsKVxuICAgIH0sXG4gICAgLi4uKHBvc3RFbmNvZGluZ1RyYW5zZm9ybSA/IHtcbiAgICAgIHRyYW5zZm9ybTogcG9zdEVuY29kaW5nVHJhbnNmb3JtXG4gICAgfSA6IHt9KVxuICB9XTtcblxufVxuXG4vKipcbiAqIFJldHVybnMgbGlzdCBvZiBwYXRoIGdyb3VwaW5nIGZpZWxkc1xuICogdGhhdCB0aGUgbW9kZWwncyBzcGVjIGNvbnRhaW5zLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcGF0aEdyb3VwaW5nRmllbGRzKG1hcms6IE1hcmssIGVuY29kaW5nOiBFbmNvZGluZzxzdHJpbmc+KTogc3RyaW5nW10ge1xuICByZXR1cm4ga2V5cyhlbmNvZGluZykucmVkdWNlKChkZXRhaWxzLCBjaGFubmVsKSA9PiB7XG4gICAgc3dpdGNoIChjaGFubmVsKSB7XG4gICAgICAvLyB4LCB5LCB4MiwgeTIsIGxhdCwgbG9uZywgbGF0MSwgbG9uZzIsIG9yZGVyLCB0b29sdGlwLCBocmVmLCBjdXJzb3Igc2hvdWxkIG5vdCBjYXVzZSBsaW5lcyB0byBncm91cFxuICAgICAgY2FzZSAneCc6XG4gICAgICBjYXNlICd5JzpcbiAgICAgIGNhc2UgJ29yZGVyJzpcbiAgICAgIGNhc2UgJ3Rvb2x0aXAnOlxuICAgICAgY2FzZSAnaHJlZic6XG4gICAgICBjYXNlICd4Mic6XG4gICAgICBjYXNlICd5Mic6XG5cbiAgICAgIGNhc2UgJ2xhdGl0dWRlJzpcbiAgICAgIGNhc2UgJ2xvbmdpdHVkZSc6XG4gICAgICBjYXNlICdsYXRpdHVkZTInOlxuICAgICAgY2FzZSAnbG9uZ2l0dWRlMic6XG4gICAgICAvLyBUT0RPOiBjYXNlICdjdXJzb3InOlxuXG4gICAgICAvLyB0ZXh0LCBzaGFwZSwgc2hvdWxkbid0IGJlIGEgcGFydCBvZiBsaW5lL3RyYWlsL2FyZWFcbiAgICAgIGNhc2UgJ3RleHQnOlxuICAgICAgY2FzZSAnc2hhcGUnOlxuICAgICAgICByZXR1cm4gZGV0YWlscztcblxuICAgICAgY2FzZSAnZGV0YWlsJzpcbiAgICAgIGNhc2UgJ2tleSc6XG4gICAgICAgIGNvbnN0IGNoYW5uZWxEZWYgPSBlbmNvZGluZ1tjaGFubmVsXTtcbiAgICAgICAgaWYgKGNoYW5uZWxEZWYpIHtcbiAgICAgICAgICAoaXNBcnJheShjaGFubmVsRGVmKSA/IGNoYW5uZWxEZWYgOiBbY2hhbm5lbERlZl0pLmZvckVhY2goKGZpZWxkRGVmKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWZpZWxkRGVmLmFnZ3JlZ2F0ZSkge1xuICAgICAgICAgICAgICBkZXRhaWxzLnB1c2godmdGaWVsZChmaWVsZERlZiwge30pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGV0YWlscztcblxuICAgICAgY2FzZSAnc2l6ZSc6XG4gICAgICAgIGlmIChtYXJrID09PSAndHJhaWwnKSB7XG4gICAgICAgICAgLy8gRm9yIHRyYWlsLCBzaXplIHNob3VsZCBub3QgZ3JvdXAgdHJhaWwgbGluZXMuXG4gICAgICAgICAgcmV0dXJuIGRldGFpbHM7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRm9yIGxpbmUsIGl0IHNob3VsZCBncm91cCBsaW5lcy5cblxuICAgICAgLyogdHNsaW50OmRpc2FibGUgKi9cbiAgICAgIC8vIGludGVudGlvbmFsIGZhbGwgdGhyb3VnaFxuXG4gICAgICBjYXNlICdjb2xvcic6XG4gICAgICBjYXNlICdmaWxsJzpcbiAgICAgIGNhc2UgJ3N0cm9rZSc6XG4gICAgICBjYXNlICdvcGFjaXR5JzpcbiAgICAgIC8vIFRPRE8gc3Ryb2tlRGFzaE9mZnNldDpcblxuICAgICAgLyogdHNsaW50OmVuYWJsZSAqL1xuICAgICAgICBjb25zdCBmaWVsZERlZiA9IGdldEZpZWxkRGVmPHN0cmluZz4oZW5jb2RpbmdbY2hhbm5lbF0pO1xuICAgICAgICBpZiAoZmllbGREZWYgJiYgIWZpZWxkRGVmLmFnZ3JlZ2F0ZSkge1xuICAgICAgICAgIGRldGFpbHMucHVzaCh2Z0ZpZWxkKGZpZWxkRGVmLCB7fSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkZXRhaWxzO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBCdWc6IENoYW5uZWwgJHtjaGFubmVsfSB1bmltcGxlbWVudGVkIGZvciBsaW5lIG1hcmtgKTtcbiAgICB9XG4gIH0sIFtdKTtcbn1cblxuLyoqXG4gKiBJZiBzY2FsZXMgYXJlIGJvdW5kIHRvIGludGVydmFsIHNlbGVjdGlvbnMsIHdlIHdhbnQgdG8gYXV0b21hdGljYWxseSBjbGlwXG4gKiBtYXJrcyB0byBhY2NvdW50IGZvciBwYW5uaW5nL3pvb21pbmcgaW50ZXJhY3Rpb25zLiBXZSBpZGVudGlmeSBib3VuZCBzY2FsZXNcbiAqIGJ5IHRoZSBkb21haW5SYXcgcHJvcGVydHksIHdoaWNoIGdldHMgYWRkZWQgZHVyaW5nIHNjYWxlIHBhcnNpbmcuXG4gKi9cbmZ1bmN0aW9uIHNjYWxlQ2xpcChtb2RlbDogVW5pdE1vZGVsKSB7XG4gIGNvbnN0IHhTY2FsZSA9IG1vZGVsLmdldFNjYWxlQ29tcG9uZW50KCd4Jyk7XG4gIGNvbnN0IHlTY2FsZSA9IG1vZGVsLmdldFNjYWxlQ29tcG9uZW50KCd5Jyk7XG4gIHJldHVybiAoeFNjYWxlICYmIHhTY2FsZS5nZXQoJ2RvbWFpblJhdycpKSB8fFxuICAgICh5U2NhbGUgJiYgeVNjYWxlLmdldCgnZG9tYWluUmF3JykpID8gdHJ1ZSA6IGZhbHNlO1xufVxuIl19","import * as tslib_1 from \"tslib\";\nimport { GEOPOSITION_CHANNELS, NONPOSITION_SCALE_CHANNELS, SCALE_CHANNELS, X, Y } from '../channel';\nimport * as vlEncoding from '../encoding';\nimport { normalizeEncoding } from '../encoding';\nimport { getFieldDef, hasConditionalFieldDef, isFieldDef } from '../fielddef';\nimport { GEOSHAPE, isMarkDef } from '../mark';\nimport { stack } from '../stack';\nimport { duplicate } from '../util';\nimport { parseUnitAxis } from './axis/parse';\nimport { parseData } from './data/parse';\nimport { assembleLayoutSignals } from './layoutsize/assemble';\nimport { parseUnitLayoutSize } from './layoutsize/parse';\nimport { normalizeMarkDef } from './mark/init';\nimport { parseMarkGroup } from './mark/mark';\nimport { isLayerModel, ModelWithField } from './model';\nimport { replaceRepeaterInEncoding } from './repeater';\nimport { assembleTopLevelSignals, assembleUnitSelectionData, assembleUnitSelectionMarks, assembleUnitSelectionSignals, parseUnitSelection } from './selection/selection';\n/**\n * Internal model of Vega-Lite specification for the compiler.\n */\nvar UnitModel = /** @class */ (function (_super) {\n    tslib_1.__extends(UnitModel, _super);\n    function UnitModel(spec, parent, parentGivenName, parentGivenSize, repeater, config, fit) {\n        if (parentGivenSize === void 0) { parentGivenSize = {}; }\n        var _this = _super.call(this, spec, parent, parentGivenName, config, repeater, undefined) || this;\n        _this.fit = fit;\n        _this.type = 'unit';\n        _this.specifiedScales = {};\n        _this.specifiedAxes = {};\n        _this.specifiedLegends = {};\n        _this.specifiedProjection = {};\n        _this.selection = {};\n        _this.children = [];\n        _this.initSize(tslib_1.__assign({}, parentGivenSize, (spec.width ? { width: spec.width } : {}), (spec.height ? { height: spec.height } : {})));\n        var mark = isMarkDef(spec.mark) ? spec.mark.type : spec.mark;\n        var encoding = _this.encoding = normalizeEncoding(replaceRepeaterInEncoding(spec.encoding || {}, repeater), mark);\n        _this.markDef = normalizeMarkDef(spec.mark, encoding, config);\n        // calculate stack properties\n        _this.stack = stack(mark, encoding, _this.config.stack);\n        _this.specifiedScales = _this.initScales(mark, encoding);\n        _this.specifiedAxes = _this.initAxes(encoding);\n        _this.specifiedLegends = _this.initLegend(encoding);\n        _this.specifiedProjection = spec.projection;\n        // Selections will be initialized upon parse.\n        _this.selection = spec.selection;\n        return _this;\n    }\n    Object.defineProperty(UnitModel.prototype, \"hasProjection\", {\n        get: function () {\n            var encoding = this.encoding;\n            var isGeoShapeMark = this.mark === GEOSHAPE;\n            var hasGeoPosition = encoding && GEOPOSITION_CHANNELS.some(function (channel) { return isFieldDef(encoding[channel]); });\n            return isGeoShapeMark || hasGeoPosition;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Return specified Vega-lite scale domain for a particular channel\n     * @param channel\n     */\n    UnitModel.prototype.scaleDomain = function (channel) {\n        var scale = this.specifiedScales[channel];\n        return scale ? scale.domain : undefined;\n    };\n    UnitModel.prototype.axis = function (channel) {\n        return this.specifiedAxes[channel];\n    };\n    UnitModel.prototype.legend = function (channel) {\n        return this.specifiedLegends[channel];\n    };\n    UnitModel.prototype.initScales = function (mark, encoding) {\n        return SCALE_CHANNELS.reduce(function (scales, channel) {\n            var fieldDef;\n            var specifiedScale;\n            var channelDef = encoding[channel];\n            if (isFieldDef(channelDef)) {\n                fieldDef = channelDef;\n                specifiedScale = channelDef.scale;\n            }\n            else if (hasConditionalFieldDef(channelDef)) {\n                fieldDef = channelDef.condition;\n                specifiedScale = channelDef.condition['scale'];\n            }\n            else if (channel === 'x') {\n                fieldDef = getFieldDef(encoding.x2);\n            }\n            else if (channel === 'y') {\n                fieldDef = getFieldDef(encoding.y2);\n            }\n            if (fieldDef) {\n                scales[channel] = specifiedScale || {};\n            }\n            return scales;\n        }, {});\n    };\n    UnitModel.prototype.initAxes = function (encoding) {\n        return [X, Y].reduce(function (_axis, channel) {\n            // Position Axis\n            // TODO: handle ConditionFieldDef\n            var channelDef = encoding[channel];\n            if (isFieldDef(channelDef) ||\n                (channel === X && isFieldDef(encoding.x2)) ||\n                (channel === Y && isFieldDef(encoding.y2))) {\n                var axisSpec = isFieldDef(channelDef) ? channelDef.axis : null;\n                // We no longer support false in the schema, but we keep false here for backward compatibility.\n                if (axisSpec !== null && axisSpec !== false) {\n                    _axis[channel] = tslib_1.__assign({}, axisSpec);\n                }\n            }\n            return _axis;\n        }, {});\n    };\n    UnitModel.prototype.initLegend = function (encoding) {\n        return NONPOSITION_SCALE_CHANNELS.reduce(function (_legend, channel) {\n            var channelDef = encoding[channel];\n            if (channelDef) {\n                var legend = isFieldDef(channelDef) ? channelDef.legend :\n                    (hasConditionalFieldDef(channelDef)) ? channelDef.condition['legend'] : null;\n                if (legend !== null && legend !== false) {\n                    _legend[channel] = tslib_1.__assign({}, legend);\n                }\n            }\n            return _legend;\n        }, {});\n    };\n    UnitModel.prototype.parseData = function () {\n        this.component.data = parseData(this);\n    };\n    UnitModel.prototype.parseLayoutSize = function () {\n        parseUnitLayoutSize(this);\n    };\n    UnitModel.prototype.parseSelection = function () {\n        this.component.selection = parseUnitSelection(this, this.selection);\n    };\n    UnitModel.prototype.parseMarkGroup = function () {\n        this.component.mark = parseMarkGroup(this);\n    };\n    UnitModel.prototype.parseAxisAndHeader = function () {\n        this.component.axes = parseUnitAxis(this);\n    };\n    UnitModel.prototype.assembleSelectionTopLevelSignals = function (signals) {\n        return assembleTopLevelSignals(this, signals);\n    };\n    UnitModel.prototype.assembleSelectionSignals = function () {\n        return assembleUnitSelectionSignals(this, []);\n    };\n    UnitModel.prototype.assembleSelectionData = function (data) {\n        return assembleUnitSelectionData(this, data);\n    };\n    UnitModel.prototype.assembleLayout = function () {\n        return null;\n    };\n    UnitModel.prototype.assembleLayoutSignals = function () {\n        return assembleLayoutSignals(this);\n    };\n    UnitModel.prototype.assembleMarks = function () {\n        var marks = this.component.mark || [];\n        // If this unit is part of a layer, selections should augment\n        // all in concert rather than each unit individually. This\n        // ensures correct interleaving of clipping and brushed marks.\n        if (!this.parent || !isLayerModel(this.parent)) {\n            marks = assembleUnitSelectionMarks(this, marks);\n        }\n        return marks.map(this.correctDataNames);\n    };\n    UnitModel.prototype.assembleLayoutSize = function () {\n        return {\n            width: this.getSizeSignalRef('width'),\n            height: this.getSizeSignalRef('height')\n        };\n    };\n    UnitModel.prototype.getMapping = function () {\n        return this.encoding;\n    };\n    UnitModel.prototype.toSpec = function (excludeConfig, excludeData) {\n        var encoding = duplicate(this.encoding);\n        var spec;\n        spec = {\n            mark: this.markDef,\n            encoding: encoding\n        };\n        if (!excludeConfig) {\n            spec.config = duplicate(this.config);\n        }\n        if (!excludeData) {\n            spec.data = duplicate(this.data);\n        }\n        // remove defaults\n        return spec;\n    };\n    Object.defineProperty(UnitModel.prototype, \"mark\", {\n        get: function () {\n            return this.markDef.type;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    UnitModel.prototype.channelHasField = function (channel) {\n        return vlEncoding.channelHasField(this.encoding, channel);\n    };\n    UnitModel.prototype.fieldDef = function (channel) {\n        var channelDef = this.encoding[channel];\n        return getFieldDef(channelDef);\n    };\n    return UnitModel;\n}(ModelWithField));\nexport { UnitModel };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidW5pdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21waWxlL3VuaXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBLE9BQU8sRUFBVSxvQkFBb0IsRUFBRSwwQkFBMEIsRUFBRSxjQUFjLEVBQWtDLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxZQUFZLENBQUM7QUFFM0ksT0FBTyxLQUFLLFVBQVUsTUFBTSxhQUFhLENBQUM7QUFDMUMsT0FBTyxFQUFXLGlCQUFpQixFQUFDLE1BQU0sYUFBYSxDQUFDO0FBQ3hELE9BQU8sRUFBdUIsV0FBVyxFQUFFLHNCQUFzQixFQUFFLFVBQVUsRUFBQyxNQUFNLGFBQWEsQ0FBQztBQUVsRyxPQUFPLEVBQUMsUUFBUSxFQUFFLFNBQVMsRUFBZ0IsTUFBTSxTQUFTLENBQUM7QUFLM0QsT0FBTyxFQUFDLEtBQUssRUFBa0IsTUFBTSxVQUFVLENBQUM7QUFDaEQsT0FBTyxFQUFPLFNBQVMsRUFBQyxNQUFNLFNBQVMsQ0FBQztBQUd4QyxPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0sY0FBYyxDQUFDO0FBQzNDLE9BQU8sRUFBQyxTQUFTLEVBQUMsTUFBTSxjQUFjLENBQUM7QUFDdkMsT0FBTyxFQUFDLHFCQUFxQixFQUFDLE1BQU0sdUJBQXVCLENBQUM7QUFDNUQsT0FBTyxFQUFDLG1CQUFtQixFQUFDLE1BQU0sb0JBQW9CLENBQUM7QUFFdkQsT0FBTyxFQUFDLGdCQUFnQixFQUFDLE1BQU0sYUFBYSxDQUFDO0FBQzdDLE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSxhQUFhLENBQUM7QUFDM0MsT0FBTyxFQUFDLFlBQVksRUFBUyxjQUFjLEVBQUMsTUFBTSxTQUFTLENBQUM7QUFDNUQsT0FBTyxFQUFnQix5QkFBeUIsRUFBQyxNQUFNLFlBQVksQ0FBQztBQUVwRSxPQUFPLEVBQUMsdUJBQXVCLEVBQUUseUJBQXlCLEVBQUUsMEJBQTBCLEVBQUUsNEJBQTRCLEVBQUUsa0JBQWtCLEVB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O1lBQ0wsSUFBSSxFQUFFLElBQUksQ0FBQyxPQUFPO1lBQ2xCLFFBQVEsRUFBRSxRQUFRO1NBQ25CLENBQUM7UUFFRixJQUFJLENBQUMsYUFBYSxFQUFFO1lBQ2xCLElBQUksQ0FBQyxNQUFNLEdBQUcsU0FBUyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztTQUN0QztRQUVELElBQUksQ0FBQyxXQUFXLEVBQUU7WUFDaEIsSUFBSSxDQUFDLElBQUksR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ2xDO1FBRUQsa0JBQWtCO1FBQ2xCLE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVELHNCQUFXLDJCQUFJO2FBQWY7WUFDRSxPQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDO1FBQzNCLENBQUM7OztPQUFBO0lBRU0sbUNBQWUsR0FBdEIsVUFBdUIsT0FBZ0I7UUFDckMsT0FBTyxVQUFVLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDNUQsQ0FBQztJQUVNLDRCQUFRLEdBQWYsVUFBZ0IsT0FBeUI7UUFDdkMsSUFBTSxVQUFVLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQXVCLENBQUM7UUFDaEUsT0FBTyxXQUFXLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDakMsQ0FBQztJQUNILGdCQUFDO0FBQUQsQ0FBQyxBQXpPRCxDQUErQixjQUFjLEdBeU81QyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7QXhpc30gZnJvbSAnLi4vYXhpcyc7XG5pbXBvcnQge0NoYW5uZWwsIEdFT1BPU0lUSU9OX0NIQU5ORUxTLCBOT05QT1NJVElPTl9TQ0FMRV9DSEFOTkVMUywgU0NBTEVfQ0hBTk5FTFMsIFNjYWxlQ2hhbm5lbCwgU2luZ2xlRGVmQ2hhbm5lbCwgWCwgWX0gZnJvbSAnLi4vY2hhbm5lbCc7XG5pbXBvcnQge0NvbmZpZ30gZnJvbSAnLi4vY29uZmlnJztcbmltcG9ydCAqIGFzIHZsRW5jb2RpbmcgZnJvbSAnLi4vZW5jb2RpbmcnO1xuaW1wb3J0IHtFbmNvZGluZywgbm9ybWFsaXplRW5jb2Rpbmd9IGZyb20gJy4uL2VuY29kaW5nJztcbmltcG9ydCB7Q2hhbm5lbERlZiwgRmllbGREZWYsIGdldEZpZWxkRGVmLCBoYXNDb25kaXRpb25hbEZpZWxkRGVmLCBpc0ZpZWxkRGVmfSBmcm9tICcuLi9maWVsZGRlZic7XG5pbXBvcnQge0xlZ2VuZH0gZnJvbSAnLi4vbGVnZW5kJztcbmltcG9ydCB7R0VPU0hBUEUsIGlzTWFya0RlZiwgTWFyaywgTWFya0RlZn0gZnJvbSAnLi4vbWFyayc7XG5pbXBvcnQge1Byb2plY3Rpb259IGZyb20gJy4uL3Byb2plY3Rpb24nO1xuaW1wb3J0IHtEb21haW4sIFNjYWxlfSBmcm9tICcuLi9zY2FsZSc7XG5pbXBvcnQge1NlbGVjdGlvbkRlZn0gZnJvbSAnLi4vc2VsZWN0aW9uJztcbmltcG9ydCB7TGF5b3V0U2l6ZU1peGlucywgTm9ybWFsaXplZFVuaXRTcGVjfSBmcm9tICcuLi9zcGVjJztcbmltcG9ydCB7c3RhY2ssIFN0YWNrUHJvcGVydGllc30gZnJvbSAnLi4vc3RhY2snO1xuaW1wb3J0IHtEaWN0LCBkdXBsaWNhdGV9IGZyb20gJy4uL3V0aWwnO1xuaW1wb3J0IHtWZ0RhdGEsIFZnRW5jb2RlRW50cnksIFZnTGF5b3V0LCBWZ1NpZ25hbH0gZnJvbSAnLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtBeGlzSW5kZXh9IGZyb20gJy4vYXhpcy9jb21wb25lbnQnO1xuaW1wb3J0IHtwYXJzZVVuaXRBeGlzfSBmcm9tICcuL2F4aXMvcGFyc2UnO1xuaW1wb3J0IHtwYXJzZURhdGF9IGZyb20gJy4vZGF0YS9wYXJzZSc7XG5pbXBvcnQge2Fzc2VtYmxlTGF5b3V0U2lnbmFsc30gZnJvbSAnLi9sYXlvdXRzaXplL2Fzc2VtYmxlJztcbmltcG9ydCB7cGFyc2VVbml0TGF5b3V0U2l6ZX0gZnJvbSAnLi9sYXlvdXRzaXplL3BhcnNlJztcbmltcG9ydCB7TGVnZW5kSW5kZXh9IGZyb20gJy4vbGVnZW5kL2NvbXBvbmVudCc7XG5pbXBvcnQge25vcm1hbGl6ZU1hcmtEZWZ9IGZyb20gJy4vbWFyay9pbml0JztcbmltcG9ydCB7cGFyc2VNYXJrR3JvdXB9IGZyb20gJy4vbWFyay9tYXJrJztcbmltcG9ydCB7aXNMYXllck1vZGVsLCBNb2RlbCwgTW9kZWxXaXRoRmllbGR9IGZyb20gJy4vbW9kZWwnO1xuaW1wb3J0IHtSZXBlYXRlclZhbHVlLCByZXBsYWNlUmVwZWF0ZXJJbkVuY29kaW5nfSBmcm9tICcuL3JlcGVhdGVyJztcbmltcG9ydCB7U2NhbGVJbmRleH0gZnJvbSAnLi9zY2FsZS9jb21wb25lbnQnO1xuaW1wb3J0IHthc3NlbWJsZVRvcExldmVsU2lnbmFscywgYXNzZW1ibGVVbml0U2VsZWN0aW9uRGF0YSwgYXNzZW1ibGVVbml0U2VsZWN0aW9uTWFya3MsIGFzc2VtYmxlVW5pdFNlbGVjdGlvblNpZ25hbHMsIHBhcnNlVW5pdFNlbGVjdGlvbn0gZnJvbSAnLi9zZWxlY3Rpb24vc2VsZWN0aW9uJztcblxuXG4vKipcbiAqIEludGVybmFsIG1vZGVsIG9mIFZlZ2EtTGl0ZSBzcGVjaWZpY2F0aW9uIGZvciB0aGUgY29tcGlsZXIuXG4gKi9cbmV4cG9ydCBjbGFzcyBVbml0TW9kZWwgZXh0ZW5kcyBNb2RlbFdpdGhGaWVsZCB7XG4gIHB1YmxpYyByZWFkb25seSB0eXBlOiAndW5pdCcgPSAndW5pdCc7XG4gIHB1YmxpYyByZWFkb25seSBtYXJrRGVmOiBNYXJrRGVmO1xuICBwdWJsaWMgcmVhZG9ubHkgZW5jb2Rpbmc6IEVuY29kaW5nPHN0cmluZz47XG5cbiAgcHVibGljIHJlYWRvbmx5IHNwZWNpZmllZFNjYWxlczogU2NhbGVJbmRleCA9IHt9O1xuXG4gIHB1YmxpYyByZWFkb25seSBzdGFjazogU3RhY2tQcm9wZXJ0aWVzO1xuXG4gIHByb3RlY3RlZCBzcGVjaWZpZWRBeGVzOiBBeGlzSW5kZXggPSB7fTtcblxuICBwcm90ZWN0ZWQgc3BlY2lmaWVkTGVnZW5kczogTGVnZW5kSW5kZXggPSB7fTtcblxuICBwdWJsaWMgc3BlY2lmaWVkUHJvamVjdGlvbjogUHJvamVjdGlvbiA9IHt9O1xuXG4gIHB1YmxpYyByZWFkb25seSBzZWxlY3Rpb246IERpY3Q8U2VsZWN0aW9uRGVmPiA9IHt9O1xuICBwdWJsaWMgY2hpbGRyZW46IE1vZGVsW10gPSBbXTtcblxuICBjb25zdHJ1Y3RvcihzcGVjOiBOb3JtYWxpemVkVW5pdFNwZWMsIHBhcmVudDogTW9kZWwsIHBhcmVudEdpdmVuTmFtZTogc3RyaW5nLFxuICAgIHBhcmVudEdpdmVuU2l6ZTogTGF5b3V0U2l6ZU1peGlucyA9IHt9LCByZXBlYXRlcjogUmVwZWF0ZXJWYWx1ZSwgY29uZmlnOiBDb25maWcsIHB1YmxpYyBmaXQ6IGJvb2xlYW4pIHtcblxuICAgIHN1cGVyKHNwZWMsIHBhcmVudCwgcGFyZW50R2l2ZW5OYW1lLCBjb25maWcsIHJlcGVhdGVyLCB1bmRlZmluZWQpO1xuICAgIHRoaXMuaW5pdFNpemUoe1xuICAgICAgLi4ucGFyZW50R2l2ZW5TaXplLFxuICAgICAgLi4uKHNwZWMud2lkdGggPyB7d2lkdGg6IHNwZWMud2lkdGh9IDoge30pLFxuICAgICAgLi4uKHNwZWMuaGVpZ2h0ID8ge2hlaWdodDogc3BlYy5oZWlnaHR9IDoge30pXG4gICAgfSk7XG4gICAgY29uc3QgbWFyayA9IGlzTWFya0RlZihzcGVjLm1hcmspID8gc3BlYy5tYXJrLnR5cGUgOiBzcGVjLm1hcms7XG5cbiAgICBjb25zdCBlbmNvZGluZyA9IHRoaXMuZW5jb2RpbmcgPSBub3JtYWxpemVFbmNvZGluZyhyZXBsYWNlUmVwZWF0ZXJJbkVuY29kaW5nKHNwZWMuZW5jb2RpbmcgfHwge30sIHJlcGVhdGVyKSwgbWFyayk7XG5cbiAgICB0aGlzLm1hcmtEZWYgPSBub3JtYWxpemVNYXJrRGVmKHNwZWMubWFyaywgZW5jb2RpbmcsIGNvbmZpZyk7XG5cbiAgICAvLyBjYWxjdWxhdGUgc3RhY2sgcHJvcGVydGllc1xuICAgIHRoaXMuc3RhY2sgPSBzdGFjayhtYXJrLCBlbmNvZGluZywgdGhpcy5jb25maWcuc3RhY2spO1xuICAgIHRoaXMuc3BlY2lmaWVkU2NhbGVzID0gdGhpcy5pbml0U2NhbGVzKG1hcmssIGVuY29kaW5nKTtcblxuICAgIHRoaXMuc3BlY2lmaWVkQXhlcyA9IHRoaXMuaW5pdEF4ZXMoZW5jb2RpbmcpO1xuICAgIHRoaXMuc3BlY2lmaWVkTGVnZW5kcyA9IHRoaXMuaW5pdExlZ2VuZChlbmNvZGluZyk7XG4gICAgdGhpcy5zcGVjaWZpZWRQcm9qZWN0aW9uID0gc3BlYy5wcm9qZWN0aW9uO1xuXG4gICAgLy8gU2VsZWN0aW9ucyB3aWxsIGJlIGluaXRpYWxpemVkIHVwb24gcGFyc2UuXG4gICAgdGhpcy5zZWxlY3Rpb24gPSBzcGVjLnNlbGVjdGlvbjtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgaGFzUHJvamVjdGlvbigpOiBib29sZWFuIHtcbiAgICBjb25zdCB7ZW5jb2Rpbmd9ID0gdGhpcztcbiAgICBjb25zdCBpc0dlb1NoYXBlTWFyayA9IHRoaXMubWFyayA9PT0gR0VPU0hBUEU7XG4gICAgY29uc3QgaGFzR2VvUG9zaXRpb24gPSBlbmNvZGluZyAmJiBHRU9QT1NJVElPTl9DSEFOTkVMUy5zb21lKFxuICAgICAgY2hhbm5lbCA9PiBpc0ZpZWxkRGVmKGVuY29kaW5nW2NoYW5uZWxdKVxuICAgICk7XG4gICAgcmV0dXJuIGlzR2VvU2hhcGVNYXJrIHx8IGhhc0dlb1Bvc2l0aW9uO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiBzcGVjaWZpZWQgVmVnYS1saXRlIHNjYWxlIGRvbWFpbiBmb3IgYSBwYXJ0aWN1bGFyIGNoYW5uZWxcbiAgICogQHBhcmFtIGNoYW5uZWxcbiAgICovXG4gIHB1YmxpYyBzY2FsZURvbWFpbihjaGFubmVsOiBTY2FsZUNoYW5uZWwpOiBEb21haW4ge1xuICAgIGNvbnN0IHNjYWxlID0gdGhpcy5zcGVjaWZpZWRTY2FsZXNbY2hhbm5lbF07XG4gICAgcmV0dXJuIHNjYWxlID8gc2NhbGUuZG9tYWluIDogdW5kZWZpbmVkO1xuICB9XG5cbiAgcHVibGljIGF4aXMoY2hhbm5lbDogQ2hhbm5lbCk6IEF4aXMge1xuICAgIHJldHVybiB0aGlzLnNwZWNpZmllZEF4ZXNbY2hhbm5lbF07XG4gIH1cblxuICBwdWJsaWMgbGVnZW5kKGNoYW5uZWw6IENoYW5uZWwpOiBMZWdlbmQge1xuICAgIHJldHVybiB0aGlzLnNwZWNpZmllZExlZ2VuZHNbY2hhbm5lbF07XG4gIH1cblxuICBwcml2YXRlIGluaXRTY2FsZXMobWFyazogTWFyaywgZW5jb2Rpbmc6IEVuY29kaW5nPHN0cmluZz4pOiBTY2FsZUluZGV4IHtcbiAgICByZXR1cm4gU0NBTEVfQ0hBTk5FTFMucmVkdWNlKChzY2FsZXMsIGNoYW5uZWwpID0+IHtcbiAgICAgIGxldCBmaWVsZERlZjogRmllbGREZWY8c3RyaW5nPjtcbiAgICAgIGxldCBzcGVjaWZpZWRTY2FsZTogU2NhbGU7XG5cbiAgICAgIGNvbnN0IGNoYW5uZWxEZWYgPSBlbmNvZGluZ1tjaGFubmVsXTtcblxuICAgICAgaWYgKGlzRmllbGREZWYoY2hhbm5lbERlZikpIHtcbiAgICAgICAgZmllbGREZWYgPSBjaGFubmVsRGVmO1xuICAgICAgICBzcGVjaWZpZWRTY2FsZSA9IGNoYW5uZWxEZWYuc2NhbGU7XG4gICAgICB9IGVsc2UgaWYgKGhhc0NvbmRpdGlvbmFsRmllbGREZWYoY2hhbm5lbERlZikpIHtcbiAgICAgICAgZmllbGREZWYgPSBjaGFubmVsRGVmLmNvbmRpdGlvbjtcbiAgICAgICAgc3BlY2lmaWVkU2NhbGUgPSBjaGFubmVsRGVmLmNvbmRpdGlvblsnc2NhbGUnXTtcbiAgICAgIH0gZWxzZSBpZiAoY2hhbm5lbCA9PT0gJ3gnKSB7XG4gICAgICAgIGZpZWxkRGVmID0gZ2V0RmllbGREZWYoZW5jb2RpbmcueDIpO1xuICAgICAgfSBlbHNlIGlmIChjaGFubmVsID09PSAneScpIHtcbiAgICAgICAgZmllbGREZWYgPSBnZXRGaWVsZERlZihlbmNvZGluZy55Mik7XG4gICAgICB9XG5cbiAgICAgIGlmIChmaWVsZERlZikge1xuICAgICAgICBzY2FsZXNbY2hhbm5lbF0gPSBzcGVjaWZpZWRTY2FsZSB8fCB7fTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBzY2FsZXM7XG4gICAgfSwge30gYXMgU2NhbGVJbmRleCk7XG4gIH1cblxuICBwcml2YXRlIGluaXRBeGVzKGVuY29kaW5nOiBFbmNvZGluZzxzdHJpbmc+KTogQXhpc0luZGV4IHtcbiAgICByZXR1cm4gW1gsIFldLnJlZHVjZShmdW5jdGlvbihfYXhpcywgY2hhbm5lbCkge1xuICAgICAgLy8gUG9zaXRpb24gQXhpc1xuXG4gICAgICAvLyBUT0RPOiBoYW5kbGUgQ29uZGl0aW9uRmllbGREZWZcbiAgICAgIGNvbnN0IGNoYW5uZWxEZWYgPSBlbmNvZGluZ1tjaGFubmVsXTtcbiAgICAgIGlmIChpc0ZpZWxkRGVmKGNoYW5uZWxEZWYpIHx8XG4gICAgICAgICAgKGNoYW5uZWwgPT09IFggJiYgaXNGaWVsZERlZihlbmNvZGluZy54MikpIHx8XG4gICAgICAgICAgKGNoYW5uZWwgPT09IFkgJiYgaXNGaWVsZERlZihlbmNvZGluZy55MikpKSB7XG5cbiAgICAgICAgY29uc3QgYXhpc1NwZWMgPSBpc0ZpZWxkRGVmKGNoYW5uZWxEZWYpID8gY2hhbm5lbERlZi5heGlzIDogbnVsbDtcblxuICAgICAgICAvLyBXZSBubyBsb25nZXIgc3VwcG9ydCBmYWxzZSBpbiB0aGUgc2NoZW1hLCBidXQgd2Uga2VlcCBmYWxzZSBoZXJlIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5LlxuICAgICAgICBpZiAoYXhpc1NwZWMgIT09IG51bGwgJiYgYXhpc1NwZWMgIT09IGZhbHNlKSB7XG4gICAgICAgICAgX2F4aXNbY2hhbm5lbF0gPSB7XG4gICAgICAgICAgICAuLi5heGlzU3BlY1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBfYXhpcztcbiAgICB9LCB7fSk7XG4gIH1cblxuICBwcml2YXRlIGluaXRMZWdlbmQoZW5jb2Rpbmc6IEVuY29kaW5nPHN0cmluZz4pOiBMZWdlbmRJbmRleCB7XG4gICAgcmV0dXJuIE5PTlBPU0lUSU9OX1NDQUxFX0NIQU5ORUxTLnJlZHVjZShmdW5jdGlvbihfbGVnZW5kLCBjaGFubmVsKSB7XG4gICAgICBjb25zdCBjaGFubmVsRGVmID0gZW5jb2RpbmdbY2hhbm5lbF07XG4gICAgICBpZiAoY2hhbm5lbERlZikge1xuICAgICAgICBjb25zdCBsZWdlbmQgPSBpc0ZpZWxkRGVmKGNoYW5uZWxEZWYpID8gY2hhbm5lbERlZi5sZWdlbmQgOlxuICAgICAgICAgIChoYXNDb25kaXRpb25hbEZpZWxkRGVmKGNoYW5uZWxEZWYpKSA/IGNoYW5uZWxEZWYuY29uZGl0aW9uWydsZWdlbmQnXSA6IG51bGw7XG5cbiAgICAgICAgaWYgKGxlZ2VuZCAhPT0gbnVsbCAmJiBsZWdlbmQgIT09IGZhbHNlKSB7XG4gICAgICAgICAgX2xlZ2VuZFtjaGFubmVsXSA9IHsuLi5sZWdlbmR9O1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBfbGVnZW5kO1xuICAgIH0sIHt9KTtcbiAgfVxuXG4gIHB1YmxpYyBwYXJzZURhdGEoKSB7XG4gICAgdGhpcy5jb21wb25lbnQuZGF0YSA9IHBhcnNlRGF0YSh0aGlzKTtcbiAgfVxuXG4gIHB1YmxpYyBwYXJzZUxheW91dFNpemUoKSB7XG4gICAgcGFyc2VVbml0TGF5b3V0U2l6ZSh0aGlzKTtcbiAgfVxuXG4gIHB1YmxpYyBwYXJzZVNlbGVjdGlvbigpIHtcbiAgICB0aGlzLmNvbXBvbmVudC5zZWxlY3Rpb24gPSBwYXJzZVVuaXRTZWxlY3Rpb24odGhpcywgdGhpcy5zZWxlY3Rpb24pO1xuICB9XG5cbiAgcHVibGljIHBhcnNlTWFya0dyb3VwKCkge1xuICAgIHRoaXMuY29tcG9uZW50Lm1hcmsgPSBwYXJzZU1hcmtHcm91cCh0aGlzKTtcbiAgfVxuXG4gIHB1YmxpYyBwYXJzZUF4aXNBbmRIZWFkZXIoKSB7XG4gICAgdGhpcy5jb21wb25lbnQuYXhlcyA9IHBhcnNlVW5pdEF4aXModGhpcyk7XG4gIH1cblxuICBwdWJsaWMgYXNzZW1ibGVTZWxlY3Rpb25Ub3BMZXZlbFNpZ25hbHMoc2lnbmFsczogYW55W10pOiBWZ1NpZ25hbFtdIHtcbiAgICByZXR1cm4gYXNzZW1ibGVUb3BMZXZlbFNpZ25hbHModGhpcywgc2lnbmFscyk7XG4gIH1cblxuICBwdWJsaWMgYXNzZW1ibGVTZWxlY3Rpb25TaWduYWxzKCk6IFZnU2lnbmFsW10ge1xuICAgIHJldHVybiBhc3NlbWJsZVVuaXRTZWxlY3Rpb25TaWduYWxzKHRoaXMsIFtdKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3NlbWJsZVNlbGVjdGlvbkRhdGEoZGF0YTogVmdEYXRhW10pOiBWZ0RhdGFbXSB7XG4gICAgcmV0dXJuIGFzc2VtYmxlVW5pdFNlbGVjdGlvbkRhdGEodGhpcywgZGF0YSk7XG4gIH1cblxuICBwdWJsaWMgYXNzZW1ibGVMYXlvdXQoKTogVmdMYXlvdXQge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcHVibGljIGFzc2VtYmxlTGF5b3V0U2lnbmFscygpOiBWZ1NpZ25hbFtdIHtcbiAgICByZXR1cm4gYXNzZW1ibGVMYXlvdXRTaWduYWxzKHRoaXMpO1xuICB9XG5cbiAgcHVibGljIGFzc2VtYmxlTWFya3MoKSB7XG4gICAgbGV0IG1hcmtzID0gdGhpcy5jb21wb25lbnQubWFyayB8fCBbXTtcblxuICAgIC8vIElmIHRoaXMgdW5pdCBpcyBwYXJ0IG9mIGEgbGF5ZXIsIHNlbGVjdGlvbnMgc2hvdWxkIGF1Z21lbnRcbiAgICAvLyBhbGwgaW4gY29uY2VydCByYXRoZXIgdGhhbiBlYWNoIHVuaXQgaW5kaXZpZHVhbGx5LiBUaGlzXG4gICAgLy8gZW5zdXJlcyBjb3JyZWN0IGludGVybGVhdmluZyBvZiBjbGlwcGluZyBhbmQgYnJ1c2hlZCBtYXJrcy5cbiAgICBpZiAoIXRoaXMucGFyZW50IHx8ICFpc0xheWVyTW9kZWwodGhpcy5wYXJlbnQpKSB7XG4gICAgICBtYXJrcyA9IGFzc2VtYmxlVW5pdFNlbGVjdGlvbk1hcmtzKHRoaXMsIG1hcmtzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbWFya3MubWFwKHRoaXMuY29ycmVjdERhdGFOYW1lcyk7XG4gIH1cblxuICBwdWJsaWMgYXNzZW1ibGVMYXlvdXRTaXplKCk6IFZnRW5jb2RlRW50cnkge1xuICAgIHJldHVybiB7XG4gICAgICB3aWR0aDogdGhpcy5nZXRTaXplU2lnbmFsUmVmKCd3aWR0aCcpLFxuICAgICAgaGVpZ2h0OiB0aGlzLmdldFNpemVTaWduYWxSZWYoJ2hlaWdodCcpXG4gICAgfTtcbiAgfVxuXG4gIHByb3RlY3RlZCBnZXRNYXBwaW5nKCkge1xuICAgIHJldHVybiB0aGlzLmVuY29kaW5nO1xuICB9XG5cbiAgcHVibGljIHRvU3BlYyhleGNsdWRlQ29uZmlnPzogYW55LCBleGNsdWRlRGF0YT86IGFueSkge1xuICAgIGNvbnN0IGVuY29kaW5nID0gZHVwbGljYXRlKHRoaXMuZW5jb2RpbmcpO1xuICAgIGxldCBzcGVjOiBhbnk7XG5cbiAgICBzcGVjID0ge1xuICAgICAgbWFyazogdGhpcy5tYXJrRGVmLFxuICAgICAgZW5jb2Rpbmc6IGVuY29kaW5nXG4gICAgfTtcblxuICAgIGlmICghZXhjbHVkZUNvbmZpZykge1xuICAgICAgc3BlYy5jb25maWcgPSBkdXBsaWNhdGUodGhpcy5jb25maWcpO1xuICAgIH1cblxuICAgIGlmICghZXhjbHVkZURhdGEpIHtcbiAgICAgIHNwZWMuZGF0YSA9IGR1cGxpY2F0ZSh0aGlzLmRhdGEpO1xuICAgIH1cblxuICAgIC8vIHJlbW92ZSBkZWZhdWx0c1xuICAgIHJldHVybiBzcGVjO1xuICB9XG5cbiAgcHVibGljIGdldCBtYXJrKCk6IE1hcmsge1xuICAgIHJldHVybiB0aGlzLm1hcmtEZWYudHlwZTtcbiAgfVxuXG4gIHB1YmxpYyBjaGFubmVsSGFzRmllbGQoY2hhbm5lbDogQ2hhbm5lbCkge1xuICAgIHJldHVybiB2bEVuY29kaW5nLmNoYW5uZWxIYXNGaWVsZCh0aGlzLmVuY29kaW5nLCBjaGFubmVsKTtcbiAgfVxuXG4gIHB1YmxpYyBmaWVsZERlZihjaGFubmVsOiBTaW5nbGVEZWZDaGFubmVsKTogRmllbGREZWY8c3RyaW5nPiB7XG4gICAgY29uc3QgY2hhbm5lbERlZiA9IHRoaXMuZW5jb2RpbmdbY2hhbm5lbF0gYXMgQ2hhbm5lbERlZjxzdHJpbmc+O1xuICAgIHJldHVybiBnZXRGaWVsZERlZihjaGFubmVsRGVmKTtcbiAgfVxufVxuIl19","import * as tslib_1 from \"tslib\";\nimport * as log from '../log';\nimport { isLayerSpec, isUnitSpec } from '../spec';\nimport { flatten, keys } from '../util';\nimport { parseLayerAxis } from './axis/parse';\nimport { parseData } from './data/parse';\nimport { assembleLayoutSignals } from './layoutsize/assemble';\nimport { parseLayerLayoutSize } from './layoutsize/parse';\nimport { assembleLegends } from './legend/assemble';\nimport { Model } from './model';\nimport { assembleLayerSelectionMarks } from './selection/selection';\nimport { UnitModel } from './unit';\nvar LayerModel = /** @class */ (function (_super) {\n    tslib_1.__extends(LayerModel, _super);\n    function LayerModel(spec, parent, parentGivenName, parentGivenSize, repeater, config, fit) {\n        var _this = _super.call(this, spec, parent, parentGivenName, config, repeater, spec.resolve) || this;\n        _this.type = 'layer';\n        var layoutSize = tslib_1.__assign({}, parentGivenSize, (spec.width ? { width: spec.width } : {}), (spec.height ? { height: spec.height } : {}));\n        _this.initSize(layoutSize);\n        _this.children = spec.layer.map(function (layer, i) {\n            if (isLayerSpec(layer)) {\n                return new LayerModel(layer, _this, _this.getName('layer_' + i), layoutSize, repeater, config, fit);\n            }\n            if (isUnitSpec(layer)) {\n                return new UnitModel(layer, _this, _this.getName('layer_' + i), layoutSize, repeater, config, fit);\n            }\n            throw new Error(log.message.INVALID_SPEC);\n        });\n        return _this;\n    }\n    LayerModel.prototype.parseData = function () {\n        this.component.data = parseData(this);\n        for (var _i = 0, _a = this.children; _i < _a.length; _i++) {\n            var child = _a[_i];\n            child.parseData();\n        }\n    };\n    LayerModel.prototype.parseLayoutSize = function () {\n        parseLayerLayoutSize(this);\n    };\n    LayerModel.prototype.parseSelection = function () {\n        var _this = this;\n        // Merge selections up the hierarchy so that they may be referenced\n        // across unit specs. Persist their definitions within each child\n        // to assemble signals which remain within output Vega unit groups.\n        this.component.selection = {};\n        var _loop_1 = function (child) {\n            child.parseSelection();\n            keys(child.component.selection).forEach(function (key) {\n                _this.component.selection[key] = child.component.selection[key];\n            });\n        };\n        for (var _i = 0, _a = this.children; _i < _a.length; _i++) {\n            var child = _a[_i];\n            _loop_1(child);\n        }\n    };\n    LayerModel.prototype.parseMarkGroup = function () {\n        for (var _i = 0, _a = this.children; _i < _a.length; _i++) {\n            var child = _a[_i];\n            child.parseMarkGroup();\n        }\n    };\n    LayerModel.prototype.parseAxisAndHeader = function () {\n        parseLayerAxis(this);\n    };\n    LayerModel.prototype.assembleSelectionTopLevelSignals = function (signals) {\n        return this.children.reduce(function (sg, child) { return child.assembleSelectionTopLevelSignals(sg); }, signals);\n    };\n    // TODO: Support same named selections across children.\n    LayerModel.prototype.assembleSelectionSignals = function () {\n        return this.children.reduce(function (signals, child) {\n            return signals.concat(child.assembleSelectionSignals());\n        }, []);\n    };\n    LayerModel.prototype.assembleLayoutSignals = function () {\n        return this.children.reduce(function (signals, child) {\n            return signals.concat(child.assembleLayoutSignals());\n        }, assembleLayoutSignals(this));\n    };\n    LayerModel.prototype.assembleSelectionData = function (data) {\n        return this.children.reduce(function (db, child) { return child.assembleSelectionData(db); }, data);\n    };\n    LayerModel.prototype.assembleTitle = function () {\n        var title = _super.prototype.assembleTitle.call(this);\n        if (title) {\n            return title;\n        }\n        // If title does not provide layer, look into children\n        for (var _i = 0, _a = this.children; _i < _a.length; _i++) {\n            var child = _a[_i];\n            title = child.assembleTitle();\n            if (title) {\n                return title;\n            }\n        }\n        return undefined;\n    };\n    LayerModel.prototype.assembleLayout = function () {\n        return null;\n    };\n    LayerModel.prototype.assembleMarks = function () {\n        return assembleLayerSelectionMarks(this, flatten(this.children.map(function (child) {\n            return child.assembleMarks();\n        })));\n    };\n    LayerModel.prototype.assembleLegends = function () {\n        return this.children.reduce(function (legends, child) {\n            return legends.concat(child.assembleLegends());\n        }, assembleLegends(this));\n    };\n    return LayerModel;\n}(Model));\nexport { LayerModel };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGF5ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29tcGlsZS9sYXllci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQ0EsT0FBTyxLQUFLLEdBQUcsTUFBTSxRQUFRLENBQUM7QUFDOUIsT0FBTyxFQUFDLFdBQVcsRUFBRSxVQUFVLEVBQXdDLE1BQU0sU0FBUyxDQUFDO0FBQ3ZGLE9BQU8sRUFBQyxPQUFPLEVBQUUsSUFBSSxFQUFDLE1BQU0sU0FBUyxDQUFDO0FBRXRDLE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSxjQUFjLENBQUM7QUFDNUMsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLGNBQWMsQ0FBQztBQUN2QyxPQUFPLEVBQUMscUJBQXFCLEVBQUMsTUFBTSx1QkFBdUIsQ0FBQztBQUM1RCxPQUFPLEVBQUMsb0JBQW9CLEVBQUMsTUFBTSxvQkFBb0IsQ0FBQztBQUN4RCxPQUFPLEVBQUMsZUFBZSxFQUFDLE1BQU0sbUJBQW1CLENBQUM7QUFDbEQsT0FBTyxFQUFDLEtBQUssRUFBQyxNQUFNLFNBQVMsQ0FBQztBQUU5QixPQUFPLEVBQUMsMkJBQTJCLEVBQUMsTUFBTSx1QkFBdUIsQ0FBQztBQUNsRSxPQUFPLEVBQUMsU0FBUyxFQUFDLE1BQU0sUUFBUSxDQUFDO0FBR2pDO0lBQWdDLHNDQUFLO0lBU25DLG9CQUFZLElBQXlCLEVBQUUsTUFBYSxFQUFFLGVBQXVCLEVBQzNFLGVBQWlDLEVBQUUsUUFBdUIsRUFBRSxNQUFjLEVBQUUsR0FBWTtRQUQxRixZQUdFLGtCQUFNLElBQUksRUFBRSxNQUFNLEVBQUUsZUFBZSxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxTQXFCckU7UUFoQ2UsVUFBSSxHQUFZLE9BQU8sQ0FBQztRQWF0QyxJQUFNLFVBQVUsd0JBQ1gsZUFBZSxFQUNmLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBQyxLQUFLLEVBQUUsSUFB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O1FBQ0QsT0FBTyxTQUFTLENBQUM7SUFDbkIsQ0FBQztJQUVNLG1DQUFjLEdBQXJCO1FBQ0UsT0FBTyxJQUFJLENBQUM7SUFDZCxDQUFDO0lBRU0sa0NBQWEsR0FBcEI7UUFDRSxPQUFPLDJCQUEyQixDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsVUFBQyxLQUFLO1lBQ3ZFLE9BQU8sS0FBSyxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQy9CLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7SUFFTSxvQ0FBZSxHQUF0QjtRQUNFLE9BQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsVUFBQyxPQUFPLEVBQUUsS0FBSztZQUN6QyxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLGVBQWUsRUFBRSxDQUFDLENBQUM7UUFDakQsQ0FBQyxFQUFFLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQzVCLENBQUM7SUFDSCxpQkFBQztBQUFELENBQUMsQUF6SEQsQ0FBZ0MsS0FBSyxHQXlIcEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NvbmZpZ30gZnJvbSAnLi4vY29uZmlnJztcbmltcG9ydCAqIGFzIGxvZyBmcm9tICcuLi9sb2cnO1xuaW1wb3J0IHtpc0xheWVyU3BlYywgaXNVbml0U3BlYywgTGF5b3V0U2l6ZU1peGlucywgTm9ybWFsaXplZExheWVyU3BlY30gZnJvbSAnLi4vc3BlYyc7XG5pbXBvcnQge2ZsYXR0ZW4sIGtleXN9IGZyb20gJy4uL3V0aWwnO1xuaW1wb3J0IHtWZ0RhdGEsIFZnTGF5b3V0LCBWZ0xlZ2VuZCwgVmdTaWduYWwsIFZnVGl0bGV9IGZyb20gJy4uL3ZlZ2Euc2NoZW1hJztcbmltcG9ydCB7cGFyc2VMYXllckF4aXN9IGZyb20gJy4vYXhpcy9wYXJzZSc7XG5pbXBvcnQge3BhcnNlRGF0YX0gZnJvbSAnLi9kYXRhL3BhcnNlJztcbmltcG9ydCB7YXNzZW1ibGVMYXlvdXRTaWduYWxzfSBmcm9tICcuL2xheW91dHNpemUvYXNzZW1ibGUnO1xuaW1wb3J0IHtwYXJzZUxheWVyTGF5b3V0U2l6ZX0gZnJvbSAnLi9sYXlvdXRzaXplL3BhcnNlJztcbmltcG9ydCB7YXNzZW1ibGVMZWdlbmRzfSBmcm9tICcuL2xlZ2VuZC9hc3NlbWJsZSc7XG5pbXBvcnQge01vZGVsfSBmcm9tICcuL21vZGVsJztcbmltcG9ydCB7UmVwZWF0ZXJWYWx1ZX0gZnJvbSAnLi9yZXBlYXRlcic7XG5pbXBvcnQge2Fzc2VtYmxlTGF5ZXJTZWxlY3Rpb25NYXJrc30gZnJvbSAnLi9zZWxlY3Rpb24vc2VsZWN0aW9uJztcbmltcG9ydCB7VW5pdE1vZGVsfSBmcm9tICcuL3VuaXQnO1xuXG5cbmV4cG9ydCBjbGFzcyBMYXllck1vZGVsIGV4dGVuZHMgTW9kZWwge1xuICBwdWJsaWMgcmVhZG9ubHkgdHlwZTogJ2xheWVyJyA9ICdsYXllcic7XG5cbiAgLy8gSEFDSzogVGhpcyBzaG91bGQgYmUgKExheWVyTW9kZWwgfCBVbml0TW9kZWwpW10sIGJ1dCBzZXR0aW5nIHRoZSBjb3JyZWN0IHR5cGUgbGVhZHMgdG8gd2VpcmQgZXJyb3IuXG4gIC8vIFNvIEknbSBqdXN0IHB1dHRpbmcgZ2VuZXJpYyBNb2RlbCBmb3Igbm93LlxuICBwdWJsaWMgcmVhZG9ubHkgY2hpbGRyZW46IE1vZGVsW107XG5cblxuXG4gIGNvbnN0cnVjdG9yKHNwZWM6IE5vcm1hbGl6ZWRMYXllclNwZWMsIHBhcmVudDogTW9kZWwsIHBhcmVudEdpdmVuTmFtZTogc3RyaW5nLFxuICAgIHBhcmVudEdpdmVuU2l6ZTogTGF5b3V0U2l6ZU1peGlucywgcmVwZWF0ZXI6IFJlcGVhdGVyVmFsdWUsIGNvbmZpZzogQ29uZmlnLCBmaXQ6IGJvb2xlYW4pIHtcblxuICAgIHN1cGVyKHNwZWMsIHBhcmVudCwgcGFyZW50R2l2ZW5OYW1lLCBjb25maWcsIHJlcGVhdGVyLCBzcGVjLnJlc29sdmUpO1xuXG4gICAgY29uc3QgbGF5b3V0U2l6ZSA9IHtcbiAgICAgIC4uLnBhcmVudEdpdmVuU2l6ZSxcbiAgICAgIC4uLihzcGVjLndpZHRoID8ge3dpZHRoOiBzcGVjLndpZHRofSA6IHt9KSxcbiAgICAgIC4uLihzcGVjLmhlaWdodCA/IHtoZWlnaHQ6IHNwZWMuaGVpZ2h0fSA6IHt9KVxuICAgIH07XG5cbiAgICB0aGlzLmluaXRTaXplKGxheW91dFNpemUpO1xuXG4gICAgdGhpcy5jaGlsZHJlbiA9IHNwZWMubGF5ZXIubWFwKChsYXllciwgaSkgPT4ge1xuICAgICAgaWYgKGlzTGF5ZXJTcGVjKGxheWVyKSkge1xuICAgICAgICByZXR1cm4gbmV3IExheWVyTW9kZWwobGF5ZXIsIHRoaXMsIHRoaXMuZ2V0TmFtZSgnbGF5ZXJfJytpKSwgbGF5b3V0U2l6ZSwgcmVwZWF0ZXIsIGNvbmZpZywgZml0KTtcbiAgICAgIH1cblxuICAgICAgaWYgKGlzVW5pdFNwZWMobGF5ZXIpKSB7XG4gICAgICAgIHJldHVybiBuZXcgVW5pdE1vZGVsKGxheWVyLCB0aGlzLCB0aGlzLmdldE5hbWUoJ2xheWVyXycraSksIGxheW91dFNpemUsIHJlcGVhdGVyLCBjb25maWcsIGZpdCk7XG4gICAgICB9XG5cbiAgICAgIHRocm93IG5ldyBFcnJvcihsb2cubWVzc2FnZS5JTlZBTElEX1NQRUMpO1xuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIHBhcnNlRGF0YSgpIHtcbiAgICB0aGlzLmNvbXBvbmVudC5kYXRhID0gcGFyc2VEYXRhKHRoaXMpO1xuICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpcy5jaGlsZHJlbikge1xuICAgICAgY2hpbGQucGFyc2VEYXRhKCk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHBhcnNlTGF5b3V0U2l6ZSgpIHtcbiAgICBwYXJzZUxheWVyTGF5b3V0U2l6ZSh0aGlzKTtcbiAgfVxuXG4gIHB1YmxpYyBwYXJzZVNlbGVjdGlvbigpIHtcbiAgICAvLyBNZXJnZSBzZWxlY3Rpb25zIHVwIHRoZSBoaWVyYXJjaHkgc28gdGhhdCB0aGV5IG1heSBiZSByZWZlcmVuY2VkXG4gICAgLy8gYWNyb3NzIHVuaXQgc3BlY3MuIFBlcnNpc3QgdGhlaXIgZGVmaW5pdGlvbnMgd2l0aGluIGVhY2ggY2hpbGRcbiAgICAvLyB0byBhc3NlbWJsZSBzaWduYWxzIHdoaWNoIHJlbWFpbiB3aXRoaW4gb3V0cHV0IFZlZ2EgdW5pdCBncm91cHMuXG4gICAgdGhpcy5jb21wb25lbnQuc2VsZWN0aW9uID0ge307XG4gICAgZm9yIChjb25zdCBjaGlsZCBvZiB0aGlzLmNoaWxkcmVuKSB7XG4gICAgICBjaGlsZC5wYXJzZVNlbGVjdGlvbigpO1xuICAgICAga2V5cyhjaGlsZC5jb21wb25lbnQuc2VsZWN0aW9uKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgdGhpcy5jb21wb25lbnQuc2VsZWN0aW9uW2tleV0gPSBjaGlsZC5jb21wb25lbnQuc2VsZWN0aW9uW2tleV07XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgcGFyc2VNYXJrR3JvdXAoKSB7XG4gICAgZm9yIChjb25zdCBjaGlsZCBvZiB0aGlzLmNoaWxkcmVuKSB7XG4gICAgICBjaGlsZC5wYXJzZU1hcmtHcm91cCgpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBwYXJzZUF4aXNBbmRIZWFkZXIoKSB7XG4gICAgcGFyc2VMYXllckF4aXModGhpcyk7XG4gIH1cblxuICBwdWJsaWMgYXNzZW1ibGVTZWxlY3Rpb25Ub3BMZXZlbFNpZ25hbHMoc2lnbmFsczogYW55W10pOiBWZ1NpZ25hbFtdIHtcbiAgICByZXR1cm4gdGhpcy5jaGlsZHJlbi5yZWR1Y2UoKHNnLCBjaGlsZCkgPT4gY2hpbGQuYXNzZW1ibGVTZWxlY3Rpb25Ub3BMZXZlbFNpZ25hbHMoc2cpLCBzaWduYWxzKTtcbiAgfVxuXG4gIC8vIFRPRE86IFN1cHBvcnQgc2FtZSBuYW1lZCBzZWxlY3Rpb25zIGFjcm9zcyBjaGlsZHJlbi5cbiAgcHVibGljIGFzc2VtYmxlU2VsZWN0aW9uU2lnbmFscygpOiBWZ1NpZ25hbFtdIHtcbiAgICByZXR1cm4gdGhpcy5jaGlsZHJlbi5yZWR1Y2UoKHNpZ25hbHMsIGNoaWxkKSA9PiB7XG4gICAgICByZXR1cm4gc2lnbmFscy5jb25jYXQoY2hpbGQuYXNzZW1ibGVTZWxlY3Rpb25TaWduYWxzKCkpO1xuICAgIH0sIFtdKTtcbiAgfVxuXG5cbiAgcHVibGljIGFzc2VtYmxlTGF5b3V0U2lnbmFscygpOiBWZ1NpZ25hbFtdIHtcbiAgICByZXR1cm4gdGhpcy5jaGlsZHJlbi5yZWR1Y2UoKHNpZ25hbHMsIGNoaWxkKSA9PiB7XG4gICAgICByZXR1cm4gc2lnbmFscy5jb25jYXQoY2hpbGQuYXNzZW1ibGVMYXlvdXRTaWduYWxzKCkpO1xuICAgIH0sIGFzc2VtYmxlTGF5b3V0U2lnbmFscyh0aGlzKSk7XG4gIH1cblxuICBwdWJsaWMgYXNzZW1ibGVTZWxlY3Rpb25EYXRhKGRhdGE6IFZnRGF0YVtdKTogVmdEYXRhW10ge1xuICAgIHJldHVybiB0aGlzLmNoaWxkcmVuLnJlZHVjZSgoZGIsIGNoaWxkKSA9PiBjaGlsZC5hc3NlbWJsZVNlbGVjdGlvbkRhdGEoZGIpLCBkYXRhKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3NlbWJsZVRpdGxlKCk6IFZnVGl0bGUge1xuICAgIGxldCB0aXRsZSA9IHN1cGVyLmFzc2VtYmxlVGl0bGUoKTtcbiAgICBpZiAodGl0bGUpIHtcbiAgICAgIHJldHVybiB0aXRsZTtcbiAgICB9XG4gICAgLy8gSWYgdGl0bGUgZG9lcyBub3QgcHJvdmlkZSBsYXllciwgbG9vayBpbnRvIGNoaWxkcmVuXG4gICAgZm9yIChjb25zdCBjaGlsZCBvZiB0aGlzLmNoaWxkcmVuKSB7XG4gICAgICB0aXRsZSA9IGNoaWxkLmFzc2VtYmxlVGl0bGUoKTtcbiAgICAgIGlmICh0aXRsZSkge1xuICAgICAgICByZXR1cm4gdGl0bGU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICBwdWJsaWMgYXNzZW1ibGVMYXlvdXQoKTogVmdMYXlvdXQge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcHVibGljIGFzc2VtYmxlTWFya3MoKTogYW55W10ge1xuICAgIHJldHVybiBhc3NlbWJsZUxheWVyU2VsZWN0aW9uTWFya3ModGhpcywgZmxhdHRlbih0aGlzLmNoaWxkcmVuLm1hcCgoY2hpbGQpID0+IHtcbiAgICAgIHJldHVybiBjaGlsZC5hc3NlbWJsZU1hcmtzKCk7XG4gICAgfSkpKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3NlbWJsZUxlZ2VuZHMoKTogVmdMZWdlbmRbXSB7XG4gICAgcmV0dXJuIHRoaXMuY2hpbGRyZW4ucmVkdWNlKChsZWdlbmRzLCBjaGlsZCkgPT4ge1xuICAgICAgcmV0dXJuIGxlZ2VuZHMuY29uY2F0KGNoaWxkLmFzc2VtYmxlTGVnZW5kcygpKTtcbiAgICB9LCBhc3NlbWJsZUxlZ2VuZHModGhpcykpO1xuICB9XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport * as log from '../log';\nimport { BaseConcatModel } from './baseconcat';\nimport { buildModel } from './buildmodel';\nimport { parseRepeatLayoutSize } from './layoutsize/parse';\nvar RepeatModel = /** @class */ (function (_super) {\n    tslib_1.__extends(RepeatModel, _super);\n    function RepeatModel(spec, parent, parentGivenName, repeatValues, config) {\n        var _this = _super.call(this, spec, parent, parentGivenName, config, repeatValues, spec.resolve) || this;\n        _this.type = 'repeat';\n        if (spec.resolve && spec.resolve.axis && (spec.resolve.axis.x === 'shared' || spec.resolve.axis.y === 'shared')) {\n            log.warn(log.message.REPEAT_CANNOT_SHARE_AXIS);\n        }\n        _this.repeat = spec.repeat;\n        _this.children = _this._initChildren(spec, _this.repeat, repeatValues, config);\n        return _this;\n    }\n    RepeatModel.prototype._initChildren = function (spec, repeat, repeater, config) {\n        var children = [];\n        var row = repeat.row || [repeater ? repeater.row : null];\n        var column = repeat.column || [repeater ? repeater.column : null];\n        // cross product\n        for (var _i = 0, row_1 = row; _i < row_1.length; _i++) {\n            var rowField = row_1[_i];\n            for (var _a = 0, column_1 = column; _a < column_1.length; _a++) {\n                var columnField = column_1[_a];\n                var name_1 = (rowField ? '_' + rowField : '') + (columnField ? '_' + columnField : '');\n                var childRepeat = {\n                    row: rowField,\n                    column: columnField\n                };\n                children.push(buildModel(spec.spec, this, this.getName('child' + name_1), undefined, childRepeat, config, false));\n            }\n        }\n        return children;\n    };\n    RepeatModel.prototype.parseLayoutSize = function () {\n        parseRepeatLayoutSize(this);\n    };\n    RepeatModel.prototype.assembleLayout = function () {\n        // TODO: allow customization\n        return {\n            padding: { row: 10, column: 10 },\n            offset: 10,\n            columns: this.repeat && this.repeat.column ? this.repeat.column.length : 1,\n            bounds: 'full',\n            align: 'all'\n        };\n    };\n    return RepeatModel;\n}(BaseConcatModel));\nexport { RepeatModel };\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVwZWF0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvbXBpbGUvcmVwZWF0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFFQSxPQUFPLEtBQUssR0FBRyxNQUFNLFFBQVEsQ0FBQztBQUk5QixPQUFPLEVBQUMsZUFBZSxFQUFDLE1BQU0sY0FBYyxDQUFDO0FBQzdDLE9BQU8sRUFBQyxVQUFVLEVBQUMsTUFBTSxjQUFjLENBQUM7QUFDeEMsT0FBTyxFQUFDLHFCQUFxQixFQUFDLE1BQU0sb0JBQW9CLENBQUM7QUFJekQ7SUFBaUMsdUNBQWU7SUFNOUMscUJBQVksSUFBMEIsRUFBRSxNQUFhLEVBQUUsZUFBdUIsRUFBRSxZQUEyQixFQUFFLE1BQWM7UUFBM0gsWUFDRSxrQkFBTSxJQUFJLEVBQUUsTUFBTSxFQUFFLGVBQWUsRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsU0FRekU7UUFkZSxVQUFJLEdBQWEsUUFBUSxDQUFDO1FBUXhDLElBQUksSUFBSSxDQUFDLE9BQU8sSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxRQUFRLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLFFBQVEsQ0FBQyxFQUFFO1lBQy9HLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO1NBQ2hEO1FBRUQsS0FBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDO1FBQzFCLEtBQUksQ0FBQyxRQUFRLEdBQUcsS0FBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLEVBQUUsS0FBSSxDQUFDLE1BQU0sRUFBRSxZQUFZLEVBQUUsTUFBTSxDQUFDLENBQUM7O0lBQzlFLENBQUM7SUFFTyxtQ0FBYSxHQUFyQixVQUFzQixJQUEwQixFQUFFLE1BQWMsRUFBRSxRQUF1QixFQUFFLE1BQWM7UUFDdkcsSUFBTSxRQUFRLEdBQVksRUFBRSxDQUFDO1FBQzdCLElBQU0sR0FBRyxHQUFHLE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzNELElBQU0sTUFBTSxHQUFHLE1BQU0sQ0FBQyxNQUFNLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBRXBFLGdCQUFnQjtRQUNoQixLQUF1QixVQUFHLEVBQUgsV0FBRyxFQUFILGlCQUFHLEVBQUgsSUFBRyxFQUFFO1lBQXZCLElBQU0sUUFBUSxZQUFBO1lBQ2pCLEtBQTBCLFVBQU0sRUFBTixpQkFBTSxFQUFOLG9CQUFNLEVBQU4sSUFBTSxFQUFFO2dCQUE3QixJQUFNLFdBQVcsZUFBQTtnQkFDcEIsSUFBTSxNQUFJLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsV0FBVyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztnQkFFdkYsSUFBTSxXQUFXLEdBQUc7b0JBQ2xCLEdBQUcsRUFBRSxRQUFRO29CQUNiLE1BQU0sRUFBRSxXQUFXO2lCQUNwQixDQUFDO2dCQUVGLFFBQVEsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxHQUFHLE1BQUksQ0FBQyxFQUFFLFNBQVMsRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUM7YUFDakg7U0FDRjtRQUVELE9BQU8sUUFBUSxDQUFDO0lBQ2xCLENBQUM7SUFFTSxxQ0FBZSxHQUF0QjtRQUNFLHFCQUFxQixDQUFDLElBQUksQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFTSxvQ0FBYyxHQUFyQjtRQUNFLDRCQUE0QjtRQUM1QixPQUFPO1lBQ0wsT0FBTyxFQUFFLEVBQUMsR0FBRyxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFDO1lBQzlCLE1BQU0sRUFBRSxFQUFFO1lBQ1YsT0FBTyxFQUFFLElBQUksQ0FBQyxNQUFNLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMxRSxNQUFNLEVBQUUsTUFBTTtZQUNkLEtBQUssRUFBRSxLQUFLO1NBQ2IsQ0FBQztJQUNKLENBQUM7SUFDSCxrQkFBQztBQUFELENBQUMsQUFyREQsQ0FBaUMsZUFBZSxHQXFEL0MiLCJzb3VyY2VzQ29udGVudCI6WyJcbmltcG9ydCB7Q29uZmlnfSBmcm9tICcuLi9jb25maWcnO1xuaW1wb3J0ICogYXMgbG9nIGZyb20gJy4uL2xvZyc7XG5pbXBvcnQge1JlcGVhdH0gZnJvbSAnLi4vcmVwZWF0JztcbmltcG9ydCB7Tm9ybWFsaXplZFJlcGVhdFNwZWN9IGZyb20gJy4uL3NwZWMnO1xuaW1wb3J0IHtWZ0xheW91dH0gZnJvbSAnLi4vdmVnYS5zY2hlbWEnO1xuaW1wb3J0IHtCYXNlQ29uY2F0TW9kZWx9IGZyb20gJy4vYmFzZWNvbmNhdCc7XG5pbXBvcnQge2J1aWxkTW9kZWx9IGZyb20gJy4vYnVpbGRtb2RlbCc7XG5pbXBvcnQge3BhcnNlUmVwZWF0TGF5b3V0U2l6ZX0gZnJvbSAnLi9sYXlvdXRzaXplL3BhcnNlJztcbmltcG9ydCB7TW9kZWx9IGZyb20gJy4vbW9kZWwnO1xuaW1wb3J0IHtSZXBlYXRlclZhbHVlfSBmcm9tICcuL3JlcGVhdGVyJztcblxuZXhwb3J0IGNsYXNzIFJlcGVhdE1vZGVsIGV4dGVuZHMgQmFzZUNvbmNhdE1vZGVsIHtcbiAgcHVibGljIHJlYWRvbmx5IHR5cGU6ICdyZXBlYXQnID0gJ3JlcGVhdCc7XG4gIHB1YmxpYyByZWFkb25seSByZXBlYXQ6IFJlcGVhdDtcblxuICBwdWJsaWMgcmVhZG9ubHkgY2hpbGRyZW46IE1vZGVsW107XG5cbiAgY29uc3RydWN0b3Ioc3BlYzogTm9ybWFsaXplZFJlcGVhdFNwZWMsIHBhcmVudDogTW9kZWwsIHBhcmVudEdpdmVuTmFtZTogc3RyaW5nLCByZXBlYXRWYWx1ZXM6IFJlcGVhdGVyVmFsdWUsIGNvbmZpZzogQ29uZmlnKSB7XG4gICAgc3VwZXIoc3BlYywgcGFyZW50LCBwYXJlbnRHaXZlbk5hbWUsIGNvbmZpZywgcmVwZWF0VmFsdWVzLCBzcGVjLnJlc29sdmUpO1xuXG4gICAgaWYgKHNwZWMucmVzb2x2ZSAmJiBzcGVjLnJlc29sdmUuYXhpcyAmJiAoc3BlYy5yZXNvbHZlLmF4aXMueCA9PT0gJ3NoYXJlZCcgfHwgc3BlYy5yZXNvbHZlLmF4aXMueSA9PT0gJ3NoYXJlZCcpKSB7XG4gICAgICBsb2cud2Fybihsb2cubWVzc2FnZS5SRVBFQVRfQ0FOTk9UX1NIQVJFX0FYSVMpO1xuICAgIH1cblxuICAgIHRoaXMucmVwZWF0ID0gc3BlYy5yZXBlYXQ7XG4gICAgdGhpcy5jaGlsZHJlbiA9IHRoaXMuX2luaXRDaGlsZHJlbihzcGVjLCB0aGlzLnJlcGVhdCwgcmVwZWF0VmFsdWVzLCBjb25maWcpO1xuICB9XG5cbiAgcHJpdmF0ZSBfaW5pdENoaWxkcmVuKHNwZWM6IE5vcm1hbGl6ZWRSZXBlYXRTcGVjLCByZXBlYXQ6IFJlcGVhdCwgcmVwZWF0ZXI6IFJlcGVhdGVyVmFsdWUsIGNvbmZpZzogQ29uZmlnKTogTW9kZWxbXSB7XG4gICAgY29uc3QgY2hpbGRyZW46IE1vZGVsW10gPSBbXTtcbiAgICBjb25zdCByb3cgPSByZXBlYXQucm93IHx8IFtyZXBlYXRlciA/IHJlcGVhdGVyLnJvdyA6IG51bGxdO1xuICAgIGNvbnN0IGNvbHVtbiA9IHJlcGVhdC5jb2x1bW4gfHwgW3JlcGVhdGVyID8gcmVwZWF0ZXIuY29sdW1uIDogbnVsbF07XG5cbiAgICAvLyBjcm9zcyBwcm9kdWN0XG4gICAgZm9yIChjb25zdCByb3dGaWVsZCBvZiByb3cpIHtcbiAgICAgIGZvciAoY29uc3QgY29sdW1uRmllbGQgb2YgY29sdW1uKSB7XG4gICAgICAgIGNvbnN0IG5hbWUgPSAocm93RmllbGQgPyAnXycgKyByb3dGaWVsZCA6ICcnKSArIChjb2x1bW5GaWVsZCA/ICdfJyArIGNvbHVtbkZpZWxkIDogJycpO1xuXG4gICAgICAgIGNvbnN0IGNoaWxkUmVwZWF0ID0ge1xuICAgICAgICAgIHJvdzogcm93RmllbGQsXG4gICAgICAgICAgY29sdW1uOiBjb2x1bW5GaWVsZFxuICAgICAgICB9O1xuXG4gICAgICAgIGNoaWxkcmVuLnB1c2goYnVpbGRNb2RlbChzcGVjLnNwZWMsIHRoaXMsIHRoaXMuZ2V0TmFtZSgnY2hpbGQnICsgbmFtZSksIHVuZGVmaW5lZCwgY2hpbGRSZXBlYXQsIGNvbmZpZywgZmFsc2UpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gY2hpbGRyZW47XG4gIH1cblxuICBwdWJsaWMgcGFyc2VMYXlvdXRTaXplKCkge1xuICAgIHBhcnNlUmVwZWF0TGF5b3V0U2l6ZSh0aGlzKTtcbiAgfVxuXG4gIHB1YmxpYyBhc3NlbWJsZUxheW91dCgpOiBWZ0xheW91dCB7XG4gICAgLy8gVE9ETzogYWxsb3cgY3VzdG9taXphdGlvblxuICAgIHJldHVybiB7XG4gICAgICBwYWRkaW5nOiB7cm93OiAxMCwgY29sdW1uOiAxMH0sXG4gICAgICBvZmZzZXQ6IDEwLFxuICAgICAgY29sdW1uczogdGhpcy5yZXBlYXQgJiYgdGhpcy5yZXBlYXQuY29sdW1uID8gdGhpcy5yZXBlYXQuY29sdW1uLmxlbmd0aCA6IDEsXG4gICAgICBib3VuZHM6ICdmdWxsJyxcbiAgICAgIGFsaWduOiAnYWxsJ1xuICAgIH07XG4gIH1cbn1cbiJdfQ==","import * as log from '../log';\nimport { isConcatSpec, isFacetSpec, isLayerSpec, isRepeatSpec, isUnitSpec } from '../spec';\nimport { ConcatModel } from './concat';\nimport { FacetModel } from './facet';\nimport { LayerModel } from './layer';\nimport { RepeatModel } from './repeat';\nimport { UnitModel } from './unit';\nexport function buildModel(spec, parent, parentGivenName, unitSize, repeater, config, fit) {\n    if (isFacetSpec(spec)) {\n        return new FacetModel(spec, parent, parentGivenName, repeater, config);\n    }\n    if (isLayerSpec(spec)) {\n        return new LayerModel(spec, parent, parentGivenName, unitSize, repeater, config, fit);\n    }\n    if (isUnitSpec(spec)) {\n        return new UnitModel(spec, parent, parentGivenName, unitSize, repeater, config, fit);\n    }\n    if (isRepeatSpec(spec)) {\n        return new RepeatModel(spec, parent, parentGivenName, repeater, config);\n    }\n    if (isConcatSpec(spec)) {\n        return new ConcatModel(spec, parent, parentGivenName, repeater, config);\n    }\n    throw new Error(log.message.INVALID_SPEC);\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVpbGRtb2RlbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21waWxlL2J1aWxkbW9kZWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxLQUFLLEdBQUcsTUFBTSxRQUFRLENBQUM7QUFDOUIsT0FBTyxFQUFDLFlBQVksRUFBRSxXQUFXLEVBQUUsV0FBVyxFQUFFLFlBQVksRUFBRSxVQUFVLEVBQW1DLE1BQU0sU0FBUyxDQUFDO0FBQzNILE9BQU8sRUFBQyxXQUFXLEVBQUMsTUFBTSxVQUFVLENBQUM7QUFDckMsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLFNBQVMsQ0FBQztBQUNuQyxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0sU0FBUyxDQUFDO0FBRW5DLE9BQU8sRUFBQyxXQUFXLEVBQUMsTUFBTSxVQUFVLENBQUM7QUFFckMsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLFFBQVEsQ0FBQztBQUVqQyxNQUFNLHFCQUFxQixJQUFvQixFQUFFLE1BQWEsRUFBRSxlQUF1QixFQUNyRixRQUEwQixFQUFFLFFBQXVCLEVBQUUsTUFBYyxFQUFFLEdBQVk7SUFDakYsSUFBSSxXQUFXLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDckIsT0FBTyxJQUFJLFVBQVUsQ0FBQyxJQUFJLEVBQUUsTUFBTSxFQUFFLGVBQWUsRUFBRSxRQUFRLEVBQUUsTUFBTSxDQUFDLENBQUM7S0FDeEU7SUFFRCxJQUFJLFdBQVcsQ0FBQyxJQUFJLENBQUMsRUFBRTtRQUNyQixPQUFPLElBQUksVUFBVSxDQUFDLElBQUksRUFBRSxNQUFNLEVBQUUsZUFBZSxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFDO0tBQ3ZGO0lBRUQsSUFBSSxVQUFVLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDcEIsT0FBTyxJQUFJLFNBQVMsQ0FBQyxJQUFJLEVBQUUsTUFBTSxFQUFFLGVBQWUsRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLE1BQU0sRUFBRSxHQUFHLENBQUMsQ0FBQztLQUN0RjtJQUVELElBQUksWUFBWSxDQUFDLElBQUksQ0FBQyxFQUFFO1FBQ3RCLE9BQU8sSUFBSSxXQUFXLENBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxlQUFlLEVBQUUsUUFBUSxFQUFFLE1BQU0sQ0FBQyxDQUFDO0tBQ3pFO0lBRUQsSUFBSSxZQUFZLENBQUMsSUFBSSxDQUFDLEVBQUU7UUFDdEIsT0FBTyxJQUFJLFdBQVcsQ0FBQyxJQUFJLEVBQUUsTUFBTSxFQUFFLGVBQWUsRUFBRSxRQUFRLEVBQUUsTUFBTSxDQUFDLENBQUM7S0FDekU7SUFFRCxNQUFNLElBQUksS0FBSyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLENBQUM7QUFDNUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29uZmlnfSBmcm9tICcuLi9jb25maWcnO1xuaW1wb3J0ICogYXMgbG9nIGZyb20gJy4uL2xvZyc7XG5pbXBvcnQge2lzQ29uY2F0U3BlYywgaXNGYWNldFNwZWMsIGlzTGF5ZXJTcGVjLCBpc1JlcGVhdFNwZWMsIGlzVW5pdFNwZWMsIExheW91dFNpemVNaXhpbnMsIE5vcm1hbGl6ZWRTcGVjfSBmcm9tICcuLi9zcGVjJztcbmltcG9ydCB7Q29uY2F0TW9kZWx9IGZyb20gJy4vY29uY2F0JztcbmltcG9ydCB7RmFjZXRNb2RlbH0gZnJvbSAnLi9mYWNldCc7XG5pbXBvcnQge0xheWVyTW9kZWx9IGZyb20gJy4vbGF5ZXInO1xuaW1wb3J0IHtNb2RlbH0gZnJvbSAnLi9tb2RlbCc7XG5pbXBvcnQge1JlcGVhdE1vZGVsfSBmcm9tICcuL3JlcGVhdCc7XG5pbXBvcnQge1JlcGVhdGVyVmFsdWV9IGZyb20gJy4vcmVwZWF0ZXInO1xuaW1wb3J0IHtVbml0TW9kZWx9IGZyb20gJy4vdW5pdCc7XG5cbmV4cG9ydCBmdW5jdGlvbiBidWlsZE1vZGVsKHNwZWM6IE5vcm1hbGl6ZWRTcGVjLCBwYXJlbnQ6IE1vZGVsLCBwYXJlbnRHaXZlbk5hbWU6IHN0cmluZyxcbiAgdW5pdFNpemU6IExheW91dFNpemVNaXhpbnMsIHJlcGVhdGVyOiBSZXBlYXRlclZhbHVlLCBjb25maWc6IENvbmZpZywgZml0OiBib29sZWFuKTogTW9kZWwge1xuICBpZiAoaXNGYWNldFNwZWMoc3BlYykpIHtcbiAgICByZXR1cm4gbmV3IEZhY2V0TW9kZWwoc3BlYywgcGFyZW50LCBwYXJlbnRHaXZlbk5hbWUsIHJlcGVhdGVyLCBjb25maWcpO1xuICB9XG5cbiAgaWYgKGlzTGF5ZXJTcGVjKHNwZWMpKSB7XG4gICAgcmV0dXJuIG5ldyBMYXllck1vZGVsKHNwZWMsIHBhcmVudCwgcGFyZW50R2l2ZW5OYW1lLCB1bml0U2l6ZSwgcmVwZWF0ZXIsIGNvbmZpZywgZml0KTtcbiAgfVxuXG4gIGlmIChpc1VuaXRTcGVjKHNwZWMpKSB7XG4gICAgcmV0dXJuIG5ldyBVbml0TW9kZWwoc3BlYywgcGFyZW50LCBwYXJlbnRHaXZlbk5hbWUsIHVuaXRTaXplLCByZXBlYXRlciwgY29uZmlnLCBmaXQpO1xuICB9XG5cbiAgaWYgKGlzUmVwZWF0U3BlYyhzcGVjKSkge1xuICAgIHJldHVybiBuZXcgUmVwZWF0TW9kZWwoc3BlYywgcGFyZW50LCBwYXJlbnRHaXZlbk5hbWUsIHJlcGVhdGVyLCBjb25maWcpO1xuICB9XG5cbiAgaWYgKGlzQ29uY2F0U3BlYyhzcGVjKSkge1xuICAgIHJldHVybiBuZXcgQ29uY2F0TW9kZWwoc3BlYywgcGFyZW50LCBwYXJlbnRHaXZlbk5hbWUsIHJlcGVhdGVyLCBjb25maWcpO1xuICB9XG5cbiAgdGhyb3cgbmV3IEVycm9yKGxvZy5tZXNzYWdlLklOVkFMSURfU1BFQyk7XG59XG4iXX0=","import * as tslib_1 from \"tslib\";\nimport { initConfig, stripAndRedirectConfig } from '../config';\nimport * as vlFieldDef from '../fielddef';\nimport * as log from '../log';\nimport { isLayerSpec, isUnitSpec, normalize } from '../spec';\nimport { extractTopLevelProperties, normalizeAutoSize } from '../toplevelprops';\nimport { keys, mergeDeep } from '../util';\nimport { buildModel } from './buildmodel';\nimport { assembleRootData } from './data/assemble';\nimport { optimizeDataflow } from './data/optimize';\n/**\n * Vega-Lite's main function, for compiling Vega-lite spec into Vega spec.\n *\n * At a high-level, we make the following transformations in different phases:\n *\n * Input spec\n *     |\n *     |  (Normalization)\n *     v\n * Normalized Spec (Row/Column channels in single-view specs becomes faceted specs, composite marks becomes layered specs.)\n *     |\n *     |  (Build Model)\n *     v\n * A model tree of the spec\n *     |\n *     |  (Parse)\n *     v\n * A model tree with parsed components (intermediate structure of visualization primitives in a format that can be easily merged)\n *     |\n *     | (Optimize)\n *     v\n * A model tree with parsed components with the data component optimized\n *     |\n *     | (Assemble)\n *     v\n * Vega spec\n */\nexport function compile(inputSpec, opt) {\n    if (opt === void 0) { opt = {}; }\n    // 0. Augment opt with default opts\n    if (opt.logger) {\n        // set the singleton logger to the provided logger\n        log.set(opt.logger);\n    }\n    if (opt.fieldTitle) {\n        // set the singleton field title formatter\n        vlFieldDef.setTitleFormatter(opt.fieldTitle);\n    }\n    try {\n        // 1. Initialize config by deep merging default config with the config provided via option and the input spec.\n        var config = initConfig(mergeDeep({}, opt.config, inputSpec.config));\n        // 2. Normalize: Convert input spec -> normalized spec\n        // - Decompose all extended unit specs into composition of unit spec.  For example, a box plot get expanded into multiple layers of bars, ticks, and rules. The shorthand row/column channel is also expanded to a facet spec.\n        var spec = normalize(inputSpec, config);\n        // - Normalize autosize to be a autosize properties object.\n        var autosize = normalizeAutoSize(inputSpec.autosize, config.autosize, isLayerSpec(spec) || isUnitSpec(spec));\n        // 3. Build Model: normalized spec -> Model (a tree structure)\n        // This phases instantiates the models with default config by doing a top-down traversal. This allows us to pass properties that child models derive from their parents via their constructors.\n        // See the abstract `Model` class and its children (UnitModel, LayerModel, FacetModel, RepeatModel, ConcatModel) for different types of models.\n        var model = buildModel(spec, null, '', undefined, undefined, config, autosize.type === 'fit');\n        // 4 Parse: Model --> Model with components\n        // Note that components = intermediate representations that are equivalent to Vega specs.\n        // We need these intermediate representation because we need to merge many visualizaiton \"components\" like projections, scales, axes, and legends.\n        // We will later convert these components into actual Vega specs in the assemble phase.\n        // In this phase, we do a bottom-up traversal over the whole tree to\n        // parse for each type of components once (e.g., data, layout, mark, scale).\n        // By doing bottom-up traversal, we start parsing components of unit specs and\n        // then merge child components of parent composite specs.\n        //\n        // Please see inside model.parse() for order of different components parsed.\n        model.parse();\n        // 5. Optimize the dataflow.  This will modify the data component of the model.\n        optimizeDataflow(model.component.data);\n        // 6. Assemble: convert model components --> Vega Spec.\n        return assembleTopLevelModel(model, getTopLevelProperties(inputSpec, config, autosize));\n    }\n    finally {\n        // Reset the singleton logger if a logger is provided\n        if (opt.logger) {\n            log.reset();\n        }\n        // Reset the singleton field title formatter if provided\n        if (opt.fieldTitle) {\n            vlFieldDef.resetTitleFormatter();\n        }\n    }\n}\nfunction getTopLevelProperties(topLevelSpec, config, autosize) {\n    return tslib_1.__assign({ autosize: keys(autosize).length === 1 && autosize.type ? autosize.type : autosize }, extractTopLevelProperties(config), extractTopLevelProperties(topLevelSpec));\n}\n/*\n * Assemble the top-level model.\n *\n * Note: this couldn't be `model.assemble()` since the top-level model\n * needs some special treatment to generate top-level properties.\n */\nfunction assembleTopLevelModel(model, topLevelProperties) {\n    // TODO: change type to become VgSpec\n    // Config with Vega-Lite only config removed.\n    var vgConfig = model.config ? stripAndRedirectConfig(model.config) : undefined;\n    var data = [].concat(model.assembleSelectionData([]), \n    // only assemble data in the root\n    assembleRootData(model.component.data, topLevelProperties.datasets || {}));\n    delete topLevelProperties.datasets;\n    var projections = model.assembleProjections();\n    var title = model.assembleTitle();\n    var style = model.assembleGroupStyle();\n    var layoutSignals = model.assembleLayoutSignals();\n    // move width and height signals with values to top level\n    layoutSignals = layoutSignals.filter(function (signal) {\n        if ((signal.name === 'width' || signal.name === 'height') && signal.value !== undefined) {\n            topLevelProperties[signal.name] = +signal.value;\n            return false;\n        }\n        return true;\n    });\n    var output = tslib_1.__assign({ $schema: 'https://vega.github.io/schema/vega/v3.json' }, (model.description ? { description: model.description } : {}), topLevelProperties, (title ? { title: title } : {}), (style ? { style: style } : {}), { data: data }, (projections.length > 0 ? { projections: projections } : {}), model.assembleGroup(layoutSignals.concat(model.assembleSelectionTopLevelSignals([]))), (vgConfig ? { config: vgConfig } : {}));\n    return {\n        spec: output\n        // TODO: add warning / errors here\n    };\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcGlsZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21waWxlL2NvbXBpbGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBUyxVQUFVLEVBQUUsc0JBQXNCLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFDckUsT0FBTyxLQUFLLFVBQVUsTUFBTSxhQUFhLENBQUM7QUFDMUMsT0FBTyxLQUFLLEdBQUcsTUFBTSxRQUFRLENBQUM7QUFDOUIsT0FBTyxFQUFDLFdBQVcsRUFBRSxVQUFVLEVBQW9CLFNBQVMsRUFBeUIsTUFBTSxTQUFTLENBQUM7QUFDckcsT0FBTyxFQUFpQix5QkFBeUIsRUFBRSxpQkFBaUIsRUFBcUIsTUFBTSxrQkFBa0IsQ0FBQztBQUNsSCxPQUFPLEVBQUMsSUFBSSxFQUFFLFNBQVMsRUFBQyxNQUFNLFNBQVMsQ0FBQztBQUN4QyxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0sY0FBYyxDQUFDO0FBQ3hDLE9BQU8sRUFBQyxnQkFBZ0IsRUFBQyxNQUFNLGlCQUFpQixDQUFDO0FBQ2pELE9BQU8sRUFBQyxnQkFBZ0IsRUFBQyxNQUFNLGlCQUFpQixDQUFDO0FBVWpEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQTBCRztBQUNILE1BQU0sa0JBQWtCLFNBQXVCLEVBQUUsR0FBd0I7SUFBeEIsb0JBQUEsRUFBQSxRQUF3QjtJQUN2RSxtQ0FBbUM7SUFDbkMsSUFBSSxHQUFHLENBQUMsTUFBTSxFQUFFO1FBQ2Qsa0RBQWtEO1FBQ2xELEdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0tBQ3JCO0lBRUQsSUFBSSxHQUFHLENBQUMsVUFBVSxFQUFFO1FBQ2xCLDBDQUEwQztRQUMxQyxVQUFVLENBQUMsaUJBQWlCLENBQUMsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDO0tBQzlDO0lBRUQsSUFBSTtRQUNGLDhHQUE4RztRQUM5RyxJQUFNLE1BQU0sR0FBRyxV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QUNMLElBQUksRUFBRSxNQUFNO1FBQ1osa0NBQWtDO0tBQ25DLENBQUM7QUFDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDb25maWcsIGluaXRDb25maWcsIHN0cmlwQW5kUmVkaXJlY3RDb25maWd9IGZyb20gJy4uL2NvbmZpZyc7XG5pbXBvcnQgKiBhcyB2bEZpZWxkRGVmIGZyb20gJy4uL2ZpZWxkZGVmJztcbmltcG9ydCAqIGFzIGxvZyBmcm9tICcuLi9sb2cnO1xuaW1wb3J0IHtpc0xheWVyU3BlYywgaXNVbml0U3BlYywgTGF5b3V0U2l6ZU1peGlucywgbm9ybWFsaXplLCBUb3BMZXZlbCwgVG9wTGV2ZWxTcGVjfSBmcm9tICcuLi9zcGVjJztcbmltcG9ydCB7QXV0b1NpemVQYXJhbXMsIGV4dHJhY3RUb3BMZXZlbFByb3BlcnRpZXMsIG5vcm1hbGl6ZUF1dG9TaXplLCBUb3BMZXZlbFByb3BlcnRpZXN9IGZyb20gJy4uL3RvcGxldmVscHJvcHMnO1xuaW1wb3J0IHtrZXlzLCBtZXJnZURlZXB9IGZyb20gJy4uL3V0aWwnO1xuaW1wb3J0IHtidWlsZE1vZGVsfSBmcm9tICcuL2J1aWxkbW9kZWwnO1xuaW1wb3J0IHthc3NlbWJsZVJvb3REYXRhfSBmcm9tICcuL2RhdGEvYXNzZW1ibGUnO1xuaW1wb3J0IHtvcHRpbWl6ZURhdGFmbG93fSBmcm9tICcuL2RhdGEvb3B0aW1pemUnO1xuaW1wb3J0IHtNb2RlbH0gZnJvbSAnLi9tb2RlbCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29tcGlsZU9wdGlvbnMge1xuICBjb25maWc/OiBDb25maWc7XG4gIGxvZ2dlcj86IGxvZy5Mb2dnZXJJbnRlcmZhY2U7XG5cbiAgZmllbGRUaXRsZT86IHZsRmllbGREZWYuRmllbGRUaXRsZUZvcm1hdHRlcjtcbn1cblxuLyoqXG4gKiBWZWdhLUxpdGUncyBtYWluIGZ1bmN0aW9uLCBmb3IgY29tcGlsaW5nIFZlZ2EtbGl0ZSBzcGVjIGludG8gVmVnYSBzcGVjLlxuICpcbiAqIEF0IGEgaGlnaC1sZXZlbCwgd2UgbWFrZSB0aGUgZm9sbG93aW5nIHRyYW5zZm9ybWF0aW9ucyBpbiBkaWZmZXJlbnQgcGhhc2VzOlxuICpcbiAqIElucHV0IHNwZWNcbiAqICAgICB8XG4gKiAgICAgfCAgKE5vcm1hbGl6YXRpb24pXG4gKiAgICAgdlxuICogTm9ybWFsaXplZCBTcGVjIChSb3cvQ29sdW1uIGNoYW5uZWxzIGluIHNpbmdsZS12aWV3IHNwZWNzIGJlY29tZXMgZmFjZXRlZCBzcGVjcywgY29tcG9zaXRlIG1hcmtzIGJlY29tZXMgbGF5ZXJlZCBzcGVjcy4pXG4gKiAgICAgfFxuICogICAgIHwgIChCdWlsZCBNb2RlbClcbiAqICAgICB2XG4gKiBBIG1vZGVsIHRyZWUgb2YgdGhlIHNwZWNcbiAqICAgICB8XG4gKiAgICAgfCAgKFBhcnNlKVxuICogICAgIHZcbiAqIEEgbW9kZWwgdHJlZSB3aXRoIHBhcnNlZCBjb21wb25lbnRzIChpbnRlcm1lZGlhdGUgc3RydWN0dXJlIG9mIHZpc3VhbGl6YXRpb24gcHJpbWl0aXZlcyBpbiBhIGZvcm1hdCB0aGF0IGNhbiBiZSBlYXNpbHkgbWVyZ2VkKVxuICogICAgIHxcbiAqICAgICB8IChPcHRpbWl6ZSlcbiAqICAgICB2XG4gKiBBIG1vZGVsIHRyZWUgd2l0aCBwYXJzZWQgY29tcG9uZW50cyB3aXRoIHRoZSBkYXRhIGNvbXBvbmVudCBvcHRpbWl6ZWRcbiAqICAgICB8XG4gKiAgICAgfCAoQXNzZW1ibGUpXG4gKiAgICAgdlxuICogVmVnYSBzcGVjXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjb21waWxlKGlucHV0U3BlYzogVG9wTGV2ZWxTcGVjLCBvcHQ6IENvbXBpbGVPcHRpb25zID0ge30pIHtcbiAgLy8gMC4gQXVnbWVudCBvcHQgd2l0aCBkZWZhdWx0IG9wdHNcbiAgaWYgKG9wdC5sb2dnZXIpIHtcbiAgICAvLyBzZXQgdGhlIHNpbmdsZXRvbiBsb2dnZXIgdG8gdGhlIHByb3ZpZGVkIGxvZ2dlclxuICAgIGxvZy5zZXQob3B0LmxvZ2dlcik7XG4gIH1cblxuICBpZiAob3B0LmZpZWxkVGl0bGUpIHtcbiAgICAvLyBzZXQgdGhlIHNpbmdsZXRvbiBmaWVsZCB0aXRsZSBmb3JtYXR0ZXJcbiAgICB2bEZpZWxkRGVmLnNldFRpdGxlRm9ybWF0dGVyKG9wdC5maWVsZFRpdGxlKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgLy8gMS4gSW5pdGlhbGl6ZSBjb25maWcgYnkgZGVlcCBtZXJnaW5nIGRlZmF1bHQgY29uZmlnIHdpdGggdGhlIGNvbmZpZyBwcm92aWRlZCB2aWEgb3B0aW9uIGFuZCB0aGUgaW5wdXQgc3BlYy5cbiAgICBjb25zdCBjb25maWcgPSBpbml0Q29uZmlnKG1lcmdlRGVlcCh7fSwgb3B0LmNvbmZpZywgaW5wdXRTcGVjLmNvbmZpZykpO1xuXG4gICAgLy8gMi4gTm9ybWFsaXplOiBDb252ZXJ0IGlucHV0IHNwZWMgLT4gbm9ybWFsaXplZCBzcGVjXG5cbiAgICAvLyAtIERlY29tcG9zZSBhbGwgZXh0ZW5kZWQgdW5pdCBzcGVjcyBpbnRvIGNvbXBvc2l0aW9uIG9mIHVuaXQgc3BlYy4gIEZvciBleGFtcGxlLCBhIGJveCBwbG90IGdldCBleHBhbmRlZCBpbnRvIG11bHRpcGxlIGxheWVycyBvZiBiYXJzLCB0aWNrcywgYW5kIHJ1bGVzLiBUaGUgc2hvcnRoYW5kIHJvdy9jb2x1bW4gY2hhbm5lbCBpcyBhbHNvIGV4cGFuZGVkIHRvIGEgZmFjZXQgc3BlYy5cbiAgICBjb25zdCBzcGVjID0gbm9ybWFsaXplKGlucHV0U3BlYywgY29uZmlnKTtcbiAgICAvLyAtIE5vcm1hbGl6ZSBhdXRvc2l6ZSB0byBiZSBhIGF1dG9zaXplIHByb3BlcnRpZXMgb2JqZWN0LlxuICAgIGNvbnN0IGF1dG9zaXplID0gbm9ybWFsaXplQXV0b1NpemUoaW5wdXRTcGVjLmF1dG9zaXplLCBjb25maWcuYXV0b3NpemUsIGlzTGF5ZXJTcGVjKHNwZWMpIHx8IGlzVW5pdFNwZWMoc3BlYykpO1xuXG4gICAgLy8gMy4gQnVpbGQgTW9kZWw6IG5vcm1hbGl6ZWQgc3BlYyAtPiBNb2RlbCAoYSB0cmVlIHN0cnVjdHVyZSlcblxuICAgIC8vIFRoaXMgcGhhc2VzIGluc3RhbnRpYXRlcyB0aGUgbW9kZWxzIHdpdGggZGVmYXVsdCBjb25maWcgYnkgZG9pbmcgYSB0b3AtZG93biB0cmF2ZXJzYWwuIFRoaXMgYWxsb3dzIHVzIHRvIHBhc3MgcHJvcGVydGllcyB0aGF0IGNoaWxkIG1vZGVscyBkZXJpdmUgZnJvbSB0aGVpciBwYXJlbnRzIHZpYSB0aGVpciBjb25zdHJ1Y3RvcnMuXG4gICAgLy8gU2VlIHRoZSBhYnN0cmFjdCBgTW9kZWxgIGNsYXNzIGFuZCBpdHMgY2hpbGRyZW4gKFVuaXRNb2RlbCwgTGF5ZXJNb2RlbCwgRmFjZXRNb2RlbCwgUmVwZWF0TW9kZWwsIENvbmNhdE1vZGVsKSBmb3IgZGlmZmVyZW50IHR5cGVzIG9mIG1vZGVscy5cbiAgICBjb25zdCBtb2RlbDogTW9kZWwgPSBidWlsZE1vZGVsKHNwZWMsIG51bGwsICcnLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgY29uZmlnLCBhdXRvc2l6ZS50eXBlID09PSAnZml0Jyk7XG5cbiAgICAvLyA0IFBhcnNlOiBNb2RlbCAtLT4gTW9kZWwgd2l0aCBjb21wb25lbnRzXG5cbiAgICAvLyBOb3RlIHRoYXQgY29tcG9uZW50cyA9IGludGVybWVkaWF0ZSByZXByZXNlbnRhdGlvbnMgdGhhdCBhcmUgZXF1aXZhbGVudCB0byBWZWdhIHNwZWNzLlxuICAgIC8vIFdlIG5lZWQgdGhlc2UgaW50ZXJtZWRpYXRlIHJlcHJlc2VudGF0aW9uIGJlY2F1c2Ugd2UgbmVlZCB0byBtZXJnZSBtYW55IHZpc3VhbGl6YWl0b24gXCJjb21wb25lbnRzXCIgbGlrZSBwcm9qZWN0aW9ucywgc2NhbGVzLCBheGVzLCBhbmQgbGVnZW5kcy5cbiAgICAvLyBXZSB3aWxsIGxhdGVyIGNvbnZlcnQgdGhlc2UgY29tcG9uZW50cyBpbnRvIGFjdHVhbCBWZWdhIHNwZWNzIGluIHRoZSBhc3NlbWJsZSBwaGFzZS5cblxuICAgIC8vIEluIHRoaXMgcGhhc2UsIHdlIGRvIGEgYm90dG9tLXVwIHRyYXZlcnNhbCBvdmVyIHRoZSB3aG9sZSB0cmVlIHRvXG4gICAgLy8gcGFyc2UgZm9yIGVhY2ggdHlwZSBvZiBjb21wb25lbnRzIG9uY2UgKGUuZy4sIGRhdGEsIGxheW91dCwgbWFyaywgc2NhbGUpLlxuICAgIC8vIEJ5IGRvaW5nIGJvdHRvbS11cCB0cmF2ZXJzYWwsIHdlIHN0YXJ0IHBhcnNpbmcgY29tcG9uZW50cyBvZiB1bml0IHNwZWNzIGFuZFxuICAgIC8vIHRoZW4gbWVyZ2UgY2hpbGQgY29tcG9uZW50cyBvZiBwYXJlbnQgY29tcG9zaXRlIHNwZWNzLlxuICAgIC8vXG4gICAgLy8gUGxlYXNlIHNlZSBpbnNpZGUgbW9kZWwucGFyc2UoKSBmb3Igb3JkZXIgb2YgZGlmZmVyZW50IGNvbXBvbmVudHMgcGFyc2VkLlxuICAgIG1vZGVsLnBhcnNlKCk7XG5cbiAgICAvLyA1LiBPcHRpbWl6ZSB0aGUgZGF0YWZsb3cuICBUaGlzIHdpbGwgbW9kaWZ5IHRoZSBkYXRhIGNvbXBvbmVudCBvZiB0aGUgbW9kZWwuXG4gICAgb3B0aW1pemVEYXRhZmxvdyhtb2RlbC5jb21wb25lbnQuZGF0YSk7XG5cbiAgICAvLyA2LiBBc3NlbWJsZTogY29udmVydCBtb2RlbCBjb21wb25lbnRzIC0tPiBWZWdhIFNwZWMuXG4gICAgcmV0dXJuIGFzc2VtYmxlVG9wTGV2ZWxNb2RlbChtb2RlbCwgZ2V0VG9wTGV2ZWxQcm9wZXJ0aWVzKGlucHV0U3BlYywgY29uZmlnLCBhdXRvc2l6ZSkpO1xuICB9IGZpbmFsbHkge1xuICAgIC8vIFJlc2V0IHRoZSBzaW5nbGV0b24gbG9nZ2VyIGlmIGEgbG9nZ2VyIGlzIHByb3ZpZGVkXG4gICAgaWYgKG9wdC5sb2dnZXIpIHtcbiAgICAgIGxvZy5yZXNldCgpO1xuICAgIH1cbiAgICAvLyBSZXNldCB0aGUgc2luZ2xldG9uIGZpZWxkIHRpdGxlIGZvcm1hdHRlciBpZiBwcm92aWRlZFxuICAgIGlmIChvcHQuZmllbGRUaXRsZSkge1xuICAgICAgdmxGaWVsZERlZi5yZXNldFRpdGxlRm9ybWF0dGVyKCk7XG4gICAgfVxuICB9XG59XG5cblxuZnVuY3Rpb24gZ2V0VG9wTGV2ZWxQcm9wZXJ0aWVzKHRvcExldmVsU3BlYzogVG9wTGV2ZWw8YW55PiwgY29uZmlnOiBDb25maWcsIGF1dG9zaXplOiBBdXRvU2l6ZVBhcmFtcykge1xuICByZXR1cm4ge1xuICAgIGF1dG9zaXplOiBrZXlzKGF1dG9zaXplKS5sZW5ndGggPT09IDEgJiYgYXV0b3NpemUudHlwZSA/IGF1dG9zaXplLnR5cGUgOiBhdXRvc2l6ZSxcbiAgICAuLi5leHRyYWN0VG9wTGV2ZWxQcm9wZXJ0aWVzKGNvbmZpZyksXG4gICAgLi4uZXh0cmFjdFRvcExldmVsUHJvcGVydGllcyh0b3BMZXZlbFNwZWMpXG4gIH07XG59XG5cbi8qXG4gKiBBc3NlbWJsZSB0aGUgdG9wLWxldmVsIG1vZGVsLlxuICpcbiAqIE5vdGU6IHRoaXMgY291bGRuJ3QgYmUgYG1vZGVsLmFzc2VtYmxlKClgIHNpbmNlIHRoZSB0b3AtbGV2ZWwgbW9kZWxcbiAqIG5lZWRzIHNvbWUgc3BlY2lhbCB0cmVhdG1lbnQgdG8gZ2VuZXJhdGUgdG9wLWxldmVsIHByb3BlcnRpZXMuXG4gKi9cbmZ1bmN0aW9uIGFzc2VtYmxlVG9wTGV2ZWxNb2RlbChtb2RlbDogTW9kZWwsIHRvcExldmVsUHJvcGVydGllczogVG9wTGV2ZWxQcm9wZXJ0aWVzICYgTGF5b3V0U2l6ZU1peGlucykge1xuICAvLyBUT0RPOiBjaGFuZ2UgdHlwZSB0byBiZWNvbWUgVmdTcGVjXG5cbiAgLy8gQ29uZmlnIHdpdGggVmVnYS1MaXRlIG9ubHkgY29uZmlnIHJlbW92ZWQuXG4gIGNvbnN0IHZnQ29uZmlnID0gbW9kZWwuY29uZmlnID8gc3RyaXBBbmRSZWRpcmVjdENvbmZpZyhtb2RlbC5jb25maWcpIDogdW5kZWZpbmVkO1xuXG4gIGNvbnN0IGRhdGEgPSBbXS5jb25jYXQoXG4gICAgbW9kZWwuYXNzZW1ibGVTZWxlY3Rpb25EYXRhKFtdKSxcbiAgICAvLyBvbmx5IGFzc2VtYmxlIGRhdGEgaW4gdGhlIHJvb3RcbiAgICBhc3NlbWJsZVJvb3REYXRhKG1vZGVsLmNvbXBvbmVudC5kYXRhLCB0b3BMZXZlbFByb3BlcnRpZXMuZGF0YXNldHMgfHwge30pXG4gICk7XG5cbiAgZGVsZXRlIHRvcExldmVsUHJvcGVydGllcy5kYXRhc2V0cztcblxuICBjb25zdCBwcm9qZWN0aW9ucyA9IG1vZGVsLmFzc2VtYmxlUHJvamVjdGlvbnMoKTtcbiAgY29uc3QgdGl0bGUgPSBtb2RlbC5hc3NlbWJsZVRpdGxlKCk7XG4gIGNvbnN0IHN0eWxlID0gbW9kZWwuYXNzZW1ibGVHcm91cFN0eWxlKCk7XG5cbiAgbGV0IGxheW91dFNpZ25hbHMgPSBtb2RlbC5hc3NlbWJsZUxheW91dFNpZ25hbHMoKTtcblxuICAvLyBtb3ZlIHdpZHRoIGFuZCBoZWlnaHQgc2lnbmFscyB3aXRoIHZhbHVlcyB0byB0b3AgbGV2ZWxcbiAgbGF5b3V0U2lnbmFscyA9IGxheW91dFNpZ25hbHMuZmlsdGVyKHNpZ25hbCA9PiB7XG4gICAgaWYgKChzaWduYWwubmFtZSA9PT0gJ3dpZHRoJyB8fCBzaWduYWwubmFtZSA9PT0gJ2hlaWdodCcpICYmIHNpZ25hbC52YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0b3BMZXZlbFByb3BlcnRpZXNbc2lnbmFsLm5hbWVdID0gK3NpZ25hbC52YWx1ZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG4gIH0pO1xuXG4gIGNvbnN0IG91dHB1dCA9IHtcbiAgICAkc2NoZW1hOiAnaHR0cHM6Ly92ZWdhLmdpdGh1Yi5pby9zY2hlbWEvdmVnYS92My5qc29uJyxcbiAgICAuLi4obW9kZWwuZGVzY3JpcHRpb24gPyB7ZGVzY3JpcHRpb246IG1vZGVsLmRlc2NyaXB0aW9ufSA6IHt9KSxcbiAgICAuLi50b3BMZXZlbFByb3BlcnRpZXMsXG4gICAgLi4uKHRpdGxlPyB7dGl0bGV9IDoge30pLFxuICAgIC4uLihzdHlsZT8ge3N0eWxlfSA6IHt9KSxcbiAgICBkYXRhOiBkYXRhLFxuICAgIC4uLihwcm9qZWN0aW9ucy5sZW5ndGggPiAwID8ge3Byb2plY3Rpb25zOiBwcm9qZWN0aW9uc30gOiB7fSksXG4gICAgLi4ubW9kZWwuYXNzZW1ibGVHcm91cChbXG4gICAgICAuLi5sYXlvdXRTaWduYWxzLFxuICAgICAgLi4ubW9kZWwuYXNzZW1ibGVTZWxlY3Rpb25Ub3BMZXZlbFNpZ25hbHMoW10pXG4gICAgXSksXG4gICAgLi4uKHZnQ29uZmlnID8ge2NvbmZpZzogdmdDb25maWd9IDoge30pXG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBzcGVjOiBvdXRwdXRcbiAgICAvLyBUT0RPOiBhZGQgd2FybmluZyAvIGVycm9ycyBoZXJlXG4gIH07XG59XG4iXX0=","import { toSet } from 'vega-util';\nimport { isMarkDef } from './mark';\nimport { BAR } from './mark';\n/**\n * Required Encoding Channels for each mark type\n */\nexport var DEFAULT_REQUIRED_CHANNEL_MAP = {\n    text: ['text'],\n    line: ['x', 'y'],\n    trail: ['x', 'y'],\n    area: ['x', 'y']\n};\n/**\n * Supported Encoding Channel for each mark type\n */\nexport var DEFAULT_SUPPORTED_CHANNEL_TYPE = {\n    bar: toSet(['row', 'column', 'x', 'y', 'size', 'color', 'fill', 'stroke', 'detail']),\n    line: toSet(['row', 'column', 'x', 'y', 'color', 'fill', 'stroke', 'color', 'detail']),\n    trail: toSet(['row', 'column', 'x', 'y', 'color', 'fill', 'stroke', 'color', 'detail', 'size']),\n    area: toSet(['row', 'column', 'x', 'y', 'color', 'fill', 'stroke', 'detail']),\n    tick: toSet(['row', 'column', 'x', 'y', 'color', 'fill', 'stroke', 'detail']),\n    circle: toSet(['row', 'column', 'x', 'y', 'color', 'fill', 'stroke', 'size', 'detail']),\n    square: toSet(['row', 'column', 'x', 'y', 'color', 'fill', 'stroke', 'size', 'detail']),\n    point: toSet(['row', 'column', 'x', 'y', 'color', 'fill', 'stroke', 'size', 'detail', 'shape']),\n    geoshape: toSet(['row', 'column', 'color', 'fill', 'stroke', 'detail', 'shape']),\n    text: toSet(['row', 'column', 'size', 'color', 'fill', 'stroke', 'text']) // TODO(#724) revise\n};\n// TODO: consider if we should add validate method and\n// requires ZSchema in the main vega-lite repo\n/**\n * Further check if encoding mapping of a spec is invalid and\n * return error if it is invalid.\n *\n * This checks if\n * (1) all the required encoding channels for the mark type are specified\n * (2) all the specified encoding channels are supported by the mark type\n * @param  {[type]} spec [description]\n * @param  {RequiredChannelMap = DefaultRequiredChannelMap}  requiredChannelMap\n * @param  {SupportedChannelMap = DefaultSupportedChannelMap} supportedChannelMap\n * @return {String} Return one reason why the encoding is invalid,\n *                  or null if the encoding is valid.\n */\nexport function getEncodingMappingError(spec, requiredChannelMap, supportedChannelMap) {\n    if (requiredChannelMap === void 0) { requiredChannelMap = DEFAULT_REQUIRED_CHANNEL_MAP; }\n    if (supportedChannelMap === void 0) { supportedChannelMap = DEFAULT_SUPPORTED_CHANNEL_TYPE; }\n    var mark = isMarkDef(spec.mark) ? spec.mark.type : spec.mark;\n    var encoding = spec.encoding;\n    var requiredChannels = requiredChannelMap[mark];\n    var supportedChannels = supportedChannelMap[mark];\n    for (var i in requiredChannels) { // all required channels are in encoding`\n        if (!(requiredChannels[i] in encoding)) {\n            return 'Missing encoding channel \\\"' + requiredChannels[i] +\n                '\\\" for mark \\\"' + mark + '\\\"';\n        }\n    }\n    for (var channel in encoding) { // all channels in encoding are supported\n        if (!supportedChannels[channel]) {\n            return 'Encoding channel \\\"' + channel +\n                '\\\" is not supported by mark type \\\"' + mark + '\\\"';\n        }\n    }\n    if (mark === BAR && !encoding.x && !encoding.y) {\n        return 'Missing both x and y for bar';\n    }\n    return null;\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsaWRhdGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdmFsaWRhdGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFDLEtBQUssRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUNoQyxPQUFPLEVBQUMsU0FBUyxFQUFDLE1BQU0sUUFBUSxDQUFDO0FBQ2pDLE9BQU8sRUFBQyxHQUFHLEVBQUMsTUFBTSxRQUFRLENBQUM7QUFVM0I7O0dBRUc7QUFDSCxNQUFNLENBQUMsSUFBTSw0QkFBNEIsR0FBdUI7SUFDOUQsSUFBSSxFQUFFLENBQUMsTUFBTSxDQUFDO0lBQ2QsSUFBSSxFQUFFLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQztJQUNoQixLQUFLLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDO0lBQ2pCLElBQUksRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUM7Q0FDakIsQ0FBQztBQVFGOztHQUVHO0FBQ0gsTUFBTSxDQUFDLElBQU0sOEJBQThCLEdBQXdCO0lBQ2pFLEdBQUcsRUFBRSxLQUFLLENBQUMsQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQ3BGLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQ3RGLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLENBQUMsQ0FBQztJQUMvRixJQUFJLEVBQUUsS0FBSyxDQUFDLENB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dXRpbCc7XG5pbXBvcnQge2lzTWFya0RlZn0gZnJvbSAnLi9tYXJrJztcbmltcG9ydCB7QkFSfSBmcm9tICcuL21hcmsnO1xuaW1wb3J0IHtGYWNldGVkQ29tcG9zaXRlVW5pdFNwZWN9IGZyb20gJy4vc3BlYyc7XG5cblxuXG4vLyBUT0RPOiBtb3ZlIHRvIHZsLnNwZWMudmFsaWRhdG9yP1xuZXhwb3J0IGludGVyZmFjZSBSZXF1aXJlZENoYW5uZWxNYXAge1xuICBbbWFyazogc3RyaW5nXTogQXJyYXk8c3RyaW5nPjtcbn1cblxuLyoqXG4gKiBSZXF1aXJlZCBFbmNvZGluZyBDaGFubmVscyBmb3IgZWFjaCBtYXJrIHR5cGVcbiAqL1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfUkVRVUlSRURfQ0hBTk5FTF9NQVA6IFJlcXVpcmVkQ2hhbm5lbE1hcCA9IHtcbiAgdGV4dDogWyd0ZXh0J10sXG4gIGxpbmU6IFsneCcsICd5J10sXG4gIHRyYWlsOiBbJ3gnLCAneSddLFxuICBhcmVhOiBbJ3gnLCAneSddXG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIFN1cHBvcnRlZENoYW5uZWxNYXAge1xuICBbbWFyazogc3RyaW5nXToge1xuICAgIFtjaGFubmVsOiBzdHJpbmddOiBib29sZWFuXG4gIH07XG59XG5cbi8qKlxuICogU3VwcG9ydGVkIEVuY29kaW5nIENoYW5uZWwgZm9yIGVhY2ggbWFyayB0eXBlXG4gKi9cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NVUFBPUlRFRF9DSEFOTkVMX1RZUEU6IFN1cHBvcnRlZENoYW5uZWxNYXAgPSB7XG4gIGJhcjogdG9TZXQoWydyb3cnLCAnY29sdW1uJywgJ3gnLCAneScsICdzaXplJywgJ2NvbG9yJywgJ2ZpbGwnLCAnc3Ryb2tlJywgJ2RldGFpbCddKSxcbiAgbGluZTogdG9TZXQoWydyb3cnLCAnY29sdW1uJywgJ3gnLCAneScsICdjb2xvcicsICdmaWxsJywgJ3N0cm9rZScsICdjb2xvcicsICdkZXRhaWwnXSksXG4gIHRyYWlsOiB0b1NldChbJ3JvdycsICdjb2x1bW4nLCAneCcsICd5JywgJ2NvbG9yJywgJ2ZpbGwnLCAnc3Ryb2tlJywgJ2NvbG9yJywgJ2RldGFpbCcsICdzaXplJ10pLFxuICBhcmVhOiB0b1NldChbJ3JvdycsICdjb2x1bW4nLCAneCcsICd5JywgJ2NvbG9yJywgJ2ZpbGwnLCAnc3Ryb2tlJywgJ2RldGFpbCddKSxcbiAgdGljazogdG9TZXQoWydyb3cnLCAnY29sdW1uJywgJ3gnLCAneScsICdjb2xvcicsICdmaWxsJywgJ3N0cm9rZScsICdkZXRhaWwnXSksXG4gIGNpcmNsZTogdG9TZXQoWydyb3cnLCAnY29sdW1uJywgJ3gnLCAneScsICdjb2xvcicsICdmaWxsJywgJ3N0cm9rZScsICdzaXplJywgJ2RldGFpbCddKSxcbiAgc3F1YXJlOiB0b1NldChbJ3JvdycsICdjb2x1bW4nLCAneCcsICd5JywgJ2NvbG9yJywgJ2ZpbGwnLCAnc3Ryb2tlJywgJ3NpemUnLCAnZGV0YWlsJ10pLFxuICBwb2ludDogdG9TZXQoWydyb3cnLCAnY29sdW1uJywgJ3gnLCAneScsICdjb2xvcicsICdmaWxsJywgJ3N0cm9rZScsICdzaXplJywgJ2RldGFpbCcsICdzaGFwZSddKSxcbiAgZ2Vvc2hhcGU6IHRvU2V0KFsncm93JywgJ2NvbHVtbicsICdjb2xvcicsICdmaWxsJywgJ3N0cm9rZScsICdkZXRhaWwnLCAnc2hhcGUnXSksXG4gIHRleHQ6IHRvU2V0KFsncm93JywgJ2NvbHVtbicsICdzaXplJywgJ2NvbG9yJywgJ2ZpbGwnLCAnc3Ryb2tlJywgJ3RleHQnXSkgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVE9ETygjNzI0KSByZXZpc2Vcbn07XG5cbi8vIFRPRE86IGNvbnNpZGVyIGlmIHdlIHNob3VsZCBhZGQgdmFsaWRhdGUgbWV0aG9kIGFuZFxuLy8gcmVxdWlyZXMgWlNjaGVtYSBpbiB0aGUgbWFpbiB2ZWdhLWxpdGUgcmVwb1xuXG4vKipcbiAqIEZ1cnRoZXIgY2hlY2sgaWYgZW5jb2RpbmcgbWFwcGluZyBvZiBhIHNwZWMgaXMgaW52YWxpZCBhbmRcbiAqIHJldHVybiBlcnJvciBpZiBpdCBpcyBpbnZhbGlkLlxuICpcbiAqIFRoaXMgY2hlY2tzIGlmXG4gKiAoMSkgYWxsIHRoZSByZXF1aXJlZCBlbmNvZGluZyBjaGFubmVscyBmb3IgdGhlIG1hcmsgdHlwZSBhcmUgc3BlY2lmaWVkXG4gKiAoMikgYWxsIHRoZSBzcGVjaWZpZWQgZW5jb2RpbmcgY2hhbm5lbHMgYXJlIHN1cHBvcnRlZCBieSB0aGUgbWFyayB0eXBlXG4gKiBAcGFyYW0gIHtbdHlwZV19IHNwZWMgW2Rlc2NyaXB0aW9uXVxuICogQHBhcmFtICB7UmVxdWlyZWRDaGFubmVsTWFwID0gRGVmYXVsdFJlcXVpcmVkQ2hhbm5lbE1hcH0gIHJlcXVpcmVkQ2hhbm5lbE1hcFxuICogQHBhcmFtICB7U3VwcG9ydGVkQ2hhbm5lbE1hcCA9IERlZmF1bHRTdXBwb3J0ZWRDaGFubmVsTWFwfSBzdXBwb3J0ZWRDaGFubmVsTWFwXG4gKiBAcmV0dXJuIHtTdHJpbmd9IFJldHVybiBvbmUgcmVhc29uIHdoeSB0aGUgZW5jb2RpbmcgaXMgaW52YWxpZCxcbiAqICAgICAgICAgICAgICAgICAgb3IgbnVsbCBpZiB0aGUgZW5jb2RpbmcgaXMgdmFsaWQuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRFbmNvZGluZ01hcHBpbmdFcnJvcihzcGVjOiBGYWNldGVkQ29tcG9zaXRlVW5pdFNwZWMsXG4gIHJlcXVpcmVkQ2hhbm5lbE1hcDogUmVxdWlyZWRDaGFubmVsTWFwID0gREVGQVVMVF9SRVFVSVJFRF9DSEFOTkVMX01BUCxcbiAgc3VwcG9ydGVkQ2hhbm5lbE1hcDogU3VwcG9ydGVkQ2hhbm5lbE1hcCA9IERFRkFVTFRfU1VQUE9SVEVEX0NIQU5ORUxfVFlQRVxuICApIHtcbiAgY29uc3QgbWFyayA9IGlzTWFya0RlZihzcGVjLm1hcmspID8gc3BlYy5tYXJrLnR5cGUgOiBzcGVjLm1hcms7XG4gIGNvbnN0IGVuY29kaW5nID0gc3BlYy5lbmNvZGluZztcbiAgY29uc3QgcmVxdWlyZWRDaGFubmVscyA9IHJlcXVpcmVkQ2hhbm5lbE1hcFttYXJrXTtcbiAgY29uc3Qgc3VwcG9ydGVkQ2hhbm5lbHMgPSBzdXBwb3J0ZWRDaGFubmVsTWFwW21hcmtdO1xuXG4gIGZvciAoY29uc3QgaSBpbiByZXF1aXJlZENoYW5uZWxzKSB7IC8vIGFsbCByZXF1aXJlZCBjaGFubmVscyBhcmUgaW4gZW5jb2RpbmdgXG4gICAgaWYgKCEocmVxdWlyZWRDaGFubmVsc1tpXSBpbiBlbmNvZGluZykpIHtcbiAgICAgIHJldHVybiAnTWlzc2luZyBlbmNvZGluZyBjaGFubmVsIFxcXCInICsgcmVxdWlyZWRDaGFubmVsc1tpXSArXG4gICAgICAgICdcXFwiIGZvciBtYXJrIFxcXCInICsgbWFyayArICdcXFwiJztcbiAgICB9XG4gIH1cblxuICBmb3IgKGNvbnN0IGNoYW5uZWwgaW4gZW5jb2RpbmcpIHsgLy8gYWxsIGNoYW5uZWxzIGluIGVuY29kaW5nIGFyZSBzdXBwb3J0ZWRcbiAgICBpZiAoIXN1cHBvcnRlZENoYW5uZWxzW2NoYW5uZWxdKSB7XG4gICAgICByZXR1cm4gJ0VuY29kaW5nIGNoYW5uZWwgXFxcIicgKyBjaGFubmVsICtcbiAgICAgICAgJ1xcXCIgaXMgbm90IHN1cHBvcnRlZCBieSBtYXJrIHR5cGUgXFxcIicgKyBtYXJrICsgJ1xcXCInO1xuICAgIH1cbiAgfVxuXG4gIGlmIChtYXJrID09PSBCQVIgJiYgIWVuY29kaW5nLnggJiYgIWVuY29kaW5nLnkpIHtcbiAgICByZXR1cm4gJ01pc3NpbmcgYm90aCB4IGFuZCB5IGZvciBiYXInO1xuICB9XG5cbiAgcmV0dXJuIG51bGw7XG59XG4iXX0="],"names":["stringValue","Error","error","array","require$$0","require$$1","isArray","tslib_1.__assign","stringify","stableStringify","key","isBoolean","tslib_1.__rest","TEXT","field","log.warn","log.message","boxplot.BOXPLOT_STYLES","normalize","defaultConfig","mark.defaultMarkConfig","mark.defaultBarConfig","mark.defaultTickConfig","defaultSelectionConfig","compositeMark.normalize","vlEncoding.fieldDefs","fieldDefs","parseSelector","title","fieldDefTitle","bin","text","ref.midPoint","ref.text","ref.fieldRef","ref.bandRef","ref.bin","ref.getOffset","ref.stackable","ref.getDefaultRef","ref.stackable2","tslib_1.__extends","mixins.color","vals","type","properties.values","properties.type","log.debug","fieldRef","optimizers.iterateFromLeaves","optimizers.removeUnusedSubtrees","optimizers.moveParseUp","optimizers.removeDuplicateTimeUnits","util.keys","util.hash","util.isBoolean","util.replacePathInField","util.contains","util.unique","zero","defaultType","domain","scales","multiSignals","signals","scalesCompiler","INTERVAL_BRUSH","ANCHOR","DELTA","zoom","onDelta","inputs","contains","singleCompiler","multiCompiler","intervalCompiler","fieldExpr","timeUnitFieldExpr","isTimeUnit","isAggregate","hash","labels","labelAlign","labelBaseline","values","orient","getProperty","encode.labels","properties.gridScale","properties.grid","properties.labelFlush","properties.labelOverlap","properties.orient","properties.tickCount","mixins.baseEncodeEntry","mixins.pointPosition","mixins.pointPosition2","mixins.defined","mixins.binnedPosition","mixins.bandPosition","mixins.centeredBandPosition","ref.mid","mixins.nonPosition","x","y","mixins.text","mixins.valueIfDefined","vlEncoding.channelHasField","log.set","vlFieldDef.setTitleFormatter","log.reset","vlFieldDef.resetTitleFormatter"],"mappings":";;;;;;EAAe,iBAAQ,CAAC,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE;EAC1C,EAAE,EAAE,CAAC,MAAM,GAAG,MAAM,IAAI,EAAE,CAAC;EAC3B,EAAE,EAAE,CAAC,KAAK,GAAG,IAAI,CAAC;EAClB,EAAE,OAAO,EAAE,CAAC;EACZ,CAAC;;ECJc,cAAQ,CAAC,OAAO,EAAE;EACjC,EAAE,MAAM,KAAK,CAAC,OAAO,CAAC,CAAC;EACvB,CAAC;;ECAc,wBAAQ,CAAC,CAAC,EAAE;EAC3B,EAAE,IAAI,IAAI,GAAG,EAAE;EACf,MAAM,CAAC,GAAG,IAAI;EACd,MAAM,CAAC,GAAG,CAAC;EACX,MAAM,CAAC,GAAG,CAAC,CAAC,MAAM;EAClB,MAAM,CAAC,GAAG,EAAE;EACZ,MAAM,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;;EAEd,EAAE,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC;;EAEb,EAAE,SAAS,IAAI,GAAG;EAClB,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACrC,IAAI,CAAC,GAAG,EAAE,CAAC;EACX,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;EACd,GAAG;;EAEH,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,EAAE;EACxB,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;EACb,IAAI,IAAI,CAAC,KAAK,IAAI,EAAE;EACpB,MAAM,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EAC7B,MAAM,CAAC,GAAG,EAAE,CAAC,CAAC;EACd,KAAK,MAAM,IAAI,CAAC,KAAK,CAAC,EAAE;EACxB,MAAM,IAAI,EAAE,CAAC;EACb,MAAM,CAAC,GAAG,IAAI,CAAC;EACf,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;EACb,KAAK,MAAM,IAAI,CAAC,EAAE;EAClB,MAAM,SAAS;EACf,KAAK,MAAM,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,GAAG,EAAE;EACrC,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;EAChB,MAAM,CAAC,GAAG,CAAC,CAAC;EACZ,KAAK,MAAM,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,GAAG,EAAE;EACrC,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;EAChB,MAAM,CAAC,GAAG,CAAC,CAAC;EACZ,KAAK,MAAM,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,CAAC,EAAE;EAChC,MAAM,IAAI,CAAC,GAAG,CAAC,EAAE;EACjB,QAAQ,IAAI,EAAE,CAAC;EACf,OAAO,MAAM;EACb,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;EAClB,OAAO;EACP,KAAK,MAAM,IAAI,CAAC,KAAK,GAAG,EAAE;EAC1B,MAAM,IAAI,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,CAAC;EACxB,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;EACpB,KAAK,MAAM,IAAI,CAAC,KAAK,GAAG,EAAE;EAC1B,MAAM,IAAI,CAAC,CAAC,EAAE,KAAK,CAAC,oCAAoC,GAAG,CAAC,CAAC,CAAC;EAC9D,MAAM,IAAI,CAAC,GAAG,CAAC,EAAE,IAAI,EAAE,CAAC;EACxB,MAAM,CAAC,GAAG,CAAC,CAAC;EACZ,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;EAChB,KAAK;EACL,GAAG;;EAEH,EAAE,IAAI,CAAC,EAAE,KAAK,CAAC,uCAAuC,GAAG,CAAC,CAAC,CAAC;EAC5D,EAAE,IAAI,CAAC,EAAE,KAAK,CAAC,qCAAqC,GAAG,CAAC,CAAC,CAAC;;EAE1D,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE;EACb,IAAI,CAAC,EAAE,CAAC;EACR,IAAI,IAAI,EAAE,CAAC;EACX,GAAG;;EAEH,EAAE,OAAO,IAAI,CAAC;EACd,CAAC;;AC7DD,gBAAe,KAAK,CAAC,OAAO,CAAC;;ECAd,iBAAQ,CAAC,CAAC,EAAE;EAC3B,EAAE,OAAO,CAAC,KAAK,MAAM,CAAC,CAAC,CAAC,CAAC;EACzB,CAAC;;ECFc,iBAAQ,CAAC,CAAC,EAAE;EAC3B,EAAE,OAAO,OAAO,CAAC,KAAK,QAAQ,CAAC;EAC/B,CAAC;;ECEc,SAAS,CAAC,CAAC,CAAC,EAAE;EAC7B,EAAE,OAAO,OAAO,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG;EAC1C,MAAM,QAAQ,CAAC,CAAC,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC;EAChC;EACA;EACA,MAAM,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,QAAQ,EAAE,SAAS,CAAC;EAChF,MAAM,CAAC,CAAC;EACR,CAAC;;ECPc,cAAQ,CAAC,KAAK,EAAE,IAAI,EAAE;EACrC,EAAE,IAAI,IAAI,GAAG,eAAe,CAAC,KAAK,CAAC;EACnC,MAAM,IAAI,GAAG,WAAW,GAAG,IAAI,CAAC,GAAG,CAACA,CAAW,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;;EAEnE,EAAE,OAAO,QAAQ;EACjB,IAAI,QAAQ,CAAC,GAAG,EAAE,IAAI,CAAC;EACvB,IAAI,EAAE,KAAK,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,GAAG,KAAK,EAAE;EACjD,IAAI,IAAI,IAAI,KAAK;EACjB,GAAG,CAAC;EACJ,CAAC;;ECVD,IAAI,KAAK,GAAG,EAAE,CAAC;;AAEf,EAAO,IAAI,EAAE,GAAG,KAAK,CAAC,IAAI,CAAC,CAAC;;AAE5B,EAAO,IAAI,QAAQ,GAAG,QAAQ,CAAC,SAAS,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,EAAE,EAAE,KAAK,EAAE,UAAU,CAAC,CAAC;;AAE7E,EAAO,IAAI,IAAI,GAAG,QAAQ,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC,EAAE,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;;AAEpE,EAAO,IAAI,GAAG,GAAG,QAAQ,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;;AAElE,EAAO,IAAI,MAAM,GAAG,QAAQ,CAAC,WAAW,EAAE,OAAO,IAAI,CAAC,EAAE,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;;AAEzE,EAAO,IAAI,KAAK,GAAG,QAAQ,CAAC,WAAW,EAAE,OAAO,KAAK,CAAC,EAAE,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;;ECf1E,SAAS,GAAG,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE;EACnC,EAAE,IAAI,IAAI,GAAG,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;EAClD,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;EACvC,CAAC;;AAED,EAAO,IAAI,IAAI,IAAI,CAAC,CAAC;AACrB,EAAO,IAAIC,OAAK,GAAG,CAAC,CAAC;AACrB,EAAO,IAAI,IAAI,IAAI,CAAC,CAAC;AACrB,EAAO,IAAI,IAAI,IAAI,CAAC,CAAC;AACrB,EAAO,IAAI,KAAK,GAAG,CAAC,CAAC;;AAErB,EAAe,eAAQ,CAAC,CAAC,EAAE;EAC3B,EAAE,IAAI,KAAK,GAAG,CAAC,IAAI,IAAI,CAAC;EACxB,EAAE,OAAO;EACT,IAAI,KAAK,EAAE,SAAS,CAAC,EAAE;EACvB,MAAM,IAAI,SAAS,CAAC,MAAM,EAAE;EAC5B,QAAQ,KAAK,GAAG,CAAC,CAAC,CAAC;EACnB,QAAQ,OAAO,IAAI,CAAC;EACpB,OAAO,MAAM;EACb,QAAQ,OAAO,KAAK,CAAC;EACrB,OAAO;EACP,KAAK;EACL,IAAI,KAAK,EAAE,WAAW;EACtB,MAAM,IAAI,KAAK,IAAIA,OAAK,EAAE,GAAG,CAAC,OAAO,EAAE,OAAO,EAAE,SAAS,CAAC,CAAC;EAC3D,MAAM,OAAO,IAAI,CAAC;EAClB,KAAK;EACL,IAAI,IAAI,EAAE,WAAW;EACrB,MAAM,IAAI,KAAK,IAAI,IAAI,EAAE,GAAG,CAAC,MAAM,EAAE,MAAM,EAAE,SAAS,CAAC,CAAC;EACxD,MAAM,OAAO,IAAI,CAAC;EAClB,KAAK;EACL,IAAI,IAAI,EAAE,WAAW;EACrB,MAAM,IAAI,KAAK,IAAI,IAAI,EAAE,GAAG,CAAC,KAAK,EAAE,MAAM,EAAE,SAAS,CAAC,CAAC;EACvD,MAAM,OAAO,IAAI,CAAC;EAClB,KAAK;EACL,IAAI,KAAK,EAAE,WAAW;EACtB,MAAM,IAAI,KAAK,IAAI,KAAK,EAAE,GAAG,CAAC,KAAK,EAAE,OAAO,EAAE,SAAS,CAAC,CAAC;EACzD,MAAM,OAAO,IAAI,CAAC;EAClB,KAAK;EACL,GAAG;EACH,CAAC;;ECvCc,kBAAQ,CAAC,CAAC,EAAE;EAC3B,EAAE,OAAO,OAAO,CAAC,KAAK,SAAS,CAAC;EAChC,CAAC;;ECFc,iBAAQ,CAAC,CAAC,EAAE;EAC3B,EAAE,OAAO,OAAO,CAAC,KAAK,QAAQ,CAAC;EAC/B,CAAC;;ECFc,cAAQ,CAAC,CAAC,EAAE;EAC3B,EAAE,KAAK,IAAI,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;EAC3D,EAAE,OAAO,CAAC,CAAC;EACX,CAAC;;ECHD;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;;EAEA,IAAI,aAAa,GAAG,MAAM,CAAC,cAAc;EACzC,KAAK,EAAE,SAAS,EAAE,EAAE,EAAE,YAAY,KAAK,IAAI,UAAU,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,EAAE,CAAC;EAChF,IAAI,UAAU,CAAC,EAAE,CAAC,EAAE,EAAE,KAAK,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;;AAE/E,EAAO,SAAS,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE;EAChC,IAAI,aAAa,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EACxB,IAAI,SAAS,EAAE,GAAG,EAAE,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC,EAAE;EAC3C,IAAI,CAAC,CAAC,SAAS,GAAG,CAAC,KAAK,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,SAAS,GAAG,CAAC,CAAC,SAAS,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC;EACzF,CAAC;;AAED,EAAO,IAAI,QAAQ,GAAG,MAAM,CAAC,MAAM,IAAI,SAAS,QAAQ,CAAC,CAAC,EAAE;EAC5D,IAAI,KAAK,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;EACzD,QAAQ,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;EACzB,QAAQ,KAAK,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;EACrF,KAAK;EACL,IAAI,OAAO,CAAC,CAAC;EACb,EAAC;;AAED,EAAO,SAAS,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE;EAC7B,IAAI,IAAI,CAAC,GAAG,EAAE,CAAC;EACf,IAAI,KAAK,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC;EACvF,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;EACpB,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,OAAO,MAAM,CAAC,qBAAqB,KAAK,UAAU;EACvE,QAAQ,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,qBAAqB,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;EACvG,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAC9B,IAAI,OAAO,CAAC,CAAC;EACb,CAAC;;EC1CD,IAAI,EAAE;MACF,EAAE;MACF,OAAO,GAAG;UACN,GAAG,GAAG,GAAG;UACT,IAAI,EAAE,IAAI;UACV,GAAG,GAAG,GAAG;UACT,CAAC,KAAK,IAAI;UACV,CAAC,KAAK,IAAI;UACV,CAAC,KAAK,IAAI;UACV,CAAC,KAAK,IAAI;UACV,CAAC,KAAK,IAAI;OACb;MACD,IAAI;;MAEJC,OAAK,GAAG,UAAU,CAAC,EAAE;;UAEjB,MAAM;cACF,IAAI,KAAK,aAAa;cACtB,OAAO,EAAE,CAAC;cACV,EAAE,OAAO,EAAE;cACX,IAAI,KAAK,IAAI;WAChB,CAAC;OACL;;MAED,IAAI,GAAG,UAAU,CAAC,EAAE;;UAEhB,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,EAAE;cACfA,OAAK,CAAC,YAAY,GAAG,CAAC,GAAG,gBAAgB,GAAG,EAAE,GAAG,GAAG,CAAC,CAAC;WACzD;;;;;UAKD,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;UACrB,EAAE,IAAI,CAAC,CAAC;UACR,OAAO,EAAE,CAAC;OACb;;MAED,MAAM,GAAG,YAAY;;UAEjB,IAAI,MAAM;cACN,MAAM,GAAG,EAAE,CAAC;;UAEhB,IAAI,EAAE,KAAK,GAAG,EAAE;cACZ,MAAM,GAAG,GAAG,CAAC;cACb,IAAI,CAAC,GAAG,CAAC,CAAC;WACb;UACD,OAAO,EAAE,IAAI,GAAG,IAAI,EAAE,IAAI,GAAG,EAAE;cAC3B,MAAM,IAAI,EAAE,CAAC;cACb,IAAI,EAAE,CAAC;WACV;UACD,IAAI,EAAE,KAAK,GAAG,EAAE;cACZ,MAAM,IAAI,GAAG,CAAC;cACd,OAAO,IAAI,EAAE,IAAI,EAAE,IAAI,GAAG,IAAI,EAAE,IAAI,GAAG,EAAE;kBACrC,MAAM,IAAI,EAAE,CAAC;eAChB;WACJ;UACD,IAAI,EAAE,KAAK,GAAG,IAAI,EAAE,KAAK,GAAG,EAAE;cAC1B,MAAM,IAAI,EAAE,CAAC;cACb,IAAI,EAAE,CAAC;cACP,IAAI,EAAE,KAAK,GAAG,IAAI,EAAE,KAAK,GAAG,EAAE;kBAC1B,MAAM,IAAI,EAAE,CAAC;kBACb,IAAI,EAAE,CAAC;eACV;cACD,OAAO,EAAE,IAAI,GAAG,IAAI,EAAE,IAAI,GAAG,EAAE;kBAC3B,MAAM,IAAI,EAAE,CAAC;kBACb,IAAI,EAAE,CAAC;eACV;WACJ;UACD,MAAM,GAAG,CAAC,MAAM,CAAC;UACjB,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;cACnBA,OAAK,CAAC,YAAY,CAAC,CAAC;WACvB,MAAM;cACH,OAAO,MAAM,CAAC;WACjB;OACJ;;MAED,MAAM,GAAG,YAAY;;UAEjB,IAAI,GAAG;cACH,CAAC;cACD,MAAM,GAAG,EAAE;cACX,KAAK,CAAC;;;UAGV,IAAI,EAAE,KAAK,GAAG,EAAE;cACZ,OAAO,IAAI,EAAE,EAAE;kBACX,IAAI,EAAE,KAAK,GAAG,EAAE;sBACZ,IAAI,EAAE,CAAC;sBACP,OAAO,MAAM,CAAC;mBACjB,MAAM,IAAI,EAAE,KAAK,IAAI,EAAE;sBACpB,IAAI,EAAE,CAAC;sBACP,IAAI,EAAE,KAAK,GAAG,EAAE;0BACZ,KAAK,GAAG,CAAC,CAAC;0BACV,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE;8BACvB,GAAG,GAAG,QAAQ,CAAC,IAAI,EAAE,EAAE,EAAE,CAAC,CAAC;8BAC3B,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;kCAChB,MAAM;+BACT;8BACD,KAAK,GAAG,KAAK,GAAG,EAAE,GAAG,GAAG,CAAC;2BAC5B;0BACD,MAAM,IAAI,MAAM,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;uBACxC,MAAM,IAAI,OAAO,OAAO,CAAC,EAAE,CAAC,KAAK,QAAQ,EAAE;0BACxC,MAAM,IAAI,OAAO,CAAC,EAAE,CAAC,CAAC;uBACzB,MAAM;0BACH,MAAM;uBACT;mBACJ,MAAM;sBACH,MAAM,IAAI,EAAE,CAAC;mBAChB;eACJ;WACJ;UACDA,OAAK,CAAC,YAAY,CAAC,CAAC;OACvB;;MAED,KAAK,GAAG,YAAY;;;;UAIhB,OAAO,EAAE,IAAI,EAAE,IAAI,GAAG,EAAE;cACpB,IAAI,EAAE,CAAC;WACV;OACJ;;MAED,IAAI,GAAG,YAAY;;;;UAIf,QAAQ,EAAE;UACV,KAAK,GAAG;cACJ,IAAI,CAAC,GAAG,CAAC,CAAC;cACV,IAAI,CAAC,GAAG,CAAC,CAAC;cACV,IAAI,CAAC,GAAG,CAAC,CAAC;cACV,IAAI,CAAC,GAAG,CAAC,CAAC;cACV,OAAO,IAAI,CAAC;UAChB,KAAK,GAAG;cACJ,IAAI,CAAC,GAAG,CAAC,CAAC;cACV,IAAI,CAAC,GAAG,CAAC,CAAC;cACV,IAAI,CAAC,GAAG,CAAC,CAAC;cACV,IAAI,CAAC,GAAG,CAAC,CAAC;cACV,IAAI,CAAC,GAAG,CAAC,CAAC;cACV,OAAO,KAAK,CAAC;UACjB,KAAK,GAAG;cACJ,IAAI,CAAC,GAAG,CAAC,CAAC;cACV,IAAI,CAAC,GAAG,CAAC,CAAC;cACV,IAAI,CAAC,GAAG,CAAC,CAAC;cACV,IAAI,CAAC,GAAG,CAAC,CAAC;cACV,OAAO,IAAI,CAAC;WACf;UACDA,OAAK,CAAC,cAAc,GAAG,EAAE,GAAG,GAAG,CAAC,CAAC;OACpC;;MAED,KAAK;;MAELC,OAAK,GAAG,YAAY;;;;UAIhB,IAAI,KAAK,GAAG,EAAE,CAAC;;UAEf,IAAI,EAAE,KAAK,GAAG,EAAE;cACZ,IAAI,CAAC,GAAG,CAAC,CAAC;cACV,KAAK,EAAE,CAAC;cACR,IAAI,EAAE,KAAK,GAAG,EAAE;kBACZ,IAAI,CAAC,GAAG,CAAC,CAAC;kBACV,OAAO,KAAK,CAAC;eAChB;cACD,OAAO,EAAE,EAAE;kBACP,KAAK,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC;kBACpB,KAAK,EAAE,CAAC;kBACR,IAAI,EAAE,KAAK,GAAG,EAAE;sBACZ,IAAI,CAAC,GAAG,CAAC,CAAC;sBACV,OAAO,KAAK,CAAC;mBAChB;kBACD,IAAI,CAAC,GAAG,CAAC,CAAC;kBACV,KAAK,EAAE,CAAC;eACX;WACJ;UACDD,OAAK,CAAC,WAAW,CAAC,CAAC;OACtB;;MAED,MAAM,GAAG,YAAY;;;;UAIjB,IAAI,GAAG;cACH,MAAM,GAAG,EAAE,CAAC;;UAEhB,IAAI,EAAE,KAAK,GAAG,EAAE;cACZ,IAAI,CAAC,GAAG,CAAC,CAAC;cACV,KAAK,EAAE,CAAC;cACR,IAAI,EAAE,KAAK,GAAG,EAAE;kBACZ,IAAI,CAAC,GAAG,CAAC,CAAC;kBACV,OAAO,MAAM,CAAC;eACjB;cACD,OAAO,EAAE,EAAE;kBACP,GAAG,GAAG,MAAM,EAAE,CAAC;kBACf,KAAK,EAAE,CAAC;kBACR,IAAI,CAAC,GAAG,CAAC,CAAC;kBACV,IAAI,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE;sBACzCA,OAAK,CAAC,iBAAiB,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;mBACxC;kBACD,MAAM,CAAC,GAAG,CAAC,GAAG,KAAK,EAAE,CAAC;kBACtB,KAAK,EAAE,CAAC;kBACR,IAAI,EAAE,KAAK,GAAG,EAAE;sBACZ,IAAI,CAAC,GAAG,CAAC,CAAC;sBACV,OAAO,MAAM,CAAC;mBACjB;kBACD,IAAI,CAAC,GAAG,CAAC,CAAC;kBACV,KAAK,EAAE,CAAC;eACX;WACJ;UACDA,OAAK,CAAC,YAAY,CAAC,CAAC;OACvB,CAAC;;EAEN,KAAK,GAAG,YAAY;;;;;MAKhB,KAAK,EAAE,CAAC;MACR,QAAQ,EAAE;MACV,KAAK,GAAG;UACJ,OAAO,MAAM,EAAE,CAAC;MACpB,KAAK,GAAG;UACJ,OAAOC,OAAK,EAAE,CAAC;MACnB,KAAK,GAAG;UACJ,OAAO,MAAM,EAAE,CAAC;MACpB,KAAK,GAAG;UACJ,OAAO,MAAM,EAAE,CAAC;MACpB;UACI,OAAO,EAAE,IAAI,GAAG,IAAI,EAAE,IAAI,GAAG,GAAG,MAAM,EAAE,GAAG,IAAI,EAAE,CAAC;OACrD;GACJ,CAAC;;;;;EAKF,SAAc,GAAG,UAAU,MAAM,EAAE,OAAO,EAAE;MACxC,IAAI,MAAM,CAAC;;MAEX,IAAI,GAAG,MAAM,CAAC;MACd,EAAE,GAAG,CAAC,CAAC;MACP,EAAE,GAAG,GAAG,CAAC;MACT,MAAM,GAAG,KAAK,EAAE,CAAC;MACjB,KAAK,EAAE,CAAC;MACR,IAAI,EAAE,EAAE;UACJD,OAAK,CAAC,cAAc,CAAC,CAAC;OACzB;;;;;;;;MAQD,OAAO,OAAO,OAAO,KAAK,UAAU,IAAI,SAAS,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE;UAC/D,IAAI,CAAC,EAAE,CAAC,EAAE,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;UAC9B,IAAI,KAAK,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;cACpC,KAAK,CAAC,IAAI,KAAK,EAAE;kBACb,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC,EAAE;sBAChD,CAAC,GAAG,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;sBACnB,IAAI,CAAC,KAAK,SAAS,EAAE;0BACjB,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;uBAChB,MAAM;0BACH,OAAO,KAAK,CAAC,CAAC,CAAC,CAAC;uBACnB;mBACJ;eACJ;WACJ;UACD,OAAO,OAAO,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;OAC3C,CAAC,CAAC,EAAE,EAAE,MAAM,CAAC,EAAE,EAAE,CAAC,IAAI,MAAM,CAAC;GACjC,CAAC;;MC/QE,SAAS,GAAG,0HAA0H;MACtI,GAAG;MACH,MAAM;MACN,IAAI,GAAG;UACH,IAAI,EAAE,KAAK;UACX,IAAI,EAAE,KAAK;UACX,IAAI,EAAE,KAAK;UACX,IAAI,EAAE,KAAK;UACX,IAAI,EAAE,KAAK;UACX,GAAG,GAAG,KAAK;UACX,IAAI,EAAE,MAAM;OACf;MACD,GAAG,CAAC;;EAER,SAAS,KAAK,CAAC,MAAM,EAAE;;;;;;MAMnB,SAAS,CAAC,SAAS,GAAG,CAAC,CAAC;MACxB,OAAO,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,GAAG,GAAG,MAAM,CAAC,OAAO,CAAC,SAAS,EAAE,UAAU,CAAC,EAAE;UACzE,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;UAChB,OAAO,OAAO,CAAC,KAAK,QAAQ,GAAG,CAAC;cAC5B,KAAK,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;OACjE,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,MAAM,GAAG,GAAG,CAAC;GACjC;;EAED,SAAS,GAAG,CAAC,GAAG,EAAE,MAAM,EAAE;;MAEtB,IAAI,CAAC;UACD,CAAC;UACD,CAAC;UACD,MAAM;UACN,IAAI,GAAG,GAAG;UACV,OAAO;UACP,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;;;MAGxB,IAAI,KAAK,IAAI,OAAO,KAAK,KAAK,QAAQ;cAC9B,OAAO,KAAK,CAAC,MAAM,KAAK,UAAU,EAAE;UACxC,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;OAC7B;;;;MAID,IAAI,OAAO,GAAG,KAAK,UAAU,EAAE;UAC3B,KAAK,GAAG,GAAG,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;OACxC;;;MAGD,QAAQ,OAAO,KAAK;UAChB,KAAK,QAAQ;cACT,OAAO,KAAK,CAAC,KAAK,CAAC,CAAC;;UAExB,KAAK,QAAQ;;cAET,OAAO,QAAQ,CAAC,KAAK,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,GAAG,MAAM,CAAC;;UAEpD,KAAK,SAAS,CAAC;UACf,KAAK,MAAM;;;;cAIP,OAAO,MAAM,CAAC,KAAK,CAAC,CAAC;;UAEzB,KAAK,QAAQ;cACT,IAAI,CAAC,KAAK,EAAE,OAAO,MAAM,CAAC;cAC1B,GAAG,IAAI,MAAM,CAAC;cACd,OAAO,GAAG,EAAE,CAAC;;;cAGb,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,gBAAgB,EAAE;kBAC7D,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;kBACtB,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE;sBAC5B,OAAO,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,EAAE,KAAK,CAAC,IAAI,MAAM,CAAC;mBACxC;;;;kBAID,CAAC,GAAG,OAAO,CAAC,MAAM,KAAK,CAAC,GAAG,IAAI,GAAG,GAAG;sBACjC,KAAK,GAAG,GAAG,GAAG,OAAO,CAAC,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC,GAAG,IAAI,GAAG,IAAI,GAAG,GAAG;sBAC3D,GAAG,GAAG,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;kBAClC,GAAG,GAAG,IAAI,CAAC;kBACX,OAAO,CAAC,CAAC;eACZ;;;;cAID,IAAI,GAAG,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;kBAChC,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC;kBACpB,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE;sBAC5B,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;sBACX,IAAI,OAAO,CAAC,KAAK,QAAQ,EAAE;0BACvB,CAAC,GAAG,GAAG,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;0BAClB,IAAI,CAAC,EAAE;8BACH,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,GAAG,GAAG,IAAI,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;2BACnD;uBACJ;mBACJ;eACJ;mBACI;;kBAED,KAAK,CAAC,IAAI,KAAK,EAAE;sBACb,IAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC,EAAE;0BAChD,CAAC,GAAG,GAAG,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;0BAClB,IAAI,CAAC,EAAE;8BACH,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,GAAG,GAAG,IAAI,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;2BACnD;uBACJ;mBACJ;eACJ;;;;;UAKL,CAAC,GAAG,OAAO,CAAC,MAAM,KAAK,CAAC,GAAG,IAAI,GAAG,GAAG;cACjC,KAAK,GAAG,GAAG,GAAG,OAAO,CAAC,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC,GAAG,IAAI,GAAG,IAAI,GAAG,GAAG;cAC3D,GAAG,GAAG,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;UAClC,GAAG,GAAG,IAAI,CAAC;UACX,OAAO,CAAC,CAAC;OACZ;GACJ;;EAED,aAAc,GAAG,UAAU,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE;MAC/C,IAAI,CAAC,CAAC;MACN,GAAG,GAAG,EAAE,CAAC;MACT,MAAM,GAAG,EAAE,CAAC;;;;MAIZ,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;UAC3B,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,EAAE,CAAC,IAAI,CAAC,EAAE;cAC3B,MAAM,IAAI,GAAG,CAAC;WACjB;OACJ;;WAEI,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;UAChC,MAAM,GAAG,KAAK,CAAC;OAClB;;;;MAID,GAAG,GAAG,QAAQ,CAAC;MACf,IAAI,QAAQ,IAAI,OAAO,QAAQ,KAAK,UAAU;UAC1C,OAAO,QAAQ,KAAK,QAAQ,IAAI,OAAO,QAAQ,CAAC,MAAM,KAAK,QAAQ,CAAC,EAAE;UACtE,MAAM,IAAI,KAAK,CAAC,gBAAgB,CAAC,CAAC;OACrC;;;;MAID,OAAO,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC,CAAC;GAC/B,CAAC;;ECzJF,WAAa,GAAGE,KAAsB,CAAC;EACvC,eAAiB,GAAGC,SAA0B,CAAC;;;;;;;ECD/C,IAAI,IAAI,GAAG,OAAO,IAAI,KAAK,WAAW,GAAG,IAAI,GAAGD,OAAkB,CAAC;;EAEnE,uBAAc,GAAG,UAAU,GAAG,EAAE,IAAI,EAAE;MAClC,IAAI,CAAC,IAAI,EAAE,IAAI,GAAG,EAAE,CAAC;MACrB,IAAI,OAAO,IAAI,KAAK,UAAU,EAAE,IAAI,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC;MACrD,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,IAAI,EAAE,CAAC;MAC7B,IAAI,OAAO,KAAK,KAAK,QAAQ,EAAE,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;MAChE,IAAI,MAAM,GAAG,CAAC,OAAO,IAAI,CAAC,MAAM,KAAK,SAAS,IAAI,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;MACtE,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,IAAI,SAAS,GAAG,EAAE,KAAK,EAAE,EAAE,OAAO,KAAK,CAAC,EAAE,CAAC;;MAEvE,IAAI,GAAG,GAAG,IAAI,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,EAAE;UAChC,OAAO,UAAU,IAAI,EAAE;cACnB,OAAO,UAAU,CAAC,EAAE,CAAC,EAAE;kBACnB,IAAI,IAAI,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;kBACtC,IAAI,IAAI,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;kBACtC,OAAO,CAAC,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;eACxB,CAAC;WACL,CAAC;OACL,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC;;MAEb,IAAI,IAAI,GAAG,EAAE,CAAC;MACd,OAAO,CAAC,SAAS,SAAS,EAAE,MAAM,EAAE,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE;UAClD,IAAI,MAAM,GAAG,KAAK,IAAI,IAAI,GAAG,IAAI,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;UACpE,IAAI,cAAc,GAAG,KAAK,GAAG,IAAI,GAAG,GAAG,CAAC;;UAExC,IAAI,IAAI,IAAI,IAAI,CAAC,MAAM,IAAI,OAAO,IAAI,CAAC,MAAM,KAAK,UAAU,EAAE;cAC1D,IAAI,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;WACxB;;UAED,IAAI,GAAG,QAAQ,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;;UAExC,IAAI,IAAI,KAAK,SAAS,EAAE;cACpB,OAAO;WACV;UACD,IAAI,OAAO,IAAI,KAAK,QAAQ,IAAI,IAAI,KAAK,IAAI,EAAE;cAC3C,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;WAC/B;UACD,IAAIE,SAAO,CAAC,IAAI,CAAC,EAAE;cACf,IAAI,GAAG,GAAG,EAAE,CAAC;cACb,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;kBAClC,IAAI,IAAI,GAAG,SAAS,CAAC,IAAI,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;kBACxE,GAAG,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,GAAG,IAAI,CAAC,CAAC;eACnC;cACD,OAAO,GAAG,GAAG,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,MAAM,GAAG,GAAG,CAAC;WAC7C;eACI;cACD,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE;kBAC3B,IAAI,MAAM,EAAE,OAAO,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;kBAC/C,MAAM,IAAI,SAAS,CAAC,uCAAuC,CAAC,CAAC;eAChE;mBACI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;;cAErB,IAAI,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,GAAG,IAAI,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;cACnD,IAAI,GAAG,GAAG,EAAE,CAAC;cACb,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;kBAClC,IAAI,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;kBAClB,IAAI,KAAK,GAAG,SAAS,CAAC,IAAI,EAAE,GAAG,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;;kBAErD,GAAG,CAAC,KAAK,EAAE,SAAS;;kBAEpB,IAAI,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC;wBAC5B,cAAc;wBACd,KAAK,CAAC;kBAEZ,GAAG,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,GAAG,QAAQ,CAAC,CAAC;eACvC;cACD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC;cACnC,OAAO,GAAG,GAAG,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,MAAM,GAAG,GAAG,CAAC;WAC7C;OACJ,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC;GAC/B,CAAC;;EAEF,IAAIA,SAAO,GAAG,KAAK,CAAC,OAAO,IAAI,UAAU,CAAC,EAAE;MACxC,OAAO,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,gBAAgB,CAAC;GACnD,CAAC;;EAEF,IAAI,UAAU,GAAG,MAAM,CAAC,IAAI,IAAI,UAAU,GAAG,EAAE;MAC3C,IAAI,GAAG,GAAG,MAAM,CAAC,SAAS,CAAC,cAAc,IAAI,YAAY,EAAE,OAAO,IAAI,EAAE,CAAC;MACzE,IAAI,IAAI,GAAG,EAAE,CAAC;MACd,KAAK,IAAI,GAAG,IAAI,GAAG,EAAE;UACjB,IAAI,GAAG,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;OAC1C;MACD,OAAO,IAAI,CAAC;GACf,CAAC;;ECnFK,SAAS,WAAW,CAAC,EAAE,EAAE;EAChC,IAAI,OAAO,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC;EACnB,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,EAAE,EAAE;EACjC,IAAI,OAAO,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC;EACpB,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,EAAE,EAAE;EACjC,IAAI,OAAO,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC;EACpB,CAAC;AACD,EAAO,SAAS,WAAW,CAAC,EAAE,EAAE,EAAE,EAAE;EACpC,IAAI,IAAI,YAAY,CAAC,EAAE,CAAC,EAAE;EAC1B,QAAQ,WAAW,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC;EAChC,KAAK;EACL,SAAS,IAAI,YAAY,CAAC,EAAE,CAAC,EAAE;EAC/B,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC5D,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,WAAW,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;EACnC,SAAS;EACT,KAAK;EACL,SAAS,IAAI,WAAW,CAAC,EAAE,CAAC,EAAE;EAC9B,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC3D,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,WAAW,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;EACnC,SAAS;EACT,KAAK;EACL,SAAS;EACT,QAAQ,EAAE,CAAC,EAAE,CAAC,CAAC;EACf,KAAK;EACL,CAAC;AACD,EAAO,SAAS,uBAAuB,CAAC,EAAE,EAAE,UAAU,EAAE;EACxD,IAAI,IAAI,YAAY,CAAC,EAAE,CAAC,EAAE;EAC1B,QAAQ,OAAO,EAAE,GAAG,EAAE,uBAAuB,CAAC,EAAE,CAAC,GAAG,EAAE,UAAU,CAAC,EAAE,CAAC;EACpE,KAAK;EACL,SAAS,IAAI,YAAY,CAAC,EAAE,CAAC,EAAE;EAC/B,QAAQ,OAAO,EAAE,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,uBAAuB,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC;EACpG,KAAK;EACL,SAAS,IAAI,WAAW,CAAC,EAAE,CAAC,EAAE;EAC9B,QAAQ,OAAO,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,uBAAuB,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC;EAClG,KAAK;EACL,SAAS;EACT,QAAQ,OAAO,UAAU,CAAC,EAAE,CAAC,CAAC;EAC9B,KAAK;EACL,CAAC;;ECtCD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,IAAI,CAAC,GAAG,EAAE,KAAK,EAAE;EACjC,IAAI,IAAI,IAAI,GAAG,EAAE,CAAC;EAClB,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,OAAO,GAAG,KAAK,EAAE,EAAE,GAAG,OAAO,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACjE,QAAQ,IAAI,IAAI,GAAG,OAAO,CAAC,EAAE,CAAC,CAAC;EAC/B,QAAQ,IAAI,GAAG,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;EACtC,YAAY,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;EACnC,SAAS;EACT,KAAK;EACL,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;EACD;EACA;EACA;EACA;AACA,EAAO,SAAS,IAAI,CAAC,GAAG,EAAE,KAAK,EAAE;EACjC,IAAI,IAAI,IAAI,GAAGC,QAAgB,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;EACzC,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,OAAO,GAAG,KAAK,EAAE,EAAE,GAAG,OAAO,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACjE,QAAQ,IAAI,IAAI,GAAG,OAAO,CAAC,EAAE,CAAC,CAAC;EAC/B,QAAQ,OAAO,IAAI,CAAC,IAAI,CAAC,CAAC;EAC1B,KAAK;EACL,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;EACD;EACA;EACA;AACA,EAAO,IAAIC,WAAS,GAAGC,mBAAe,CAAC;EACvC;EACA;EACA;AACA,EAAO,SAAS,IAAI,CAAC,CAAC,EAAE;EACxB,IAAI,IAAI,QAAQ,CAAC,CAAC,CAAC,EAAE;EACrB,QAAQ,OAAO,CAAC,CAAC;EACjB,KAAK;EACL,IAAI,IAAI,GAAG,GAAG,QAAQ,CAAC,CAAC,CAAC,GAAG,CAAC,GAAGA,mBAAe,CAAC,CAAC,CAAC,CAAC;EACnD;EACA,IAAI,IAAI,GAAG,CAAC,MAAM,GAAG,GAAG,EAAE;EAC1B,QAAQ,OAAO,GAAG,CAAC;EACnB,KAAK;EACL;EACA,IAAI,IAAI,CAAC,GAAG,CAAC,CAAC;EACd,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;EACzC,QAAQ,IAAI,IAAI,GAAG,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;EACrC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC;EAClC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;EAClB,KAAK;EACL,IAAI,OAAO,CAAC,CAAC;EACb,CAAC;AACD,EAAO,SAAS,QAAQ,CAACN,QAAK,EAAE,IAAI,EAAE;EACtC,IAAI,OAAOA,QAAK,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;EACpC,CAAC;EACD;AACA,EAAO,SAAS,OAAO,CAACA,QAAK,EAAE,aAAa,EAAE;EAC9C,IAAI,OAAOA,QAAK,CAAC,MAAM,CAAC,UAAU,IAAI,EAAE,EAAE,OAAO,CAAC,QAAQ,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;EACpF,CAAC;AACD,EAAO,SAAS,KAAK,CAACA,QAAK,EAAE,KAAK,EAAE;EACpC,IAAI,OAAOA,QAAK,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,EAAEA,QAAK,CAAC,CAAC,CAAC;EAC/C,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,IAAI,CAAC,GAAG,EAAE,CAAC,EAAE;EAC7B,IAAI,IAAI,CAAC,GAAG,CAAC,CAAC;EACd,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;EACzC,QAAQ,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE;EAC/B,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,KAAK;EACL,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,KAAK,CAAC,GAAG,EAAE,CAAC,EAAE;EAC9B,IAAI,IAAI,CAAC,GAAG,CAAC,CAAC;EACd,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;EACzC,QAAQ,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE;EAChC,YAAY,OAAO,KAAK,CAAC;EACzB,SAAS;EACT,KAAK;EACL,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;AACD,EAAO,SAAS,OAAO,CAAC,MAAM,EAAE;EAChC,IAAI,OAAO,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;EACvC,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,SAAS,CAAC,IAAI,EAAE;EAChC,IAAI,IAAI,GAAG,GAAG,EAAE,CAAC;EACjB,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,SAAS,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAClD,QAAQ,GAAG,CAAC,EAAE,GAAG,CAAC,CAAC,GAAG,SAAS,CAAC,EAAE,CAAC,CAAC;EACpC,KAAK;EACL,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,KAAK,GAAG,GAAG,EAAE,EAAE,GAAG,KAAK,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC3D,QAAQ,IAAI,CAAC,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC;EAC1B,QAAQ,IAAI,GAAG,UAAU,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;EACnC,KAAK;EACL,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;EACD;EACA,SAAS,UAAU,CAAC,IAAI,EAAE,GAAG,EAAE;EAC/B,IAAI,IAAI,OAAO,GAAG,KAAK,QAAQ,IAAI,GAAG,KAAK,IAAI,EAAE;EACjD,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,IAAI,KAAK,IAAI,CAAC,IAAI,GAAG,EAAE;EACvB,QAAQ,IAAI,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC,CAAC,EAAE;EACpC,YAAY,SAAS;EACrB,SAAS;EACT,QAAQ,IAAI,GAAG,CAAC,CAAC,CAAC,KAAK,SAAS,EAAE;EAClC,YAAY,SAAS;EACrB,SAAS;EACT,QAAQ,IAAI,OAAO,GAAG,CAAC,CAAC,CAAC,KAAK,QAAQ,IAAI,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC,KAAK,IAAI,EAAE;EAC9E,YAAY,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;EAC7B,SAAS;EACT,aAAa,IAAI,OAAO,IAAI,CAAC,CAAC,CAAC,KAAK,QAAQ,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,IAAI,EAAE;EAClE,YAAY,IAAI,CAAC,CAAC,CAAC,GAAG,SAAS,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;EAC/E,SAAS;EACT,aAAa;EACb,YAAY,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;EACvC,SAAS;EACT,KAAK;EACL,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;AACD,EAAO,SAAS,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE;EAClC,IAAI,IAAI,OAAO,GAAG,EAAE,CAAC;EACrB,IAAI,IAAI,CAAC,GAAG,EAAE,CAAC;EACf,IAAI,IAAI,CAAC,CAAC;EACV,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,QAAQ,GAAG,MAAM,EAAE,EAAE,GAAG,QAAQ,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACpE,QAAQ,IAAI,GAAG,GAAG,QAAQ,CAAC,EAAE,CAAC,CAAC;EAC/B,QAAQ,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;EACnB,QAAQ,IAAI,CAAC,IAAI,CAAC,EAAE;EACpB,YAAY,SAAS;EACrB,SAAS;EACT,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;EACjB,QAAQ,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;EAC1B,KAAK;EACL,IAAI,OAAO,OAAO,CAAC;EACnB,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,MAAM,CAAC,IAAI,EAAE,KAAK,EAAE;EACpC,IAAI,KAAK,IAAIO,MAAG,IAAI,IAAI,EAAE;EAC1B,QAAQ,IAAI,IAAI,CAAC,cAAc,CAACA,MAAG,CAAC,EAAE;EACtC,YAAY,IAAI,KAAK,CAACA,MAAG,CAAC,IAAI,IAAI,CAACA,MAAG,CAAC,IAAI,KAAK,CAACA,MAAG,CAAC,KAAK,IAAI,CAACA,MAAG,CAAC,EAAE;EACrE,gBAAgB,OAAO,IAAI,CAAC;EAC5B,aAAa;EACb,SAAS;EACT,KAAK;EACL,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;AACD,EAAO,SAAS,eAAe,CAAC,CAAC,EAAE,CAAC,EAAE;EACtC,IAAI,KAAK,IAAIA,MAAG,IAAI,CAAC,EAAE;EACvB,QAAQ,IAAIA,MAAG,IAAI,CAAC,EAAE;EACtB,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,KAAK;EACL,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;AACD,EAAO,SAAS,SAAS,CAAC,GAAG,EAAE;EAC/B,IAAI,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;EACvB,CAAC;AACD,EAAO,SAAS,WAAW,CAACP,QAAK,EAAE,KAAK,EAAE;EAC1C,IAAI,IAAIA,QAAK,CAAC,MAAM,KAAK,KAAK,CAAC,MAAM,EAAE;EACvC,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,IAAIA,QAAK,CAAC,IAAI,EAAE,CAAC;EACjB,IAAI,KAAK,CAAC,IAAI,EAAE,CAAC;EACjB,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAGA,QAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;EAC3C,QAAQ,IAAI,KAAK,CAAC,CAAC,CAAC,KAAKA,QAAK,CAAC,CAAC,CAAC,EAAE;EACnC,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,KAAK;EACL,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;EACD;AACA,EAAO,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC;AAC9B,EAAO,SAAS,IAAI,CAAC,CAAC,EAAE;EACxB,IAAI,IAAI,KAAK,GAAG,EAAE,CAAC;EACnB,IAAI,KAAK,IAAI,CAAC,IAAI,CAAC,EAAE;EACrB,QAAQ,IAAI,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,EAAE;EACjC,YAAY,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAC7B,SAAS;EACT,KAAK;EACL,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;AACD,EAAO,SAAS,QAAQ,CAAC,CAAC,EAAE;EAC5B,IAAI,OAAO,IAAI,CAAC,CAAC,CAAC,CAAC;EACnB,CAAC;AACD,EAAO,SAAS,SAAS,CAAC,GAAG,EAAE;EAC/B,IAAI,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC;EAC3C,CAAC;AACD,EAAO,SAASQ,WAAS,CAAC,CAAC,EAAE;EAC7B,IAAI,OAAO,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,KAAK,CAAC;EACrC,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,OAAO,CAAC,CAAC,EAAE;EAC3B;EACA,IAAI,IAAI,aAAa,GAAG,CAAC,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;EAC9C;EACA,IAAI,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,GAAG,GAAG,EAAE,IAAI,aAAa,CAAC;EACxD,CAAC;AACD,EAAO,SAAS,WAAW,CAAC,EAAE,EAAE,EAAE,EAAE;EACpC,IAAI,IAAI,YAAY,CAAC,EAAE,CAAC,EAAE;EAC1B,QAAQ,OAAO,IAAI,GAAG,WAAW,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,GAAG,CAAC;EACpD,KAAK;EACL,SAAS,IAAI,YAAY,CAAC,EAAE,CAAC,EAAE;EAC/B,QAAQ,OAAO,GAAG,GAAG,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,UAAU,GAAG,EAAE,EAAE,OAAO,WAAW,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,GAAG,CAAC;EACtG,KAAK;EACL,SAAS,IAAI,WAAW,CAAC,EAAE,CAAC,EAAE;EAC9B,QAAQ,OAAO,GAAG,GAAG,EAAE,CAAC,EAAE,CAAC,GAAG,CAAC,UAAU,EAAE,EAAE,EAAE,OAAO,WAAW,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,GAAG,CAAC;EACnG,KAAK;EACL,SAAS;EACT,QAAQ,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;EACtB,KAAK;EACL,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,oBAAoB,CAAC,GAAG,EAAE,YAAY,EAAE;EACxD,IAAI,IAAI,YAAY,CAAC,MAAM,KAAK,CAAC,EAAE;EACnC,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,IAAI,IAAI,IAAI,GAAG,YAAY,CAAC,KAAK,EAAE,CAAC;EACpC,IAAI,IAAI,oBAAoB,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,YAAY,CAAC,EAAE;EACvD,QAAQ,OAAO,GAAG,CAAC,IAAI,CAAC,CAAC;EACzB,KAAK;EACL,IAAI,OAAO,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC;EACzC,CAAC;AACD,EAAO,SAAS,SAAS,CAAC,CAAC,EAAE;EAC7B,IAAI,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;EACnD,CAAC;EACD;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,mBAAmB,CAAC,IAAI,EAAE,KAAK,EAAE;EACjD,IAAI,IAAI,KAAK,KAAK,KAAK,CAAC,EAAE,EAAE,KAAK,GAAG,OAAO,CAAC,EAAE;EAC9C,IAAI,IAAI,MAAM,GAAG,eAAe,CAAC,IAAI,CAAC,CAAC;EACvC,IAAI,IAAI,QAAQ,GAAG,EAAE,CAAC;EACtB,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;EAC7C,QAAQ,IAAI,MAAM,GAAG,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAACX,CAAW,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC;EAChF,QAAQ,QAAQ,CAAC,IAAI,CAAC,EAAE,GAAG,KAAK,GAAG,MAAM,CAAC,CAAC;EAC3C,KAAK;EACL,IAAI,OAAO,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;EACjC,CAAC;EACD;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,mBAAmB,CAAC,IAAI,EAAE,KAAK,EAAE;EACjD,IAAI,IAAI,KAAK,KAAK,KAAK,CAAC,EAAE,EAAE,KAAK,GAAG,OAAO,CAAC,EAAE;EAC9C,IAAI,OAAO,KAAK,GAAG,GAAG,GAAGA,CAAW,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC;EAC5E,CAAC;EACD;EACA;EACA;EACA;AACA,EAAO,SAAS,kBAAkB,CAAC,IAAI,EAAE;EACzC,IAAI,OAAO,EAAE,GAAG,eAAe,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,OAAO,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;EACtG,CAAC;EACD;EACA;EACA;EACA;AACA,EAAO,SAAS,mBAAmB,CAAC,IAAI,EAAE;EAC1C,IAAI,OAAO,EAAE,GAAG,eAAe,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;EAChD,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,eAAe,CAAC,IAAI,EAAE;EACtC,IAAI,IAAI,CAAC,IAAI,EAAE;EACf,QAAQ,OAAO,CAAC,CAAC;EACjB,KAAK;EACL,IAAI,OAAO,eAAe,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC;EACxC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ECnSD,IAAI,kBAAkB,GAAG;EACzB,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,QAAQ,EAAE,CAAC;EACf,IAAI,GAAG,EAAE,CAAC;EACV,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,GAAG,EAAE,CAAC;EACV,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,EAAE,EAAE,CAAC;EACT,IAAI,EAAE,EAAE,CAAC;EACT,IAAI,GAAG,EAAE,CAAC;EACV,IAAI,GAAG,EAAE,CAAC;EACV,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,GAAG,EAAE,CAAC;EACV,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,QAAQ,EAAE,CAAC;EACf,IAAI,SAAS,EAAE,CAAC;EAChB,CAAC,CAAC;AACF,EAAO,IAAI,aAAa,GAAG,QAAQ,CAAC,kBAAkB,CAAC,CAAC;AACxD,EAAO,SAAS,aAAa,CAAC,CAAC,EAAE;EACjC,IAAI,OAAO,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC;EACnC,CAAC;AACD,EAAO,IAAI,YAAY,GAAG,CAAC,OAAO,EAAE,OAAO,EAAE,SAAS,EAAE,UAAU,CAAC,CAAC;AACpE,EAAO,SAAS,qBAAqB,CAAC,SAAS,EAAE;EACjD,IAAI,OAAO,SAAS,IAAI,QAAQ,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;EAC1D,CAAC;EACD;AACA,EAAO,IAAI,OAAO,GAAG;EACrB,IAAI,OAAO;EACX,IAAI,KAAK;EACT,IAAI,UAAU;EACd,IAAI,OAAO;EACX,IAAI,SAAS;EACb,CAAC,CAAC;EACF;EACA;EACA;AACA,EAAO,IAAI,iBAAiB,GAAG;EAC/B,IAAI,MAAM;EACV,IAAI,SAAS;EACb,IAAI,QAAQ;EACZ,IAAI,IAAI;EACR,IAAI,IAAI;EACR,IAAI,KAAK;EACT,IAAI,KAAK;EACT,CAAC,CAAC;AACF,EAAO,IAAI,sBAAsB,GAAG,KAAK,CAAC,iBAAiB,CAAC,CAAC;;;;;;;;;;;;ECpDtD,IAAI,UAAU,GAAG,CAAC,QAAQ,EAAE,MAAM,EAAE,QAAQ,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;EACvE;EACA;EACA;EACA;AACA,EAAO,IAAI,kBAAkB,GAAG;EAChC,IAAI,IAAI,EAAE,MAAM;EAChB,IAAI,SAAS,EAAE,MAAM;EACrB,IAAI,MAAM,EAAE,MAAM;EAClB,IAAI,MAAM,EAAE,MAAM;EAClB,IAAI,UAAU,EAAE,MAAM;EACtB,IAAI,YAAY,EAAE,MAAM;EACxB,IAAI,SAAS,EAAE,MAAM;EACrB,IAAI,SAAS,EAAE,MAAM;EACrB,IAAI,MAAM,EAAE,MAAM;EAClB,IAAI,KAAK,EAAE,MAAM;EACjB,IAAI,KAAK,EAAE,MAAM;EACjB,IAAI,MAAM,EAAE,MAAM;EAClB,IAAI,KAAK,EAAE,MAAM;EACjB,IAAI,MAAM,EAAE,MAAM;EAClB,CAAC,CAAC;EACF,IAAI,4BAA4B,GAAG;EACnC,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,UAAU,EAAE,CAAC;EACjB,IAAI,UAAU,EAAE,CAAC;EACjB,IAAI,YAAY,EAAE,CAAC;EACnB,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,YAAY,EAAE,CAAC;EACnB,IAAI,SAAS,EAAE,CAAC;EAChB,IAAI,SAAS,EAAE,CAAC;EAChB,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,QAAQ,EAAE,CAAC;EACf,IAAI,SAAS,EAAE,CAAC;EAChB,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,QAAQ,EAAE,CAAC;EACf,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,YAAY,EAAE,CAAC;EACnB,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,MAAM,EAAE,CAAC;EACb,CAAC,CAAC;EACF,IAAI,qBAAqB,GAAGO,QAAgB,CAAC,EAAE,EAAE,4BAA4B,EAAE,EAAE,QAAQ,EAAE,CAAC,EAAE,UAAU,EAAE,CAAC,EAAE,cAAc,EAAE,CAAC,EAAE,CAAC,CAAC;EAClI,IAAI,wBAAwB,GAAGA,QAAgB,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,EAAE,4BAA4B,EAAE,EAAE,SAAS,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;AACzH,EAAO,SAAS,cAAc,CAAC,IAAI,EAAE;EACrC,IAAI,OAAO,CAAC,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;EACzC,CAAC;AACD,EAAO,IAAI,kBAAkB,GAAG,QAAQ,CAAC,wBAAwB,CAAC,CAAC;EACnE;AACA,EAAO,IAAI,eAAe,GAAG,QAAQ,CAAC,qBAAqB,CAAC,CAAC;;;;;;;;;;ECpD7D;EACA;EACA;EACA;AACA,EAEO,IAAI,OAAO,CAAC;EACnB,CAAC,UAAU,OAAO,EAAE;EACpB;EACA,IAAI,OAAO,CAAC,GAAG,GAAG,KAAK,CAAC;EACxB,IAAI,OAAO,CAAC,MAAM,GAAG,QAAQ,CAAC;EAC9B;EACA,IAAI,OAAO,CAAC,CAAC,GAAG,GAAG,CAAC;EACpB,IAAI,OAAO,CAAC,CAAC,GAAG,GAAG,CAAC;EACpB,IAAI,OAAO,CAAC,EAAE,GAAG,IAAI,CAAC;EACtB,IAAI,OAAO,CAAC,EAAE,GAAG,IAAI,CAAC;EACtB;EACA,IAAI,OAAO,CAAC,QAAQ,GAAG,UAAU,CAAC;EAClC,IAAI,OAAO,CAAC,SAAS,GAAG,WAAW,CAAC;EACpC,IAAI,OAAO,CAAC,SAAS,GAAG,WAAW,CAAC;EACpC,IAAI,OAAO,CAAC,UAAU,GAAG,YAAY,CAAC;EACtC;EACA,IAAI,OAAO,CAAC,KAAK,GAAG,OAAO,CAAC;EAC5B,IAAI,OAAO,CAAC,IAAI,GAAG,MAAM,CAAC;EAC1B,IAAI,OAAO,CAAC,MAAM,GAAG,QAAQ,CAAC;EAC9B,IAAI,OAAO,CAAC,KAAK,GAAG,OAAO,CAAC;EAC5B,IAAI,OAAO,CAAC,IAAI,GAAG,MAAM,CAAC;EAC1B,IAAI,OAAO,CAAC,OAAO,GAAG,SAAS,CAAC;EAChC;EACA,IAAI,OAAO,CAAC,IAAI,GAAG,MAAM,CAAC;EAC1B,IAAI,OAAO,CAAC,KAAK,GAAG,OAAO,CAAC;EAC5B,IAAI,OAAO,CAAC,MAAM,GAAG,QAAQ,CAAC;EAC9B,IAAI,OAAO,CAAC,GAAG,GAAG,KAAK,CAAC;EACxB,IAAI,OAAO,CAAC,OAAO,GAAG,SAAS,CAAC;EAChC,IAAI,OAAO,CAAC,IAAI,GAAG,MAAM,CAAC;EAC1B,CAAC,EAAE,OAAO,KAAK,OAAO,GAAG,EAAE,CAAC,CAAC,CAAC;AAC9B,EAAO,IAAI,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC;AACzB,EAAO,IAAI,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC;AACzB,EAAO,IAAI,EAAE,GAAG,OAAO,CAAC,EAAE,CAAC;AAC3B,EAAO,IAAI,EAAE,GAAG,OAAO,CAAC,EAAE,CAAC;AAC3B,EAAO,IAAI,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC;AACvC,EAAO,IAAI,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;AACzC,EAAO,IAAI,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC;AACzC,EAAO,IAAI,UAAU,GAAG,OAAO,CAAC,UAAU,CAAC;AAC3C,EAAO,IAAI,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC;AAC7B,EAAO,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;AACnC,EAAO,IAAI,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;AACjC,EAAO,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;AAC/B,EAAO,IAAI,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;AACjC,EAAO,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;AAC/B,EAAO,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;AACnC,EAAO,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;AAC/B,EAAO,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;AACnC,EAAO,IAAI,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC;AAC7B,EAAO,IAAI,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC;AACjC,EAAO,IAAI,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;AACrC,EAAO,IAAI,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;AACrC,EAAO,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;AAC/B,EAAO,IAAI,yBAAyB,GAAG;EACvC,IAAI,SAAS,EAAE,CAAC;EAChB,IAAI,UAAU,EAAE,CAAC;EACjB,IAAI,QAAQ,EAAE,CAAC;EACf,IAAI,SAAS,EAAE,CAAC;EAChB,CAAC,CAAC;AACF,EAAO,IAAI,oBAAoB,GAAG,QAAQ,CAAC,yBAAyB,CAAC,CAAC;EACtE,IAAI,kBAAkB,GAAGA,QAAgB,CAAC;EAC1C;EACA,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,yBAAyB,EAAE;EAC3D;EACA,IAAI,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC;EAChC;EACA,IAAI,OAAO,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC;EACjC;EACA,IAAI,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,OAAO,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC,CAAC;AACjE,EAAO,SAAS,cAAc,CAAC,OAAO,EAAE;EACxC,IAAI,OAAO,OAAO,KAAK,OAAO,IAAI,OAAO,KAAK,MAAM,IAAI,OAAO,KAAK,QAAQ,CAAC;EAC7E,CAAC;EACD,IAAI,mBAAmB,GAAG;EAC1B,IAAI,GAAG,EAAE,CAAC;EACV,IAAI,MAAM,EAAE,CAAC;EACb,CAAC,CAAC;EACF,IAAI,aAAa,GAAGA,QAAgB,CAAC,EAAE,EAAE,kBAAkB,EAAE,mBAAmB,CAAC,CAAC;AAClF,EAAO,IAAI,QAAQ,GAAG,QAAQ,CAAC,aAAa,CAAC,CAAC;EAC9C,IAAI,EAAE,GAAG,aAAa,CAAC,KAAK,EAAE,EAAE,GAAG,aAAa,CAAC,MAAM,EAAE,wBAAwB,GAAGK,MAAc,CAAC,aAAa,EAAE,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC,CAAC;EACvI;EACA;EACA;EACA;EACA;EACA;EACA;EACA;AACA,EAAO,IAAI,mBAAmB,GAAG,QAAQ,CAAC,wBAAwB,CAAC,CAAC;AACpE,EAAO,SAAS,SAAS,CAAC,GAAG,EAAE;EAC/B,IAAI,OAAO,CAAC,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;EAChC,CAAC;EACD;AACA,EAAO,IAAI,aAAa,GAAG,QAAQ,CAAC,kBAAkB,CAAC,CAAC;EACxD;EACA,IAAI,EAAE,GAAG,kBAAkB,CAAC,CAAC,EAAE,EAAE,GAAG,kBAAkB,CAAC,CAAC;EACxD;EACA,GAAG,GAAG,kBAAkB,CAAC,EAAE,EAAE,GAAG,GAAG,kBAAkB,CAAC,EAAE,EAAE,SAAS,GAAG,kBAAkB,CAAC,QAAQ,EAAE,UAAU,GAAG,kBAAkB,CAAC,SAAS,EAAE,UAAU,GAAG,kBAAkB,CAAC,SAAS,EAAE,WAAW,GAAG,kBAAkB,CAAC,UAAU;EACpO;EACA,yBAAyB,GAAGA,MAAc,CAAC,kBAAkB,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,UAAU,EAAE,WAAW,EAAE,WAAW,EAAE,YAAY,CAAC,CAAC,CAAC;AAC3I,EAAO,IAAI,oBAAoB,GAAG,QAAQ,CAAC,yBAAyB,CAAC,CAAC;EACtE;EACA,IAAI,4BAA4B,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;AAClD,EAAO,IAAI,uBAAuB,GAAG,QAAQ,CAAC,4BAA4B,CAAC,CAAC;EAC5E;AACA,AAAE,MAAC;AACH,EAKmH,+BAA+B,GAAGA,MAAc,CAAC,yBAAyB,EAAE,CAAC,MAAM,EAAE,SAAS,EAAE,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC,CAAC;AACtP,EAAO,IAAI,0BAA0B,GAAG,QAAQ,CAAC,+BAA+B,CAAC,CAAC;EAClF;EACA,IAAI,mBAAmB,GAAGL,QAAgB,CAAC,EAAE,EAAE,4BAA4B,EAAE,+BAA+B,CAAC,CAAC;EAC9G;AACA,EAAO,IAAI,cAAc,GAAG,QAAQ,CAAC,mBAAmB,CAAC,CAAC;AAC1D,EAAO,SAAS,cAAc,CAAC,OAAO,EAAE;EACxC,IAAI,OAAO,CAAC,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;EAC1C,CAAC;EACD;EACA;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,WAAW,CAAC,OAAO,EAAE,IAAI,EAAE;EAC3C,IAAI,OAAO,IAAI,IAAI,gBAAgB,CAAC,OAAO,CAAC,CAAC;EAC7C,CAAC;EACD;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,gBAAgB,CAAC,OAAO,EAAE;EAC1C,IAAI,QAAQ,OAAO;EACnB,QAAQ,KAAK,KAAK,CAAC;EACnB,QAAQ,KAAK,IAAI,CAAC;EAClB,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,GAAG,CAAC;EACjB,QAAQ,KAAK,OAAO,CAAC;EACrB,QAAQ,KAAK,IAAI,CAAC;EAClB,QAAQ,KAAK,KAAK,CAAC;EACnB,QAAQ,KAAK,OAAO,CAAC;EACrB,QAAQ,KAAK,GAAG,CAAC;EACjB,QAAQ,KAAK,MAAM;EACnB,YAAY,OAAO;EACnB,gBAAgB,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI;EAC/E,gBAAgB,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI;EACtG,aAAa,CAAC;EACd,QAAQ,KAAK,CAAC,CAAC;EACf,QAAQ,KAAK,CAAC,CAAC;EACf,QAAQ,KAAK,QAAQ,CAAC;EACtB,QAAQ,KAAK,SAAS;EACtB,YAAY,OAAO;EACnB,gBAAgB,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI;EAC/E,gBAAgB,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI;EACtF,aAAa,CAAC;EACd,QAAQ,KAAK,EAAE,CAAC;EAChB,QAAQ,KAAK,EAAE,CAAC;EAChB,QAAQ,KAAK,SAAS,CAAC;EACvB,QAAQ,KAAK,UAAU;EACvB,YAAY,OAAO;EACnB,gBAAgB,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI;EAC7D,aAAa,CAAC;EACd,QAAQ,KAAK,IAAI;EACjB,YAAY,OAAO;EACnB,gBAAgB,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI;EAC/E,gBAAgB,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI;EAC9D,aAAa,CAAC;EACd,QAAQ,KAAK,KAAK;EAClB,YAAY,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;EACnD,QAAQ,KAAK,IAAI;EACjB,YAAY,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;EAClC,KAAK;EACL,CAAC;AACD,EAAO,SAAS,SAAS,CAAC,OAAO,EAAE;EACnC,IAAI,QAAQ,OAAO;EACnB,QAAQ,KAAK,CAAC,CAAC;EACf,QAAQ,KAAK,CAAC,CAAC;EACf,QAAQ,KAAK,IAAI,CAAC;EAClB,QAAQ,KAAK,OAAO,CAAC;EACrB;EACA,QAAQ,KAAK,EAAE,CAAC;EAChB,QAAQ,KAAK,EAAE;EACf,YAAY,OAAO,YAAY,CAAC;EAChC,QAAQ,KAAK,GAAG,CAAC;EACjB,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,KAAK,CAAC;EACnB;EACA,QAAQ,KAAK,IAAI,CAAC;EAClB,QAAQ,KAAK,OAAO,CAAC;EACrB,QAAQ,KAAK,IAAI;EACjB,YAAY,OAAO,UAAU,CAAC;EAC9B;EACA,QAAQ,KAAK,KAAK,CAAC;EACnB,QAAQ,KAAK,IAAI,CAAC;EAClB,QAAQ,KAAK,MAAM;EACnB,YAAY,OAAO,UAAU,CAAC;EAC9B;EACA,QAAQ,KAAK,QAAQ,CAAC;EACtB,QAAQ,KAAK,SAAS,CAAC;EACvB,QAAQ,KAAK,SAAS,CAAC;EACvB,QAAQ,KAAK,UAAU,CAAC;EACxB,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,GAAG,CAAC;EACjB,QAAQ,KAAK,KAAK;EAClB,YAAY,OAAO,SAAS,CAAC;EAC7B,KAAK;EACL;EACA,IAAI,MAAM,IAAI,KAAK,CAAC,gCAAgC,GAAG,OAAO,CAAC,CAAC;EAChE,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ECrNM,SAAS,WAAW,CAAC,GAAG,EAAE;EACjC,IAAI,IAAI,SAAS,CAAC,GAAG,CAAC,EAAE;EACxB,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,OAAO,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,OAAO,CAAC,GAAG,GAAG,CAAC,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;EACpG,CAAC;AACD,EAAO,SAAS,WAAW,CAAC,GAAG,EAAE;EACjC,IAAI,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;EAClC,CAAC;AACD,EAAO,SAAS,WAAW,CAAC,OAAO,EAAE;EACrC,IAAI,QAAQ,OAAO;EACnB,QAAQ,KAAK,GAAG,CAAC;EACjB,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,IAAI,CAAC;EAClB,QAAQ,KAAK,KAAK,CAAC;EACnB,QAAQ,KAAK,IAAI,CAAC;EAClB,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,OAAO,CAAC;EACrB;EACA;EACA,QAAQ,KAAK,KAAK;EAClB,YAAY,OAAO,CAAC,CAAC;EACrB,QAAQ;EACR,YAAY,OAAO,EAAE,CAAC;EACtB,KAAK;EACL,CAAC;;;;;;;;EC1BM,IAAI,IAAI,CAAC;EAChB,CAAC,UAAU,IAAI,EAAE;EACjB,IAAI,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;EACvB,IAAI,IAAI,CAAC,GAAG,GAAG,KAAK,CAAC;EACrB,IAAI,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;EACvB,IAAI,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC;EACzB,IAAI,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;EACvB,IAAI,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;EACvB,IAAI,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;EACvB,IAAI,IAAI,CAAC,IAAI,GAAG,MAAM,CAAC;EACvB,IAAI,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC;EACzB,IAAI,IAAI,CAAC,MAAM,GAAG,QAAQ,CAAC;EAC3B,IAAI,IAAI,CAAC,MAAM,GAAG,QAAQ,CAAC;EAC3B,IAAI,IAAI,CAAC,QAAQ,GAAG,UAAU,CAAC;EAC/B,CAAC,EAAE,IAAI,KAAK,IAAI,GAAG,EAAE,CAAC,CAAC,CAAC;AACxB,EAAO,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;AAC5B,EAAO,IAAI,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;AAC1B,EAAO,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;AAC5B,EAAO,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;AAC9B,EAAO,IAAIM,MAAI,GAAG,IAAI,CAAC,IAAI,CAAC;AAC5B,EAAO,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;AAC5B,EAAO,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;AAC9B,EAAO,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;AAC5B,EAAO,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;AAC5B,EAAO,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;AACpC,EAAO,IAAI,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;AAChC,EAAO,IAAI,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;EAChC;EACA,IAAI,UAAU,GAAG;EACjB,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,GAAG,EAAE,CAAC;EACV,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,QAAQ,EAAE,CAAC;EACf,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,MAAM,EAAE,CAAC;EACb,CAAC,CAAC;AACF,EAAO,SAAS,MAAM,CAAC,CAAC,EAAE;EAC1B,IAAI,OAAO,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;EAC3B,CAAC;AACD,EAAO,SAAS,UAAU,CAAC,CAAC,EAAE;EAC9B,IAAI,OAAO,QAAQ,CAAC,CAAC,MAAM,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC;EAClD,CAAC;AACD,EAAO,IAAI,eAAe,GAAG,QAAQ,CAAC,UAAU,CAAC,CAAC;AAClD,EAAO,SAAS,SAAS,CAAC,IAAI,EAAE;EAChC,IAAI,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC;EACxB,CAAC;EACD,IAAI,oBAAoB,GAAG,KAAK,CAAC,eAAe,CAAC,CAAC;AAClD,EAAO,SAAS,eAAe,CAAC,IAAI,EAAE;EACtC,IAAI,IAAI,QAAQ,GAAG,SAAS,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;EACtD,IAAI,OAAO,QAAQ,IAAI,oBAAoB,CAAC;EAC5C,CAAC;AACD,EAAO,IAAI,aAAa,GAAG,CAAC,QAAQ,EAAE,aAAa;EACnD,IAAI,YAAY,EAAE,kBAAkB,EAAE,eAAe,CAAC,CAAC;AACvD,EAAO,IAAI,WAAW,GAAG,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC;AACjD,EAAO,IAAI,kBAAkB,GAAG,EAAE,CAAC,MAAM,CAAC,aAAa,EAAE,WAAW,CAAC,CAAC;AACtE,EAAO,IAAI,8BAA8B,GAAG,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;AAChE,EAAO,IAAI,2CAA2C,GAAG;EACzD,IAAI,IAAI,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC;EAC3B,IAAI,GAAG,EAAE,CAAC,YAAY,EAAE,oBAAoB,EAAE,kBAAkB,CAAC;EACjE,IAAI,IAAI,EAAE,CAAC,OAAO,CAAC;EACnB,IAAI,IAAI,EAAE,CAAC,iBAAiB,CAAC;EAC7B,IAAI,IAAI,EAAE,CAAC,UAAU,EAAE,WAAW,CAAC;EACnC,CAAC,CAAC;AACF,EAAO,IAAI,iBAAiB,GAAG;EAC/B,IAAI,KAAK,EAAE,SAAS;EACpB,CAAC,CAAC;AACF,EAAO,IAAI,gBAAgB,GAAG;EAC9B,IAAI,UAAU,EAAE,CAAC;EACjB,IAAI,kBAAkB,EAAE,CAAC;EACzB,CAAC,CAAC;AACF,EAAO,IAAI,iBAAiB,GAAG;EAC/B,IAAI,SAAS,EAAE,CAAC;EAChB,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EChFF;EACA;EACA;AACA,EAEA;EACA;EACA;EACA,IAAI,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;EACxB,IAAI,OAAO,GAAG,IAAI,CAAC;AACnB,EAiDA;EACA;EACA;AACA,EAAO,SAAS,GAAG,CAAC,SAAS,EAAE;EAC/B,IAAI,OAAO,GAAG,SAAS,CAAC;EACxB,IAAI,OAAO,OAAO,CAAC;EACnB,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,KAAK,GAAG;EACxB,IAAI,OAAO,GAAG,IAAI,CAAC;EACnB,IAAI,OAAO,OAAO,CAAC;EACnB,CAAC;AACD,EAAO,SAAS,IAAI,GAAG;EACvB,IAAI,IAAI,CAAC,GAAG,EAAE,CAAC;EACf,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,SAAS,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAClD,QAAQ,CAAC,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,EAAE,CAAC,CAAC;EAC9B,KAAK;EACL,IAAI,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC;EAC3C,CAAC;AACD,EAOO,SAAS,KAAK,GAAG;EACxB,IAAI,IAAI,CAAC,GAAG,EAAE,CAAC;EACf,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,SAAS,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAClD,QAAQ,CAAC,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,EAAE,CAAC,CAAC;EAC9B,KAAK;EACL,IAAI,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC;EAC5C,CAAC;EACD;EACA;EACA;AACA,EAAO,IAAI,OAAO,CAAC;EACnB,CAAC,UAAU,OAAO,EAAE;EACpB,IAAI,OAAO,CAAC,YAAY,GAAG,cAAc,CAAC;EAC1C;EACA,IAAI,OAAO,CAAC,cAAc,GAAG,+DAA+D,CAAC;EAC7F,IAAI,OAAO,CAAC,8BAA8B,GAAG,mEAAmE,CAAC;EACjH;EACA,IAAI,SAAS,kCAAkC,CAAC,OAAO,EAAE;EACzD,QAAQ,OAAO,mDAAmD,GAAG,OAAO,GAAG,yBAAyB,CAAC;EACzG,KAAK;EACL,IAAI,OAAO,CAAC,kCAAkC,GAAG,kCAAkC,CAAC;EACpF,IAAI,SAAS,8BAA8B,CAAC,IAAI,EAAE;EAClD,QAAQ,OAAO,iDAAiD,GAAG,IAAI,GAAG,SAAS,CAAC;EACpF,KAAK;EACL,IAAI,OAAO,CAAC,8BAA8B,GAAG,8BAA8B,CAAC;EAC5E,IAAI,SAAS,iBAAiB,CAAC,IAAI,EAAE;EACrC,QAAQ,OAAO,kCAAkC,GAAG,IAAI,GAAG,IAAI,CAAC;EAChE,KAAK;EACL,IAAI,OAAO,CAAC,iBAAiB,GAAG,iBAAiB,CAAC;EAClD,IAAI,OAAO,CAAC,yBAAyB,GAAG,2FAA2F,CAAC;EACpI;EACA,IAAI,SAAS,mBAAmB,CAACC,QAAK,EAAE;EACxC,QAAQ,OAAO,2BAA2B,GAAGA,QAAK,GAAG,KAAK,CAAC;EAC3D,KAAK;EACL,IAAI,OAAO,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;EACtD;EACA,IAAI,OAAO,CAAC,wBAAwB,GAAG,8CAA8C,CAAC;EACtF;EACA,IAAI,OAAO,CAAC,wBAAwB,GAAG,0CAA0C,CAAC;EAClF;EACA,IAAI,SAAS,oBAAoB,CAAC,IAAI,EAAE;EACxC,QAAQ,OAAO,oCAAoC,GAAG,IAAI,GAAG,OAAO,CAAC;EACrE,KAAK;EACL,IAAI,OAAO,CAAC,oBAAoB,GAAG,oBAAoB,CAAC;EACxD;EACA,IAAI,SAAS,iBAAiB,CAAC,CAAC,EAAE;EAClC,QAAQ,OAAO,uBAAuB,GAAG,CAAC,GAAG,KAAK,CAAC;EACnD,KAAK;EACL,IAAI,OAAO,CAAC,iBAAiB,GAAG,iBAAiB,CAAC;EAClD,IAAI,SAAS,cAAc,CAACA,QAAK,EAAE,KAAK,EAAE,QAAQ,EAAE;EACpD,QAAQ,OAAO,6BAA6B,GAAGA,QAAK,GAAG,QAAQ,GAAG,QAAQ,GAAG,2CAA2C,GAAG,KAAK,GAAG,GAAG,CAAC;EACvI,KAAK;EACL,IAAI,OAAO,CAAC,cAAc,GAAG,cAAc,CAAC;EAC5C;EACA,IAAI,SAAS,uBAAuB,CAAC,SAAS,EAAE;EAChD,QAAQ,OAAO,iCAAiC,GAAGN,WAAS,CAAC,SAAS,CAAC,GAAG,GAAG,CAAC;EAC9E,KAAK;EACL,IAAI,OAAO,CAAC,uBAAuB,GAAG,uBAAuB,CAAC;EAC9D,IAAI,OAAO,CAAC,kBAAkB,GAAG,sIAAsI,CAAC;EACxK;EACA,IAAI,SAAS,kBAAkB,CAAC,QAAQ,EAAE;EAC1C,QAAQ,OAAO,iBAAiB,GAAG,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,WAAW,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,GAAG,IAAI,GAAG,KAAK,CAAC,GAAG,YAAY,CAAC;EAC5H,KAAK;EACL,IAAI,OAAO,CAAC,kBAAkB,GAAG,kBAAkB,CAAC;EACpD,IAAI,SAAS,oBAAoB,CAAC,GAAG,EAAE;EACvC,QAAQ,IAAI,gBAAgB,GAAG,GAAG,CAAC,gBAAgB,EAAE,UAAU,GAAG,GAAG,CAAC,UAAU,CAAC;EACjF,QAAQ,OAAO,4BAA4B,GAAGA,WAAS,CAAC,gBAAgB,CAAC,GAAG,uCAAuC,GAAGA,WAAS,CAAC,UAAU,CAAC,GAAG,GAAG,CAAC;EAClJ,KAAK;EACL,IAAI,OAAO,CAAC,oBAAoB,GAAG,oBAAoB,CAAC;EACxD,IAAI,SAAS,mBAAmB,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE;EACvD,QAAQ,OAAO,UAAU,GAAG,OAAO,GAAG,QAAQ,GAAG,IAAI,GAAG,yBAAyB,GAAGA,WAAS,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC;EAC5G,KAAK;EACL,IAAI,OAAO,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;EACtD,IAAI,SAAS,gBAAgB,CAAC,IAAI,EAAE;EACpC,QAAQ,OAAO,uBAAuB,GAAG,IAAI,GAAG,IAAI,CAAC;EACrD,KAAK;EACL,IAAI,OAAO,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;EAChD,IAAI,SAAS,8BAA8B,CAAC,IAAI,EAAE,OAAO,EAAE,GAAG,EAAE;EAChE,QAAQ,IAAI,SAAS,GAAG,GAAG,CAAC,SAAS,GAAG,GAAG,CAAC,SAAS,GAAG,QAAQ;EAChE,YAAY,GAAG,CAAC,SAAS,GAAG,uBAAuB;EACnD,gBAAgB,6CAA6C,CAAC;EAC9D,QAAQ,OAAO,IAAI,GAAG,SAAS,GAAG,gBAAgB,GAAG,IAAI,GAAG,uCAAuC,IAAI,OAAO,KAAK,GAAG,GAAG,OAAO,GAAG,QAAQ,CAAC,GAAG,UAAU,GAAG,IAAI,GAAG,sFAAsF,CAAC;EAC1P,KAAK;EACL,IAAI,OAAO,CAAC,8BAA8B,GAAG,8BAA8B,CAAC;EAC5E,IAAI,SAAS,iCAAiC,CAAC,IAAI,EAAE,SAAS,EAAE;EAChE,QAAQ,OAAO,uBAAuB,GAAG,IAAI,GAAG,sBAAsB,GAAG,SAAS,GAAG,qCAAqC,CAAC;EAC3H,KAAK;EACL,IAAI,OAAO,CAAC,iCAAiC,GAAG,iCAAiC,CAAC;EAClF,IAAI,SAAS,gBAAgB,CAAC,SAAS,EAAE;EACzC,QAAQ,OAAO,iCAAiC,GAAG,SAAS,GAAG,IAAI,CAAC;EACpE,KAAK;EACL,IAAI,OAAO,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;EAChD,IAAI,SAAS,uBAAuB,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE;EAC7D,QAAQ,OAAO,uBAAuB,GAAG,IAAI,GAAG,mBAAmB,GAAG,OAAO,GAAG,cAAc,GAAG,OAAO,GAAG,aAAa,CAAC;EACzH,KAAK;EACL,IAAI,OAAO,CAAC,uBAAuB,GAAG,uBAAuB,CAAC;EAC9D,IAAI,SAAS,aAAa,CAAC,IAAI,EAAE,GAAG,EAAE;EACtC,QAAQ,IAAI,IAAI,GAAG,GAAG,CAAC,IAAI,EAAE,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC;EACjD,QAAQ,OAAO,iBAAiB,GAAG,IAAI,GAAG,wBAAwB,IAAI,IAAI,IAAI,MAAM,GAAG,iBAAiB,GAAG,IAAI,GAAG,MAAM,GAAG,QAAQ,CAAC,CAAC;EACrI,KAAK;EACL,IAAI,OAAO,CAAC,aAAa,GAAG,aAAa,CAAC;EAC1C,IAAI,SAAS,aAAa,CAAC,QAAQ,EAAE,OAAO,EAAE;EAC9C,QAAQ,OAAO,WAAW,GAAGA,WAAS,CAAC,QAAQ,CAAC,GAAG,kBAAkB,GAAG,OAAO,GAAG,mDAAmD,CAAC;EACtI,KAAK;EACL,IAAI,OAAO,CAAC,aAAa,GAAG,aAAa,CAAC;EAC1C,IAAI,SAAS,iBAAiB,CAAC,OAAO,EAAE,IAAI,EAAE,UAAU,EAAE;EAC1D,QAAQ,OAAO,OAAO,GAAG,sBAAsB,GAAG,IAAI,GAAG,iCAAiC,GAAG,UAAU,GAAG,YAAY,CAAC;EACvH,KAAK;EACL,IAAI,OAAO,CAAC,iBAAiB,GAAG,iBAAiB,CAAC;EAClD,IAAI,OAAO,CAAC,sBAAsB,GAAG,kGAAkG,CAAC;EACxI,IAAI,SAAS,mBAAmB,CAAC,OAAO,EAAE,WAAW,EAAE,IAAI,EAAE;EAC7D,QAAQ,OAAO,OAAO,GAAG,wCAAwC,GAAG,WAAW,GAAG,IAAI,IAAI,IAAI,GAAG,QAAQ,GAAG,IAAI,GAAG,EAAE,CAAC,GAAG,GAAG,CAAC;EAC7H,KAAK;EACL,IAAI,OAAO,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;EACtD,IAAI,SAAS,sBAAsB,CAAC,OAAO,EAAE;EAC7C,QAAQ,OAAO,OAAO,GAAG,0BAA0B,GAAG,OAAO,GAAG,mCAAmC,CAAC;EACpG,KAAK;EACL,IAAI,OAAO,CAAC,sBAAsB,GAAG,sBAAsB,CAAC;EAC5D,IAAI,SAAS,4BAA4B,CAAC,OAAO,EAAE;EACnD,QAAQ,OAAO,OAAO,GAAG,4DAA4D,CAAC;EACtF,KAAK;EACL,IAAI,OAAO,CAAC,4BAA4B,GAAG,4BAA4B,CAAC;EACxE,IAAI,SAAS,2BAA2B,CAAC,OAAO,EAAE,IAAI,EAAE;EACxD,QAAQ,OAAO,2BAA2B,GAAG,OAAO,GAAG,iBAAiB,GAAG,IAAI,GAAG,mDAAmD,IAAI,IAAI,KAAK,SAAS,GAAG,OAAO,GAAG,WAAW,CAAC,GAAG,GAAG,CAAC;EAC3L,KAAK;EACL,IAAI,OAAO,CAAC,2BAA2B,GAAG,2BAA2B,CAAC;EACtE;EACA,IAAI,OAAO,CAAC,uCAAuC,GAAG,qGAAqG,CAAC;EAC5J,IAAI,SAAS,aAAa,CAAC,KAAK,EAAE,KAAK,EAAE;EACzC,QAAQ,IAAI,QAAQ,GAAG,KAAK,IAAI,KAAK,GAAG,WAAW,GAAG,KAAK,GAAG,IAAI,GAAG,IAAI,CAAC;EAC1E,QAAQ,OAAO,iEAAiE,GAAG,QAAQ,GAAG,sDAAsD,CAAC;EACrJ,KAAK;EACL,IAAI,OAAO,CAAC,aAAa,GAAG,aAAa,CAAC;EAC1C,IAAI,SAAS,uBAAuB,CAAC,IAAI,EAAE;EAC3C,QAAQ,OAAO,6CAA6C,GAAG,IAAI,GAAG,kGAAkG,CAAC;EACzK,KAAK;EACL,IAAI,OAAO,CAAC,uBAAuB,GAAG,uBAAuB,CAAC;EAC9D,IAAI,SAAS,4BAA4B,CAAC,IAAI,EAAE;EAChD,QAAQ,OAAO,6CAA6C,GAAG,IAAI,GAAG,gEAAgE,CAAC;EACvI,KAAK;EACL,IAAI,OAAO,CAAC,4BAA4B,GAAG,4BAA4B,CAAC;EACxE,IAAI,SAAS,gBAAgB,CAAC,QAAQ,EAAE,MAAM,EAAE;EAChD,QAAQ,OAAO,qBAAqB,GAAG,QAAQ,GAAG,uBAAuB,GAAG,MAAM,GAAG,IAAI,CAAC;EAC1F,KAAK;EACL,IAAI,OAAO,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;EAChD;EACA,IAAI,OAAO,CAAC,4CAA4C,GAAG,uEAAuE,CAAC;EACnI,IAAI,SAAS,kCAAkC,CAAC,IAAI,EAAE;EACtD,QAAQ,OAAO,kCAAkC,GAAG,IAAI,GAAG,4BAA4B,CAAC;EACxF,KAAK;EACL,IAAI,OAAO,CAAC,kCAAkC,GAAG,kCAAkC,CAAC;EACpF,IAAI,SAAS,uCAAuC,CAAC,QAAQ,EAAE;EAC/D,QAAQ,OAAO,0DAA0D,GAAGA,WAAS,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC;EACvG,KAAK;EACL,IAAI,OAAO,CAAC,uCAAuC,GAAG,uCAAuC,CAAC;EAC9F,IAAI,SAAS,sCAAsC,CAAC,SAAS,EAAE;EAC/D,QAAQ,OAAO,2CAA2C,GAAG,SAAS,GAAG,2EAA2E,CAAC;EACrJ,KAAK;EACL,IAAI,OAAO,CAAC,sCAAsC,GAAG,sCAAsC,CAAC;EAC5F,IAAI,SAAS,8BAA8B,CAAC,QAAQ,EAAE;EACtD,QAAQ,OAAO,8DAA8D,GAAGA,WAAS,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC;EAC3G,KAAK;EACL,IAAI,OAAO,CAAC,8BAA8B,GAAG,8BAA8B,CAAC;EAC5E,IAAI,SAAS,gCAAgC,CAAC,IAAI,EAAE;EACpD,QAAQ,OAAO,2CAA2C,GAAG,IAAI,GAAG,KAAK,CAAC;EAC1E,KAAK;EACL,IAAI,OAAO,CAAC,gCAAgC,GAAG,gCAAgC,CAAC;EAChF,IAAI,SAAS,gBAAgB,CAAC,OAAO,EAAE;EACvC,QAAQ,OAAO,kBAAkB,GAAG,OAAO,GAAG,6BAA6B,IAAI,OAAO,KAAK,GAAG,GAAG,OAAO,GAAG,QAAQ,CAAC,GAAG,eAAe,CAAC;EACvI,KAAK;EACL,IAAI,OAAO,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;EAChD,IAAI,SAAS,2BAA2B,CAAC,OAAO,EAAE,SAAS,EAAE,gBAAgB,EAAE;EAC/E,QAAQ,OAAO,YAAY,GAAG,OAAO,GAAG,0BAA0B,GAAG,SAAS,GAAG,2BAA2B,GAAG,gBAAgB,GAAG,mBAAmB,CAAC;EACtJ,KAAK;EACL,IAAI,OAAO,CAAC,2BAA2B,GAAG,2BAA2B,CAAC;EACtE,IAAI,SAAS,4BAA4B,CAAC,SAAS,EAAE,gBAAgB,EAAE;EACvE,QAAQ,OAAO,gCAAgC,GAAG,SAAS,GAAG,2BAA2B,GAAG,gBAAgB,GAAG,mBAAmB,CAAC;EACnI,KAAK;EACL,IAAI,OAAO,CAAC,4BAA4B,GAAG,4BAA4B,CAAC;EACxE,IAAI,SAAS,iCAAiC,CAAC,SAAS,EAAE,QAAQ,EAAE,OAAO,EAAE;EAC7E,QAAQ,OAAO,OAAO,GAAG,aAAa,GAAG,QAAQ,GAAG,yCAAyC,GAAG,SAAS,GAAG,SAAS,CAAC;EACtH,KAAK;EACL,IAAI,OAAO,CAAC,iCAAiC,GAAG,iCAAiC,CAAC;EAClF,IAAI,SAAS,wBAAwB,CAAC,IAAI,EAAE,SAAS,EAAE;EACvD,QAAQ,OAAO,eAAe,GAAG,SAAS,GAAG,+BAA+B,GAAG,IAAI,GAAG,KAAK,CAAC;EAC5F,KAAK;EACL,IAAI,OAAO,CAAC,wBAAwB,GAAG,wBAAwB,CAAC;EAChE,IAAI,SAAS,wBAAwB,CAAC,QAAQ,EAAE,UAAU,EAAE,EAAE,EAAE,EAAE,EAAE;EACpE,QAAQ,OAAO,cAAc,GAAG,UAAU,CAAC,QAAQ,EAAE,GAAG,cAAc,GAAG,QAAQ,CAAC,QAAQ,EAAE,GAAG,MAAM,GAAGA,WAAS,CAAC,EAAE,CAAC,GAAG,OAAO,GAAGA,WAAS,CAAC,EAAE,CAAC,GAAG,YAAY,GAAGA,WAAS,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC;EACrL,KAAK;EACL,IAAI,OAAO,CAAC,wBAAwB,GAAG,wBAAwB,CAAC;EAChE,IAAI,SAAS,qCAAqC,CAAC,OAAO,EAAE;EAC5D,QAAQ,OAAO,4CAA4C,GAAG,OAAO,GAAG,4EAA4E,CAAC;EACrJ,KAAK;EACL,IAAI,OAAO,CAAC,qCAAqC,GAAG,qCAAqC,CAAC;EAC1F,IAAI,SAAS,iBAAiB,CAAC,IAAI,EAAE;EACrC,QAAQ,OAAO,yBAAyB,GAAGA,WAAS,CAAC,IAAI,CAAC,GAAG,yDAAyD,CAAC;EACvH,KAAK;EACL,IAAI,OAAO,CAAC,iBAAiB,GAAG,iBAAiB,CAAC;EAClD,IAAI,OAAO,CAAC,uBAAuB,GAAG,yBAAyB,CAAC;EAChE,IAAI,OAAO,CAAC,kBAAkB,GAAG,2FAA2F,CAAC;EAC7H;EACA,IAAI,OAAO,CAAC,wBAAwB,GAAG,2BAA2B,CAAC;EACnE;EACA,IAAI,SAAS,qBAAqB,CAAC,OAAO,EAAE;EAC5C,QAAQ,OAAO,iBAAiB,GAAG,OAAO,GAAG,2BAA2B,GAAG,OAAO,GAAG,KAAK,CAAC;EAC3F,KAAK;EACL,IAAI,OAAO,CAAC,qBAAqB,GAAG,qBAAqB,CAAC;EAC1D,IAAI,SAAS,yBAAyB,CAAC,SAAS,EAAE;EAClD,QAAQ,OAAO,iCAAiC,GAAG,SAAS,GAAG,GAAG,CAAC;EACnE,KAAK;EACL,IAAI,OAAO,CAAC,yBAAyB,GAAG,yBAAyB,CAAC;EAClE,IAAI,SAAS,0BAA0B,CAAC,SAAS,EAAE;EACnD,QAAQ,OAAO,6EAA6E,GAAG,SAAS,GAAG,KAAK,CAAC;EACjH,KAAK;EACL,IAAI,OAAO,CAAC,0BAA0B,GAAG,0BAA0B,CAAC;EACpE;EACA,IAAI,SAAS,eAAe,CAAC,QAAQ,EAAE,KAAK,EAAE;EAC9C,QAAQ,OAAO,UAAU,GAAG,QAAQ,GAAG,IAAI,GAAGA,WAAS,CAAC,KAAK,CAAC,CAAC;EAC/D,KAAK;EACL,IAAI,OAAO,CAAC,eAAe,GAAG,eAAe,CAAC;EAC9C,IAAI,SAAS,mBAAmB,CAAC,YAAY,EAAE;EAC/C,QAAQ,OAAO,cAAc,GAAG,YAAY,GAAG,gDAAgD,GAAG,YAAY,CAAC,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC,GAAG,GAAG,CAAC;EAC5I,KAAK;EACL,IAAI,OAAO,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;EACtD,IAAI,SAAS,UAAU,CAAC,CAAC,EAAE;EAC3B,QAAQ,OAAO,6BAA6B,GAAGA,WAAS,CAAC,CAAC,CAAC,GAAG,8CAA8C,CAAC;EAC7G,KAAK;EACL,IAAI,OAAO,CAAC,UAAU,GAAG,UAAU,CAAC;EACpC,CAAC,EAAE,OAAO,KAAK,OAAO,GAAG,EAAE,CAAC,CAAC,CAAC;;EC5T9B;AACA,EAGA;EACA;EACA;EACA,IAAI,WAAW,GAAG,IAAI,CAAC;AACvB,EAAO,SAAS,UAAU,CAAC,CAAC,EAAE;EAC9B,IAAI,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG;EAC9E,QAAQ,CAAC,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC;EACrE,CAAC;AACD,EAAO,IAAI,MAAM,GAAG,CAAC,SAAS,EAAE,UAAU,EAAE,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE,SAAS,EAAE,UAAU,EAAE,UAAU,CAAC,CAAC;AAC/I,EAAO,IAAI,YAAY,GAAG,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;AAC9E,EAAO,IAAI,IAAI,GAAG,CAAC,QAAQ,EAAE,QAAQ,EAAE,SAAS,EAAE,WAAW,EAAE,UAAU,EAAE,QAAQ,EAAE,UAAU,CAAC,CAAC;AACjG,EAAO,IAAI,UAAU,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;EAC1E,SAAS,gBAAgB,CAAC,CAAC,EAAE;EAC7B,IAAI,IAAI,QAAQ,CAAC,CAAC,CAAC,EAAE;EACrB,QAAQ,IAAI,CAAC,GAAG,CAAC,EAAE;EACnB,YAAYO,IAAQ,CAACC,OAAW,CAAC,eAAe,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC,CAAC;EAChE,SAAS;EACT;EACA,QAAQ,OAAO,CAAC,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;EAC5B,KAAK;EACL,SAAS;EACT;EACA,QAAQ,MAAM,IAAI,KAAK,CAACA,OAAW,CAAC,eAAe,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC,CAAC;EACnE,KAAK;EACL,CAAC;EACD,SAAS,cAAc,CAAC,CAAC,EAAE;EAC3B,IAAI,IAAI,QAAQ,CAAC,CAAC,CAAC,EAAE;EACrB;EACA,QAAQ,OAAO,CAAC,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;EAC5B,KAAK;EACL,SAAS;EACT,QAAQ,IAAI,MAAM,GAAG,CAAC,CAAC,WAAW,EAAE,CAAC;EACrC,QAAQ,IAAI,UAAU,GAAG,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;EAChD,QAAQ,IAAI,UAAU,KAAK,CAAC,CAAC,EAAE;EAC/B,YAAY,OAAO,UAAU,GAAG,EAAE,CAAC;EACnC,SAAS;EACT,QAAQ,IAAI,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EACzC,QAAQ,IAAI,eAAe,GAAG,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;EAC3D,QAAQ,IAAI,eAAe,KAAK,CAAC,CAAC,EAAE;EACpC,YAAY,OAAO,eAAe,GAAG,EAAE,CAAC;EACxC,SAAS;EACT;EACA,QAAQ,MAAM,IAAI,KAAK,CAACA,OAAW,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,CAAC;EACjE,KAAK;EACL,CAAC;EACD,SAAS,YAAY,CAAC,CAAC,EAAE;EACzB,IAAI,IAAI,QAAQ,CAAC,CAAC,CAAC,EAAE;EACrB;EACA;EACA,QAAQ,OAAO,CAAC,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;EAC5B,KAAK;EACL,SAAS;EACT,QAAQ,IAAI,MAAM,GAAG,CAAC,CAAC,WAAW,EAAE,CAAC;EACrC,QAAQ,IAAI,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;EAC5C,QAAQ,IAAI,QAAQ,KAAK,CAAC,CAAC,EAAE;EAC7B,YAAY,OAAO,QAAQ,GAAG,EAAE,CAAC;EACjC,SAAS;EACT,QAAQ,IAAI,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EACzC,QAAQ,IAAI,aAAa,GAAG,UAAU,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;EACvD,QAAQ,IAAI,aAAa,KAAK,CAAC,CAAC,EAAE;EAClC,YAAY,OAAO,aAAa,GAAG,EAAE,CAAC;EACtC,SAAS;EACT;EACA,QAAQ,MAAM,IAAI,KAAK,CAACA,OAAW,CAAC,eAAe,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;EAC/D,KAAK;EACL,CAAC;EACD;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,YAAY,CAAC,CAAC,EAAE,SAAS,EAAE;EAC3C,IAAI,IAAI,SAAS,KAAK,KAAK,CAAC,EAAE,EAAE,SAAS,GAAG,KAAK,CAAC,EAAE;EACpD,IAAI,IAAI,KAAK,GAAG,EAAE,CAAC;EACnB,IAAI,IAAI,SAAS,IAAI,CAAC,CAAC,GAAG,KAAK,SAAS,EAAE;EAC1C,QAAQ,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;EAChC,YAAYD,IAAQ,CAACC,OAAW,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;EAChD,YAAY,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;EAC7B,YAAY,OAAO,CAAC,CAAC,GAAG,CAAC;EACzB,SAAS;EACT,KAAK;EACL,IAAI,IAAI,CAAC,CAAC,IAAI,KAAK,SAAS,EAAE;EAC9B,QAAQ,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;EAC3B,KAAK;EACL,SAAS,IAAI,CAAC,CAAC,GAAG,KAAK,SAAS,EAAE;EAClC;EACA,QAAQ,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;EAChC,KAAK;EACL,SAAS;EACT,QAAQ,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;EACtB,KAAK;EACL,IAAI,IAAI,CAAC,CAAC,KAAK,KAAK,SAAS,EAAE;EAC/B,QAAQ,IAAI,KAAK,GAAG,SAAS,GAAG,cAAc,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC;EAClE,QAAQ,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;EAC1B,KAAK;EACL,SAAS,IAAI,CAAC,CAAC,OAAO,KAAK,SAAS,EAAE;EACtC,QAAQ,IAAI,OAAO,GAAG,SAAS,GAAG,gBAAgB,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;EAC1E,QAAQ,KAAK,CAAC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,CAAC;EACnC,KAAK;EACL,SAAS;EACT,QAAQ,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;EACtB,KAAK;EACL,IAAI,IAAI,CAAC,CAAC,IAAI,KAAK,SAAS,EAAE;EAC9B,QAAQ,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;EAC3B,KAAK;EACL,SAAS,IAAI,CAAC,CAAC,GAAG,KAAK,SAAS,EAAE;EAClC;EACA;EACA,QAAQ,IAAI,GAAG,GAAG,SAAS,GAAG,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC;EAC1D,QAAQ,KAAK,CAAC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,CAAC;EAC/B,KAAK;EACL,SAAS;EACT,QAAQ,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;EACtB,KAAK;EACL;EACA;EACA,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC,OAAO,EAAE,SAAS,EAAE,SAAS,EAAE,cAAc,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACjG,QAAQ,IAAI,QAAQ,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC9B,QAAQ,IAAI,CAAC,CAAC,QAAQ,CAAC,KAAK,SAAS,EAAE;EACvC,YAAY,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC;EACpC,SAAS;EACT,aAAa;EACb,YAAY,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;EAC1B,SAAS;EACT,KAAK;EACL,IAAI,IAAI,CAAC,CAAC,GAAG,EAAE;EACf,QAAQ,OAAO,MAAM,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC;EAC/C,KAAK;EACL,SAAS;EACT,QAAQ,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC;EACpD,KAAK;EACL,CAAC;;;;;;;;;;;ECnIM,IAAI,QAAQ,CAAC;EACpB,CAAC,UAAU,QAAQ,EAAE;EACrB,IAAI,QAAQ,CAAC,IAAI,GAAG,MAAM,CAAC;EAC3B,IAAI,QAAQ,CAAC,KAAK,GAAG,OAAO,CAAC;EAC7B,IAAI,QAAQ,CAAC,GAAG,GAAG,KAAK,CAAC;EACzB,IAAI,QAAQ,CAAC,IAAI,GAAG,MAAM,CAAC;EAC3B,IAAI,QAAQ,CAAC,KAAK,GAAG,OAAO,CAAC;EAC7B,IAAI,QAAQ,CAAC,OAAO,GAAG,SAAS,CAAC;EACjC,IAAI,QAAQ,CAAC,OAAO,GAAG,SAAS,CAAC;EACjC,IAAI,QAAQ,CAAC,YAAY,GAAG,cAAc,CAAC;EAC3C,IAAI,QAAQ,CAAC,SAAS,GAAG,WAAW,CAAC;EACrC,IAAI,QAAQ,CAAC,aAAa,GAAG,eAAe,CAAC;EAC7C,IAAI,QAAQ,CAAC,kBAAkB,GAAG,oBAAoB,CAAC;EACvD,IAAI,QAAQ,CAAC,yBAAyB,GAAG,2BAA2B,CAAC;EACrE,IAAI,QAAQ,CAAC,gCAAgC,GAAG,kCAAkC,CAAC;EACnF;EACA,IAAI,QAAQ,CAAC,SAAS,GAAG,WAAW,CAAC;EACrC,IAAI,QAAQ,CAAC,YAAY,GAAG,cAAc,CAAC;EAC3C,IAAI,QAAQ,CAAC,mBAAmB,GAAG,qBAAqB,CAAC;EACzD,IAAI,QAAQ,CAAC,cAAc,GAAG,gBAAgB,CAAC;EAC/C,IAAI,QAAQ,CAAC,mBAAmB,GAAG,qBAAqB,CAAC;EACzD,IAAI,QAAQ,CAAC,OAAO,GAAG,SAAS,CAAC;EACjC,IAAI,QAAQ,CAAC,WAAW,GAAG,aAAa,CAAC;EACzC,IAAI,QAAQ,CAAC,YAAY,GAAG,cAAc,CAAC;EAC3C,IAAI,QAAQ,CAAC,gBAAgB,GAAG,kBAAkB,CAAC;EACnD,IAAI,QAAQ,CAAC,OAAO,GAAG,SAAS,CAAC;EACjC,IAAI,QAAQ,CAAC,QAAQ,GAAG,UAAU,CAAC;EACnC,IAAI,QAAQ,CAAC,MAAM,GAAG,QAAQ,CAAC;EAC/B,IAAI,QAAQ,CAAC,OAAO,GAAG,SAAS,CAAC;EACjC,IAAI,QAAQ,CAAC,QAAQ,GAAG,UAAU,CAAC;EACnC,IAAI,QAAQ,CAAC,UAAU,GAAG,YAAY,CAAC;EACvC,IAAI,QAAQ,CAAC,UAAU,GAAG,YAAY,CAAC;EACvC,IAAI,QAAQ,CAAC,eAAe,GAAG,iBAAiB,CAAC;EACjD,IAAI,QAAQ,CAAC,YAAY,GAAG,cAAc,CAAC;EAC3C,IAAI,QAAQ,CAAC,gBAAgB,GAAG,kBAAkB,CAAC;EACnD,IAAI,QAAQ,CAAC,qBAAqB,GAAG,uBAAuB,CAAC;EAC7D,IAAI,QAAQ,CAAC,4BAA4B,GAAG,8BAA8B,CAAC;EAC3E,IAAI,QAAQ,CAAC,mCAAmC,GAAG,qCAAqC,CAAC;EACzF;EACA,IAAI,QAAQ,CAAC,YAAY,GAAG,cAAc,CAAC;EAC3C,IAAI,QAAQ,CAAC,eAAe,GAAG,iBAAiB,CAAC;EACjD,IAAI,QAAQ,CAAC,sBAAsB,GAAG,wBAAwB,CAAC;EAC/D,IAAI,QAAQ,CAAC,iBAAiB,GAAG,mBAAmB,CAAC;EACrD,IAAI,QAAQ,CAAC,sBAAsB,GAAG,wBAAwB,CAAC;EAC/D,IAAI,QAAQ,CAAC,UAAU,GAAG,YAAY,CAAC;EACvC,IAAI,QAAQ,CAAC,cAAc,GAAG,gBAAgB,CAAC;EAC/C,IAAI,QAAQ,CAAC,eAAe,GAAG,iBAAiB,CAAC;EACjD,IAAI,QAAQ,CAAC,mBAAmB,GAAG,qBAAqB,CAAC;EACzD,CAAC,EAAE,QAAQ,KAAK,QAAQ,GAAG,EAAE,CAAC,CAAC,CAAC;EAChC;EACA,IAAI,2BAA2B,GAAG;EAClC,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,GAAG,EAAE,CAAC;EACV,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,YAAY,EAAE,CAAC;EACnB,CAAC,CAAC;AACF,EAAO,IAAI,cAAc,GAAG,QAAQ,CAAC,2BAA2B,CAAC,CAAC;AAClE,EAAO,SAAS,qBAAqB,CAAC,QAAQ,EAAE;EAChD,IAAI,OAAO,CAAC,CAAC,2BAA2B,CAAC,QAAQ,CAAC,CAAC;EACnD,CAAC;EACD,IAAI,yBAAyB,GAAG;EAChC,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,UAAU,EAAE,CAAC;EACjB,IAAI,QAAQ,EAAE,CAAC;EACf,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,QAAQ,EAAE,CAAC;EACf,IAAI,UAAU,EAAE,CAAC;EACjB,IAAI,UAAU,EAAE,CAAC;EACjB,IAAI,eAAe,EAAE,CAAC;EACtB,CAAC,CAAC;AACF,EAAO,SAAS,mBAAmB,CAAC,QAAQ,EAAE;EAC9C,IAAI,OAAO,CAAC,CAAC,yBAAyB,CAAC,QAAQ,CAAC,CAAC;EACjD,CAAC;EACD,IAAI,0BAA0B,GAAG;EACjC,IAAI,WAAW,EAAE,CAAC;EAClB,IAAI,gBAAgB,EAAE,CAAC;EACvB,IAAI,SAAS,EAAE,CAAC;EAChB,IAAI,aAAa,EAAE,CAAC;EACpB,IAAI,kBAAkB,EAAE,CAAC;EACzB,IAAI,yBAAyB,EAAE,CAAC;EAChC,IAAI,gCAAgC,EAAE,CAAC;EACvC,IAAI,YAAY,EAAE,CAAC;EACnB,IAAI,SAAS,EAAE,CAAC;EAChB,IAAI,YAAY,EAAE,CAAC;EACnB,IAAI,mBAAmB,EAAE,CAAC;EAC1B,IAAI,cAAc,EAAE,CAAC;EACrB,IAAI,mBAAmB,EAAE,CAAC;EAC1B,CAAC,CAAC;EACF,IAAI,wBAAwB,GAAG;EAC/B,IAAI,cAAc,EAAE,CAAC;EACrB,IAAI,mBAAmB,EAAE,CAAC;EAC1B,IAAI,YAAY,EAAE,CAAC;EACnB,IAAI,gBAAgB,EAAE,CAAC;EACvB,IAAI,qBAAqB,EAAE,CAAC;EAC5B,IAAI,4BAA4B,EAAE,CAAC;EACnC,IAAI,mCAAmC,EAAE,CAAC;EAC1C,IAAI,eAAe,EAAE,CAAC;EACtB,IAAI,YAAY,EAAE,CAAC;EACnB,IAAI,eAAe,EAAE,CAAC;EACtB,IAAI,sBAAsB,EAAE,CAAC;EAC7B,IAAI,iBAAiB,EAAE,CAAC;EACxB,IAAI,sBAAsB,EAAE,CAAC;EAC7B,CAAC,CAAC;EACF,IAAI,kBAAkB,GAAGT,QAAgB,CAAC,EAAE,EAAE,yBAAyB,EAAE,wBAAwB,CAAC,CAAC;AACnG,EAAO,SAAS,aAAa,CAAC,CAAC,EAAE;EACjC,IAAI,OAAO,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC;EACnC,CAAC;AACD,EAAO,SAAS,gBAAgB,CAAC,CAAC,EAAE;EACpC,IAAI,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;EACvB,CAAC;EACD,IAAI,cAAc,GAAGA,QAAgB,CAAC,EAAE,EAAE,2BAA2B,EAAE,yBAAyB,EAAE,0BAA0B,EAAE,wBAAwB,CAAC,CAAC;AACxJ,EAAO,IAAI,SAAS,GAAG,QAAQ,CAAC,cAAc,CAAC,CAAC;AAChD,EAAO,SAAS,UAAU,CAAC,CAAC,EAAE;EAC9B,IAAI,OAAO,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;EAC/B,CAAC;EACD,IAAI,eAAe,GAAG;EACtB,IAAI,IAAI,EAAE,aAAa;EACvB,IAAI,KAAK,EAAE,UAAU;EACrB,IAAI,IAAI,EAAE,SAAS;EACnB,IAAI,KAAK,EAAE,UAAU;EACrB,IAAI,OAAO,EAAE,YAAY;EACzB,IAAI,OAAO,EAAE,YAAY;EACzB,IAAI,YAAY,EAAE,iBAAiB;EACnC;EACA,IAAI,OAAO,EAAE,IAAI;EACjB,IAAI,GAAG,EAAE,IAAI;EACb,CAAC,CAAC;EACF;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,OAAO,CAAC,IAAI,EAAE,IAAI,EAAE;EACpC,IAAI,IAAI,KAAK,GAAG,aAAa,CAAC,IAAI,CAAC,CAAC;EACpC,IAAI,IAAI,MAAM,GAAG,KAAK;EACtB;EACA,QAAQ,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;EAC/C,QAAQ,IAAI,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;EACtC,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,gBAAgB,GAAG,cAAc,EAAE,EAAE,GAAG,gBAAgB,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC5F,QAAQ,IAAI,YAAY,GAAG,gBAAgB,CAAC,EAAE,CAAC,CAAC;EAChD,QAAQ,IAAI,gBAAgB,CAAC,IAAI,EAAE,YAAY,CAAC,EAAE;EAClD,YAAY,QAAQ,YAAY;EAChC,gBAAgB,KAAK,QAAQ,CAAC,GAAG;EACjC,oBAAoB,MAAM,IAAI,KAAK,CAAC,gDAAgD,CAAC,CAAC;EACtF,gBAAgB,KAAK,QAAQ,CAAC,OAAO,EAAE;EACvC,oBAAoB,IAAI,EAAE,GAAG,WAAW,CAAC,OAAO,EAAE,KAAK,CAAC,EAAE,eAAe,GAAG,EAAE,CAAC,aAAa,EAAE,eAAe,GAAG,EAAE,CAAC,aAAa,CAAC;EACjI;EACA,oBAAoB,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;EAC3F,oBAAoB,MAAM;EAC1B,iBAAiB;EACjB,gBAAgB;EAChB,oBAAoB,IAAI,EAAE,GAAG,WAAW,CAAC,YAAY,EAAE,KAAK,CAAC,EAAE,aAAa,GAAG,EAAE,CAAC,aAAa,EAAE,aAAa,GAAG,EAAE,CAAC,aAAa,CAAC;EAClI,oBAAoB,MAAM,CAAC,aAAa,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC,CAAC;EACjE,aAAa;EACb,SAAS;EACT,KAAK;EACL,IAAI,OAAO,MAAM,CAAC;EAClB,CAAC;EACD,SAAS,WAAW,CAAC,UAAU,EAAE,KAAK,EAAE;EACxC,IAAI,IAAI,gBAAgB,GAAG,eAAe,CAAC,UAAU,CAAC,CAAC;EACvD,IAAI,IAAI,aAAa,GAAG,KAAK,GAAG,QAAQ,GAAG,gBAAgB,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,gBAAgB,CAAC;EACzF,IAAI,IAAI,aAAa,GAAG,KAAK,IAAI,KAAK,GAAG,KAAK,GAAG,EAAE,CAAC,GAAG,gBAAgB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;EAClF,IAAI,OAAO,EAAE,aAAa,EAAE,aAAa,EAAE,aAAa,EAAE,aAAa,EAAE,CAAC;EAC1E,CAAC;AACD,EAAO,SAAS,gBAAgB,CAAC,QAAQ,EAAE;EAC3C,IAAI,OAAO,cAAc,CAAC,MAAM,CAAC,UAAU,KAAK,EAAE,IAAI,EAAE;EACxD,QAAQ,IAAI,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,EAAE;EAC9C,YAAY,OAAO,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;EACtC,SAAS;EACT,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK,EAAE,EAAE,CAAC,CAAC;EACX,CAAC;EACD;AACA,EAAO,SAAS,gBAAgB,CAAC,YAAY,EAAE,QAAQ,EAAE;EACzD,IAAI,IAAI,KAAK,GAAG,YAAY,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;EAC/C,IAAI,OAAO,KAAK,GAAG,CAAC,CAAC;EACrB,SAAS,QAAQ,KAAK,QAAQ,CAAC,OAAO;EACtC,YAAY,KAAK,KAAK,CAAC;EACvB,YAAY,YAAY,CAAC,MAAM,CAAC,KAAK,GAAG,CAAC,CAAC,KAAK,GAAG;EAClD,SAAS,CAAC;EACV,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,SAAS,CAAC,YAAY,EAAE,KAAK,EAAE;EAC/C,IAAI,IAAI,QAAQ,GAAG,mBAAmB,CAAC,KAAK,CAAC,CAAC;EAC9C,IAAI,IAAI,GAAG,GAAG,aAAa,CAAC,YAAY,CAAC,GAAG,KAAK,GAAG,EAAE,CAAC;EACvD,IAAI,SAAS,IAAI,CAAC,QAAQ,EAAE;EAC5B,QAAQ,IAAI,QAAQ,KAAK,QAAQ,CAAC,OAAO,EAAE;EAC3C;EACA,YAAY,OAAO,GAAG,GAAG,GAAG,GAAG,UAAU,GAAG,QAAQ,GAAG,MAAM,CAAC;EAC9D,SAAS;EACT,aAAa;EACb,YAAY,OAAO,EAAE,GAAG,GAAG,GAAG,QAAQ,GAAG,GAAG,GAAG,QAAQ,GAAG,GAAG,CAAC;EAC9D,SAAS;EACT,KAAK;EACL,IAAI,IAAI,CAAC,GAAG,cAAc,CAAC,MAAM,CAAC,UAAU,QAAQ,EAAE,EAAE,EAAE;EAC1D,QAAQ,IAAI,gBAAgB,CAAC,YAAY,EAAE,EAAE,CAAC,EAAE;EAChD,YAAY,QAAQ,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC;EACpC,SAAS;EACT,QAAQ,OAAO,QAAQ,CAAC;EACxB,KAAK,EAAE,EAAE,CAAC,CAAC;EACX,IAAI,OAAO,YAAY,CAAC,CAAC,CAAC,CAAC;EAC3B,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,gBAAgB,CAAC,QAAQ,EAAE,KAAK,EAAE,eAAe,EAAE,UAAU,EAAE;EAC/E,IAAI,IAAI,CAAC,QAAQ,EAAE;EACnB,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK;EACL,IAAI,IAAI,cAAc,GAAG,EAAE,CAAC;EAC5B,IAAI,IAAI,UAAU,GAAG,EAAE,CAAC;EACxB,IAAI,IAAI,OAAO,GAAG,gBAAgB,CAAC,QAAQ,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC;EAC5D,IAAI,IAAI,gBAAgB,CAAC,QAAQ,EAAE,QAAQ,CAAC,OAAO,CAAC,EAAE;EACtD;EACA,QAAQ,UAAU,GAAG,gBAAgB,GAAG,KAAK,GAAG,GAAG,CAAC;EACpD,KAAK;EACL,IAAI,IAAI,gBAAgB,CAAC,QAAQ,EAAE,QAAQ,CAAC,KAAK,CAAC,EAAE;EACpD;EACA,QAAQ,cAAc,CAAC,IAAI,CAAC,eAAe,KAAK,KAAK,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC;EACrE,KAAK;EACL,IAAI,IAAI,gBAAgB,CAAC,QAAQ,EAAE,QAAQ,CAAC,GAAG,CAAC,EAAE;EAClD,QAAQ,cAAc,CAAC,IAAI,CAAC,eAAe,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC;EAC3D,KAAK;EACL,SAAS,IAAI,gBAAgB,CAAC,QAAQ,EAAE,QAAQ,CAAC,IAAI,CAAC,EAAE;EACxD,QAAQ,cAAc,CAAC,IAAI,CAAC,IAAI,IAAI,OAAO,GAAG,GAAG,GAAG,EAAE,CAAC,CAAC,CAAC;EACzD,KAAK;EACL,IAAI,IAAI,OAAO,EAAE;EACjB,QAAQ,cAAc,CAAC,IAAI,CAAC,eAAe,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC;EAC3D,KAAK;EACL,IAAI,IAAI,cAAc,GAAG,EAAE,CAAC;EAC5B,IAAI,IAAI,gBAAgB,CAAC,QAAQ,EAAE,QAAQ,CAAC,KAAK,CAAC,EAAE;EACpD,QAAQ,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EAClC,KAAK;EACL,IAAI,IAAI,gBAAgB,CAAC,QAAQ,EAAE,QAAQ,CAAC,OAAO,CAAC,EAAE;EACtD,QAAQ,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EAClC,KAAK;EACL,IAAI,IAAI,gBAAgB,CAAC,QAAQ,EAAE,QAAQ,CAAC,OAAO,CAAC,EAAE;EACtD,QAAQ,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EAClC,KAAK;EACL,IAAI,IAAI,gBAAgB,CAAC,QAAQ,EAAE,QAAQ,CAAC,YAAY,CAAC,EAAE;EAC3D,QAAQ,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EAClC,KAAK;EACL,IAAI,IAAI,kBAAkB,GAAG,EAAE,CAAC;EAChC,IAAI,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE;EACnC,QAAQ,kBAAkB,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;EAC1D,KAAK;EACL,IAAI,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE;EACnC,QAAQ,kBAAkB,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;EAC1D,KAAK;EACL,IAAI,IAAI,kBAAkB,CAAC,MAAM,GAAG,CAAC,EAAE;EACvC,QAAQ,IAAI,UAAU,EAAE;EACxB;EACA,YAAY,UAAU,IAAI,WAAW,CAAC;EACtC,SAAS;EACT;EACA;EACA;EACA,QAAQ,IAAI,UAAU,EAAE;EACxB,YAAY,UAAU,IAAI,YAAY,GAAG,KAAK,GAAG,KAAK,GAAG,kBAAkB,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC;EAC7F,SAAS;EACT,aAAa;EACb,YAAY,UAAU,IAAI,aAAa,GAAG,KAAK,GAAG,KAAK,GAAG,kBAAkB,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC;EAC9F,SAAS;EACT,KAAK;EACL;EACA,IAAI,OAAO,UAAU,IAAI,SAAS,CAAC;EACnC,CAAC;AACD,EAAO,SAAS,iBAAiB,CAAC,QAAQ,EAAE;EAC5C,IAAI,IAAI,QAAQ,KAAK,KAAK,IAAI,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;EAC5D,QAAQQ,IAAQ,CAACC,OAAW,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC,CAAC;EAC5D,QAAQ,OAAO,QAAQ,CAAC,OAAO,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;EAC/C,KAAK;EACL,IAAI,OAAO,QAAQ,CAAC;EACpB,CAAC;;;;;;;;;;;;;;;;;;;EC7RD;EACA;AACA,EAAO,IAAI,IAAI,CAAC;EAChB,CAAC,UAAU,IAAI,EAAE;EACjB,IAAI,IAAI,CAAC,YAAY,GAAG,cAAc,CAAC;EACvC,IAAI,IAAI,CAAC,OAAO,GAAG,SAAS,CAAC;EAC7B,IAAI,IAAI,CAAC,QAAQ,GAAG,UAAU,CAAC;EAC/B,IAAI,IAAI,CAAC,OAAO,GAAG,SAAS,CAAC;EAC7B,IAAI,IAAI,CAAC,QAAQ,GAAG,UAAU,CAAC;EAC/B,IAAI,IAAI,CAAC,SAAS,GAAG,WAAW,CAAC;EACjC,IAAI,IAAI,CAAC,OAAO,GAAG,SAAS,CAAC;EAC7B,CAAC,EAAE,IAAI,KAAK,IAAI,GAAG,EAAE,CAAC,CAAC,CAAC;AACxB,EAAO,IAAI,UAAU,GAAG;EACxB,IAAI,YAAY,EAAE,CAAC;EACnB,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,QAAQ,EAAE,CAAC;EACf,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,QAAQ,EAAE,CAAC;EACf,IAAI,SAAS,EAAE,CAAC;EAChB,IAAI,OAAO,EAAE,CAAC;EACd,CAAC,CAAC;AACF,EAAO,SAAS,MAAM,CAAC,CAAC,EAAE;EAC1B,IAAI,OAAO,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;EAC3B,CAAC;AACD,EAAO,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;AAC5C,EAAO,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;AAClC,EAAO,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;AACpC,EAAO,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;AAClC,EAAO,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;EAClC;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,WAAW,CAAC,IAAI,EAAE;EAClC,IAAI,IAAI,IAAI,EAAE;EACd,QAAQ,IAAI,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;EAClC,QAAQ,QAAQ,IAAI;EACpB,YAAY,KAAK,GAAG,CAAC;EACrB,YAAY,KAAK,YAAY;EAC7B,gBAAgB,OAAO,cAAc,CAAC;EACtC,YAAY,KAAK,GAAG,CAAC;EACrB,YAAY,KAAK,QAAQ;EACzB,gBAAgB,OAAO,UAAU,CAAC;EAClC,YAAY,KAAK,GAAG,CAAC;EACrB,YAAY,KAAK,OAAO;EACxB,gBAAgB,OAAO,SAAS,CAAC;EACjC,YAAY,KAAK,GAAG,CAAC;EACrB,YAAY,KAAK,OAAO;EACxB,gBAAgB,OAAO,SAAS,CAAC;EACjC,YAAY,KAAK,IAAI,CAAC,QAAQ;EAC9B,gBAAgB,OAAO,UAAU,CAAC;EAClC,YAAY,KAAK,IAAI,CAAC,SAAS;EAC/B,gBAAgB,OAAO,WAAW,CAAC;EACnC,YAAY,KAAK,OAAO;EACxB,gBAAgB,OAAO,SAAS,CAAC;EACjC,SAAS;EACT,KAAK;EACL;EACA,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;;;;;;;;;;;;;;ECnDM,SAAS,sBAAsB,CAAC,CAAC,EAAE;EAC1C,IAAI,OAAO,CAAC,CAAC,WAAW,CAAC,CAAC;EAC1B,CAAC;AACD,EAAO,SAAS,WAAW,CAACF,QAAK,EAAE;EACnC,IAAI,OAAOA,QAAK,IAAI,CAAC,QAAQ,CAACA,QAAK,CAAC,IAAI,QAAQ,IAAIA,QAAK,CAAC;EAC1D,CAAC;AACD,EAAO,SAAS,cAAc,CAAC,QAAQ,EAAE;EACzC,IAAI,IAAIA,QAAK,GAAG,QAAQ,CAAC,KAAK,EAAE,QAAQ,GAAG,QAAQ,CAAC,QAAQ,EAAE,GAAG,GAAG,QAAQ,CAAC,GAAG,EAAE,SAAS,GAAG,QAAQ,CAAC,SAAS,CAAC;EACjH,IAAI,OAAOP,QAAgB,CAAC,EAAE,GAAG,QAAQ,GAAG,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,EAAE,IAAI,GAAG,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,SAAS,GAAG,EAAE,SAAS,EAAE,SAAS,EAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAEO,QAAK,EAAE,CAAC,CAAC;EACpK,CAAC;AACD,EAAO,SAAS,gBAAgB,CAAC,UAAU,EAAE;EAC7C,IAAI,OAAO,CAAC,CAAC,UAAU,IAAI,CAAC,CAAC,UAAU,CAAC,SAAS,CAAC;EAClD,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,sBAAsB,CAAC,UAAU,EAAE;EACnD,IAAI,OAAO,CAAC,CAAC,UAAU,IAAI,CAAC,CAAC,UAAU,CAAC,SAAS,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,SAAS,CAAC,IAAI,UAAU,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;EACxH,CAAC;AACD,EAAO,SAAS,sBAAsB,CAAC,UAAU,EAAE;EACnD,IAAI,OAAO,CAAC,CAAC,UAAU,IAAI,CAAC,CAAC,UAAU,CAAC,SAAS,KAAK,OAAO,CAAC,UAAU,CAAC,SAAS,CAAC,IAAI,UAAU,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC;EACzH,CAAC;AACD,EAAO,SAAS,UAAU,CAAC,UAAU,EAAE;EACvC,IAAI,OAAO,CAAC,CAAC,UAAU,KAAK,CAAC,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,UAAU,CAAC,WAAW,CAAC,KAAK,OAAO,CAAC,CAAC;EAC1F,CAAC;AACD,EAAO,SAAS,gBAAgB,CAAC,QAAQ,EAAE;EAC3C,IAAI,OAAO,UAAU,CAAC,QAAQ,CAAC,IAAI,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;EAC5D,CAAC;AACD,EAAO,SAAS,UAAU,CAAC,UAAU,EAAE;EACvC,IAAI,OAAO,UAAU,IAAI,OAAO,IAAI,UAAU,IAAI,UAAU,CAAC,OAAO,CAAC,KAAK,SAAS,CAAC;EACpF,CAAC;AACD,EAAO,SAAS,eAAe,CAAC,UAAU,EAAE;EAC5C,IAAI,OAAO,CAAC,CAAC,UAAU,KAAK,CAAC,CAAC,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC;EAC3E,CAAC;EACD,SAAS,YAAY,CAAC,QAAQ,EAAE;EAChC,IAAI,OAAO,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;EAC5B,CAAC;AACD,EAAO,SAAS,OAAO,CAAC,QAAQ,EAAE,GAAG,EAAE;EACvC,IAAI,IAAI,GAAG,KAAK,KAAK,CAAC,EAAE,EAAE,GAAG,GAAG,EAAE,CAAC,EAAE;EACrC,IAAI,IAAIA,QAAK,GAAG,QAAQ,CAAC,KAAK,CAAC;EAC/B,IAAI,IAAI,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC;EAC5B,IAAI,IAAI,MAAM,GAAG,GAAG,CAAC,MAAM,CAAC;EAC5B,IAAI,IAAI,OAAO,CAAC,QAAQ,CAAC,EAAE;EAC3B,QAAQA,QAAK,GAAG,SAAS,CAAC;EAC1B,KAAK;EACL,SAAS;EACT,QAAQ,IAAI,EAAE,GAAG,SAAS,CAAC;EAC3B,QAAQ,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE;EACvB,YAAY,IAAI,YAAY,CAAC,QAAQ,CAAC,EAAE;EACxC,gBAAgB,EAAE,GAAG,QAAQ,CAAC,EAAE,CAAC;EACjC,aAAa;EACb,iBAAiB,IAAI,QAAQ,CAAC,GAAG,EAAE;EACnC,gBAAgB,EAAE,GAAG,WAAW,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;EAC/C,gBAAgB,MAAM,GAAG,GAAG,CAAC,SAAS,IAAI,EAAE,CAAC;EAC7C,aAAa;EACb,iBAAiB,IAAI,QAAQ,CAAC,SAAS,EAAE;EACzC,gBAAgB,EAAE,GAAG,MAAM,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;EAChD,aAAa;EACb,iBAAiB,IAAI,QAAQ,CAAC,QAAQ,EAAE;EACxC,gBAAgB,EAAE,GAAG,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;EAC/C,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,EAAE,EAAE;EAChB,YAAYA,QAAK,GAAGA,QAAK,GAAG,EAAE,GAAG,GAAG,GAAGA,QAAK,GAAG,EAAE,CAAC;EAClD,SAAS;EACT,KAAK;EACL,IAAI,IAAI,MAAM,EAAE;EAChB,QAAQA,QAAK,GAAGA,QAAK,GAAG,GAAG,GAAG,MAAM,CAAC;EACrC,KAAK;EACL,IAAI,IAAI,MAAM,EAAE;EAChB,QAAQA,QAAK,GAAG,MAAM,GAAG,GAAG,GAAGA,QAAK,CAAC;EACrC,KAAK;EACL,IAAI,IAAI,GAAG,CAAC,IAAI,EAAE;EAClB;EACA,QAAQ,OAAO,mBAAmB,CAACA,QAAK,EAAE,GAAG,CAAC,IAAI,CAAC,CAAC;EACpD,KAAK;EACL,SAAS;EACT;EACA,QAAQ,OAAO,kBAAkB,CAACA,QAAK,CAAC,CAAC;EACzC,KAAK;EACL,CAAC;AACD,EAAO,SAAS,UAAU,CAAC,QAAQ,EAAE;EACrC,IAAI,QAAQ,QAAQ,CAAC,IAAI;EACzB,QAAQ,KAAK,SAAS,CAAC;EACvB,QAAQ,KAAK,SAAS,CAAC;EACvB,QAAQ,KAAK,SAAS;EACtB,YAAY,OAAO,IAAI,CAAC;EACxB,QAAQ,KAAK,cAAc;EAC3B,YAAY,OAAO,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC;EAClC,QAAQ,KAAK,UAAU,CAAC;EACxB,QAAQ,KAAK,WAAW,CAAC;EACzB,QAAQ,KAAK,UAAU;EACvB,YAAY,OAAO,KAAK,CAAC;EACzB,KAAK;EACL,IAAI,MAAM,IAAI,KAAK,CAACE,OAAW,CAAC,gBAAgB,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;EACjE,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,QAAQ,EAAE;EACvC,IAAI,OAAO,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;EACjC,CAAC;AACD,EAAO,SAAS,OAAO,CAAC,QAAQ,EAAE;EAClC,IAAI,OAAO,QAAQ,CAAC,SAAS,KAAK,OAAO,CAAC;EAC1C,CAAC;AACD,EAAO,SAAS,oBAAoB,CAAC,QAAQ,EAAE,MAAM,EAAE;EACvD,IAAI,IAAIF,QAAK,GAAG,QAAQ,CAAC,KAAK,EAAE,GAAG,GAAG,QAAQ,CAAC,GAAG,EAAE,QAAQ,GAAG,QAAQ,CAAC,QAAQ,EAAE,SAAS,GAAG,QAAQ,CAAC,SAAS,CAAC;EACjH,IAAI,IAAI,SAAS,KAAK,OAAO,EAAE;EAC/B,QAAQ,OAAO,MAAM,CAAC,UAAU,CAAC;EACjC,KAAK;EACL,SAAS,IAAI,GAAG,EAAE;EAClB,QAAQ,OAAOA,QAAK,GAAG,WAAW,CAAC;EACnC,KAAK;EACL,SAAS,IAAI,QAAQ,EAAE;EACvB,QAAQ,IAAI,KAAK,GAAG,gBAAgB,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;EACzD,QAAQ,OAAOA,QAAK,GAAG,IAAI,GAAG,KAAK,GAAG,GAAG,CAAC;EAC1C,KAAK;EACL,SAAS,IAAI,SAAS,EAAE;EACxB,QAAQ,OAAO,SAAS,CAAC,SAAS,CAAC,GAAG,MAAM,GAAGA,QAAK,CAAC;EACrD,KAAK;EACL,IAAI,OAAOA,QAAK,CAAC;EACjB,CAAC;AACD,EAAO,SAAS,wBAAwB,CAAC,QAAQ,EAAE,MAAM,EAAE;EAC3D,IAAI,IAAI,EAAE,GAAG,QAAQ,CAAC,SAAS,IAAI,QAAQ,CAAC,QAAQ,KAAK,QAAQ,CAAC,GAAG,IAAI,KAAK,CAAC,CAAC;EAChF,IAAI,IAAI,EAAE,EAAE;EACZ,QAAQ,OAAO,EAAE,CAAC,WAAW,EAAE,GAAG,GAAG,GAAG,QAAQ,CAAC,KAAK,GAAG,GAAG,CAAC;EAC7D,KAAK;EACL,SAAS;EACT,QAAQ,OAAO,QAAQ,CAAC,KAAK,CAAC;EAC9B,KAAK;EACL,CAAC;AACD,EAAO,IAAI,qBAAqB,GAAG,UAAU,QAAQ,EAAE,MAAM,EAAE;EAC/D,IAAI,QAAQ,MAAM,CAAC,UAAU;EAC7B,QAAQ,KAAK,OAAO;EACpB,YAAY,OAAO,QAAQ,CAAC,KAAK,CAAC;EAClC,QAAQ,KAAK,YAAY;EACzB,YAAY,OAAO,wBAAwB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;EAC9D,QAAQ;EACR,YAAY,OAAO,oBAAoB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;EAC1D,KAAK;EACL,CAAC,CAAC;EACF,IAAI,cAAc,GAAG,qBAAqB,CAAC;AAC3C,EAAO,SAAS,iBAAiB,CAAC,SAAS,EAAE;EAC7C,IAAI,cAAc,GAAG,SAAS,CAAC;EAC/B,CAAC;AACD,EAAO,SAAS,mBAAmB,GAAG;EACtC,IAAI,iBAAiB,CAAC,qBAAqB,CAAC,CAAC;EAC7C,CAAC;AACD,EAAO,SAAS,KAAK,CAAC,QAAQ,EAAE,MAAM,EAAE;EACxC,IAAI,OAAO,cAAc,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;EAC5C,CAAC;AACD,EAAO,SAAS,WAAW,CAAC,QAAQ,EAAE,OAAO,EAAE;EAC/C,IAAI,IAAI,QAAQ,CAAC,QAAQ,EAAE;EAC3B,QAAQ,OAAO,UAAU,CAAC;EAC1B,KAAK;EACL,IAAI,IAAI,QAAQ,CAAC,GAAG,EAAE;EACtB,QAAQ,OAAO,cAAc,CAAC;EAC9B,KAAK;EACL,IAAI,QAAQ,SAAS,CAAC,OAAO,CAAC;EAC9B,QAAQ,KAAK,YAAY;EACzB,YAAY,OAAO,cAAc,CAAC;EAClC,QAAQ,KAAK,UAAU;EACvB,YAAY,OAAO,SAAS,CAAC;EAC7B,QAAQ,KAAK,UAAU;EACvB,YAAY,OAAO,SAAS,CAAC;EAC7B,QAAQ;EACR,YAAY,OAAO,cAAc,CAAC;EAClC,KAAK;EACL,CAAC;EACD;EACA;EACA;EACA;AACA,EAAO,SAAS,WAAW,CAAC,UAAU,EAAE;EACxC,IAAI,IAAI,UAAU,CAAC,UAAU,CAAC,EAAE;EAChC,QAAQ,OAAO,UAAU,CAAC;EAC1B,KAAK;EACL,SAAS,IAAI,sBAAsB,CAAC,UAAU,CAAC,EAAE;EACjD,QAAQ,OAAO,UAAU,CAAC,SAAS,CAAC;EACpC,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,SAAS,CAAC,UAAU,EAAE,OAAO,EAAE;EAC/C,IAAI,IAAI,QAAQ,CAAC,UAAU,CAAC,IAAI,QAAQ,CAAC,UAAU,CAAC,IAAI,SAAS,CAAC,UAAU,CAAC,EAAE;EAC/E,QAAQ,IAAI,aAAa,GAAG,QAAQ,CAAC,UAAU,CAAC,GAAG,QAAQ;EAC3D,YAAY,QAAQ,CAAC,UAAU,CAAC,GAAG,QAAQ,GAAG,SAAS,CAAC;EACxD,QAAQC,IAAQ,CAACC,OAAW,CAAC,mBAAmB,CAAC,OAAO,EAAE,aAAa,EAAE,UAAU,CAAC,CAAC,CAAC;EACtF,QAAQ,OAAO,EAAE,KAAK,EAAE,UAAU,EAAE,CAAC;EACrC,KAAK;EACL;EACA,IAAI,IAAI,UAAU,CAAC,UAAU,CAAC,EAAE;EAChC,QAAQ,OAAO,iBAAiB,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;EACtD,KAAK;EACL,SAAS,IAAI,sBAAsB,CAAC,UAAU,CAAC,EAAE;EACjD,QAAQ,OAAOT,QAAgB,CAAC,EAAE,EAAE,UAAU,EAAE;EAChD;EACA,YAAY,SAAS,EAAE,iBAAiB,CAAC,UAAU,CAAC,SAAS,EAAE,OAAO,CAAC,EAAE,CAAC,CAAC;EAC3E,KAAK;EACL,IAAI,OAAO,UAAU,CAAC;EACtB,CAAC;AACD,EAAO,SAAS,iBAAiB,CAAC,QAAQ,EAAE,OAAO,EAAE;EACrD;EACA,IAAI,IAAI,QAAQ,CAAC,SAAS,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE;EAClE,QAAQ,IAAI,SAAS,GAAG,QAAQ,CAAC,SAAS,EAAE,wBAAwB,GAAGK,MAAc,CAAC,QAAQ,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC;EAC/G,QAAQG,IAAQ,CAACC,OAAW,CAAC,gBAAgB,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC;EACnE,QAAQ,QAAQ,GAAG,wBAAwB,CAAC;EAC5C,KAAK;EACL;EACA,IAAI,IAAI,QAAQ,CAAC,QAAQ,EAAE;EAC3B,QAAQ,QAAQ,GAAGT,QAAgB,CAAC,EAAE,EAAE,QAAQ,EAAE,EAAE,QAAQ,EAAE,iBAAiB,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;EACtG,KAAK;EACL;EACA,IAAI,IAAI,QAAQ,CAAC,GAAG,EAAE;EACtB,QAAQ,QAAQ,GAAGA,QAAgB,CAAC,EAAE,EAAE,QAAQ,EAAE,EAAE,GAAG,EAAE,YAAY,CAAC,QAAQ,CAAC,GAAG,EAAE,OAAO,CAAC,EAAE,CAAC,CAAC;EAChG,KAAK;EACL;EACA,IAAI,IAAI,QAAQ,CAAC,IAAI,EAAE;EACvB,QAAQ,IAAI,QAAQ,GAAG,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;EAClD,QAAQ,IAAI,QAAQ,CAAC,IAAI,KAAK,QAAQ,EAAE;EACxC;EACA,YAAY,QAAQ,GAAGA,QAAgB,CAAC,EAAE,EAAE,QAAQ,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAC;EAC1E,SAAS;EACT,QAAQ,IAAI,QAAQ,CAAC,IAAI,KAAK,cAAc,EAAE;EAC9C,YAAY,IAAI,qBAAqB,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE;EAC3D,gBAAgBQ,IAAQ,CAACC,OAAW,CAAC,iCAAiC,CAAC,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC;EAC3G,gBAAgB,QAAQ,GAAGT,QAAgB,CAAC,EAAE,EAAE,QAAQ,EAAE,EAAE,IAAI,EAAE,cAAc,EAAE,CAAC,CAAC;EACpF,aAAa;EACb,SAAS;EACT,KAAK;EACL,SAAS;EACT;EACA,QAAQ,IAAI,OAAO,GAAG,WAAW,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;EACrD,QAAQQ,IAAQ,CAACC,OAAW,CAAC,uBAAuB,CAAC,QAAQ,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC;EACvF,QAAQ,QAAQ,GAAGT,QAAgB,CAAC,EAAE,EAAE,QAAQ,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;EACrE,KAAK;EACL,IAAI,IAAI,EAAE,GAAG,oBAAoB,CAAC,QAAQ,EAAE,OAAO,CAAC,EAAE,UAAU,GAAG,EAAE,CAAC,UAAU,EAAE,OAAO,GAAG,EAAE,CAAC,OAAO,CAAC;EACvG,IAAI,IAAI,CAAC,UAAU,EAAE;EACrB,QAAQQ,IAAQ,CAAC,OAAO,CAAC,CAAC;EAC1B,KAAK;EACL,IAAI,OAAO,QAAQ,CAAC;EACpB,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,GAAG,EAAE,OAAO,EAAE;EAC3C,IAAI,IAAI,SAAS,CAAC,GAAG,CAAC,EAAE;EACxB,QAAQ,OAAO,EAAE,OAAO,EAAE,WAAW,CAAC,OAAO,CAAC,EAAE,CAAC;EACjD,KAAK;EACL,SAAS,IAAI,CAAC,GAAG,CAAC,OAAO,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE;EACxC,QAAQ,OAAOR,QAAgB,CAAC,EAAE,EAAE,GAAG,EAAE,EAAE,OAAO,EAAE,WAAW,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;EAC5E,KAAK;EACL,SAAS;EACT,QAAQ,OAAO,GAAG,CAAC;EACnB,KAAK;EACL,CAAC;EACD,IAAI,UAAU,GAAG,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC;AACtC,EAAO,SAAS,oBAAoB,CAAC,QAAQ,EAAE,OAAO,EAAE;EACxD,IAAI,IAAI,IAAI,GAAG,QAAQ,CAAC,IAAI,CAAC;EAC7B,IAAI,QAAQ,OAAO;EACnB,QAAQ,KAAK,KAAK,CAAC;EACnB,QAAQ,KAAK,QAAQ;EACrB,YAAY,IAAI,YAAY,CAAC,QAAQ,CAAC,EAAE;EACxC,gBAAgB,OAAO;EACvB,oBAAoB,UAAU,EAAE,KAAK;EACrC,oBAAoB,OAAO,EAAES,OAAW,CAAC,4BAA4B,CAAC,OAAO,CAAC;EAC9E,iBAAiB,CAAC;EAClB,aAAa;EACb,YAAY,OAAO,UAAU,CAAC;EAC9B,QAAQ,KAAK,GAAG,CAAC;EACjB,QAAQ,KAAK,GAAG,CAAC;EACjB,QAAQ,KAAK,OAAO,CAAC;EACrB,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,QAAQ,CAAC;EACtB,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,QAAQ,CAAC;EACtB,QAAQ,KAAK,KAAK,CAAC;EACnB,QAAQ,KAAK,SAAS,CAAC;EACvB,QAAQ,KAAK,MAAM;EACnB,YAAY,OAAO,UAAU,CAAC;EAC9B,QAAQ,KAAK,WAAW,CAAC;EACzB,QAAQ,KAAK,YAAY,CAAC;EAC1B,QAAQ,KAAK,UAAU,CAAC;EACxB,QAAQ,KAAK,WAAW;EACxB,YAAY,IAAI,IAAI,KAAK,YAAY,EAAE;EACvC,gBAAgB,OAAO;EACvB,oBAAoB,UAAU,EAAE,KAAK;EACrC,oBAAoB,OAAO,EAAE,UAAU,GAAG,OAAO,GAAG,sDAAsD,GAAG,QAAQ,CAAC,IAAI,GAAG,SAAS;EACtI,iBAAiB,CAAC;EAClB,aAAa;EACb,YAAY,OAAO,UAAU,CAAC;EAC9B,QAAQ,KAAK,SAAS,CAAC;EACvB,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,IAAI,CAAC;EAClB,QAAQ,KAAK,IAAI;EACjB,YAAY,IAAI,CAAC,IAAI,KAAK,SAAS,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,IAAI,KAAK,SAAS,EAAE;EACjF,gBAAgB,OAAO;EACvB,oBAAoB,UAAU,EAAE,KAAK;EACrC,oBAAoB,OAAO,EAAE,UAAU,GAAG,OAAO,GAAG,sDAAsD;EAC1G,iBAAiB,CAAC;EAClB,aAAa;EACb,YAAY,OAAO,UAAU,CAAC;EAC9B,QAAQ,KAAK,OAAO;EACpB,YAAY,IAAI,QAAQ,CAAC,IAAI,KAAK,SAAS,IAAI,QAAQ,CAAC,IAAI,KAAK,SAAS,EAAE;EAC5E,gBAAgB,OAAO;EACvB,oBAAoB,UAAU,EAAE,KAAK;EACrC,oBAAoB,OAAO,EAAE,uEAAuE;EACpG,iBAAiB,CAAC;EAClB,aAAa;EACb,YAAY,OAAO,UAAU,CAAC;EAC9B,QAAQ,KAAK,OAAO;EACpB,YAAY,IAAI,QAAQ,CAAC,IAAI,KAAK,SAAS,EAAE;EAC7C,gBAAgB,OAAO;EACvB,oBAAoB,UAAU,EAAE,KAAK;EACrC,oBAAoB,OAAO,EAAE,gFAAgF;EAC7G,iBAAiB,CAAC;EAClB,aAAa;EACb,YAAY,OAAO,UAAU,CAAC;EAC9B,KAAK;EACL,IAAI,MAAM,IAAI,KAAK,CAAC,mDAAmD,GAAG,OAAO,CAAC,CAAC;EACnF,CAAC;AACD,EAAO,SAAS,gBAAgB,CAAC,QAAQ,EAAE;EAC3C,IAAI,OAAO,QAAQ,CAAC,IAAI,KAAK,cAAc,IAAI,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC;EAC9D,CAAC;AACD,EAAO,SAAS,cAAc,CAAC,QAAQ,EAAE;EACzC,IAAI,OAAO,QAAQ,CAAC,IAAI,KAAK,UAAU,IAAI,CAAC,CAAC,QAAQ,CAAC,QAAQ,CAAC;EAC/D,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ECpUM,SAAS,eAAe,CAAC,QAAQ,EAAE,OAAO,EAAE;EACnD,IAAI,IAAI,UAAU,GAAG,QAAQ,IAAI,QAAQ,CAAC,OAAO,CAAC,CAAC;EACnD,IAAI,IAAI,UAAU,EAAE;EACpB,QAAQ,IAAI,OAAO,CAAC,UAAU,CAAC,EAAE;EACjC,YAAY,OAAO,IAAI,CAAC,UAAU,EAAE,UAAU,QAAQ,EAAE,EAAE,OAAO,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;EACtF,SAAS;EACT,aAAa;EACb,YAAY,OAAO,UAAU,CAAC,UAAU,CAAC,IAAI,sBAAsB,CAAC,UAAU,CAAC,CAAC;EAChF,SAAS;EACT,KAAK;EACL,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;AACD,EAAO,SAAS,WAAW,CAAC,QAAQ,EAAE;EACtC,IAAI,OAAO,IAAI,CAAC,QAAQ,EAAE,UAAU,OAAO,EAAE;EAC7C,QAAQ,IAAI,eAAe,CAAC,QAAQ,EAAE,OAAO,CAAC,EAAE;EAChD,YAAY,IAAI,UAAU,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC/C,YAAY,IAAI,OAAO,CAAC,UAAU,CAAC,EAAE;EACrC,gBAAgB,OAAO,IAAI,CAAC,UAAU,EAAE,UAAU,QAAQ,EAAE,EAAE,OAAO,CAAC,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;EAC9F,aAAa;EACb,iBAAiB;EACjB,gBAAgB,IAAI,QAAQ,GAAG,WAAW,CAAC,UAAU,CAAC,CAAC;EACvD,gBAAgB,OAAO,QAAQ,IAAI,CAAC,CAAC,QAAQ,CAAC,SAAS,CAAC;EACxD,aAAa;EACb,SAAS;EACT,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK,CAAC,CAAC;EACP,CAAC;AACD,EAAO,SAAS,iBAAiB,CAAC,QAAQ,EAAE,IAAI,EAAE;EAClD,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,UAAU,kBAAkB,EAAE,OAAO,EAAE;EACxE,QAAQ,IAAI,EAAE,CAAC;EACf,QAAQ,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE;EACjC;EACA,YAAYD,IAAQ,CAACC,OAAW,CAAC,sBAAsB,CAAC,OAAO,CAAC,CAAC,CAAC;EAClE,YAAY,OAAO,kBAAkB,CAAC;EACtC,SAAS;EACT,QAAQ,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,IAAI,CAAC,EAAE;EACzC;EACA,YAAYD,IAAQ,CAACC,OAAW,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC;EACrE,YAAY,OAAO,kBAAkB,CAAC;EACtC,SAAS;EACT;EACA,QAAQ,IAAI,OAAO,KAAK,MAAM,IAAI,IAAI,KAAK,MAAM,EAAE;EACnD,YAAY,IAAI,QAAQ,GAAG,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;EAC1D,YAAY,IAAI,QAAQ,IAAI,QAAQ,CAAC,SAAS,EAAE;EAChD,gBAAgBD,IAAQ,CAACC,OAAW,CAAC,sBAAsB,CAAC,CAAC;EAC7D,gBAAgB,OAAO,kBAAkB,CAAC;EAC1C,aAAa;EACb,SAAS;EACT;EACA,QAAQ,IAAI,OAAO,KAAK,OAAO,KAAK,MAAM,IAAI,QAAQ,IAAI,QAAQ,IAAI,QAAQ,CAAC,EAAE;EACjF,YAAYD,IAAQ,CAACC,OAAW,CAAC,aAAa,CAAC,UAAU,EAAE,EAAE,IAAI,EAAE,MAAM,IAAI,QAAQ,EAAE,MAAM,EAAE,QAAQ,IAAI,QAAQ,EAAE,CAAC,CAAC,CAAC;EACxH,YAAY,OAAO,kBAAkB,CAAC;EACtC,SAAS;EACT,QAAQ,IAAI,UAAU,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC3C,QAAQ,IAAI,OAAO,KAAK,QAAQ;EAChC,aAAa,OAAO,KAAK,OAAO,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;EACpF,aAAa,OAAO,KAAK,SAAS,IAAI,OAAO,CAAC,UAAU,CAAC,CAAC,EAAE;EAC5D,YAAY,IAAI,UAAU,EAAE;EAC5B;EACA,gBAAgB,kBAAkB,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,UAAU,CAAC,GAAG,UAAU,GAAG,CAAC,UAAU,CAAC;EAC9F,qBAAqB,MAAM,CAAC,UAAU,IAAI,EAAE,QAAQ,EAAE;EACtD,oBAAoB,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,EAAE;EAC/C,wBAAwBD,IAAQ,CAACC,OAAW,CAAC,aAAa,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC;EAC/E,qBAAqB;EACrB,yBAAyB;EACzB,wBAAwB,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC;EACxE,qBAAqB;EACrB,oBAAoB,OAAO,IAAI,CAAC;EAChC,iBAAiB,EAAE,EAAE,CAAC,CAAC;EACvB,aAAa;EACb,SAAS;EACT,aAAa;EACb,YAAY,IAAI,QAAQ,GAAG,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;EAC1D,YAAY,IAAI,QAAQ,IAAI,QAAQ,CAAC,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,QAAQ,CAAC,IAAI,CAAC,EAAE;EACtF,gBAAgB,IAAI,EAAE,GAAG,OAAO,EAAE,CAAC,GAAG,kBAAkB,CAAC,EAAE,CAAC,EAAE,WAAW,GAAGJ,MAAc,CAAC,kBAAkB,EAAE,CAAC,OAAO,EAAE,KAAK,QAAQ,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC;EACxJ,gBAAgB,IAAI,UAAU,GAAG,OAAO,KAAK,GAAG,GAAG,WAAW;EAC9D,oBAAoB,OAAO,KAAK,GAAG,GAAG,UAAU;EAChD,wBAAwB,OAAO,KAAK,IAAI,GAAG,YAAY;EACvD,4BAA4B,OAAO,KAAK,IAAI,GAAG,WAAW,GAAG,SAAS,CAAC;EACvE,gBAAgBG,IAAQ,CAACC,OAAW,CAAC,iBAAiB,CAAC,OAAO,EAAE,QAAQ,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC,CAAC;EAC5F,gBAAgB,OAAOT,QAAgB,CAAC,EAAE,EAAE,WAAW,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,GAAGA,QAAgB,CAAC,EAAE,EAAE,SAAS,CAAC,QAAQ,EAAE,OAAO,CAAC,EAAE,EAAE,IAAI,EAAE,cAAc,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;EACvK,aAAa;EACb,YAAY,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,EAAE;EACrG,gBAAgBQ,IAAQ,CAACC,OAAW,CAAC,aAAa,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC,CAAC;EACzE,gBAAgB,OAAO,kBAAkB,CAAC;EAC1C,aAAa;EACb,YAAY,kBAAkB,CAAC,OAAO,CAAC,GAAG,SAAS,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;EACzE,SAAS;EACT,QAAQ,OAAO,kBAAkB,CAAC;EAClC,KAAK,EAAE,EAAE,CAAC,CAAC;EACX,CAAC;AACD,EAAO,SAAS,QAAQ,CAAC,QAAQ,EAAE;EACnC,IAAI,OAAO,QAAQ,KAAK,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,EAAE,MAAM,CAAC,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;EAC5F,CAAC;AACD,EAAO,SAAS,SAAS,CAAC,QAAQ,EAAE;EACpC,IAAI,IAAI,GAAG,GAAG,EAAE,CAAC;EACjB,IAAI,QAAQ,CAAC,OAAO,CAAC,UAAU,OAAO,EAAE;EACxC,QAAQ,IAAI,eAAe,CAAC,QAAQ,EAAE,OAAO,CAAC,EAAE;EAChD,YAAY,IAAI,UAAU,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC/C,YAAY,CAAC,OAAO,CAAC,UAAU,CAAC,GAAG,UAAU,GAAG,CAAC,UAAU,CAAC,EAAE,OAAO,CAAC,UAAU,GAAG,EAAE;EACrF,gBAAgB,IAAI,UAAU,CAAC,GAAG,CAAC,EAAE;EACrC,oBAAoB,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;EAClC,iBAAiB;EACjB,qBAAqB,IAAI,sBAAsB,CAAC,GAAG,CAAC,EAAE;EACtD,oBAAoB,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;EAC5C,iBAAiB;EACjB,aAAa,CAAC,CAAC;EACf,SAAS;EACT,KAAK,CAAC,CAAC;EACP,IAAI,OAAO,GAAG,CAAC;EACf,CAAC;AACD,EAAO,SAAS,OAAO,CAAC,OAAO,EAAE,CAAC,EAAE,OAAO,EAAE;EAC7C,IAAI,IAAI,CAAC,OAAO,EAAE;EAClB,QAAQ,OAAO;EACf,KAAK;EACL,IAAI,IAAI,OAAO,GAAG,UAAU,OAAO,EAAE;EACrC,QAAQ,IAAI,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,EAAE;EACvC,YAAY,OAAO,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,UAAU,UAAU,EAAE;EAC3D,gBAAgB,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,UAAU,EAAE,OAAO,CAAC,CAAC;EACrD,aAAa,CAAC,CAAC;EACf,SAAS;EACT,aAAa;EACb,YAAY,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,OAAO,CAAC,OAAO,CAAC,EAAE,OAAO,CAAC,CAAC;EACvD,SAAS;EACT,KAAK,CAAC;EACN,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,OAAO,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC/D,QAAQ,IAAI,OAAO,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC7B,QAAQ,OAAO,CAAC,OAAO,CAAC,CAAC;EACzB,KAAK;EACL,CAAC;AACD,EAAO,SAAS,MAAM,CAAC,OAAO,EAAE,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE;EAClD,IAAI,IAAI,CAAC,OAAO,EAAE;EAClB,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,OAAO,EAAE;EACtD,QAAQ,IAAI,GAAG,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;EACnC,QAAQ,IAAI,OAAO,CAAC,GAAG,CAAC,EAAE;EAC1B,YAAY,OAAO,GAAG,CAAC,MAAM,CAAC,UAAU,EAAE,EAAE,UAAU,EAAE;EACxD,gBAAgB,OAAO,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE,EAAE,UAAU,EAAE,OAAO,CAAC,CAAC;EAChE,aAAa,EAAE,CAAC,CAAC,CAAC;EAClB,SAAS;EACT,aAAa;EACb,YAAY,OAAO,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,EAAE,GAAG,EAAE,OAAO,CAAC,CAAC;EACpD,SAAS;EACT,KAAK,EAAE,IAAI,CAAC,CAAC;EACb,CAAC;;;;;;;;;;;;ECxJM,SAAS,2BAA2B,CAAC,kBAAkB,EAAE,OAAO,EAAE;EACzE,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,IAAI,KAAK,GAAG,kBAAkB,CAAC,OAAO,CAAC,CAAC;EAC5C,IAAI,OAAO,KAAK,KAAK,SAAS,IAAI,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,OAAO,CAAC,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,EAAE,EAAE,IAAI,EAAE,CAAC;EACpF,CAAC;;ECGM,IAAI,OAAO,GAAG,UAAU,CAAC;AAChC,EAAO,SAAS,YAAY,CAAC,IAAI,EAAE;EACnC,IAAI,OAAO,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;EAC1B,CAAC;AACD,EAAO,IAAI,cAAc,GAAG,CAAC,YAAY,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAC;AAC5D,EAAO,IAAI,qCAAqC,GAAG;EACnD,IAAI,GAAG,EAAE,CAAC,MAAM,EAAE,OAAO,EAAE,QAAQ,CAAC;EACpC,IAAI,UAAU,EAAE,CAAC,OAAO,CAAC;EACzB,IAAI,MAAM,EAAE,CAAC,OAAO,CAAC;EACrB,CAAC,CAAC;EACF,IAAI,iBAAiB,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;AACzE,EAAO,SAAS,yBAAyB,CAAC,IAAI,EAAE;EAChD,IAAI,OAAOT,QAAgB,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE,QAAQ,EAAE,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,UAAU,WAAW,EAAE,QAAQ,EAAE,OAAO,EAAE;EAClH,YAAY,IAAI,iBAAiB,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,EAAE;EACzD,gBAAgB,WAAW,CAAC,OAAO,CAAC,GAAG,QAAQ,CAAC;EAChD,aAAa;EACb,iBAAiB;EACjB,gBAAgBQ,IAAQ,CAACC,OAAW,CAAC,mBAAmB,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC;EAC5E,aAAa;EACb,YAAY,OAAO,WAAW,CAAC;EAC/B,SAAS,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC;EAClB,CAAC;AACD,EAAO,SAAS,gBAAgB,CAAC,IAAI,EAAE,MAAM,EAAE;EAC/C,IAAI,IAAI,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;EACvB,IAAI,IAAI,GAAG,yBAAyB,CAAC,IAAI,CAAC,CAAC;EAC3C;EACA,IAAI,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,EAAE,QAAQ,GAAG,IAAI,CAAC,QAAQ,EAAE,SAAS,GAAG,IAAI,CAAC,SAAS,EAAE,EAAE,GAAG,IAAI,CAAC,UAAU,EAAE,SAAS,GAAGJ,MAAc,CAAC,IAAI,EAAE,CAAC,MAAM,EAAE,UAAU,EAAE,WAAW,EAAE,YAAY,CAAC,CAAC,CAAC;EACxL,IAAI,IAAI,UAAU,GAAG,SAAS,CAAC;EAC/B,IAAI,IAAI,QAAQ,CAAC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE;EACrC,QAAQ,UAAU,GAAG,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC;EACvC,KAAK;EACL,IAAI,IAAI,YAAY,CAAC,IAAI,CAAC,EAAE;EAC5B,QAAQ,IAAI,IAAI,CAAC,MAAM,EAAE;EACzB,YAAY,IAAI,IAAI,CAAC,MAAM,KAAK,SAAS,EAAE;EAC3C,gBAAgB,UAAU,GAAG,SAAS,CAAC;EACvC,aAAa;EACb,SAAS;EACT,KAAK;EACL,IAAI,IAAI,MAAM,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC;EACjC,IAAI,IAAI,EAAE,GAAG,SAAS,CAAC,IAAI,EAAE,MAAM,EAAE,UAAU,CAAC,EAAE,SAAS,GAAG,EAAE,CAAC,SAAS,EAAE,wBAAwB,GAAG,EAAE,CAAC,wBAAwB,EAAE,cAAc,GAAG,EAAE,CAAC,cAAc,EAAE,6BAA6B,GAAG,EAAE,CAAC,6BAA6B,CAAC;EACzO,IAAI,AAAG,IAA8C,IAAI,GAAG,6BAA6B,CAAC,IAAI,CAAC,CAAC,yCAAyC,GAAGA,MAAc,CAAC,6BAA6B,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC,CAAC;EAC7M;EACA,IAAI,IAAI,UAAU,GAAG,IAAI,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,2BAA2B,CAAC,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;EAC7F,IAAI,IAAI,0BAA0B,GAAG,EAAE,CAAC;EACxC,IAAI,IAAI,wBAAwB,CAAC,KAAK,EAAE;EACxC,QAAQ,0BAA0B,CAAC,OAAO,CAAC,GAAG,wBAAwB,CAAC,KAAK,CAAC;EAC7E,KAAK;EACL,IAAI,IAAI,wBAAwB,CAAC,IAAI,EAAE;EACvC,QAAQ,0BAA0B,CAAC,MAAM,CAAC,GAAG,wBAAwB,CAAC,IAAI,CAAC;EAC3E,KAAK;EACL,IAAI,OAAOL,QAAgB,CAAC,EAAE,EAAE,SAAS,EAAE,EAAE,SAAS,EAAE,SAAS,EAAE,KAAK,EAAE;EAC1E,YAAY;EACZ,gBAAgB,IAAI,EAAE;EACtB,oBAAoB,IAAI,EAAE,MAAM;EAChC,oBAAoB,KAAK,EAAE,YAAY;EACvC,iBAAiB;EACjB,gBAAgB,QAAQ,EAAEA,QAAgB,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,cAAc,CAAC,GAAGA,QAAgB,CAAC,EAAE,KAAK,EAAE,gBAAgB,GAAG,wBAAwB,CAAC,KAAK,EAAE,IAAI,EAAE,wBAAwB,CAAC,IAAI,EAAE,EAAE,0BAA0B,CAAC,EAAE,EAAE,CAAC,cAAc,GAAG,GAAG,CAAC,GAAG;EACtP,oBAAoB,KAAK,EAAE,YAAY,GAAG,wBAAwB,CAAC,KAAK;EACxE,oBAAoB,IAAI,EAAE,wBAAwB,CAAC,IAAI;EACvD,iBAAiB,EAAE,EAAE,GAAG,yCAAyC,EAAE,2BAA2B,CAAC,MAAM,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;EAC3H,aAAa,EAAE;EACf,gBAAgB,IAAI,EAAE;EACtB,oBAAoB,IAAI,EAAE,MAAM;EAChC,oBAAoB,KAAK,EAAE,YAAY;EACvC,iBAAiB;EACjB,gBAAgB,QAAQ,EAAEA,QAAgB,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,cAAc,CAAC,GAAG;EAC1E,oBAAoB,KAAK,EAAE,YAAY,GAAG,wBAAwB,CAAC,KAAK;EACxE,oBAAoB,IAAI,EAAE,wBAAwB,CAAC,IAAI;EACvD,iBAAiB,EAAE,EAAE,CAAC,cAAc,GAAG,GAAG,CAAC,GAAG;EAC9C,oBAAoB,KAAK,EAAE,gBAAgB,GAAG,wBAAwB,CAAC,KAAK;EAC5E,oBAAoB,IAAI,EAAE,wBAAwB,CAAC,IAAI;EACvD,iBAAiB,EAAE,EAAE,GAAG,yCAAyC,EAAE,2BAA2B,CAAC,MAAM,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;EAC3H,aAAa;EACb,YAAYA,QAAgB,CAAC,EAAE,GAAG,SAAS,GAAG,EAAE,SAAS,EAAE,SAAS,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE;EACtF,oBAAoB,IAAI,EAAE,KAAK;EAC/B,oBAAoB,KAAK,EAAE,KAAK;EAChC,iBAAiB,EAAE,QAAQ,EAAEA,QAAgB,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,cAAc,CAAC,GAAG;EAC7E,oBAAoB,KAAK,EAAE,YAAY,GAAG,wBAAwB,CAAC,KAAK;EACxE,oBAAoB,IAAI,EAAE,wBAAwB,CAAC,IAAI;EACvD,iBAAiB,EAAE,EAAE,CAAC,cAAc,GAAG,GAAG,CAAC,GAAG;EAC9C,oBAAoB,KAAK,EAAE,YAAY,GAAG,wBAAwB,CAAC,KAAK;EACxE,oBAAoB,IAAI,EAAE,wBAAwB,CAAC,IAAI;EACvD,iBAAiB,EAAE,EAAE,GAAG,6BAA6B,GAAG,6BAA6B,CAAC,KAAK,GAAG,EAAE,GAAG,2BAA2B,CAAC,MAAM,CAAC,GAAG,EAAE,OAAO,CAAC,GAAG,UAAU,CAAC,EAAE,CAAC;EACpK,YAAY;EACZ,gBAAgB,IAAI,EAAE;EACtB,oBAAoB,IAAI,EAAE,MAAM;EAChC,oBAAoB,KAAK,EAAE,QAAQ;EACnC,iBAAiB;EACjB,gBAAgB,QAAQ,EAAEA,QAAgB,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,cAAc,CAAC,GAAG;EAC1E,oBAAoB,KAAK,EAAE,UAAU,GAAG,wBAAwB,CAAC,KAAK;EACtE,oBAAoB,IAAI,EAAE,wBAAwB,CAAC,IAAI;EACvD,iBAAiB,EAAE,EAAE,GAAG,yCAAyC,EAAE,2BAA2B,CAAC,MAAM,CAAC,MAAM,EAAE,OAAO,CAAC,EAAE,UAAU,CAAC;EACnI,aAAa;EACb,SAAS,EAAE,CAAC,CAAC;EACb,CAAC;EACD,SAAS,SAAS,CAAC,IAAI,EAAE;EACzB,IAAI,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,EAAE,QAAQ,GAAG,IAAI,CAAC,QAAQ,EAAE,EAAE,GAAG,IAAI,CAAC,UAAU,EAAE,UAAU,GAAGK,MAAc,CAAC,IAAI,EAAE,CAAC,MAAM,EAAE,UAAU,EAAE,YAAY,CAAC,CAAC,CAAC;EAChJ,IAAI,IAAI,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,YAAY,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE;EAC5D;EACA,QAAQ,IAAI,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,YAAY,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE;EAChE;EACA,YAAY,IAAI,QAAQ,CAAC,CAAC,CAAC,SAAS,KAAK,SAAS,IAAI,QAAQ,CAAC,CAAC,CAAC,SAAS,KAAK,OAAO,EAAE;EACxF,gBAAgB,OAAO,UAAU,CAAC;EAClC,aAAa;EACb,iBAAiB,IAAI,QAAQ,CAAC,CAAC,CAAC,SAAS,KAAK,SAAS,IAAI,QAAQ,CAAC,CAAC,CAAC,SAAS,KAAK,OAAO,EAAE;EAC7F,gBAAgB,OAAO,YAAY,CAAC;EACpC,aAAa;EACb,iBAAiB,IAAI,QAAQ,CAAC,CAAC,CAAC,SAAS,KAAK,OAAO,IAAI,QAAQ,CAAC,CAAC,CAAC,SAAS,KAAK,OAAO,EAAE;EAC3F,gBAAgB,MAAM,IAAI,KAAK,CAAC,oCAAoC,CAAC,CAAC;EACtE,aAAa;EACb,iBAAiB;EACjB,gBAAgB,IAAI,YAAY,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,MAAM,EAAE;EACvD,oBAAoB,OAAO,IAAI,CAAC,MAAM,CAAC;EACvC,iBAAiB;EACjB;EACA,gBAAgB,OAAO,UAAU,CAAC;EAClC,aAAa;EACb,SAAS;EACT;EACA,QAAQ,OAAO,YAAY,CAAC;EAC5B,KAAK;EACL,SAAS,IAAI,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,YAAY,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE;EACjE;EACA,QAAQ,OAAO,UAAU,CAAC;EAC1B,KAAK;EACL,SAAS;EACT;EACA,QAAQ,MAAM,IAAI,KAAK,CAAC,2CAA2C,CAAC,CAAC;EACrE,KAAK;EACL,CAAC;EACD,SAAS,gBAAgB,CAAC,IAAI,EAAE,MAAM,EAAE;EACxC,IAAI,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,EAAE,QAAQ,GAAG,IAAI,CAAC,QAAQ,EAAE,EAAE,GAAG,IAAI,CAAC,UAAU,EAAE,UAAU,GAAGA,MAAc,CAAC,IAAI,EAAE,CAAC,MAAM,EAAE,UAAU,EAAE,YAAY,CAAC,CAAC,CAAC;EAChJ,IAAI,IAAI,wBAAwB,CAAC;EACjC,IAAI,IAAI,cAAc,CAAC;EACvB,IAAI,IAAI,MAAM,KAAK,UAAU,EAAE;EAC/B,QAAQ,cAAc,GAAG,GAAG,CAAC;EAC7B,QAAQ,wBAAwB,GAAG,QAAQ,CAAC,CAAC,CAAC;EAC9C,KAAK;EACL,SAAS;EACT,QAAQ,cAAc,GAAG,GAAG,CAAC;EAC7B,QAAQ,wBAAwB,GAAG,QAAQ,CAAC,CAAC,CAAC;EAC9C,KAAK;EACL,IAAI,IAAI,wBAAwB,IAAI,wBAAwB,CAAC,SAAS,EAAE;EACxE,QAAQ,IAAI,SAAS,GAAG,wBAAwB,CAAC,SAAS,EAAE,8BAA8B,GAAGA,MAAc,CAAC,wBAAwB,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC;EACrJ,QAAQ,IAAI,SAAS,KAAK,OAAO,EAAE;EACnC,YAAYG,IAAQ,CAAC,kEAAkE,GAAG,SAAS,CAAC,CAAC;EACrG,SAAS;EACT,QAAQ,wBAAwB,GAAG,8BAA8B,CAAC;EAClE,KAAK;EACL,IAAI,OAAO;EACX,QAAQ,wBAAwB,EAAE,wBAAwB;EAC1D,QAAQ,cAAc,EAAE,cAAc;EACtC,KAAK,CAAC;EACN,CAAC;EACD,SAAS,SAAS,CAAC,IAAI,EAAE,MAAM,EAAE,UAAU,EAAE;EAC7C,IAAI,IAAI,EAAE,GAAG,gBAAgB,CAAC,IAAI,EAAE,MAAM,CAAC,EAAE,wBAAwB,GAAG,EAAE,CAAC,wBAAwB,EAAE,cAAc,GAAG,EAAE,CAAC,cAAc,CAAC;EACxI,IAAI,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;EACjC,IAAI,IAAI,QAAQ,GAAG,UAAU,KAAK,SAAS,CAAC;EAC5C,IAAI,IAAI,SAAS,GAAG;EACpB,QAAQ;EACR,YAAY,EAAE,EAAE,IAAI;EACpB,YAAY,KAAK,EAAE,wBAAwB,CAAC,KAAK;EACjD,YAAY,EAAE,EAAE,YAAY,GAAG,wBAAwB,CAAC,KAAK;EAC7D,SAAS;EACT,QAAQ;EACR,YAAY,EAAE,EAAE,IAAI;EACpB,YAAY,KAAK,EAAE,wBAAwB,CAAC,KAAK;EACjD,YAAY,EAAE,EAAE,YAAY,GAAG,wBAAwB,CAAC,KAAK;EAC7D,SAAS;EACT,QAAQ;EACR,YAAY,EAAE,EAAE,QAAQ;EACxB,YAAY,KAAK,EAAE,wBAAwB,CAAC,KAAK;EACjD,YAAY,EAAE,EAAE,UAAU,GAAG,wBAAwB,CAAC,KAAK;EAC3D,SAAS;EACT,KAAK,CAAC;EACN,IAAI,IAAI,uBAAuB,GAAG,EAAE,CAAC;EACrC,IAAI,SAAS,CAAC,IAAI,CAAC;EACnB,QAAQ,EAAE,EAAE,KAAK;EACjB,QAAQ,KAAK,EAAE,wBAAwB,CAAC,KAAK;EAC7C,QAAQ,EAAE,EAAE,CAAC,QAAQ,GAAG,gBAAgB,GAAG,MAAM,IAAI,wBAAwB,CAAC,KAAK;EACnF,KAAK,CAAC,CAAC;EACP,IAAI,SAAS,CAAC,IAAI,CAAC;EACnB,QAAQ,EAAE,EAAE,KAAK;EACjB,QAAQ,KAAK,EAAE,wBAAwB,CAAC,KAAK;EAC7C,QAAQ,EAAE,EAAE,CAAC,QAAQ,GAAG,gBAAgB,GAAG,MAAM,IAAI,wBAAwB,CAAC,KAAK;EACnF,KAAK,CAAC,CAAC;EACP,IAAI,IAAI,CAAC,QAAQ,EAAE;EACnB,QAAQ,uBAAuB,GAAG;EAClC,YAAY;EACZ,gBAAgB,SAAS,EAAE,kBAAkB,GAAG,wBAAwB,CAAC,KAAK,GAAG,qBAAqB,GAAG,wBAAwB,CAAC,KAAK;EACvI,gBAAgB,EAAE,EAAE,MAAM,GAAG,wBAAwB,CAAC,KAAK;EAC3D,aAAa;EACb,YAAY;EACZ,gBAAgB,SAAS,EAAE,sBAAsB,GAAG,wBAAwB,CAAC,KAAK,GAAG,eAAe,GAAG,wBAAwB,CAAC,KAAK,GAAG,KAAK,GAAG,UAAU,GAAG,cAAc,GAAG,wBAAwB,CAAC,KAAK,GAAG,GAAG;EAClN,gBAAgB,EAAE,EAAE,gBAAgB,GAAG,wBAAwB,CAAC,KAAK;EACrE,aAAa;EACb,YAAY;EACZ,gBAAgB,SAAS,EAAE,sBAAsB,GAAG,wBAAwB,CAAC,KAAK,GAAG,eAAe,GAAG,wBAAwB,CAAC,KAAK,GAAG,KAAK,GAAG,UAAU,GAAG,cAAc,GAAG,wBAAwB,CAAC,KAAK,GAAG,GAAG;EAClN,gBAAgB,EAAE,EAAE,gBAAgB,GAAG,wBAAwB,CAAC,KAAK;EACrE,aAAa;EACb,SAAS,CAAC;EACV,KAAK;EACL,IAAI,IAAI,OAAO,GAAG,EAAE,CAAC;EACrB,IAAI,IAAI,IAAI,GAAG,EAAE,CAAC;EAClB,IAAI,IAAI,SAAS,GAAG,EAAE,CAAC;EACvB,IAAI,IAAI,6BAA6B,GAAG,EAAE,CAAC;EAC3C,IAAI,OAAO,CAAC,QAAQ,EAAE,UAAU,UAAU,EAAE,OAAO,EAAE;EACrD,QAAQ,IAAI,OAAO,KAAK,cAAc,EAAE;EACxC;EACA,YAAY,OAAO;EACnB,SAAS;EACT,QAAQ,IAAI,UAAU,CAAC,UAAU,CAAC,EAAE;EACpC,YAAY,IAAI,UAAU,CAAC,SAAS,IAAI,UAAU,CAAC,SAAS,KAAK,OAAO,EAAE;EAC1E,gBAAgB,SAAS,CAAC,IAAI,CAAC;EAC/B,oBAAoB,EAAE,EAAE,UAAU,CAAC,SAAS;EAC5C,oBAAoB,KAAK,EAAE,UAAU,CAAC,KAAK;EAC3C,oBAAoB,EAAE,EAAE,OAAO,CAAC,UAAU,CAAC;EAC3C,iBAAiB,CAAC,CAAC;EACnB,aAAa;EACb,iBAAiB,IAAI,UAAU,CAAC,SAAS,KAAK,SAAS,EAAE;EACzD,gBAAgB,IAAI,gBAAgB,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;EAC3D;EACA,gBAAgB,IAAI,GAAG,GAAG,UAAU,CAAC,GAAG,CAAC;EACzC,gBAAgB,IAAI,GAAG,EAAE;EACzB,oBAAoB,IAAID,QAAK,GAAG,UAAU,CAAC,KAAK,CAAC;EACjD,oBAAoB,IAAI,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAEA,QAAK,EAAE,EAAE,EAAE,gBAAgB,EAAE,CAAC,CAAC;EAChF,iBAAiB;EACjB,qBAAqB,IAAI,UAAU,CAAC,QAAQ,EAAE;EAC9C,oBAAoB,IAAI,QAAQ,GAAG,UAAU,CAAC,QAAQ,EAAEA,QAAK,GAAG,UAAU,CAAC,KAAK,CAAC;EACjF,oBAAoB,SAAS,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAE,QAAQ,EAAE,KAAK,EAAEA,QAAK,EAAE,EAAE,EAAE,gBAAgB,EAAE,CAAC,CAAC;EAC/F,iBAAiB;EACjB,gBAAgB,OAAO,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;EAC/C,aAAa;EACb;EACA,YAAY,6BAA6B,CAAC,OAAO,CAAC,GAAG;EACrD,gBAAgB,KAAK,EAAE,OAAO,CAAC,UAAU,CAAC;EAC1C,gBAAgB,IAAI,EAAE,UAAU,CAAC,IAAI;EACrC,aAAa,CAAC;EACd,SAAS;EACT,aAAa;EACb;EACA,YAAY,6BAA6B,CAAC,OAAO,CAAC,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;EACvE,SAAS;EACT,KAAK,CAAC,CAAC;EACP,IAAI,OAAO;EACX,QAAQ,SAAS,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,EAAE,SAAS,EAAE,CAAC,EAAE,SAAS,EAAE,SAAS,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,uBAAuB,CAAC;EACpH,QAAQ,wBAAwB,EAAE,wBAAwB;EAC1D,QAAQ,cAAc,EAAE,cAAc;EACtC,QAAQ,6BAA6B,EAAE,6BAA6B;EACpE,KAAK,CAAC;EACN,CAAC;;EChQM,IAAI,QAAQ,GAAG,WAAW,CAAC;AAClC,EAAO,SAAS,iBAAiB,CAAC,IAAI,EAAE;EACxC;EACA,IAAI,IAAI,EAAE,GAAG,IAAI,CAAC,IAAI,EAAE,IAAI,GAAG,IAAI,CAAC,SAAS,EAAE,EAAE,GAAG,IAAI,CAAC,UAAU,EAAE,QAAQ,GAAG,IAAI,CAAC,QAAQ,EAAE,SAAS,GAAGF,MAAc,CAAC,IAAI,EAAE,CAAC,MAAM,EAAE,WAAW,EAAE,YAAY,EAAE,UAAU,CAAC,CAAC,CAAC;EACjL,IAAI,IAAI,EAAE,GAAG,QAAQ,CAAC,IAAI,EAAE,mBAAmB,GAAGA,MAAc,CAAC,QAAQ,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;EACrF,IAAI,IAAI,GAAG,GAAG,QAAQ,CAAC,EAAE,EAAE,GAAG,GAAG,QAAQ,CAAC,EAAE,EAAE,mBAAmB,GAAGA,MAAc,CAAC,QAAQ,EAAE,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC;EAC3G,IAAI,AAAG,IAAyD,wBAAwB,GAAGA,MAAc,CAAC,mBAAmB,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;EAC3I,IAAI,IAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE;EACtC,QAAQ,MAAM,IAAI,KAAK,CAAC,2BAA2B,CAAC,CAAC;EACrD,KAAK;EACL,IAAI,OAAOL,QAAgB,CAAC,EAAE,EAAE,SAAS,EAAE,EAAE,KAAK,EAAE;EACpD,YAAY;EACZ,gBAAgB,IAAI,EAAE,MAAM;EAC5B,gBAAgB,QAAQ,EAAE,mBAAmB;EAC7C,aAAa,EAAE;EACf,gBAAgB,IAAI,EAAE,MAAM;EAC5B,gBAAgB,QAAQ,EAAE,mBAAmB;EAC7C,aAAa,EAAE;EACf,gBAAgB,IAAI,EAAE,MAAM;EAC5B,gBAAgB,QAAQ,EAAE,QAAQ,CAAC,EAAE,GAAGA,QAAgB,CAAC,EAAE,CAAC,EAAE,QAAQ,CAAC,EAAE,EAAE,CAAC,EAAE,QAAQ,CAAC,CAAC,EAAE,EAAE,wBAAwB,CAAC,GAAGA,QAAgB,CAAC,EAAE,CAAC,EAAE,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,QAAQ,CAAC,EAAE,EAAE,EAAE,wBAAwB,CAAC;EACrM,aAAa;EACb,SAAS,EAAE,CAAC,CAAC;EACb,CAAC;;ECbD;EACA;EACA;EACA,IAAI,kBAAkB,GAAG,EAAE,CAAC;AAC5B,EAAO,SAAS,GAAG,CAAC,IAAI,EAAE,UAAU,EAAE;EACtC,IAAI,kBAAkB,CAAC,IAAI,CAAC,GAAG,UAAU,CAAC;EAC1C,CAAC;AACD,EAAO,SAAS,MAAM,CAAC,IAAI,EAAE;EAC7B,IAAI,OAAO,kBAAkB,CAAC,IAAI,CAAC,CAAC;EACpC,CAAC;AACD,EAAO,IAAI,qBAAqB,GAAGU,cAAsB,CAAC;AAC1D,EAAO,IAAI,qDAAqD,GAAGV,QAAgB,CAAC,EAAE,EAAE,qCAAqC,CAAC,CAAC;EAC/H,GAAG,CAAC,OAAO,EAAE,gBAAgB,CAAC,CAAC;EAC/B,GAAG,CAAC,QAAQ,EAAE,iBAAiB,CAAC,CAAC;EACjC;EACA;EACA;AACA,EAAO,SAASW,WAAS;EACzB;EACA,IAAI,EAAE,MAAM,EAAE;EACd,IAAI,IAAI,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;EACjE,IAAI,IAAI,UAAU,GAAG,kBAAkB,CAAC,IAAI,CAAC,CAAC;EAC9C,IAAI,IAAI,UAAU,EAAE;EACpB,QAAQ,OAAO,UAAU,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;EACxC,KAAK;EACL,IAAI,MAAM,IAAI,KAAK,CAAC,sBAAsB,GAAG,IAAI,GAAG,IAAI,CAAC,CAAC;EAC1D,CAAC;;;;;;;;;;ECpCM,IAAI,oBAAoB,GAAG,CAAC,iBAAiB,CAAC,CAAC;;ECE/C,IAAI,mBAAmB,GAAG,EAAE,CAAC;EACpC,IAAI,4BAA4B,GAAG;EACnC,IAAI,YAAY,EAAE,CAAC;EACnB,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,SAAS,EAAE,CAAC;EAChB,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,MAAM,EAAE,CAAC;EACb,CAAC,CAAC;EACF,IAAI,wBAAwB,GAAGX,QAAgB,CAAC,EAAE,EAAE,4BAA4B,EAAE;EAClF;EACA,IAAI,OAAO,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC;EACrD;EACA,IAAI,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC;AACjB,EAAO,IAAI,iBAAiB,GAAG,QAAQ,CAAC,4BAA4B,CAAC,CAAC;AACtE,EAAO,IAAI,oBAAoB,GAAG,QAAQ,CAAC,wBAAwB,CAAC,CAAC;;;;;;;;ECf9D,IAAI,SAAS,CAAC;EACrB,CAAC,UAAU,SAAS,EAAE;EACtB;EACA,IAAI,SAAS,CAAC,MAAM,GAAG,QAAQ,CAAC;EAChC,IAAI,SAAS,CAAC,UAAU,GAAG,YAAY,CAAC;EACxC,IAAI,SAAS,CAAC,GAAG,GAAG,KAAK,CAAC;EAC1B,IAAI,SAAS,CAAC,GAAG,GAAG,KAAK,CAAC;EAC1B,IAAI,SAAS,CAAC,IAAI,GAAG,MAAM,CAAC;EAC5B;EACA,IAAI,SAAS,CAAC,IAAI,GAAG,MAAM,CAAC;EAC5B,IAAI,SAAS,CAAC,GAAG,GAAG,KAAK,CAAC;EAC1B;EACA,IAAI,SAAS,CAAC,UAAU,GAAG,YAAY,CAAC;EACxC;EACA,IAAI,SAAS,CAAC,QAAQ,GAAG,UAAU,CAAC;EACpC,IAAI,SAAS,CAAC,QAAQ,GAAG,UAAU,CAAC;EACpC,IAAI,SAAS,CAAC,SAAS,GAAG,WAAW,CAAC;EACtC,IAAI,SAAS,CAAC,OAAO,GAAG,SAAS,CAAC;EAClC,IAAI,SAAS,CAAC,WAAW,GAAG,aAAa,CAAC;EAC1C,IAAI,SAAS,CAAC,KAAK,GAAG,OAAO,CAAC;EAC9B,IAAI,SAAS,CAAC,IAAI,GAAG,MAAM,CAAC;EAC5B,CAAC,EAAE,SAAS,KAAK,SAAS,GAAG,EAAE,CAAC,CAAC,CAAC;EAClC;EACA;EACA;EACA;EACA,IAAI,oBAAoB,GAAG;EAC3B,IAAI,MAAM,EAAE,SAAS;EACrB,IAAI,GAAG,EAAE,SAAS;EAClB,IAAI,GAAG,EAAE,SAAS;EAClB,IAAI,IAAI,EAAE,SAAS;EACnB,IAAI,YAAY,EAAE,YAAY;EAC9B,IAAI,IAAI,EAAE,MAAM;EAChB,IAAI,GAAG,EAAE,MAAM;EACf,IAAI,UAAU,EAAE,YAAY;EAC5B,IAAI,OAAO,EAAE,SAAS;EACtB,IAAI,aAAa,EAAE,aAAa;EAChC,IAAI,KAAK,EAAE,kBAAkB;EAC7B,IAAI,IAAI,EAAE,kBAAkB;EAC5B,CAAC,CAAC;AACF,EAAO,IAAI,WAAW,GAAG,IAAI,CAAC,oBAAoB,CAAC,CAAC;EACpD;EACA;EACA;AACA,EAAO,SAAS,eAAe,CAAC,UAAU,EAAE,UAAU,EAAE;EACxD,IAAI,IAAI,cAAc,GAAG,oBAAoB,CAAC,UAAU,CAAC,CAAC;EAC1D,IAAI,IAAI,cAAc,GAAG,oBAAoB,CAAC,UAAU,CAAC,CAAC;EAC1D,IAAI,OAAO,cAAc,KAAK,cAAc;EAC5C,SAAS,cAAc,KAAK,kBAAkB,IAAI,cAAc,KAAK,MAAM,CAAC;EAC5E,SAAS,cAAc,KAAK,kBAAkB,IAAI,cAAc,KAAK,MAAM,CAAC,CAAC;EAC7E,CAAC;EACD;EACA;EACA;EACA,IAAI,sBAAsB,GAAG;EAC7B;EACA,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,GAAG,EAAE,CAAC;EACV,IAAI,GAAG,EAAE,CAAC;EACV,IAAI,IAAI,EAAE,CAAC;EACX;EACA,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,GAAG,EAAE,CAAC;EACV;EACA,IAAI,KAAK,EAAE,EAAE;EACb,IAAI,IAAI,EAAE,EAAE;EACZ;EACA,IAAI,YAAY,EAAE,CAAC;EACnB,IAAI,UAAU,EAAE,CAAC;EACjB,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,aAAa,EAAE,CAAC;EACpB,CAAC,CAAC;EACF;EACA;EACA;AACA,EAAO,SAAS,mBAAmB,CAAC,SAAS,EAAE;EAC/C,IAAI,OAAO,sBAAsB,CAAC,SAAS,CAAC,CAAC;EAC7C,CAAC;AACD,EAAO,IAAI,+BAA+B,GAAG,CAAC,QAAQ,EAAE,YAAY,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;EAC3G,IAAI,8BAA8B,GAAG,KAAK,CAAC,+BAA+B,CAAC,CAAC;AAC5E,EAAO,IAAI,wBAAwB,GAAG,+BAA+B,CAAC,MAAM,CAAC,CAAC,YAAY,mDAAmD,CAAC,CAAC;EAC/I,IAAI,uBAAuB,GAAG,KAAK,CAAC,wBAAwB,CAAC,CAAC;AAC9D,EAAO,IAAI,sBAAsB,GAAG,CAAC,SAAS,EAAE,aAAa,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;EAChF,IAAI,qBAAqB,GAAG,KAAK,CAAC,sBAAsB,CAAC,CAAC;EAC1D,IAAI,gBAAgB,GAAG,KAAK,CAAC,CAAC,YAAY,EAAE,aAAa,CAAC,CAAC,CAAC;AAC5D,EAAO,IAAI,gBAAgB,GAAG,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;AAC9C,EAAO,SAAS,iBAAiB,CAAC,IAAI,EAAE;EACxC,IAAI,OAAO,IAAI,IAAI,qBAAqB,CAAC;EACzC,CAAC;AACD,EAAO,SAAS,UAAU,CAAC,IAAI,EAAE;EACjC,IAAI,OAAO,IAAI,IAAI,gBAAgB,CAAC;EACpC,CAAC;AACD,EAAO,SAAS,mBAAmB,CAAC,IAAI,EAAE;EAC1C,IAAI,OAAO,IAAI,IAAI,uBAAuB,CAAC;EAC3C,CAAC;AACD,EAAO,SAAS,wBAAwB,CAAC,IAAI,EAAE;EAC/C,IAAI,OAAO,IAAI,IAAI,8BAA8B,CAAC;EAClD,CAAC;AACD,EAAO,IAAI,kBAAkB,GAAG;EAChC,IAAI,cAAc,EAAE,EAAE;EACtB,IAAI,SAAS,EAAE,EAAE;EACjB,IAAI,YAAY,EAAE,GAAG;EACrB,IAAI,gBAAgB,EAAE,GAAG;EACzB,IAAI,YAAY,EAAE,EAAE;EACpB,IAAI,WAAW,EAAE,CAAC;EAClB,IAAI,WAAW,EAAE,CAAC;EAClB,IAAI,WAAW,EAAE,EAAE;EACnB,IAAI,UAAU,EAAE,GAAG;EACnB,IAAI,UAAU,EAAE,GAAG;EACnB;EACA,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,cAAc,EAAE,CAAC;EACrB,IAAI,cAAc,EAAE,CAAC;EACrB,CAAC,CAAC;AACF,EAAO,SAAS,gBAAgB,CAAC,MAAM,EAAE;EACzC,IAAI,OAAO,MAAM,IAAI,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;EACtC,CAAC;AACD,EAAO,SAAS,iBAAiB,CAAC,MAAM,EAAE;EAC1C,IAAI,OAAO,MAAM,IAAI,MAAM,CAAC,WAAW,CAAC,CAAC;EACzC,CAAC;EACD,IAAI,oBAAoB,GAAG;EAC3B,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,SAAS,EAAE,CAAC;EAChB,IAAI,MAAM,EAAE,CAAC;EACb;EACA,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,KAAK,EAAE,CAAC;EACZ;EACA,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,IAAI,EAAE,CAAC;EACX;EACA,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,QAAQ,EAAE,CAAC;EACf,IAAI,WAAW,EAAE,CAAC;EAClB,IAAI,IAAI,EAAE,CAAC;EACX;EACA,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,YAAY,EAAE,CAAC;EACnB,IAAI,YAAY,EAAE,CAAC;EACnB,CAAC,CAAC;AACF,EAAO,IAAI,gBAAgB,GAAG,QAAQ,CAAC,oBAAoB,CAAC,CAAC;AAC7D,AAAG,MAA+L,+CAA+C,GAAGK,MAAc,CAAC,oBAAoB,EAAE,CAAC,MAAM,EAAE,QAAQ,EAAE,OAAO,EAAE,WAAW,EAAE,QAAQ,CAAC,CAAC,CAAC;AAC7U,EAAO,IAAI,2CAA2C,GAAG,QAAQ,CAAC,+CAA+C,CAAC,CAAC;AACnH,EAAO,IAAI,gBAAgB,GAAG,sBAAsB,EAAE,CAAC;AACvD,EAAO,SAAS,wBAAwB,CAAC,SAAS,EAAE,QAAQ,EAAE;EAC9D,IAAI,QAAQ,QAAQ;EACpB,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,QAAQ,CAAC;EACtB,QAAQ,KAAK,SAAS,CAAC;EACvB,QAAQ,KAAK,OAAO;EACpB,YAAY,OAAO,IAAI,CAAC;EACxB,QAAQ,KAAK,QAAQ;EACrB,YAAY,OAAO,QAAQ,CAAC,CAAC,YAAY,EAAE,SAAS,EAAE,aAAa,EAAE,UAAU,EAAE,UAAU,CAAC,EAAE,SAAS,CAAC,CAAC;EACzG,QAAQ,KAAK,aAAa;EAC1B;EACA,YAAY,OAAO,QAAQ,CAAC,CAAC,QAAQ,EAAE,YAAY,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,CAAC,EAAE,SAAS,CAAC,CAAC;EACtG,QAAQ,KAAK,OAAO;EACpB,YAAY,OAAO,wBAAwB,CAAC,SAAS,CAAC,IAAI,SAAS,KAAK,MAAM,IAAI,SAAS,KAAK,OAAO,CAAC;EACxG,QAAQ,KAAK,SAAS;EACtB,YAAY,OAAO,wBAAwB,CAAC,SAAS,CAAC,IAAI,QAAQ,CAAC,CAAC,OAAO,EAAE,MAAM,CAAC,EAAE,SAAS,CAAC,CAAC;EACjG,QAAQ,KAAK,cAAc,CAAC;EAC5B,QAAQ,KAAK,WAAW;EACxB,YAAY,OAAO,QAAQ,CAAC,CAAC,OAAO,EAAE,MAAM,CAAC,EAAE,SAAS,CAAC,CAAC;EAC1D,QAAQ,KAAK,cAAc;EAC3B,YAAY,OAAO,SAAS,KAAK,MAAM,CAAC;EACxC,QAAQ,KAAK,OAAO;EACpB,YAAY,OAAO,wBAAwB,CAAC,SAAS,CAAC,IAAI,SAAS,KAAK,YAAY,CAAC;EACrF,QAAQ,KAAK,MAAM;EACnB,YAAY,OAAO,wBAAwB,CAAC,SAAS,CAAC,IAAI,SAAS,KAAK,YAAY,IAAI,SAAS,KAAK,UAAU,CAAC;EACjH,QAAQ,KAAK,UAAU;EACvB,YAAY,OAAO,SAAS,KAAK,KAAK,CAAC;EACvC,QAAQ,KAAK,MAAM;EACnB,YAAY,OAAO,SAAS,KAAK,KAAK,CAAC;EACvC,QAAQ,KAAK,MAAM;EACnB,YAAY,OAAO,mBAAmB,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC;EAC/D,gBAAgB,KAAK;EACrB,gBAAgB,MAAM,EAAE,KAAK;EAC7B,gBAAgB,YAAY;EAC5B,gBAAgB,WAAW;EAC3B,gBAAgB,UAAU;EAC1B,aAAa,EAAE,SAAS,CAAC,CAAC;EAC1B,KAAK;EACL;EACA,IAAI,MAAM,IAAI,KAAK,CAAC,yBAAyB,GAAG,QAAQ,GAAG,GAAG,CAAC,CAAC;EAChE,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,mCAAmC,CAAC,OAAO,EAAE,QAAQ,EAAE;EACvE,IAAI,QAAQ,QAAQ;EACpB,QAAQ,KAAK,aAAa,CAAC;EAC3B,QAAQ,KAAK,QAAQ;EACrB,YAAY,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE;EAC1C,gBAAgB,OAAOI,OAAW,CAAC,kCAAkC,CAAC,OAAO,CAAC,CAAC;EAC/E,aAAa;EACb,YAAY,OAAO,SAAS,CAAC;EAC7B,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,QAAQ,CAAC;EACtB,QAAQ,KAAK,OAAO,CAAC;EACrB,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,UAAU,CAAC;EACxB,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,SAAS,CAAC;EACvB,QAAQ,KAAK,cAAc,CAAC;EAC5B,QAAQ,KAAK,cAAc,CAAC;EAC5B,QAAQ,KAAK,WAAW,CAAC;EACzB,QAAQ,KAAK,SAAS,CAAC;EACvB,QAAQ,KAAK,OAAO,CAAC;EACrB,QAAQ,KAAK,OAAO,CAAC;EACrB,QAAQ,KAAK,MAAM;EACnB,YAAY,OAAO,SAAS,CAAC;EAC7B,KAAK;EACL;EACA,IAAI,MAAM,IAAI,KAAK,CAAC,2BAA2B,GAAG,QAAQ,GAAG,KAAK,CAAC,CAAC;EACpE,CAAC;AACD,EAAO,SAAS,wBAAwB,CAAC,aAAa,EAAE,YAAY,EAAE,GAAG,EAAE;EAC3E,IAAI,IAAI,QAAQ,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,EAAE,YAAY,CAAC,EAAE;EAC9D,QAAQ,OAAO,aAAa,KAAK,SAAS,IAAI,iBAAiB,CAAC,aAAa,CAAC,CAAC;EAC/E,KAAK;EACL,SAAS,IAAI,YAAY,KAAK,IAAI,CAAC,QAAQ,EAAE;EAC7C,QAAQ,OAAO,QAAQ,CAAC,CAAC,SAAS,CAAC,IAAI,EAAE,SAAS,CAAC,GAAG,EAAE,SAAS,CAAC,UAAU,EAAE,SAAS,CAAC,EAAE,aAAa,CAAC,CAAC;EACzG,KAAK;EACL,SAAS,IAAI,YAAY,KAAK,IAAI,CAAC,YAAY,EAAE;EACjD,QAAQ,IAAI,GAAG,EAAE;EACjB,YAAY,OAAO,QAAQ,CAAC,CAAC,SAAS,CAAC,UAAU,EAAE,SAAS,CAAC,WAAW,EAAE,SAAS,CAAC,MAAM,CAAC,EAAE,aAAa,CAAC,CAAC;EAC5G,SAAS;EACT,QAAQ,OAAO,QAAQ,CAAC,CAAC,SAAS,CAAC,GAAG,EAAE,SAAS,CAAC,GAAG,EAAE,SAAS,CAAC,IAAI,EAAE,SAAS,CAAC,QAAQ,EAAE,SAAS,CAAC,QAAQ,EAAE,SAAS,CAAC,MAAM,EAAE,SAAS,CAAC,UAAU,EAAE,SAAS,CAAC,EAAE,aAAa,CAAC,CAAC;EAClL,KAAK;EACL,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;AACD,EAAO,SAAS,uBAAuB,CAAC,OAAO,EAAE,SAAS,EAAE;EAC5D,IAAI,QAAQ,OAAO;EACnB,QAAQ,KAAK,OAAO,CAAC,CAAC,CAAC;EACvB,QAAQ,KAAK,OAAO,CAAC,CAAC,CAAC;EACvB,QAAQ,KAAK,OAAO,CAAC,IAAI,CAAC;EAC1B,QAAQ,KAAK,OAAO,CAAC,OAAO;EAC5B;EACA;EACA,YAAY,OAAO,wBAAwB,CAAC,SAAS,CAAC,IAAI,QAAQ,CAAC,CAAC,MAAM,EAAE,OAAO,CAAC,EAAE,SAAS,CAAC,CAAC;EACjG,QAAQ,KAAK,OAAO,CAAC,KAAK,CAAC;EAC3B,QAAQ,KAAK,OAAO,CAAC,IAAI,CAAC;EAC1B,QAAQ,KAAK,OAAO,CAAC,MAAM;EAC3B,YAAY,OAAO,SAAS,KAAK,MAAM,CAAC;EACxC,QAAQ,KAAK,OAAO,CAAC,KAAK;EAC1B,YAAY,OAAO,SAAS,KAAK,SAAS,CAAC;EAC3C,KAAK;EACL;EACA,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;AACD,EAAO,SAAS,qBAAqB,CAAC,OAAO,EAAE,YAAY,EAAE,GAAG,EAAE;EAClE,IAAI,OAAO,gBAAgB,CAAC,yBAAyB,CAAC,OAAO,EAAE,YAAY,EAAE,GAAG,CAAC,CAAC,CAAC;EACnF,CAAC;EACD;EACA,SAAS,sBAAsB,GAAG;EAClC,IAAI,IAAI,KAAK,GAAG,EAAE,CAAC;EACnB,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,UAAU,GAAG,QAAQ,EAAE,EAAE,GAAG,UAAU,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC1E,QAAQ,IAAI,OAAO,GAAG,UAAU,CAAC,EAAE,CAAC,CAAC;EACrC,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACtE,YAAY,IAAI,YAAY,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EACtC,YAAY,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,aAAa,GAAG,WAAW,EAAE,EAAE,GAAG,aAAa,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC3F,gBAAgB,IAAI,SAAS,GAAG,aAAa,CAAC,EAAE,CAAC,CAAC;EAClD,gBAAgB,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC,KAAK,EAAE,IAAI,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC3E,oBAAoB,IAAI,GAAG,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EACrC,oBAAoB,IAAIN,MAAG,GAAG,yBAAyB,CAAC,OAAO,EAAE,YAAY,EAAE,GAAG,CAAC,CAAC;EACpF,oBAAoB,IAAI,uBAAuB,CAAC,OAAO,EAAE,SAAS,CAAC,IAAI,wBAAwB,CAAC,SAAS,EAAE,YAAY,EAAE,GAAG,CAAC,EAAE;EAC/H,wBAAwB,KAAK,CAACA,MAAG,CAAC,GAAG,KAAK,CAACA,MAAG,CAAC,IAAI,EAAE,CAAC;EACtD,wBAAwB,KAAK,CAACA,MAAG,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;EACnD,qBAAqB;EACrB,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,KAAK;EACL,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;EACD,SAAS,yBAAyB,CAAC,OAAO,EAAE,YAAY,EAAE,GAAG,EAAE;EAC/D,IAAI,IAAIA,MAAG,GAAG,OAAO,GAAG,GAAG,GAAG,YAAY,CAAC;EAC3C,IAAI,OAAO,GAAG,GAAGA,MAAG,GAAG,MAAM,GAAGA,MAAG,CAAC;EACpC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;EC7RM,IAAI,YAAY,GAAG,SAAS,CAAC;AACpC,EAAO,IAAI,aAAa,GAAG;EAC3B,IAAI,MAAM,EAAE;EACZ,QAAQ,EAAE,EAAE,OAAO;EACnB,QAAQ,MAAM,EAAE,CAAC,YAAY,CAAC;EAC9B,QAAQ,OAAO,EAAE,QAAQ;EACzB,QAAQ,KAAK,EAAE,KAAK;EACpB,KAAK;EACL,IAAI,KAAK,EAAE;EACX,QAAQ,EAAE,EAAE,OAAO;EACnB,QAAQ,MAAM,EAAE,CAAC,YAAY,CAAC;EAC9B,QAAQ,MAAM,EAAE,gBAAgB;EAChC,QAAQ,OAAO,EAAE,QAAQ;EACzB,QAAQ,KAAK,EAAE,KAAK;EACpB,KAAK;EACL,IAAI,QAAQ,EAAE;EACd,QAAQ,EAAE,EAAE,iDAAiD;EAC7D,QAAQ,SAAS,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC;EAC7B,QAAQ,SAAS,EAAE,iDAAiD;EACpE,QAAQ,IAAI,EAAE,QAAQ;EACtB,QAAQ,IAAI,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,WAAW,EAAE,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE;EACnE,QAAQ,OAAO,EAAE,QAAQ;EACzB,KAAK;EACL,CAAC,CAAC;;ECtBK,SAAS,kBAAkB,CAAC,WAAW,EAAE;EAChD,IAAI;EACJ;EACA,IAAI,MAAM,GAAG,WAAW,CAAC,MAAM,EAAE,MAAM,GAAG,WAAW,CAAC,MAAM,EAAE,MAAM,GAAG,WAAW,CAAC,MAAM;EACzF;EACA,IAAI,KAAK,GAAG,WAAW,CAAC,KAAK;EAC7B;EACA,IAAI,eAAe,GAAGE,MAAc,CAAC,WAAW,EAAE,CAAC,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC;EAC3F,IAAI,IAAI,IAAI,GAAGL,QAAgB,CAAC,EAAE,EAAE,eAAe,EAAE,KAAK,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC,CAAC;EACnF,IAAI,IAAI,OAAO,GAAGA,QAAgB,CAAC,EAAE,EAAE,MAAM,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,EAAE,EAAE,MAAM,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,EAAE,EAAE,MAAM,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;EAC7I,IAAI,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC;EAC5C,CAAC;;ECAM,IAAI,iBAAiB,GAAG;EAC/B,IAAI,KAAK,EAAE,GAAG;EACd,IAAI,MAAM,EAAE,GAAG;EACf,CAAC,CAAC;AACF,EAAO,IAAIY,eAAa,GAAG;EAC3B,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,UAAU,EAAE,EAAE;EAClB,IAAI,UAAU,EAAE,mBAAmB;EACnC,IAAI,aAAa,EAAE,QAAQ;EAC3B,IAAI,IAAI,EAAE,iBAAiB;EAC3B,IAAI,IAAI,EAAEC,iBAAsB;EAChC,IAAI,IAAI,EAAE,EAAE;EACZ,IAAI,GAAG,EAAEC,gBAAqB;EAC9B,IAAI,MAAM,EAAE,EAAE;EACd,IAAI,QAAQ,EAAE,EAAE;EAChB,IAAI,IAAI,EAAE,EAAE;EACZ,IAAI,KAAK,EAAE,EAAE;EACb,IAAI,IAAI,EAAE,EAAE;EACZ,IAAI,IAAI,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE;EAC5B,IAAI,MAAM,EAAE,EAAE;EACd,IAAI,IAAI,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE;EAC5B,IAAI,IAAI,EAAEC,iBAAsB;EAChC,IAAI,KAAK,EAAE,EAAE;EACb,IAAI,GAAG,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE;EAClC,IAAI,UAAU,EAAE,EAAE;EAClB,IAAI,MAAM,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE;EAC9B,IAAI,KAAK,EAAE,kBAAkB;EAC7B,IAAI,UAAU,EAAE,EAAE;EAClB,IAAI,IAAI,EAAE,EAAE;EACZ,IAAI,KAAK,EAAE,EAAE;EACb,IAAI,KAAK,EAAE,EAAE,SAAS,EAAE,EAAE,EAAE;EAC5B,IAAI,QAAQ,EAAE,EAAE;EAChB,IAAI,SAAS,EAAE,EAAE;EACjB,IAAI,OAAO,EAAE,EAAE;EACf,IAAI,UAAU,EAAE,EAAE;EAClB,IAAI,QAAQ,EAAE,EAAE;EAChB,IAAI,MAAM,EAAE,mBAAmB;EAC/B,IAAI,SAAS,EAAEC,aAAsB;EACrC,IAAI,KAAK,EAAE,EAAE;EACb,IAAI,KAAK,EAAE,EAAE;EACb,CAAC,CAAC;AACF,EAAO,SAAS,UAAU,CAAC,MAAM,EAAE;EACnC,IAAI,OAAO,SAAS,CAAC,SAAS,CAACJ,eAAa,CAAC,EAAE,MAAM,CAAC,CAAC;EACvD,CAAC;EACD,IAAI,WAAW,GAAG,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,eAAe,EAAE,qBAAqB,CAAC,CAAC;EAC1E,IAAI,yBAAyB,GAAG;EAChC,IAAI,SAAS,EAAE,cAAc,EAAE,YAAY,EAAE,YAAY;EACzD,IAAI,OAAO,EAAE,OAAO,EAAE,WAAW,EAAE,eAAe;EAClD,IAAI,SAAS;EACb,CAAC,CAAC;EACF,IAAI,+CAA+C,GAAGZ,QAAgB,CAAC,EAAE,IAAI,EAAE,CAAC,OAAO,EAAE,QAAQ,CAAC,EAAE,EAAE,2CAA2C,EAAE,qDAAqD,CAAC,CAAC;AAC1M,EAAO,SAAS,sBAAsB,CAAC,MAAM,EAAE;EAC/C,IAAI,MAAM,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC;EAC/B,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,2BAA2B,GAAG,yBAAyB,EAAE,EAAE,GAAG,2BAA2B,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC7H,QAAQ,IAAI,IAAI,GAAG,2BAA2B,CAAC,EAAE,CAAC,CAAC;EACnD,QAAQ,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;EAC5B,KAAK;EACL;EACA,IAAI,IAAI,MAAM,CAAC,IAAI,EAAE;EACrB,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,sBAAsB,GAAG,oBAAoB,EAAE,EAAE,GAAG,sBAAsB,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAClH,YAAY,IAAI,IAAI,GAAG,sBAAsB,CAAC,EAAE,CAAC,CAAC;EAClD,YAAY,OAAO,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACrC,SAAS;EACT,KAAK;EACL,IAAI,IAAI,MAAM,CAAC,MAAM,EAAE;EACvB,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,sBAAsB,GAAG,oBAAoB,EAAE,EAAE,GAAG,sBAAsB,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAClH,YAAY,IAAI,IAAI,GAAG,sBAAsB,CAAC,EAAE,CAAC,CAAC;EAClD,YAAY,OAAO,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;EACvC,SAAS;EACT,KAAK;EACL;EACA,IAAI,IAAI,MAAM,CAAC,IAAI,EAAE;EACrB,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,gCAAgC,GAAG,8BAA8B,EAAE,EAAE,GAAG,gCAAgC,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAChJ,YAAY,IAAI,IAAI,GAAG,gCAAgC,CAAC,EAAE,CAAC,CAAC;EAC5D,YAAY,OAAO,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACrC,SAAS;EACT,KAAK;EACL,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,aAAa,GAAG,WAAW,EAAE,EAAE,GAAG,aAAa,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACnF,QAAQ,IAAI,QAAQ,GAAG,aAAa,CAAC,EAAE,CAAC,CAAC;EACzC;EACA,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,gCAAgC,GAAG,8BAA8B,EAAE,EAAE,GAAG,gCAAgC,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAChJ,YAAY,IAAI,IAAI,GAAG,gCAAgC,CAAC,EAAE,CAAC,CAAC;EAC5D,YAAY,OAAO,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,CAAC;EAC1C,SAAS;EACT;EACA,QAAQ,IAAI,yBAAyB,GAAG,+CAA+C,CAAC,QAAQ,CAAC,CAAC;EAClG,QAAQ,IAAI,yBAAyB,EAAE;EACvC,YAAY,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,2BAA2B,GAAG,yBAAyB,EAAE,EAAE,GAAG,2BAA2B,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACrI,gBAAgB,IAAI,IAAI,GAAG,2BAA2B,CAAC,EAAE,CAAC,CAAC;EAC3D,gBAAgB,OAAO,MAAM,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,CAAC;EAC9C,aAAa;EACb,SAAS;EACT;EACA;EACA;EACA,QAAQ,cAAc,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;EACzC,KAAK;EACL;EACA;EACA,IAAI,cAAc,CAAC,MAAM,EAAE,OAAO,EAAE,aAAa,CAAC,CAAC;EACnD;EACA,IAAI,KAAK,IAAI,IAAI,IAAI,MAAM,EAAE;EAC7B,QAAQ,IAAI,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE;EACvE,YAAY,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;EAChC,SAAS;EACT,KAAK;EACL,IAAI,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,GAAG,CAAC,GAAG,MAAM,GAAG,SAAS,CAAC;EACxD,CAAC;EACD,SAAS,cAAc,CAAC,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE;EAC9C,IAAI,IAAI,UAAU,GAAG,IAAI,KAAK,OAAO,GAAG,kBAAkB,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;EAC7F,IAAI,IAAI,IAAI,KAAK,MAAM,EAAE;EACzB,QAAQ,MAAM,GAAG,MAAM,CAAC;EACxB,KAAK;EACL,IAAI,IAAI,KAAK,GAAGA,QAAgB,CAAC,EAAE,EAAE,UAAU,EAAE,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;EACrE;EACA,IAAI,IAAI,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;EAChC,QAAQ,MAAM,CAAC,KAAK,CAAC,MAAM,IAAI,IAAI,CAAC,GAAG,KAAK,CAAC;EAC7C,KAAK;EACL,IAAI,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;EACxB,CAAC;;;;;;;;;EC1HD,IAAI,kBAAkB,GAAG;EACzB,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,SAAS,EAAE,CAAC;EAChB,CAAC,CAAC;AACF,EAAO,SAAS,aAAa,CAAC,CAAC,EAAE;EACjC,IAAI,OAAO,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC;EACnC,CAAC;AACD,EAAO,IAAI,eAAe,GAAG,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,IAAI,EAAEM,MAAI,EAAE,IAAI,CAAC,CAAC;AACxF,EAAO,IAAI,sBAAsB,GAAG,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;EAChD,SAAS,uBAAuB,CAAC,QAAQ,EAAE;EAC3C,IAAI,IAAI,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC;EAC1B,IAAI,IAAI,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC;EAC1B,IAAI,IAAI,UAAU,CAAC,IAAI,CAAC,IAAI,UAAU,CAAC,IAAI,CAAC,EAAE;EAC9C,QAAQ,IAAI,IAAI,CAAC,IAAI,KAAK,cAAc,IAAI,IAAI,CAAC,IAAI,KAAK,cAAc,EAAE;EAC1E,YAAY,IAAI,IAAI,CAAC,KAAK,EAAE;EAC5B,gBAAgB,OAAO,GAAG,CAAC;EAC3B,aAAa;EACb,iBAAiB,IAAI,IAAI,CAAC,KAAK,EAAE;EACjC,gBAAgB,OAAO,GAAG,CAAC;EAC3B,aAAa;EACb;EACA,YAAY,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,OAAO,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;EAC3D,gBAAgB,OAAO,IAAI,CAAC,SAAS,GAAG,GAAG,GAAG,GAAG,CAAC;EAClD,aAAa;EACb,SAAS;EACT,aAAa,IAAI,IAAI,CAAC,IAAI,KAAK,cAAc,EAAE;EAC/C,YAAY,OAAO,GAAG,CAAC;EACvB,SAAS;EACT,aAAa,IAAI,IAAI,CAAC,IAAI,KAAK,cAAc,EAAE;EAC/C,YAAY,OAAO,GAAG,CAAC;EACvB,SAAS;EACT,KAAK;EACL,SAAS,IAAI,UAAU,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,KAAK,cAAc,EAAE;EAC/D,QAAQ,OAAO,GAAG,CAAC;EACnB,KAAK;EACL,SAAS,IAAI,UAAU,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,KAAK,cAAc,EAAE;EAC/D,QAAQ,OAAO,GAAG,CAAC;EACnB,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;EACD;EACA;AACA,EAAO,SAAS,KAAK,CAAC,CAAC,EAAE,QAAQ,EAAE,WAAW,EAAE;EAChD,IAAI,IAAI,IAAI,GAAG,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,GAAG,CAAC,CAAC;EACzC;EACA,IAAI,IAAI,CAAC,QAAQ,CAAC,eAAe,EAAE,IAAI,CAAC,EAAE;EAC1C,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,IAAI,IAAI,YAAY,GAAG,uBAAuB,CAAC,QAAQ,CAAC,CAAC;EACzD,IAAI,IAAI,CAAC,YAAY,EAAE;EACvB,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,IAAI,IAAI,eAAe,GAAG,QAAQ,CAAC,YAAY,CAAC,CAAC;EACjD,IAAI,IAAI,YAAY,GAAG,gBAAgB,CAAC,eAAe,CAAC,GAAG,OAAO,CAAC,eAAe,EAAE,EAAE,CAAC,GAAG,SAAS,CAAC;EACpG,IAAI,IAAI,gBAAgB,GAAG,YAAY,KAAK,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;EAC5D,IAAI,IAAI,YAAY,GAAG,QAAQ,CAAC,gBAAgB,CAAC,CAAC;EAClD,IAAI,IAAI,cAAc,GAAG,gBAAgB,CAAC,YAAY,CAAC,GAAG,OAAO,CAAC,YAAY,EAAE,EAAE,CAAC,GAAG,SAAS,CAAC;EAChG;EACA,IAAI,IAAI,OAAO,GAAG,oBAAoB,CAAC,MAAM,CAAC,UAAU,EAAE,EAAE,OAAO,EAAE;EACrE,QAAQ,IAAI,eAAe,CAAC,QAAQ,EAAE,OAAO,CAAC,EAAE;EAChD,YAAY,IAAI,UAAU,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC/C,YAAY,CAAC,OAAO,CAAC,UAAU,CAAC,GAAG,UAAU,GAAG,CAAC,UAAU,CAAC,EAAE,OAAO,CAAC,UAAU,IAAI,EAAE;EACtF,gBAAgB,IAAI,QAAQ,GAAG,WAAW,CAAC,IAAI,CAAC,CAAC;EACjD,gBAAgB,IAAI,QAAQ,CAAC,SAAS,EAAE;EACxC,oBAAoB,OAAO;EAC3B,iBAAiB;EACjB;EACA,gBAAgB,IAAI,CAAC,GAAG,gBAAgB,CAAC,QAAQ,CAAC,GAAG,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,GAAG,SAAS,CAAC;EACvF,gBAAgB;EAChB;EACA,gBAAgB,CAAC,CAAC;EAClB;EACA,qBAAqB,CAAC,KAAK,cAAc,IAAI,CAAC,KAAK,YAAY,CAAC,EAAE;EAClE,oBAAoB,EAAE,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,CAAC,CAAC;EACtE,iBAAiB;EACjB,aAAa,CAAC,CAAC;EACf,SAAS;EACT,QAAQ,OAAO,EAAE,CAAC;EAClB,KAAK,EAAE,EAAE,CAAC,CAAC;EACX,IAAI,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE;EAC9B,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL;EACA,IAAI,IAAI,MAAM,GAAG,SAAS,CAAC;EAC3B,IAAI,IAAI,eAAe,CAAC,KAAK,KAAK,SAAS,EAAE;EAC7C,QAAQ,MAAM,GAAG,eAAe,CAAC,KAAK,CAAC;EACvC,KAAK;EACL,SAAS,IAAI,QAAQ,CAAC,sBAAsB,EAAE,IAAI,CAAC,EAAE;EACrD;EACA,QAAQ,MAAM,GAAG,WAAW,KAAK,SAAS,GAAG,MAAM,GAAG,WAAW,CAAC;EAClE,KAAK;EACL,SAAS;EACT,QAAQ,MAAM,GAAG,WAAW,CAAC;EAC7B,KAAK;EACL,IAAI,IAAI,CAAC,MAAM,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,EAAE;EAC3C,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL;EACA,IAAI,IAAI,eAAe,CAAC,KAAK,IAAI,eAAe,CAAC,KAAK,CAAC,IAAI,IAAI,eAAe,CAAC,KAAK,CAAC,IAAI,KAAK,SAAS,CAAC,MAAM,EAAE;EAChH,QAAQE,IAAQ,CAACC,OAAW,CAAC,yBAAyB,CAAC,eAAe,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;EACpF,KAAK;EACL;EACA,IAAI,IAAI,eAAe,CAAC,QAAQ,EAAE,YAAY,KAAK,CAAC,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE;EACjE,QAAQD,IAAQ,CAACC,OAAW,CAAC,qBAAqB,CAAC,YAAY,CAAC,CAAC,CAAC;EAClE,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL;EACA,IAAI,IAAI,eAAe,CAAC,SAAS,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,eAAe,CAAC,SAAS,CAAC,EAAE;EACpF,QAAQD,IAAQ,CAACC,OAAW,CAAC,0BAA0B,CAAC,eAAe,CAAC,SAAS,CAAC,CAAC,CAAC;EACpF,KAAK;EACL,IAAI,OAAO;EACX,QAAQ,cAAc,EAAE,YAAY,GAAG,gBAAgB,GAAG,SAAS;EACnE,QAAQ,YAAY,EAAE,YAAY;EAClC,QAAQ,MAAM,EAAE,UAAU,CAAC,IAAI,CAAC;EAChC,QAAQ,OAAO,EAAE,OAAO;EACxB,QAAQ,MAAM,EAAE,MAAM;EACtB,KAAK,CAAC;EACN,CAAC;;;;;;;;;ECrHD;AACA,EAAO,SAAS,WAAW,CAAC,IAAI,EAAE;EAClC,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,KAAK,SAAS,CAAC;EACvC,CAAC;AACD,EAAO,SAAS,UAAU,CAAC,IAAI,EAAE;EACjC,IAAI,OAAO,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;EAC1B,CAAC;AACD,EAAO,SAAS,WAAW,CAAC,IAAI,EAAE;EAClC,IAAI,OAAO,IAAI,CAAC,OAAO,CAAC,KAAK,SAAS,CAAC;EACvC,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,IAAI,EAAE;EACnC,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,SAAS,CAAC;EACxC,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,IAAI,EAAE;EACnC,IAAI,OAAO,aAAa,CAAC,IAAI,CAAC,IAAI,aAAa,CAAC,IAAI,CAAC,CAAC;EACtD,CAAC;AACD,EAAO,SAAS,aAAa,CAAC,IAAI,EAAE;EACpC,IAAI,OAAO,IAAI,CAAC,SAAS,CAAC,KAAK,SAAS,CAAC;EACzC,CAAC;AACD,EAAO,SAAS,aAAa,CAAC,IAAI,EAAE;EACpC,IAAI,OAAO,IAAI,CAAC,SAAS,CAAC,KAAK,SAAS,CAAC;EACzC,CAAC;EACD;EACA;EACA;EACA;AACA,EAAO,SAASE,WAAS,CAAC,IAAI,EAAE,MAAM,EAAE;EACxC,IAAI,IAAI,WAAW,CAAC,IAAI,CAAC,EAAE;EAC3B,QAAQ,OAAO,cAAc,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;EAC5C,KAAK;EACL,IAAI,IAAI,WAAW,CAAC,IAAI,CAAC,EAAE;EAC3B,QAAQ,OAAO,cAAc,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;EAC5C,KAAK;EACL,IAAI,IAAI,YAAY,CAAC,IAAI,CAAC,EAAE;EAC5B,QAAQ,OAAO,eAAe,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;EAC7C,KAAK;EACL,IAAI,IAAI,aAAa,CAAC,IAAI,CAAC,EAAE;EAC7B,QAAQ,OAAO,gBAAgB,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;EAC9C,KAAK;EACL,IAAI,IAAI,aAAa,CAAC,IAAI,CAAC,EAAE;EAC7B,QAAQ,OAAO,gBAAgB,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;EAC9C,KAAK;EACL,IAAI,IAAI,UAAU,CAAC,IAAI,CAAC,EAAE;EAC1B,QAAQ,IAAI,MAAM,GAAG,eAAe,CAAC,IAAI,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;EACzD,QAAQ,IAAI,SAAS,GAAG,eAAe,CAAC,IAAI,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;EAC/D,QAAQ,IAAI,MAAM,IAAI,SAAS,EAAE;EACjC,YAAY,OAAO,oBAAoB,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;EACtD,SAAS;EACT,QAAQ,OAAO,qBAAqB,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;EACnD,KAAK;EACL,IAAI,MAAM,IAAI,KAAK,CAACF,OAAW,CAAC,YAAY,CAAC,CAAC;EAC9C,CAAC;EACD,SAAS,cAAc,CAAC,IAAI,EAAE,MAAM,EAAE;EACtC,IAAI,IAAI,OAAO,GAAG,IAAI,CAAC,IAAI,EAAE,IAAI,GAAGJ,MAAc,CAAC,IAAI,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;EACnE,IAAI,OAAOL,QAAgB,CAAC,EAAE,EAAE,IAAI,EAAE;EACtC;EACA,QAAQ,IAAI,EAAEW,WAAS,CAAC,OAAO,EAAE,MAAM,CAAC,EAAE,CAAC,CAAC;EAC5C,CAAC;EACD,SAAS,aAAa,CAAC,GAAG,EAAE;EAC5B,IAAI,IAAI,cAAc,GAAG,GAAG,CAAC,cAAc,EAAE,QAAQ,GAAG,GAAG,CAAC,QAAQ,CAAC;EACrE,IAAI,IAAI,cAAc,IAAI,QAAQ,EAAE;EACpC,QAAQ,IAAI,SAAS,GAAG,IAAI,CAAC,cAAc,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,EAAER,MAAG,EAAE;EACtE,YAAY,IAAI,QAAQ,CAACA,MAAG,CAAC,EAAE;EAC/B,gBAAgB,CAAC,CAAC,IAAI,CAACA,MAAG,CAAC,CAAC;EAC5B,aAAa;EACb,YAAY,OAAO,CAAC,CAAC;EACrB,SAAS,EAAE,EAAE,CAAC,CAAC;EACf,QAAQ,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;EAClC,YAAYK,IAAQ,CAACC,OAAW,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC,CAAC;EAChE,SAAS;EACT,KAAK;EACL,IAAI,IAAI,MAAM,GAAGT,QAAgB,CAAC,EAAE,GAAG,cAAc,IAAI,EAAE,IAAI,QAAQ,IAAI,EAAE,EAAE,CAAC;EAChF,IAAI,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,GAAG,CAAC,GAAG,MAAM,GAAG,SAAS,CAAC;EACxD,CAAC;EACD,SAAS,eAAe,CAAC,GAAG,EAAE;EAC9B,IAAI,IAAI,gBAAgB,GAAG,GAAG,CAAC,gBAAgB,EAAE,UAAU,GAAG,GAAG,CAAC,UAAU,CAAC;EAC7E,IAAI,IAAI,gBAAgB,IAAI,UAAU,EAAE;EACxC,QAAQQ,IAAQ,CAACC,OAAW,CAAC,oBAAoB,CAAC,EAAE,gBAAgB,EAAE,gBAAgB,EAAE,UAAU,EAAE,UAAU,EAAE,CAAC,CAAC,CAAC;EACnH,KAAK;EACL,IAAI,OAAO,UAAU,IAAI,gBAAgB,CAAC;EAC1C,CAAC;EACD,SAAS,cAAc,CAAC,IAAI,EAAE,MAAM,EAAE,cAAc,EAAE,gBAAgB,EAAE;EACxE,IAAI,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,EAAE,QAAQ,GAAG,IAAI,CAAC,QAAQ,EAAE,UAAU,GAAG,IAAI,CAAC,UAAU,EAAE,IAAI,GAAGJ,MAAc,CAAC,IAAI,EAAE,CAAC,OAAO,EAAE,UAAU,EAAE,YAAY,CAAC,CAAC,CAAC;EACrJ,IAAI,IAAI,cAAc,GAAG,aAAa,CAAC,EAAE,cAAc,EAAE,cAAc,EAAE,QAAQ,EAAE,QAAQ,EAAE,CAAC,CAAC;EAC/F,IAAI,IAAI,gBAAgB,GAAG,eAAe,CAAC,EAAE,gBAAgB,EAAE,gBAAgB,EAAE,UAAU,EAAE,UAAU,EAAE,CAAC,CAAC;EAC3G,IAAI,OAAOL,QAAgB,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE,KAAK,EAAE,KAAK,CAAC,GAAG,CAAC,UAAU,OAAO,EAAE;EAC5E,YAAY,IAAI,WAAW,CAAC,OAAO,CAAC,EAAE;EACtC,gBAAgB,OAAO,cAAc,CAAC,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,gBAAgB,CAAC,CAAC;EACzF,aAAa;EACb,YAAY,OAAO,qBAAqB,CAAC,OAAO,EAAE,MAAM,EAAE,cAAc,EAAE,gBAAgB,CAAC,CAAC;EAC5F,SAAS,CAAC,EAAE,CAAC,CAAC;EACd,CAAC;EACD,SAAS,eAAe,CAAC,IAAI,EAAE,MAAM,EAAE;EACvC,IAAI,IAAI,OAAO,GAAG,IAAI,CAAC,IAAI,EAAE,IAAI,GAAGK,MAAc,CAAC,IAAI,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;EACnE,IAAI,OAAOL,QAAgB,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE,IAAI,EAAEW,WAAS,CAAC,OAAO,EAAE,MAAM,CAAC,EAAE,CAAC,CAAC;EAC5E,CAAC;EACD,SAAS,gBAAgB,CAAC,IAAI,EAAE,MAAM,EAAE;EACxC,IAAI,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,EAAE,IAAI,GAAGN,MAAc,CAAC,IAAI,EAAE,CAAC,SAAS,CAAC,CAAC,CAAC;EACzE,IAAI,OAAOL,QAAgB,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE,OAAO,EAAE,OAAO,CAAC,GAAG,CAAC,UAAU,OAAO,EAAE,EAAE,OAAOW,WAAS,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAC3H,CAAC;EACD,SAAS,gBAAgB,CAAC,IAAI,EAAE,MAAM,EAAE;EACxC,IAAI,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,EAAE,IAAI,GAAGN,MAAc,CAAC,IAAI,EAAE,CAAC,SAAS,CAAC,CAAC,CAAC;EACzE,IAAI,OAAOL,QAAgB,CAAC,EAAE,EAAE,IAAI,EAAE,EAAE,OAAO,EAAE,OAAO,CAAC,GAAG,CAAC,UAAU,OAAO,EAAE,EAAE,OAAOW,WAAS,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAC3H,CAAC;EACD,SAAS,oBAAoB,CAAC,IAAI,EAAE,MAAM,EAAE;EAC5C;EACA;EACA,IAAI,IAAI,EAAE,GAAG,IAAI,CAAC,QAAQ,EAAE,GAAG,GAAG,EAAE,CAAC,GAAG,EAAE,MAAM,GAAG,EAAE,CAAC,MAAM,EAAE,QAAQ,GAAGN,MAAc,CAAC,EAAE,EAAE,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC,CAAC;EAC/G;EACA,IAAI,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,EAAE,KAAK,GAAG,IAAI,CAAC,KAAK,EAAE,UAAU,GAAG,IAAI,CAAC,UAAU,EAAE,MAAM,GAAG,IAAI,CAAC,MAAM,EAAE,SAAS,GAAG,IAAI,CAAC,SAAS,EAAE,CAAC,GAAG,IAAI,CAAC,QAAQ,EAAE,SAAS,GAAGA,MAAc,CAAC,IAAI,EAAE,CAAC,MAAM,EAAE,OAAO,EAAE,YAAY,EAAE,QAAQ,EAAE,WAAW,EAAE,UAAU,CAAC,CAAC,CAAC;EACtP,IAAI,OAAOL,QAAgB,CAAC,EAAE,EAAE,SAAS,EAAE,EAAE,KAAK,EAAEA,QAAgB,CAAC,EAAE,GAAG,GAAG,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,MAAM,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,EAAE,EAAE,EAAE,IAAI,EAAE,qBAAqB,CAACA,QAAgB,CAAC,EAAE,GAAG,UAAU,GAAG,EAAE,UAAU,EAAE,UAAU,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,KAAK,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,MAAM,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,EAAE,GAAG,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,SAAS,GAAG,EAAE,SAAS,EAAE,SAAS,EAAE,GAAG,EAAE,EAAE,EAAE,MAAM,CAAC,EAAE,CAAC,CAAC;EAChZ,CAAC;EACD,SAAS,mCAAmC,CAAC,IAAI,EAAE;EACnD,IAAI,OAAO,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACtC,CAAC;EACD,SAAS,eAAe,CAAC,OAAO,EAAE,UAAU,EAAE,QAAQ,EAAE;EACxD,IAAI,IAAI,OAAO,CAAC,KAAK,KAAK,aAAa,EAAE;EACzC,QAAQ,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC;EAC9B,KAAK;EACL,SAAS,IAAI,OAAO,CAAC,KAAK,EAAE;EAC5B,QAAQ,OAAO,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,OAAO,CAAC,KAAK,GAAG,EAAE,CAAC;EAC5D,KAAK;EACL,SAAS,IAAI,OAAO,CAAC,KAAK,KAAK,SAAS,EAAE;EAC1C,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,SAAS;EACT,QAAQ,IAAI,UAAU,CAAC,KAAK,IAAI,QAAQ,CAAC,KAAK,EAAE;EAChD;EACA,YAAY,OAAO,QAAQ,CAAC,UAAU,CAAC,KAAK,CAAC,GAAG,UAAU,CAAC,KAAK,GAAG,EAAE,CAAC;EACtE,SAAS;EACT;EACA,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,CAAC;EACD,SAAS,cAAc,CAAC,OAAO,EAAE,UAAU,EAAE;EAC7C,IAAI,IAAI,OAAO,CAAC,IAAI,EAAE;EACtB,QAAQ,OAAO,OAAO,CAAC,IAAI,KAAK,IAAI,GAAG,EAAE,GAAG,OAAO,CAAC,IAAI,CAAC;EACzD,KAAK;EACL,SAAS,IAAI,OAAO,CAAC,IAAI,KAAK,SAAS,EAAE;EACzC,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,SAAS;EACT,QAAQ,IAAI,UAAU,CAAC,IAAI,EAAE;EAC7B;EACA,YAAY,OAAO,UAAU,CAAC,IAAI,KAAK,IAAI,GAAG,EAAE,GAAG,UAAU,CAAC,IAAI,CAAC;EACnE,SAAS;EACT;EACA,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,CAAC;EACD,SAAS,qBAAqB,CAAC,IAAI,EAAE,MAAM,EAAE,cAAc,EAAE,gBAAgB,EAAE;EAC/E,IAAI,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,EAAE,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;EAC/D,IAAI,IAAI,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;EACjE;EACA,IAAI,IAAI,cAAc,IAAI,gBAAgB,EAAE;EAC5C,QAAQ,IAAI,gBAAgB,GAAG,eAAe,CAAC,EAAE,gBAAgB,EAAE,gBAAgB,EAAE,UAAU,EAAE,UAAU,EAAE,CAAC,CAAC;EAC/G,QAAQ,IAAI,cAAc,GAAG,aAAa,CAAC,EAAE,cAAc,EAAE,cAAc,EAAE,QAAQ,EAAE,QAAQ,EAAE,CAAC,CAAC;EACnG,QAAQ,OAAO,qBAAqB,CAACA,QAAgB,CAAC,EAAE,EAAE,IAAI,GAAG,gBAAgB,GAAG,EAAE,UAAU,EAAE,gBAAgB,EAAE,GAAG,EAAE,IAAI,cAAc,GAAG,EAAE,QAAQ,EAAE,cAAc,EAAE,GAAG,EAAE,EAAE,EAAE,MAAM,CAAC,CAAC;EAC3L,KAAK;EACL,IAAI,IAAI,mCAAmC,CAAC,IAAI,CAAC,EAAE;EACnD;EACA,QAAQ,IAAI,QAAQ,CAAC,QAAQ,CAAC,EAAE;EAChC,YAAY,OAAO,mBAAmB,CAAC,IAAI,CAAC,CAAC;EAC7C,SAAS;EACT,QAAQ,IAAI,IAAI,KAAK,MAAM,KAAK,QAAQ,CAAC,EAAE,IAAI,QAAQ,CAAC,EAAE,CAAC,EAAE;EAC7D,YAAYQ,IAAQ,CAACC,OAAW,CAAC,aAAa,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE,EAAE,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;EAC9E,YAAY,OAAO,qBAAqB,CAACT,QAAgB,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,IAAI,CAAC,EAAE,MAAM,EAAE,cAAc,EAAE,gBAAgB,CAAC,CAAC;EAC7H,SAAS;EACT,QAAQ,IAAI,UAAU,CAAC,IAAI,CAAC,EAAE;EAC9B,YAAY,OAAO,oBAAoB,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;EACtD,SAAS;EACT,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,SAAS;EACT,QAAQ,OAAOiB,WAAuB,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;EACrD,KAAK;EACL,CAAC;EACD,SAAS,mBAAmB,CAAC,IAAI,EAAE;EACnC,IAAI,IAAI,IAAI,GAAG,eAAe,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;EACjD,IAAI,IAAI,IAAI,GAAG,eAAe,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;EACjD,IAAI,IAAI,KAAK,GAAG,eAAe,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;EACnD,IAAI,IAAI,KAAK,GAAG,eAAe,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;EACnD,IAAI,IAAI,CAAC,KAAK,IAAI,CAAC,IAAI,MAAM,KAAK,IAAI,CAAC,IAAI,CAAC,EAAE;EAC9C,QAAQ,IAAI,cAAc,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC;EAC7C,QAAQ,IAAI,KAAK,IAAI,CAAC,IAAI,EAAE;EAC5B,YAAY,cAAc,CAAC,QAAQ,CAAC,CAAC,GAAG,cAAc,CAAC,QAAQ,CAAC,EAAE,CAAC;EACnE,YAAY,OAAO,cAAc,CAAC,QAAQ,CAAC,EAAE,CAAC;EAC9C,SAAS;EACT,QAAQ,IAAI,KAAK,IAAI,CAAC,IAAI,EAAE;EAC5B,YAAY,cAAc,CAAC,QAAQ,CAAC,CAAC,GAAG,cAAc,CAAC,QAAQ,CAAC,EAAE,CAAC;EACnE,YAAY,OAAO,cAAc,CAAC,QAAQ,CAAC,EAAE,CAAC;EAC9C,SAAS;EACT,QAAQ,OAAO,cAAc,CAAC;EAC9B,KAAK;EACL,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;EACD,SAAS,gBAAgB,CAAC,OAAO,EAAE;EACnC,IAAI,IAAI,MAAM,GAAG,OAAO,CAAC,KAAK,EAAE,KAAK,GAAG,OAAO,CAAC,IAAI,EAAE,IAAI,GAAGZ,MAAc,CAAC,OAAO,EAAE,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC,CAAC;EACxG,IAAI,OAAO,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,GAAG,CAAC,GAAG,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;EACpD,CAAC;EACD,SAAS,oBAAoB,CAAC,IAAI,EAAE,MAAM,EAAE;EAC5C,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,IAAI,MAAM,KAAK,KAAK,CAAC,EAAE,EAAE,MAAM,GAAG,EAAE,CAAC,EAAE;EAC3C;EACA;EACA,IAAI,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,EAAE,UAAU,GAAG,IAAI,CAAC,UAAU,EAAE,QAAQ,GAAG,IAAI,CAAC,QAAQ,EAAE,IAAI,GAAG,IAAI,CAAC,IAAI,EAAE,SAAS,GAAGA,MAAc,CAAC,IAAI,EAAE,CAAC,WAAW,EAAE,YAAY,EAAE,UAAU,EAAE,MAAM,CAAC,CAAC,CAAC;EAChM,IAAI,IAAI,OAAO,GAAG,SAAS,CAAC,IAAI,CAAC,GAAG,IAAI,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;EAC1D,IAAI,IAAI,YAAY,GAAG,eAAe,CAAC,OAAO,EAAE,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,QAAQ,CAAC,CAAC;EAChF,IAAI,IAAI,WAAW,GAAG,OAAO,CAAC,IAAI,KAAK,MAAM,IAAI,cAAc,CAAC,OAAO,EAAE,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;EAC/F,IAAI,IAAI,CAAC,YAAY,IAAI,CAAC,WAAW,EAAE;EACvC,QAAQ,OAAOL,QAAgB,CAAC,EAAE,EAAE,IAAI,EAAE;EAC1C;EACA,YAAY,IAAI,EAAE,gBAAgB,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;EAC/C,KAAK;EACL,IAAI,IAAI,KAAK,GAAG,CAACA,QAAgB,CAAC,EAAE,GAAG,SAAS,GAAG,EAAE,SAAS,EAAE,SAAS,EAAE,GAAG,EAAE,GAAG;EACnF;EACA,YAAY,IAAI,EAAE,gBAAgB,CAACA,QAAgB,CAAC,EAAE,EAAE,OAAO,GAAG,OAAO,CAAC,IAAI,KAAK,MAAM,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC;EACpH;EACA,YAAY,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EACpD;EACA;EACA;EACA,IAAI,IAAI,UAAU,GAAG,KAAK,CAAC,OAAO,EAAE,QAAQ,EAAE,MAAM,GAAG,MAAM,CAAC,KAAK,GAAG,SAAS,CAAC,CAAC;EACjF,IAAI,IAAI,eAAe,GAAG,QAAQ,CAAC;EACnC,IAAI,IAAI,UAAU,EAAE;EACpB,QAAQ,IAAI,iBAAiB,GAAG,UAAU,CAAC,YAAY,EAAE,MAAM,GAAG,UAAU,CAAC,MAAM,CAAC;EACpF,QAAQ,eAAe,GAAGA,QAAgB,CAAC,EAAE,EAAE,QAAQ,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,iBAAiB,CAAC,GAAGA,QAAgB,CAAC,EAAE,EAAE,QAAQ,CAAC,iBAAiB,CAAC,GAAG,MAAM,GAAG,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;EACtL,KAAK;EACL,IAAI,IAAI,WAAW,EAAE;EACrB,QAAQ,IAAI,WAAW,GAAG,OAAO,CAAC,WAAW,CAAC;EAC9C,QAAQ,KAAK,CAAC,IAAI,CAACA,QAAgB,CAAC,EAAE,GAAG,UAAU,GAAG,EAAE,UAAU,EAAE,UAAU,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAEA,QAAgB,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,EAAE,WAAW,GAAG,WAAW,GAAG,EAAE,WAAW,EAAE,WAAW,EAAE,GAAG,EAAE,EAAE,EAAE,QAAQ,EAAE,eAAe,EAAE,CAAC,CAAC,CAAC;EAClO,KAAK;EACL,IAAI,IAAI,YAAY,EAAE;EACtB,QAAQ,KAAK,CAAC,IAAI,CAACA,QAAgB,CAAC,EAAE,GAAG,UAAU,GAAG,EAAE,UAAU,EAAE,UAAU,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAEA,QAAgB,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,YAAY,CAAC,EAAE,QAAQ,EAAE,eAAe,EAAE,CAAC,CAAC,CAAC;EAC3M,KAAK;EACL,IAAI,OAAOA,QAAgB,CAAC,EAAE,EAAE,SAAS,EAAE,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;EAC7D,CAAC;EACD;EACA;EACA,SAAS,UAAU,CAAC,IAAI,EAAE,IAAI,EAAE;EAChC,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,QAAQ,EAAE;EACrC;EACA,QAAQ,IAAI,YAAY,GAAG,CAAC,OAAO,EAAE,MAAM,EAAE,OAAO,EAAE,UAAU,EAAE,KAAK,EAAE,WAAW,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,EAAEG,MAAG,EAAE;EAC/G,YAAY,IAAI,QAAQ,CAACA,MAAG,CAAC,KAAK,SAAS,EAAE;EAC7C,gBAAgB,CAAC,CAACA,MAAG,CAAC,GAAG,QAAQ,CAACA,MAAG,CAAC,CAAC;EACvC,aAAa;EACb,YAAY,OAAO,CAAC,CAAC;EACrB,SAAS,EAAE,EAAE,CAAC,CAAC;EACf,QAAQ,IAAIA,MAAG,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC;EACrC,QAAQ,IAAI,CAACA,MAAG,CAAC,GAAG,IAAI,CAACA,MAAG,CAAC,IAAI,QAAQ,CAAC;EAC1C,KAAK,CAAC,CAAC;EACP,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;EACD;EACA,SAAS,aAAa,CAAC,IAAI,EAAE,IAAI,EAAE;EACnC,IAAI,IAAI,IAAI,KAAK,KAAK,CAAC,EAAE,EAAE,IAAI,GAAG,EAAE,CAAC,EAAE;EACvC;EACA,IAAI,IAAI,WAAW,CAAC,IAAI,CAAC,EAAE;EAC3B,QAAQ,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,UAAU,KAAK,EAAE;EAC5C,YAAY,IAAI,UAAU,CAAC,KAAK,CAAC,EAAE;EACnC,gBAAgB,UAAU,CAAC,IAAI,EAAEe,SAAoB,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;EACvE,aAAa;EACb,iBAAiB;EACjB,gBAAgB,aAAa,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;EAC3C,aAAa;EACb,SAAS,CAAC,CAAC;EACX,KAAK;EACL,SAAS,IAAI,WAAW,CAAC,IAAI,CAAC,EAAE;EAChC,QAAQ,UAAU,CAAC,IAAI,EAAEA,SAAoB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;EAC3D,QAAQ,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;EACvC,KAAK;EACL,SAAS,IAAI,YAAY,CAAC,IAAI,CAAC,EAAE;EACjC,QAAQ,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;EACvC,KAAK;EACL,SAAS,IAAI,YAAY,CAAC,IAAI,CAAC,EAAE;EACjC,QAAQ,IAAI,SAAS,GAAG,aAAa,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;EAC1E,QAAQ,SAAS,CAAC,OAAO,CAAC,UAAU,KAAK,EAAE,EAAE,OAAO,aAAa,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;EACnF,KAAK;EACL,SAAS;EACT,QAAQ,UAAU,CAAC,IAAI,EAAEA,SAAoB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;EAC9D,KAAK;EACL,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;EACD;AACA,EAAO,SAASC,WAAS,CAAC,IAAI,EAAE;EAChC,IAAI,OAAO,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC;EACrC,CAAC;AACD,EAAO,SAAS,SAAS,CAAC,IAAI,EAAE,MAAM,EAAE;EACxC,IAAI,MAAM,GAAG,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC;EACnC,IAAI,IAAI,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;EACpC,QAAQ,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,EAAE,MAAM,GAAG,MAAM,CAAC,KAAK,GAAG,SAAS,CAAC,KAAK,IAAI,CAAC;EAC3F,KAAK;EACL,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;;;;;;;;;;;;;;;EC5SD,SAAS,kBAAkB,CAAC,QAAQ,EAAE;EACtC,IAAI,OAAO,QAAQ,CAAC,QAAQ,CAAC,GAAG,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,QAAQ,IAAI,EAAE,CAAC;EACpE,CAAC;AACD,EAAO,SAAS,iBAAiB,CAAC,gBAAgB,EAAE,cAAc,EAAE,aAAa,EAAE;EACnF,IAAI,IAAI,aAAa,KAAK,KAAK,CAAC,EAAE,EAAE,aAAa,GAAG,IAAI,CAAC,EAAE;EAC3D,IAAI,IAAI,QAAQ,GAAGnB,QAAgB,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE,kBAAkB,CAAC,cAAc,CAAC,EAAE,kBAAkB,CAAC,gBAAgB,CAAC,CAAC,CAAC;EAC/H,IAAI,IAAI,QAAQ,CAAC,IAAI,KAAK,KAAK,EAAE;EACjC,QAAQ,IAAI,CAAC,aAAa,EAAE;EAC5B,YAAYQ,IAAQ,CAACC,OAAW,CAAC,cAAc,CAAC,CAAC;EACjD,YAAY,QAAQ,CAAC,IAAI,GAAG,KAAK,CAAC;EAClC,SAAS;EACT,KAAK;EACL,IAAI,OAAO,QAAQ,CAAC;EACpB,CAAC;EACD,IAAI,oBAAoB,GAAG;EAC3B,IAAI,YAAY,EAAE,SAAS,EAAE,UAAU;EACvC;EACA,CAAC,CAAC;AACF,EAAO,SAAS,yBAAyB,CAAC,CAAC,EAAE;EAC7C,IAAI,OAAO,oBAAoB,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,CAAC,EAAE;EACvD,QAAQ,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,SAAS,EAAE;EACrC,YAAY,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;EACxB,SAAS;EACT,QAAQ,OAAO,CAAC,CAAC;EACjB,KAAK,EAAE,EAAE,CAAC,CAAC;EACX,CAAC;;EC5BM,SAAS,SAAS,CAAC,IAAI,EAAE;EAChC,IAAI,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;EACzB,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,IAAI,EAAE;EACnC,IAAI,OAAO,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;EAC5B,CAAC;AACD,EAAO,SAAS,WAAW,CAAC,IAAI,EAAE;EAClC,IAAI,OAAO,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;EACrE,CAAC;AACD,EAAO,IAAI,IAAI,GAAG,MAAM,CAAC;AACzB,EAAO,IAAI,GAAG,GAAG,KAAK,CAAC;;;;;;;;;;ECVvB;EACA;EACA;EACA;AACA,EAAe,sBAAQ,CAAC,QAAQ,EAAE,MAAM,EAAE,KAAK,EAAE;EACjD,EAAE,cAAc,GAAG,MAAM,IAAI,IAAI,CAAC;EAClC,EAAE,KAAK,GAAG,KAAK,IAAI,aAAa,CAAC;EACjC,EAAE,OAAO,UAAU,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,CAAC,GAAG,CAACW,eAAa,CAAC,CAAC;EACxD,CAAC;;EAED,IAAI,IAAI,MAAM,MAAM;EACpB,IAAI,MAAM,IAAI,GAAG;EACjB,IAAI,MAAM,IAAI,GAAG;EACjB,IAAI,MAAM,IAAI,GAAG;EACjB,IAAI,MAAM,IAAI,GAAG;EACjB,IAAI,KAAK,KAAK,GAAG;EACjB,IAAI,KAAK,KAAK,GAAG;EACjB,IAAI,IAAI,MAAM,GAAG;EACjB,IAAI,EAAE,QAAQ,GAAG;EACjB,IAAI,OAAO,GAAG,SAAS;EACvB,IAAI,cAAc;EAClB,IAAI,KAAK;EACT,IAAI,aAAa,GAAG;EACpB,MAAM,GAAG,EAAE,CAAC;EACZ,MAAM,GAAG,EAAE,CAAC;EACZ,MAAM,IAAI,EAAE,CAAC;EACb,MAAM,KAAK,EAAE,CAAC;EACd,MAAM,KAAK,EAAE,CAAC;EACd,MAAM,IAAI,EAAE,CAAC;EACb,MAAM,IAAI,EAAE,CAAC;EACb,MAAM,IAAI,EAAE,CAAC;EACb,MAAM,IAAI,EAAE,CAAC;EACb,MAAM,KAAK,EAAE,CAAC;EACd,MAAM,MAAM,EAAE,CAAC;EACf,MAAM,IAAI,EAAE,CAAC;EACb,MAAM,KAAK,EAAE,CAAC;EACd,KAAK,CAAC;;EAEN,SAAS,UAAU,CAAC,IAAI,EAAE;EAC1B,EAAE,OAAO,KAAK,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;EACpC,CAAC;;EAED,SAAS,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,OAAO,EAAE,QAAQ,EAAE,OAAO,EAAE;EAChD,EAAE,IAAI,KAAK,GAAG,CAAC;EACf,MAAM,CAAC,GAAG,CAAC,CAAC,MAAM;EAClB,MAAM,CAAC,CAAC;EACR,EAAE,OAAO,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,EAAE;EACnB,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;EACb,IAAI,IAAI,CAAC,KAAK,IAAI,CAAC,KAAK,OAAO,EAAE,OAAO,CAAC,CAAC;EAC1C,SAAS,IAAI,OAAO,IAAI,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE,KAAK,CAAC;EACzD,SAAS,IAAI,QAAQ,IAAI,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE,KAAK,CAAC;EAC3D,GAAG;EACH,EAAE,OAAO,CAAC,CAAC;EACX,CAAC;;EAED,SAAS,UAAU,CAAC,CAAC,EAAE;EACvB,EAAE,IAAI,MAAM,GAAG,EAAE;EACjB,MAAM,KAAK,GAAG,CAAC;EACf,MAAM,CAAC,GAAG,CAAC,CAAC,MAAM;EAClB,MAAM,CAAC,GAAG,CAAC,CAAC;;EAEZ,EAAE,OAAO,CAAC,GAAG,CAAC,EAAE;EAChB,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,MAAM,GAAG,MAAM,EAAE,MAAM,GAAG,MAAM,CAAC,CAAC;EAC5D,IAAI,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC;EAC9C,IAAI,KAAK,GAAG,EAAE,CAAC,CAAC;EAChB,GAAG;;EAEH,EAAE,IAAI,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE;EAC3B,IAAI,MAAM,wBAAwB,GAAG,CAAC,CAAC;EACvC,GAAG;EACH,EAAE,OAAO,MAAM,CAAC;EAChB,CAAC;;EAED,SAASA,eAAa,CAAC,CAAC,EAAE;EAC1B,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG;EACrB,MAAM,YAAY,CAAC,CAAC,CAAC;EACrB,MAAM,WAAW,CAAC,CAAC,CAAC,CAAC;EACrB,CAAC;;EAED,SAAS,YAAY,CAAC,CAAC,EAAE;EACzB,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM;EAClB,MAAM,CAAC,GAAG,CAAC;EACX,MAAM,CAAC,EAAE,MAAM,CAAC;;EAEhB,EAAE,CAAC,GAAG,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;EACzC,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE;EACf,IAAI,MAAM,0BAA0B,GAAG,CAAC,CAAC;EACzC,GAAG;;EAEH,EAAE,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACpC,EAAE,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE;EACtB,IAAI,MAAM,2CAA2C,GAAG,CAAC,CAAC;EAC1D,GAAG;;EAEH,EAAE,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;EAC5B,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,EAAE,EAAE;EACnB,IAAI,MAAM,yCAAyC,GAAG,CAAC,CAAC;EACxD,GAAG;;EAEH,EAAE,CAAC,GAAG,CAAC,CAAC,GAAG,CAACA,eAAa,CAAC,CAAC;;EAE3B,EAAE,MAAM,GAAGA,eAAa,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC;EAC5C,EAAE,IAAI,MAAM,CAAC,OAAO,EAAE;EACtB,IAAI,OAAO;EACX,MAAM,OAAO,EAAE,CAAC;EAChB,MAAM,MAAM,EAAE,MAAM;EACpB,KAAK,CAAC;EACN,GAAG,MAAM;EACT,IAAI,MAAM,CAAC,OAAO,GAAG,CAAC,CAAC;EACvB,GAAG;;EAEH,EAAE,OAAO,MAAM,CAAC;EAChB,CAAC;;EAED,SAAS,WAAW,CAAC,CAAC,EAAE;EACxB,EAAE,IAAI,MAAM,GAAG,CAAC,MAAM,EAAE,cAAc,CAAC;EACvC,MAAM,MAAM,GAAG,EAAE;EACjB,MAAM,QAAQ,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;EACvB,MAAM,QAAQ,GAAG,CAAC;EAClB,MAAM,KAAK,GAAG,CAAC;EACf,MAAM,CAAC,GAAG,CAAC,CAAC,MAAM;EAClB,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC;EACd,MAAM,MAAM,CAAC;;EAEb;EACA,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,MAAM,EAAE;EACzB,IAAI,CAAC,GAAG,CAAC,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;EAC9B,IAAI,IAAI,CAAC,IAAI,CAAC,EAAE;EAChB,MAAM,IAAI;EACV,QAAQ,QAAQ,GAAG,aAAa,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EACxD,OAAO,CAAC,OAAO,CAAC,EAAE;EAClB,QAAQ,MAAM,kCAAkC,GAAG,CAAC,CAAC;EACrD,OAAO;EACP,MAAM,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;EAC/B,MAAM,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC;EACnB,KAAK,MAAM,MAAM,yBAAyB,GAAG,CAAC,CAAC;EAC/C,IAAI,CAAC,GAAG,CAAC,CAAC;EACV,GAAG;;EAEH,EAAE,IAAI,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;;EAElB;EACA,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,IAAI,EAAE,QAAQ,GAAG,EAAE,CAAC,CAAC;;EAEpC;EACA,EAAE,CAAC,GAAG,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;EACxB,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE;EACb,IAAI,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC;EAC9C,IAAI,KAAK,GAAG,CAAC,GAAG,EAAE,CAAC,CAAC;EACpB,GAAG;;EAEH;EACA,EAAE,CAAC,GAAG,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC;EACzB,EAAE,IAAI,CAAC,KAAK,CAAC,EAAE;EACf,IAAI,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC;EAC9C,GAAG,MAAM;EACT,IAAI,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC;EAC9C,IAAI,MAAM,GAAG,EAAE,CAAC;EAChB,IAAI,KAAK,GAAG,EAAE,CAAC,CAAC;EAChB,IAAI,IAAI,KAAK,KAAK,CAAC,EAAE,MAAM,0BAA0B,GAAG,CAAC,CAAC;EAC1D,GAAG;;EAEH;EACA,EAAE,OAAO,CAAC,GAAG,CAAC,EAAE;EAChB,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,CAAC;EAC3B,IAAI,IAAI,CAAC,KAAK,CAAC,EAAE,MAAM,0BAA0B,GAAG,CAAC,CAAC;EACtD,IAAI,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC;EAC9C,IAAI,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,MAAM,EAAE,MAAM,yBAAyB,GAAG,CAAC,CAAC;EAC1E,IAAI,KAAK,GAAG,EAAE,CAAC,CAAC;EAChB,GAAG;;EAEH;EACA,EAAE,IAAI,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE;EACzD,IAAI,MAAM,0BAA0B,GAAG,CAAC,CAAC;EACzC,GAAG;;EAEH,EAAE,IAAI,CAAC,GAAG,CAAC,EAAE;EACb,IAAI,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;EAC5B,IAAI,IAAI,QAAQ,EAAE;EAClB,MAAM,MAAM,CAAC,QAAQ,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;EAC3C,KAAK,MAAM,IAAI,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE;EACtC,MAAM,MAAM,CAAC,QAAQ,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;EAClC,KAAK,MAAM;EACX,MAAM,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;EAChC,KAAK;EACL,GAAG,MAAM;EACT,IAAI,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;EAC5B,GAAG;EACH,EAAE,IAAI,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;EACrC,IAAI,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC;EAC1B,IAAI,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,EAAC;EAC1C,GAAG;EACH,EAAE,IAAI,MAAM,IAAI,IAAI,EAAE,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC;EAC7C,EAAE,IAAI,QAAQ,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,QAAQ,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;EACjD,EAAE,IAAI,QAAQ,CAAC,CAAC,CAAC,EAAE,MAAM,CAAC,QAAQ,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;;EAEjD,EAAE,OAAO,MAAM,CAAC;EAChB,CAAC;;EAED,SAAS,aAAa,CAAC,CAAC,EAAE;EAC1B,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;EACzB,EAAE,IAAI,CAAC,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE,MAAM,CAAC,CAAC;EACzC,EAAE,OAAO,CAAC,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE;EAC3B,IAAI,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;EACf,IAAI,IAAI,CAAC,KAAK,CAAC,EAAE,MAAM,CAAC,CAAC;EACzB,IAAI,OAAO,CAAC,CAAC;EACb,GAAG,CAAC,CAAC;EACL,CAAC;;EC7MM,SAAS,aAAa,CAAC,CAAC,EAAE;EACjC,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;EACzB,CAAC;AACD,EAAO,SAAS,aAAa,CAAC,KAAK,EAAE;EACrC,IAAI,OAAO,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;EAC3B,CAAC;AACD,EAAO,SAAS,sBAAsB,CAAC,MAAM,EAAE;EAC/C,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;EAC1B,QAAQ,OAAO,QAAQ,IAAI,MAAM,IAAI,EAAE,MAAM,IAAI,MAAM,CAAC,CAAC;EACzD,KAAK;EACL,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;AACD,EAAO,SAAS,qBAAqB,CAAC,MAAM,EAAE;EAC9C,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;EAC1B,QAAQ,OAAO,QAAQ,IAAI,MAAM,IAAI,MAAM,IAAI,MAAM,CAAC;EACtD,KAAK;EACL,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;AACD,EAAO,SAAS,eAAe,CAAC,MAAM,EAAE;EACxC,IAAI,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;EAC1B,QAAQ,OAAO,OAAO,IAAI,MAAM,IAAI,MAAM,IAAI,MAAM,CAAC;EACrD,KAAK;EACL,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;AACD,EAMA,IAAI,oBAAoB,GAAG;EAC3B,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,WAAW,EAAE,CAAC;EAClB,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,SAAS,EAAE,CAAC;EAChB,IAAI,WAAW,EAAE,CAAC;EAClB,IAAI,aAAa,EAAE,CAAC;EACpB,IAAI,UAAU,EAAE,CAAC;EACjB,IAAI,gBAAgB,EAAE,CAAC;EACvB,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,WAAW,EAAE,CAAC;EAClB,IAAI,OAAO,EAAE,CAAC;EACd,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,QAAQ,EAAE,CAAC;EACf,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,EAAE,EAAE,CAAC;EACT,IAAI,EAAE,EAAE,CAAC;EACT,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,KAAK,EAAE,CAAC;EACZ,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,QAAQ,EAAE,CAAC;EACf,IAAI,UAAU,EAAE,CAAC;EACjB,IAAI,SAAS,EAAE,CAAC;EAChB,IAAI,MAAM,EAAE,CAAC;EACb,IAAI,IAAI,EAAE,CAAC;EACX,CAAC,CAAC;AACF,EAAO,IAAI,eAAe,GAAG,QAAQ,CAAC,oBAAoB,CAAC,CAAC;;EC1D5D,SAAS,aAAa,CAACC,QAAK,EAAE,MAAM,EAAE;EACtC,IAAI,IAAI,OAAO,CAACA,QAAK,CAAC,EAAE;EACxB,QAAQ,OAAOA,QAAK,CAAC,GAAG,CAAC,UAAU,QAAQ,EAAE,EAAE,OAAOC,KAAa,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACrG,KAAK;EACL,IAAI,OAAOD,QAAK,CAAC;EACjB,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,EAAE;EAC1D,IAAI,IAAI,GAAG,KAAK,KAAK,CAAC,EAAE,EAAE,GAAG,GAAG,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC,EAAE;EACpD,IAAI,IAAI,EAAE,GAAG,QAAQ,CAAC,OAAO,EAAE,EAAE,MAAM,GAAG,EAAE,CAAC,MAAM,EAAE,KAAK,GAAG,EAAE,CAAC,KAAK,EAAEA,QAAK,GAAG,EAAE,CAAC,KAAK,EAAE,MAAM,GAAG,EAAE,CAAC,MAAM,EAAE,IAAI,GAAGhB,MAAc,CAAC,EAAE,EAAE,CAAC,QAAQ,EAAE,OAAO,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC,CAAC;EAC/K;EACA,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,UAAUF,MAAG,EAAE;EACtC,QAAQ,IAAI,QAAQ,GAAG,kBAAkB,CAACA,MAAG,CAAC,CAAC;EAC/C,QAAQ,IAAI,QAAQ,IAAI,QAAQ,KAAK,IAAI,IAAI,QAAQ,KAAK,MAAM,EAAE;EAClE,YAAY,OAAO,IAAI,CAACA,MAAG,CAAC,CAAC;EAC7B,SAAS;EACT,KAAK,CAAC,CAAC;EACP,IAAI,IAAI,IAAI,KAAK,MAAM,EAAE;EACzB,QAAQ,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;EACxB,YAAY,OAAO,SAAS,CAAC;EAC7B,SAAS;EACT;EACA,QAAQ,IAAI,IAAI,CAAC,MAAM,EAAE;EACzB;EACA,YAAY,IAAI,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC;EACxC,YAAY,IAAI,CAAC,MAAM,GAAGH,QAAgB,CAAC,EAAE,GAAG,IAAI,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,EAAE,CAAC;EAC7E,YAAY,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE;EAChD,gBAAgB,OAAO,IAAI,CAAC,MAAM,CAAC;EACnC,aAAa;EACb,SAAS;EACT,QAAQ,OAAOA,QAAgB,CAAC,EAAE,KAAK,EAAE,KAAK;EAC9C,YAAY,MAAM,EAAE,MAAM,EAAE,EAAE,IAAI,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,KAAK;EAClE;EACA;EACA,YAAY,SAAS,EAAE,CAAC,EAAE,SAAS,EAAE,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,KAAK,SAAS,GAAG,MAAM,GAAG,CAAC;EAC/F,UAAU,CAAC,CAAC;EACZ,KAAK;EACL,SAAS;EACT,QAAQ,IAAI,CAAC,GAAG,CAAC,MAAM,IAAI,QAAQ,CAAC,aAAa,EAAE;EACnD;EACA,YAAY,OAAO,SAAS,CAAC;EAC7B,SAAS;EACT;EACA,QAAQ,IAAI,IAAI,CAAC,MAAM,EAAE;EACzB,YAAY,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,YAAY,GAAG,UAAU,EAAE,EAAE,GAAG,YAAY,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACxF,gBAAgB,IAAI,IAAI,GAAG,YAAY,CAAC,EAAE,CAAC,CAAC;EAC5C,gBAAgB,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE;EACjD,oBAAoB,OAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;EAC7C,iBAAiB;EACjB,aAAa;EACb,YAAY,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE;EAChD,gBAAgB,OAAO,IAAI,CAAC,MAAM,CAAC;EACnC,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,WAAW,GAAG,aAAa,CAACqB,QAAK,EAAE,MAAM,CAAC,CAAC;EACvD,QAAQ,OAAOrB,QAAgB,CAAC,EAAE,KAAK,EAAE,KAAK;EAC9C,YAAY,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,WAAW,GAAG,EAAE,KAAK,EAAE,WAAW,EAAE,GAAG,EAAE,GAAG,IAAI,EAAE,EAAE,MAAM,EAAE,MAAM,KAAK,SAAS,GAAG,MAAM,GAAG,CAAC;EACzI,UAAU,CAAC,CAAC;EACZ,KAAK;EACL,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,cAAc,EAAE,MAAM,EAAE;EACrD,IAAI,IAAI,EAAE,GAAG,cAAc,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,KAAK,KAAK,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,GAAG,cAAc,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,KAAK,KAAK,CAAC,GAAG,EAAE,GAAG,EAAE,CAAC;EAC/G,IAAI,OAAO,CAAC,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,YAAY,CAAC,CAAC,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,YAAY,CAAC,CAAC,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,YAAY,CAAC,CAAC,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,YAAY,CAAC,CAAC,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC;EACxT,CAAC;;ECvDD;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,SAAS,CAAC,OAAO,EAAE,UAAU,EAAE,SAAS,EAAE,KAAK,EAAE,KAAK,EAAE,UAAU,EAAE;EACpF,IAAI,IAAI,UAAU,CAAC,UAAU,CAAC,IAAI,KAAK,IAAI,OAAO,KAAK,KAAK,CAAC,YAAY,EAAE;EAC3E;EACA,QAAQ,OAAO,QAAQ,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC,CAAC;EAClE,KAAK;EACL,IAAI,OAAO,QAAQ,CAAC,OAAO,EAAE,UAAU,EAAE,SAAS,EAAE,KAAK,EAAE,KAAK,EAAE,UAAU,CAAC,CAAC;EAC9E,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,UAAU,CAAC,OAAO,EAAE,SAAS,EAAE,UAAU,EAAE,SAAS,EAAE,KAAK,EAAE,KAAK,EAAE,UAAU,EAAE;EAChG,IAAI,IAAI,UAAU,CAAC,SAAS,CAAC,IAAI,KAAK;EACtC;EACA,QAAQ,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE;EAC5D,QAAQ,OAAO,QAAQ,CAAC,SAAS,EAAE,SAAS,EAAE,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC,CAAC;EACnE,KAAK;EACL,IAAI,OAAO,QAAQ,CAAC,OAAO,EAAE,UAAU,EAAE,SAAS,EAAE,KAAK,EAAE,KAAK,EAAE,UAAU,CAAC,CAAC;EAC9E,CAAC;AACD,EAAO,SAAS,SAAS,CAAC,OAAO,EAAE,OAAO,EAAE;EAC5C,IAAI,IAAI,aAAa,GAAG,OAAO,GAAG,QAAQ,CAAC;EAC3C;EACA,IAAI,IAAI,kBAAkB,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;EACpD,IAAI,IAAI,kBAAkB,EAAE;EAC5B,QAAQ,OAAO,kBAAkB,CAAC;EAClC,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;EACD;EACA;EACA;AACA,EAAO,SAASuB,KAAG,CAAC,QAAQ,EAAE,SAAS,EAAE,IAAI,EAAE,MAAM,EAAE;EACvD,IAAI,IAAI,SAAS,GAAG,IAAI,KAAK,OAAO,GAAG,SAAS,GAAG,KAAK,CAAC;EACzD,IAAI,OAAO,QAAQ,CAAC,QAAQ,EAAE,SAAS,EAAE,EAAE,SAAS,EAAE,SAAS,EAAE,EAAE,MAAM,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;EACrG,CAAC;AACD,EAAO,SAAS,QAAQ,CAAC,QAAQ,EAAE,SAAS,EAAE,GAAG,EAAE,MAAM,EAAE;EAC3D,IAAI,IAAI,GAAG,GAAGvB,QAAgB,CAAC,EAAE,GAAG,SAAS,GAAG,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,EAAE,CAAC,CAAC;EAC/G,IAAI,IAAI,MAAM,EAAE;EAChB,QAAQ,OAAOA,QAAgB,CAAC,EAAE,EAAE,GAAG,EAAE,MAAM,CAAC,CAAC;EACjD,KAAK;EACL,IAAI,OAAO,GAAG,CAAC;EACf,CAAC;AACD,EAAO,SAAS,OAAO,CAAC,SAAS,EAAE,IAAI,EAAE;EACzC,IAAI,IAAI,IAAI,KAAK,KAAK,CAAC,EAAE,EAAE,IAAI,GAAG,IAAI,CAAC,EAAE;EACzC,IAAI,OAAO;EACX,QAAQ,KAAK,EAAE,SAAS;EACxB,QAAQ,IAAI,EAAE,IAAI;EAClB,KAAK,CAAC;EACN,CAAC;EACD;EACA;EACA;EACA,SAAS,YAAY,CAAC,QAAQ,EAAE,SAAS,EAAE;EAC3C,IAAI,OAAO;EACX,QAAQ,MAAM,EAAE,GAAG;EACnB,aAAa,UAAU,GAAG,SAAS,GAAG,MAAM,GAAG,OAAO,CAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,GAAG,GAAG,CAAC;EAC1F,YAAY,KAAK;EACjB,aAAa,UAAU,GAAG,SAAS,GAAG,MAAM,GAAG,OAAO,CAAC,QAAQ,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,GAAG,GAAG,CAAC;EAC5G,YAAY,KAAK;EACjB,KAAK,CAAC;EACN,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,QAAQ,CAAC,OAAO,EAAE,UAAU,EAAE,SAAS,EAAE,KAAK,EAAE,KAAK,EAAE,UAAU,EAAE;EACnF;EACA,IAAI,IAAI,UAAU,EAAE;EACpB;EACA,QAAQ,IAAI,UAAU,CAAC,UAAU,CAAC,EAAE;EACpC,YAAY,IAAI,UAAU,CAAC,GAAG,EAAE;EAChC;EACA;EACA,gBAAgB,IAAI,QAAQ,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,OAAO,CAAC,IAAI,UAAU,CAAC,IAAI,KAAK,YAAY,EAAE;EACnF,oBAAoB,IAAI,KAAK,IAAI,KAAK,CAAC,MAAM,EAAE;EAC/C;EACA,wBAAwB,OAAO,QAAQ,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC;EACrF,qBAAqB;EACrB;EACA,oBAAoB,OAAO,YAAY,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;EAC/D,iBAAiB;EACjB,gBAAgB,OAAO,QAAQ,CAAC,UAAU,EAAE,SAAS,EAAE,gBAAgB,CAAC,UAAU,EAAE,OAAO,CAAC,GAAG,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,EAAE,CAAC,CAAC;EAC5H,aAAa;EACb,YAAY,IAAI,KAAK,EAAE;EACvB,gBAAgB,IAAI,SAAS,GAAG,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAClD,gBAAgB,IAAI,iBAAiB,CAAC,SAAS,CAAC,EAAE;EAClD,oBAAoB,IAAI,SAAS,KAAK,MAAM,EAAE;EAC9C;EACA,wBAAwB,OAAO,QAAQ,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE,SAAS,EAAE,OAAO,EAAE,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,CAAC;EACtG,qBAAqB;EACrB,oBAAoB,OAAO,QAAQ,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE,SAAS,EAAE,OAAO,EAAE,CAAC,CAAC;EACnF,iBAAiB;EACjB,aAAa;EACb,YAAY,OAAO,QAAQ,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE,CAAC,CAAC;EACvD,SAAS;EACT,aAAa,IAAI,UAAU,CAAC,UAAU,CAAC,EAAE;EACzC,YAAY,IAAI,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC;EACzC,YAAY,IAAI,QAAQ,CAAC,CAAC,GAAG,EAAE,IAAI,CAAC,EAAE,OAAO,CAAC,IAAI,KAAK,KAAK,OAAO,EAAE;EACrE,gBAAgB,OAAO,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,EAAE,CAAC;EACrD,aAAa;EACb,iBAAiB,IAAI,QAAQ,CAAC,CAAC,GAAG,EAAE,IAAI,CAAC,EAAE,OAAO,CAAC,IAAI,KAAK,KAAK,QAAQ,EAAE;EAC3E,gBAAgB,OAAO,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,QAAQ,EAAE,EAAE,CAAC;EACtD,aAAa;EACb,YAAY,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;EACpC,SAAS;EACT;EACA;EACA,KAAK;EACL,IAAI,OAAO,UAAU,CAAC;EACtB,CAAC;AACD,EAAO,SAASwB,MAAI,CAAC,OAAO,EAAE,MAAM,EAAE;EACtC;EACA,IAAI,IAAI,OAAO,EAAE;EACjB,QAAQ,IAAI,UAAU,CAAC,OAAO,CAAC,EAAE;EACjC,YAAY,OAAO,eAAe,CAAC,OAAO,EAAE,OAAO,CAAC,MAAM,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;EAC7E,SAAS;EACT,aAAa,IAAI,UAAU,CAAC,OAAO,CAAC,EAAE;EACtC,YAAY,OAAO,EAAE,KAAK,EAAE,OAAO,CAAC,KAAK,EAAE,CAAC;EAC5C,SAAS;EACT,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;AACD,EAAO,SAAS,GAAG,CAAC,OAAO,EAAE;EAC7B,IAAI,OAAOxB,QAAgB,CAAC,EAAE,EAAE,OAAO,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,CAAC;EACxD,CAAC;EACD;EACA;EACA;EACA,SAAS,2BAA2B,CAAC,KAAK,EAAE;EAC5C,IAAI,IAAI,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,KAAK,EAAE;EACrC,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,IAAI,IAAI,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC;EAChC,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,EAAE;EAC1B,QAAQ,OAAO,IAAI,CAAC,OAAO,EAAE,UAAU,CAAC,EAAE,EAAE,OAAO,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;EAC9G,KAAK;EACL,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;AACD,EAAO,SAAS,aAAa,CAAC,UAAU,EAAE,OAAO,EAAE,SAAS,EAAE,KAAK,EAAE,IAAI,EAAE;EAC3E,IAAI,IAAI,QAAQ,CAAC,UAAU,CAAC,EAAE;EAC9B,QAAQ,IAAI,SAAS,EAAE;EACvB,YAAY,IAAI,SAAS,GAAG,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAC9C,YAAY,IAAI,QAAQ,CAAC,CAAC,SAAS,CAAC,GAAG,EAAE,SAAS,CAAC,IAAI,EAAE,SAAS,CAAC,GAAG,CAAC,EAAE,SAAS,CAAC,EAAE;EACrF;EACA;EACA;EACA;EACA,gBAAgB,IAAI,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,MAAM,EAAE;EACvD,oBAAoBQ,IAAQ,CAACC,OAAW,CAAC,8BAA8B,CAAC,IAAI,EAAE,OAAO,EAAE,EAAE,SAAS,EAAE,SAAS,EAAE,CAAC,CAAC,CAAC;EAClH,iBAAiB;EACjB,aAAa;EACb,iBAAiB;EACjB,gBAAgB,IAAI,2BAA2B,CAAC,KAAK,CAAC,EAAE;EACxD,oBAAoB,OAAO;EAC3B,wBAAwB,KAAK,EAAE,SAAS;EACxC,wBAAwB,KAAK,EAAE,CAAC;EAChC,qBAAqB,CAAC;EACtB,iBAAiB;EACjB,gBAAgB,IAAI,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,MAAM,EAAE;EACvD,oBAAoBD,IAAQ,CAACC,OAAW,CAAC,8BAA8B,CAAC,IAAI,EAAE,OAAO,EAAE,EAAE,SAAS,EAAE,KAAK,CAAC,QAAQ,CAAC,IAAI,KAAK,KAAK,EAAE,CAAC,CAAC,CAAC;EACtI,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,UAAU,KAAK,WAAW,EAAE;EACxC,YAAY,OAAO,OAAO,KAAK,GAAG,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,QAAQ,EAAE,EAAE,CAAC;EACnF,SAAS;EACT,aAAa;EACb,YAAY,OAAO,OAAO,KAAK,GAAG,GAAG,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC;EAClF,SAAS;EACT,KAAK;EACL,IAAI,OAAO,UAAU,CAAC;EACtB,CAAC;;EC/KM,SAAS,KAAK,CAAC,KAAK,EAAE,GAAG,EAAE;EAClC,IAAI,IAAI,EAAE,EAAE,EAAE,CAAC;EACf,IAAI,IAAI,GAAG,KAAK,KAAK,CAAC,EAAE,EAAE,GAAG,GAAG,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,EAAE;EACvD,IAAI,IAAI,OAAO,GAAG,KAAK,CAAC,OAAO,EAAE,QAAQ,GAAG,KAAK,CAAC,QAAQ,EAAE,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;EAClF,IAAI,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,EAAE,QAAQ,GAAG,OAAO,CAAC,IAAI,CAAC;EACzD,IAAI,IAAI,WAAW,GAAG;EACtB,QAAQ,IAAI,EAAE,aAAa,CAAC,MAAM,EAAE,OAAO,EAAE,MAAM,CAAC;EACpD,QAAQ,MAAM,EAAE,aAAa,CAAC,QAAQ,EAAE,OAAO,EAAE,MAAM,CAAC;EACxD,QAAQ,KAAK,EAAE,aAAa,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC;EACtD,KAAK,CAAC;EACN,IAAI,IAAI,mBAAmB,GAAG,QAAQ,CAAC,CAAC,KAAK,EAAE,OAAO,EAAE,QAAQ,EAAE,QAAQ,EAAE,UAAU,CAAC,EAAE,QAAQ,CAAC,GAAG,aAAa,GAAG,SAAS,CAAC;EAC/H,IAAI,IAAI,YAAY,GAAG;EACvB,QAAQ,IAAI,EAAE,OAAO,CAAC,IAAI,IAAI,WAAW,CAAC,IAAI;EAC9C;EACA;EACA,YAAY,mBAAmB;EAC/B,QAAQ,MAAM,EAAE,OAAO,CAAC,MAAM,IAAI,WAAW,CAAC,MAAM;EACpD,KAAK,CAAC;EACN,IAAI,IAAI,cAAc,GAAG,MAAM,GAAG,MAAM,GAAG,QAAQ,CAAC;EACpD,IAAI,IAAI,0BAA0B,GAAGT,QAAgB,CAAC,EAAE,GAAG,YAAY,CAAC,IAAI,GAAG;EAC/E,QAAQ,IAAI,EAAE,EAAE,KAAK,EAAE,YAAY,CAAC,IAAI,EAAE;EAC1C,KAAK,GAAG,EAAE,IAAI,YAAY,CAAC,MAAM,GAAG;EACpC,QAAQ,MAAM,EAAE,EAAE,KAAK,EAAE,YAAY,CAAC,MAAM,EAAE;EAC9C,KAAK,GAAG,EAAE,EAAE,CAAC;EACb,IAAI,IAAI,QAAQ,CAAC,IAAI,IAAI,QAAQ,CAAC,MAAM,EAAE;EAC1C;EACA,QAAQ,IAAI,OAAO,CAAC,KAAK,EAAE;EAC3B;EACA,YAAYQ,IAAQ,CAACC,OAAW,CAAC,aAAa,CAAC,UAAU,EAAE,EAAE,IAAI,EAAE,MAAM,IAAI,QAAQ,EAAE,MAAM,EAAE,QAAQ,IAAI,QAAQ,EAAE,CAAC,CAAC,CAAC;EACxH,SAAS;EACT,QAAQ,OAAOT,QAAgB,CAAC,EAAE,EAAE,WAAW,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE,YAAY,EAAE,YAAY,CAAC,IAAI,IAAI,mBAAmB,EAAE,CAAC,EAAE,WAAW,CAAC,QAAQ,EAAE,KAAK,EAAE,EAAE,YAAY,EAAE,YAAY,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;EACjM,KAAK;EACL,SAAS,IAAI,QAAQ,CAAC,KAAK,EAAE;EAC7B,QAAQ,OAAOA,QAAgB,CAAC,EAAE,EAAE,0BAA0B,EAAE,WAAW,CAAC,OAAO,EAAE,KAAK,EAAE;EAC5F,YAAY,SAAS,EAAE,cAAc;EACrC;EACA,YAAY,YAAY,EAAE,OAAO,CAAC,cAAc,CAAC,IAAI,OAAO,CAAC,KAAK,IAAI,WAAW,CAAC,cAAc,CAAC,IAAI,WAAW,CAAC,KAAK,KAAK,MAAM,GAAG,mBAAmB,GAAG,SAAS,CAAC;EACpK,SAAS,CAAC,CAAC,CAAC;EACZ,KAAK;EACL,SAAS,IAAI,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,MAAM,EAAE;EAC7C;EACA,QAAQ,IAAI,OAAO,CAAC,KAAK,EAAE;EAC3B,YAAYQ,IAAQ,CAACC,OAAW,CAAC,aAAa,CAAC,UAAU,EAAE,EAAE,IAAI,EAAE,MAAM,IAAI,OAAO,EAAE,MAAM,EAAE,QAAQ,IAAI,OAAO,EAAE,CAAC,CAAC,CAAC;EACtH,SAAS;EACT,QAAQ,OAAO,0BAA0B,CAAC;EAC1C,KAAK;EACL,SAAS,IAAI,OAAO,CAAC,KAAK,EAAE;EAC5B,QAAQ,OAAOT,QAAgB,CAAC,EAAE,EAAE,0BAA0B,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,cAAc,CAAC,GAAG,EAAE,KAAK,EAAE,OAAO,CAAC,KAAK,EAAE,EAAE,EAAE,EAAE,CAAC;EAC9H,KAAK;EACL,SAAS,IAAI,WAAW,CAAC,IAAI,IAAI,WAAW,CAAC,MAAM,EAAE;EACrD;EACA,QAAQ,OAAO,0BAA0B,CAAC;EAC1C,KAAK;EACL,SAAS,IAAI,WAAW,CAAC,KAAK,EAAE;EAChC,QAAQ,OAAOA,QAAgB,CAAC,EAAE,GAAG,mBAAmB,GAAG,EAAE,IAAI,EAAE,EAAE,KAAK,EAAE,aAAa,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,cAAc,CAAC,GAAG,EAAE,KAAK,EAAE,WAAW,CAAC,KAAK,EAAE,EAAE,EAAE,EAAE,CAAC;EACvK,KAAK;EACL,IAAI,OAAO,EAAE,CAAC;EACd,CAAC;AACD,EAAO,SAAS,eAAe,CAAC,KAAK,EAAE,MAAM,EAAE;EAC/C,IAAI,OAAOA,QAAgB,CAAC,EAAE,EAAE,iBAAiB,CAAC,KAAK,CAAC,OAAO,EAAE,MAAM,CAAC,EAAE,KAAK,CAAC,KAAK,CAAC,EAAE,WAAW,CAAC,SAAS,EAAE,KAAK,CAAC,EAAE,OAAO,CAAC,KAAK,CAAC,EAAEwB,MAAI,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC,CAAC;EAC5J,CAAC;EACD,SAAS,iBAAiB,CAAC,IAAI,EAAE,MAAM,EAAE;EACzC,IAAI,OAAO,eAAe,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,IAAI,EAAE;EACrD,QAAQ,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,SAAS,IAAI,MAAM,CAAC,IAAI,CAAC,KAAK,QAAQ,EAAE;EACnE,YAAY,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;EAC5C,SAAS;EACT,QAAQ,OAAO,CAAC,CAAC;EACjB,KAAK,EAAE,EAAE,CAAC,CAAC;EACX,CAAC;AACD,EAAO,SAAS,cAAc,CAAC,IAAI,EAAE,KAAK,EAAE;EAC5C,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,IAAI,KAAK,KAAK,SAAS,EAAE;EAC7B,QAAQ,OAAO,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC;EACxD,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;EACD,SAAS,cAAc,CAAC,KAAK,EAAE;EAC/B,IAAI,OAAO,KAAK,GAAG,sBAAsB,GAAG,KAAK,GAAG,GAAG,CAAC;EACxD,CAAC;AACD,EAAO,SAAS,OAAO,CAAC,KAAK,EAAE;EAC/B,IAAI,IAAI,KAAK,CAAC,MAAM,CAAC,aAAa,KAAK,QAAQ,EAAE;EACjD,QAAQ,IAAI,MAAM,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,UAAU,OAAO,EAAE;EACvD,YAAY,IAAI,cAAc,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;EAClE,YAAY,IAAI,cAAc,EAAE;EAChC,gBAAgB,IAAI,SAAS,GAAG,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAC3D;EACA,gBAAgB,IAAI,mBAAmB,CAAC,SAAS,CAAC,EAAE;EACpD,oBAAoB,OAAO,KAAK,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;EACrE,iBAAiB;EACjB,aAAa;EACb,YAAY,OAAO,SAAS,CAAC;EAC7B,SAAS,CAAC;EACV,aAAa,MAAM,CAAC,UAAUjB,QAAK,EAAE,EAAE,OAAO,CAAC,CAACA,QAAK,CAAC,EAAE,CAAC;EACzD,aAAa,GAAG,CAAC,cAAc,CAAC,CAAC;EACjC,QAAQ,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;EAC/B,YAAY,OAAO;EACnB,gBAAgB,OAAO,EAAE,EAAE,MAAM,EAAE,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;EACxD,aAAa,CAAC;EACd,SAAS;EACT,KAAK;EACL,IAAI,OAAO,EAAE,CAAC;EACd,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,WAAW,CAAC,OAAO,EAAE,KAAK,EAAE,GAAG,EAAE;EACjD,IAAI,IAAI,GAAG,KAAK,KAAK,CAAC,EAAE,EAAE,GAAG,GAAG,EAAE,CAAC,EAAE;EACrC,IAAI,IAAI,YAAY,GAAG,GAAG,CAAC,YAAY,EAAE,SAAS,GAAG,GAAG,CAAC,SAAS,CAAC;EACnE,IAAI,IAAI,UAAU,GAAG,GAAG,CAAC,UAAU,KAAK,YAAY,KAAK,SAAS,GAAG,EAAE,KAAK,EAAE,YAAY,EAAE,GAAG,SAAS,CAAC,CAAC;EAC1G,IAAI,IAAI,UAAU,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC7C,IAAI,OAAO,aAAa,CAAC,KAAK,EAAE,UAAU,EAAE,SAAS,IAAI,OAAO,EAAE,UAAU,IAAI,EAAE;EAClF,QAAQ,OAAOkB,QAAY,CAAC,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,EAAE,IAAI;EAC3G,QAAQ,UAAU,CAAC,CAAC;EACpB,KAAK,CAAC,CAAC;EACP,CAAC;EACD;EACA;EACA;EACA;AACA,EAAO,SAAS,aAAa,CAAC,KAAK,EAAE,UAAU,EAAE,SAAS,EAAE,KAAK,EAAE;EACnE,IAAI,IAAI,EAAE,EAAE,EAAE,CAAC;EACf,IAAI,IAAI,SAAS,GAAG,UAAU,IAAI,UAAU,CAAC,SAAS,CAAC;EACvD,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,UAAU,CAAC,CAAC;EACrC,IAAI,IAAI,SAAS,EAAE;EACnB,QAAQ,IAAI,UAAU,GAAG,OAAO,CAAC,SAAS,CAAC,GAAG,SAAS,GAAG,CAAC,SAAS,CAAC,CAAC;EACtE,QAAQ,IAAI,YAAY,GAAG,UAAU,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;EACvD,YAAY,IAAI,iBAAiB,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;EAC7C,YAAY,IAAI,IAAI,GAAG,sBAAsB,CAAC,CAAC,CAAC,GAAG,kBAAkB,CAAC,KAAK,EAAE,CAAC,CAAC,SAAS,CAAC,GAAG,UAAU,CAAC,KAAK,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC;EACtH,YAAY,OAAOzB,QAAgB,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,iBAAiB,CAAC,CAAC;EACvE,SAAS,CAAC,CAAC;EACX,QAAQ,OAAO,EAAE,GAAG,EAAE;EACtB,YAAY,EAAE,CAAC,SAAS,CAAC,GAAG,YAAY,CAAC,MAAM,EAAE,QAAQ,KAAK,SAAS,GAAG,CAAC,QAAQ,CAAC,GAAG,EAAE,EAAE;EAC3F,YAAY,EAAE,CAAC;EACf,KAAK;EACL,SAAS;EACT,QAAQ,OAAO,QAAQ,KAAK,SAAS,IAAI,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,SAAS,CAAC,GAAG,QAAQ,EAAE,EAAE,IAAI,EAAE,CAAC;EACrF,KAAK;EACL,CAAC;AACD,EAAO,SAAS,OAAO,CAAC,KAAK,EAAE;EAC/B,IAAI,IAAI,OAAO,GAAG,SAAS,CAAC;EAC5B,IAAI,IAAI,UAAU,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC7C,IAAI,IAAI,OAAO,CAAC,UAAU,CAAC,EAAE;EAC7B,QAAQ,IAAI,SAAS,GAAG,UAAU,CAAC,GAAG,CAAC,UAAU,QAAQ,EAAE;EAC3D,YAAY,IAAIG,MAAG,GAAG,QAAQ,CAAC,KAAK,KAAK,SAAS,GAAG,QAAQ,CAAC,KAAK,GAAG,OAAO,CAAC,QAAQ,EAAE,EAAE,SAAS,EAAE,OAAO,EAAE,CAAC,CAAC;EAChH,YAAY,IAAI,KAAK,GAAGuB,MAAQ,CAAC,QAAQ,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC;EAChE,YAAY,OAAO,IAAI,GAAGvB,MAAG,GAAG,MAAM,GAAG,KAAK,CAAC;EAC/C,SAAS,CAAC,CAAC;EACX,QAAQ,OAAO,EAAE,OAAO,EAAE,EAAE,MAAM,EAAE,GAAG,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,EAAE,EAAE,CAAC;EACzE,KAAK;EACL,SAAS;EACT;EACA,QAAQ,OAAO,UAAU,CAAC,KAAK,EAAE,OAAO,EAAE,UAAU,CAAC,CAAC;EACtD,KAAK;EACL,CAAC;AACD,EAAO,SAASqB,MAAI,CAAC,KAAK,EAAE,OAAO,EAAE;EACrC,IAAI,IAAI,OAAO,KAAK,KAAK,CAAC,EAAE,EAAE,OAAO,GAAG,MAAM,CAAC,EAAE;EACjD,IAAI,IAAI,UAAU,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC7C,IAAI,OAAO,UAAU,CAAC,KAAK,EAAE,OAAO,EAAE,UAAU,CAAC,CAAC;EAClD,CAAC;EACD,SAAS,UAAU,CAAC,KAAK,EAAE,OAAO,EAAE,UAAU,EAAE;EAChD,IAAI,OAAO,aAAa,CAAC,KAAK,EAAE,UAAU,EAAE,OAAO,EAAE,UAAU,IAAI,EAAE,EAAE,OAAOE,MAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC;EAC/G,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,QAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;EACvD,IAAI,IAAI,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;EACnB,IAAI,IAAI,SAAS,GAAG,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;EAC7C,IAAI,IAAI,WAAW,GAAG,OAAO,KAAK,GAAG,GAAG,OAAO,GAAG,QAAQ,CAAC;EAC3D,IAAI,IAAI,KAAK,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,KAAK,SAAS,EAAE;EACjE,QAAQ,IAAI,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC;EAC1C,QAAQ,IAAI,MAAM,EAAE;EACpB,YAAY,IAAI,0BAA0B,IAAI,EAAE,GAAG,EAAE;EACrD;EACA;EACA,gBAAgB,EAAE,CAAC,OAAO,GAAG,GAAG,CAAC,GAAGC,QAAY,CAAC,QAAQ,EAAE,SAAS,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC;EACxF,gBAAgB,EAAE,CAAC,CAAC;EACpB,YAAY,IAAI,WAAW,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;EAClD,gBAAgB,OAAO3B,QAAgB,CAAC,EAAE,EAAE,0BAA0B,EAAE,WAAW,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE,SAAS,EAAE,WAAW,EAAE,CAAC,CAAC,CAAC;EAChI,aAAa;EACb,iBAAiB,IAAI,UAAU,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;EACtD,gBAAgB,OAAOA,QAAgB,CAAC,EAAE,EAAE,0BAA0B,EAAE,WAAW,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE,SAAS,EAAE,WAAW,EAAE,CAAC,CAAC,CAAC;EAChI,aAAa;EACb,iBAAiB,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,KAAK,SAAS,EAAE;EACvD,gBAAgB,OAAOA,QAAgB,CAAC,EAAE,EAAE,0BAA0B,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,WAAW,CAAC,GAAG,EAAE,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,EAAE,EAAE,CAAC;EACxI,aAAa;EACb,SAAS;EACT,aAAa;EACb,YAAYQ,IAAQ,CAACC,OAAW,CAAC,gCAAgC,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;EACvF,SAAS;EACT,KAAK;EACL,IAAI,OAAO,EAAE,GAAG,EAAE;EAClB,QAAQ,EAAE,CAAC,OAAO,CAAC,GAAGkB,QAAY,CAAC,QAAQ,EAAE,SAAS,EAAE,EAAE,SAAS,EAAE,OAAO,EAAE,CAAC;EAC/E,QAAQ,EAAE,CAAC,WAAW,CAAC,GAAGC,OAAW,CAAC,SAAS,CAAC;EAChD,QAAQ,EAAE,CAAC;EACX,CAAC;AACD,EAAO,SAAS,oBAAoB,CAAC,OAAO,EAAE,KAAK,EAAE,aAAa,EAAE,cAAc,EAAE;EACpF,IAAI,IAAI,aAAa,GAAG,OAAO,KAAK,GAAG,GAAG,IAAI,GAAG,IAAI,CAAC;EACtD,IAAI,IAAI,WAAW,GAAG,OAAO,KAAK,GAAG,GAAG,OAAO,GAAG,QAAQ,CAAC;EAC3D,IAAI,OAAO5B,QAAgB,CAAC,EAAE,EAAE,aAAa,CAAC,OAAO,EAAE,KAAK,EAAE,aAAa,EAAE,aAAa,CAAC,EAAE,WAAW,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE,UAAU,EAAE,cAAc,EAAE,SAAS,EAAE,WAAW,EAAE,CAAC,CAAC,CAAC;EACjL,CAAC;AACD,EAAO,SAAS,cAAc,CAAC,QAAQ,EAAE,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,OAAO,EAAE;EAC/E,IAAI,IAAI,OAAO,KAAK,GAAG,EAAE;EACzB,QAAQ,OAAO;EACf,YAAY,EAAE,EAAE6B,KAAO,CAAC,QAAQ,EAAE,SAAS,EAAE,OAAO,EAAE,OAAO,GAAG,CAAC,GAAG,OAAO,CAAC;EAC5E,YAAY,CAAC,EAAEA,KAAO,CAAC,QAAQ,EAAE,SAAS,EAAE,KAAK,EAAE,OAAO,GAAG,OAAO,GAAG,CAAC,CAAC;EACzE,SAAS,CAAC;EACV,KAAK;EACL,SAAS;EACT,QAAQ,OAAO;EACf,YAAY,EAAE,EAAEA,KAAO,CAAC,QAAQ,EAAE,SAAS,EAAE,OAAO,EAAE,OAAO,GAAG,OAAO,GAAG,CAAC,CAAC;EAC5E,YAAY,CAAC,EAAEA,KAAO,CAAC,QAAQ,EAAE,SAAS,EAAE,KAAK,EAAE,OAAO,GAAG,CAAC,GAAG,OAAO,CAAC;EACzE,SAAS,CAAC;EACV,KAAK;EACL,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,aAAa,CAAC,OAAO,EAAE,KAAK,EAAE,UAAU,EAAE,SAAS,EAAE;EACrE;EACA,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,EAAE,IAAI,GAAG,KAAK,CAAC,IAAI,EAAE,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;EAC1E,IAAI,IAAI,UAAU,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;EACvC,IAAI,IAAI,SAAS,GAAG,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;EAC7C,IAAI,IAAI,KAAK,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;EACjD,IAAI,IAAI,MAAM,GAAGC,SAAa,CAAC,OAAO,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC;EACvD,IAAI,IAAI,QAAQ,GAAG,CAAC,UAAU,KAAK,QAAQ,CAAC,QAAQ,IAAI,QAAQ,CAAC,SAAS,CAAC;EAC3E;EACA,QAAQ,EAAE,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,GAAG9B,QAAgB,CAAC,EAAE,EAAE+B,SAAa,CAAC,OAAO,EAAE,QAAQ,CAAC,OAAO,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,KAAK,EAAEC,aAAiB,CAAC,UAAU,EAAE,OAAO,EAAE,SAAS,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC,GAAG,MAAM,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,EAAE,EAAE,CAAC;EACzO,IAAI,OAAO,EAAE,GAAG,EAAE;EAClB,QAAQ,EAAE,CAAC,SAAS,IAAI,OAAO,CAAC,GAAG,QAAQ;EAC3C,QAAQ,EAAE,CAAC;EACX,CAAC;EACD;EACA;EACA;EACA;AACA,EAAO,SAAS,cAAc,CAAC,KAAK,EAAE,UAAU,EAAE,OAAO,EAAE;EAC3D,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,EAAE,IAAI,GAAG,KAAK,CAAC,IAAI,EAAE,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;EAC1E,IAAI,IAAI,WAAW,GAAG,OAAO,KAAK,IAAI,GAAG,GAAG,GAAG,GAAG,CAAC;EACnD,IAAI,IAAI,UAAU,GAAG,QAAQ,CAAC,WAAW,CAAC,CAAC;EAC3C,IAAI,IAAI,SAAS,GAAG,KAAK,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;EACjD,IAAI,IAAI,KAAK,GAAG,KAAK,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC;EACrD,IAAI,IAAI,MAAM,GAAGF,SAAa,CAAC,OAAO,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC;EACvD,IAAI,IAAI,QAAQ,GAAG,CAAC,UAAU,KAAK,QAAQ,CAAC,QAAQ,IAAI,QAAQ,CAAC,SAAS,CAAC;EAC3E;EACA,QAAQ,EAAE,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,GAAG9B,QAAgB,CAAC,EAAE,EAAEiC,UAAc,CAAC,OAAO,EAAE,UAAU,EAAE,QAAQ,CAAC,OAAO,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,KAAK,EAAED,aAAiB,CAAC,UAAU,EAAE,WAAW,EAAE,SAAS,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC,GAAG,MAAM,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,EAAE,EAAE,CAAC;EAC1P,IAAI,OAAO,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,OAAO,CAAC,GAAG,QAAQ,EAAE,EAAE,CAAC;EAC/C,CAAC;;EC7OM,SAAS,eAAe,CAAC,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE;EACrD,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,WAAW,GAAG,SAAS,EAAE,EAAE,GAAG,WAAW,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC7E,QAAQ,IAAI,QAAQ,GAAG,WAAW,CAAC,EAAE,CAAC,CAAC;EACvC,QAAQ,IAAI,KAAK,GAAG,aAAa,CAAC,QAAQ,EAAE,KAAK,CAAC,OAAO,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;EACzE,QAAQ,IAAI,KAAK,KAAK,SAAS,EAAE;EACjC,YAAY,CAAC,CAAC,QAAQ,CAAC,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;EAC3C,SAAS;EACT,KAAK;EACL,IAAI,OAAO,CAAC,CAAC;EACb,CAAC;AACD,EAAO,SAAS,SAAS,CAAC,IAAI,EAAE;EAChC,IAAI,OAAO,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC;EAClD,CAAC;EACD;EACA;EACA;EACA;AACA,EAAO,SAAS,aAAa,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE;EAClD;EACA,IAAI,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EAClC;EACA,IAAI,IAAI,kBAAkB,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EAC/C,IAAI,IAAI,kBAAkB,CAAC,IAAI,CAAC,KAAK,SAAS,EAAE;EAChD,QAAQ,KAAK,GAAG,kBAAkB,CAAC,IAAI,CAAC,CAAC;EACzC,KAAK;EACL;EACA,IAAI,IAAI,MAAM,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC;EACjC,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,QAAQ,GAAG,MAAM,EAAE,EAAE,GAAG,QAAQ,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACpE,QAAQ,IAAI,KAAK,GAAG,QAAQ,CAAC,EAAE,CAAC,CAAC;EACjC,QAAQ,IAAI,WAAW,GAAG,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;EAC9C;EACA;EACA,QAAQ,IAAI,CAAC,GAAG,IAAI,CAAC;EACrB,QAAQ,IAAI,WAAW,IAAI,WAAW,CAAC,CAAC,CAAC,KAAK,SAAS,EAAE;EACzD,YAAY,KAAK,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;EACnC,SAAS;EACT,KAAK;EACL,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;AACD,EAAO,SAAS,eAAe,CAAC,QAAQ,EAAE,eAAe,EAAE,IAAI,EAAE,MAAM,EAAE;EACzE,IAAI,IAAI,MAAM,GAAG,YAAY,CAAC,QAAQ,EAAE,eAAe,EAAE,MAAM,CAAC,CAAC;EACjE,IAAI,IAAI,QAAQ,CAAC,GAAG,EAAE;EACtB,QAAQ,IAAI,UAAU,GAAG,OAAO,CAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;EAC3D,QAAQ,IAAI,QAAQ,GAAG,OAAO,CAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC;EAC3E,QAAQ,OAAO;EACf,YAAY,MAAM,EAAE,mBAAmB,CAAC,UAAU,EAAE,QAAQ,EAAE,MAAM,EAAE,MAAM,CAAC;EAC7E,SAAS,CAAC;EACV,KAAK;EACL,SAAS,IAAI,QAAQ,CAAC,IAAI,KAAK,cAAc,EAAE;EAC/C,QAAQ,OAAO;EACf,YAAY,MAAM,EAAE,EAAE,GAAG,UAAU,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,CAAC,EAAE,MAAM,CAAC;EAClG,SAAS,CAAC;EACV,KAAK;EACL,SAAS,IAAI,cAAc,CAAC,QAAQ,CAAC,EAAE;EACvC,QAAQ,IAAI,UAAU,GAAG,eAAe,CAAC,QAAQ,CAAC,IAAI,QAAQ,CAAC,OAAO,CAAC,IAAI,QAAQ,CAAC,OAAO,CAAC,CAAC,IAAI,KAAK,SAAS,CAAC,GAAG,CAAC;EACpH,QAAQ,OAAO;EACf,YAAY,MAAM,EAAE,oBAAoB,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,QAAQ,CAAC,QAAQ,EAAE,eAAe,EAAE,MAAM,CAAC,IAAI,CAAC,eAAe,EAAE,MAAM,CAAC,UAAU,EAAE,UAAU,EAAE,IAAI,CAAC;EACjL,SAAS,CAAC;EACV,KAAK;EACL,SAAS;EACT,QAAQ,OAAO;EACf,YAAY,MAAM,EAAE,KAAK,GAAG,OAAO,CAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;EAC7D,SAAS,CAAC;EACV,KAAK;EACL,CAAC;AACD,EAAO,SAAS,0BAA0B,CAAC,cAAc,EAAE,YAAY,EAAE;EACzE,IAAI,IAAI,cAAc,KAAK,SAAS,EAAE;EACtC,QAAQ,OAAO,cAAc,CAAC;EAC9B,KAAK;EACL,IAAI,OAAO,YAAY,CAAC;EACxB,CAAC;EACD;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,YAAY,CAAC,QAAQ,EAAE,eAAe,EAAE,MAAM,EAAE;EAChE,IAAI,IAAI,QAAQ,CAAC,IAAI,KAAK,YAAY,EAAE;EACxC;EACA;EACA,QAAQ,IAAI,eAAe,EAAE;EAC7B,YAAY,OAAO,eAAe,CAAC;EACnC,SAAS;EACT;EACA,QAAQ,OAAO,MAAM,CAAC,YAAY,CAAC;EACnC,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;EACD,SAAS,UAAU,CAACzB,QAAK,EAAE,MAAM,EAAE;EACnC,IAAI,OAAO,SAAS,GAAGA,QAAK,GAAG,MAAM,IAAI,MAAM,IAAI,EAAE,CAAC,GAAG,KAAK,CAAC;EAC/D,CAAC;AACD,EAAO,SAAS,gBAAgB,CAACA,QAAK,EAAE,eAAe,EAAE,MAAM,EAAE;EACjE,IAAI,OAAO,UAAU,CAACA,QAAK,EAAE,eAAe,IAAI,MAAM,CAAC,YAAY,CAAC,CAAC;EACrE,CAAC;AACD,EAAO,SAAS,mBAAmB,CAAC,UAAU,EAAE,QAAQ,EAAE,MAAM,EAAE,MAAM,EAAE;EAC1E,IAAI,OAAO,UAAU,GAAG,qBAAqB,GAAG,UAAU,GAAG,iBAAiB,GAAG,gBAAgB,CAAC,UAAU,EAAE,MAAM,EAAE,MAAM,CAAC,GAAG,eAAe,GAAG,gBAAgB,CAAC,QAAQ,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;EAC7L,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,oBAAoB,CAACA,QAAK,EAAE,QAAQ,EAAE,MAAM,EAAE,eAAe,EAAE,gBAAgB,EAAE,UAAU,EAAE,YAAY,EAAE;EAC3H,IAAI,IAAI,YAAY,KAAK,KAAK,CAAC,EAAE,EAAE,YAAY,GAAG,KAAK,CAAC,EAAE;EAC1D,IAAI,IAAI,CAAC,QAAQ,IAAI,MAAM,EAAE;EAC7B;EACA,QAAQ,MAAM,GAAG,MAAM,IAAI,gBAAgB,CAAC;EAC5C,QAAQ,IAAI,MAAM,IAAI,YAAY,EAAE;EACpC,YAAY,OAAO,CAAC,UAAU,GAAG,KAAK,GAAG,MAAM,IAAI,SAAS,GAAGA,QAAK,GAAG,KAAK,GAAG,MAAM,GAAG,IAAI,CAAC;EAC7F,SAAS;EACT,aAAa;EACb,YAAY,OAAO,SAAS,CAAC;EAC7B,SAAS;EACT,KAAK;EACL,SAAS;EACT,QAAQ,OAAO,gBAAgB,CAAC,QAAQ,EAAEA,QAAK,EAAE,eAAe,EAAE,UAAU,CAAC,CAAC;EAC9E,KAAK;EACL,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,UAAU,CAAC,QAAQ,EAAE,cAAc,EAAE;EACrD,IAAI,OAAO,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,QAAQ,GAAG,CAAC,QAAQ,CAAC,EAAE,MAAM,CAAC,UAAU,CAAC,EAAE,eAAe,EAAE;EAC5F,QAAQ,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,cAAc,CAAC,CAAC,CAAC;EAC/D,QAAQ,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,IAAI,WAAW,CAAC,CAAC;EAC1D,QAAQ,OAAO,CAAC,CAAC;EACjB,KAAK,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC,CAAC;EACjC,CAAC;AACD,EAAO,SAAS,mBAAmB,CAAC,EAAE,EAAE,EAAE,EAAE;EAC5C,IAAI,IAAI,MAAM,GAAG,EAAE,CAAC,KAAK,EAAE,CAAC;EAC5B,IAAI,EAAE,CAAC,OAAO,CAAC,UAAU,SAAS,EAAE;EACpC,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,QAAQ,GAAG,MAAM,EAAE,EAAE,GAAG,QAAQ,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACxE,YAAY,IAAI,SAAS,GAAG,QAAQ,CAAC,EAAE,CAAC,CAAC;EACzC;EACA,YAAY,IAAIN,WAAS,CAAC,SAAS,CAAC,KAAKA,WAAS,CAAC,SAAS,CAAC,EAAE;EAC/D,gBAAgB,OAAO;EACvB,aAAa;EACb,SAAS;EACT,QAAQ,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;EAC/B,KAAK,CAAC,CAAC;EACP,IAAI,OAAO,MAAM,CAAC;EAClB,CAAC;AACD,EAAO,SAAS,UAAU,CAAC,MAAM,EAAE,MAAM,EAAE;EAC3C,IAAI,OAAO,MAAM,KAAK,MAAM;EAC5B,QAAQ,MAAM;EACd,QAAQ,MAAM,GAAG,IAAI,GAAG,MAAM,CAAC;EAC/B,CAAC;AACD,EAAO,SAAS,mBAAmB,CAAC,EAAE,EAAE,EAAE,EAAE;EAC5C,IAAI,IAAI,OAAO,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,OAAO,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE;EAChD,QAAQ,OAAO;EACf,YAAY,QAAQ,EAAE,EAAE,CAAC,QAAQ;EACjC,YAAY,KAAK,EAAE,mBAAmB,CAAC,EAAE,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC;EAC1D,SAAS,CAAC;EACV,KAAK;EACL,SAAS,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE;EACvD,QAAQ,OAAO;EACf,YAAY,QAAQ,EAAE,EAAE,CAAC,QAAQ;EACjC,YAAY,KAAK,EAAE,UAAU,CAAC,EAAE,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC;EACjD,SAAS,CAAC;EACV,KAAK;EACL;EACA,IAAI,MAAM,IAAI,KAAK,CAAC,4BAA4B,CAAC,CAAC;EAClD,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,gBAAgB,CAAC,QAAQ,EAAE,OAAO,EAAE;EACpD,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,EAAE;EACvB,QAAQ,OAAO,CAAC,IAAI,CAAC,6CAA6C,CAAC,CAAC;EACpE,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL;EACA;EACA,IAAI,OAAO,cAAc,CAAC,OAAO,CAAC,IAAI,QAAQ,CAAC,CAAC,SAAS,EAAE,SAAS,CAAC,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC;EACtF,CAAC;AACD,EAAO,SAAS,gBAAgB,CAAC,QAAQ,EAAE,KAAK,EAAE;EAClD,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,UAAU,MAAM,EAAE,OAAO,EAAE;EAC5D,QAAQ,IAAI,QAAQ,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;EACzC,QAAQ,OAAOD,QAAgB,CAAC,EAAE,EAAE,MAAM,EAAE,aAAa,CAAC,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,UAAU,CAAC,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,CAAC,KAAK,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC;EACpI,KAAK,EAAE,EAAE,CAAC,CAAC;EACX,CAAC;;EClMM,IAAI,eAAe,GAAG,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;AAC/C,EAAO,IAAI,YAAY,GAAG,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;AAC/C,EAAO,SAAS,aAAa,CAAC,MAAM,EAAE;EACtC,IAAI,IAAI,MAAM,KAAK,KAAK,IAAI,MAAM,KAAK,MAAM,EAAE;EAC/C,QAAQ,OAAO,QAAQ,CAAC;EACxB,KAAK;EACL,IAAI,OAAO,QAAQ,CAAC;EACpB,CAAC;AACD,EAAO,SAAS,aAAa,CAAC,KAAK,EAAE,OAAO,EAAE;EAC9C,IAAI,IAAIqB,QAAK,GAAG,KAAK,CAAC,SAAS,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC;EAC7D,IAAI,IAAI,UAAU,GAAG,OAAO,KAAK,KAAK,GAAG,UAAU,GAAG,SAAS,CAAC;EAChE,IAAI,IAAI,MAAM,GAAGrB,QAAgB,CAAC,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,QAAQ,EAAE,EAAE,IAAI,EAAE,EAAE,KAAK,EAAEqB,QAAK,EAAE,EAAE,GAAG,UAAU,KAAK,UAAU,GAAG,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,GAAG,EAAE,EAAE,GAAG,EAAE,EAAE,CAAC;EACxJ,IAAI,OAAO;EACX,QAAQ,IAAI,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,GAAG,QAAQ,CAAC;EAC/C,QAAQ,IAAI,EAAE,OAAO,GAAG,QAAQ;EAChC,QAAQ,IAAI,EAAE,OAAO;EACrB,QAAQ,KAAK,EAAE,CAACrB,QAAgB,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,OAAO,GAAG,aAAa,EAAE,KAAK,EAAE,aAAa,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,GAAG,CAAC,GAAG,EAAE,MAAM,EAAE,EAAE,MAAM,EAAE,MAAM,EAAE,EAAE,GAAG,EAAE,EAAE,CAAC;EACzK,KAAK,CAAC;EACN,CAAC;AACD,EAAO,SAAS,eAAe,CAAC,KAAK,EAAE,OAAO,EAAE;EAChD,IAAI,IAAI,YAAY,GAAG,KAAK,CAAC,SAAS,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;EAC9D,IAAI,IAAI,MAAM,GAAG,EAAE,CAAC;EACpB,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,cAAc,GAAG,YAAY,EAAE,EAAE,GAAG,cAAc,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACtF,QAAQ,IAAI,UAAU,GAAG,cAAc,CAAC,EAAE,CAAC,CAAC;EAC5C,QAAQ,IAAI,YAAY,CAAC,UAAU,CAAC,EAAE;EACtC,YAAY,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,YAAY,CAAC,UAAU,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAClF,gBAAgB,IAAI,UAAU,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EACxC,gBAAgB,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,KAAK,EAAE,OAAO,EAAE,UAAU,EAAE,YAAY,EAAE,UAAU,CAAC,CAAC,CAAC;EAClG,aAAa;EACb,SAAS;EACT,KAAK;EACL,IAAI,OAAO,MAAM,CAAC;EAClB,CAAC;EACD;AACA,EAAO,SAAS,UAAU,CAAC,KAAK,EAAE;EAClC;EACA,IAAI,KAAK,GAAG,CAAC,CAAC,KAAK,GAAG,GAAG,IAAI,GAAG,IAAI,GAAG,CAAC;EACxC,IAAI,IAAI,CAAC,KAAK,GAAG,EAAE,IAAI,GAAG,KAAK,CAAC,EAAE;EAClC,QAAQ,OAAO,EAAE,CAAC;EAClB,KAAK;EACL,SAAS,IAAI,KAAK,GAAG,EAAE,IAAI,GAAG,GAAG,KAAK,EAAE;EACxC,QAAQ,OAAO,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,EAAE,CAAC;EAC7C,KAAK;EACL,SAAS,IAAI,GAAG,IAAI,KAAK,IAAI,KAAK,GAAG,GAAG,EAAE;EAC1C,QAAQ,OAAO,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,MAAM,EAAE,EAAE,CAAC;EAC5C,KAAK;EACL,IAAI,OAAO,EAAE,CAAC;EACd,CAAC;AACD,EAAO,SAAS,aAAa,CAAC,KAAK,EAAE;EACrC;EACA,IAAI,KAAK,GAAG,CAAC,CAAC,KAAK,GAAG,GAAG,IAAI,GAAG,IAAI,GAAG,CAAC;EACxC,IAAI,IAAI,EAAE,IAAI,KAAK,IAAI,KAAK,IAAI,GAAG,EAAE;EACrC,QAAQ,OAAO,EAAE,QAAQ,EAAE,EAAE,KAAK,EAAE,KAAK,EAAE,EAAE,CAAC;EAC9C,KAAK;EACL,IAAI,OAAO,EAAE,CAAC;EACd,CAAC;EACD,SAAS,cAAc,CAAC,KAAK,EAAE,OAAO,EAAE,UAAU,EAAE,YAAY,EAAE,UAAU,EAAE;EAC9E,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,IAAI,UAAU,EAAE;EACpB,QAAQ,IAAIqB,QAAK,GAAG,IAAI,CAAC;EACzB,QAAQ,IAAI,aAAa,GAAG,YAAY,CAAC,aAAa,CAAC;EACvD,QAAQ,IAAI,aAAa,IAAI,UAAU,CAAC,MAAM,EAAE;EAChD,YAAY,IAAI,EAAE,GAAG,aAAa,CAAC,MAAM,EAAE,MAAM,GAAG,EAAE,KAAK,KAAK,CAAC,GAAG,EAAE,GAAG,EAAE,CAAC;EAC5E,YAAY,IAAI,MAAM,GAAG,MAAM,CAAC,MAAM,EAAE,UAAU,GAAG,MAAM,CAAC,UAAU,CAAC;EACvE,YAAY,IAAI,MAAM,GAAGrB,QAAgB,CAAC,EAAE,GAAG,UAAU,KAAK,SAAS,GAAG,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,UAAU,EAAE,EAAE,GAAG,EAAE,GAAG,UAAU,CAAC,UAAU,CAAC,EAAE,aAAa,CAAC,UAAU,CAAC,CAAC,CAAC;EACrK,YAAYqB,QAAK,GAAGrB,QAAgB,CAAC,EAAE,IAAI,EAAE,eAAe,CAAC,aAAa,EAAE,MAAM,EAAE,QAAQ,EAAE,KAAK,CAAC,MAAM,CAAC,EAAE,MAAM,EAAE,EAAE,EAAE,MAAM,EAAE,OAAO,KAAK,KAAK,GAAG,MAAM,GAAG,KAAK,EAAE,KAAK,EAAE,aAAa,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,GAAG,CAAC,GAAG,EAAE,MAAM,EAAE,EAAE,MAAM,EAAE,MAAM,EAAE,EAAE,GAAG,EAAE,EAAE,CAAC;EAC9P,SAAS;EACT,QAAQ,IAAI,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC;EACnC,QAAQ,IAAI,OAAO,GAAG,IAAI,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;EAC9C,QAAQ,IAAIqB,QAAK,IAAI,OAAO,EAAE;EAC9B,YAAY,IAAI,WAAW,GAAG,OAAO,KAAK,KAAK,GAAG,QAAQ,GAAG,OAAO,CAAC;EACrE,YAAY,OAAOrB,QAAgB,CAAC,EAAE,IAAI,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,GAAG,GAAG,GAAG,UAAU,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,GAAG,GAAG,GAAG,UAAU,EAAE,GAAG,YAAY,CAAC,aAAa,GAAG;EACxK,gBAAgB,IAAI,EAAE,EAAE,IAAI,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,GAAG,SAAS,CAAC,EAAE;EAClE,gBAAgB,IAAI,EAAE;EACtB,oBAAoB,KAAK,EAAE,OAAO,CAAC,aAAa,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC;EACpE,oBAAoB,KAAK,EAAE,aAAa,CAAC,IAAI,IAAI,WAAW;EAC5D,iBAAiB;EACjB,aAAa,GAAG,EAAE,IAAIqB,QAAK,GAAG,EAAE,KAAK,EAAEA,QAAK,EAAE,GAAG,EAAE,IAAI,UAAU,CAAC,UAAU,GAAG;EAC/E,gBAAgB,MAAM,EAAE;EACxB,oBAAoB,MAAM,GAAG,EAAE,GAAG,EAAE;EACpC,wBAAwB,EAAE,CAAC,WAAW,CAAC,GAAG,UAAU,CAAC,UAAU;EAC/D,wBAAwB,EAAE,CAAC;EAC3B,iBAAiB;EACjB,aAAa,GAAG,EAAE,IAAI,OAAO,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,EAAE,CAAC;EACtD,SAAS;EACT,KAAK;EACL,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;;ECxFM,SAAS,qBAAqB,CAAC,KAAK,EAAE;EAC7C,IAAI,OAAO,EAAE,CAAC,MAAM,CAAC,WAAW,CAAC,KAAK,EAAE,OAAO,CAAC,EAAE,WAAW,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC,CAAC;EAChF,CAAC;AACD,EAAO,SAAS,WAAW,CAAC,KAAK,EAAE,QAAQ,EAAE;EAC7C,IAAI,IAAI,OAAO,GAAG,QAAQ,KAAK,OAAO,GAAG,GAAG,GAAG,GAAG,CAAC;EACnD,IAAI,IAAI,IAAI,GAAG,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;EACxD,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,KAAK,QAAQ,EAAE;EACpC,QAAQ,OAAO,EAAE,CAAC;EAClB,KAAK;EACL;EACA,IAAI,IAAI,IAAI,GAAG,KAAK,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;EACvD,IAAI,IAAI,IAAI,KAAK,YAAY,EAAE;EAC/B,QAAQ,IAAI,cAAc,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;EAC9D,QAAQ,IAAI,cAAc,EAAE;EAC5B,YAAY,IAAI,IAAI,GAAG,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAClD,YAAY,IAAI,KAAK,GAAG,cAAc,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;EACpD,YAAY,IAAI,iBAAiB,CAAC,IAAI,CAAC,IAAI,aAAa,CAAC,KAAK,CAAC,EAAE;EACjE,gBAAgB,IAAI,SAAS,GAAG,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;EACzD,gBAAgB,IAAI,YAAY,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE;EAChD;EACA;EACA;EACA,oBAAoB,IAAI,aAAa,GAAG,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC;EACvE,oBAAoB,IAAI,aAAa,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,aAAa,EAAE;EACxE,wBAAwB,OAAO,CAAC,UAAU,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC,CAAC;EAC9D,qBAAqB;EACrB,iBAAiB;EACjB,gBAAgB,OAAO;EACvB,oBAAoB,UAAU,CAAC,SAAS,EAAE,KAAK,CAAC;EAChD,oBAAoB;EACpB,wBAAwB,IAAI,EAAE,IAAI;EAClC,wBAAwB,MAAM,EAAE,QAAQ,CAAC,SAAS,EAAE,cAAc,EAAE,UAAU,GAAG,SAAS,GAAG,WAAW,CAAC;EACzG,qBAAqB;EACrB,iBAAiB,CAAC;EAClB,aAAa;EACb,SAAS;EACT;EACA,QAAQ,MAAM,IAAI,KAAK,CAAC,2DAA2D,CAAC,CAAC;EACrF,KAAK;EACL,SAAS;EACT,QAAQ,OAAO,CAAC;EAChB,gBAAgB,IAAI,EAAE,IAAI;EAC1B,gBAAgB,KAAK,EAAE,IAAI;EAC3B,aAAa,CAAC,CAAC;EACf,KAAK;EACL,CAAC;EACD,SAAS,UAAU,CAAC,SAAS,EAAE,KAAK,EAAE;EACtC,IAAI,OAAO;EACX,QAAQ,IAAI,EAAE,SAAS,GAAG,OAAO;EACjC,QAAQ,KAAK,EAAE,KAAK,CAAC,IAAI;EACzB,KAAK,CAAC;EACN,CAAC;AACD,EAAO,SAAS,QAAQ,CAAC,SAAS,EAAE,cAAc,EAAE,WAAW,EAAE;EACjE,IAAI,IAAI,IAAI,GAAG,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAC1C,IAAI,IAAI,OAAO,GAAG,cAAc,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;EAChD,IAAI,IAAI,YAAY,GAAG,cAAc,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;EAC1D,IAAI,YAAY,GAAG,YAAY,KAAK,SAAS,GAAG,YAAY,GAAG,OAAO,CAAC;EACvE,IAAI,IAAI,YAAY,GAAG,cAAc,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;EAC1D,IAAI,YAAY,GAAG,IAAI,KAAK,MAAM;EAClC;EACA,SAAS,YAAY,KAAK,SAAS,GAAG,YAAY,GAAG,OAAO;EAC5D;EACA;EACA,QAAQ,CAAC,CAAC;EACV,IAAI,OAAO,YAAY,GAAG,WAAW,GAAG,IAAI,GAAG,YAAY,GAAG,IAAI,GAAG,YAAY,GAAG,MAAM,GAAG,SAAS,GAAG,OAAO,CAAC;EACjH,CAAC;;EChEM,SAAS,mBAAmB,CAAC,OAAO,EAAE,KAAK,EAAE;EACpD,IAAI,IAAI,YAAY,CAAC,KAAK,CAAC,IAAI,YAAY,CAAC,KAAK,CAAC,EAAE;EACpD,QAAQ,OAAO,QAAQ,CAAC;EACxB,KAAK;EACL,SAAS,IAAI,aAAa,CAAC,KAAK,CAAC,IAAI,aAAa,CAAC,KAAK,CAAC,EAAE;EAC3D,QAAQ,OAAO,QAAQ,CAAC,uBAAuB,EAAE,OAAO,CAAC,GAAG,aAAa,GAAG,QAAQ,CAAC;EACrF,KAAK;EACL;EACA,IAAI,MAAM,IAAI,KAAK,CAAC,gCAAgC,CAAC,CAAC;EACtD,CAAC;AACD,EAAO,SAAS,iBAAiB,CAAC,OAAO,EAAE,OAAO,EAAE;EACpD,IAAI,IAAI,mBAAmB,GAAG,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;EACrD,IAAI,IAAI,KAAK,GAAG,QAAQ,CAAC,uBAAuB,EAAE,OAAO,CAAC,GAAG,MAAM,GAAG,QAAQ,CAAC;EAC/E,IAAI,IAAI,mBAAmB,KAAK,aAAa,EAAE;EAC/C,QAAQ,IAAI,OAAO,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,KAAK,QAAQ,EAAE;EAClD,YAAYb,IAAQ,CAACC,OAAW,CAAC,qCAAqC,CAAC,OAAO,CAAC,CAAC,CAAC;EACjF,SAAS;EACT,QAAQ,OAAO,aAAa,CAAC;EAC7B,KAAK;EACL,IAAI,OAAO,OAAO,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,IAAI,QAAQ,CAAC;EAC/C,CAAC;;ECrBD;EACA;EACA;EACA;EACA;EACA;EACA,IAAI,KAAK,kBAAkB,YAAY;EACvC,IAAI,SAAS,KAAK,CAAC,QAAQ,EAAE,QAAQ,EAAE;EACvC,QAAQ,IAAI,QAAQ,KAAK,KAAK,CAAC,EAAE,EAAE,QAAQ,GAAG,EAAE,CAAC,EAAE;EACnD,QAAQ,IAAI,QAAQ,KAAK,KAAK,CAAC,EAAE,EAAE,QAAQ,GAAG,EAAE,CAAC,EAAE;EACnD,QAAQ,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;EACjC,QAAQ,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;EACjC,KAAK;EACL,IAAI,KAAK,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EACxC,QAAQ,OAAO,IAAI,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;EAC7E,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,OAAO,GAAG,YAAY;EAC1C;EACA;EACA,QAAQ,OAAOT,QAAgB,CAAC,EAAE,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;EAClE,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,GAAG,GAAG,UAAU,GAAG,EAAE;EACzC;EACA,QAAQ,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;EAC1F,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,eAAe,GAAG,UAAU,GAAG,EAAE;EACrD;EACA,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE;EAC9C,YAAY,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC;EACjE,SAAS;EACT,aAAa,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE;EACnD,YAAY,OAAO,EAAE,QAAQ,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,CAAC;EAClE,SAAS;EACT,QAAQ,OAAO,EAAE,QAAQ,EAAE,KAAK,EAAE,KAAK,EAAE,SAAS,EAAE,CAAC;EACrD,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,eAAe,GAAG,UAAU,GAAG,EAAE,KAAK,EAAE;EAC5D,QAAQ,IAAI,KAAK,CAAC,KAAK,KAAK,SAAS,EAAE;EACvC,YAAY,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,KAAK,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;EACvD,SAAS;EACT,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,GAAG,GAAG,UAAU,GAAG,EAAE,KAAK,EAAE,QAAQ,EAAE;EAC1D,QAAQ,OAAO,IAAI,CAAC,QAAQ,GAAG,UAAU,GAAG,UAAU,CAAC,CAAC,GAAG,CAAC,CAAC;EAC7D,QAAQ,IAAI,CAAC,QAAQ,GAAG,UAAU,GAAG,UAAU,CAAC,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;EAC9D,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,gBAAgB,GAAG,UAAU,GAAG,EAAE,CAAC,EAAE;EACzD;EACA,QAAQ,IAAI,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE;EAC3C,YAAY,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,CAAC;EACjD,SAAS;EACT,aAAa,IAAI,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE;EAChD,YAAY,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,KAAK,CAAC,CAAC;EAClD,SAAS;EACT,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,iBAAiB,GAAG,UAAU,GAAG,EAAE,CAAC,EAAE;EAC1D;EACA,QAAQ,IAAI,CAAC,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE;EAClC,YAAY,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,CAAC;EACxC,SAAS;EACT,KAAK,CAAC;EACN;EACA;EACA;EACA;EACA,IAAI,KAAK,CAAC,SAAS,CAAC,OAAO,GAAG,UAAU,KAAK,EAAE;EAC/C,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC3E,YAAY,IAAI,GAAG,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC7B,YAAY,IAAI,GAAG,GAAG,KAAK,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC;EACjD,YAAY,IAAI,CAAC,eAAe,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;EAC3C,SAAS;EACT,KAAK,CAAC;EACN,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC,EAAE,CAAC,CAAC;AACL,EACO,SAAS,YAAY,CAAC,KAAK,EAAE;EACpC,IAAI,OAAO;EACX,QAAQ,QAAQ,EAAE,IAAI;EACtB,QAAQ,KAAK,EAAE,KAAK;EACpB,KAAK,CAAC;EACN,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,KAAK,EAAE;EACpC,IAAI,OAAO;EACX,QAAQ,QAAQ,EAAE,KAAK;EACvB,QAAQ,KAAK,EAAE,KAAK;EACpB,KAAK,CAAC;EACN,CAAC;AACD,EAAO,SAAS,mBAAmB,CAAC,OAAO,EAAE;EAC7C,IAAI,OAAO,UAAU,EAAE,EAAE,EAAE,EAAE,QAAQ,EAAE,UAAU,EAAE;EACnD,QAAQ,IAAI,IAAI,GAAG,OAAO,CAAC,EAAE,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,CAAC;EAC/C,QAAQ,IAAI,IAAI,GAAG,CAAC,EAAE;EACtB,YAAY,OAAO,EAAE,CAAC;EACtB,SAAS;EACT,aAAa,IAAI,IAAI,GAAG,CAAC,EAAE;EAC3B,YAAY,OAAO,EAAE,CAAC;EACtB,SAAS;EACT,QAAQ,OAAO,iBAAiB,CAAC,EAAE,EAAE,EAAE,EAAE,QAAQ,EAAE,UAAU,CAAC,CAAC;EAC/D,KAAK,CAAC;EACN,CAAC;AACD,EAAO,SAAS,iBAAiB,CAAC,EAAE,EAAE,EAAE,EAAE,QAAQ,EAAE,UAAU,EAAE;EAChE,IAAI,IAAI,EAAE,CAAC,QAAQ,IAAI,EAAE,CAAC,QAAQ,EAAE;EACpC,QAAQQ,IAAQ,CAACC,OAAW,CAAC,wBAAwB,CAAC,QAAQ,EAAE,UAAU,EAAE,EAAE,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;EACjG,KAAK;EACL;EACA,IAAI,OAAO,EAAE,CAAC;EACd,CAAC;AACD,EAAO,SAAS,uBAAuB,CAAC,EAAE,EAAE,EAAE,EAAE,QAAQ,EAAE,UAAU,EAAE,UAAU,EAAE;EAClF,IAAI,IAAI,UAAU,KAAK,KAAK,CAAC,EAAE,EAAE,UAAU,GAAG,iBAAiB,CAAC,EAAE;EAClE,IAAI,IAAI,EAAE,KAAK,SAAS,IAAI,EAAE,CAAC,KAAK,KAAK,SAAS,EAAE;EACpD;EACA,QAAQ,OAAO,EAAE,CAAC;EAClB,KAAK;EACL,IAAI,IAAI,EAAE,CAAC,QAAQ,IAAI,CAAC,EAAE,CAAC,QAAQ,EAAE;EACrC,QAAQ,OAAO,EAAE,CAAC;EAClB,KAAK;EACL,SAAS,IAAI,EAAE,CAAC,QAAQ,IAAI,CAAC,EAAE,CAAC,QAAQ,EAAE;EAC1C,QAAQ,OAAO,EAAE,CAAC;EAClB,KAAK;EACL,SAAS,IAAIR,WAAS,CAAC,EAAE,CAAC,KAAK,CAAC,KAAKA,WAAS,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE;EAC1D,QAAQ,OAAO,EAAE,CAAC;EAClB,KAAK;EACL,SAAS;EACT,QAAQ,OAAO,UAAU,CAAC,EAAE,EAAE,EAAE,EAAE,QAAQ,EAAE,UAAU,CAAC,CAAC;EACxD,KAAK;EACL,CAAC;;EC5HD,IAAI,eAAe,kBAAkB,UAAU,MAAM,EAAE;EACvD,IAAIiC,SAAiB,CAAC,eAAe,EAAE,MAAM,CAAC,CAAC;EAC/C,IAAI,SAAS,eAAe,GAAG;EAC/B,QAAQ,OAAO,MAAM,KAAK,IAAI,IAAI,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,IAAI,IAAI,CAAC;EACxE,KAAK;EACL,IAAI,OAAO,eAAe,CAAC;EAC3B,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;;ECCH,SAAS,OAAO,CAAC,QAAQ,EAAE,WAAW,EAAE,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE;EACrE,IAAI,IAAI,IAAI,KAAK,UAAU,EAAE;EAC7B,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK;EACL,IAAI,IAAI,GAAG,GAAGlC,QAAgB,CAAC,EAAE,EAAE,eAAe,CAAC,EAAE,EAAE,KAAK,EAAE,kBAAkB,CAAC,EAAEmC,KAAY,CAAC,KAAK,CAAC,CAAC,CAAC;EACxG,IAAI,QAAQ,KAAK,CAAC,IAAI;EACtB,QAAQ,KAAK,GAAG,CAAC;EACjB,QAAQ,KAAK,IAAI,CAAC;EAClB,QAAQ,KAAK7B,MAAI;EACjB,YAAY,GAAG,CAAC,KAAK,GAAG,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC;EAC5C,YAAY,MAAM;EAClB,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,MAAM;EACnB,YAAY,GAAG,CAAC,KAAK,GAAG,EAAE,KAAK,EAAE,KAAK,CAAC,IAAI,EAAE,CAAC;EAC9C,YAAY,MAAM;EAClB,QAAQ,KAAK,KAAK,CAAC;EACnB,QAAQ,KAAK,IAAI,CAAC;EAClB,QAAQ,KAAK,QAAQ,CAAC;EACtB,QAAQ,KAAK,IAAI;EACjB;EACA,YAAY,MAAM;EAClB,KAAK;EACL,IAAI,IAAI,OAAO,GAAG,KAAK,CAAC,OAAO,EAAE,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;EAC3D,IAAI,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;EAChC,IAAI,IAAI,GAAG,CAAC,IAAI,EAAE;EAClB;EACA,QAAQ,IAAI,OAAO,KAAK,MAAM,KAAK,MAAM,IAAI,OAAO,KAAK,KAAK,CAAC,EAAE;EACjE,YAAY,OAAO,GAAG,CAAC,IAAI,CAAC;EAC5B,SAAS;EACT,aAAa;EACb,YAAY,IAAI,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;EACnC;EACA,gBAAgB,OAAO,GAAG,CAAC,IAAI,CAAC;EAChC,aAAa;EACb,iBAAiB,IAAI,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;EACxC,gBAAgB,IAAI,IAAI,GAAG,sBAAsB,CAAC,QAAQ,CAAC,IAAI,IAAI,QAAQ,CAAC,KAAK,CAAC,IAAI,OAAO,CAAC,IAAI,KAAK,MAAM,IAAI,OAAO,CAAC,KAAK,CAAC,CAAC;EAChI,gBAAgB,IAAI,IAAI,EAAE;EAC1B,oBAAoB,GAAG,CAAC,IAAI,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;EAC/C,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,KAAK;EACL,IAAI,IAAI,GAAG,CAAC,MAAM,EAAE;EACpB,QAAQ,IAAI,OAAO,KAAK,QAAQ,KAAK,CAAC,MAAM,IAAI,OAAO,KAAK,KAAK,CAAC,EAAE;EACpE,YAAY,OAAO,GAAG,CAAC,MAAM,CAAC;EAC9B,SAAS;EACT,aAAa;EACb,YAAY,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC,EAAE;EACrC;EACA,gBAAgB,OAAO,GAAG,CAAC,MAAM,CAAC;EAClC,aAAa;EACb,iBAAiB,IAAI,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE;EAC1C,gBAAgB,IAAI,MAAM,GAAG,sBAAsB,CAAC,QAAQ,CAAC,MAAM,IAAI,QAAQ,CAAC,KAAK,CAAC,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,MAAM,IAAI,OAAO,CAAC,KAAK,CAAC,CAAC;EACvI,gBAAgB,IAAI,MAAM,EAAE;EAC5B,oBAAoB,GAAG,CAAC,MAAM,GAAG,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC;EACnD,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,KAAK;EACL,IAAI,IAAI,GAAG,CAAC,IAAI,IAAI,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,aAAa,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE;EACxE;EACA,QAAQ,GAAG,CAAC,MAAM,GAAG,EAAE,KAAK,EAAE,aAAa,EAAE,CAAC;EAC9C,KAAK;EACL,IAAI,IAAI,OAAO,KAAK,KAAK,EAAE;EAC3B,QAAQ,IAAI,KAAK,GAAG,sBAAsB,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,OAAO,CAAC,KAAK,CAAC;EAC5E,QAAQ,IAAI,KAAK,EAAE;EACnB,YAAY,GAAG,CAAC,KAAK,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;EACzC,SAAS;EACT,KAAK;EACL,IAAI,IAAI,OAAO,KAAK,OAAO,EAAE;EAC7B,QAAQ,IAAI,OAAO,GAAG,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC;EACvE,QAAQ,IAAI,OAAO,EAAE;EACrB,YAAY,GAAG,CAAC,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC;EAC7C,SAAS;EACT,KAAK;EACL,IAAI,GAAG,GAAGN,QAAgB,CAAC,EAAE,EAAE,GAAG,EAAE,WAAW,CAAC,CAAC;EACjD,IAAI,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,CAAC,GAAG,GAAG,GAAG,SAAS,CAAC;EAClD,CAAC;AACD,EAAO,SAAS,QAAQ,CAAC,QAAQ,EAAE,YAAY,EAAE,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE;EACvE,IAAI,IAAI,GAAG,GAAG,EAAE,CAAC;EACjB,IAAI,IAAI,IAAI,KAAK,UAAU,EAAE;EAC7B,QAAQ,IAAI,OAAO,GAAG,WAAW,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC;EACnF,QAAQ,IAAI,OAAO,EAAE;EACrB,YAAY,GAAG,CAAC,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,EAAE,CAAC;EAC7C,SAAS;EACT,KAAK;EACL,IAAI,GAAG,GAAGA,QAAgB,CAAC,EAAE,EAAE,GAAG,EAAE,YAAY,CAAC,CAAC;EAClD,IAAI,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,CAAC,GAAG,GAAG,GAAG,SAAS,CAAC;EAClD,CAAC;AACD,EAAO,SAAS,MAAM,CAAC,QAAQ,EAAE,UAAU,EAAE,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE;EACnE,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;EACvC,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;EAC9B,IAAI,IAAI,GAAG,GAAG,EAAE,CAAC;EACjB,IAAI,IAAI,cAAc,CAAC,QAAQ,CAAC,EAAE;EAClC,QAAQ,IAAI,UAAU,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,SAAS,CAAC,GAAG,CAAC;EACxF,QAAQ,IAAI,IAAI,GAAG,oBAAoB,CAAC,aAAa,EAAE,QAAQ,CAAC,QAAQ,EAAE,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,MAAM,CAAC,eAAe,EAAE,MAAM,CAAC,UAAU,EAAE,UAAU,CAAC,CAAC;EACvJ,QAAQ,UAAU,GAAGA,QAAgB,CAAC,EAAE,GAAG,IAAI,GAAG,EAAE,IAAI,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,EAAE,GAAG,UAAU,CAAC,CAAC;EAChG,KAAK;EACL,IAAI,GAAG,GAAGA,QAAgB,CAAC,EAAE,EAAE,GAAG,EAAE,UAAU,CAAC,CAAC;EAChD,IAAI,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,GAAG,CAAC,GAAG,GAAG,GAAG,SAAS,CAAC;EAClD,CAAC;EACD,SAAS,WAAW,CAAC,UAAU,EAAE;EACjC,IAAI,OAAO,iBAAiB,CAAC,UAAU,EAAE,UAAU,CAAC,EAAE,cAAc,EAAE,EAAE,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,cAAc,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;EACrH,CAAC;EACD,SAAS,sBAAsB,CAAC,UAAU,EAAE;EAC5C,IAAI,OAAO,iBAAiB,CAAC,UAAU,EAAE,UAAU,CAAC,EAAE,cAAc,EAAE,EAAE,OAAO,CAAC,KAAK,SAAS,GAAG,CAAC,GAAG,cAAc,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;EAC9H,CAAC;EACD,SAAS,iBAAiB,CAAC,UAAU,EAAE,OAAO,EAAE;EAChD,IAAI,IAAI,sBAAsB,CAAC,UAAU,CAAC,EAAE;EAC5C,QAAQ,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,SAAS,CAAC,GAAG,UAAU,CAAC,SAAS,GAAG,CAAC,UAAU,CAAC,SAAS,CAAC;EAC7F,aAAa,MAAM,CAAC,OAAO,EAAE,UAAU,CAAC,KAAK,CAAC,CAAC;EAC/C,KAAK;EACL,SAAS,IAAI,UAAU,CAAC,UAAU,CAAC,EAAE;EACrC,QAAQ,OAAO,UAAU,CAAC,KAAK,CAAC;EAChC,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;;;;;;;;ECzHM,SAAS,MAAM,CAAC,MAAM,EAAE;EAC/B,IAAI,IAAIoC,OAAI,GAAG,MAAM,CAAC,MAAM,CAAC;EAC7B,IAAI,IAAIA,OAAI,IAAI,UAAU,CAACA,OAAI,CAAC,CAAC,CAAC,CAAC,EAAE;EACrC,QAAQ,OAAOA,OAAI,CAAC,GAAG,CAAC,UAAU,EAAE,EAAE;EACtC;EACA,YAAY,OAAO,EAAE,MAAM,EAAE,YAAY,CAAC,EAAE,EAAE,IAAI,CAAC,EAAE,CAAC;EACtD,SAAS,CAAC,CAAC;EACX,KAAK;EACL,IAAI,OAAOA,OAAI,CAAC;EAChB,CAAC;AACD,EAAO,SAASC,MAAI,CAAC,CAAC,EAAE,OAAO,EAAE,SAAS,EAAE;EAC5C,IAAI,IAAI,cAAc,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,KAAK,cAAc,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC;EACnF,SAAS,CAAC,KAAK,UAAU,IAAI,QAAQ,CAAC,CAAC,MAAM,EAAE,KAAK,CAAC,EAAE,SAAS,CAAC,CAAC,CAAC,EAAE;EACrE,QAAQ,OAAO,UAAU,CAAC;EAC1B,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;;ECRM,SAAS,WAAW,CAAC,KAAK,EAAE;EACnC,IAAI,IAAI,WAAW,CAAC,KAAK,CAAC,EAAE;EAC5B,QAAQ,KAAK,CAAC,SAAS,CAAC,OAAO,GAAG,eAAe,CAAC,KAAK,CAAC,CAAC;EACzD,KAAK;EACL,SAAS;EACT,QAAQ,KAAK,CAAC,SAAS,CAAC,OAAO,GAAG,kBAAkB,CAAC,KAAK,CAAC,CAAC;EAC5D,KAAK;EACL,CAAC;EACD,SAAS,eAAe,CAAC,KAAK,EAAE;EAChC,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;EAClC,IAAI,OAAO,CAAC,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC,MAAM,CAAC,UAAU,eAAe,EAAE,OAAO,EAAE;EAClG,QAAQ,IAAI,GAAG,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;EACpC,QAAQ,IAAI,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,EAAE,UAAU,CAAC,GAAG,CAAC,KAAK,OAAO,KAAK,KAAK,IAAI,GAAG,CAAC,IAAI,KAAK,OAAO,CAAC,CAAC,EAAE;EAC5I,YAAY,eAAe,CAAC,OAAO,CAAC,GAAG,qBAAqB,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;EAC7E,SAAS;EACT,QAAQ,OAAO,eAAe,CAAC;EAC/B,KAAK,EAAE,EAAE,CAAC,CAAC;EACX,CAAC;EACD,SAAS,qBAAqB,CAAC,KAAK,EAAE,OAAO,EAAE;EAC/C,IAAI,IAAI,EAAE,CAAC;EACX;EACA,IAAI,QAAQ,OAAO;EACnB,QAAQ,KAAK,KAAK;EAClB,YAAY,IAAI,KAAK,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;EAC/C,YAAY,OAAO,KAAK,CAAC,OAAO,CAAC,MAAM,GAAG,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC;EAC9E,QAAQ,KAAK,IAAI,CAAC;EAClB,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,IAAI,CAAC;EAClB,QAAQ,KAAK,KAAK,CAAC;EACnB,QAAQ,KAAK,OAAO;EACpB,YAAY,OAAO,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,OAAO,CAAC,GAAG,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,EAAE,EAAE,CAAC;EACvE,KAAK;EACL,CAAC;AACD,EAAO,SAAS,qBAAqB,CAAC,KAAK,EAAE,OAAO,EAAE;EACtD,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC3C,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;EACvC,IAAI,IAAI,UAAU,GAAG,IAAI,eAAe,CAAC,EAAE,EAAE,qBAAqB,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC,CAAC;EACpF,IAAI,iBAAiB,CAAC,OAAO,CAAC,UAAU,QAAQ,EAAE;EAClD,QAAQ,IAAI,KAAK,GAAG,WAAW,CAAC,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,KAAK,CAAC,CAAC;EAClE,QAAQ,IAAI,KAAK,KAAK,SAAS,EAAE;EACjC,YAAY,IAAI,QAAQ;EACxB;EACA,YAAY,QAAQ,KAAK,QAAQ,GAAG,CAAC,CAAC,MAAM,CAAC,MAAM;EACnD;EACA,gBAAgB,QAAQ,KAAK,OAAO,IAAI,KAAK,KAAK,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,KAAK,GAAG,IAAI;EACtF;EACA,oBAAoB,KAAK,KAAK,MAAM,CAAC,QAAQ,CAAC,CAAC;EAC/C,YAAY,IAAI,QAAQ,IAAI,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAK,SAAS,EAAE;EACzE,gBAAgB,UAAU,CAAC,GAAG,CAAC,QAAQ,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAC;EAC1D,aAAa;EACb,SAAS;EACT,KAAK,CAAC,CAAC;EACP;EACA,IAAI,IAAI,cAAc,GAAG,MAAM,CAAC,QAAQ,IAAI,EAAE,CAAC;EAC/C,IAAI,IAAI,YAAY,GAAG,CAAC,QAAQ,EAAE,QAAQ,EAAE,OAAO,EAAE,SAAS,EAAE,UAAU,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,IAAI,EAAE;EACtG,QAAQ,IAAI,kBAAkB,GAAG,gBAAgB,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,KAAK,CAAC,CAAC;EACrF,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC;EAChC;EACA,YAAY,MAAM,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,kBAAkB,EAAE,KAAK,EAAE,OAAO,EAAE,UAAU,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAC9F,YAAY,kBAAkB,CAAC;EAC/B,QAAQ,IAAI,KAAK,KAAK,SAAS,IAAI,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;EAC3D,YAAY,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC;EACxC,SAAS;EACT,QAAQ,OAAO,CAAC,CAAC;EACjB,KAAK,EAAE,EAAE,CAAC,CAAC;EACX,IAAI,IAAI,IAAI,CAAC,YAAY,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;EACvC,QAAQ,UAAU,CAAC,GAAG,CAAC,QAAQ,EAAE,YAAY,EAAE,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;EAClE,KAAK;EACL,IAAI,OAAO,UAAU,CAAC;EACtB,CAAC;EACD,SAAS,WAAW,CAAC,QAAQ,EAAE,eAAe,EAAE,OAAO,EAAE,KAAK,EAAE;EAChE,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC3C,IAAI,QAAQ,QAAQ;EACpB,QAAQ,KAAK,QAAQ;EACrB;EACA,YAAY,OAAO,YAAY,CAAC,QAAQ,EAAE,eAAe,CAAC,MAAM,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;EAChF,QAAQ,KAAK,OAAO;EACpB;EACA;EACA,YAAY,IAAI,cAAc,GAAG,QAAQ,CAAC,KAAK,KAAK,SAAS,GAAG,QAAQ,CAAC,KAAK;EAC9E,gBAAgB,eAAe,CAAC,KAAK,KAAK,eAAe,CAAC,KAAK,KAAK,SAAS,GAAG,SAAS,GAAG,IAAI,CAAC,CAAC;EAClG,YAAY,OAAO,0BAA0B,CAAC,cAAc,EAAEf,KAAa,CAAC,QAAQ,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,IAAI,SAAS,CAAC;EAClH,QAAQ,KAAK,QAAQ;EACrB,YAAY,OAAOgB,MAAiB,CAAC,eAAe,CAAC,CAAC;EACtD,QAAQ,KAAK,MAAM;EACnB,YAAY,OAAO,0BAA0B,CAAC,eAAe,CAAC,IAAI,EAAEC,MAAe,CAAC,QAAQ,CAAC,IAAI,EAAE,OAAO,EAAE,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;EAC3J,KAAK;EACL;EACA,IAAI,OAAO,eAAe,CAAC,QAAQ,CAAC,CAAC;EACrC,CAAC;EACD,SAAS,kBAAkB,CAAC,KAAK,EAAE;EACnC,IAAI,IAAI,EAAE,GAAG,KAAK,CAAC,SAAS,EAAE,OAAO,GAAG,EAAE,CAAC,OAAO,EAAE,OAAO,GAAG,EAAE,CAAC,OAAO,CAAC;EACzE,IAAI,IAAI,OAAO,GAAG,UAAU,KAAK,EAAE;EACnC,QAAQ,WAAW,CAAC,KAAK,CAAC,CAAC;EAC3B,QAAQ,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,UAAU,OAAO,EAAE;EACjE,YAAY,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,iBAAiB,CAAC,KAAK,CAAC,SAAS,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;EAC1F,YAAY,IAAI,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,QAAQ,EAAE;EACtD;EACA;EACA,gBAAgB,OAAO,CAAC,OAAO,CAAC,GAAG,oBAAoB,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC;EAC5G,gBAAgB,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;EACvC;EACA;EACA,oBAAoB,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,aAAa,CAAC;EAC5D,oBAAoB,OAAO,OAAO,CAAC,OAAO,CAAC,CAAC;EAC5C,iBAAiB;EACjB,aAAa;EACb,SAAS,CAAC,CAAC;EACX,KAAK,CAAC;EACN,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAChE,QAAQ,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC3B,QAAQ,OAAO,CAAC,KAAK,CAAC,CAAC;EACvB,KAAK;EACL,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,UAAU,OAAO,EAAE;EAC7C,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACpE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;EACnD;EACA,gBAAgB,SAAS;EACzB,aAAa;EACb,YAAY,IAAI,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,QAAQ,EAAE;EACtD;EACA,gBAAgB,OAAO,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;EACxD,aAAa;EACb,SAAS;EACT,KAAK,CAAC,CAAC;EACP,IAAI,OAAO,OAAO,CAAC;EACnB,CAAC;AACD,EAAO,SAAS,oBAAoB,CAAC,YAAY,EAAE,WAAW,EAAE;EAChE,IAAI,IAAI,CAAC,YAAY,EAAE;EACvB,QAAQ,OAAO,WAAW,CAAC,KAAK,EAAE,CAAC;EACnC,KAAK;EACL,IAAI,IAAI,YAAY,GAAG,YAAY,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;EAC9D,IAAI,IAAI,WAAW,GAAG,WAAW,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;EAC5D,IAAI,IAAI,YAAY,CAAC,QAAQ,IAAI,WAAW,CAAC,QAAQ,IAAI,YAAY,CAAC,KAAK,KAAK,WAAW,CAAC,KAAK,EAAE;EACnG;EACA;EACA,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK;EACL,IAAI,IAAI,UAAU,GAAG,KAAK,CAAC;EAC3B,IAAI,IAAI,OAAO,GAAG,UAAU,IAAI,EAAE;EAClC,QAAQ,IAAI,uBAAuB,GAAG,uBAAuB,CAAC,YAAY,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,WAAW,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,QAAQ;EACnJ;EACA,QAAQ,UAAU,EAAE,EAAE,EAAE,EAAE;EAC1B,YAAY,QAAQ,IAAI;EACxB,gBAAgB,KAAK,OAAO;EAC5B,oBAAoB,OAAO,mBAAmB,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;EACvD,gBAAgB,KAAK,MAAM;EAC3B;EACA,oBAAoB,UAAU,GAAG,IAAI,CAAC;EACtC,oBAAoB,OAAO,YAAY,CAAC,QAAQ,CAAC,CAAC;EAClD,aAAa;EACb,YAAY,OAAO,iBAAiB,CAAC,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;EAC7D,SAAS,CAAC,CAAC;EACX,QAAQ,YAAY,CAAC,eAAe,CAAC,IAAI,EAAE,uBAAuB,CAAC,CAAC;EACpE,KAAK,CAAC;EACN;EACA,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,sBAAsB,GAAG,oBAAoB,EAAE,EAAE,GAAG,sBAAsB,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC9G,QAAQ,IAAI,IAAI,GAAG,sBAAsB,CAAC,EAAE,CAAC,CAAC;EAC9C,QAAQ,OAAO,CAAC,IAAI,CAAC,CAAC;EACtB,KAAK;EACL,IAAI,IAAI,UAAU,EAAE;EACpB,QAAQ,IAAI,CAAC,CAAC,YAAY,CAAC,QAAQ,IAAI,EAAE,EAAE,MAAM,IAAI,EAAE,EAAE,QAAQ,EAAE;EACnE,YAAY,oBAAoB,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC,CAAC;EAChF,SAAS;EACT,QAAQ,IAAI,CAAC,CAAC,YAAY,CAAC,QAAQ,IAAI,EAAE,EAAE,MAAM,IAAI,EAAE,EAAE,QAAQ,EAAE;EACnE,YAAY,oBAAoB,CAAC,YAAY,CAAC,QAAQ,EAAE,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC,CAAC;EAChF,SAAS;EACT,KAAK;EACL,IAAI,OAAO,YAAY,CAAC;EACxB,CAAC;;ECpLM,SAAS,eAAe,CAAC,KAAK,EAAE;EACvC,IAAI,IAAI,oBAAoB,GAAG,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC;EACvD,IAAI,IAAI,cAAc,GAAG,EAAE,CAAC;EAC5B,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,oBAAoB,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC5E,QAAQ,IAAI,OAAO,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC7B,QAAQ,IAAI,cAAc,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;EAC9D,QAAQ,IAAI,UAAU,GAAGtC,WAAS,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;EAC3D,QAAQ,IAAI,cAAc,CAAC,UAAU,CAAC,EAAE;EACxC,YAAY,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,cAAc,CAAC,UAAU,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACpF,gBAAgB,IAAI,qBAAqB,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EACnD,gBAAgB,IAAI,MAAM,GAAG,oBAAoB,CAAC,qBAAqB,EAAE,oBAAoB,CAAC,OAAO,CAAC,CAAC,CAAC;EACxG,gBAAgB,IAAI,CAAC,MAAM,EAAE;EAC7B;EACA,oBAAoB,cAAc,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC,CAAC;EACnF,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,aAAa;EACb,YAAY,cAAc,CAAC,UAAU,CAAC,GAAG,CAAC,oBAAoB,CAAC,OAAO,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC;EACjF,SAAS;EACT,KAAK;EACL,IAAI,OAAO,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,GAAG,CAAC,UAAU,UAAU,EAAE,EAAE,OAAO,UAAU,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;EACrG,CAAC;;ECpBM,SAAS,mBAAmB,CAAC,KAAK,EAAE;EAC3C,IAAI,IAAI,YAAY,CAAC,KAAK,CAAC,IAAI,aAAa,CAAC,KAAK,CAAC,IAAI,aAAa,CAAC,KAAK,CAAC,EAAE;EAC7E,QAAQ,OAAO,sCAAsC,CAAC,KAAK,CAAC,CAAC;EAC7D,KAAK;EACL,SAAS;EACT,QAAQ,OAAO,0BAA0B,CAAC,KAAK,CAAC,CAAC;EACjD,KAAK;EACL,CAAC;AACD,EAAO,SAAS,sCAAsC,CAAC,KAAK,EAAE;EAC9D,IAAI,OAAO,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,WAAW,EAAE,KAAK,EAAE;EAC/D,QAAQ,OAAO,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,mBAAmB,EAAE,CAAC,CAAC;EAC/D,KAAK,EAAE,0BAA0B,CAAC,KAAK,CAAC,CAAC,CAAC;EAC1C,CAAC;AACD,EAAO,SAAS,0BAA0B,CAAC,KAAK,EAAE;EAClD,IAAI,IAAI,SAAS,GAAG,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC;EAC/C,IAAI,IAAI,CAAC,SAAS,IAAI,SAAS,CAAC,MAAM,EAAE;EACxC,QAAQ,OAAO,EAAE,CAAC;EAClB,KAAK;EACL,IAAI,IAAI,UAAU,GAAG,SAAS,CAAC,OAAO,EAAE,CAAC;EACzC,IAAI,IAAI,IAAI,GAAG,UAAU,CAAC,IAAI,EAAE,IAAI,GAAGI,MAAc,CAAC,UAAU,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;EAC5E,IAAI,IAAI,IAAI,GAAG;EACf,QAAQ,MAAM,EAAE,GAAG,GAAG,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,UAAU,GAAG,EAAE,EAAE,OAAO,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG;EAChG,KAAK,CAAC;EACN,IAAI,IAAI,GAAG,GAAG,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,UAAU,OAAO,EAAE,IAAI,EAAE;EAC7D,QAAQ,IAAI,MAAM,GAAG,aAAa,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,GAAG,QAAQ,GAAG,KAAK,CAAC,gBAAgB,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;EACxG,QAAQ,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,MAAM,CAAC,EAAE;EACxC;EACA,YAAY,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;EACjC,SAAS;EACT,QAAQ,OAAO,OAAO,CAAC;EACvB,KAAK,EAAE,EAAE,CAAC,CAAC;EACX,IAAI,IAAI,GAAG,CAAC,MAAM,IAAI,CAAC,EAAE;EACzB,QAAQ,MAAM,IAAI,KAAK,CAAC,+CAA+C,CAAC,CAAC;EACzE,KAAK;EACL,IAAI,OAAO,CAACL,QAAgB,CAAC,EAAE,IAAI,EAAE,IAAI;EACzC,YAAY,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE;EAC7B,gBAAgB,MAAM,EAAE,GAAG,CAAC,MAAM,GAAG,CAAC,GAAG,GAAG,GAAG,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC;EAC5E,aAAa,EAAE,EAAE,IAAI,CAAC,CAAC,CAAC;EACxB,CAAC;;EC1CM,IAAI,qBAAqB,GAAG;EACnC,IAAI,MAAM;EACV,IAAI,WAAW;EACf,IAAI,YAAY;EAChB,IAAI,QAAQ;EACZ,IAAI,QAAQ;EACZ,IAAI,WAAW;EACf,IAAI,aAAa;EACjB,IAAI,UAAU;EACd,IAAI,UAAU;EACd,IAAI,OAAO;EACX,IAAI,UAAU;EACd,IAAI,QAAQ;EACZ,IAAI,OAAO;EACX,IAAI,SAAS;EACb,IAAI,MAAM;EACV,CAAC,CAAC;;ECdF,IAAI,mBAAmB,kBAAkB,UAAU,MAAM,EAAE;EAC3D,IAAIkC,SAAiB,CAAC,mBAAmB,EAAE,MAAM,CAAC,CAAC;EACnD,IAAI,SAAS,mBAAmB,CAAC,IAAI,EAAE,mBAAmB,EAAE,IAAI,EAAE,IAAI,EAAE;EACxE,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAElC,QAAgB,CAAC,EAAE,EAAE,mBAAmB,CAAC;EAC/E,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE;EACtB,SAAS,IAAI,IAAI,CAAC;EAClB,QAAQ,KAAK,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;EACxD,QAAQ,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC;EAC1B,QAAQ,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC;EAC1B,QAAQ,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC;EAC7B,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,OAAO,mBAAmB,CAAC;EAC/B,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;;ECPH,SAAS,eAAe,CAAC,KAAK,EAAE;EACvC,IAAI,IAAI,WAAW,CAAC,KAAK,CAAC,EAAE;EAC5B,QAAQ,KAAK,CAAC,SAAS,CAAC,UAAU,GAAG,mBAAmB,CAAC,KAAK,CAAC,CAAC;EAChE,KAAK;EACL,SAAS;EACT;EACA;EACA;EACA;EACA,QAAQ,KAAK,CAAC,SAAS,CAAC,UAAU,GAAG,uBAAuB,CAAC,KAAK,CAAC,CAAC;EACpE,KAAK;EACL,CAAC;EACD,SAAS,mBAAmB,CAAC,KAAK,EAAE;EACpC,IAAI,IAAI,mBAAmB,GAAG,KAAK,CAAC,mBAAmB,EAAE,MAAM,GAAG,KAAK,CAAC,MAAM,EAAE,aAAa,GAAG,KAAK,CAAC,aAAa,CAAC;EACpH,IAAI,IAAI,aAAa,EAAE;EACvB,QAAQ,IAAI,MAAM,GAAG,EAAE,CAAC;EACxB,QAAQ,CAAC,CAAC,SAAS,EAAE,QAAQ,CAAC,EAAE,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC,CAAC,OAAO,CAAC,UAAU,aAAa,EAAE;EAC1F,YAAY,IAAI,KAAK,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,EAAE;EACpG,gBAAgB,MAAM,CAAC,IAAI,CAAC;EAC5B,oBAAoB,MAAM,EAAE,KAAK,CAAC,OAAO,CAAC,UAAU,GAAG,MAAM,CAAC,MAAM,CAAC;EACrE,iBAAiB,CAAC,CAAC;EACnB,aAAa;EACb,SAAS,CAAC,CAAC;EACX,QAAQ,IAAI,KAAK,CAAC,eAAe,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,IAAI,KAAK,OAAO,EAAE;EACpF,YAAY,MAAM,CAAC,IAAI,CAAC;EACxB,gBAAgB,MAAM,EAAE,KAAK,CAAC,OAAO,CAAC,UAAU,GAAG,MAAM,CAAC,MAAM,CAAC;EACjE,aAAa,CAAC,CAAC;EACf,SAAS;EACT,QAAQ,IAAI,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE;EACjC;EACA,YAAY,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,CAAC;EACrD,SAAS;EACT,QAAQ,OAAO,IAAI,mBAAmB,CAAC,KAAK,CAAC,cAAc,CAAC,IAAI,CAAC,EAAEA,QAAgB,CAAC,EAAE,GAAG,MAAM,CAAC,UAAU,IAAI,EAAE,IAAI,mBAAmB,IAAI,EAAE,EAAE,EAAE,CAAC,KAAK,CAAC,gBAAgB,CAAC,OAAO,CAAC,EAAE,KAAK,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;EAC9N,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;EACD,SAAS,iBAAiB,CAAC,KAAK,EAAE,MAAM,EAAE;EAC1C,IAAI,IAAI,mBAAmB,GAAG,KAAK,CAAC,qBAAqB,EAAE,UAAU,IAAI,EAAE;EAC3E;EACA,QAAQ,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC;EAChD,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;EACnD,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT;EACA,QAAQ,IAAI,KAAK,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC;EAC/C,YAAY,MAAM,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC;EAChD;EACA,YAAYC,WAAS,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,KAAKA,WAAS,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE;EACxE,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK,CAAC,CAAC;EACP,IAAI,IAAI,IAAI,GAAGA,WAAS,CAAC,KAAK,CAAC,IAAI,CAAC,KAAKA,WAAS,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;EAChE,IAAI,IAAI,IAAI,EAAE;EACd,QAAQ,IAAI,mBAAmB,EAAE;EACjC,YAAY,OAAO,KAAK,CAAC;EACzB,SAAS;EACT,aAAa,IAAIA,WAAS,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAKA,WAAS,CAAC,EAAE,CAAC,EAAE;EAC9D,YAAY,OAAO,MAAM,CAAC;EAC1B,SAAS;EACT,aAAa,IAAIA,WAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,KAAKA,WAAS,CAAC,EAAE,CAAC,EAAE;EAC/D,YAAY,OAAO,KAAK,CAAC;EACzB,SAAS;EACT,KAAK;EACL;EACA,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;EACD,SAAS,uBAAuB,CAAC,KAAK,EAAE;EACxC,IAAI,IAAI,KAAK,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;EACrC,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK;EACL,IAAI,IAAI,iBAAiB,CAAC;EAC1B,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,KAAK,CAAC,QAAQ,EAAE,UAAU,KAAK,EAAE;EAC1D,QAAQ,eAAe,CAAC,KAAK,CAAC,CAAC;EAC/B,QAAQ,IAAI,UAAU,GAAG,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC;EACpD,QAAQ,IAAI,CAAC,UAAU,EAAE;EACzB;EACA,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,aAAa,IAAI,CAAC,iBAAiB,EAAE;EACrC;EACA,YAAY,iBAAiB,GAAG,UAAU,CAAC;EAC3C,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,aAAa;EACb,YAAY,IAAI,KAAK,GAAG,iBAAiB,CAAC,iBAAiB,EAAE,UAAU,CAAC,CAAC;EACzE,YAAY,IAAI,KAAK,EAAE;EACvB,gBAAgB,iBAAiB,GAAG,KAAK,CAAC;EAC1C,aAAa;EACb,YAAY,OAAO,CAAC,CAAC,KAAK,CAAC;EAC3B,SAAS;EACT,KAAK,CAAC,CAAC;EACP;EACA,IAAI,IAAI,iBAAiB,IAAI,QAAQ,EAAE;EACvC;EACA,QAAQ,IAAI,MAAM,GAAG,KAAK,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;EAChD,QAAQ,IAAI,iBAAiB,GAAG,IAAI,mBAAmB,CAAC,MAAM,EAAE,iBAAiB,CAAC,mBAAmB,EAAE,iBAAiB,CAAC,IAAI,EAAE,SAAS,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC,CAAC;EAClK;EACA,QAAQ,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,KAAK,EAAE;EAChD,YAAY,IAAI,KAAK,CAAC,SAAS,CAAC,UAAU,EAAE;EAC5C,gBAAgB,iBAAiB,CAAC,IAAI,GAAG,iBAAiB,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;EACxG,gBAAgB,KAAK,CAAC,gBAAgB,CAAC,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,MAAM,CAAC,CAAC;EACvF,gBAAgB,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC;EACzD,aAAa;EACb,SAAS,CAAC,CAAC;EACX,QAAQ,OAAO,iBAAiB,CAAC;EACjC,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;;ECnHM,SAAS,WAAW,CAAC,IAAI,EAAE;EAClC,IAAI,OAAO,CAAC,CAAC,IAAI,KAAK,IAAI,CAAC,IAAI,CAAC,KAAK,OAAO,IAAI,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACjF,CAAC;AACD,EAAO,SAAS,WAAW,CAAC,IAAI,EAAE;EAClC,IAAI,OAAO,CAAC,CAAC,IAAI,IAAI,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;EACvF,CAAC;;;;;;;ECLD;EACA;EACA;EACA,IAAI,YAAY,kBAAkB,YAAY;EAC9C,IAAI,SAAS,YAAY,CAAC,MAAM,EAAE,SAAS,EAAE;EAC7C,QAAQ,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;EACnC,QAAQ,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;EAC5B,QAAQ,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;EAC5B,QAAQ,IAAI,MAAM,EAAE;EACpB,YAAY,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;EACjC,SAAS;EACT,KAAK;EACL;EACA;EACA;EACA,IAAI,YAAY,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EAC/C,QAAQ,MAAM,IAAI,KAAK,CAAC,mBAAmB,CAAC,CAAC;EAC7C,KAAK,CAAC;EACN;EACA;EACA;EACA,IAAI,YAAY,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACxD,QAAQ,OAAO,EAAE,CAAC;EAClB,KAAK,CAAC;EACN,IAAI,YAAY,CAAC,SAAS,CAAC,eAAe,GAAG,YAAY;EACzD,QAAQ,OAAO,EAAE,CAAC;EAClB,KAAK,CAAC;EACN,IAAI,MAAM,CAAC,cAAc,CAAC,YAAY,CAAC,SAAS,EAAE,QAAQ,EAAE;EAC5D,QAAQ,GAAG,EAAE,YAAY;EACzB,YAAY,OAAO,IAAI,CAAC,OAAO,CAAC;EAChC,SAAS;EACT;EACA;EACA;EACA,QAAQ,GAAG,EAAE,UAAU,MAAM,EAAE;EAC/B,YAAY,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;EAClC,YAAY,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;EAClC,SAAS;EACT,QAAQ,UAAU,EAAE,IAAI;EACxB,QAAQ,YAAY,EAAE,IAAI;EAC1B,KAAK,CAAC,CAAC;EACP,IAAI,MAAM,CAAC,cAAc,CAAC,YAAY,CAAC,SAAS,EAAE,UAAU,EAAE;EAC9D,QAAQ,GAAG,EAAE,YAAY;EACzB,YAAY,OAAO,IAAI,CAAC,SAAS,CAAC;EAClC,SAAS;EACT,QAAQ,UAAU,EAAE,IAAI;EACxB,QAAQ,YAAY,EAAE,IAAI;EAC1B,KAAK,CAAC,CAAC;EACP,IAAI,YAAY,CAAC,SAAS,CAAC,WAAW,GAAG,YAAY;EACrD,QAAQ,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;EACrC,KAAK,CAAC;EACN,IAAI,YAAY,CAAC,SAAS,CAAC,QAAQ,GAAG,UAAU,KAAK,EAAE;EACvD,QAAQ,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;EACnC,KAAK,CAAC;EACN,IAAI,YAAY,CAAC,SAAS,CAAC,WAAW,GAAG,UAAU,QAAQ,EAAE;EAC7D,QAAQ,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;EACnE,KAAK,CAAC;EACN;EACA;EACA;EACA,IAAI,YAAY,CAAC,SAAS,CAAC,MAAM,GAAG,YAAY;EAChD,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,SAAS,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACpE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC;EACxC,SAAS;EACT,QAAQ,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;EACvC,KAAK,CAAC;EACN;EACA;EACA;EACA,IAAI,YAAY,CAAC,SAAS,CAAC,gBAAgB,GAAG,UAAU,KAAK,EAAE;EAC/D,QAAQ,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;EAClC,QAAQ,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;EACjC,QAAQ,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;EAC7B,QAAQ,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC;EAC5B,KAAK,CAAC;EACN,IAAI,YAAY,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACxD,QAAQ,IAAI,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC;EAClC,QAAQ,IAAI,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC;EACtC;EACA,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,SAAS,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACpE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;EAClC,SAAS;EACT;EACA,QAAQ,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;EAC5B,QAAQ,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;EACjC,QAAQ,MAAM,CAAC,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;EAC1C;EACA,QAAQ,IAAI,CAAC,MAAM,GAAG,SAAS,CAAC;EAChC,QAAQ,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC;EAC7B,KAAK,CAAC;EACN,IAAI,OAAO,YAAY,CAAC;EACxB,CAAC,EAAE,CAAC,CAAC;AACL,EACA,IAAI,UAAU,kBAAkB,UAAU,MAAM,EAAE;EAClD,IAAIiC,SAAiB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;EAC1C;EACA;EACA;EACA;EACA;EACA,IAAI,SAAS,UAAU,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,SAAS,EAAE;EACzD,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC;EAC9D,QAAQ,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC;EAC1B,QAAQ,KAAK,CAAC,SAAS,GAAG,SAAS,CAAC;EACpC,QAAQ,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC,KAAK,GAAG,MAAM,CAAC;EAC7C,QAAQ,IAAI,KAAK,CAAC,SAAS,IAAI,EAAE,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC,SAAS,CAAC,EAAE;EAClE,YAAY,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;EAC7C,SAAS;EACT,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,UAAU,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EAC7C,QAAQ,IAAI,QAAQ,GAAG,IAAI,IAAI,CAAC,WAAW,CAAC;EAC5C,QAAQ,QAAQ,CAAC,SAAS,GAAG,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC;EACvD,QAAQ,QAAQ,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;EACxC,QAAQ,QAAQ,CAAC,KAAK,GAAG,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC;EAC/C,QAAQ,QAAQ,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;EAClC,QAAQ,QAAQ,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;EAC5C,QAAQ,QAAQ,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;EAC/C,QAAQ,OAAO,QAAQ,CAAC;EACxB,KAAK,CAAC;EACN;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,IAAI,UAAU,CAAC,SAAS,CAAC,SAAS,GAAG,YAAY;EACjD,QAAQ,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC;EACrC,QAAQ,OAAO,IAAI,CAAC,OAAO,CAAC;EAC5B,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,UAAU,GAAG,YAAY;EAClD,QAAQ,OAAO,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;EAC5C,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,SAAS,GAAG,UAAU,MAAM,EAAE;EACvD,QAAQ,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;EAC9B,KAAK,CAAC;EACN,IAAI,OAAO,UAAU,CAAC;EACtB,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;;EC1IjB;EACA;EACA;EACA,IAAI,aAAa,kBAAkB,UAAU,MAAM,EAAE;EACrD,IAAIA,SAAiB,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;EAC7C,IAAI,SAAS,aAAa,CAAC,MAAM,EAAE,SAAS,EAAE;EAC9C,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC;EACtD,QAAQ,KAAK,CAAC,SAAS,GAAG,SAAS,CAAC;EACpC,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,aAAa,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EAChD,QAAQ,OAAO,IAAI,aAAa,CAAC,IAAI,EAAE,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;EAClE,KAAK,CAAC;EACN,IAAI,aAAa,CAAC,oBAAoB,GAAG,UAAU,MAAM,EAAE,KAAK,EAAE;EAClE;EACA,QAAQ,KAAK,CAAC,eAAe,CAAC,UAAU,QAAQ,EAAE,OAAO,EAAE;EAC3D,YAAY,IAAI,eAAe,CAAC,QAAQ,CAAC,IAAI,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;EACzE,gBAAgB,IAAI,SAAS,GAAG;EAChC,oBAAoB,SAAS,EAAE,aAAa,CAAC,gCAAgC,CAAC,QAAQ,CAAC,KAAK,EAAE,QAAQ,CAAC,IAAI,CAAC;EAC5G,oBAAoB,EAAE,EAAE,mBAAmB,CAAC,KAAK,EAAE,OAAO,CAAC;EAC3D,iBAAiB,CAAC;EAClB,gBAAgB,MAAM,GAAG,IAAI,aAAa,CAAC,MAAM,EAAE,SAAS,CAAC,CAAC;EAC9D,aAAa;EACb,SAAS,CAAC,CAAC;EACX,QAAQ,OAAO,MAAM,CAAC;EACtB,KAAK,CAAC;EACN,IAAI,aAAa,CAAC,gCAAgC,GAAG,UAAU,KAAK,EAAE,UAAU,EAAE;EAClF,QAAQ,IAAI,UAAU,GAAG,EAAE,CAAC;EAC5B,QAAQ,IAAI,CAAC,CAAC;EACd,QAAQ,KAAK,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;EAChD,YAAY,UAAU,IAAI,QAAQ,GAAG,KAAK,GAAG,QAAQ,GAAG,UAAU,CAAC,CAAC,CAAC,GAAG,MAAM,GAAG,CAAC,GAAG,KAAK,CAAC;EAC3F,SAAS;EACT,QAAQ,UAAU,IAAI,CAAC,CAAC;EACxB,QAAQ,OAAO,UAAU,CAAC;EAC1B,KAAK,CAAC;EACN,IAAI,aAAa,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACzD,QAAQ,IAAI,GAAG,GAAG,EAAE,CAAC;EACrB,QAAQ,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC;EACtC,QAAQ,OAAO,GAAG,CAAC;EACnB,KAAK,CAAC;EACN,IAAI,aAAa,CAAC,SAAS,CAAC,QAAQ,GAAG,YAAY;EACnD,QAAQ,OAAO;EACf,YAAY,IAAI,EAAE,SAAS;EAC3B,YAAY,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,SAAS;EAC1C,YAAY,EAAE,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE;EACjC,SAAS,CAAC;EACV,KAAK,CAAC;EACN,IAAI,OAAO,aAAa,CAAC;EACzB,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;AACjB,EACO,SAAS,mBAAmB,CAAC,KAAK,EAAE,OAAO,EAAE;EACpD,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC3C,IAAI,OAAO,OAAO,GAAG,GAAG,GAAG,OAAO,CAAC,QAAQ,CAAC,GAAG,aAAa,CAAC;EAC7D,CAAC;;ECnDD,SAAS,YAAY,CAAC,IAAI,EAAE,OAAO,EAAE,QAAQ,EAAE;EAC/C,IAAI,IAAI,QAAQ,CAAC,GAAG,EAAE;EACtB,QAAQ,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC,GAAG,IAAI,CAAC;EAC3C,QAAQ,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC,GAAG,IAAI,CAAC;EAC7D,QAAQ,IAAI,gBAAgB,CAAC,QAAQ,EAAE,OAAO,CAAC,EAAE;EACjD,YAAY,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,SAAS,EAAE,OAAO,EAAE,CAAC,CAAC,GAAG,IAAI,CAAC;EACnE,SAAS;EACT,KAAK;EACL,SAAS;EACT,QAAQ,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,GAAG,IAAI,CAAC;EACvC,KAAK;EACL,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;EACD,SAAS,aAAa,CAAC,cAAc,EAAE,aAAa,EAAE;EACtD,IAAI,KAAK,IAAI,CAAC,IAAI,aAAa,EAAE;EACjC,QAAQ,IAAI,aAAa,CAAC,cAAc,CAAC,CAAC,CAAC,EAAE;EAC7C;EACA,YAAY,IAAI,GAAG,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC;EACvC,YAAY,KAAK,IAAI,EAAE,IAAI,GAAG,EAAE;EAChC,gBAAgB,IAAI,GAAG,CAAC,cAAc,CAAC,EAAE,CAAC,EAAE;EAC5C,oBAAoB,IAAI,CAAC,IAAI,cAAc,EAAE;EAC7C;EACA,wBAAwB,cAAc,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,EAAE,CAAC,CAAC;EACxD,qBAAqB;EACrB,yBAAyB;EACzB,wBAAwB,cAAc,CAAC,CAAC,CAAC,GAAG,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC;EAC5D,qBAAqB;EACrB,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,KAAK;EACL,CAAC;EACD,IAAI,aAAa,kBAAkB,UAAU,MAAM,EAAE;EACrD,IAAIA,SAAiB,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;EAC7C;EACA;EACA;EACA;EACA,IAAI,SAAS,aAAa,CAAC,MAAM,EAAE,UAAU,EAAE,QAAQ,EAAE;EACzD,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC;EACtD,QAAQ,KAAK,CAAC,UAAU,GAAG,UAAU,CAAC;EACtC,QAAQ,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC;EAClC,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,aAAa,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EAChD,QAAQ,OAAO,IAAI,aAAa,CAAC,IAAI,EAAElC,QAAgB,CAAC,EAAE,EAAE,IAAI,CAAC,UAAU,CAAC,EAAE,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;EACxG,KAAK,CAAC;EACN,IAAI,aAAa,CAAC,gBAAgB,GAAG,UAAU,MAAM,EAAE,KAAK,EAAE;EAC9D,QAAQ,IAAI,WAAW,GAAG,KAAK,CAAC;EAChC,QAAQ,KAAK,CAAC,eAAe,CAAC,UAAU,EAAE,EAAE;EAC5C,YAAY,IAAI,EAAE,CAAC,SAAS,EAAE;EAC9B,gBAAgB,WAAW,GAAG,IAAI,CAAC;EACnC,aAAa;EACb,SAAS,CAAC,CAAC;EACX,QAAQ,IAAI,IAAI,GAAG,EAAE,CAAC;EACtB,QAAQ,IAAI,IAAI,GAAG,EAAE,CAAC;EACtB,QAAQ,IAAI,CAAC,WAAW,EAAE;EAC1B;EACA,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,QAAQ,KAAK,CAAC,eAAe,CAAC,UAAU,QAAQ,EAAE,OAAO,EAAE;EAC3D,YAAY,IAAI,SAAS,GAAG,QAAQ,CAAC,SAAS,EAAE,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC;EACvE,YAAY,IAAI,SAAS,EAAE;EAC3B,gBAAgB,IAAI,SAAS,KAAK,OAAO,EAAE;EAC3C,oBAAoB,IAAI,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;EAChD,oBAAoB,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;EAC3D,iBAAiB;EACjB,qBAAqB;EACrB,oBAAoB,IAAI,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;EACpD,oBAAoB,IAAI,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;EAC/D;EACA,oBAAoB,IAAI,cAAc,CAAC,OAAO,CAAC,IAAI,KAAK,CAAC,WAAW,CAAC,OAAO,CAAC,KAAK,cAAc,EAAE;EAClG,wBAAwB,IAAI,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,GAAG,OAAO,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC;EACzF,wBAAwB,IAAI,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,GAAG,OAAO,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC;EACzF,qBAAqB;EACrB,iBAAiB;EACjB,aAAa;EACb,iBAAiB;EACjB,gBAAgB,YAAY,CAAC,IAAI,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;EACtD,aAAa;EACb,SAAS,CAAC,CAAC;EACX,QAAQ,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,MAAM,CAAC,EAAE;EAC3D,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,QAAQ,OAAO,IAAI,aAAa,CAAC,MAAM,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;EACrD,KAAK,CAAC;EACN,IAAI,aAAa,CAAC,iBAAiB,GAAG,UAAU,MAAM,EAAE,CAAC,EAAE;EAC3D,QAAQ,IAAI,IAAI,GAAG,EAAE,CAAC;EACtB,QAAQ,IAAI,IAAI,GAAG,EAAE,CAAC;EACtB,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC,SAAS,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACjE,YAAY,IAAI,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC3B,YAAY,IAAI,EAAE,GAAG,CAAC,CAAC,EAAE,EAAE,KAAK,GAAG,CAAC,CAAC,KAAK,EAAE,EAAE,GAAG,CAAC,CAAC,EAAE,CAAC;EACtD,YAAY,IAAI,EAAE,EAAE;EACpB,gBAAgB,IAAI,EAAE,KAAK,OAAO,EAAE;EACpC,oBAAoB,IAAI,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;EAChD,oBAAoB,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,GAAG,EAAE,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC;EAC1D,iBAAiB;EACjB,qBAAqB;EACrB,oBAAoB,IAAI,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;EACpD,oBAAoB,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC;EACvD,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC,OAAO,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACrE,YAAY,IAAI,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC3B,YAAY,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;EAC3B,SAAS;EACT,QAAQ,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,MAAM,CAAC,EAAE;EAC3D,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,QAAQ,OAAO,IAAI,aAAa,CAAC,MAAM,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;EACrD,KAAK,CAAC;EACN,IAAI,aAAa,CAAC,SAAS,CAAC,KAAK,GAAG,UAAU,KAAK,EAAE;EACrD,QAAQ,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,EAAE,KAAK,CAAC,UAAU,CAAC,EAAE;EACxD,YAAY,aAAa,CAAC,IAAI,CAAC,QAAQ,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;EACzD,YAAY,KAAK,CAAC,MAAM,EAAE,CAAC;EAC3B,SAAS;EACT,aAAa;EACb,YAAYwC,KAAS,CAAC,oCAAoC,CAAC,CAAC;EAC5D,SAAS;EACT,KAAK,CAAC;EACN,IAAI,aAAa,CAAC,SAAS,CAAC,aAAa,GAAG,UAAU,MAAM,EAAE;EAC9D,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC;EACzB,QAAQ,MAAM,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC;EAC5E,KAAK,CAAC;EACN,IAAI,aAAa,CAAC,SAAS,CAAC,eAAe,GAAG,YAAY;EAC1D,QAAQ,IAAI,GAAG,GAAG,EAAE,CAAC;EACrB,QAAQ,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC;EAC9E,QAAQ,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC;EAC5E,QAAQ,OAAO,GAAG,CAAC;EACnB,KAAK,CAAC;EACN,IAAI,aAAa,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACzD,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC;EACzB,QAAQ,IAAI,GAAG,GAAG,EAAE,CAAC;EACrB,QAAQ,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,UAAU,KAAK,EAAE;EACrD,YAAY,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE;EAC9D,gBAAgB,GAAG,CAAC,EAAE,GAAG,GAAG,GAAG,KAAK,CAAC,GAAG,IAAI,CAAC;EAC7C,aAAa,CAAC,CAAC;EACf,SAAS,CAAC,CAAC;EACX,QAAQ,OAAO,GAAG,CAAC;EACnB,KAAK,CAAC;EACN,IAAI,aAAa,CAAC,SAAS,CAAC,QAAQ,GAAG,YAAY;EACnD,QAAQ,IAAI,GAAG,GAAG,EAAE,CAAC;EACrB,QAAQ,IAAI,MAAM,GAAG,EAAE,CAAC;EACxB,QAAQ,IAAI,EAAE,GAAG,EAAE,CAAC;EACpB,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACzE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACpF,gBAAgB,IAAI,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAChC,gBAAgB,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;EAClD,gBAAgB,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;EAC7B,gBAAgB,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;EACnC,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,MAAM,GAAG;EACrB,YAAY,IAAI,EAAE,WAAW;EAC7B,YAAY,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC;EAC1C,YAAY,GAAG,EAAE,GAAG;EACpB,YAAY,MAAM,EAAE,MAAM;EAC1B,YAAY,EAAE,EAAE,EAAE;EAClB,SAAS,CAAC;EACV,QAAQ,OAAO,MAAM,CAAC;EACtB,KAAK,CAAC;EACN,IAAI,OAAO,aAAa,CAAC;EACzB,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;;ECpKjB;EACA;EACA;EACA,IAAI,SAAS,kBAAkB,UAAU,MAAM,EAAE;EACjD,IAAIN,SAAiB,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;EACzC;EACA;EACA;EACA;EACA;EACA,IAAI,SAAS,SAAS,CAAC,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE;EAClD,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC;EACtD,QAAQ,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC;EAC5B,QAAQ,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC;EAC1B,QAAQ,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC;EAC1B,QAAQ,IAAI,KAAK,CAAC,KAAK,CAAC,MAAM,EAAE;EAChC,YAAY,KAAK,CAAC,YAAY,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;EACzD,YAAY,KAAK,CAAC,UAAU,GAAG,KAAK,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC;EAC9D,YAAY,IAAI,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE;EAC5C,gBAAgB,KAAK,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;EACrF,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,KAAK,CAAC,KAAK,CAAC,GAAG,EAAE;EAC7B,YAAY,KAAK,CAAC,SAAS,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;EACnD,YAAY,KAAK,CAAC,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;EACxD,YAAY,IAAI,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE;EACzC,gBAAgB,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;EAC/E,aAAa;EACb,SAAS;EACT,QAAQ,KAAK,CAAC,UAAU,GAAG,KAAK,CAAC,KAAK,CAAC;EACvC,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,SAAS,EAAE,QAAQ,EAAE;EACzD,QAAQ,GAAG,EAAE,YAAY;EACzB,YAAY,IAAI,MAAM,GAAG,EAAE,CAAC;EAC5B,YAAY,IAAI,IAAI,CAAC,YAAY,EAAE;EACnC,gBAAgB,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;EAC1D,aAAa;EACb,YAAY,IAAI,IAAI,CAAC,SAAS,EAAE;EAChC,gBAAgB,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;EACvD,aAAa;EACb,YAAY,OAAO,MAAM,CAAC;EAC1B,SAAS;EACT,QAAQ,UAAU,EAAE,IAAI;EACxB,QAAQ,YAAY,EAAE,IAAI;EAC1B,KAAK,CAAC,CAAC;EACP;EACA;EACA;EACA,IAAI,SAAS,CAAC,SAAS,CAAC,SAAS,GAAG,YAAY;EAChD,QAAQ,OAAO,IAAI,CAAC,IAAI,CAAC;EACzB,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,iCAAiC,GAAG,YAAY;EACxE,QAAQ,IAAI,8BAA8B,GAAG,EAAE,CAAC;EAChD,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAChE,YAAY,IAAI,OAAO,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EACjC,YAAY,IAAI,mBAAmB,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;EAChF,YAAY,IAAI,mBAAmB,IAAI,CAAC,mBAAmB,CAAC,MAAM,EAAE;EACpE,gBAAgB,IAAI,IAAI,GAAG,mBAAmB,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAC3D,gBAAgB,IAAI,KAAK,GAAG,mBAAmB,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;EAC7D,gBAAgB,IAAI,iBAAiB,CAAC,IAAI,CAAC,IAAI,aAAa,CAAC,KAAK,CAAC,EAAE;EACrE,oBAAoB,IAAI,MAAM,GAAG,cAAc,CAAC,IAAI,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;EAC1E,oBAAoB,IAAI,KAAK,GAAG,kBAAkB,CAAC,MAAM,CAAC,CAAC;EAC3D,oBAAoB,IAAI,KAAK,EAAE;EAC/B,wBAAwB,8BAA8B,CAAC,OAAO,CAAC,GAAG,KAAK,CAAC;EACxE,qBAAqB;EACrB,yBAAyB;EACzB,wBAAwB1B,IAAQ,CAAC,4DAA4D,CAAC,CAAC;EAC/F,qBAAqB;EACrB,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,QAAQ,OAAO,8BAA8B,CAAC;EAC9C,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,qBAAqB,GAAG,UAAU,OAAO,EAAE,eAAe,EAAE,8BAA8B,EAAE;EACpH,QAAQ,IAAI,mBAAmB,GAAG,EAAE,CAAC;EACrC,QAAQ,IAAI,YAAY,GAAG,OAAO,KAAK,KAAK,GAAG,GAAG,GAAG,GAAG,CAAC;EACzD,QAAQ,IAAI,8BAA8B,CAAC,YAAY,CAAC,EAAE;EAC1D,YAAY,IAAI,eAAe,EAAE;EACjC,gBAAgB,mBAAmB,GAAG;EACtC;EACA,oBAAoB,MAAM,EAAE,CAAC,WAAW,GAAG,8BAA8B,CAAC,YAAY,CAAC,CAAC;EACxF,oBAAoB,GAAG,EAAE,CAAC,KAAK,CAAC;EAChC;EACA,oBAAoB,EAAE,EAAE,CAAC,WAAW,GAAG,8BAA8B,CAAC,YAAY,CAAC,CAAC;EACpF,iBAAiB,CAAC;EAClB,aAAa;EACb,iBAAiB;EACjB,gBAAgB,mBAAmB,GAAG;EACtC;EACA,oBAAoB,MAAM,EAAE,CAAC,8BAA8B,CAAC,YAAY,CAAC,CAAC;EAC1E,oBAAoB,GAAG,EAAE,CAAC,UAAU,CAAC;EACrC,iBAAiB,CAAC;EAClB,aAAa;EACb,SAAS;EACT,QAAQ,OAAO;EACf,YAAY,IAAI,EAAE,OAAO,KAAK,KAAK,GAAG,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,UAAU;EACpE;EACA,YAAY,MAAM,EAAE,eAAe,IAAI,IAAI,CAAC,IAAI;EAChD,YAAY,SAAS,EAAE,CAACR,QAAgB,CAAC,EAAE,IAAI,EAAE,WAAW,EAAE,OAAO,EAAE,OAAO,KAAK,KAAK,GAAG,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,YAAY,EAAE,EAAE,mBAAmB,CAAC,CAAC;EACtJ,SAAS,CAAC;EACV,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,QAAQ,GAAG,YAAY;EAC/C,QAAQ,IAAI,IAAI,GAAG,EAAE,CAAC;EACtB,QAAQ,IAAI,eAAe,GAAG,IAAI,CAAC;EACnC,QAAQ,IAAI,8BAA8B,GAAG,IAAI,CAAC,iCAAiC,EAAE,CAAC;EACtF,QAAQ,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,OAAO,KAAK,8BAA8B,CAAC,CAAC,IAAI,8BAA8B,CAAC,CAAC,CAAC,EAAE;EACvH;EACA,YAAY,eAAe,GAAG,QAAQ,GAAG,IAAI,CAAC,UAAU,GAAG,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC;EAC9E,YAAY,IAAI,MAAM,GAAG,EAAE,CAAC,MAAM,CAAC,8BAA8B,CAAC,CAAC,GAAG,CAAC,8BAA8B,CAAC,CAAC,CAAC,GAAG,EAAE,EAAE,8BAA8B,CAAC,CAAC,GAAG,CAAC,8BAA8B,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;EAC3L,YAAY,IAAI,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC,YAAY,EAAE,OAAO,UAAU,CAAC,EAAE,CAAC,CAAC;EACrE,YAAY,IAAI,CAAC,IAAI,CAAC;EACtB,gBAAgB,IAAI,EAAE,eAAe;EACrC,gBAAgB,MAAM,EAAE,IAAI,CAAC,IAAI;EACjC,gBAAgB,SAAS,EAAE,CAAC;EAC5B,wBAAwB,IAAI,EAAE,WAAW;EACzC,wBAAwB,OAAO,EAAE,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;EACzE,wBAAwB,MAAM,EAAE,MAAM;EACtC,wBAAwB,GAAG,EAAE,GAAG;EAChC,qBAAqB,CAAC;EACtB,aAAa,CAAC,CAAC;EACf,SAAS;EACT,QAAQ,IAAI,IAAI,CAAC,UAAU,EAAE;EAC7B,YAAY,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,QAAQ,EAAE,eAAe,EAAE,8BAA8B,CAAC,CAAC,CAAC;EAC7G,SAAS;EACT,QAAQ,IAAI,IAAI,CAAC,OAAO,EAAE;EAC1B,YAAY,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,KAAK,EAAE,eAAe,EAAE,8BAA8B,CAAC,CAAC,CAAC;EAC1G,SAAS;EACT,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK,CAAC;EACN,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;;ECnIjB,IAAI,iBAAiB,kBAAkB,UAAU,MAAM,EAAE;EACzD,IAAIkC,SAAiB,CAAC,iBAAiB,EAAE,MAAM,CAAC,CAAC;EACjD,IAAI,SAAS,iBAAiB,CAAC,MAAM,EAAE,SAAS,EAAE;EAClD,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC;EACtD,QAAQ,KAAK,CAAC,SAAS,GAAG,SAAS,CAAC;EACpC,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,iBAAiB,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EACpD,QAAQ,OAAO,IAAI,iBAAiB,CAAC,IAAI,EAAElC,QAAgB,CAAC,EAAE,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;EACjF,KAAK,CAAC;EACN,IAAI,iBAAiB,CAAC,IAAI,GAAG,UAAU,MAAM,EAAE,KAAK,EAAE;EACtD,QAAQ,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,EAAE,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC;EACrD,QAAQ,IAAI,MAAM,CAAC,aAAa,KAAK,QAAQ,EAAE;EAC/C,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,QAAQ,IAAI,MAAM,GAAG,KAAK,CAAC,cAAc,CAAC,UAAU,UAAU,EAAE,QAAQ,EAAE,OAAO,EAAE;EACnF,YAAY,IAAI,cAAc,GAAG,cAAc,CAAC,OAAO,CAAC,IAAI,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;EAC7F,YAAY,IAAI,cAAc,EAAE;EAChC,gBAAgB,IAAI,SAAS,GAAG,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAC3D;EACA;EACA;EACA,gBAAgB,IAAI,mBAAmB,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE;EAChG,oBAAoB,UAAU,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,QAAQ,CAAC;EAC1D,iBAAiB;EACjB,aAAa;EACb,YAAY,OAAO,UAAU,CAAC;EAC9B,SAAS,EAAE,EAAE,CAAC,CAAC;EACf,QAAQ,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE;EAClC,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,QAAQ,OAAO,IAAI,iBAAiB,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;EACrD,KAAK,CAAC;EACN,IAAI,MAAM,CAAC,cAAc,CAAC,iBAAiB,CAAC,SAAS,EAAE,QAAQ,EAAE;EACjE,QAAQ,GAAG,EAAE,YAAY;EACzB,YAAY,OAAO,IAAI,CAAC,SAAS,CAAC;EAClC,SAAS;EACT,QAAQ,UAAU,EAAE,IAAI;EACxB,QAAQ,YAAY,EAAE,IAAI;EAC1B,KAAK,CAAC,CAAC;EACP;EACA,IAAI,iBAAiB,CAAC,SAAS,CAAC,QAAQ,GAAG,YAAY;EACvD,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC;EACzB,QAAQ,IAAI,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,UAAU,WAAW,EAAE,KAAK,EAAE;EAC7E,YAAY,IAAI,QAAQ,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;EAClD,YAAY,IAAI,GAAG,GAAGyC,OAAQ,CAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;EAC5D,YAAY,IAAI,QAAQ,KAAK,IAAI,EAAE;EACnC,gBAAgB,WAAW,CAAC,IAAI,CAAC,GAAG,GAAG,WAAW,CAAC,CAAC;EACpD,gBAAgB,WAAW,CAAC,IAAI,CAAC,SAAS,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;EACxD,aAAa;EACb,YAAY,OAAO,WAAW,CAAC;EAC/B,SAAS,EAAE,EAAE,CAAC,CAAC;EACf,QAAQ,OAAO,OAAO,CAAC,MAAM,GAAG,CAAC;EACjC,YAAY;EACZ,gBAAgB,IAAI,EAAE,QAAQ;EAC9B,gBAAgB,IAAI,EAAE,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC;EAC1C,aAAa,GAAG,IAAI,CAAC;EACrB,KAAK,CAAC;EACN,IAAI,OAAO,iBAAiB,CAAC;EAC7B,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;;ECrDjB;EACA;EACA;EACA;EACA,SAAS,eAAe,CAAClC,QAAK,EAAE,KAAK,EAAE;EACvC,IAAI,IAAI,CAAC,GAAG,mBAAmB,CAACA,QAAK,CAAC,CAAC;EACvC,IAAI,IAAI,KAAK,KAAK,QAAQ,EAAE;EAC5B,QAAQ,OAAO,WAAW,GAAG,CAAC,GAAG,GAAG,CAAC;EACrC,KAAK;EACL,SAAS,IAAI,KAAK,KAAK,SAAS,EAAE;EAClC,QAAQ,OAAO,YAAY,GAAG,CAAC,GAAG,GAAG,CAAC;EACtC,KAAK;EACL,SAAS,IAAI,KAAK,KAAK,QAAQ,EAAE;EACjC,QAAQ,OAAO,WAAW,GAAG,CAAC,GAAG,GAAG,CAAC;EACrC,KAAK;EACL,SAAS,IAAI,KAAK,KAAK,MAAM,EAAE;EAC/B,QAAQ,OAAO,SAAS,GAAG,CAAC,GAAG,GAAG,CAAC;EACnC,KAAK;EACL,SAAS,IAAI,KAAK,KAAK,SAAS,EAAE;EAClC,QAAQ,OAAO,CAAC,CAAC;EACjB,KAAK;EACL,SAAS,IAAI,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;EAC3C,QAAQ,IAAI,SAAS,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;EACrD,QAAQ,OAAO,YAAY,GAAG,CAAC,GAAG,GAAG,GAAG,SAAS,GAAG,GAAG,CAAC;EACxD,KAAK;EACL,SAAS,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE;EAC1C,QAAQ,IAAI,SAAS,GAAG,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;EACrD,QAAQ,OAAO,WAAW,GAAG,CAAC,GAAG,GAAG,GAAG,SAAS,GAAG,GAAG,CAAC;EACvD,KAAK;EACL,SAAS;EACT,QAAQC,IAAQ,CAACC,OAAW,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC,CAAC;EACvD,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,CAAC;EACD,IAAI,SAAS,kBAAkB,UAAU,MAAM,EAAE;EACjD,IAAIyB,SAAiB,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;EACzC,IAAI,SAAS,SAAS,CAAC,MAAM,EAAE,KAAK,EAAE;EACtC,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC;EACtD,QAAQ,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC;EAC7B,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,SAAS,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EAC5C,QAAQ,OAAO,IAAI,SAAS,CAAC,IAAI,EAAE,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;EAC3D,KAAK,CAAC;EACN;EACA;EACA;EACA,IAAI,SAAS,CAAC,YAAY,GAAG,UAAU,MAAM,EAAE,KAAK,EAAE,aAAa,EAAE;EACrE;EACA,QAAQ,IAAI,QAAQ,GAAG,EAAE,CAAC;EAC1B,QAAQ,IAAI,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC;EAC9B,QAAQ,IAAI,IAAI,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE;EACtD,YAAY,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;EACzC,SAAS;EACT,QAAQ,OAAO,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,QAAQ,EAAE,EAAE,EAAE,aAAa,CAAC,CAAC;EAC3E,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,+BAA+B,GAAG,UAAU,MAAM,EAAE,SAAS,EAAE,aAAa,EAAE;EAC5F,QAAQ,IAAI,KAAK,GAAG,EAAE,CAAC;EACvB,QAAQ,WAAW,CAAC,SAAS,CAAC,MAAM,EAAE,UAAU,MAAM,EAAE;EACxD,YAAY,IAAI,gBAAgB,CAAC,MAAM,CAAC,EAAE;EAC1C;EACA,gBAAgB,IAAI,GAAG,GAAG,IAAI,CAAC;EAC/B;EACA;EACA;EACA,gBAAgB,IAAI,qBAAqB,CAAC,MAAM,CAAC,EAAE;EACnD,oBAAoB,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC;EACvC,iBAAiB;EACjB,qBAAqB,IAAI,qBAAqB,CAAC,MAAM,CAAC,EAAE;EACxD,oBAAoB,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;EAC1C,iBAAiB;EACjB,qBAAqB,IAAI,qBAAqB,CAAC,MAAM,CAAC,EAAE;EACxD,oBAAoB,GAAG,GAAG,CAAC,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC;EAC5D,iBAAiB;EACjB,gBAAgB,IAAI,GAAG,EAAE;EACzB,oBAAoB,IAAI,UAAU,CAAC,GAAG,CAAC,EAAE;EACzC,wBAAwB,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,MAAM,CAAC;EACrD,qBAAqB;EACrB,yBAAyB,IAAI,QAAQ,CAAC,GAAG,CAAC,EAAE;EAC5C,wBAAwB,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,QAAQ,CAAC;EACvD,qBAAqB;EACrB,yBAAyB,IAAI,QAAQ,CAAC,GAAG,CAAC,EAAE;EAC5C,wBAAwB,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,QAAQ,CAAC;EACvD,qBAAqB;EACrB,iBAAiB;EACjB,gBAAgB,IAAI,MAAM,CAAC,QAAQ,EAAE;EACrC,oBAAoB,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,MAAM,CAAC;EACjD,iBAAiB;EACjB,aAAa;EACb,SAAS,CAAC,CAAC;EACX,QAAQ,IAAI,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE;EACtC,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,QAAQ,OAAO,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,EAAE,EAAE,KAAK,EAAE,aAAa,CAAC,CAAC;EACxE,KAAK,CAAC;EACN;EACA;EACA;EACA,IAAI,SAAS,CAAC,wBAAwB,GAAG,UAAU,MAAM,EAAE,KAAK,EAAE,aAAa,EAAE;EACjF,QAAQ,IAAI,QAAQ,GAAG,EAAE,CAAC;EAC1B,QAAQ,IAAI,WAAW,CAAC,KAAK,CAAC,IAAI,YAAY,CAAC,KAAK,CAAC,EAAE;EACvD;EACA,YAAY,KAAK,CAAC,eAAe,CAAC,UAAU,QAAQ,EAAE;EACtD,gBAAgB,IAAI,cAAc,CAAC,QAAQ,CAAC,EAAE;EAC9C,oBAAoB,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,MAAM,CAAC;EACtD,iBAAiB;EACjB,qBAAqB,IAAI,gBAAgB,CAAC,QAAQ,CAAC,EAAE;EACrD,oBAAoB,IAAI,CAAC,qBAAqB,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE;EACpE,wBAAwB,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,QAAQ,CAAC;EAC5D,qBAAqB;EACrB,iBAAiB;EACjB,qBAAqB,IAAI,eAAe,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE;EAC9D;EACA;EACA,oBAAoB,IAAI,EAAE,QAAQ,CAAC,KAAK,IAAI,QAAQ,CAAC,EAAE;EACvD,wBAAwB,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,SAAS,CAAC;EAC7D,qBAAqB;EACrB,iBAAiB;EACjB,qBAAqB,IAAI,eAAe,CAAC,QAAQ,CAAC,IAAI,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,eAAe,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,EAAE;EAC9H;EACA,oBAAoB,IAAI,EAAE,QAAQ,CAAC,IAAI,CAAC,KAAK,IAAI,QAAQ,CAAC,EAAE;EAC5D,wBAAwB,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,SAAS,CAAC;EAClE,qBAAqB;EACrB,iBAAiB;EACjB,aAAa,CAAC,CAAC;EACf,SAAS;EACT,QAAQ,OAAO,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,EAAE,EAAE,QAAQ,EAAE,aAAa,CAAC,CAAC;EAC3E,KAAK,CAAC;EACN;EACA;EACA;EACA,IAAI,SAAS,CAAC,iBAAiB,GAAG,UAAU,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,aAAa,EAAE;EACvF;EACA,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACpE,YAAY,IAAI3B,QAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,IAAI,QAAQ,GAAG,aAAa,CAAC,eAAe,CAACA,QAAK,CAAC,CAAC;EAChE,YAAY,IAAI,QAAQ,CAAC,KAAK,KAAK,SAAS,EAAE;EAC9C;EACA,gBAAgB,IAAI,QAAQ,CAAC,QAAQ,IAAI,QAAQ,CAAC,KAAK,KAAK,QAAQ,CAACA,QAAK,CAAC,IAAI,QAAQ,CAAC,KAAK,KAAK,SAAS,IAAI,QAAQ,CAACA,QAAK,CAAC,KAAK,SAAS,EAAE;EAC9I,oBAAoB,OAAO,QAAQ,CAACA,QAAK,CAAC,CAAC;EAC3C,iBAAiB;EACjB,qBAAqB;EACrB,oBAAoBC,IAAQ,CAACC,OAAW,CAAC,cAAc,CAACF,QAAK,EAAE,QAAQ,CAACA,QAAK,CAAC,EAAE,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;EACjG,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,QAAQ,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACpE,YAAY,IAAIA,QAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,IAAI,QAAQ,GAAG,aAAa,CAAC,GAAG,CAACA,QAAK,CAAC,CAAC;EACpD,YAAY,IAAI,QAAQ,KAAK,SAAS,EAAE;EACxC;EACA,gBAAgB,IAAI,QAAQ,KAAK,QAAQ,CAACA,QAAK,CAAC,EAAE;EAClD,oBAAoB,OAAO,QAAQ,CAACA,QAAK,CAAC,CAAC;EAC3C,iBAAiB;EACjB,qBAAqB;EACrB,oBAAoBC,IAAQ,CAACC,OAAW,CAAC,cAAc,CAACF,QAAK,EAAE,QAAQ,CAACA,QAAK,CAAC,EAAE,QAAQ,CAAC,CAAC,CAAC;EAC3F,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,KAAK,GAAG,IAAI,KAAK,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;EAClD;EACA,QAAQ,aAAa,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;EACrC;EACA,QAAQ,IAAI,CAAC,GAAG,EAAE,CAAC;EACnB,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC3E,YAAY,IAAIJ,MAAG,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC7B,YAAY,IAAI,GAAG,GAAG,KAAK,CAAC,GAAG,CAACA,MAAG,CAAC,CAAC;EACrC,YAAY,IAAI,GAAG,KAAK,IAAI,EAAE;EAC9B,gBAAgB,CAAC,CAACA,MAAG,CAAC,GAAG,GAAG,CAAC;EAC7B,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,KAAK,CAAC,IAAI,aAAa,CAAC,YAAY,EAAE;EAChE,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,QAAQ,OAAO,IAAI,SAAS,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;EACxC,KAAK,CAAC;EACN,IAAI,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,SAAS,EAAE,OAAO,EAAE;EACxD,QAAQ,GAAG,EAAE,YAAY;EACzB,YAAY,OAAO,IAAI,CAAC,MAAM,CAAC;EAC/B,SAAS;EACT,QAAQ,UAAU,EAAE,IAAI;EACxB,QAAQ,YAAY,EAAE,IAAI;EAC1B,KAAK,CAAC,CAAC;EACP,IAAI,SAAS,CAAC,SAAS,CAAC,KAAK,GAAG,UAAU,KAAK,EAAE;EACjD,QAAQ,IAAI,CAAC,MAAM,GAAGH,QAAgB,CAAC,EAAE,EAAE,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC;EACrE,QAAQ,KAAK,CAAC,MAAM,EAAE,CAAC;EACvB,KAAK,CAAC;EACN;EACA;EACA;EACA,IAAI,SAAS,CAAC,SAAS,CAAC,mBAAmB,GAAG,YAAY;EAC1D,QAAQ,IAAI,WAAW,GAAG,EAAE,CAAC;EAC7B,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACvE,YAAY,IAAIO,QAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,IAAI,CAAC,GAAG,IAAI,CAAC,MAAM,CAACA,QAAK,CAAC,CAAC;EACvC,YAAY,IAAI,eAAe,CAACA,QAAK,CAAC,KAAK,CAAC,EAAE;EAC9C,gBAAgB,WAAW,CAACA,QAAK,CAAC,GAAG,CAAC,CAAC;EACvC,aAAa;EACb,SAAS;EACT,QAAQ,OAAO,WAAW,CAAC;EAC3B,KAAK,CAAC;EACN;EACA,IAAI,SAAS,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACrD,QAAQ,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;EACxC,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,eAAe,GAAG,YAAY;EACtD,QAAQ,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;EACxC,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,kBAAkB,GAAG,UAAU,UAAU,EAAE;EACnE,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC;EACzB,QAAQ,IAAI,UAAU,KAAK,KAAK,CAAC,EAAE,EAAE,UAAU,GAAG,KAAK,CAAC,EAAE;EAC1D,QAAQ,OAAO,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;EAChC,aAAa,MAAM,CAAC,UAAUA,QAAK,EAAE,EAAE,OAAO,UAAU,GAAG,eAAe,CAACA,QAAK,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC;EAChG,aAAa,GAAG,CAAC,UAAUA,QAAK,EAAE;EAClC,YAAY,IAAI,IAAI,GAAG,eAAe,CAACA,QAAK,EAAE,KAAK,CAAC,MAAM,CAACA,QAAK,CAAC,CAAC,CAAC;EACnE,YAAY,IAAI,CAAC,IAAI,EAAE;EACvB,gBAAgB,OAAO,IAAI,CAAC;EAC5B,aAAa;EACb,YAAY,IAAI,OAAO,GAAG;EAC1B,gBAAgB,IAAI,EAAE,SAAS;EAC/B,gBAAgB,IAAI,EAAE,IAAI;EAC1B,gBAAgB,EAAE,EAAE,mBAAmB,CAACA,QAAK,CAAC;EAC9C,aAAa,CAAC;EACd,YAAY,OAAO,OAAO,CAAC;EAC3B,SAAS,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,KAAK,IAAI,CAAC,EAAE,CAAC,CAAC;EACvD,KAAK,CAAC;EACN,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;;EC5OjB,IAAI,UAAU,kBAAkB,UAAU,MAAM,EAAE;EAClD,IAAI2B,SAAiB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;EAC1C,IAAI,SAAS,UAAU,CAAC,IAAI,EAAE;EAC9B,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,IAAI,CAAC;EACpD,QAAQ,IAAI,GAAG,IAAI,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC;EAC1C,QAAQ,IAAI,YAAY,CAAC,IAAI,CAAC,EAAE;EAChC,YAAY,KAAK,CAAC,KAAK,GAAG,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC;EAClD,SAAS;EACT,aAAa,IAAI,SAAS,CAAC,IAAI,CAAC,EAAE;EAClC,YAAY,KAAK,CAAC,KAAK,GAAG,EAAE,GAAG,EAAE,IAAI,CAAC,GAAG,EAAE,CAAC;EAC5C,YAAY,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;EAC9B,gBAAgB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;EACjC,aAAa;EACb,YAAY,IAAI,CAAC,IAAI,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE;EACnD;EACA;EACA,gBAAgB,IAAI,gBAAgB,GAAG,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;EAC3E,gBAAgB,IAAI,CAAC,QAAQ,CAAC,CAAC,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,UAAU,CAAC,EAAE,gBAAgB,CAAC,EAAE;EAC5F,oBAAoB,gBAAgB,GAAG,MAAM,CAAC;EAC9C,iBAAiB;EACjB;EACA,gBAAgB,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,gBAAgB,CAAC;EACpD,aAAa;EACb,SAAS;EACT,aAAa,IAAI,WAAW,CAAC,IAAI,CAAC,EAAE;EACpC,YAAY,KAAK,CAAC,KAAK,GAAG,EAAE,CAAC;EAC7B,SAAS;EACT;EACA,QAAQ,IAAI,IAAI,CAAC,IAAI,EAAE;EACvB,YAAY,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC;EACpC,SAAS;EACT,QAAQ,IAAI,IAAI,CAAC,MAAM,EAAE;EACzB,YAAY,AAAG,IAAC,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,GAAG,EAAE,CAAC,KAAK,CAAC,CAAC,AAAmC,MAAM,GAAG7B,MAAc,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;EAC3H,YAAY,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;EACxC,SAAS;EACT,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,SAAS,EAAE,MAAM,EAAE;EACxD,QAAQ,GAAG,EAAE,YAAY;EACzB,YAAY,OAAO,IAAI,CAAC,KAAK,CAAC;EAC9B,SAAS;EACT,QAAQ,UAAU,EAAE,IAAI;EACxB,QAAQ,YAAY,EAAE,IAAI;EAC1B,KAAK,CAAC,CAAC;EACP,IAAI,UAAU,CAAC,SAAS,CAAC,OAAO,GAAG,YAAY;EAC/C,QAAQ,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC;EAC5B,KAAK,CAAC;EACN,IAAI,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,SAAS,EAAE,UAAU,EAAE;EAC5D,QAAQ,GAAG,EAAE,YAAY;EACzB,YAAY,OAAO,IAAI,CAAC,KAAK,CAAC;EAC9B,SAAS;EACT,QAAQ,GAAG,EAAE,UAAU,IAAI,EAAE;EAC7B,YAAY,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;EAC9B,SAAS;EACT,QAAQ,UAAU,EAAE,IAAI;EACxB,QAAQ,YAAY,EAAE,IAAI;EAC1B,KAAK,CAAC,CAAC;EACP,IAAI,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,SAAS,EAAE,QAAQ,EAAE;EAC1D,QAAQ,GAAG,EAAE,UAAU,MAAM,EAAE;EAC/B,YAAY,MAAM,IAAI,KAAK,CAAC,gCAAgC,CAAC,CAAC;EAC9D,SAAS;EACT,QAAQ,UAAU,EAAE,IAAI;EACxB,QAAQ,YAAY,EAAE,IAAI;EAC1B,KAAK,CAAC,CAAC;EACP,IAAI,UAAU,CAAC,SAAS,CAAC,MAAM,GAAG,YAAY;EAC9C,QAAQ,MAAM,IAAI,KAAK,CAAC,+CAA+C,CAAC,CAAC;EACzE,KAAK,CAAC;EACN;EACA;EACA;EACA,IAAI,UAAU,CAAC,SAAS,CAAC,IAAI,GAAG,YAAY;EAC5C,QAAQ,IAAI,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;EACtC,YAAY,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE;EAC7B;EACA,gBAAgB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;EAC9C,aAAa;EACb,YAAY,OAAO,IAAI,CAAC,KAAK,CAAC;EAC9B,SAAS;EACT,aAAa,IAAI,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;EACxC,YAAY,OAAO,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;EAC7D,SAAS;EACT,aAAa;EACb,YAAY,OAAO,IAAI,CAAC,KAAK,CAAC;EAC9B,SAAS;EACT,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,QAAQ,GAAG,YAAY;EAChD,QAAQ,OAAOL,QAAgB,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,KAAK,EAAE,EAAE,IAAI,CAAC,KAAK,EAAE,EAAE,SAAS,EAAE,EAAE,EAAE,CAAC,CAAC;EACrF,KAAK,CAAC;EACN,IAAI,OAAO,UAAU,CAAC;EACtB,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;;ECxFjB,IAAI,YAAY,kBAAkB,UAAU,MAAM,EAAE;EACpD,IAAIkC,SAAiB,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;EAC5C,IAAI,SAAS,YAAY,CAAC,MAAM,EAAE,OAAO,EAAE;EAC3C,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC;EACtD,QAAQ,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;EAChC,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,YAAY,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EAC/C,QAAQ,OAAO,IAAI,YAAY,CAAC,IAAI,EAAE,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;EAC/D,KAAK,CAAC;EACN,IAAI,YAAY,CAAC,gBAAgB,GAAG,UAAU,MAAM,EAAE,KAAK,EAAE;EAC7D,QAAQ,IAAI,OAAO,GAAG,KAAK,CAAC,cAAc,CAAC,UAAU,iBAAiB,EAAE,QAAQ,EAAE;EAClF,YAAY,IAAI,QAAQ,CAAC,QAAQ,EAAE;EACnC,gBAAgB,IAAI,CAAC,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;EAC1C,gBAAgB,iBAAiB,CAAC,CAAC,CAAC,GAAG;EACvC,oBAAoB,EAAE,EAAE,CAAC;EACzB,oBAAoB,QAAQ,EAAE,QAAQ,CAAC,QAAQ;EAC/C,oBAAoB,KAAK,EAAE,QAAQ,CAAC,KAAK;EACzC,iBAAiB,CAAC;EAClB,aAAa;EACb,YAAY,OAAO,iBAAiB,CAAC;EACrC,SAAS,EAAE,EAAE,CAAC,CAAC;EACf,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE;EACxC,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,QAAQ,OAAO,IAAI,YAAY,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;EACjD,KAAK,CAAC;EACN,IAAI,YAAY,CAAC,iBAAiB,GAAG,UAAU,MAAM,EAAE,CAAC,EAAE;EAC1D,QAAQ,IAAI,EAAE,CAAC;EACf,QAAQ,OAAO,IAAI,YAAY,CAAC,MAAM,GAAG,EAAE,GAAG,EAAE;EAChD,YAAY,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG;EAC1B,gBAAgB,EAAE,EAAE,CAAC,CAAC,EAAE;EACxB,gBAAgB,QAAQ,EAAE,CAAC,CAAC,QAAQ;EACpC,gBAAgB,KAAK,EAAE,CAAC,CAAC,KAAK;EAC9B,aAAa;EACb,YAAY,EAAE,EAAE,CAAC;EACjB,KAAK,CAAC;EACN,IAAI,YAAY,CAAC,SAAS,CAAC,KAAK,GAAG,UAAU,KAAK,EAAE;EACpD,QAAQ,IAAI,CAAC,OAAO,GAAGlC,QAAgB,CAAC,EAAE,EAAE,IAAI,CAAC,OAAO,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC;EACzE,QAAQ,KAAK,CAAC,MAAM,EAAE,CAAC;EACvB,KAAK,CAAC;EACN,IAAI,YAAY,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACxD,QAAQ,IAAI,GAAG,GAAG,EAAE,CAAC;EACrB,QAAQ,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;EAChD,YAAY,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC;EAC7B,SAAS,CAAC,CAAC;EACX,QAAQ,OAAO,GAAG,CAAC;EACnB,KAAK,CAAC;EACN,IAAI,YAAY,CAAC,SAAS,CAAC,eAAe,GAAG,YAAY;EACzD,QAAQ,IAAI,GAAG,GAAG,EAAE,CAAC;EACrB,QAAQ,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;EAChD,YAAY,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC;EAChC,SAAS,CAAC,CAAC;EACX,QAAQ,OAAO,GAAG,CAAC;EACnB,KAAK,CAAC;EACN,IAAI,YAAY,CAAC,SAAS,CAAC,QAAQ,GAAG,YAAY;EAClD,QAAQ,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;EACnD,YAAY,OAAO;EACnB,gBAAgB,IAAI,EAAE,SAAS;EAC/B,gBAAgB,EAAE,EAAE,CAAC,CAAC,EAAE;EACxB,gBAAgB,IAAI,EAAE,SAAS,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC,KAAK,CAAC;EACpD,aAAa,CAAC;EACd,SAAS,CAAC,CAAC;EACX,KAAK,CAAC;EACN,IAAI,OAAO,YAAY,CAAC;EACxB,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;;EC/DjB;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,iBAAiB,CAAC,CAAC,EAAE;EACrC,IAAI,SAAS,sBAAsB,CAAC,IAAI,EAAE;EAC1C,QAAQ,IAAI,IAAI,YAAY,UAAU,EAAE;EACxC,YAAY,OAAO;EACnB,SAAS;EACT,QAAQ,IAAI,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC;EAC/B,QAAQ,IAAI,CAAC,CAAC,IAAI,CAAC,EAAE;EACrB,YAAY,sBAAsB,CAAC,IAAI,CAAC,CAAC;EACzC,SAAS;EACT,KAAK;EACL,IAAI,OAAO,sBAAsB,CAAC;EAClC,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,WAAW,CAAC,IAAI,EAAE;EAClC,IAAI,IAAI,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;EAC7B;EACA,IAAI,IAAI,IAAI,YAAY,SAAS,EAAE;EACnC,QAAQ,IAAI,MAAM,YAAY,UAAU,EAAE;EAC1C,YAAY,OAAO,KAAK,CAAC;EACzB,SAAS;EACT,QAAQ,IAAI,MAAM,CAAC,WAAW,EAAE,GAAG,CAAC,EAAE;EACtC;EACA,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,QAAQ,IAAI,MAAM,YAAY,SAAS,EAAE;EACzC,YAAY,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;EAC/B,SAAS;EACT,aAAa;EACb;EACA,YAAY,IAAI,eAAe,CAAC,MAAM,CAAC,cAAc,EAAE,EAAE,IAAI,CAAC,eAAe,EAAE,CAAC,EAAE;EAClF,gBAAgB,OAAO,IAAI,CAAC;EAC5B,aAAa;EACb,YAAY,IAAI,CAAC,cAAc,EAAE,CAAC;EAClC,SAAS;EACT,KAAK;EACL,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;EACD;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,oBAAoB,CAAC,IAAI,EAAE;EAC3C,IAAI,IAAI,IAAI,YAAY,UAAU,IAAI,IAAI,CAAC,WAAW,EAAE,GAAG,CAAC,IAAI,IAAI,YAAY,SAAS,EAAE;EAC3F;EACA,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,SAAS;EACT,QAAQ,IAAI,CAAC,MAAM,EAAE,CAAC;EACtB,KAAK;EACL,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;EACD;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,wBAAwB,CAAC,IAAI,EAAE;EAC/C,IAAI,IAAI,MAAM,GAAG,EAAE,CAAC;EACpB,IAAI,OAAO,iBAAiB,CAAC,UAAU,IAAI,EAAE;EAC7C,QAAQ,IAAI,IAAI,YAAY,YAAY,EAAE;EAC1C,YAAY,IAAI,OAAO,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;EAChD,YAAY,IAAI,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;EACjF,YAAY,IAAI,IAAI,EAAE;EACtB,gBAAgB,IAAI,CAAC,MAAM,EAAE,CAAC;EAC9B,aAAa;EACb,iBAAiB;EACjB,gBAAgB,MAAM,GAAGA,QAAgB,CAAC,EAAE,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC;EAC/D,aAAa;EACb,SAAS;EACT,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC;EACb,CAAC;;EChFD,SAAS,gBAAgB,CAAC,KAAK,EAAE;EACjC,IAAI,OAAO,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,UAAU,MAAM,EAAE,EAAE,EAAE;EAC5D,QAAQ,IAAI,QAAQ,GAAG,EAAE,CAAC,QAAQ,CAAC;EACnC,QAAQ,IAAI,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,CAAC;EACvC,QAAQ,IAAI,MAAM,EAAE;EACpB,YAAY,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;EAChC,SAAS;EACT,QAAQ,OAAO,MAAM,CAAC;EACtB,KAAK,EAAE,EAAE,CAAC,CAAC;EACX,CAAC;EACD,SAAS,cAAc,CAAC,EAAE,EAAE;EAC5B,IAAI,OAAO,OAAO,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC,MAAM,GAAG,CAAC,CAAC;EAC1F,CAAC;EACD,IAAI,SAAS,kBAAkB,UAAU,MAAM,EAAE;EACjD,IAAIkC,SAAiB,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;EACzC,IAAI,SAAS,SAAS,CAAC,MAAM,EAAE,KAAK,EAAE;EACtC,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC;EACtD,QAAQ,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC;EAC7B,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,SAAS,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EAC5C,QAAQ,OAAO,IAAI,SAAS,CAAC,IAAI,EAAE,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;EAC3D,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,iBAAiB,GAAG,UAAU,MAAM,EAAE,cAAc,EAAE;EACpE,QAAQ,IAAI,KAAK,GAAG,cAAc,CAAC,KAAK,EAAE,OAAO,GAAG,cAAc,CAAC,OAAO,EAAE,EAAE,GAAG,cAAc,CAAC,EAAE,EAAE,EAAE,GAAG,cAAc,CAAC,MAAM,EAAE,MAAM,GAAG,EAAE,KAAK,KAAK,CAAC,GAAG,MAAM,GAAG,EAAE,CAAC;EACrK,QAAQ,IAAI,UAAU,GAAG,EAAE,CAAC;EAC5B,QAAQ,IAAI,SAAS,GAAG,EAAE,CAAC;EAC3B,QAAQ,IAAI,cAAc,CAAC,IAAI,KAAK,SAAS,EAAE;EAC/C,YAAY,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,cAAc,CAAC,IAAI,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC7E,gBAAgB,IAAI,SAAS,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EACvC,gBAAgB,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;EACjD,gBAAgB,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,KAAK,SAAS,GAAG,WAAW,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC;EAC9F,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,IAAI,GAAG;EACnB,YAAY,KAAK,EAAE,UAAU;EAC7B,YAAY,KAAK,EAAE,SAAS;EAC5B,SAAS,CAAC;EACV,QAAQ,IAAI,YAAY,CAAC;EACzB,QAAQ,IAAI,cAAc,CAAC,EAAE,CAAC,EAAE;EAChC,YAAY,YAAY,GAAG,EAAE,CAAC;EAC9B,SAAS;EACT,aAAa,IAAI,QAAQ,CAAC,EAAE,CAAC,EAAE;EAC/B,YAAY,YAAY,GAAG,CAAC,EAAE,EAAE,EAAE,GAAG,MAAM,CAAC,CAAC;EAC7C,SAAS;EACT,aAAa;EACb,YAAY,YAAY,GAAG,CAAC,cAAc,CAAC,KAAK,GAAG,QAAQ,EAAE,cAAc,CAAC,KAAK,GAAG,MAAM,CAAC,CAAC;EAC5F,SAAS;EACT,QAAQ,OAAO,IAAI,SAAS,CAAC,MAAM,EAAE;EACrC,YAAY,UAAU,EAAE,KAAK;EAC7B,YAAY,OAAO,EAAE,OAAO;EAC5B,YAAY,MAAM,EAAE,MAAM;EAC1B,YAAY,IAAI,EAAE,IAAI;EACtB,YAAY,OAAO,EAAE,EAAE;EACvB,YAAY,EAAE,EAAE,YAAY;EAC5B,SAAS,CAAC,CAAC;EACX,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,gBAAgB,GAAG,UAAU,MAAM,EAAE,KAAK,EAAE;EAC1D,QAAQ,IAAI,eAAe,GAAG,KAAK,CAAC,KAAK,CAAC;EAC1C,QAAQ,IAAI,CAAC,eAAe,EAAE;EAC9B,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,QAAQ,IAAI,iBAAiB,CAAC;EAC9B,QAAQ,IAAI,eAAe,CAAC,cAAc,EAAE;EAC5C,YAAY,iBAAiB,GAAG,KAAK,CAAC,QAAQ,CAAC,eAAe,CAAC,cAAc,CAAC,CAAC;EAC/E,SAAS;EACT,QAAQ,IAAI,OAAO,GAAG,gBAAgB,CAAC,KAAK,CAAC,CAAC;EAC9C,QAAQ,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC;EAC5C,QAAQ,IAAI,IAAI,CAAC;EACjB,QAAQ,IAAI,OAAO,CAAC,QAAQ,CAAC,IAAI,UAAU,CAAC,QAAQ,CAAC,EAAE;EACvD,YAAY,IAAI,GAAG,UAAU,CAAC,QAAQ,CAAC,CAAC;EACxC,SAAS;EACT,aAAa;EACb;EACA;EACA,YAAY,IAAI,GAAG,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE3B,QAAK,EAAE;EACtD,gBAAgB,CAAC,CAAC,KAAK,CAAC,IAAI,CAACA,QAAK,CAAC,CAAC;EACpC,gBAAgB,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;EAC3C,gBAAgB,OAAO,CAAC,CAAC;EACzB,aAAa,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC,CAAC;EACzC,SAAS;EACT;EACA;EACA,QAAQ,IAAIA,QAAK,GAAG,KAAK,CAAC,OAAO,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;EAChE,QAAQ,OAAO,IAAI,SAAS,CAAC,MAAM,EAAE;EACrC,YAAY,iBAAiB,EAAE,iBAAiB;EAChD,YAAY,UAAU,EAAEA,QAAK;EAC7B,YAAY,OAAO,EAAE,EAAE;EACvB,YAAY,OAAO,EAAE,OAAO;EAC5B,YAAY,IAAI,EAAE,IAAI;EACtB,YAAY,MAAM,EAAE,eAAe,CAAC,MAAM;EAC1C,YAAY,MAAM,EAAE,eAAe,CAAC,MAAM;EAC1C,YAAY,EAAE,EAAE,CAACA,QAAK,GAAG,QAAQ,EAAEA,QAAK,GAAG,MAAM,CAAC;EAClD,SAAS,CAAC,CAAC;EACX,KAAK,CAAC;EACN,IAAI,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,SAAS,EAAE,OAAO,EAAE;EACxD,QAAQ,GAAG,EAAE,YAAY;EACzB,YAAY,OAAO,IAAI,CAAC,MAAM,CAAC;EAC/B,SAAS;EACT,QAAQ,UAAU,EAAE,IAAI;EACxB,QAAQ,YAAY,EAAE,IAAI;EAC1B,KAAK,CAAC,CAAC;EACP,IAAI,SAAS,CAAC,SAAS,CAAC,aAAa,GAAG,UAAU,MAAM,EAAE;EAC1D,QAAQ,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;EACjE,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,eAAe,GAAG,YAAY;EACtD,QAAQ,IAAI,GAAG,GAAG,EAAE,CAAC;EACrB,QAAQ,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,GAAG,IAAI,CAAC;EAC3C,QAAQ,IAAI,CAAC,gBAAgB,EAAE,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC;EAChF,QAAQ,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC;EAC5E,QAAQ,IAAIA,QAAK,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC;EAC3C,QAAQ,OAAO,CAACA,QAAK,CAAC,GAAGA,QAAK,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,GAAG,GAAG,CAACA,QAAK,CAAC,GAAG,IAAI,CAAC;EACnG,QAAQ,OAAO,GAAG,CAAC;EACnB,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACrD,QAAQ,OAAO,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,CAAC,UAAU,MAAM,EAAE,IAAI,EAAE;EAC7D,YAAY,MAAM,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC;EAChC,YAAY,OAAO,MAAM,CAAC;EAC1B,SAAS,EAAE,EAAE,CAAC,CAAC;EACf,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,gBAAgB,GAAG,YAAY;EACvD,QAAQ,IAAI,EAAE,GAAG,IAAI,CAAC,MAAM,EAAE,iBAAiB,GAAG,EAAE,CAAC,iBAAiB,EAAE,MAAM,GAAG,EAAE,CAAC,MAAM,EAAE,OAAO,GAAG,EAAE,CAAC,OAAO,CAAC;EACjH,QAAQ,IAAI,iBAAiB,EAAE;EAC/B,YAAY,IAAI,iBAAiB,CAAC,GAAG,EAAE;EACvC,gBAAgB,IAAI,MAAM,EAAE;EAC5B;EACA;EACA,oBAAoB,OAAO,CAAC,OAAO,CAAC,iBAAiB,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;EAC9E,iBAAiB;EACjB,gBAAgB,OAAO;EACvB;EACA,oBAAoB,OAAO,CAAC,iBAAiB,EAAE,EAAE,CAAC;EAClD,oBAAoB,OAAO,CAAC,iBAAiB,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;EACpE,iBAAiB,CAAC;EAClB,aAAa;EACb,YAAY,OAAO,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,CAAC;EAChD,SAAS;EACT,QAAQ,OAAO,OAAO,IAAI,EAAE,CAAC;EAC7B,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,QAAQ,GAAG,YAAY;EAC/C,QAAQ,IAAI,SAAS,GAAG,EAAE,CAAC;EAC3B,QAAQ,IAAI,EAAE,GAAG,IAAI,CAAC,MAAM,EAAE,OAAO,GAAG,EAAE,CAAC,OAAO,EAAE,iBAAiB,GAAG,EAAE,CAAC,iBAAiB,EAAEA,QAAK,GAAG,EAAE,CAAC,UAAU,EAAE,OAAO,GAAG,EAAE,CAAC,OAAO,EAAE,IAAI,GAAG,EAAE,CAAC,IAAI,EAAE,MAAM,GAAG,EAAE,CAAC,MAAM,EAAE,MAAM,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;EAC9M;EACA,QAAQ,IAAI,MAAM,IAAI,iBAAiB,EAAE;EACzC,YAAY,IAAI,cAAc,GAAG,iBAAiB,GAAG,OAAO,CAAC,iBAAiB,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,GAAG,SAAS,CAAC;EAClH,YAAY,IAAI,iBAAiB,CAAC,GAAG,EAAE;EACvC;EACA;EACA,gBAAgB,SAAS,CAAC,IAAI,CAAC;EAC/B,oBAAoB,IAAI,EAAE,SAAS;EACnC,oBAAoB,IAAI,EAAE,GAAG;EAC7B,wBAAwB,OAAO,CAAC,iBAAiB,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC;EACrE,wBAAwB,GAAG;EAC3B,wBAAwB,OAAO,CAAC,iBAAiB,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;EACvF,wBAAwB,KAAK;EAC7B,oBAAoB,EAAE,EAAE,cAAc;EACtC,iBAAiB,CAAC,CAAC;EACnB,aAAa;EACb,YAAY,SAAS,CAAC,IAAI,CAAC;EAC3B,gBAAgB,IAAI,EAAE,QAAQ;EAC9B,gBAAgB,KAAK,EAAEA,QAAK;EAC5B,gBAAgB,OAAO,EAAE,OAAO;EAChC,gBAAgB,GAAG,EAAE,cAAc;EACnC,gBAAgB,MAAM,EAAE,OAAO;EAC/B,gBAAgB,KAAK,EAAE,CAAC;EACxB,aAAa,CAAC,CAAC;EACf,SAAS;EACT;EACA,QAAQ,SAAS,CAAC,IAAI,CAAC;EACvB,YAAY,IAAI,EAAE,OAAO;EACzB,YAAY,OAAO,EAAE,IAAI,CAAC,gBAAgB,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC;EAC5D,YAAY,KAAK,EAAEA,QAAK;EACxB,YAAY,IAAI,EAAE,IAAI;EACtB,YAAY,EAAE,EAAE,EAAE;EAClB,YAAY,MAAM,EAAE,MAAM;EAC1B,SAAS,CAAC,CAAC;EACX,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK,CAAC;EACN,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;;ECjLV,IAAI,kBAAkB,GAAG,QAAQ,CAAC;EACzC;EACA;EACA;EACA,SAAS,YAAY,CAAC,KAAK,EAAE;EAC7B,IAAI,SAAS,KAAK,CAAC,IAAI,EAAE;EACzB,QAAQ,IAAI,EAAE,IAAI,YAAY,SAAS,CAAC,EAAE;EAC1C,YAAY,IAAI,MAAM,GAAG,IAAI,CAAC,KAAK,EAAE,CAAC;EACtC,YAAY,IAAI,MAAM,YAAY,UAAU,EAAE;EAC9C,gBAAgB,IAAI,OAAO,GAAG,kBAAkB,GAAG,MAAM,CAAC,SAAS,EAAE,CAAC;EACtE,gBAAgB,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;EAC1C,gBAAgB,KAAK,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,GAAG,MAAM,CAAC;EACzE,aAAa;EACb,iBAAiB,IAAI,MAAM,YAAY,aAAa,IAAI,MAAM,YAAY,SAAS,EAAE;EACrF,gBAAgB,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;EACnD,aAAa;EACb,YAAY,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,MAAM,GAAG,MAAM,CAAC,EAAE,CAAC,CAAC;EAClG,YAAY,OAAO,CAAC,MAAM,CAAC,CAAC;EAC5B,SAAS;EACT,QAAQ,OAAO,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC;EACjD,KAAK;EACL,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;EACD;EACA;EACA;EACA;EACA,SAAS,aAAa,CAAC,IAAI,EAAE;EAC7B,IAAI,IAAI,IAAI,YAAY,SAAS,EAAE;EACnC,QAAQ,IAAI,IAAI,CAAC,WAAW,EAAE,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,YAAY,UAAU,CAAC,EAAE;EACnF;EACA,YAAY,IAAI,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;EACzC,YAAY,IAAI,KAAK,YAAY,aAAa,IAAI,KAAK,YAAY,SAAS,EAAE;EAC9E,gBAAgB,KAAK,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;EACjD,aAAa;EACb,YAAY,KAAK,CAAC,cAAc,EAAE,CAAC;EACnC,YAAY,aAAa,CAAC,IAAI,CAAC,CAAC;EAChC,SAAS;EACT,aAAa;EACb;EACA,YAAY,mBAAmB,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EAChE;EACA,YAAY,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;EACtE,YAAY,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;EAC7F,SAAS;EACT,KAAK;EACL,SAAS;EACT,QAAQ,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;EAC7C,KAAK;EACL,CAAC;EACD,SAAS,mBAAmB,CAAC,IAAI,EAAE;EACnC,IAAI,IAAI,IAAI,YAAY,UAAU,IAAI,IAAI,CAAC,IAAI,KAAK,IAAI,EAAE;EAC1D,QAAQ,IAAI,IAAI,CAAC,WAAW,EAAE,KAAK,CAAC,EAAE;EACtC,YAAY,IAAI,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;EACzC,YAAY,IAAI,EAAE,KAAK,YAAY,SAAS,CAAC,EAAE;EAC/C,gBAAgB,KAAK,CAAC,cAAc,EAAE,CAAC;EACvC,gBAAgB,mBAAmB,CAAC,IAAI,CAAC,CAAC;EAC1C,aAAa;EACb,SAAS;EACT,KAAK;EACL,CAAC;EACD;EACA;EACA;EACA,SAAS,sBAAsB,CAAC,IAAI,EAAE;EACtC;EACA,IAAI,IAAI,IAAI,YAAY,iBAAiB,IAAI,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,KAAK,IAAI,CAAC,EAAE,CAAC,EAAE;EAC5G,QAAQ,IAAI,CAAC,MAAM,EAAE,CAAC;EACtB,KAAK;EACL;EACA,IAAI,IAAI,IAAI,YAAY,UAAU,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,EAAE;EAC1D,QAAQ,IAAI,CAAC,MAAM,EAAE,CAAC;EACtB,KAAK;EACL,IAAI,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,sBAAsB,CAAC,CAAC;EAClD,CAAC;EACD;EACA;EACA;EACA,SAAS,SAAS,CAAC,KAAK,EAAE;EAC1B,IAAI,IAAI,MAAM,GAAG,EAAE,CAAC;EACpB,IAAI,SAAS,MAAM,CAAC,IAAI,EAAE;EAC1B,QAAQ,IAAI,IAAI,CAAC,WAAW,EAAE,KAAK,CAAC,EAAE;EACtC,YAAY,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EAC9B,SAAS;EACT,aAAa;EACb,YAAY,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;EAC1C,SAAS;EACT,KAAK;EACL,IAAI,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;EAC1B,IAAI,OAAO,MAAM,CAAC;EAClB,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,gBAAgB,CAAC,aAAa,EAAE;EAChD,IAAI,IAAI,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;EAC5C,IAAI,KAAK,CAAC,OAAO,CAAC,sBAAsB,CAAC,CAAC;EAC1C;EACA,IAAI,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;EACvE,IAAI,SAAS,CAAC,KAAK,CAAC,CAAC,OAAO,CAACmC,iBAA4B,CAACC,oBAA+B,CAAC,CAAC,CAAC;EAC5F,IAAI,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;EACvE,IAAI,SAAS,CAAC,KAAK,CAAC,CAAC,OAAO,CAACD,iBAA4B,CAACE,WAAsB,CAAC,CAAC,CAAC;EACnF,IAAI,SAAS,CAAC,KAAK,CAAC,CAAC,OAAO,CAACC,wBAAmC,CAAC,CAAC;EAClE,IAAI,KAAK,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;EACjC,IAAI,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;EACrD,QAAQ,IAAI,aAAa,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,KAAK,CAAC,EAAE;EAC1D,YAAY,OAAO,aAAa,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;EAC5C,SAAS;EACT,KAAK,CAAC,CAAC;EACP,CAAC;;ECnGM,SAAS,gBAAgB,CAAC,KAAK,EAAE;EACxC,IAAI,IAAI,WAAW,CAAC,KAAK,CAAC,EAAE;EAC5B,QAAQ,oBAAoB,CAAC,KAAK,CAAC,CAAC;EACpC,KAAK;EACL,SAAS;EACT,QAAQ,uBAAuB,CAAC,KAAK,CAAC,CAAC;EACvC,KAAK;EACL,CAAC;EACD,SAAS,oBAAoB,CAAC,KAAK,EAAE;EACrC,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,eAAe,CAAC;EACvC,IAAI,IAAI,oBAAoB,GAAG,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC;EACtD,IAAIC,IAAS,CAAC,oBAAoB,CAAC,CAAC,OAAO,CAAC,UAAU,OAAO,EAAE;EAC/D,QAAQ,IAAI,cAAc,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC;EAC7C,QAAQ,IAAI,eAAe,GAAG,cAAc,GAAG,cAAc,CAAC,MAAM,GAAG,SAAS,CAAC;EACjF,QAAQ,IAAI,OAAO,GAAG,qBAAqB,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;EAC5D,QAAQ,IAAI,cAAc,GAAG,oBAAoB,CAAC,OAAO,CAAC,CAAC;EAC3D,QAAQ,cAAc,CAAC,OAAO,GAAG,OAAO,CAAC;EACzC,QAAQ,IAAI,iBAAiB,CAAC,eAAe,CAAC,EAAE;EAChD;EACA;EACA;EACA;EACA;EACA,YAAY,cAAc,CAAC,GAAG,CAAC,WAAW,EAAE;EAC5C,gBAAgB,MAAM,EAAE,gBAAgB,GAAGC,IAAS,CAAC,eAAe,CAAC;EACrE,aAAa,EAAE,IAAI,CAAC,CAAC;EACrB,SAAS;EACT,QAAQ,IAAI,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,EAAE;EAC5C;EACA,YAAY,IAAI,WAAW,GAAG,KAAK,CAAC;EACpC,YAAY,OAAO,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,WAAW,CAAC,MAAM,EAAE;EACrE,gBAAgB,WAAW,GAAG,WAAW,CAAC,MAAM,CAAC;EACjD,aAAa;EACb,YAAY,IAAI,OAAO,GAAG,WAAW,CAAC,SAAS,CAAC,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;EACvE,YAAY,IAAI,OAAO,KAAK,QAAQ,EAAE;EACtC,gBAAgB,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,SAAS,GAAG,OAAO,EAAE,EAAE,GAAG,SAAS,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACnF,oBAAoB,IAAI,MAAM,GAAG,SAAS,CAAC,EAAE,CAAC,CAAC;EAC/C;EACA,oBAAoB,IAAI,eAAe,CAAC,MAAM,CAAC,EAAE;EACjD;EACA,wBAAwB,MAAM,CAAC,IAAI,GAAG,kBAAkB,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,kBAAkB,EAAE,EAAE,CAAC,CAAC;EACvG,qBAAqB;EACrB,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,KAAK,CAAC,CAAC;EACP,CAAC;EACD,SAAS,uBAAuB,CAAC,KAAK,EAAE;EACxC,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAChE,QAAQ,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC3B,QAAQ,gBAAgB,CAAC,KAAK,CAAC,CAAC;EAChC,KAAK;EACL,IAAI,IAAI,oBAAoB,GAAG,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC;EACtD,IAAID,IAAS,CAAC,oBAAoB,CAAC,CAAC,OAAO,CAAC,UAAU,OAAO,EAAE;EAC/D,QAAQ,IAAI,OAAO,CAAC;EACpB,QAAQ,IAAI,SAAS,GAAG,IAAI,CAAC;EAC7B,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACpE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,IAAI,cAAc,GAAG,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;EACjE,YAAY,IAAI,cAAc,EAAE;EAChC,gBAAgB,IAAI,OAAO,KAAK,SAAS,EAAE;EAC3C,oBAAoB,OAAO,GAAG,cAAc,CAAC,OAAO,CAAC;EACrD,iBAAiB;EACjB,qBAAqB;EACrB,oBAAoB,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;EACrE,iBAAiB;EACjB,gBAAgB,IAAI,EAAE,GAAG,cAAc,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;EACzD,gBAAgB,IAAI,SAAS,IAAI,EAAE,IAAI,SAAS,CAAC,MAAM,KAAK,EAAE,CAAC,MAAM,EAAE;EACvE,oBAAoBtC,IAAQ,CAAC,8EAA8E,CAAC,CAAC;EAC7G,iBAAiB;EACjB,gBAAgB,SAAS,GAAG,EAAE,CAAC;EAC/B,aAAa;EACb,SAAS;EACT,QAAQ,oBAAoB,CAAC,OAAO,CAAC,CAAC,OAAO,GAAG,OAAO,CAAC;EACxD,QAAQ,IAAI,SAAS,EAAE;EACvB,YAAY,oBAAoB,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,WAAW,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;EAC5E,SAAS;EACT,KAAK,CAAC,CAAC;EACP,CAAC;EACD;EACA;EACA;EACA;EACA,SAAS,2BAA2B,CAAC,MAAM,EAAE,QAAQ,EAAE,SAAS,EAAE,WAAW,EAAE;EAC/E,IAAI,IAAI,MAAM,KAAK,cAAc,EAAE;EACnC,QAAQ,IAAI,EAAE,GAAG,wBAAwB,CAAC,QAAQ,EAAE,SAAS,CAAC,EAAE,KAAK,GAAG,EAAE,CAAC,KAAK,EAAE,MAAM,GAAG,EAAE,CAAC,MAAM,CAAC;EACrG,QAAQ,IAAI,CAAC,KAAK,EAAE;EACpB,YAAYA,IAAQ,CAAC,MAAM,CAAC,CAAC;EAC7B,YAAY,OAAO,SAAS,CAAC;EAC7B,SAAS;EACT,KAAK;EACL,SAAS,IAAI,MAAM,KAAK,SAAS,IAAI,WAAW,CAAC,qBAAqB,EAAE;EACxE;EACA,QAAQ,IAAI,KAAK,GAAG,wBAAwB,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC,KAAK,CAAC;EACxE,QAAQ,IAAI,KAAK,EAAE;EACnB,YAAY,OAAO,cAAc,CAAC;EAClC,SAAS;EACT,KAAK;EACL,IAAI,OAAO,MAAM,CAAC;EAClB,CAAC;AACD,EAAO,SAAS,qBAAqB,CAAC,KAAK,EAAE,OAAO,EAAE;EACtD,IAAI,IAAI,SAAS,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EACjE,IAAI,IAAI,MAAM,GAAG,2BAA2B,CAAC,KAAK,CAAC,WAAW,CAAC,OAAO,CAAC,EAAE,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,SAAS,EAAE,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;EACjI,IAAI,IAAI,MAAM,KAAK,KAAK,CAAC,WAAW,CAAC,OAAO,CAAC,EAAE;EAC/C,QAAQ,KAAK,CAAC,eAAe,CAAC,OAAO,CAAC,GAAGR,QAAgB,CAAC,EAAE,EAAE,KAAK,CAAC,eAAe,CAAC,OAAO,CAAC,EAAE,EAAE,MAAM,EAAE,MAAM,EAAE,CAAC,CAAC;EAClH,KAAK;EACL;EACA,IAAI,IAAI,OAAO,KAAK,GAAG,IAAI,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE;EACxD,QAAQ,IAAI,KAAK,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE;EACxC,YAAY,OAAO,wBAAwB,CAAC,SAAS,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,CAAC,CAAC,MAAM,CAAC,wBAAwB,CAAC,SAAS,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC;EAC5I,SAAS;EACT,aAAa;EACb,YAAY,OAAO,wBAAwB,CAAC,SAAS,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;EAC5E,SAAS;EACT,KAAK;EACL,SAAS,IAAI,OAAO,KAAK,GAAG,IAAI,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE;EAC7D,QAAQ,IAAI,KAAK,CAAC,eAAe,CAAC,GAAG,CAAC,EAAE;EACxC,YAAY,OAAO,wBAAwB,CAAC,SAAS,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,CAAC,CAAC,MAAM,CAAC,wBAAwB,CAAC,SAAS,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC;EAC5I,SAAS;EACT,aAAa;EACb,YAAY,OAAO,wBAAwB,CAAC,SAAS,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;EAC5E,SAAS;EACT,KAAK;EACL,IAAI,OAAO,wBAAwB,CAAC,SAAS,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;EACvE,CAAC;EACD,SAAS,wBAAwB,CAAC,SAAS,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE;EACrE,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC3C,IAAI,IAAI,MAAM,IAAI,MAAM,KAAK,cAAc,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,EAAE;EAC3E,QAAQ,IAAI,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,EAAE;EACnC,YAAY,OAAO,MAAM,CAAC,GAAG,CAAC,UAAU,EAAE,EAAE;EAC5C,gBAAgB,OAAO,EAAE,MAAM,EAAE,SAAS,GAAG,YAAY,CAAC,EAAE,EAAE,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC;EAC5E,aAAa,CAAC,CAAC;EACf,SAAS;EACT,QAAQ,OAAO,CAAC,MAAM,CAAC,CAAC;EACxB,KAAK;EACL,IAAI,IAAI,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;EAC5B,IAAI,IAAI,KAAK,IAAI,OAAO,KAAK,KAAK,CAAC,YAAY,EAAE;EACjD,QAAQ,IAAI,KAAK,CAAC,MAAM,KAAK,WAAW,EAAE;EAC1C,YAAY,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EAC5B,SAAS;EACT,QAAQ,IAAI,IAAI,GAAG,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;EAC/C,QAAQ,OAAO,CAAC;EAChB,gBAAgB,IAAI,EAAE,IAAI;EAC1B,gBAAgB,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,MAAM,EAAE,OAAO,EAAE,CAAC;EAClE,aAAa,EAAE;EACf,gBAAgB,IAAI,EAAE,IAAI;EAC1B,gBAAgB,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC;EAChE,aAAa,CAAC,CAAC;EACf,KAAK;EACL,IAAI,IAAI,IAAI,GAAG,cAAc,CAAC,OAAO,CAAC,GAAG,UAAU,CAAC,KAAK,EAAE,OAAO,EAAE,SAAS,CAAC,GAAG,SAAS,CAAC;EAC3F,IAAI,IAAI,MAAM,KAAK,cAAc,EAAE;EACnC,QAAQ,IAAI,IAAI,GAAG,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;EAC/C,QAAQ,IAAIO,QAAK,GAAG,QAAQ,CAAC,KAAK,CAAC;EACnC,QAAQ,OAAO,CAAC;EAChB,gBAAgB,IAAI,EAAE,IAAI;EAC1B,gBAAgB,KAAK,EAAE,OAAO,CAAC,EAAE,KAAK,EAAEA,QAAK,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;EAClE,aAAa,EAAE;EACf,gBAAgB,IAAI,EAAE,IAAI;EAC1B,gBAAgB,KAAK,EAAE,OAAO,CAAC,EAAE,KAAK,EAAEA,QAAK,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;EAClE,aAAa,CAAC,CAAC;EACf,KAAK;EACL,SAAS,IAAI,QAAQ,CAAC,GAAG,EAAE;EAC3B,QAAQ,IAAI,UAAU,CAAC,SAAS,CAAC,EAAE;EACnC,YAAY,IAAI,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,QAAQ,CAAC,KAAK,GAAG,OAAO,CAAC,CAAC;EACnG,YAAY,OAAO,CAAC,EAAE,MAAM,EAAE,WAAW,GAAG,MAAM,GAAG,UAAU,GAAG,MAAM,GAAG,UAAU,GAAG,MAAM,GAAG,SAAS,GAAG,MAAM,GAAG,QAAQ,EAAE,CAAC,CAAC;EAClI,SAAS;EACT,QAAQ,IAAI,iBAAiB,CAAC,SAAS,CAAC,EAAE;EAC1C;EACA;EACA,YAAY,OAAO,CAAC;EACpB;EACA;EACA,oBAAoB,IAAI,EAAEyC,WAAc,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC,eAAe,CAAC,GAAG,CAAC;EACzG;EACA,oBAAoB,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,EAAE,gBAAgB,CAAC,QAAQ,EAAE,OAAO,CAAC,GAAG,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,EAAE,CAAC;EACpH;EACA,oBAAoB,IAAI,EAAE,IAAI,KAAK,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG;EAChE,wBAAwB,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC;EACzD,wBAAwB,EAAE,EAAE,KAAK;EACjC,qBAAqB,GAAG,IAAI;EAC5B,iBAAiB,CAAC,CAAC;EACnB,SAAS;EACT,aAAa;EACb,YAAY,IAAI,OAAO,KAAK,GAAG,IAAI,OAAO,KAAK,GAAG,EAAE;EACpD,gBAAgB,IAAI,WAAW,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,GAAG,CAAC,MAAM,EAAE;EACtE,oBAAoB,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EACjD,iBAAiB;EACjB;EACA,gBAAgB,IAAI,IAAI,GAAG,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;EACvD,gBAAgB,OAAO,CAAC;EACxB,wBAAwB,IAAI,EAAE,IAAI;EAClC,wBAAwB,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC;EACzD,qBAAqB,EAAE;EACvB,wBAAwB,IAAI,EAAE,IAAI;EAClC,wBAAwB,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;EAC3E,qBAAqB,CAAC,CAAC;EACvB,aAAa;EACb,iBAAiB;EACjB;EACA,gBAAgB,OAAO,CAAC;EACxB,wBAAwB,IAAI,EAAE,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC;EACzD,wBAAwB,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC;EACzD,qBAAqB,CAAC,CAAC;EACvB,aAAa;EACb,SAAS;EACT,KAAK;EACL,SAAS,IAAI,IAAI,EAAE;EACnB,QAAQ,OAAO,CAAC;EAChB;EACA;EACA,gBAAgB,IAAI,EAAEA,WAAc,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC,eAAe,CAAC,GAAG,CAAC;EACrG,gBAAgB,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC;EAC7C,gBAAgB,IAAI,EAAE,IAAI;EAC1B,aAAa,CAAC,CAAC;EACf,KAAK;EACL,SAAS;EACT,QAAQ,OAAO,CAAC;EAChB,gBAAgB,IAAI,EAAE,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC;EACjD,gBAAgB,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC;EAC7C,aAAa,CAAC,CAAC;EACf,KAAK;EACL,CAAC;AACD,EAAO,SAAS,UAAU,CAAC,KAAK,EAAE,OAAO,EAAE,SAAS,EAAE;EACtD,IAAI,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE;EACvC,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK;EACL,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC3C,IAAI,IAAI,IAAI,GAAG,QAAQ,CAAC,IAAI,CAAC;EAC7B;EACA,IAAI,IAAI,WAAW,CAAC,IAAI,CAAC,EAAE;EAC3B,QAAQ,OAAO;EACf,YAAY,EAAE,EAAE,KAAK;EACrB,YAAY,KAAK,EAAE,mBAAmB,CAAC,KAAK,EAAE,OAAO,CAAC;EACtD,YAAY,KAAK,EAAE,WAAW;EAC9B,SAAS,CAAC;EACV,KAAK;EACL;EACA,IAAI,IAAI,WAAW,CAAC,IAAI,CAAC,EAAE;EAC3B;EACA,QAAQ,OAAOhD,QAAgB,CAAC,EAAE,EAAE,IAAI,GAAG,IAAI,CAAC,KAAK,GAAG,EAAE,KAAK,EAAEiD,kBAAuB,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC;EAC9G,KAAK;EACL,IAAI,IAAI,IAAI,KAAK,YAAY,EAAE;EAC/B,QAAQ,OAAO;EACf,YAAY,EAAE,EAAE,KAAK;EACrB,YAAY,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC;EACzC,YAAY,KAAK,EAAE,YAAY;EAC/B,SAAS,CAAC;EACV,KAAK;EACL,IAAI,IAAIC,QAAa,CAAC,CAAC,WAAW,EAAE,SAAS,yBAAyB,EAAE,IAAI,CAAC,EAAE;EAC/E,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL;EACA,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;EACD;EACA;EACA;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,wBAAwB,CAAC,QAAQ,EAAE,SAAS,EAAE;EAC9D,IAAI,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAE;EAC7B,QAAQ,OAAO;EACf,YAAY,KAAK,EAAE,KAAK;EACxB,YAAY,MAAM,EAAEzC,OAAW,CAAC,uCAAuC,CAAC,QAAQ,CAAC;EACjF,SAAS,CAAC;EACV,KAAK;EACL,IAAI,IAAI,CAAC,sBAAsB,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE;EACrD,QAAQ,OAAO;EACf,YAAY,KAAK,EAAE,KAAK;EACxB,YAAY,MAAM,EAAEA,OAAW,CAAC,sCAAsC,CAAC,QAAQ,CAAC,SAAS,CAAC;EAC1F,SAAS,CAAC;EACV,KAAK;EACL,IAAI,IAAI,QAAQ,CAAC,IAAI,KAAK,cAAc,EAAE;EAC1C,QAAQ,IAAI,SAAS,KAAK,KAAK,EAAE;EACjC,YAAY,OAAO;EACnB,gBAAgB,KAAK,EAAE,KAAK;EAC5B,gBAAgB,MAAM,EAAEA,OAAW,CAAC,8BAA8B,CAAC,QAAQ,CAAC;EAC5E,aAAa,CAAC;EACd,SAAS;EACT,KAAK;EACL,IAAI,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;EAC3B,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,YAAY,CAAC,OAAO,EAAE;EACtC,IAAI,IAAI,aAAa,GAAG0C,MAAW,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,MAAM,EAAE;EAClE;EACA,QAAQ,IAAI,eAAe,CAAC,MAAM,CAAC,EAAE;EACrC,YAAY,IAAI,EAAE,GAAG,MAAM,CAAC,IAAI,EAAE,iBAAiB,GAAG9C,MAAc,CAAC,MAAM,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC;EACvF,YAAY,OAAO,iBAAiB,CAAC;EACrC,SAAS;EACT,QAAQ,OAAO,MAAM,CAAC;EACtB,KAAK,CAAC,EAAE0C,IAAS,CAAC,CAAC;EACnB,IAAI,IAAI,KAAK,GAAGI,MAAW,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;EACrD,QAAQ,IAAI,eAAe,CAAC,CAAC,CAAC,EAAE;EAChC,YAAY,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;EAC3B,YAAY,IAAI,CAAC,KAAK,SAAS,IAAI,CAACH,WAAc,CAAC,CAAC,CAAC,EAAE;EACvD,gBAAgB,IAAI,CAAC,CAAC,EAAE,KAAK,OAAO,EAAE;EACtC;EACA,oBAAoB,OAAO,CAAC,CAAC,KAAK,CAAC;EACnC,iBAAiB;EACjB,gBAAgB,IAAI,CAAC,CAAC,KAAK,KAAK,WAAW,EAAE;EAC7C;EACA,oBAAoB,OAAO,CAAC,CAAC,KAAK,CAAC;EACnC,iBAAiB;EACjB,aAAa;EACb,YAAY,OAAO,CAAC,CAAC;EACrB,SAAS;EACT,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,KAAK,SAAS,CAAC,EAAE,CAAC,EAAED,IAAS,CAAC,CAAC;EACpE,IAAI,IAAI,aAAa,CAAC,MAAM,KAAK,CAAC,EAAE;EACpC,QAAQ,IAAI,MAAM,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;EAChC,QAAQ,IAAI,eAAe,CAAC,MAAM,CAAC,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;EACzD,YAAY,IAAI,MAAM,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;EAClC,YAAY,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;EAClC,gBAAgBvC,IAAQ,CAACC,OAAW,CAAC,kBAAkB,CAAC,CAAC;EACzD,gBAAgB,MAAM,GAAG,IAAI,CAAC;EAC9B,aAAa;EACb,YAAY,OAAOT,QAAgB,CAAC,EAAE,EAAE,MAAM,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;EAClE,SAAS;EACT,QAAQ,OAAO,MAAM,CAAC;EACtB,KAAK;EACL;EACA,IAAI,IAAI,WAAW,GAAGmD,MAAW,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;EACzD,QAAQ,IAAI,CAAC,KAAK,IAAI,EAAE;EACxB,YAAY,OAAO,CAAC,CAAC;EACrB,SAAS;EACT,QAAQ,IAAI,CAAC,CAAC,EAAE,KAAK,OAAO,EAAE;EAC9B,YAAY,OAAO,CAAC,CAAC;EACrB,SAAS;EACT,QAAQ3C,IAAQ,CAACC,OAAW,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC,CAAC;EACnD,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK,CAAC,EAAEsC,IAAS,CAAC,CAAC;EACnB,IAAI,IAAI,IAAI,GAAG,SAAS,CAAC;EACzB,IAAI,IAAI,WAAW,CAAC,MAAM,KAAK,CAAC,EAAE;EAClC,QAAQ,IAAI,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;EAC9B,KAAK;EACL,SAAS,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;EACrC,QAAQvC,IAAQ,CAACC,OAAW,CAAC,kBAAkB,CAAC,CAAC;EACjD,QAAQ,IAAI,GAAG,IAAI,CAAC;EACpB,KAAK;EACL,IAAI,IAAI,OAAO,GAAG0C,MAAW,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;EACvD,QAAQ,IAAI,eAAe,CAAC,CAAC,CAAC,EAAE;EAChC,YAAY,OAAO,CAAC,CAAC,IAAI,CAAC;EAC1B,SAAS;EACT,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK,CAAC,EAAE,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC;EACpC,IAAI,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,IAAI,OAAO,CAAC,CAAC,CAAC,KAAK,IAAI,EAAE;EACrD;EACA,QAAQ,IAAI,MAAM,GAAGnD,QAAgB,CAAC,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC,CAAC,EAAE,MAAM,EAAE,aAAa,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,EAAE,GAAG,IAAI,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,EAAE,CAAC;EACvJ,QAAQ,OAAO,MAAM,CAAC;EACtB,KAAK;EACL,IAAI,OAAOA,QAAgB,CAAC,EAAE,MAAM,EAAE,aAAa,EAAE,GAAG,IAAI,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,EAAE,CAAC;EACrF,CAAC;EACD;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,kBAAkB,CAAC,MAAM,EAAE;EAC3C,IAAI,IAAI,eAAe,CAAC,MAAM,CAAC,IAAI,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE;EAC3D,QAAQ,OAAO,MAAM,CAAC,KAAK,CAAC;EAC5B,KAAK;EACL,SAAS,IAAI,sBAAsB,CAAC,MAAM,CAAC,EAAE;EAC7C,QAAQ,IAAIO,QAAK,GAAG,KAAK,CAAC,CAAC;EAC3B,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,MAAM,CAAC,MAAM,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACnE,YAAY,IAAI,cAAc,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EACxC,YAAY,IAAI,eAAe,CAAC,cAAc,CAAC,IAAI,QAAQ,CAAC,cAAc,CAAC,KAAK,CAAC,EAAE;EACnF,gBAAgB,IAAI,CAACA,QAAK,EAAE;EAC5B,oBAAoBA,QAAK,GAAG,cAAc,CAAC,KAAK,CAAC;EACjD,iBAAiB;EACjB,qBAAqB,IAAIA,QAAK,KAAK,cAAc,CAAC,KAAK,EAAE;EACzD,oBAAoBC,IAAQ,CAAC,6KAA6K,CAAC,CAAC;EAC5M,oBAAoB,OAAOD,QAAK,CAAC;EACjC,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,QAAQC,IAAQ,CAAC,2QAA2Q,CAAC,CAAC;EAC9R,QAAQ,OAAOD,QAAK,CAAC;EACrB,KAAK;EACL,SAAS,IAAI,qBAAqB,CAAC,MAAM,CAAC,EAAE;EAC5C,QAAQC,IAAQ,CAAC,2KAA2K,CAAC,CAAC;EAC9L,QAAQ,IAAID,QAAK,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;EACrC,QAAQ,OAAO,QAAQ,CAACA,QAAK,CAAC,GAAGA,QAAK,GAAG,SAAS,CAAC;EACnD,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;AACD,EAAO,SAAS,cAAc,CAAC,KAAK,EAAE,OAAO,EAAE;EAC/C,IAAI,IAAI,cAAc,GAAG,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;EACzD,IAAI,IAAI,OAAO,GAAG,cAAc,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,MAAM,EAAE;EAC/D;EACA;EACA;EACA,QAAQ,IAAI,eAAe,CAAC,MAAM,CAAC,EAAE;EACrC,YAAY,MAAM,CAAC,IAAI,GAAG,KAAK,CAAC,gBAAgB,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;EAC9D,SAAS;EACT,QAAQ,OAAO,MAAM,CAAC;EACtB,KAAK,CAAC,CAAC;EACP;EACA,IAAI,OAAO,YAAY,CAAC,OAAO,CAAC,CAAC;EACjC,CAAC;;EC9ZM,SAAS,cAAc,CAAC,KAAK,EAAE;EACtC,IAAI,IAAI,YAAY,CAAC,KAAK,CAAC,IAAI,aAAa,CAAC,KAAK,CAAC,IAAI,aAAa,CAAC,KAAK,CAAC,EAAE;EAC7E;EACA,QAAQ,OAAO,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,MAAM,EAAE,KAAK,EAAE;EAC9D,YAAY,OAAO,MAAM,CAAC,MAAM,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC,CAAC;EACxD,SAAS,EAAE,sBAAsB,CAAC,KAAK,CAAC,CAAC,CAAC;EAC1C,KAAK;EACL,SAAS;EACT;EACA;EACA,QAAQ,OAAO,sBAAsB,CAAC,KAAK,CAAC,CAAC;EAC7C,KAAK;EACL,CAAC;AACD,EAAO,SAAS,sBAAsB,CAAC,KAAK,EAAE;EAC9C,IAAI,OAAO,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,UAAU,MAAM,EAAE,OAAO,EAAE;EAC1E,QAAQ,IAAI,cAAc,GAAG,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;EAC7D,QAAQ,IAAI,cAAc,CAAC,MAAM,EAAE;EACnC;EACA,YAAY,OAAO,MAAM,CAAC;EAC1B,SAAS;EACT,QAAQ,IAAI,KAAK,GAAG,cAAc,CAAC,OAAO,EAAE,CAAC;EAC7C;EACA,QAAQ,IAAI,SAAS,GAAG,KAAK,CAAC,SAAS,EAAE,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;EAC7D,QAAQ,IAAI,IAAI,GAAG,KAAK,CAAC,IAAI,EAAE,IAAI,GAAG,KAAK,CAAC,IAAI,EAAE,EAAE,GAAG,KAAK,CAAC,SAAS,EAAE,EAAE,GAAG,KAAK,CAAC,KAAK,EAAE,eAAe,GAAGF,MAAc,CAAC,KAAK,EAAE,CAAC,MAAM,EAAE,MAAM,EAAE,WAAW,EAAE,OAAO,CAAC,CAAC,CAAC;EAC1K,QAAQ,KAAK,GAAG,kBAAkB,CAAC,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;EAChE;EACA;EACA;EACA;EACA,QAAQ,IAAI,SAAS,IAAI,oBAAoB,CAAC,SAAS,CAAC,EAAE;EAC1D,YAAY,SAAS,GAAG,oBAAoB,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;EAC/D,SAAS;EACT,QAAQ,MAAM,CAAC,IAAI,CAACL,QAAgB,CAAC,EAAE,IAAI,EAAE,IAAI;EACjD,YAAY,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,cAAc,CAAC,KAAK,EAAE,OAAO,CAAC,EAAE,GAAG,SAAS,GAAG,EAAE,SAAS,EAAE,SAAS,EAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,EAAE,eAAe,CAAC,CAAC,CAAC;EACnJ,QAAQ,OAAO,MAAM,CAAC;EACtB,KAAK,EAAE,EAAE,CAAC,CAAC;EACX,CAAC;AACD,EAAO,SAAS,kBAAkB,CAAC,UAAU,EAAE,SAAS,EAAE,KAAK,EAAE,OAAO,EAAE;EAC1E;EACA,IAAI,IAAI,OAAO,KAAK,GAAG,IAAI,OAAO,KAAK,GAAG,EAAE;EAC5C,QAAQ,IAAI,aAAa,CAAC,UAAU,CAAC,EAAE;EACvC;EACA,YAAY,OAAO;EACnB,gBAAgB,IAAI,EAAE,EAAE,MAAM,EAAE,SAAS,GAAG,OAAO,EAAE;EACrD,aAAa,CAAC;EACd,SAAS;EACT,aAAa,IAAI,OAAO,CAAC,UAAU,CAAC,IAAI,UAAU,CAAC,MAAM,KAAK,CAAC,EAAE;EACjE,YAAY,IAAI,EAAE,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;EACnC,YAAY,IAAI,EAAE,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;EACnC,YAAY,IAAI,EAAE,KAAK,CAAC,IAAI,aAAa,CAAC,EAAE,CAAC,EAAE;EAC/C;EACA,gBAAgB,OAAO,CAAC,CAAC,EAAE,EAAE,MAAM,EAAE,KAAK,CAAC,WAAW,CAAC,EAAE,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;EACrE,aAAa;EACb,iBAAiB,IAAI,aAAa,CAAC,EAAE,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE;EACpD;EACA,gBAAgB,OAAO,CAAC,EAAE,MAAM,EAAE,KAAK,CAAC,WAAW,CAAC,EAAE,CAAC,MAAM,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;EACrE,aAAa;EACb,SAAS;EACT,KAAK;EACL,IAAI,OAAO,UAAU,CAAC;EACtB,CAAC;;ECjED,IAAI,cAAc,kBAAkB,UAAU,MAAM,EAAE;EACtD,IAAIkC,SAAiB,CAAC,cAAc,EAAE,MAAM,CAAC,CAAC;EAC9C,IAAI,SAAS,cAAc,CAAC,IAAI,EAAE,gBAAgB,EAAE;EACpD,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE;EACxC,QAAQ,EAAE,IAAI,EAAE,IAAI,EAAE;EACtB,SAAS,IAAI,IAAI,CAAC;EAClB,QAAQ,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC;EAC7B,QAAQ,KAAK,CAAC,OAAO,GAAG,EAAE,CAAC;EAC3B,QAAQ,KAAK,CAAC,eAAe,CAAC,MAAM,EAAE,gBAAgB,CAAC,CAAC;EACxD,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,OAAO,cAAc,CAAC;EAC1B,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;;ECJH,IAAI,gBAAgB,GAAG,CAAC,OAAO,EAAE,WAAW,EAAE,QAAQ,CAAC,CAAC;AAC/D,EAAO,SAAS,eAAe,CAAC,KAAK,EAAE;EACvC,IAAI,IAAI,WAAW,CAAC,KAAK,CAAC,EAAE;EAC5B,QAAQ,mBAAmB,CAAC,KAAK,CAAC,CAAC;EACnC,KAAK;EACL,SAAS;EACT,QAAQ,yBAAyB,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;EAClD,KAAK;EACL,CAAC;EACD,SAAS,mBAAmB,CAAC,KAAK,EAAE;EACpC,IAAI,IAAI,oBAAoB,GAAG,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC;EACtD;EACA,IAAI,cAAc,CAAC,OAAO,CAAC,UAAU,OAAO,EAAE;EAC9C,QAAQ,IAAI,cAAc,GAAG,oBAAoB,CAAC,OAAO,CAAC,CAAC;EAC3D,QAAQ,IAAI,CAAC,cAAc,EAAE;EAC7B,YAAY,OAAO;EACnB,SAAS;EACT,QAAQ,IAAI,eAAe,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;EAC/D,QAAQ,IAAI,cAAc,GAAG,KAAK,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;EAC5D,QAAQ,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC/C;EACA,QAAQ,IAAI,QAAQ,GAAG,OAAO,KAAK,GAAG,GAAG,OAAO,GAAG,OAAO,KAAK,GAAG,GAAG,QAAQ,GAAG,SAAS,CAAC;EAC1F,QAAQ,IAAI,aAAa,GAAG,QAAQ,GAAG,CAAC,CAAC,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,SAAS,CAAC;EAC9F,QAAQ,IAAI,SAAS,GAAG,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EACpD;EACA,QAAQ,IAAI,SAAS,GAAGgB,QAAa,CAAC,CAAC,OAAO,EAAE,MAAM,CAAC,EAAE,SAAS,CAAC,IAAI,CAAC,CAAC,cAAc,CAAC,SAAS,CAAC;EAClG,QAAQ,IAAI,QAAQ,IAAI,KAAK,CAAC,GAAG,IAAI,CAAC,aAAa,IAAI,SAAS,EAAE;EAClE,YAAY1C,IAAQ,CAACC,OAAW,CAAC,8BAA8B,CAAC,CAAC;EACjE,YAAY,aAAa,GAAG,IAAI,CAAC;EACjC,SAAS;EACT,QAAQ,IAAI,YAAY,GAAG,cAAc,CAAC,KAAK,CAAC,CAAC;EACjD,QAAQ,IAAI,iBAAiB,GAAG,oBAAoB,CAAC,OAAO,EAAE,SAAS,EAAE,QAAQ,CAAC,IAAI,EAAE,cAAc,EAAE,KAAK,CAAC,MAAM,EAAE,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,KAAK,CAAC,IAAI,EAAE,aAAa,EAAE,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,YAAY,CAAC,CAAC;EACpN,QAAQ,cAAc,CAAC,eAAe,CAAC,OAAO,EAAE,iBAAiB,CAAC,CAAC;EACnE,KAAK,CAAC,CAAC;EACP,CAAC;EACD,SAAS,cAAc,CAAC,KAAK,EAAE;EAC/B,IAAI,IAAI,YAAY,GAAG,EAAE,CAAC;EAC1B,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;EAC9C,IAAI,IAAI,MAAM,GAAG,MAAM,IAAI,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;EAC/C,IAAI,IAAI,MAAM,IAAI,aAAa,CAAC,MAAM,CAAC,IAAI,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE;EAClE,QAAQ,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;EACvC,KAAK;EACL,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;EAC9C,IAAI,IAAI,MAAM,GAAG,MAAM,IAAI,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;EAC/C,IAAI,IAAI,MAAM,IAAI,aAAa,CAAC,MAAM,CAAC,IAAI,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE;EAClE,QAAQ,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;EACvC,KAAK;EACL,IAAI,OAAO,YAAY,CAAC;EACxB,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,oBAAoB,CAAC,OAAO,EAAE,SAAS,EAAE,IAAI,EAAE,cAAc,EAAE,MAAM,EAAE2C,OAAI,EAAE,IAAI,EAAE,aAAa,EAAE,UAAU,EAAE,YAAY,EAAE;EAC5I,IAAI,IAAI,WAAW,GAAG,aAAa,IAAI,cAAc,CAAC,SAAS,KAAK,IAAI,CAAC;EACzE;EACA;EACA,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,kBAAkB,GAAG,gBAAgB,EAAE,EAAE,GAAG,kBAAkB,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAClG,QAAQ,IAAI,QAAQ,GAAG,kBAAkB,CAAC,EAAE,CAAC,CAAC;EAC9C,QAAQ,IAAI,cAAc,CAAC,QAAQ,CAAC,KAAK,SAAS,EAAE;EACpD,YAAY,IAAI,oBAAoB,GAAG,wBAAwB,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;EACrF,YAAY,IAAI,sBAAsB,GAAG,mCAAmC,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;EAChG,YAAY,IAAI,CAAC,oBAAoB,EAAE;EACvC,gBAAgB5C,IAAQ,CAACC,OAAW,CAAC,iCAAiC,CAAC,SAAS,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC;EACtG,aAAa;EACb,iBAAiB,IAAI,sBAAsB,EAAE;EAC7C,gBAAgBD,IAAQ,CAAC,sBAAsB,CAAC,CAAC;EACjD,aAAa;EACb,iBAAiB;EACjB,gBAAgB,QAAQ,QAAQ;EAChC,oBAAoB,KAAK,OAAO;EAChC,wBAAwB,OAAO,YAAY,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,CAAC;EACtE,oBAAoB,KAAK,QAAQ;EACjC,wBAAwB,OAAO,YAAY,CAAC,WAAW,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;EACnF,oBAAoB,KAAK,WAAW;EACpC,wBAAwB,IAAI,SAAS,GAAG,cAAc,CAAC,QAAQ,CAAC,CAAC;EACjE,wBAAwB,IAAI,SAAS,KAAK,IAAI,EAAE;EAChD,4BAA4B,IAAI,CAAC,aAAa,EAAE;EAChD,gCAAgC,OAAO,YAAY,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,CAAC,CAAC;EACzE,6BAA6B;EAC7B,iCAAiC;EACjC;EACA,gCAAgCA,IAAQ,CAACC,OAAW,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC,CAAC;EAChF,6BAA6B;EAC7B,yBAAyB;EACzB,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,KAAK;EACL,IAAI,OAAO,YAAY,CAAC,YAAY,CAAC,OAAO,EAAE,SAAS,EAAE,IAAI,EAAE,MAAM,EAAE2C,OAAI,EAAE,IAAI,EAAE,UAAU,EAAE,YAAY,EAAE,WAAW,CAAC,CAAC,CAAC;EAC3H,CAAC;EACD,SAAS,WAAW,CAAC,MAAM,EAAE;EAC7B,IAAI,IAAI,gBAAgB,CAAC,MAAM,CAAC,EAAE;EAClC,QAAQ,IAAI,CAAC,GAAG,EAAE,MAAM,EAAE,MAAM,CAAC,IAAI,EAAE,CAAC;EACxC,QAAQ,IAAI,MAAM,CAAC,KAAK,EAAE;EAC1B,YAAY,CAAC,CAAC,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC;EACnC,SAAS;EACT,QAAQ,IAAI,MAAM,CAAC,MAAM,EAAE;EAC3B,YAAY,CAAC,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;EACrC,SAAS;EACT,QAAQ,OAAO,CAAC,CAAC;EACjB,KAAK;EACL,IAAI,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,CAAC;EAC9B,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,OAAO,EAAE,SAAS,EAAE,IAAI,EAAE,MAAM,EAAEA,OAAI,EAAE,IAAI,EAAE,UAAU,EAAE,YAAY,EAAE,WAAW,EAAE;EAClH,IAAI,QAAQ,OAAO;EACnB,QAAQ,KAAK,CAAC,CAAC;EACf,QAAQ,KAAK,CAAC;EACd,YAAY,IAAIF,QAAa,CAAC,CAAC,OAAO,EAAE,MAAM,CAAC,EAAE,SAAS,CAAC,IAAI,CAAC,WAAW,EAAE;EAC7E,gBAAgB,IAAI,OAAO,KAAK,CAAC,IAAI,IAAI,KAAK,MAAM,EAAE;EACtD,oBAAoB,IAAI,MAAM,CAAC,KAAK,CAAC,cAAc,EAAE;EACrD,wBAAwB,OAAO,EAAE,IAAI,EAAE,MAAM,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC;EACrE,qBAAqB;EACrB,iBAAiB;EACjB,qBAAqB;EACrB,oBAAoB,IAAI,MAAM,CAAC,KAAK,CAAC,SAAS,EAAE;EAChD,wBAAwB,OAAO,EAAE,IAAI,EAAE,MAAM,CAAC,KAAK,CAAC,SAAS,EAAE,CAAC;EAChE,qBAAqB;EACrB,iBAAiB;EACjB,aAAa;EACb;EACA;EACA;EACA;EACA;EACA;EACA,YAAY,IAAI,OAAO,KAAK,CAAC,IAAI,mBAAmB,CAAC,SAAS,CAAC,EAAE;EACjE;EACA,gBAAgB,OAAO,CAAC,EAAE,MAAM,EAAE,UAAU,EAAE,EAAE,CAAC,CAAC,CAAC;EACnD,aAAa;EACb,iBAAiB;EACjB,gBAAgB,OAAO,CAAC,CAAC,EAAE,EAAE,MAAM,EAAE,UAAU,EAAE,CAAC,CAAC;EACnD,aAAa;EACb,QAAQ,KAAK,IAAI;EACjB;EACA,YAAY,IAAI,QAAQ,GAAG,YAAY,CAAC,IAAI,EAAEE,OAAI,EAAE,MAAM,CAAC,CAAC;EAC5D,YAAY,IAAI,QAAQ,GAAG,YAAY,CAAC,IAAI,EAAE,YAAY,EAAE,MAAM,CAAC,CAAC;EACpE,YAAY,OAAO,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;EACxC,QAAQ,KAAK,KAAK;EAClB,YAAY,OAAO,QAAQ,CAAC;EAC5B,QAAQ,KAAK,KAAK,CAAC;EACnB,QAAQ,KAAK,IAAI,CAAC;EAClB,QAAQ,KAAK,MAAM;EACnB,YAAY,IAAI,SAAS,KAAK,SAAS,EAAE;EACzC;EACA,gBAAgB,OAAO,IAAI,KAAK,SAAS,GAAG,UAAU,GAAG,SAAS,CAAC;EACnE,aAAa;EACb,YAAY,OAAO,IAAI,KAAK,MAAM,IAAI,IAAI,KAAK,UAAU,GAAG,SAAS,GAAG,MAAM,CAAC;EAC/E,QAAQ,KAAK,OAAO;EACpB;EACA,YAAY,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,EAAE,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;EACtE,KAAK;EACL;EACA,IAAI,MAAM,IAAI,KAAK,CAAC,oCAAoC,GAAG,OAAO,CAAC,CAAC;EACpE,CAAC;EACD,SAAS,YAAY,CAAC,IAAI,EAAEA,OAAI,EAAE,MAAM,EAAE;EAC1C,IAAI,IAAIA,OAAI,EAAE;EACd,QAAQ,OAAO,CAAC,CAAC;EACjB,KAAK;EACL,IAAI,QAAQ,IAAI;EAChB,QAAQ,KAAK,KAAK,CAAC;EACnB,QAAQ,KAAK,MAAM;EACnB,YAAY,OAAO,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC;EAC5C,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,OAAO,CAAC;EACrB,QAAQ,KAAK,MAAM;EACnB,YAAY,OAAO,MAAM,CAAC,KAAK,CAAC,cAAc,CAAC;EAC/C,QAAQ,KAAK,MAAM;EACnB,YAAY,OAAO,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC;EAC5C,QAAQ,KAAK,OAAO,CAAC;EACrB,QAAQ,KAAK,QAAQ,CAAC;EACtB,QAAQ,KAAK,QAAQ;EACrB,YAAY,OAAO,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;EACxC,KAAK;EACL;EACA;EACA,IAAI,MAAM,IAAI,KAAK,CAAC3C,OAAW,CAAC,mBAAmB,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC,CAAC;EACnE,CAAC;EACD,SAAS,YAAY,CAAC,IAAI,EAAE,YAAY,EAAE,MAAM,EAAE;EAClD,IAAI,IAAI,WAAW,GAAG,MAAM,CAAC,KAAK,CAAC;EACnC,IAAI,QAAQ,IAAI;EAChB,QAAQ,KAAK,KAAK,CAAC;EACnB,QAAQ,KAAK,MAAM;EACnB,YAAY,IAAI,MAAM,CAAC,KAAK,CAAC,WAAW,KAAK,SAAS,EAAE;EACxD,gBAAgB,OAAO,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC;EAChD,aAAa;EACb,YAAY,OAAO,cAAc,CAAC,YAAY,EAAE,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;EAClE,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,OAAO,CAAC;EACrB,QAAQ,KAAK,MAAM;EACnB,YAAY,OAAO,MAAM,CAAC,KAAK,CAAC,cAAc,CAAC;EAC/C,QAAQ,KAAK,MAAM;EACnB,YAAY,OAAO,MAAM,CAAC,KAAK,CAAC,WAAW,CAAC;EAC5C,QAAQ,KAAK,OAAO,CAAC;EACrB,QAAQ,KAAK,QAAQ,CAAC;EACtB,QAAQ,KAAK,QAAQ;EACrB,YAAY,IAAI,MAAM,CAAC,KAAK,CAAC,OAAO,EAAE;EACtC,gBAAgB,OAAO,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC;EAC5C,aAAa;EACb;EACA,YAAY,IAAI,SAAS,GAAG,cAAc,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC;EACtE,YAAY,OAAO,CAAC,SAAS,GAAG,CAAC,KAAK,SAAS,GAAG,CAAC,CAAC,CAAC;EACrD,KAAK;EACL;EACA;EACA,IAAI,MAAM,IAAI,KAAK,CAACA,OAAW,CAAC,mBAAmB,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC,CAAC;EACnE,CAAC;EACD;EACA;EACA;EACA,SAAS,cAAc,CAAC,YAAY,EAAE,WAAW,EAAE;EACnD,IAAI,IAAI,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;EACjC,QAAQ,OAAO,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,EAAE,YAAY,CAAC,CAAC;EAClD,KAAK;EACL,IAAI,IAAI,WAAW,CAAC,SAAS,EAAE;EAC/B,QAAQ,OAAO,WAAW,CAAC,SAAS,CAAC;EACrC,KAAK;EACL,IAAI,OAAO,EAAE,CAAC;EACd,CAAC;;EC3NM,SAAS,kBAAkB,CAAC,KAAK,EAAE,QAAQ,EAAE;EACpD,IAAI,IAAI,WAAW,CAAC,KAAK,CAAC,EAAE;EAC5B,QAAQ,sBAAsB,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;EAChD,KAAK;EACL,SAAS;EACT,QAAQ,yBAAyB,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;EACnD,KAAK;EACL,CAAC;EACD,SAAS,sBAAsB,CAAC,KAAK,EAAE,QAAQ,EAAE;EACjD,IAAI,IAAI,oBAAoB,GAAG,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC;EACtD,IAAI,IAAI,CAAC,oBAAoB,CAAC,CAAC,OAAO,CAAC,UAAU,OAAO,EAAE;EAC1D,QAAQ,IAAI,cAAc,GAAG,KAAK,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;EAC5D,QAAQ,IAAI,cAAc,GAAG,oBAAoB,CAAC,OAAO,CAAC,CAAC;EAC3D,QAAQ,IAAI,eAAe,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;EAC/D,QAAQ,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC/C,QAAQ,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;EAClC,QAAQ,IAAI,cAAc,GAAG,cAAc,CAAC,QAAQ,CAAC,CAAC;EACtD,QAAQ,IAAI,KAAK,GAAG,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAChD,QAAQ,IAAI,oBAAoB,GAAG,wBAAwB,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;EAC7E,QAAQ,IAAI,sBAAsB,GAAG,mCAAmC,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;EAC5F,QAAQ,IAAI,cAAc,KAAK,SAAS,EAAE;EAC1C;EACA,YAAY,IAAI,CAAC,oBAAoB,EAAE;EACvC,gBAAgBD,IAAQ,CAACC,OAAW,CAAC,iCAAiC,CAAC,KAAK,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC;EAClG,aAAa;EACb,iBAAiB,IAAI,sBAAsB,EAAE;EAC7C,gBAAgBD,IAAQ,CAAC,sBAAsB,CAAC,CAAC;EACjD,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,oBAAoB,IAAI,sBAAsB,KAAK,SAAS,EAAE;EAC1E,YAAY,IAAI,cAAc,KAAK,SAAS,EAAE;EAC9C;EACA,gBAAgB,cAAc,CAAC,iBAAiB,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;EAC3E,aAAa;EACb,iBAAiB;EACjB,gBAAgB,IAAI,KAAK,GAAG,eAAe,CAAC,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,eAAe,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE,eAAe,CAAC,GAAG,CAAC,cAAc,CAAC,EAAE,cAAc,CAAC,MAAM,EAAE,KAAK,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;EACzN,gBAAgB,IAAI,KAAK,KAAK,SAAS,EAAE;EACzC,oBAAoB,cAAc,CAAC,GAAG,CAAC,QAAQ,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;EAC/D,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,KAAK,CAAC,CAAC;EACP,CAAC;EACD;AACA,EAAO,SAAS,eAAe,CAAC,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,YAAY,EAAE,iBAAiB,EAAE,eAAe,EAAE,OAAO,EAAE,MAAM,EAAE;EAC3I,IAAI,IAAI,WAAW,GAAG,MAAM,CAAC,KAAK,CAAC;EACnC;EACA,IAAI,QAAQ,QAAQ;EACpB,QAAQ,KAAK,MAAM;EACnB,YAAY,OAAO,IAAI,CAAC,SAAS,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;EACtD,QAAQ,KAAK,SAAS;EACtB,YAAY,OAAO,OAAO,CAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC;EAC3F,QAAQ,KAAK,cAAc;EAC3B,YAAY,OAAO,YAAY,CAAC,YAAY,EAAE,OAAO,EAAE,WAAW,CAAC,CAAC;EACpE,QAAQ,KAAK,cAAc;EAC3B,YAAY,OAAO,YAAY,CAAC,YAAY,EAAE,OAAO,EAAE,SAAS,EAAE,iBAAiB,EAAE,WAAW,CAAC,CAAC;EAClG,QAAQ,KAAK,SAAS;EACtB,YAAY,OAAO,OAAO,CAAC,SAAS,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC;EACrD,QAAQ,KAAK,MAAM;EACnB,YAAY,OAAO4C,MAAI,CAAC,OAAO,EAAE,QAAQ,EAAE,eAAe,EAAE,OAAO,CAAC,CAAC;EACrE,KAAK;EACL;EACA,IAAI,OAAO,WAAW,CAAC,QAAQ,CAAC,CAAC;EACjC,CAAC;AACD,EAAO,SAAS,yBAAyB,CAAC,KAAK,EAAE,QAAQ,EAAE;EAC3D,IAAI,IAAI,oBAAoB,GAAG,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC;EACtD,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAChE,QAAQ,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC3B,QAAQ,IAAI,QAAQ,KAAK,OAAO,EAAE;EAClC,YAAY,eAAe,CAAC,KAAK,CAAC,CAAC;EACnC,SAAS;EACT,aAAa;EACb,YAAY,kBAAkB,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;EAChD,SAAS;EACT,KAAK;EACL,IAAI,IAAI,CAAC,oBAAoB,CAAC,CAAC,OAAO,CAAC,UAAU,OAAO,EAAE;EAC1D,QAAQ,IAAI,iBAAiB,CAAC;EAC9B,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACpE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,IAAI,cAAc,GAAG,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;EACjE,YAAY,IAAI,cAAc,EAAE;EAChC,gBAAgB,IAAI,sBAAsB,GAAG,cAAc,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;EACtF,gBAAgB,iBAAiB,GAAG,uBAAuB,CAAC,iBAAiB,EAAE,sBAAsB,EAAE,QAAQ,EAAE,OAAO,EAAE,mBAAmB,CAAC,UAAU,EAAE,EAAE,EAAE,EAAE;EAChK,oBAAoB,QAAQ,QAAQ;EACpC,wBAAwB,KAAK,OAAO;EACpC;EACA,4BAA4B,IAAI,EAAE,CAAC,IAAI,IAAI,EAAE,CAAC,IAAI,EAAE;EACpD,gCAAgC,OAAO,EAAE,CAAC,IAAI,GAAG,EAAE,CAAC,IAAI,CAAC;EACzD,6BAA6B;EAC7B,4BAA4B,OAAO,CAAC,CAAC;EACrC;EACA,qBAAqB;EACrB,oBAAoB,OAAO,CAAC,CAAC;EAC7B,iBAAiB,CAAC,CAAC,CAAC;EACpB,aAAa;EACb,SAAS;EACT,QAAQ,oBAAoB,CAAC,OAAO,CAAC,CAAC,eAAe,CAAC,QAAQ,EAAE,iBAAiB,CAAC,CAAC;EACnF,KAAK,CAAC,CAAC;EACP,CAAC;AACD,EAAO,SAAS,IAAI,CAAC,SAAS,EAAE,OAAO,EAAE,QAAQ,EAAE;EACnD,IAAI,IAAI,QAAQ,CAAC,GAAG,IAAIF,QAAa,CAAC,CAAC,SAAS,CAAC,IAAI,EAAE,SAAS,CAAC,GAAG,CAAC,EAAE,SAAS,CAAC,EAAE;EACnF,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK;EACL,IAAI,OAAOA,QAAa,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;EAC1C,CAAC;AACD,EAAO,SAAS,OAAO,CAAC,OAAO,EAAE,SAAS,EAAE,WAAW,EAAE,QAAQ,EAAE,OAAO,EAAE,SAAS,EAAE;EACvF,IAAI,IAAIA,QAAa,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE;EACxC,QAAQ,IAAI,wBAAwB,CAAC,SAAS,CAAC,EAAE;EACjD,YAAY,IAAI,WAAW,CAAC,iBAAiB,KAAK,SAAS,EAAE;EAC7D,gBAAgB,OAAO,WAAW,CAAC,iBAAiB,CAAC;EACrD,aAAa;EACb,YAAY,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,EAAE,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;EAC7D,YAAY,IAAI,IAAI,KAAK,KAAK,IAAI,CAAC,QAAQ,CAAC,GAAG,EAAE;EACjD,gBAAgB,IAAI,CAAC,MAAM,KAAK,UAAU,IAAI,OAAO,KAAK,GAAG;EAC7D,qBAAqB,MAAM,KAAK,YAAY,IAAI,OAAO,KAAK,GAAG,CAAC,EAAE;EAClE,oBAAoB,OAAO,SAAS,CAAC,kBAAkB,CAAC;EACxD,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,SAAS,KAAK,SAAS,CAAC,KAAK,EAAE;EAC3C,YAAY,OAAO,WAAW,CAAC,YAAY,CAAC;EAC5C,SAAS;EACT,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,YAAY,EAAE,OAAO,EAAE,WAAW,EAAE;EACjE,IAAI,IAAI,YAAY,KAAK,SAAS,EAAE;EACpC;EACA,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK;EACL,IAAI,IAAIA,QAAa,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE;EACxC;EACA;EACA;EACA,QAAQ,OAAO,WAAW,CAAC,gBAAgB,CAAC;EAC5C,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,YAAY,EAAE,OAAO,EAAE,SAAS,EAAE,iBAAiB,EAAE,WAAW,EAAE;EAC/F,IAAI,IAAI,YAAY,KAAK,SAAS,EAAE;EACpC;EACA,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK;EACL,IAAI,IAAIA,QAAa,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE;EACxC;EACA;EACA,QAAQ,IAAI,SAAS,KAAK,SAAS,CAAC,IAAI,EAAE;EAC1C,YAAY,IAAI,WAAW,CAAC,gBAAgB,KAAK,SAAS,EAAE;EAC5D,gBAAgB,OAAO,WAAW,CAAC,gBAAgB,CAAC;EACpD,aAAa;EACb;EACA;EACA;EACA;EACA,YAAY,OAAO,iBAAiB,GAAG,CAAC,CAAC;EACzC,SAAS;EACT,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;AACD,EAAO,SAAS,OAAO,CAAC,SAAS,EAAE,IAAI,EAAE;EACzC,IAAI,IAAI,mBAAmB,CAAC,SAAS,CAAC,IAAI,IAAI,KAAK,YAAY,EAAE;EACjE;EACA;EACA,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;AACD,EAAO,SAASE,MAAI,CAAC,OAAO,EAAE,QAAQ,EAAE,cAAc,EAAE,OAAO,EAAE;EACjE;EACA,IAAI,IAAI,eAAe,GAAG,CAAC,CAAC,cAAc,IAAI,cAAc,KAAK,cAAc,CAAC;EAChF,IAAI,IAAI,eAAe,EAAE;EACzB,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL;EACA;EACA;EACA;EACA,IAAI,IAAI,OAAO,KAAK,MAAM,IAAI,QAAQ,CAAC,IAAI,KAAK,cAAc,EAAE;EAChE,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL;EACA;EACA,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,IAAIF,QAAa,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE;EACzD,QAAQ,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,EAAE,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;EACzD,QAAQ,IAAI,QAAQ,CAAC,CAAC,KAAK,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,CAAC,EAAE,IAAI,CAAC,EAAE;EAC9D,YAAY,IAAI,CAAC,MAAM,KAAK,YAAY,IAAI,OAAO,KAAK,GAAG;EAC3D,iBAAiB,MAAM,KAAK,UAAU,IAAI,OAAO,KAAK,GAAG,CAAC,EAAE;EAC5D,gBAAgB,OAAO,KAAK,CAAC;EAC7B,aAAa;EACb,SAAS;EACT,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;;ECrMD;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,SAAS,CAAC,aAAa,EAAE,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,WAAW,EAAE;EAC/E,IAAI,IAAI,gBAAgB,GAAGG,aAAW,CAAC,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,WAAW,CAAC,CAAC;EAC7E,IAAI,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE;EAClC;EACA,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,IAAI,IAAI,aAAa,KAAK,SAAS,EAAE;EACrC;EACA,QAAQ,IAAI,CAAC,uBAAuB,CAAC,OAAO,EAAE,aAAa,CAAC,EAAE;EAC9D,YAAY7C,IAAQ,CAACC,OAAW,CAAC,2BAA2B,CAAC,OAAO,EAAE,aAAa,EAAE,gBAAgB,CAAC,CAAC,CAAC;EACxG,YAAY,OAAO,gBAAgB,CAAC;EACpC,SAAS;EACT;EACA,QAAQ,IAAI,CAAC,wBAAwB,CAAC,aAAa,EAAE,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,GAAG,CAAC,EAAE;EACnF,YAAYD,IAAQ,CAACC,OAAW,CAAC,4BAA4B,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC,CAAC;EAChG,YAAY,OAAO,gBAAgB,CAAC;EACpC,SAAS;EACT,QAAQ,OAAO,aAAa,CAAC;EAC7B,KAAK;EACL,IAAI,OAAO,gBAAgB,CAAC;EAC5B,CAAC;EACD;EACA;EACA;EACA;EACA,SAAS4C,aAAW,CAAC,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,WAAW,EAAE;EAC3D,IAAI,QAAQ,QAAQ,CAAC,IAAI;EACzB,QAAQ,KAAK,SAAS,CAAC;EACvB,QAAQ,KAAK,SAAS;EACtB,YAAY,IAAI,cAAc,CAAC,OAAO,CAAC,IAAI,SAAS,CAAC,OAAO,CAAC,KAAK,UAAU,EAAE;EAC9E,gBAAgB,IAAI,OAAO,KAAK,OAAO,IAAI,QAAQ,CAAC,IAAI,KAAK,SAAS,EAAE;EACxE,oBAAoB7C,IAAQ,CAACC,OAAW,CAAC,2BAA2B,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC,CAAC;EAC1F,iBAAiB;EACjB,gBAAgB,OAAO,SAAS,CAAC;EACjC,aAAa;EACb,YAAY,IAAIyC,QAAa,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE,OAAO,CAAC,EAAE;EACpD,gBAAgB,IAAIA,QAAa,CAAC,CAAC,MAAM,EAAE,KAAK,EAAE,MAAM,CAAC,EAAE,IAAI,CAAC,EAAE;EAClE;EACA;EACA,oBAAoB,OAAO,MAAM,CAAC;EAClC,iBAAiB;EACjB,gBAAgB,IAAI,IAAI,KAAK,KAAK,EAAE;EACpC,oBAAoB,OAAO,MAAM,CAAC;EAClC,iBAAiB;EACjB,aAAa;EACb;EACA,YAAY,OAAO,OAAO,CAAC;EAC3B,QAAQ,KAAK,UAAU;EACvB,YAAY,IAAI,cAAc,CAAC,OAAO,CAAC,EAAE;EACzC,gBAAgB,OAAO,YAAY,CAAC;EACpC,aAAa;EACb,iBAAiB,IAAI,SAAS,CAAC,OAAO,CAAC,KAAK,UAAU,EAAE;EACxD,gBAAgB1C,IAAQ,CAACC,OAAW,CAAC,2BAA2B,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC,CAAC;EACvF;EACA,gBAAgB,OAAO,SAAS,CAAC;EACjC,aAAa;EACb,YAAY,OAAO,MAAM,CAAC;EAC1B,QAAQ,KAAK,cAAc;EAC3B,YAAY,IAAI,cAAc,CAAC,OAAO,CAAC,EAAE;EACzC,gBAAgB,IAAI,QAAQ,CAAC,GAAG,EAAE;EAClC,oBAAoB,OAAO,aAAa,CAAC;EACzC,iBAAiB;EACjB;EACA;EACA,gBAAgB,OAAO,YAAY,CAAC;EACpC,aAAa;EACb,iBAAiB,IAAI,SAAS,CAAC,OAAO,CAAC,KAAK,UAAU,EAAE;EACxD,gBAAgBD,IAAQ,CAACC,OAAW,CAAC,2BAA2B,CAAC,OAAO,EAAE,cAAc,CAAC,CAAC,CAAC;EAC3F;EACA,gBAAgB,OAAO,SAAS,CAAC;EACjC,aAAa;EACb;EACA;EACA,YAAY,IAAI,QAAQ,CAAC,GAAG,IAAI,OAAO,KAAK,GAAG,IAAI,OAAO,KAAK,GAAG,EAAE;EACpE,gBAAgB,OAAO,YAAY,CAAC;EACpC,aAAa;EACb,YAAY,OAAO,QAAQ,CAAC;EAC5B,QAAQ,KAAK,UAAU,CAAC;EACxB,QAAQ,KAAK,WAAW,CAAC;EACzB,QAAQ,KAAK,SAAS;EACtB,YAAY,OAAO,SAAS,CAAC;EAC7B,KAAK;EACL;EACA,IAAI,MAAM,IAAI,KAAK,CAACA,OAAW,CAAC,gBAAgB,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;EACjE,CAAC;;EC/EM,SAAS,UAAU,CAAC,KAAK,EAAE;EAClC,IAAI,cAAc,CAAC,KAAK,CAAC,CAAC;EAC1B,IAAI,gBAAgB,CAAC,KAAK,CAAC,CAAC;EAC5B,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,6CAA6C,GAAG,2CAA2C,EAAE,EAAE,GAAG,6CAA6C,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACnL,QAAQ,IAAI,IAAI,GAAG,6CAA6C,CAAC,EAAE,CAAC,CAAC;EACrE,QAAQ,kBAAkB,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;EACxC,KAAK;EACL;EACA,IAAI,eAAe,CAAC,KAAK,CAAC,CAAC;EAC3B,CAAC;AACD,EAAO,SAAS,cAAc,CAAC,KAAK,EAAE;EACtC,IAAI,IAAI,WAAW,CAAC,KAAK,CAAC,EAAE;EAC5B,QAAQ,KAAK,CAAC,SAAS,CAAC,MAAM,GAAG,kBAAkB,CAAC,KAAK,CAAC,CAAC;EAC3D,KAAK;EACL,SAAS;EACT,QAAQ,KAAK,CAAC,SAAS,CAAC,MAAM,GAAG,qBAAqB,CAAC,KAAK,CAAC,CAAC;EAC9D,KAAK;EACL,CAAC;EACD;EACA;EACA;EACA,SAAS,kBAAkB,CAAC,KAAK,EAAE;EACnC,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,EAAE,MAAM,GAAG,KAAK,CAAC,MAAM,EAAE,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC;EAC5E,IAAI,OAAO,cAAc,CAAC,MAAM,CAAC,UAAU,eAAe,EAAE,OAAO,EAAE;EACrE,QAAQ,IAAI,QAAQ,CAAC;EACrB,QAAQ,IAAI,cAAc,GAAG,SAAS,CAAC;EACvC,QAAQ,IAAI,UAAU,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC3C;EACA,QAAQ,IAAI,UAAU,CAAC,UAAU,CAAC,IAAI,IAAI,KAAK,QAAQ;EACvD,YAAY,OAAO,KAAK,KAAK,IAAI,UAAU,CAAC,IAAI,KAAK,OAAO,EAAE;EAC9D,YAAY,OAAO,eAAe,CAAC;EACnC,SAAS;EACT,QAAQ,IAAI,UAAU,CAAC,UAAU,CAAC,EAAE;EACpC,YAAY,QAAQ,GAAG,UAAU,CAAC;EAClC,YAAY,cAAc,GAAG,UAAU,CAAC,KAAK,CAAC;EAC9C,SAAS;EACT,aAAa,IAAI,sBAAsB,CAAC,UAAU,CAAC,EAAE;EACrD,YAAY,QAAQ,GAAG,UAAU,CAAC,SAAS,CAAC;EAC5C,YAAY,cAAc,GAAG,UAAU,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;EAC3D,SAAS;EACT,aAAa,IAAI,OAAO,KAAK,CAAC,EAAE;EAChC,YAAY,QAAQ,GAAG,WAAW,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;EAChD,SAAS;EACT,aAAa,IAAI,OAAO,KAAK,CAAC,EAAE;EAChC,YAAY,QAAQ,GAAG,WAAW,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;EAChD,SAAS;EACT,QAAQ,IAAI,QAAQ,IAAI,cAAc,KAAK,IAAI,IAAI,cAAc,KAAK,KAAK,EAAE;EAC7E,YAAY,cAAc,GAAG,cAAc,IAAI,EAAE,CAAC;EAClD,YAAY,IAAI,kBAAkB,GAAG,cAAc,CAAC,IAAI,CAAC;EACzD,YAAY,IAAI,KAAK,GAAG,SAAS,CAAC,cAAc,CAAC,IAAI,EAAE,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC;EAC9F,YAAY,eAAe,CAAC,OAAO,CAAC,GAAG,IAAI,cAAc,CAAC,KAAK,CAAC,SAAS,CAAC,OAAO,GAAG,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,kBAAkB,KAAK,KAAK,EAAE,CAAC,CAAC;EACzJ,SAAS;EACT,QAAQ,OAAO,eAAe,CAAC;EAC/B,KAAK,EAAE,EAAE,CAAC,CAAC;EACX,CAAC;EACD,IAAI,mBAAmB,GAAG,mBAAmB,CAAC,UAAU,GAAG,EAAE,GAAG,EAAE,EAAE,QAAQ,mBAAmB,CAAC,GAAG,CAAC,GAAG,mBAAmB,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,CAAC;EACrI,SAAS,qBAAqB,CAAC,KAAK,EAAE;EACtC,IAAI,IAAI,eAAe,GAAG,KAAK,CAAC,SAAS,CAAC,MAAM,GAAG,EAAE,CAAC;EACtD,IAAI,IAAI,0BAA0B,GAAG,EAAE,CAAC;EACxC,IAAI,IAAI,OAAO,GAAG,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC;EAC1C,IAAI,IAAI,OAAO,GAAG,UAAU,KAAK,EAAE;EACnC,QAAQ,cAAc,CAAC,KAAK,CAAC,CAAC;EAC9B;EACA,QAAQ,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,UAAU,OAAO,EAAE;EAChE;EACA,YAAY,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,mBAAmB,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;EACnG,YAAY,IAAI,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,QAAQ,EAAE;EACrD,gBAAgB,IAAI,iBAAiB,GAAG,0BAA0B,CAAC,OAAO,CAAC,CAAC;EAC5E,gBAAgB,IAAI,cAAc,GAAG,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;EAC7F,gBAAgB,IAAI,iBAAiB,EAAE;EACvC,oBAAoB,IAAI,eAAe,CAAC,iBAAiB,CAAC,KAAK,EAAE,cAAc,CAAC,KAAK,CAAC,EAAE;EACxF;EACA,wBAAwB,0BAA0B,CAAC,OAAO,CAAC,GAAG,uBAAuB,CAAC,iBAAiB,EAAE,cAAc,EAAE,MAAM,EAAE,OAAO,EAAE,mBAAmB,CAAC,CAAC;EAC/J,qBAAqB;EACrB,yBAAyB;EACzB;EACA,wBAAwB,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,aAAa,CAAC;EAC/D;EACA,wBAAwB,OAAO,0BAA0B,CAAC,OAAO,CAAC,CAAC;EACnE,qBAAqB;EACrB,iBAAiB;EACjB,qBAAqB;EACrB,oBAAoB,0BAA0B,CAAC,OAAO,CAAC,GAAG,cAAc,CAAC;EACzE,iBAAiB;EACjB,aAAa;EACb,SAAS,CAAC,CAAC;EACX,KAAK,CAAC;EACN;EACA,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAChE,QAAQ,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC3B,QAAQ,OAAO,CAAC,KAAK,CAAC,CAAC;EACvB,KAAK;EACL;EACA,IAAI,IAAI,CAAC,0BAA0B,CAAC,CAAC,OAAO,CAAC,UAAU,OAAO,EAAE;EAChE;EACA,QAAQ,IAAI,IAAI,GAAG,KAAK,CAAC,SAAS,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;EAClD,QAAQ,IAAI,gBAAgB,GAAG,0BAA0B,CAAC,OAAO,CAAC,CAAC;EACnE,QAAQ,eAAe,CAAC,OAAO,CAAC,GAAG,IAAI,cAAc,CAAC,IAAI,EAAE,gBAAgB,CAAC,CAAC;EAC9E;EACA,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACpE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,IAAI,UAAU,GAAG,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;EAC7D,YAAY,IAAI,UAAU,EAAE;EAC5B,gBAAgB,KAAK,CAAC,WAAW,CAAC,UAAU,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,CAAC;EAChE,gBAAgB,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC;EACzC,aAAa;EACb,SAAS;EACT,KAAK,CAAC,CAAC;EACP,IAAI,OAAO,eAAe,CAAC;EAC3B,CAAC;;ECpGD,IAAI,OAAO,kBAAkB,YAAY;EACzC,IAAI,SAAS,OAAO,GAAG;EACvB,QAAQ,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;EAC1B,KAAK;EACL,IAAI,OAAO,CAAC,SAAS,CAAC,MAAM,GAAG,UAAU,OAAO,EAAE,OAAO,EAAE;EAC3D,QAAQ,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,OAAO,CAAC;EACxC,KAAK,CAAC;EACN,IAAI,OAAO,CAAC,SAAS,CAAC,GAAG,GAAG,UAAU,IAAI,EAAE;EAC5C,QAAQ,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,SAAS,CAAC;EAChD,KAAK,CAAC;EACN,IAAI,OAAO,CAAC,SAAS,CAAC,GAAG,GAAG,UAAU,IAAI,EAAE;EAC5C;EACA;EACA,QAAQ,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,KAAK,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;EAClE,YAAY,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;EACtC,SAAS;EACT,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK,CAAC;EACN,IAAI,OAAO,OAAO,CAAC;EACnB,CAAC,EAAE,CAAC,CAAC;AACL,EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;AACA,EAAO,SAAS,WAAW,CAAC,KAAK,EAAE;EACnC,IAAI,OAAO,KAAK,IAAI,KAAK,CAAC,IAAI,KAAK,MAAM,CAAC;EAC1C,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,KAAK,EAAE;EACpC,IAAI,OAAO,KAAK,IAAI,KAAK,CAAC,IAAI,KAAK,OAAO,CAAC;EAC3C,CAAC;AACD,EAAO,SAAS,aAAa,CAAC,KAAK,EAAE;EACrC,IAAI,OAAO,KAAK,IAAI,KAAK,CAAC,IAAI,KAAK,QAAQ,CAAC;EAC5C,CAAC;AACD,EAAO,SAAS,aAAa,CAAC,KAAK,EAAE;EACrC,IAAI,OAAO,KAAK,IAAI,KAAK,CAAC,IAAI,KAAK,QAAQ,CAAC;EAC5C,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,KAAK,EAAE;EACpC,IAAI,OAAO,KAAK,IAAI,KAAK,CAAC,IAAI,KAAK,OAAO,CAAC;EAC3C,CAAC;EACD,IAAI,KAAK,kBAAkB,YAAY;EACvC,IAAI,SAAS,KAAK,CAAC,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,MAAM,EAAE,QAAQ,EAAE,OAAO,EAAE;EAC7E,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC;EACzB,QAAQ,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;EAC3B;EACA;EACA;EACA,QAAQ,IAAI,CAAC,gBAAgB,GAAG,UAAU,IAAI,EAAE;EAChD;EACA;EACA,YAAY,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;EAC7C,gBAAgB,IAAI,CAAC,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACxE,aAAa;EACb;EACA,YAAY,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE;EACtE,gBAAgB,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,GAAG,KAAK,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;EACpF,aAAa;EACb,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS,CAAC;EACV,QAAQ,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;EAC7B,QAAQ,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;EAC7B,QAAQ,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;EACjC;EACA,QAAQ,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,IAAI,eAAe,CAAC;EACjD,QAAQ,IAAI,CAAC,KAAK,GAAG,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,KAAK,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC;EAC9E;EACA,QAAQ,IAAI,CAAC,YAAY,GAAG,MAAM,GAAG,MAAM,CAAC,YAAY,GAAG,IAAI,OAAO,EAAE,CAAC;EACzE,QAAQ,IAAI,CAAC,iBAAiB,GAAG,MAAM,GAAG,MAAM,CAAC,iBAAiB,GAAG,IAAI,OAAO,EAAE,CAAC;EACnF,QAAQ,IAAI,CAAC,iBAAiB,GAAG,MAAM,GAAG,MAAM,CAAC,iBAAiB,GAAG,IAAI,OAAO,EAAE,CAAC;EACnF,QAAQ,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;EAC9B,QAAQ,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;EAC5C,QAAQ,IAAI,CAAC,UAAU,GAAG,kBAAkB,CAAC,IAAI,CAAC,SAAS,IAAI,EAAE,CAAC,CAAC;EACnE,QAAQ,IAAI,CAAC,SAAS,GAAG;EACzB,YAAY,IAAI,EAAE;EAClB,gBAAgB,OAAO,EAAE,MAAM,GAAG,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,GAAG,EAAE;EACpE,gBAAgB,WAAW,EAAE,MAAM,GAAG,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,GAAG,EAAE;EAC5E,gBAAgB,mBAAmB,EAAE,MAAM,GAAG,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,mBAAmB,GAAG,EAAE;EAC5F;EACA,gBAAgB,SAAS,EAAE,WAAW,CAAC,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC;EACzG,aAAa;EACb,YAAY,UAAU,EAAE,IAAI,KAAK,EAAE;EACnC,YAAY,aAAa,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;EAClD,YAAY,IAAI,EAAE,IAAI;EACtB,YAAY,OAAO,EAAET,QAAgB,CAAC,EAAE,KAAK,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE,GAAG,OAAO,IAAI,EAAE,EAAE;EAC3F,YAAY,SAAS,EAAE,IAAI;EAC3B,YAAY,MAAM,EAAE,IAAI;EACxB,YAAY,UAAU,EAAE,IAAI;EAC5B,YAAY,IAAI,EAAE,EAAE;EACpB,YAAY,OAAO,EAAE,EAAE;EACvB,SAAS,CAAC;EACV,KAAK;EACL,IAAI,MAAM,CAAC,cAAc,CAAC,KAAK,CAAC,SAAS,EAAE,OAAO,EAAE;EACpD,QAAQ,GAAG,EAAE,YAAY;EACzB,YAAY,OAAO,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;EAClD,SAAS;EACT,QAAQ,UAAU,EAAE,IAAI;EACxB,QAAQ,YAAY,EAAE,IAAI;EAC1B,KAAK,CAAC,CAAC;EACP,IAAI,MAAM,CAAC,cAAc,CAAC,KAAK,CAAC,SAAS,EAAE,QAAQ,EAAE;EACrD,QAAQ,GAAG,EAAE,YAAY;EACzB,YAAY,OAAO,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;EACnD,SAAS;EACT,QAAQ,UAAU,EAAE,IAAI;EACxB,QAAQ,YAAY,EAAE,IAAI;EAC1B,KAAK,CAAC,CAAC;EACP,IAAI,KAAK,CAAC,SAAS,CAAC,QAAQ,GAAG,UAAU,IAAI,EAAE;EAC/C,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,EAAE,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;EACrD,QAAQ,IAAI,KAAK,EAAE;EACnB,YAAY,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,EAAE,IAAI,CAAC,CAAC;EAChE,SAAS;EACT,QAAQ,IAAI,MAAM,EAAE;EACpB,YAAY,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;EAClE,SAAS;EACT,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EACxC,QAAQ,IAAI,CAAC,UAAU,EAAE,CAAC;EAC1B,QAAQ,IAAI,CAAC,eAAe,EAAE,CAAC;EAC/B,QAAQ,IAAI,CAAC,wBAAwB,EAAE,CAAC;EACxC,QAAQ,IAAI,CAAC,cAAc,EAAE,CAAC;EAC9B,QAAQ,IAAI,CAAC,eAAe,EAAE,CAAC;EAC/B,QAAQ,IAAI,CAAC,SAAS,EAAE,CAAC;EACzB,QAAQ,IAAI,CAAC,kBAAkB,EAAE,CAAC;EAClC,QAAQ,IAAI,CAAC,WAAW,EAAE,CAAC;EAC3B,QAAQ,IAAI,CAAC,cAAc,EAAE,CAAC;EAC9B,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,UAAU,GAAG,YAAY;EAC7C,QAAQ,UAAU,CAAC,IAAI,CAAC,CAAC;EACzB,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,eAAe,GAAG,YAAY;EAClD,QAAQ,eAAe,CAAC,IAAI,CAAC,CAAC;EAC9B,KAAK,CAAC;EACN;EACA;EACA;EACA;EACA;EACA,IAAI,KAAK,CAAC,SAAS,CAAC,wBAAwB,GAAG,YAAY;EAC3D,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,OAAO,EAAE;EAC/C,YAAY,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,OAAO,CAAC,CAAC;EAClE,SAAS;EACT,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,QAAQ,EAAE;EACjD,YAAY,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,QAAQ,CAAC,CAAC;EACpE,SAAS;EACT,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,WAAW,GAAG,YAAY;EAC9C,QAAQ,WAAW,CAAC,IAAI,CAAC,CAAC;EAC1B,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,kBAAkB,GAAG,YAAY;EACrD,QAAQ,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,IAAI,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE;EAC3D,YAAY,OAAO,MAAM,CAAC;EAC1B,SAAS;EACT,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,kBAAkB,GAAG,YAAY;EACrD,QAAQ,IAAI,IAAI,CAAC,IAAI,KAAK,MAAM,IAAI,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE;EAC3D,YAAY,OAAO;EACnB,gBAAgB,KAAK,EAAE,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC;EACrD,gBAAgB,MAAM,EAAE,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;EACvD,aAAa,CAAC;EACd,SAAS;EACT,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,mBAAmB,GAAG,YAAY;EACtD,QAAQ,IAAI,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC;EACzD,QAAQ,IAAI,WAAW,GAAG,EAAE,CAAC;EAC7B,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,iBAAiB,GAAG,eAAe,EAAE,EAAE,GAAG,iBAAiB,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACnG,YAAY,IAAI,OAAO,GAAG,iBAAiB,CAAC,EAAE,CAAC,CAAC;EAChD,YAAY,IAAI,aAAa,CAAC,OAAO,CAAC,CAAC,KAAK,EAAE;EAC9C,gBAAgB,WAAW,CAAC,IAAI,CAAC,aAAa,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC,CAAC;EAC/D,aAAa;EACb,SAAS;EACT,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,iBAAiB,GAAG,eAAe,EAAE,EAAE,GAAG,iBAAiB,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACnG,YAAY,IAAI,OAAO,GAAG,iBAAiB,CAAC,EAAE,CAAC,CAAC;EAChD,YAAY,WAAW,GAAG,WAAW,CAAC,MAAM,CAAC,eAAe,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC,CAAC;EAC7E,SAAS;EACT,QAAQ,OAAO,WAAW,CAAC;EAC3B,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,YAAY,GAAG,YAAY;EAC/C,QAAQ,OAAO,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;EAC9D,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,eAAe,GAAG,YAAY;EAClD,QAAQ,OAAO,eAAe,CAAC,IAAI,CAAC,CAAC;EACrC,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,mBAAmB,GAAG,YAAY;EACtD,QAAQ,OAAO,mBAAmB,CAAC,IAAI,CAAC,CAAC;EACzC,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,aAAa,GAAG,YAAY;EAChD,QAAQ,IAAIqB,QAAK,GAAGrB,QAAgB,CAAC,EAAE,EAAE,kBAAkB,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;EACpG,QAAQ,IAAIqB,QAAK,CAAC,IAAI,EAAE;EACxB,YAAY,IAAI,CAAC,QAAQ,CAAC,CAAC,MAAM,EAAE,OAAO,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE;EACzD;EACA;EACA,gBAAgB,IAAIA,QAAK,CAAC,MAAM,IAAIA,QAAK,CAAC,MAAM,KAAK,OAAO,EAAE;EAC9D,oBAAoBb,IAAQ,CAACC,OAAW,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;EAC1E,iBAAiB;EACjB,gBAAgBY,QAAK,CAAC,MAAM,GAAG,OAAO,CAAC;EACvC,aAAa;EACb,YAAY,OAAO,IAAI,CAACA,QAAK,CAAC,CAAC,MAAM,GAAG,CAAC,GAAGA,QAAK,GAAG,SAAS,CAAC;EAC9D,SAAS;EACT,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK,CAAC;EACN;EACA;EACA;EACA,IAAI,KAAK,CAAC,SAAS,CAAC,aAAa,GAAG,UAAU,OAAO,EAAE;EACvD,QAAQ,IAAI,OAAO,KAAK,KAAK,CAAC,EAAE,EAAE,OAAO,GAAG,EAAE,CAAC,EAAE;EACjD,QAAQ,IAAI,KAAK,GAAG,EAAE,CAAC;EACvB,QAAQ,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,wBAAwB,EAAE,CAAC,CAAC;EAClE,QAAQ,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;EAChC,YAAY,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;EACpC,SAAS;EACT,QAAQ,IAAI,MAAM,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC;EAC3C,QAAQ,IAAI,MAAM,EAAE;EACpB,YAAY,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;EAClC,SAAS;EACT,QAAQ,KAAK,CAAC,KAAK,GAAG,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,mBAAmB,EAAE,EAAE,IAAI,CAAC,aAAa,EAAE,CAAC,CAAC;EAClF;EACA;EACA,QAAQ,IAAI,MAAM,GAAG,CAAC,CAAC,IAAI,CAAC,MAAM,IAAI,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,cAAc,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;EAC7F,QAAQ,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;EAC/B,YAAY,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;EAClC,SAAS;EACT,QAAQ,IAAI,IAAI,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;EACvC,QAAQ,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;EAC7B,YAAY,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC;EAC9B,SAAS;EACT,QAAQ,IAAI,OAAO,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;EAC7C,QAAQ,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;EAChC,YAAY,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;EACpC,SAAS;EACT,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,+BAA+B,GAAG,UAAU,OAAO,EAAE;EACzE,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACnE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,IAAI,WAAW,CAAC,KAAK,CAAC,EAAE;EACpC,gBAAgB,IAAI,KAAK,CAAC,eAAe,CAAC,OAAO,CAAC,EAAE;EACpD,oBAAoB,OAAO,IAAI,CAAC;EAChC,iBAAiB;EACjB,aAAa;EACb,iBAAiB;EACjB,gBAAgB,IAAI,KAAK,CAAC,+BAA+B,CAAC,OAAO,CAAC,EAAE;EACpE,oBAAoB,OAAO,IAAI,CAAC;EAChC,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,OAAO,GAAG,UAAU,IAAI,EAAE;EAC9C,QAAQ,OAAO,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,GAAG,GAAG,GAAG,EAAE,IAAI,IAAI,CAAC,CAAC;EAClE,KAAK,CAAC;EACN;EACA;EACA;EACA,IAAI,KAAK,CAAC,SAAS,CAAC,eAAe,GAAG,UAAU,IAAI,EAAE;EACtD,QAAQ,IAAI,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;EAC1C;EACA;EACA,QAAQ,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,mBAAmB,CAAC;EAChE,QAAQ,SAAS,CAAC,QAAQ,CAAC,GAAG,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EAC7D,QAAQ,OAAO,QAAQ,CAAC;EACxB,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,gBAAgB,GAAG,UAAU,QAAQ,EAAE;EAC3D,QAAQ,IAAI,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;EACvC,YAAY,IAAI,OAAO,GAAG,QAAQ,KAAK,OAAO,GAAG,GAAG,GAAG,GAAG,CAAC;EAC3D,YAAY,IAAI,cAAc,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;EAChE,YAAY,IAAI,cAAc,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE;EAC1D,gBAAgB,IAAI,IAAI,GAAG,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EACtD,gBAAgB,IAAI,KAAK,GAAG,cAAc,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;EACxD,gBAAgB,IAAI,iBAAiB,CAAC,IAAI,CAAC,IAAI,aAAa,CAAC,KAAK,CAAC,EAAE;EACrE,oBAAoB,IAAI,SAAS,GAAG,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAC/D,oBAAoB,IAAI,MAAM,GAAG,cAAc,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;EAC/D,oBAAoB,IAAId,QAAK,GAAG,kBAAkB,CAAC,MAAM,CAAC,CAAC;EAC3D,oBAAoB,IAAIA,QAAK,EAAE;EAC/B,wBAAwB,IAAI,QAAQ,GAAG,OAAO,CAAC,EAAE,SAAS,EAAE,UAAU,EAAE,KAAK,EAAEA,QAAK,EAAE,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;EAC3G,wBAAwB,OAAO;EAC/B,4BAA4B,MAAM,EAAE,QAAQ,CAAC,SAAS,EAAE,cAAc,EAAE,QAAQ,CAAC;EACjF,yBAAyB,CAAC;EAC1B,qBAAqB;EACrB,yBAAyB;EACzB,wBAAwBC,IAAQ,CAAC,4DAA4D,CAAC,CAAC;EAC/F,wBAAwB,OAAO,IAAI,CAAC;EACpC,qBAAqB;EACrB,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,QAAQ,OAAO;EACf,YAAY,MAAM,EAAE,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;EACtE,SAAS,CAAC;EACV,KAAK,CAAC;EACN;EACA;EACA;EACA,IAAI,KAAK,CAAC,SAAS,CAAC,gBAAgB,GAAG,UAAU,IAAI,EAAE;EACvD,QAAQ,IAAI,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;EACzD,QAAQ,IAAI,CAAC,IAAI,EAAE;EACnB;EACA;EACA,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,QAAQ,OAAO,IAAI,CAAC,SAAS,EAAE,CAAC;EAChC,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,WAAW,GAAG,UAAU,WAAW,EAAE;EACzD,QAAQ,OAAO,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;EACvD,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,gBAAgB,GAAG,UAAU,OAAO,EAAE,OAAO,EAAE;EACnE,QAAQ,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;EACxD,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,WAAW,GAAG,UAAU,OAAO,EAAE,OAAO,EAAE;EAC9D,QAAQ,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;EACnD,KAAK,CAAC;EACN,IAAI,KAAK,CAAC,SAAS,CAAC,gBAAgB,GAAG,UAAU,OAAO,EAAE,OAAO,EAAE;EACnE,QAAQ,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;EACxD,KAAK,CAAC;EACN;EACA;EACA;EACA,IAAI,KAAK,CAAC,SAAS,CAAC,SAAS,GAAG,UAAU,iBAAiB,EAAE,KAAK,EAAE;EACpE,QAAQ,IAAI,KAAK,EAAE;EACnB;EACA;EACA;EACA,YAAY,OAAO,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC;EACnD,SAAS;EACT;EACA;EACA,QAAQ;EACR;EACA,QAAQ,CAAC,SAAS,CAAC,iBAAiB,CAAC,IAAI,cAAc,CAAC,iBAAiB,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,iBAAiB,CAAC;EACtH;EACA,YAAY,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,EAAE;EACpE,YAAY,OAAO,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,CAAC;EAC1E,SAAS;EACT,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK,CAAC;EACN;EACA;EACA;EACA,IAAI,KAAK,CAAC,SAAS,CAAC,cAAc,GAAG,UAAU,KAAK,EAAE;EACtD,QAAQ,IAAI,KAAK,EAAE;EACnB;EACA;EACA;EACA,YAAY,OAAO,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;EAC9C,SAAS;EACT,QAAQ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,KAAK,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,EAAE;EACxI,YAAY,OAAO,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,CAAC;EAC1E,SAAS;EACT,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK,CAAC;EACN;EACA;EACA;EACA,IAAI,KAAK,CAAC,SAAS,CAAC,iBAAiB,GAAG,UAAU,OAAO,EAAE;EAC3D;EACA,QAAQ,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE;EACpC,YAAY,MAAM,IAAI,KAAK,CAAC,iIAAiI,CAAC,CAAC;EAC/J,SAAS;EACT,QAAQ,IAAI,mBAAmB,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;EACjE,QAAQ,IAAI,mBAAmB,IAAI,CAAC,mBAAmB,CAAC,MAAM,EAAE;EAChE,YAAY,OAAO,mBAAmB,CAAC;EACvC,SAAS;EACT,QAAQ,QAAQ,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,OAAO,CAAC,GAAG,SAAS,EAAE;EAClF,KAAK,CAAC;EACN;EACA;EACA;EACA,IAAI,KAAK,CAAC,SAAS,CAAC,qBAAqB,GAAG,UAAU,YAAY,EAAE,QAAQ,EAAE;EAC9E,QAAQ,IAAI,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC;EACzD,QAAQ,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC,MAAM,EAAE;EACjC,YAAY,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,qBAAqB,CAAC,YAAY,EAAE,QAAQ,CAAC,CAAC;EAC5E,SAAS;EACT,QAAQ,IAAI,CAAC,GAAG,EAAE;EAClB,YAAY,MAAM,IAAI,KAAK,CAACC,OAAW,CAAC,iBAAiB,CAAC,QAAQ,CAAC,CAAC,CAAC;EACrE,SAAS;EACT,QAAQ,OAAO,GAAG,CAAC;EACnB,KAAK,CAAC;EACN,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC,EAAE,CAAC,CAAC;AACL,EACA;EACA,IAAI,cAAc,kBAAkB,UAAU,MAAM,EAAE;EACtD,IAAIyB,SAAiB,CAAC,cAAc,EAAE,MAAM,CAAC,CAAC;EAC9C,IAAI,SAAS,cAAc,GAAG;EAC9B,QAAQ,OAAO,MAAM,KAAK,IAAI,IAAI,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,IAAI,IAAI,CAAC;EACxE,KAAK;EACL;EACA,IAAI,cAAc,CAAC,SAAS,CAAC,OAAO,GAAG,UAAU,OAAO,EAAE,GAAG,EAAE;EAC/D,QAAQ,IAAI,GAAG,KAAK,KAAK,CAAC,EAAE,EAAE,GAAG,GAAG,EAAE,CAAC,EAAE;EACzC,QAAQ,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC9C,QAAQ,IAAI,CAAC,QAAQ,EAAE;EACvB,YAAY,OAAO,SAAS,CAAC;EAC7B,SAAS;EACT,QAAQ,OAAO,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;EACtC,KAAK,CAAC;EACN,IAAI,cAAc,CAAC,SAAS,CAAC,cAAc,GAAG,UAAU,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE;EACpE,QAAQ,OAAO,MAAM,CAAC,IAAI,CAAC,UAAU,EAAE,EAAE,UAAU,GAAG,EAAE,EAAE,EAAE,CAAC,EAAE;EAC/D,YAAY,IAAI,QAAQ,GAAG,WAAW,CAAC,EAAE,CAAC,CAAC;EAC3C,YAAY,IAAI,QAAQ,EAAE;EAC1B,gBAAgB,OAAO,CAAC,CAAC,GAAG,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC;EAC3C,aAAa;EACb,YAAY,OAAO,GAAG,CAAC;EACvB,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;EACpB,KAAK,CAAC;EACN,IAAI,cAAc,CAAC,SAAS,CAAC,eAAe,GAAG,UAAU,CAAC,EAAE,CAAC,EAAE;EAC/D,QAAQ,OAAO,CAAC,IAAI,CAAC,UAAU,EAAE,EAAE,UAAU,EAAE,EAAE,CAAC,EAAE;EACpD,YAAY,IAAI,QAAQ,GAAG,WAAW,CAAC,EAAE,CAAC,CAAC;EAC3C,YAAY,IAAI,QAAQ,EAAE;EAC1B,gBAAgB,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;EAC/B,aAAa;EACb,SAAS,EAAE,CAAC,CAAC,CAAC;EACd,KAAK,CAAC;EACN,IAAI,OAAO,cAAc,CAAC;EAC1B,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;;ECpbV,IAAI,aAAa,GAAG;EACpB,IAAI,GAAG,EAAE,UAAU,OAAO,EAAE;EAC5B,QAAQ,OAAO,OAAO,CAAC,IAAI,KAAK,UAAU,IAAI,OAAO,CAAC,OAAO,KAAK,QAAQ;EAC1E,YAAY,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,IAAI,KAAK,QAAQ,CAAC;EACtD,KAAK;EACL,IAAI,KAAK,EAAE,UAAU,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE;EAC7C,QAAQ,IAAI,KAAK,GAAG,OAAO,CAAC,MAAM,GAAG,EAAE,CAAC;EACxC,QAAQ,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;EAC7C,YAAY,IAAI,OAAO,GAAG,CAAC,CAAC,OAAO,CAAC;EACpC,YAAY,IAAI,KAAK,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;EACzD,YAAY,IAAI,SAAS,GAAG,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,SAAS,CAAC;EAClE,YAAY,IAAI,CAAC,KAAK,IAAI,CAAC,mBAAmB,CAAC,SAAS,CAAC,IAAI,UAAU,CAAC,SAAS,CAAC,EAAE;EACpF,gBAAgB1B,IAAQ,CAACC,OAAW,CAAC,yBAAyB,CAAC,CAAC;EAChE,gBAAgB,OAAO;EACvB,aAAa;EACb,YAAY,KAAK,CAAC,GAAG,CAAC,WAAW,EAAE,EAAE,MAAM,EAAE,iBAAiB,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;EAClG,YAAY,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;EAChC;EACA,YAAY,IAAI,KAAK,CAAC,QAAQ,IAAI,KAAK,CAAC,QAAQ,CAAC,GAAG,KAAK,KAAK,CAAC,QAAQ,CAAC,MAAM,EAAE;EAChF,gBAAgB,IAAI,MAAM,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,KAAK,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;EAC5E,gBAAgB,MAAM,CAAC,GAAG,CAAC,WAAW,EAAE,EAAE,MAAM,EAAE,iBAAiB,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;EACvG,aAAa;EACb,SAAS,CAAC,CAAC;EACX,KAAK;EACL,IAAI,eAAe,EAAE,UAAU,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE;EACxD;EACA,QAAQ,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE;EAC3B,YAAY,OAAO,OAAO,CAAC;EAC3B,SAAS;EACT,QAAQ,IAAI,QAAQ,GAAG,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,UAAU,OAAO,EAAE;EAChE,YAAY,OAAO,EAAE,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,IAAI,KAAK,iBAAiB,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC;EAC7H,SAAS,CAAC,CAAC;EACX,QAAQ,OAAO,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC,GAAG,CAAC,UAAU,OAAO,EAAE;EAC9D,YAAY,OAAO,EAAE,IAAI,EAAE,iBAAiB,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC,EAAE,CAAC;EACzE,SAAS,CAAC,CAAC,CAAC;EACZ,KAAK;EACL,IAAI,OAAO,EAAE,UAAU,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE;EAChD;EACA,QAAQ,IAAI,KAAK,CAAC,MAAM,EAAE;EAC1B,YAAY,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,UAAU,OAAO,EAAE;EACtD,gBAAgB,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,IAAI,KAAK,iBAAiB,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EAChI,gBAAgB,MAAM,CAAC,IAAI,GAAG,OAAO,CAAC;EACtC,gBAAgB,OAAO,MAAM,CAAC,KAAK,CAAC;EACpC,gBAAgB,OAAO,MAAM,CAAC,MAAM,CAAC;EACrC,aAAa,CAAC,CAAC;EACf,SAAS;EACT,QAAQ,OAAO,OAAO,CAAC;EACvB,KAAK;EACL,CAAC,CAAC;AACF,EACO,SAAS6C,QAAM,CAAC,KAAK,EAAE,OAAO,EAAE;EACvC,IAAI,IAAI,KAAK,GAAG7D,CAAW,CAAC,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC;EACtD,IAAI,OAAO,SAAS,GAAG,KAAK,GAAG,GAAG,CAAC;EACnC,CAAC;;EClDM,IAAI,KAAK,GAAG,QAAQ,CAAC;AAC5B,EAAO,IAAI,aAAa,GAAG,gBAAgB,CAAC;EAC5C,IAAI,QAAQ,GAAG;EACf,IAAI,SAAS,EAAE,YAAY;EAC3B,IAAI,WAAW,EAAE,kBAAkB;EACnC,IAAI,OAAO,EAAE,UAAU,KAAK,EAAE,OAAO,EAAE;EACvC,QAAQ,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;EAChC,QAAQ,IAAI,SAAS,GAAG8D,aAAM,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;EAC5C,QAAQ,IAAI,OAAO,GAAG,EAAE,CAAC;EACzB,QAAQ,IAAI,SAAS,GAAG,EAAE,CAAC;EAC3B,QAAQ,IAAI,aAAa,GAAG,EAAE,CAAC;EAC/B,QAAQ,IAAI,aAAa,GAAG,EAAE,CAAC;EAC/B,QAAQ,IAAI,OAAO,CAAC,SAAS,IAAI,CAAC,SAAS,EAAE;EAC7C,YAAY,IAAI,YAAY,GAAG,0CAA0C,GAAG9D,CAAW,CAAC,IAAI,GAAG,KAAK,CAAC,CAAC;EACtG,YAAY,MAAM,CAAC,OAAO,EAAE,UAAU,CAAC,EAAE,GAAG,EAAE;EAC9C,gBAAgB,IAAI,OAAO,GAAG,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,MAAM,KAAK,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,EAAE,CAAC,CAAC;EACpF,gBAAgB,IAAI,OAAO,CAAC,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,EAAE;EACvD,oBAAoB,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;EAC/C,iBAAiB;EACjB,aAAa,CAAC,CAAC;EACf,SAAS;EACT,QAAQ,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;EAC7C,YAAY,IAAI,OAAO,GAAG,CAAC,CAAC,OAAO,CAAC;EACpC,YAAY,IAAI,OAAO,KAAK,CAAC,IAAI,OAAO,KAAK,CAAC,EAAE;EAChD,gBAAgB,IAAI,CAAC,6DAA6D,CAAC,CAAC;EACpF,gBAAgB,OAAO;EACvB,aAAa;EACb,YAAY,IAAI,EAAE,GAAG,cAAc,CAAC,KAAK,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;EAC7D,YAAY,IAAI,KAAK,GAAG,iBAAiB,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;EACpE,YAAY,IAAI,KAAK,GAAG,iBAAiB,CAAC,OAAO,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;EACtE,YAAY,IAAI,QAAQ,GAAGA,CAAW,CAAC,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC;EACjE,YAAY,IAAI,SAAS,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EACzE,YAAY,IAAI,KAAK,GAAG,mBAAmB,CAAC,SAAS,CAAC,GAAG,GAAG,GAAG,EAAE,CAAC;EAClE,YAAY,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;EAC5C,YAAY,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;EACtC,YAAY,SAAS,CAAC,IAAI,CAAC,aAAa,GAAGA,CAAW,CAAC,OAAO,CAAC,GAAG,IAAI;EACtE,iBAAiB,SAAS,GAAGA,CAAW,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,YAAY,GAAG,KAAK,GAAG,GAAG,CAAC,CAAC,CAAC;EACjF,YAAY,aAAa,CAAC,IAAI,CAAC;EAC/B,gBAAgB,SAAS,EAAE,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC;EACnD,gBAAgB,IAAI,EAAE,YAAY,GAAG,KAAK,GAAG,OAAO;EACpD,qBAAqB,GAAG,GAAG,KAAK,GAAG,SAAS,GAAG,QAAQ,GAAG,IAAI,GAAG,KAAK,GAAG,WAAW,GAAG,KAAK,GAAG,KAAK,GAAG,SAAS,CAAC;EACjH,qBAAqB,KAAK,GAAG,SAAS,GAAG,QAAQ,GAAG,IAAI,GAAG,KAAK,GAAG,WAAW,GAAG,KAAK,GAAG,KAAK,GAAG,OAAO,CAAC;EACzG,aAAa,CAAC,CAAC;EACf,SAAS,CAAC,CAAC;EACX;EACA;EACA,QAAQ,IAAI,CAAC,SAAS,EAAE;EACxB,YAAY,OAAO,CAAC,IAAI,CAAC;EACzB,gBAAgB,IAAI,EAAE,IAAI,GAAG,aAAa;EAC1C,gBAAgB,MAAM,EAAE,aAAa,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC;EACvF,qBAAqB,KAAK,IAAI,IAAI,GAAG,aAAa,CAAC,GAAG,OAAO,CAAC;EAC9D,aAAa,CAAC,CAAC;EACf,SAAS;EACT;EACA;EACA;EACA,QAAQ,OAAO,OAAO,CAAC,MAAM,CAAC;EAC9B,YAAY,IAAI,EAAE,IAAI,GAAG,KAAK;EAC9B,YAAY,EAAE,EAAE,CAAC;EACjB,oBAAoB,MAAM,EAAE,aAAa,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;EACvF,oBAAoB,MAAM,EAAE,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC;EACtD,yBAAyB,YAAY,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,gBAAgB,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,WAAW,CAAC;EAChH,iBAAiB,CAAC;EAClB,SAAS,CAAC,CAAC;EACX,KAAK;EACL,IAAI,UAAU,EAAE,UAAU,KAAK,EAAE,OAAO,EAAE;EAC1C,QAAQ,IAAI,GAAG,GAAG,OAAO,CAAC,IAAI,GAAG,KAAK,CAAC;EACvC,QAAQ,OAAO,GAAG,GAAG,IAAI;EACzB,aAAa,OAAO,CAAC,OAAO,KAAK,QAAQ,GAAG,MAAM,GAAG,SAAS,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,CAAC;EACxF,KAAK;EACL,IAAI,KAAK,EAAE,UAAU,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE;EAC5C,QAAQ,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;EAChC,QAAQ,IAAI,EAAE,GAAG,qBAAqB,CAAC,OAAO,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;EACxE,QAAQ,IAAI,KAAK,GAAG,OAAO,GAAGA,CAAW,CAAC,OAAO,CAAC,IAAI,GAAG,KAAK,CAAC,GAAG,GAAG,CAAC;EACtE;EACA,QAAQ,IAAI8D,aAAM,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE;EACjC,YAAY,OAAO,KAAK,CAAC;EACzB,SAAS;EACT,QAAQ,IAAI,MAAM,GAAG;EACrB,YAAY,CAAC,EAAE,EAAE,KAAK,IAAI,GAAG,EAAE,MAAM,EAAE,IAAI,GAAG,OAAO,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE;EACtE,YAAY,CAAC,EAAE,EAAE,KAAK,IAAI,GAAG,EAAE,MAAM,EAAE,IAAI,GAAG,OAAO,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,EAAE;EACtE,YAAY,EAAE,EAAE,EAAE,KAAK,IAAI,GAAG,EAAE,MAAM,EAAE,IAAI,GAAG,OAAO,EAAE,GAAG,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,EAAE;EACxF,YAAY,EAAE,EAAE,EAAE,KAAK,IAAI,GAAG,EAAE,MAAM,EAAE,IAAI,GAAG,OAAO,EAAE,GAAG,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,QAAQ,EAAE,EAAE;EACzF,SAAS,CAAC;EACV;EACA;EACA;EACA;EACA,QAAQ,IAAI,OAAO,CAAC,OAAO,KAAK,QAAQ,EAAE;EAC1C,YAAY,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACtE,gBAAgB,IAAIpD,MAAG,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EACjC,gBAAgB,MAAM,CAACA,MAAG,CAAC,GAAG,CAACH,QAAgB,CAAC,EAAE,IAAI,EAAE,KAAK,GAAG,aAAa,GAAG,KAAK,GAAG,eAAe,GAAG,QAAQ,CAAC,KAAK,CAAC,EAAE,EAAE,MAAM,CAACG,MAAG,CAAC,CAAC,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;EACzJ,aAAa;EACb,SAAS;EACT;EACA;EACA;EACA,QAAQ,IAAI,EAAE,GAAG,OAAO,CAAC,IAAI,EAAE,IAAI,GAAG,EAAE,CAAC,IAAI,EAAE,WAAW,GAAG,EAAE,CAAC,WAAW,EAAE,MAAM,GAAGE,MAAc,CAAC,EAAE,EAAE,CAAC,MAAM,EAAE,aAAa,CAAC,CAAC,CAAC;EAClI,QAAQ,IAAI,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,MAAM,CAAC,UAAU,GAAG,EAAE,CAAC,EAAE;EAC7D,YAAY,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC;EACtB,oBAAoB,IAAI,EAAE;EAC1B,wBAAwB,EAAE,KAAK,IAAI,IAAI,IAAI,GAAG,YAAY,GAAG,IAAI,GAAG,OAAO;EAC3E,wBAAwB,EAAE,IAAI,IAAI,IAAI,IAAI,GAAG,YAAY,GAAG,IAAI,GAAG,OAAO;EAC1E,qBAAqB,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC;EACrE,oBAAoB,KAAK,EAAE,MAAM,CAAC,CAAC,CAAC;EACpC,iBAAiB,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC,CAAC;EACpC,YAAY,OAAO,GAAG,CAAC;EACvB,SAAS,EAAE,EAAE,CAAC,CAAC;EACf,QAAQ,OAAO,CAAC;EAChB,gBAAgB,IAAI,EAAE,IAAI,GAAG,KAAK,GAAG,KAAK;EAC1C,gBAAgB,IAAI,EAAE,MAAM;EAC5B,gBAAgB,IAAI,EAAE,IAAI;EAC1B,gBAAgB,MAAM,EAAE;EACxB,oBAAoB,KAAK,EAAE;EAC3B,wBAAwB,IAAI,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE;EAC7C,wBAAwB,WAAW,EAAE,EAAE,KAAK,EAAE,WAAW,EAAE;EAC3D,qBAAqB;EACrB,oBAAoB,MAAM,EAAE,MAAM;EAClC,iBAAiB;EACjB,aAAa,CAAC,CAAC,MAAM,CAAC,KAAK,EAAE;EAC7B,YAAY,IAAI,EAAE,IAAI,GAAG,KAAK;EAC9B,YAAY,IAAI,EAAE,MAAM;EACxB,YAAY,IAAI,EAAE,IAAI;EACtB,YAAY,MAAM,EAAE;EACpB,gBAAgB,KAAK,EAAE;EACvB,oBAAoB,IAAI,EAAE,EAAE,KAAK,EAAE,aAAa,EAAE;EAClD,iBAAiB;EACjB,gBAAgB,MAAM,EAAEL,QAAgB,CAAC,EAAE,EAAE,MAAM,EAAE,QAAQ,CAAC;EAC9D,aAAa;EACb,SAAS,CAAC,CAAC;EACX,KAAK;EACL,CAAC,CAAC;AACF,EACA;EACA;EACA;EACA,SAAS,cAAc,CAAC,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE;EACjD,IAAI,IAAI,KAAK,GAAG,iBAAiB,CAAC,OAAO,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;EAC9D,IAAI,IAAI,KAAK,GAAG,iBAAiB,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;EAC5D,IAAI,IAAI,SAAS,GAAGuD,aAAM,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;EACxC,IAAI,IAAI,SAAS,GAAG,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;EAC7C,IAAI,IAAI,QAAQ,GAAG9D,CAAW,CAAC,SAAS,CAAC,CAAC;EAC1C,IAAI,IAAI,KAAK,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;EACjD,IAAI,IAAI,SAAS,GAAG,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,SAAS,CAAC;EAC1D,IAAI,IAAI,IAAI,GAAG,KAAK,CAAC,gBAAgB,CAAC,OAAO,KAAK,CAAC,GAAG,OAAO,GAAG,QAAQ,CAAC,CAAC,MAAM,CAAC;EACjF,IAAI,IAAI,KAAK,GAAG,OAAO,GAAG,QAAQ,CAAC;EACnC,IAAI,IAAI,EAAE,GAAG,MAAM,CAAC,OAAO,EAAE,UAAU,GAAG,EAAE,GAAG,EAAE;EACjD,QAAQ,OAAO,GAAG,CAAC,MAAM,CAAC,EAAE,MAAM,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,MAAM,EAAE,GAAG,GAAG,KAAK,GAAG,IAAI,GAAG,KAAK,GAAG,GAAG,EAAE;EAC9F,QAAQ,EAAE,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,GAAG,KAAK,GAAG,aAAa,GAAG,KAAK,GAAG,OAAO,GAAG,IAAI,GAAG,IAAI,EAAE;EAC5F,SAAS,CAAC;EACV,KAAK,CAAC,CAAC;EACP;EACA;EACA;EACA,IAAI,EAAE,CAAC,IAAI,CAAC;EACZ,QAAQ,MAAM,EAAE,EAAE,MAAM,EAAE,OAAO,CAAC,IAAI,GAAG,aAAa,EAAE;EACxD,QAAQ,MAAM,EAAE,mBAAmB,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC;EACxE,YAAY,SAAS,GAAG,QAAQ,GAAG,IAAI,GAAG,KAAK,GAAG,cAAc,GAAG,QAAQ,GAAG,IAAI,GAAG,KAAK,GAAG,OAAO,GAAG,QAAQ;EAC/G,KAAK,CAAC,CAAC;EACP,IAAI,OAAO,SAAS,GAAG,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,GAAG,CAAC;EACpD,YAAY,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE;EAC1C,SAAS,EAAE;EACX,YAAY,IAAI,EAAE,KAAK;EACvB,YAAY,EAAE,EAAE,CAAC,EAAE,MAAM,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,MAAM,EAAE,KAAK,GAAG,UAAU,GAAG,KAAK,GAAG,sBAAsB,GAAG,QAAQ,GAAG,IAAI,GAAG,KAAK,GAAG,GAAG,EAAE,CAAC;EAC5I,SAAS,CAAC,CAAC;EACX,CAAC;EACD,SAAS,MAAM,CAAC,OAAO,EAAE,EAAE,EAAE;EAC7B,IAAI,OAAO,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,UAAU,EAAE,EAAE,GAAG,EAAE;EACpD,QAAQ,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE;EAC1B,YAAY,IAAI,CAAC,GAAG,GAAG,yDAAyD,CAAC,CAAC;EAClF,YAAY,OAAO,EAAE,CAAC;EACtB,SAAS;EACT,QAAQ,OAAO,EAAE,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC;EAC3B,KAAK,EAAE,EAAE,CAAC,CAAC;EACX,CAAC;;ECnLD,IAAI,OAAO,GAAG,SAAS,CAAC;EACxB,IAAI,OAAO,GAAG;EACd,IAAI,GAAG,EAAE,UAAU,OAAO,EAAE;EAC5B,QAAQ,OAAO,OAAO,CAAC,IAAI,KAAK,UAAU,IAAI,OAAO,CAAC,OAAO,CAAC;EAC9D,KAAK;EACL,IAAI,KAAK,EAAE,UAAU,KAAK,EAAE,OAAO,EAAE,KAAK,EAAE;EAC5C,QAAQ,IAAI,EAAE,GAAG,qBAAqB,CAAC,OAAO,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;EACpE,QAAQ,IAAI,QAAQ,GAAG,KAAK,CAAC,IAAI,CAAC;EAClC,QAAQ,IAAI,UAAU,CAAC,QAAQ,CAAC,EAAE;EAClC,YAAYe,IAAQ,CAACC,OAAW,CAAC,8BAA8B,CAAC,QAAQ,CAAC,CAAC,CAAC;EAC3E,YAAY,OAAO,KAAK,CAAC;EACzB,SAAS;EACT,QAAQ,IAAI,OAAO,GAAG;EACtB,YAAY,IAAI,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC;EACxC,YAAY,IAAI,EAAE,MAAM;EACxB,YAAY,IAAI,EAAE,EAAE,IAAI,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;EAClD,YAAY,MAAM,EAAE;EACpB,gBAAgB,KAAK,EAAE;EACvB,oBAAoB,IAAI,EAAE,EAAE,KAAK,EAAE,aAAa,EAAE;EAClD,oBAAoB,WAAW,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE;EAChD,oBAAoB,MAAM,EAAE,EAAE,KAAK,EAAE,aAAa,EAAE;EACpD,oBAAoB,SAAS,EAAE,EAAE,KAAK,EAAE,IAAI,EAAE;EAC9C,iBAAiB;EACjB,aAAa;EACb,YAAY,SAAS,EAAE,CAAC;EACxB,oBAAoB,IAAI,EAAE,SAAS;EACnC,oBAAoB,CAAC,EAAE,EAAE,IAAI,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,oBAAoB,GAAG,GAAG,EAAE;EAC/E,oBAAoB,CAAC,EAAE,EAAE,IAAI,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,oBAAoB,GAAG,GAAG,EAAE;EAC/E,oBAAoB,IAAI,EAAE,CAAC,KAAK,CAAC,gBAAgB,CAAC,OAAO,CAAC,EAAE,KAAK,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;EAC7F,iBAAiB,CAAC;EAClB,SAAS,CAAC;EACV,QAAQ,IAAI,KAAK,GAAG,CAAC,CAAC;EACtB,QAAQ,IAAI,MAAM,GAAG,KAAK,CAAC;EAC3B,QAAQ,KAAK,CAAC,OAAO,CAAC,UAAU,IAAI,EAAE,CAAC,EAAE;EACzC,YAAY,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,IAAI,EAAE,CAAC;EACvC,YAAY,IAAI,IAAI,KAAK,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE;EACvD,gBAAgB,KAAK,GAAG,CAAC,CAAC;EAC1B,aAAa;EACb,iBAAiB,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;EACjD,gBAAgB,MAAM,GAAG,IAAI,CAAC;EAC9B,aAAa;EACb,SAAS,CAAC,CAAC;EACX,QAAQ,IAAI,CAAC,MAAM,EAAE;EACrB,YAAY,KAAK,CAAC,MAAM,CAAC,KAAK,GAAG,CAAC,EAAE,CAAC,EAAE,OAAO,CAAC,CAAC;EAChD,SAAS;EACT,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,CAAC,CAAC;;EC9CK,SAAS,OAAO,CAAC,KAAK,EAAE,OAAO,EAAE;EACxC,IAAI,IAAI,IAAI,GAAG,OAAO,CAAC,OAAO,CAAC;EAC/B,IAAI,IAAI,KAAK,GAAG,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC;EACpC,QAAQ,0CAA0C,GAAG,OAAO,CAAC;EAC7D,IAAI,IAAI,IAAI,GAAG,EAAE,CAAC;EAClB,IAAI,IAAI,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAOhB,CAAW,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EAC5H,IAAI,IAAI,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAOA,CAAW,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACpF,IAAI,IAAI,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;EACvC,QAAQ,IAAI,OAAO,GAAG,CAAC,CAAC,OAAO,CAAC;EAChC,QAAQ,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC/C;EACA,QAAQ,OAAO,CAAC,QAAQ,IAAI,QAAQ,CAAC,GAAG,KAAK,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;EAC/D,YAAY,GAAG,GAAG,mBAAmB,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,EAAE,KAAK,CAAC,GAAG,IAAI;EAC/E,iBAAiB,mBAAmB,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,EAAE,KAAK,CAAC,GAAG,GAAG,CAAC;EAChG,YAAY,EAAE,GAAG,mBAAmB,CAAC,CAAC,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;EACrD,KAAK,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EAClB;EACA;EACA;EACA;EACA;EACA;EACA;EACA,IAAI,OAAO,CAAC;EACZ,YAAY,IAAI,EAAE,OAAO,CAAC,IAAI,GAAG,KAAK;EACtC,YAAY,KAAK,EAAE,EAAE;EACrB,YAAY,EAAE,EAAE,CAAC;EACjB,oBAAoB,MAAM,EAAE,OAAO,CAAC,MAAM;EAC1C,oBAAoB,MAAM,EAAE,8CAA8C;EAC1E,yBAAyB,SAAS,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,gBAAgB,GAAG,SAAS,GAAG,KAAK,CAAC;EAC5F,yBAAyB,WAAW,GAAG,MAAM,GAAG,cAAc,GAAG,MAAM,GAAG,GAAG,CAAC;EAC9E,yBAAyB,IAAI,CAAC,MAAM,GAAG,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAOA,CAAW,CAAC,MAAM,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;EACjI,wBAAwB,UAAU;EAClC,oBAAoB,KAAK,EAAE,IAAI;EAC/B,iBAAiB,CAAC;EAClB,SAAS,CAAC,CAAC;EACX,CAAC;EACD,IAAI,KAAK,GAAG;EACZ,IAAI,SAAS,EAAE,SAAS;EACxB,IAAI,WAAW,EAAE,eAAe;EAChC,IAAI,OAAO,EAAE,OAAO;EACpB,IAAI,UAAU,EAAE,UAAU,KAAK,EAAE,OAAO,EAAE;EAC1C,QAAQ,IAAI,GAAG,GAAG,OAAO,CAAC,IAAI,GAAG,KAAK,CAAC;EACvC,QAAQ,OAAO,GAAG,GAAG,IAAI;EACzB,aAAa,OAAO,CAAC,OAAO,KAAK,QAAQ,GAAG,MAAM,GAAG,SAAS,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,CAAC;EACxF,KAAK;EACL,CAAC,CAAC;;EC/CF,IAAI,MAAM,GAAG;EACb,IAAI,SAAS,EAAE,UAAU;EACzB,IAAI,WAAW,EAAE,gBAAgB;EACjC,IAAI,OAAO,EAAE+D,OAAY;EACzB,IAAI,eAAe,EAAE,UAAU,KAAK,EAAE,OAAO,EAAEC,UAAO,EAAE;EACxD,QAAQ,IAAI,SAAS,GAAGA,UAAO,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,IAAI,KAAK,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;EACzF,QAAQ,IAAI,IAAI,GAAG,OAAO,GAAGhE,CAAW,CAAC,OAAO,CAAC,IAAI,GAAG,KAAK,CAAC,GAAG,GAAG,CAAC;EACrE,QAAQ,IAAI,MAAM,GAAG,IAAI,GAAG,YAAY,CAAC;EACzC,QAAQ,OAAO,SAAS,CAAC,MAAM,GAAGgE,UAAO,GAAGA,UAAO,CAAC,MAAM,CAAC;EAC3D,YAAY,IAAI,EAAE,OAAO,CAAC,IAAI;EAC9B,YAAY,MAAM,EAAE,IAAI,GAAG,cAAc;EACzC,gBAAgB,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,KAAK,GAAG,IAAI,GAAG,MAAM,GAAG,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG;EACzH,SAAS,CAAC,CAAC;EACX,KAAK;EACL,IAAI,UAAU,EAAE,UAAU,KAAK,EAAE,OAAO,EAAE;EAC1C,QAAQ,IAAI,GAAG,GAAG,OAAO,CAAC,IAAI,GAAG,KAAK,CAAC;EACvC,QAAQ,OAAO,GAAG,GAAG,IAAI;EACzB,aAAa,OAAO,CAAC,OAAO,KAAK,QAAQ,GAAG,MAAM,GAAG,SAAS,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,CAAC;EACxF,KAAK;EACL,CAAC,CAAC;;EClBF,IAAI,aAAa,GAAG;EACpB,IAAI,GAAG,EAAE,UAAU,OAAO,EAAE;EAC5B,QAAQ,OAAO,OAAO,CAAC,IAAI,KAAK,QAAQ,IAAI,OAAO,CAAC,OAAO,KAAK,QAAQ;EACxE,YAAY,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,IAAI,KAAK,QAAQ,CAAC;EACtD,KAAK;EACL,IAAI,eAAe,EAAE,UAAU,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE;EACxD,QAAQ,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;EAChC,QAAQ,IAAI,IAAI,GAAG,OAAO,CAAC,OAAO,CAAC;EACnC,QAAQ,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;EAChC,QAAQ,IAAI,KAAK,GAAG,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC;EACxC,YAAY,0CAA0C,GAAG,OAAO,CAAC;EACjE,QAAQ,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;EAClC,YAAY,IAAI,MAAM,GAAG,OAAO,CAAC,IAAI,GAAG,GAAG,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC;EACvD,YAAY,IAAI,SAAS,GAAG,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,IAAI,KAAK,MAAM,CAAC,EAAE,CAAC,CAAC;EACvF,YAAY,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE;EACnC,gBAAgB,OAAO,CAAC,OAAO,CAAC;EAChC,oBAAoB,IAAI,EAAE,MAAM;EAChC,oBAAoB,KAAK,EAAE,EAAE;EAC7B,oBAAoB,EAAE,EAAE,CAAC;EACzB,4BAA4B,MAAM,EAAE,OAAO,CAAC,MAAM;EAClD,4BAA4B,MAAM,EAAE,8CAA8C,GAAG,mBAAmB,CAAC,CAAC,CAAC,KAAK,EAAE,KAAK,CAAC,GAAG,SAAS;EACpI,yBAAyB,CAAC;EAC1B,oBAAoB,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,IAAI,IAAI;EAClE,iBAAiB,CAAC,CAAC;EACnB,aAAa;EACb,SAAS,CAAC,CAAC;EACX,QAAQ,OAAO,OAAO,CAAC;EACvB,KAAK;EACL,IAAI,OAAO,EAAE,UAAU,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE;EAChD,QAAQ,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;EAChC,QAAQ,IAAI,IAAI,GAAG,OAAO,CAAC,OAAO,CAAC;EACnC,QAAQ,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,IAAI,KAAK,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;EACzF,QAAQ,IAAI,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAOhE,CAAW,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACxF,QAAQ,IAAI,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,OAAO,CAAC,IAAI,GAAG,GAAG,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;EACtF,QAAQ,IAAI,MAAM,CAAC,MAAM,EAAE;EAC3B,YAAY,MAAM,CAAC,MAAM,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,eAAe,GAAG,MAAM,GAAG,cAAc,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,WAAW,CAAC;EAC9H,SAAS;EACT,QAAQ,OAAO,MAAM,CAAC,KAAK,CAAC;EAC5B,QAAQ,OAAO,MAAM,CAAC,EAAE,CAAC;EACzB,QAAQ,OAAO,OAAO,CAAC;EACvB,KAAK;EACL,CAAC,CAAC;;EC1CF,IAAI,OAAO,GAAG;EACd,IAAI,GAAG,EAAE,UAAU,MAAM,EAAE;EAC3B,QAAQ,IAAI,GAAG,GAAG,MAAM,CAAC;EACzB,QAAQ,OAAO,GAAG,CAAC,MAAM,KAAK,SAAS,IAAI,GAAG,CAAC,SAAS,KAAK,SAAS,CAAC;EACvE,KAAK;EACL,IAAI,KAAK,EAAE,UAAU,KAAK,EAAE,MAAM,EAAE,OAAO,EAAE;EAC7C,QAAQ,IAAI,QAAQ,GAAG,EAAE,CAAC;EAC1B,QAAQ,IAAI,SAAS,GAAG,EAAE,CAAC;EAC3B;EACA,QAAQ,CAAC,MAAM,CAAC,MAAM,IAAI,EAAE,EAAE,OAAO,CAAC,UAAU,KAAK,EAAE,EAAE,OAAO,QAAQ,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC;EAC3F,QAAQ,CAAC,MAAM,CAAC,SAAS,IAAI,EAAE,EAAE,OAAO,CAAC,UAAU,OAAO,EAAE;EAC5D,YAAY,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;EACnD,YAAY,IAAI,QAAQ,EAAE;EAC1B,gBAAgB,IAAI,QAAQ,CAAC,QAAQ,EAAE;EACvC,oBAAoB,IAAI,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;EACzD,oBAAoB,QAAQ,CAAC,OAAO,CAAC,GAAG,OAAO,CAAC;EAChD;EACA;EACA;EACA;EACA,oBAAoB,SAAS,CAAC,OAAO,CAAC,GAAG;EACzC,wBAAwB,EAAE,EAAE,OAAO;EACnC,wBAAwB,KAAK,EAAE,QAAQ,CAAC,KAAK;EAC7C,wBAAwB,QAAQ,EAAE,QAAQ,CAAC,QAAQ;EACnD,qBAAqB,CAAC;EACtB,iBAAiB;EACjB,qBAAqB;EACrB,oBAAoB,QAAQ,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,OAAO,CAAC;EACvD,iBAAiB;EACjB,aAAa;EACb,iBAAiB;EACjB,gBAAgBe,IAAQ,CAACC,OAAW,CAAC,kCAAkC,CAAC,OAAO,CAAC,CAAC,CAAC;EAClF,aAAa;EACb,SAAS,CAAC,CAAC;EACX,QAAQ,IAAI,UAAU,GAAG,OAAO,CAAC,OAAO,KAAK,OAAO,CAAC,OAAO,GAAG,EAAE,CAAC,CAAC;EACnE,QAAQ,KAAK,IAAI,KAAK,IAAI,QAAQ,EAAE;EACpC,YAAY,IAAI,QAAQ,CAAC,cAAc,CAAC,KAAK,CAAC,EAAE;EAChD,gBAAgB,UAAU,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;EAC5E,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,KAAK,OAAO,CAAC,MAAM,GAAG,EAAE,CAAC,CAAC;EAC7D,QAAQ,UAAU,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;EAC5H,QAAQ,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,MAAM,EAAE;EACpC,YAAY,OAAO,CAAC,QAAQ,GAAG,IAAI,YAAY,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;EACjE,SAAS;EACT,KAAK;EACL,CAAC,CAAC;;EChDF,IAAI,MAAM,GAAG,SAAS,CAAC;EACvB,IAAI,MAAM,GAAG;EACb,IAAI,GAAG,EAAE,UAAU,OAAO,EAAE;EAC5B,QAAQ,OAAO,OAAO,CAAC,IAAI,KAAK,OAAO,IAAI,OAAO,CAAC,MAAM,CAAC;EAC1D,KAAK;EACL,IAAI,OAAO,EAAE,UAAU,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE;EAChD,QAAQ,OAAO,OAAO,CAAC,MAAM,CAAC;EAC9B,YAAY,IAAI,EAAE,OAAO,CAAC,IAAI,GAAG,MAAM;EACvC,YAAY,KAAK,EAAE,KAAK;EACxB,YAAY,EAAE,EAAE,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,MAAM,EAAE,MAAM,EAAE,OAAO,CAAC,MAAM,EAAE,CAAC;EACpE,SAAS,CAAC,CAAC;EACX,KAAK;EACL,IAAI,UAAU,EAAE,UAAU,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE;EAChD,QAAQ,IAAI,GAAG,GAAG,OAAO,CAAC,IAAI,GAAG,KAAK,CAAC;EACvC,QAAQ,IAAI,MAAM,GAAG,OAAO,CAAC,IAAI,GAAG,MAAM,CAAC;EAC3C,QAAQ,OAAO,MAAM,GAAG,YAAY,GAAG,GAAG,GAAG,IAAI;EACjD,aAAa,OAAO,CAAC,OAAO,KAAK,QAAQ;EACzC,gBAAgB,MAAM,GAAG,kBAAkB;EAC3C,gBAAgB,MAAM,GAAG,mBAAmB,GAAG,QAAQ,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC;EACvE,aAAa,MAAM,GAAG,KAAK,GAAG,GAAG,GAAG,SAAS,CAAC,CAAC;EAC/C,KAAK;EACL,CAAC,CAAC;;ECjBF,IAAI,MAAM,GAAG,mBAAmB,CAAC;EACjC,IAAI,KAAK,GAAG,kBAAkB,CAAC;EAC/B,IAAI,SAAS,GAAG;EAChB,IAAI,GAAG,EAAE,UAAU,OAAO,EAAE;EAC5B,QAAQ,OAAO,OAAO,CAAC,IAAI,KAAK,UAAU,IAAI,OAAO,CAAC,SAAS,CAAC;EAChE,KAAK;EACL,IAAI,OAAO,EAAE,UAAU,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE;EAChD,QAAQ,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;EAChC,QAAQ,IAAI,SAAS,GAAGiD,aAAc,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;EACpD,QAAQ,IAAI,MAAM,GAAG,IAAI,GAAG,MAAM,CAAC;EACnC,QAAQ,IAAI,EAAE,GAAG,qBAAqB,CAAC,OAAO,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;EACpE,QAAQ,IAAI,MAAM,GAAG,aAAa,CAAC,OAAO,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;EAC/D,QAAQ,IAAI,CAAC,SAAS,EAAE;EACxB,YAAY,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,IAAI,GAAGC,KAAc,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC;EAC7G,SAAS;EACT,QAAQ,OAAO,CAAC,IAAI,CAAC;EACrB,YAAY,IAAI,EAAE,MAAM;EACxB,YAAY,KAAK,EAAE,EAAE;EACrB,YAAY,EAAE,EAAE,CAAC;EACjB,oBAAoB,MAAM,EAAE,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;EAC7E,oBAAoB,MAAM,EAAE,yBAAyB;EACrD,yBAAyB,CAAC,KAAK,IAAI,GAAG,cAAc,IAAI,SAAS,GAAGL,QAAM,CAAC,KAAK,EAAE,CAAC,CAAC;EACpF,4BAA4B,QAAQ,GAAG,iBAAiB,CAAC,OAAO,EAAE,GAAG,EAAE,QAAQ,CAAC,GAAG,GAAG,CAAC,GAAG,EAAE,CAAC;EAC7F,yBAAyB,CAAC,KAAK,IAAI,GAAG,cAAc,IAAI,SAAS,GAAGA,QAAM,CAAC,KAAK,EAAE,CAAC,CAAC;EACpF,4BAA4B,QAAQ,GAAG,iBAAiB,CAAC,OAAO,EAAE,GAAG,EAAE,QAAQ,CAAC,GAAG,GAAG,CAAC,GAAG,EAAE,CAAC,GAAG,GAAG;EACnG,iBAAiB,CAAC;EAClB,SAAS,EAAE;EACX,YAAY,IAAI,EAAE,IAAI,GAAG,KAAK;EAC9B,YAAY,KAAK,EAAE,EAAE;EACrB,YAAY,EAAE,EAAE,CAAC;EACjB,oBAAoB,MAAM,EAAE,MAAM;EAClC,oBAAoB,MAAM,EAAE,MAAM,GAAG,MAAM,GAAG,mBAAmB,GAAG,MAAM,GAAG,eAAe;EAC5F,iBAAiB,CAAC;EAClB,SAAS,CAAC,CAAC;EACX,QAAQ,IAAI,CAAC,KAAK,IAAI,EAAE;EACxB,YAAY,OAAO,CAAC,KAAK,EAAE,OAAO,EAAE,CAAC,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;EACzD,SAAS;EACT,QAAQ,IAAI,CAAC,KAAK,IAAI,EAAE;EACxB,YAAY,OAAO,CAAC,KAAK,EAAE,OAAO,EAAE,CAAC,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;EAC1D,SAAS;EACT,QAAQ,OAAO,OAAO,CAAC;EACvB,KAAK;EACL,CAAC,CAAC;AACF,EACA,SAAS,OAAO,CAAC,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE;EACzD,IAAI,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;EAC5B,IAAI,IAAI,SAAS,GAAGI,aAAc,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;EAChD,IAAI,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE;EAC7C,QAAQ,OAAO,CAAC,CAAC,IAAI,KAAK,iBAAiB,CAAC,OAAO,EAAE,OAAO,EAAE,SAAS,GAAG,MAAM,GAAG,QAAQ,CAAC,CAAC;EAC7F,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;EACV,IAAI,IAAI,MAAM,GAAG,IAAI,GAAG,MAAM,CAAC;EAC/B,IAAI,IAAI,KAAK,GAAG,IAAI,GAAG,KAAK,CAAC;EAC7B,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC;EACrD,IAAI,IAAI,SAAS,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;EACrD,IAAI,IAAI,SAAS,GAAG,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAC1C,IAAI,IAAI,IAAI,GAAG,SAAS,IAAI,OAAO,KAAK,CAAC,GAAG,GAAG,GAAG,EAAE,CAAC;EACrD,IAAI,IAAI,MAAM,GAAG,MAAM,GAAG,UAAU,GAAG,OAAO,CAAC;EAC/C,IAAI,IAAI,MAAM,GAAG,EAAE,GAAG,IAAI,GAAG,KAAK,GAAG,GAAG,GAAG,OAAO,GAAG,KAAK,IAAI,SAAS,GAAG,EAAE,GAAG,MAAM,GAAG,OAAO,GAAG,MAAM,GAAG,GAAG,CAAC,CAAC;EAChH,IAAI,IAAI,KAAK,GAAG,CAAC,SAAS,GAAG,WAAW;EACxC,QAAQ,SAAS,KAAK,KAAK,GAAG,QAAQ;EACtC,YAAY,SAAS,KAAK,KAAK,GAAG,QAAQ,GAAG,WAAW,CAAC;EACzD,IAAI,IAAI,MAAM,GAAG,KAAK,GAAG,GAAG,GAAG,MAAM,GAAG,IAAI,GAAG,MAAM;EACrD,SAAS,SAAS,IAAI,SAAS,KAAK,KAAK,GAAG,IAAI,IAAI,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,GAAG,CAAC;EAChG,IAAI,MAAM,CAAC,EAAE,CAAC,IAAI,CAAC;EACnB,QAAQ,MAAM,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE;EACjC,QAAQ,MAAM,EAAE,SAAS,GAAG,MAAM,GAAG,aAAa,GAAG,MAAM,GAAG,OAAO,GAAG,MAAM,GAAG,GAAG;EACpF,KAAK,CAAC,CAAC;EACP,CAAC;;EClED,IAAIE,QAAM,GAAG,cAAc,CAAC;EAC5B,IAAIC,OAAK,GAAG,aAAa,CAAC;EAC1B,IAAIC,MAAI,GAAG;EACX,IAAI,GAAG,EAAE,UAAU,OAAO,EAAE;EAC5B,QAAQ,OAAO,OAAO,CAAC,IAAI,KAAK,UAAU,IAAI,OAAO,CAAC,IAAI,CAAC;EAC3D,KAAK;EACL,IAAI,OAAO,EAAE,UAAU,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE;EAChD,QAAQ,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;EAChC,QAAQ,IAAI,SAAS,GAAGJ,aAAc,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;EACpD,QAAQ,IAAI,KAAK,GAAG,IAAI,GAAGG,OAAK,CAAC;EACjC,QAAQ,IAAI,EAAE,GAAG,qBAAqB,CAAC,OAAO,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;EACpE,QAAQ,IAAI,EAAE,GAAGpE,CAAW,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;EACjD,QAAQ,IAAI,EAAE,GAAGA,CAAW,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;EACjD,QAAQ,IAAI,MAAM,GAAG,aAAa,CAAC,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;EAC1D,QAAQ,IAAI,CAAC,SAAS,EAAE;EACxB,YAAY,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC,QAAQ,GAAG,IAAI,GAAGkE,KAAc,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC;EAClG,SAAS;EACT,QAAQ,OAAO,CAAC,IAAI,CAAC;EACrB,YAAY,IAAI,EAAE,IAAI,GAAGC,QAAM;EAC/B,YAAY,EAAE,EAAE,CAAC;EACjB,oBAAoB,MAAM,EAAE,MAAM;EAClC,oBAAoB,MAAM,EAAE,CAAC,SAAS,GAAG,0BAA0B;EACnE,wBAAwB,GAAG,GAAG;EAC9B,6BAA6B,EAAE,GAAG,YAAY,GAAG,EAAE,GAAG,YAAY,GAAG,EAAE;EACvE,6BAA6B,EAAE,GAAG,YAAY,GAAG,EAAE,GAAG,YAAY,GAAG,EAAE;EACvE,yBAAyB,CAAC,MAAM,CAAC,UAAU,IAAI,EAAE,EAAE,OAAO,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG;EACrF,iBAAiB,CAAC;EAClB,SAAS,EAAE;EACX,YAAY,IAAI,EAAE,KAAK;EACvB,YAAY,EAAE,EAAE,CAAC;EACjB,oBAAoB,MAAM,EAAE,MAAM;EAClC,oBAAoB,KAAK,EAAE,IAAI;EAC/B,oBAAoB,MAAM,EAAE,qDAAqD;EACjF,iBAAiB,CAAC;EAClB,SAAS,CAAC,CAAC;EACX,QAAQ,IAAI,CAAC,KAAK,IAAI,EAAE;EACxB,YAAYG,SAAO,CAAC,KAAK,EAAE,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;EAC3D,SAAS;EACT,QAAQ,IAAI,CAAC,KAAK,IAAI,EAAE;EACxB,YAAYA,SAAO,CAAC,KAAK,EAAE,OAAO,EAAE,GAAG,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;EAC5D,SAAS;EACT,QAAQ,OAAO,OAAO,CAAC;EACvB,KAAK;EACL,CAAC,CAAC;AACF,EACA,SAASA,SAAO,CAAC,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,EAAE;EACzD,IAAI,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;EAC5B,IAAI,IAAI,SAAS,GAAGL,aAAc,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;EAChD,IAAI,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE;EAC7C,QAAQ,OAAO,CAAC,CAAC,IAAI,KAAK,iBAAiB,CAAC,OAAO,EAAE,OAAO,EAAE,SAAS,GAAG,MAAM,GAAG,QAAQ,CAAC,CAAC;EAC7F,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;EACV,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC;EACrD,IAAI,IAAI,SAAS,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;EACrD,IAAI,IAAI,SAAS,GAAG,SAAS,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAC1C,IAAI,IAAI,IAAI,GAAG,SAAS,GAAGJ,QAAM,CAAC,KAAK,EAAE,OAAO,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC;EAChE,IAAI,IAAI,KAAK,GAAG,IAAI,GAAGO,OAAK,CAAC;EAC7B,IAAI,IAAI,MAAM,GAAG,EAAE,GAAG,IAAI,GAAGD,QAAM,GAAG,GAAG,GAAG,OAAO,CAAC;EACpD,IAAI,IAAI,MAAM,GAAG,CAAC,SAAS,GAAG,YAAY;EAC1C,QAAQ,SAAS,KAAK,KAAK,GAAG,SAAS;EACvC,YAAY,SAAS,KAAK,KAAK,GAAG,SAAS,GAAG,YAAY,CAAC;EAC3D,IAAI,IAAI,MAAM,GAAG,MAAM,GAAG,GAAG,GAAG,IAAI,GAAG,IAAI,GAAG,MAAM,GAAG,IAAI,GAAG,KAAK;EACnE,SAAS,SAAS,IAAI,SAAS,KAAK,KAAK,GAAG,IAAI,IAAI,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,CAAC,GAAG,GAAG,CAAC;EAChG,IAAI,MAAM,CAAC,EAAE,CAAC,IAAI,CAAC;EACnB,QAAQ,MAAM,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE;EACjC,QAAQ,MAAM,EAAE,SAAS,GAAG,MAAM,GAAG,aAAa,GAAG,MAAM,GAAG,OAAO,GAAG,MAAM,GAAG,GAAG;EACpF,KAAK,CAAC,CAAC;EACP,CAAC;;ECjED,IAAI,SAAS,GAAG,EAAE,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAEL,aAAM;EAClE,IAAI,SAAS,EAAE,SAAS,EAAE,IAAI,EAAEO,MAAI,EAAE,MAAM,EAAEE,aAAM,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC;AACzE,EAAO,SAAS,gBAAgB,CAAC,OAAO,EAAE,EAAE,EAAE;EAC9C,IAAI,KAAK,IAAI,CAAC,IAAI,SAAS,EAAE;EAC7B,QAAQ,IAAI,SAAS,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE;EACvC,YAAY,EAAE,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;EAC7B,SAAS;EACT,KAAK;EACL,CAAC;;ECHM,IAAI,KAAK,GAAG,QAAQ,CAAC;AAC5B,EAAO,IAAI,KAAK,GAAG,QAAQ,CAAC;AAC5B,EAAO,IAAI,MAAM,GAAG,SAAS,CAAC;AAC9B,EAAO,IAAI,gBAAgB,GAAG,oBAAoB,CAAC;AACnD,EAAO,SAAS,kBAAkB,CAAC,KAAK,EAAE,OAAO,EAAE;EACnD,IAAI,IAAI,QAAQ,GAAG,EAAE,CAAC;EACtB,IAAI,IAAI,eAAe,GAAG,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC;EACjD,IAAI,IAAI,OAAO,GAAG,UAAU,MAAM,EAAE;EACpC,QAAQ,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;EAC7C,YAAY,OAAO,UAAU,CAAC;EAC9B,SAAS;EACT,QAAQ,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;EACrC,QAAQ,IAAI,GAAG,GAAG,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;EAC/C;EACA;EACA;EACA;EACA,QAAQ,KAAK,IAAI7D,MAAG,IAAI,GAAG,EAAE;EAC7B;EACA;EACA,YAAY,IAAI,CAACA,MAAG,KAAK,WAAW,IAAI,MAAM,CAAC,MAAM,MAAMA,MAAG,KAAK,QAAQ,IAAI,MAAM,CAAC,SAAS,CAAC,EAAE;EAClG,gBAAgB,SAAS;EACzB,aAAa;EACb,YAAY,IAAIA,MAAG,KAAK,MAAM,EAAE;EAChC,gBAAgB,MAAM,CAACA,MAAG,CAAC,GAAGH,QAAgB,CAAC,EAAE,EAAE,GAAG,CAACG,MAAG,CAAC,EAAE,MAAM,CAACA,MAAG,CAAC,CAAC,CAAC;EAC1E,aAAa;EACb,YAAY,IAAI,MAAM,CAACA,MAAG,CAAC,KAAK,SAAS,IAAI,MAAM,CAACA,MAAG,CAAC,KAAK,IAAI,EAAE;EACnE,gBAAgB,MAAM,CAACA,MAAG,CAAC,GAAG,GAAG,CAACA,MAAG,CAAC,IAAI,MAAM,CAACA,MAAG,CAAC,CAAC;EACtD,aAAa;EACb,SAAS;EACT,QAAQ,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;EACjC,QAAQ,IAAI,OAAO,GAAG,QAAQ,CAAC,MAAM,CAAC,GAAGH,QAAgB,CAAC,EAAE,EAAE,MAAM,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,QAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,aAAa,CAAC,MAAM,CAAC,EAAE,EAAE,OAAO,CAAC,GAAG,MAAM,CAAC,EAAE,EAAE,CAAC,CAAC;EACrK,QAAQ,gBAAgB,CAAC,OAAO,EAAE,UAAU,UAAU,EAAE;EACxD,YAAY,IAAI,UAAU,CAAC,KAAK,EAAE;EAClC,gBAAgB,UAAU,CAAC,KAAK,CAAC,KAAK,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC;EACzD,aAAa;EACb,SAAS,CAAC,CAAC;EACX,KAAK,CAAC;EACN,IAAI,KAAK,IAAI,MAAM,IAAI,OAAO,EAAE;EAChC,QAAQ,OAAO,CAAC,MAAM,CAAC,CAAC;EACxB,KAAK;EACL,IAAI,OAAO,QAAQ,CAAC;EACpB,CAAC;AACD,EAAO,SAAS,4BAA4B,CAAC,KAAK,EAAEyD,UAAO,EAAE;EAC7D,IAAI,gBAAgB,CAAC,KAAK,EAAE,UAAU,OAAO,EAAE,WAAW,EAAE;EAC5D,QAAQ,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;EAChC,QAAQ,IAAI,UAAU,GAAG,WAAW,CAAC,UAAU,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;EAChE,QAAQA,UAAO,CAAC,IAAI,CAAC,KAAK,CAACA,UAAO,EAAE,WAAW,CAAC,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC,CAAC;EACzE,QAAQ,gBAAgB,CAAC,OAAO,EAAE,UAAU,UAAU,EAAE;EACxD,YAAY,IAAI,UAAU,CAAC,OAAO,EAAE;EACpC,gBAAgBA,UAAO,GAAG,UAAU,CAAC,OAAO,CAAC,KAAK,EAAE,OAAO,EAAEA,UAAO,CAAC,CAAC;EACtE,aAAa;EACb,YAAY,IAAI,UAAU,CAAC,UAAU,EAAE;EACvC,gBAAgB,UAAU,GAAG,UAAU,CAAC,UAAU,CAAC,KAAK,EAAE,OAAO,EAAE,UAAU,CAAC,CAAC;EAC/E,aAAa;EACb,SAAS,CAAC,CAAC;EACX,QAAQA,UAAO,CAAC,IAAI,CAAC;EACrB,YAAY,IAAI,EAAE,IAAI,GAAG,MAAM;EAC/B,YAAY,EAAE,EAAE,CAAC;EACjB,oBAAoB,MAAM,EAAE,EAAE,MAAM,EAAE,IAAI,GAAG,KAAK,EAAE;EACpD,oBAAoB,MAAM,EAAE,SAAS,GAAGhE,CAAW,CAAC,OAAO,CAAC,IAAI,GAAG,KAAK,CAAC,GAAG,IAAI,GAAG,UAAU,GAAG,GAAG;EACnG,iBAAiB,CAAC;EAClB,SAAS,CAAC,CAAC;EACX,KAAK,CAAC,CAAC;EACP,IAAI,IAAI,UAAU,GAAG,aAAa,CAAC,KAAK,CAAC,CAAC;EAC1C,IAAI,IAAIgE,UAAO,CAAC,MAAM,IAAI,UAAU,EAAE;EACtC,QAAQ,IAAI,MAAM,GAAGhE,CAAW,CAAC,UAAU,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;EAC7D,QAAQgE,UAAO,CAAC,OAAO,CAAC;EACxB,YAAY,IAAI,EAAE,OAAO;EACzB,YAAY,KAAK,EAAE,EAAE;EACrB,YAAY,EAAE,EAAE,CAAC;EACjB,oBAAoB,MAAM,EAAE,aAAa,CAAC,WAAW,EAAE,OAAO,CAAC;EAC/D,oBAAoB,MAAM,EAAE,iCAAiC,GAAG,MAAM,GAAG,SAAS;EAClF,iBAAiB,CAAC;EAClB,SAAS,CAAC,CAAC;EACX,KAAK;EACL,IAAI,OAAOA,UAAO,CAAC;EACnB,CAAC;AACD,EAAO,SAAS,uBAAuB,CAAC,KAAK,EAAEA,UAAO,EAAE;EACxD,IAAI,IAAI,SAAS,GAAG,KAAK,CAAC;EAC1B,IAAI,gBAAgB,CAAC,KAAK,EAAE,UAAU,OAAO,EAAE,WAAW,EAAE;EAC5D,QAAQ,IAAI,WAAW,CAAC,eAAe,EAAE;EACzC,YAAYA,UAAO,GAAG,WAAW,CAAC,eAAe,CAAC,KAAK,EAAE,OAAO,EAAEA,UAAO,CAAC,CAAC;EAC3E,SAAS;EACT,QAAQ,gBAAgB,CAAC,OAAO,EAAE,UAAU,UAAU,EAAE;EACxD,YAAY,IAAI,UAAU,CAAC,eAAe,EAAE;EAC5C,gBAAgBA,UAAO,GAAG,UAAU,CAAC,eAAe,CAAC,KAAK,EAAE,OAAO,EAAEA,UAAO,CAAC,CAAC;EAC9E,aAAa;EACb,SAAS,CAAC,CAAC;EACX,QAAQ,SAAS,GAAG,IAAI,CAAC;EACzB,KAAK,CAAC,CAAC;EACP,IAAI,IAAI,SAAS,EAAE;EACnB,QAAQ,IAAI,OAAO,GAAGA,UAAO,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,IAAI,KAAK,MAAM,CAAC,EAAE,CAAC,CAAC;EACjF,QAAQ,IAAI,EAAE,OAAO,CAAC,MAAM,CAAC,EAAE;EAC/B,YAAYA,UAAO,CAAC,OAAO,CAAC;EAC5B,gBAAgB,IAAI,EAAE,MAAM;EAC5B,gBAAgB,KAAK,EAAE,EAAE;EACzB,gBAAgB,EAAE,EAAE,CAAC,EAAE,MAAM,EAAE,WAAW,EAAE,MAAM,EAAE,mCAAmC,EAAE,CAAC;EAC1F,aAAa,CAAC,CAAC;EACf,SAAS;EACT,KAAK;EACL,IAAI,OAAOA,UAAO,CAAC;EACnB,CAAC;AACD,EAAO,SAAS,yBAAyB,CAAC,KAAK,EAAE,IAAI,EAAE;EACvD,IAAI,gBAAgB,CAAC,KAAK,EAAE,UAAU,OAAO,EAAE;EAC/C,QAAQ,IAAIQ,WAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC,IAAI,KAAK,OAAO,CAAC,IAAI,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC;EAC7F,QAAQ,IAAI,CAACA,WAAQ,CAAC,MAAM,EAAE;EAC9B,YAAY,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,OAAO,CAAC,IAAI,GAAG,KAAK,EAAE,CAAC,CAAC;EACtD,SAAS;EACT,KAAK,CAAC,CAAC;EACP,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;AACD,EAAO,SAAS,0BAA0B,CAAC,KAAK,EAAE,KAAK,EAAE;EACzD,IAAI,gBAAgB,CAAC,KAAK,EAAE,UAAU,OAAO,EAAE,WAAW,EAAE;EAC5D,QAAQ,KAAK,GAAG,WAAW,CAAC,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC,KAAK,EAAE,OAAO,EAAE,KAAK,CAAC,GAAG,KAAK,CAAC;EACrF,QAAQ,gBAAgB,CAAC,OAAO,EAAE,UAAU,UAAU,EAAE;EACxD,YAAY,IAAI,UAAU,CAAC,KAAK,EAAE;EAClC,gBAAgB,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC,KAAK,EAAE,OAAO,EAAE,KAAK,CAAC,CAAC;EAChE,aAAa;EACb,SAAS,CAAC,CAAC;EACX,KAAK,CAAC,CAAC;EACP,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;AACD,EAAO,SAAS,2BAA2B,CAAC,KAAK,EAAE,KAAK,EAAE;EAC1D,IAAI,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,KAAK,EAAE;EAC5C,QAAQ,IAAI,WAAW,CAAC,KAAK,CAAC,EAAE;EAChC,YAAY,KAAK,GAAG,0BAA0B,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;EAC7D,SAAS;EACT,KAAK,CAAC,CAAC;EACP,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;AACD,EAAO,SAAS,kBAAkB,CAAC,KAAK,EAAE,UAAU,EAAE,MAAM,EAAE;EAC9D,IAAI,IAAI,MAAM,GAAG,EAAE,CAAC;EACpB,IAAI,SAAS,IAAI,CAAC,IAAI,EAAE;EACxB,QAAQ,IAAI,KAAK,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;EAClC,QAAQ,IAAI,OAAO,GAAG,KAAK,CAAC,qBAAqB,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;EAC/D,QAAQ,IAAI,KAAK,GAAGxE,CAAW,CAAC,KAAK,GAAG,KAAK,CAAC,CAAC;EAC/C,QAAQ,IAAI,OAAO,CAAC,QAAQ,EAAE;EAC9B,YAAY,IAAI,KAAK,GAAG,MAAM,IAAI,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC;EAC3D,YAAY,IAAI,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;EAClD,YAAY,IAAI,KAAK,CAAC,MAAM,EAAE;EAC9B,gBAAgB,MAAM,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;EAC/C,aAAa;EACb,iBAAiB;EACjB,gBAAgB,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;EACtC,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,OAAO,CAAC,KAAK,KAAK,MAAM,EAAE;EACtC,YAAY,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;EAC/B,SAAS;EACT,QAAQ,OAAO,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,SAAS,IAAI,GAAG,GAAG,KAAK,GAAG,SAAS,CAAC;EAC3E,aAAa,OAAO,CAAC,OAAO,KAAK,QAAQ,GAAG,GAAG,GAAG,IAAI,GAAGA,CAAW,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,GAAG,CAAC,CAAC;EAC7F,KAAK;EACL,IAAI,IAAI,YAAY,GAAG,WAAW,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;EACrD,IAAI,OAAO,CAAC,MAAM,CAAC,MAAM;EACzB,UAAU,IAAI,GAAG,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,cAAc,GAAG,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,OAAO;EACtG,UAAU,EAAE,KAAK,GAAG,GAAG,YAAY,GAAG,GAAG,CAAC,CAAC;EAC3C,CAAC;EACD;EACA;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,oBAAoB,CAAC,SAAS,EAAE;EAChD,IAAI,OAAO,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;EAC3D,CAAC;AACD,EAAO,SAAS,oBAAoB,CAAC,KAAK,EAAE,SAAS,EAAE;EACvD,IAAI,IAAI,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,gBAAgB,EAAE,EAAE,CAAC,CAAC,CAAC;EAC/E,IAAI,IAAI,IAAI,GAAG,OAAO,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;EAC5C,IAAI,IAAI,OAAO,GAAG,KAAK,CAAC,SAAS,CAAC,SAAS,IAAI,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;EAC/E,IAAI,IAAI,OAAO,EAAE;EACjB,QAAQ,IAAI,CAAC,yFAAyF,CAAC,CAAC;EACxG,KAAK;EACL,SAAS;EACT,QAAQ,OAAO,GAAG,KAAK,CAAC,qBAAqB,CAAC,IAAI,EAAE,SAAS,CAAC,SAAS,CAAC,CAAC;EACzE,QAAQ,IAAI,CAAC,SAAS,CAAC,QAAQ,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE;EACrD,YAAY,SAAS,CAAC,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;EACvD,YAAY,IAAI,OAAO,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;EAC5C,gBAAgB,IAAI,CAAC,sFAAsF;EAC3G,qBAAqB,mBAAmB,GAAGA,CAAW,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC;EAChF,aAAa;EACb,SAAS;EACT,QAAQ,OAAO;EACf,YAAY,MAAM,EAAE,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,WAAW;EACtD,iBAAiB,GAAG,GAAGA,CAAW,CAAC,IAAI,GAAG,KAAK,CAAC,GAAG,IAAI,GAAGA,CAAW,CAAC,SAAS,CAAC,QAAQ,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC;EACzG,gBAAgBA,CAAW,CAAC,SAAS,CAAC,KAAK,IAAI,IAAI,CAAC;EACpD,iBAAiB,OAAO,CAAC,OAAO,KAAK,QAAQ,GAAG,GAAG,GAAG,IAAI,GAAGA,CAAW,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,GAAG,CAAC;EAChG,SAAS,CAAC;EACV,KAAK;EACL,IAAI,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,CAAC;EAC9B,CAAC;EACD;EACA,SAAS,gBAAgB,CAAC,KAAK,EAAE,EAAE,EAAE;EACrC,IAAI,IAAI,UAAU,GAAG,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC;EAC/C,IAAI,KAAK,IAAI,MAAM,IAAI,UAAU,EAAE;EACnC,QAAQ,IAAI,UAAU,CAAC,cAAc,CAAC,MAAM,CAAC,EAAE;EAC/C,YAAY,IAAI,GAAG,GAAG,UAAU,CAAC,MAAM,CAAC,CAAC;EACzC,YAAY,EAAE,CAAC,GAAG,EAAE,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;EACxC,SAAS;EACT,KAAK;EACL,CAAC;EACD,SAAS,QAAQ,CAAC,IAAI,EAAE;EACxB,IAAI,QAAQ,IAAI;EAChB,QAAQ,KAAK,QAAQ;EACrB,YAAY,OAAOyE,MAAc,CAAC;EAClC,QAAQ,KAAK,OAAO;EACpB,YAAY,OAAOC,KAAa,CAAC;EACjC,QAAQ,KAAK,UAAU;EACvB,YAAY,OAAOC,QAAgB,CAAC;EACpC,KAAK;EACL,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;EACD,SAAS,aAAa,CAAC,KAAK,EAAE;EAC9B,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;EAC9B,IAAI,OAAO,MAAM,EAAE;EACnB,QAAQ,IAAI,YAAY,CAAC,MAAM,CAAC,EAAE;EAClC,YAAY,MAAM;EAClB,SAAS;EACT,QAAQ,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;EAC/B,KAAK;EACL,IAAI,OAAO,MAAM,CAAC;EAClB,CAAC;AACD,EAAO,SAAS,QAAQ,CAAC,KAAK,EAAE;EAChC,IAAI,IAAI,IAAI,GAAG3E,CAAW,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;EACvC,IAAI,IAAI,KAAK,GAAG,aAAa,CAAC,KAAK,CAAC,CAAC;EACrC,IAAI,IAAI,KAAK,EAAE;EACf,QAAQ,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,GAAG,YAAY,GAAG,mBAAmB,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,OAAO,CAAC,GAAG,GAAG,GAAG,EAAE;EAC/G,eAAe,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,YAAY,GAAG,mBAAmB,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,OAAO,CAAC,GAAG,GAAG,GAAG,EAAE,CAAC,CAAC;EACrH,KAAK;EACL,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;AACD,EAAO,SAAS,mBAAmB,CAAC,KAAK,EAAE;EAC3C,IAAI,IAAI,UAAU,GAAG,KAAK,CAAC;EAC3B,IAAI,gBAAgB,CAAC,KAAK,EAAE,UAAU,OAAO,EAAE;EAC/C,QAAQ,UAAU,GAAG,UAAU,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,IAAI,EAAE,EAAE,OAAO,IAAI,CAAC,KAAK,KAAK,YAAY,CAAC,EAAE,CAAC,CAAC;EACjH,KAAK,CAAC,CAAC;EACP,IAAI,OAAO,UAAU,CAAC;EACtB,CAAC;AACD,EAAO,SAAS,iBAAiB,CAAC,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE;EAC3D,IAAI,IAAI,OAAO,GAAG,OAAO,CAAC,YAAY,KAAK,OAAO,CAAC,YAAY,GAAG,EAAE,CAAC,CAAC;EACtE,IAAI,IAAI,OAAO,CAAC,OAAO,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,EAAE;EACrD,QAAQ,OAAO,OAAO,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,CAAC;EACvC,KAAK;EACL,IAAI,OAAO,CAAC,OAAO,CAAC,GAAG,OAAO,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;EAC9C,IAAI,IAAI,QAAQ,GAAG,OAAO,CAAC,OAAO,CAAC,IAAI,GAAG,GAAG,IAAI,KAAK,KAAK,QAAQ,GAAG,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;EAC1G,IAAI,IAAI,IAAI,GAAG,QAAQ,CAAC;EACxB,IAAI,IAAI,OAAO,GAAG,CAAC,CAAC;EACpB,IAAI,OAAO,OAAO,CAAC,IAAI,CAAC,EAAE;EAC1B,QAAQ,IAAI,GAAG,QAAQ,GAAG,GAAG,GAAG,OAAO,EAAE,CAAC;EAC1C,KAAK;EACL,IAAI,QAAQ,OAAO,CAAC,IAAI,CAAC,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC,GAAG,IAAI,EAAE;EAC5D,CAAC;AACD,EAAO,SAAS,qBAAqB,CAAC,OAAO,EAAE;EAC/C,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC;EACjB,IAAI,IAAI,EAAE,GAAG,IAAI,CAAC;EAClB,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC;EACjB,IAAI,IAAI,EAAE,GAAG,IAAI,CAAC;EAClB,IAAI,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,CAAC,EAAE;EAC5C,QAAQ,IAAI,CAAC,CAAC,OAAO,KAAK,CAAC,EAAE;EAC7B,YAAY,CAAC,GAAG,CAAC,CAAC;EAClB,YAAY,EAAE,GAAG,CAAC,CAAC;EACnB,SAAS;EACT,aAAa,IAAI,CAAC,CAAC,OAAO,KAAK,CAAC,EAAE;EAClC,YAAY,CAAC,GAAG,CAAC,CAAC;EAClB,YAAY,EAAE,GAAG,CAAC,CAAC;EACnB,SAAS;EACT,KAAK,CAAC,CAAC;EACP,IAAI,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC;EAC1C,CAAC;;EClRM,SAAS,oBAAoB,CAAC,SAAS,EAAE;EAChD,IAAI,OAAO,SAAS,IAAI,SAAS,CAAC,WAAW,CAAC,CAAC;EAC/C,CAAC;AACD,EAAO,SAAS,qBAAqB,CAAC,SAAS,EAAE;EACjD,IAAI,OAAO,SAAS,IAAI,CAAC,CAAC,SAAS,CAAC,KAAK,IAAI,SAAS,CAAC,KAAK,KAAK,SAAS,CAAC;EAC3E,CAAC;AACD,EAAO,SAAS,kBAAkB,CAAC,SAAS,EAAE;EAC9C,IAAI,OAAO,SAAS,IAAI,CAAC,CAAC,SAAS,CAAC,KAAK,IAAI,SAAS,CAAC,EAAE,KAAK,SAAS,CAAC;EACxE,CAAC;AACD,EAAO,SAAS,mBAAmB,CAAC,SAAS,EAAE;EAC/C,IAAI,OAAO,SAAS,IAAI,CAAC,CAAC,SAAS,CAAC,KAAK,IAAI,SAAS,CAAC,GAAG,KAAK,SAAS,CAAC;EACzE,CAAC;AACD,EAAO,SAAS,kBAAkB,CAAC,SAAS,EAAE;EAC9C,IAAI,OAAO,SAAS,IAAI,CAAC,CAAC,SAAS,CAAC,KAAK,IAAI,SAAS,CAAC,EAAE,KAAK,SAAS,CAAC;EACxE,CAAC;AACD,EAAO,SAAS,mBAAmB,CAAC,SAAS,EAAE;EAC/C,IAAI,OAAO,SAAS,IAAI,CAAC,CAAC,SAAS,CAAC,KAAK,IAAI,SAAS,CAAC,GAAG,KAAK,SAAS,CAAC;EACzE,CAAC;AACD,EAAO,SAAS,qBAAqB,CAAC,SAAS,EAAE;EACjD,IAAI,IAAI,SAAS,IAAI,SAAS,CAAC,KAAK,EAAE;EACtC,QAAQ,IAAI,OAAO,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,SAAS,CAAC,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE;EACtE,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,KAAK;EACL,IAAI,OAAO,KAAK,CAAC;EACjB,CAAC;AACD,EAAO,SAAS,qBAAqB,CAAC,SAAS,EAAE;EACjD,IAAI,OAAO,SAAS,IAAI,CAAC,CAAC,SAAS,CAAC,KAAK,KAAK,OAAO,CAAC,SAAS,CAAC,KAAK,CAAC;EACtE,QAAQ,OAAO,CAAC,SAAS,CAAC,EAAE,CAAC;EAC7B,KAAK,CAAC;EACN,CAAC;AACD,EAAO,SAAS,gBAAgB,CAAC,SAAS,EAAE;EAC5C,IAAI,OAAO,qBAAqB,CAAC,SAAS,CAAC,IAAI,qBAAqB,CAAC,SAAS,CAAC,IAAI,qBAAqB,CAAC,SAAS,CAAC,IAAI,kBAAkB,CAAC,SAAS,CAAC,IAAI,kBAAkB,CAAC,SAAS,CAAC,IAAI,mBAAmB,CAAC,SAAS,CAAC,IAAI,mBAAmB,CAAC,SAAS,CAAC,CAAC;EAC1P,CAAC;EACD;EACA;EACA;EACA;AACA,EAAO,SAAS,UAAU,CAAC,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE;EAClD,IAAI,OAAO,WAAW,CAAC,QAAQ,EAAE,UAAU,SAAS,EAAE;EACtD,QAAQ,IAAI,QAAQ,CAAC,SAAS,CAAC,EAAE;EACjC,YAAY,OAAO,SAAS,CAAC;EAC7B,SAAS;EACT,aAAa,IAAI,oBAAoB,CAAC,SAAS,CAAC,EAAE;EAClD,YAAY,OAAO,kBAAkB,CAAC,KAAK,EAAE,SAAS,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;EACxE,SAAS;EACT,aAAa;EACb,YAAY,OAAO,qBAAqB,CAAC,SAAS,CAAC,CAAC;EACpD,SAAS;EACT,KAAK,CAAC,CAAC;EACP,CAAC;EACD;AACA,EAAO,SAAS,qBAAqB,CAAC,SAAS,EAAE,UAAU,EAAE;EAC7D,IAAI,IAAI,UAAU,KAAK,KAAK,CAAC,EAAE,EAAE,UAAU,GAAG,IAAI,CAAC,EAAE;EACrD,IAAI,IAAI4E,YAAS,GAAG,SAAS,CAAC,QAAQ;EACtC;EACA;EACA;EACA,SAAS,OAAO,GAAGC,SAAiB,CAAC,SAAS,CAAC,QAAQ,EAAE,SAAS,CAAC,KAAK,CAAC,GAAG,GAAG;EAC/E,QAAQ,OAAO,CAAC,SAAS,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;EAC9C,IAAI,IAAI,qBAAqB,CAAC,SAAS,CAAC,EAAE;EAC1C,QAAQ,OAAOD,YAAS,GAAG,KAAK,GAAG,SAAS,CAAC,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC,QAAQ,CAAC,CAAC;EAClF,KAAK;EACL,SAAS,IAAI,kBAAkB,CAAC,SAAS,CAAC,EAAE;EAC5C,QAAQ,IAAI,KAAK,GAAG,SAAS,CAAC,EAAE,CAAC;EACjC,QAAQ,OAAOA,YAAS,GAAG,GAAG,GAAG,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC,QAAQ,CAAC,CAAC;EACtE,KAAK;EACL,SAAS,IAAI,kBAAkB,CAAC,SAAS,CAAC,EAAE;EAC5C,QAAQ,IAAI,KAAK,GAAG,SAAS,CAAC,EAAE,CAAC;EACjC,QAAQ,OAAOA,YAAS,GAAG,GAAG,GAAG,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC,QAAQ,CAAC,CAAC;EACtE,KAAK;EACL,SAAS,IAAI,mBAAmB,CAAC,SAAS,CAAC,EAAE;EAC7C,QAAQ,IAAI,KAAK,GAAG,SAAS,CAAC,GAAG,CAAC;EAClC,QAAQ,OAAOA,YAAS,GAAG,IAAI,GAAG,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC,QAAQ,CAAC,CAAC;EACvE,KAAK;EACL,SAAS,IAAI,mBAAmB,CAAC,SAAS,CAAC,EAAE;EAC7C,QAAQ,IAAI,KAAK,GAAG,SAAS,CAAC,GAAG,CAAC;EAClC,QAAQ,OAAOA,YAAS,GAAG,IAAI,GAAG,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC,QAAQ,CAAC,CAAC;EACvE,KAAK;EACL,SAAS,IAAI,qBAAqB,CAAC,SAAS,CAAC,EAAE;EAC/C;EACA,QAAQ,IAAI,KAAK,GAAG,SAAS,CAAC,KAAK,IAAI,SAAS,CAAC,IAAI,CAAC,CAAC;EACvD,QAAQ,OAAO,WAAW;EAC1B,YAAY,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,SAAS,CAAC,CAAC,EAAE,SAAS,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC;EAC1F,YAAY,KAAK,GAAGA,YAAS,GAAG,UAAU,CAAC;EAC3C,KAAK;EACL,SAAS,IAAI,qBAAqB,CAAC,SAAS,CAAC,EAAE;EAC/C,QAAQ,IAAI,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;EACvC,QAAQ,IAAI,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;EACvC,QAAQ,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,IAAI,IAAI,UAAU,EAAE;EAC5D,YAAY,OAAO,UAAU,GAAGA,YAAS,GAAG,KAAK;EACjD,gBAAgB,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC,QAAQ,CAAC,GAAG,IAAI;EAC3D,gBAAgB,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC;EAC5D,SAAS;EACT,QAAQ,IAAI,KAAK,GAAG,EAAE,CAAC;EACvB,QAAQ,IAAI,KAAK,KAAK,IAAI,EAAE;EAC5B,YAAY,KAAK,CAAC,IAAI,CAACA,YAAS,GAAG,MAAM,GAAG,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC;EAClF,SAAS;EACT,QAAQ,IAAI,KAAK,KAAK,IAAI,EAAE;EAC5B,YAAY,KAAK,CAAC,IAAI,CAACA,YAAS,GAAG,MAAM,GAAG,SAAS,CAAC,KAAK,EAAE,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC;EAClF,SAAS;EACT,QAAQ,OAAO,KAAK,CAAC,MAAM,GAAG,CAAC,GAAG,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC;EAC9D,KAAK;EACL;EACA,IAAI,MAAM,IAAI,KAAK,CAAC,2BAA2B,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC;EAC7E,CAAC;EACD,SAAS,SAAS,CAAC,CAAC,EAAE,QAAQ,EAAE;EAChC,IAAI,IAAI,UAAU,CAAC,CAAC,CAAC,EAAE;EACvB,QAAQ,IAAI,IAAI,GAAG,YAAY,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;EACzC,QAAQ,OAAO,OAAO,GAAG,IAAI,GAAG,GAAG,CAAC;EACpC,KAAK;EACL,IAAI,IAAI,qBAAqB,CAAC,QAAQ,CAAC,EAAE;EACzC,QAAQ,IAAI,QAAQ,GAAG,EAAE,CAAC;EAC1B,QAAQ,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;EAC/B,QAAQ,IAAI,IAAI,GAAG,YAAY,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;EAChD,QAAQ,OAAO,OAAO,GAAG,IAAI,GAAG,GAAG,CAAC;EACpC,KAAK;EACL,SAAS,IAAI,mBAAmB,CAAC,QAAQ,CAAC,EAAE;EAC5C,QAAQ,OAAO,SAAS,CAAC,CAAC,EAAE,gBAAgB,CAAC,QAAQ,CAAC,CAAC,CAAC;EACxD,KAAK;EACL,IAAI,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;EAC7B,CAAC;AACD,EAAO,SAAS,kBAAkB,CAAC,CAAC,EAAE;EACtC,IAAI,IAAI,gBAAgB,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE;EAC3C,QAAQ,OAAOrE,QAAgB,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,QAAQ,EAAE,iBAAiB,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;EACpF,KAAK;EACL,IAAI,OAAO,CAAC,CAAC;EACb,CAAC;;ECpIM,SAAS,QAAQ,CAAC,CAAC,EAAE;EAC5B,IAAI,OAAO,CAAC,CAAC,QAAQ,CAAC,KAAK,SAAS,CAAC;EACrC,CAAC;AACD,EAAO,SAAS,QAAQ,CAAC,CAAC,EAAE;EAC5B,IAAI,OAAO,CAAC,CAAC,QAAQ,CAAC,KAAK,SAAS,CAAC;EACrC,CAAC;AACD,EAAO,SAAS,QAAQ,CAAC,CAAC,EAAE;EAC5B,IAAI,OAAO,CAAC,CAAC,QAAQ,CAAC,KAAK,SAAS,CAAC;EACrC,CAAC;AACD,EAAO,SAAS,WAAW,CAAC,CAAC,EAAE;EAC/B,IAAI,OAAO,CAAC,CAAC,WAAW,CAAC,KAAK,SAAS,CAAC;EACxC,CAAC;AACD,EAAO,SAAS,KAAK,CAAC,CAAC,EAAE;EACzB,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;EACtB,CAAC;AACD,EAAO,SAASuE,YAAU,CAAC,CAAC,EAAE;EAC9B,IAAI,OAAO,CAAC,CAAC,UAAU,CAAC,KAAK,SAAS,CAAC;EACvC,CAAC;AACD,EAAO,SAASC,aAAW,CAAC,CAAC,EAAE;EAC/B,IAAI,OAAO,CAAC,CAAC,WAAW,CAAC,KAAK,SAAS,CAAC;EACxC,CAAC;AACD,EAAO,SAAS,OAAO,CAAC,CAAC,EAAE;EAC3B,IAAI,OAAO,CAAC,CAAC,OAAO,CAAC,KAAK,SAAS,CAAC;EACpC,CAAC;AACD,EAAO,SAAS,kBAAkB,CAAC,SAAS,EAAE;EAC9C,IAAI,OAAO,SAAS,CAAC,GAAG,CAAC,UAAU,CAAC,EAAE;EACtC,QAAQ,IAAI,QAAQ,CAAC,CAAC,CAAC,EAAE;EACzB,YAAY,OAAO;EACnB,gBAAgB,MAAM,EAAE,uBAAuB,CAAC,CAAC,CAAC,MAAM,EAAE,kBAAkB,CAAC;EAC7E,aAAa,CAAC;EACd,SAAS;EACT,QAAQ,OAAO,CAAC,CAAC;EACjB,KAAK,CAAC,CAAC;EACP,CAAC;;;;;;;;;;;;;;EC5BD,SAAS,YAAY,CAAC,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAE;EACxD,IAAI,IAAI,gBAAgB,CAAC,QAAQ,EAAE,OAAO,CAAC,EAAE;EAC7C;EACA,QAAQ,IAAI,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC;EACnG,QAAQ,IAAI,UAAU,GAAG,OAAO,CAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,OAAO,GAAG,CAAC,CAAC;EAC/D,QAAQ,IAAI,QAAQ,GAAG,OAAO,CAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC;EAC9E,QAAQ,OAAO;EACf,YAAY,SAAS,EAAE,OAAO,CAAC,QAAQ,EAAE,EAAE,SAAS,EAAE,OAAO,EAAE,CAAC;EAChE,YAAY,OAAO,EAAE,mBAAmB,CAAC,UAAU,EAAE,QAAQ,EAAE,KAAK,CAAC,MAAM,EAAE,MAAM,CAAC;EACpF,SAAS,CAAC;EACV,KAAK;EACL,IAAI,OAAO,EAAE,CAAC;EACd,CAAC;EACD,SAAS,MAAM,CAAC,GAAG,EAAE,KAAK,EAAE;EAC5B,IAAI,OAAO,WAAW,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,KAAK,CAAC;EAC1C,CAAC;EACD,SAAS,mBAAmB,CAAC,KAAK,EAAE,GAAG,EAAE;EACzC,IAAI,OAAO;EACX,QAAQ,MAAM,EAAE,KAAK,CAAC,OAAO,CAAC,GAAG,GAAG,OAAO,CAAC;EAC5C,QAAQ,YAAY,EAAE,KAAK,CAAC,OAAO,CAAC,GAAG,GAAG,SAAS,CAAC;EACpD,KAAK,CAAC;EACN,CAAC;EACD,SAAS,cAAc,CAAC,CAAC,EAAE;EAC3B,IAAI,OAAO,IAAI,IAAI,CAAC,CAAC;EACrB,CAAC;EACD,SAAS,kBAAkB,CAAC,CAAC,EAAE,KAAK,EAAE;EACtC,IAAI,IAAI,EAAE,CAAC;EACX,IAAI,IAAI,cAAc,CAAC,CAAC,CAAC,EAAE;EAC3B,QAAQ,EAAE,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,GAAG,MAAM,CAAC,CAAC;EACnC,KAAK;EACL,SAAS;EACT,QAAQ,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC,EAAE,EAAE,CAAC,EAAE,OAAO,CAAC,CAAC,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;EAChE,KAAK;EACL,IAAI,IAAI,GAAG,GAAG,YAAY,CAAC,CAAC,CAAC,GAAG,EAAE,SAAS,CAAC,IAAI,EAAE,CAAC;EACnD,IAAI,IAAI,GAAG,GAAG,MAAM,CAAC,GAAG,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC;EACnC,IAAI,IAAI,EAAE,GAAG,mBAAmB,CAAC,KAAK,EAAE,GAAG,CAAC,EAAE,MAAM,GAAG,EAAE,CAAC,MAAM,EAAE,YAAY,GAAG,EAAE,CAAC,YAAY,CAAC;EACjG,IAAI,IAAI,YAAY,GAAGxE,QAAgB,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,CAAC,KAAK,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,MAAM,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,EAAE,EAAE,YAAY,GAAG,EAAE,YAAY,EAAE,YAAY,EAAE,GAAG,EAAE,CAAC,CAAC;EACpK,IAAI,OAAO,EAAE,GAAG,EAAE,GAAG,EAAE,YAAY,EAAE,YAAY,EAAE,CAAC;EACpD,CAAC;EACD,IAAI,OAAO,kBAAkB,UAAU,MAAM,EAAE;EAC/C,IAAIkC,SAAiB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;EACvC,IAAI,SAAS,OAAO,CAAC,MAAM,EAAE,IAAI,EAAE;EACnC,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC;EACtD,QAAQ,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC;EAC1B,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,OAAO,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EAC1C,QAAQ,OAAO,IAAI,OAAO,CAAC,IAAI,EAAE,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;EACvD,KAAK,CAAC;EACN,IAAI,OAAO,CAAC,gBAAgB,GAAG,UAAU,MAAM,EAAE,KAAK,EAAE;EACxD,QAAQ,IAAI,IAAI,GAAG,KAAK,CAAC,cAAc,CAAC,UAAU,iBAAiB,EAAE,QAAQ,EAAE,OAAO,EAAE;EACxF,YAAY,IAAI,QAAQ,CAAC,GAAG,EAAE;EAC9B,gBAAgB,IAAI,EAAE,GAAG,kBAAkB,CAAC,QAAQ,EAAE,KAAK,CAAC,EAAE,GAAG,GAAG,EAAE,CAAC,GAAG,EAAE,YAAY,GAAG,EAAE,CAAC,YAAY,CAAC;EAC3G,gBAAgB,iBAAiB,CAAC,GAAG,CAAC,GAAGlC,QAAgB,CAAC,EAAE,EAAE,YAAY,EAAE,iBAAiB,CAAC,GAAG,CAAC,EAAE,YAAY,CAAC,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;EAC1J,aAAa;EACb,YAAY,OAAO,iBAAiB,CAAC;EACrC,SAAS,EAAE,EAAE,CAAC,CAAC;EACf,QAAQ,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,EAAE;EACrC,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,QAAQ,OAAO,IAAI,OAAO,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;EACzC,KAAK,CAAC;EACN;EACA;EACA;EACA;EACA,IAAI,OAAO,CAAC,iBAAiB,GAAG,UAAU,MAAM,EAAE,CAAC,EAAE,KAAK,EAAE;EAC5D,QAAQ,IAAI,EAAE,CAAC;EACf,QAAQ,IAAI,EAAE,GAAG,kBAAkB,CAAC,CAAC,EAAE,KAAK,CAAC,EAAE,GAAG,GAAG,EAAE,CAAC,GAAG,EAAE,YAAY,GAAG,EAAE,CAAC,YAAY,CAAC;EAC5F,QAAQ,OAAO,IAAI,OAAO,CAAC,MAAM,GAAG,EAAE,GAAG,EAAE;EAC3C,YAAY,EAAE,CAAC,GAAG,CAAC,GAAG,YAAY;EAClC,YAAY,EAAE,EAAE,CAAC;EACjB,KAAK,CAAC;EACN,IAAI,OAAO,CAAC,SAAS,CAAC,KAAK,GAAG,UAAU,KAAK,EAAE;EAC/C,QAAQ,IAAI,CAAC,IAAI,GAAGA,QAAgB,CAAC,EAAE,EAAE,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;EAChE,QAAQ,KAAK,CAAC,MAAM,EAAE,CAAC;EACvB,KAAK,CAAC;EACN,IAAI,OAAO,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACnD,QAAQ,IAAI,GAAG,GAAG,EAAE,CAAC;EACrB,QAAQ,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;EAC7C,YAAY,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC;EACjE,SAAS,CAAC,CAAC;EACX,QAAQ,OAAO,GAAG,CAAC;EACnB,KAAK,CAAC;EACN,IAAI,OAAO,CAAC,SAAS,CAAC,eAAe,GAAG,YAAY;EACpD,QAAQ,IAAI,GAAG,GAAG,EAAE,CAAC;EACrB,QAAQ,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;EAC7C,YAAY,GAAG,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC;EAChC,SAAS,CAAC,CAAC;EACX,QAAQ,OAAO,GAAG,CAAC;EACnB,KAAK,CAAC;EACN,IAAI,OAAO,CAAC,SAAS,CAAC,QAAQ,GAAG,YAAY;EAC7C,QAAQ,OAAO,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,UAAU,GAAG,EAAE;EAC1D,YAAY,IAAI,SAAS,GAAG,EAAE,CAAC;EAC/B,YAAY,IAAI,QAAQ,GAAGA,QAAgB,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,CAAC,KAAK,EAAE,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,MAAM,EAAE,GAAG,CAAC,MAAM,EAAE,EAAE,GAAG,CAAC,GAAG,CAAC,CAAC;EACxH,YAAY,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,MAAM,IAAI,GAAG,CAAC,YAAY,EAAE;EACrD,gBAAgB,SAAS,CAAC,IAAI,CAAC;EAC/B,oBAAoB,IAAI,EAAE,QAAQ;EAClC,oBAAoB,KAAK,EAAE,GAAG,CAAC,KAAK;EACpC,oBAAoB,MAAM,EAAE,GAAG,CAAC,YAAY;EAC5C,iBAAiB,CAAC,CAAC;EACnB,gBAAgB,QAAQ,CAAC,MAAM,GAAG,EAAE,MAAM,EAAE,GAAG,CAAC,YAAY,EAAE,CAAC;EAC/D,aAAa;EACb,YAAY,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;EACrC,YAAY,IAAI,GAAG,CAAC,OAAO,EAAE;EAC7B,gBAAgB,SAAS,CAAC,IAAI,CAAC;EAC/B,oBAAoB,IAAI,EAAE,SAAS;EACnC,oBAAoB,IAAI,EAAE,GAAG,CAAC,OAAO;EACrC,oBAAoB,EAAE,EAAE,GAAG,CAAC,SAAS;EACrC,iBAAiB,CAAC,CAAC;EACnB,aAAa;EACb,YAAY,OAAO,SAAS,CAAC;EAC7B,SAAS,CAAC,CAAC,CAAC;EACZ,KAAK,CAAC;EACN,IAAI,OAAO,OAAO,CAAC;EACnB,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;;ECtHjB,IAAI,UAAU,kBAAkB,UAAU,MAAM,EAAE;EAClD,IAAIkC,SAAiB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;EAC1C,IAAI,SAAS,UAAU,CAAC,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE;EAC/C,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC;EACtD,QAAQ,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC;EAC5B,QAAQ,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;EAC9B,QAAQ,KAAK,CAAC,IAAI,GAAG,UAAU,CAAC,KAAK,CAAC,KAAK,EAAE,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;EAClE,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,UAAU,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EAC7C,QAAQ,OAAO,IAAI,UAAU,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,EAAE,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;EACxE,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,QAAQ,GAAG,YAAY;EAChD,QAAQ,OAAO;EACf,YAAY,IAAI,EAAE,QAAQ;EAC1B,YAAY,IAAI,EAAE,IAAI,CAAC,IAAI;EAC3B,SAAS,CAAC;EACV,KAAK,CAAC;EACN,IAAI,OAAO,UAAU,CAAC;EACtB,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;;EClBjB,IAAI,WAAW,kBAAkB,UAAU,MAAM,EAAE;EACnD,IAAIA,SAAiB,CAAC,WAAW,EAAE,MAAM,CAAC,CAAC;EAC3C,IAAI,SAAS,WAAW,CAAC,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE;EAC1D,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC;EACtD,QAAQ,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;EAC9B,QAAQ,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;EAChC,QAAQ,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;EAC9B,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,WAAW,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EAC9C,QAAQ,OAAO,IAAI,WAAW,CAAC,IAAI,EAAE,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;EACxF,KAAK,CAAC;EACN,IAAI,WAAW,CAAC,QAAQ,GAAG,UAAU,MAAM,EAAE,KAAK,EAAE;EACpD,QAAQ,IAAI,cAAc,GAAG,CAAC,CAAC;EAC/B,QAAQ,CAAC,CAAC,SAAS,EAAE,QAAQ,CAAC,EAAE,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC,CAAC,OAAO,CAAC,UAAU,WAAW,EAAE;EACxF,YAAY,IAAI,IAAI,GAAG,WAAW,CAAC,GAAG,CAAC,UAAU,OAAO,EAAE,EAAE,OAAO,KAAK,CAAC,eAAe,CAAC,OAAO,CAAC,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,KAAK,GAAG,SAAS,CAAC,EAAE,CAAC,CAAC;EAClJ,YAAY,IAAI,IAAI,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,EAAE;EACpC,gBAAgB,MAAM,GAAG,IAAI,WAAW,CAAC,MAAM,EAAE,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,OAAO,CAAC,UAAU,GAAG,cAAc,EAAE,CAAC,CAAC,CAAC;EAC3G,aAAa;EACb,SAAS,CAAC,CAAC;EACX,QAAQ,IAAI,KAAK,CAAC,eAAe,CAAC,KAAK,CAAC,EAAE;EAC1C,YAAY,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;EACjD,YAAY,IAAI,QAAQ,CAAC,IAAI,KAAK,OAAO,EAAE;EAC3C,gBAAgB,MAAM,GAAG,IAAI,WAAW,CAAC,MAAM,EAAE,IAAI,EAAE,QAAQ,CAAC,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,UAAU,GAAG,cAAc,EAAE,CAAC,CAAC,CAAC;EACrH,aAAa;EACb,SAAS;EACT,QAAQ,OAAO,MAAM,CAAC;EACtB,KAAK,CAAC;EACN,IAAI,WAAW,CAAC,SAAS,CAAC,QAAQ,GAAG,YAAY;EACjD,QAAQ,OAAOlC,QAAgB,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,IAAI,CAAC,MAAM,GAAG,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,IAAI,IAAI,CAAC,OAAO,GAAG,EAAE,OAAO,EAAE,IAAI,CAAC,OAAO,EAAE,GAAG,EAAE,GAAG,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC;EAC7K,KAAK,CAAC;EACN,IAAI,OAAO,WAAW,CAAC;EACvB,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;;ECjCjB,IAAI,YAAY,kBAAkB,UAAU,MAAM,EAAE;EACpD,IAAIkC,SAAiB,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;EAC5C,IAAI,SAAS,YAAY,CAAC,MAAM,EAAE,UAAU,EAAE,MAAM,EAAE,EAAE,EAAE;EAC1D,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC;EACtD,QAAQ,KAAK,CAAC,UAAU,GAAG,UAAU,CAAC;EACtC,QAAQ,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;EAC9B,QAAQ,KAAK,CAAC,EAAE,GAAG,EAAE,CAAC;EACtB,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,YAAY,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EAC/C,QAAQ,OAAO,IAAI,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,UAAU,EAAE,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC;EACnG,KAAK,CAAC;EACN,IAAI,YAAY,CAAC,QAAQ,GAAG,UAAU,MAAM,EAAE,KAAK,EAAE;EACrD,QAAQ,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,EAAE;EACrC,YAAY,OAAO,MAAM,CAAC;EAC1B,SAAS;EACT,QAAQ,CAAC,CAAC,SAAS,EAAE,QAAQ,CAAC,EAAE,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC,CAAC,OAAO,CAAC,UAAU,WAAW,EAAE;EACxF,YAAY,IAAI,IAAI,GAAG,WAAW,CAAC,GAAG,CAAC,UAAU,OAAO,EAAE,EAAE,OAAO,KAAK,CAAC,eAAe,CAAC,OAAO,CAAC,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,KAAK,GAAG,SAAS,CAAC,EAAE,CAAC,CAAC;EAClJ,YAAY,IAAI,MAAM,GAAG,WAAW,CAAC,CAAC,CAAC,KAAK,UAAU,GAAG,GAAG,GAAG,EAAE,CAAC;EAClE,YAAY,IAAI,IAAI,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,EAAE;EACpC,gBAAgB,MAAM,GAAG,IAAI,YAAY,CAAC,MAAM,EAAE,KAAK,CAAC,cAAc,EAAE,EAAE,IAAI,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,GAAG,GAAG,MAAM,CAAC,EAAE,KAAK,CAAC,OAAO,CAAC,GAAG,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;EAC5I,aAAa;EACb,SAAS,CAAC,CAAC;EACX,QAAQ,OAAO,MAAM,CAAC;EACtB,KAAK,CAAC;EACN,IAAI,YAAY,CAAC,SAAS,CAAC,QAAQ,GAAG,YAAY;EAClD,QAAQ,OAAO;EACf,YAAY,IAAI,EAAE,UAAU;EAC5B,YAAY,UAAU,EAAE,IAAI,CAAC,UAAU;EACvC,YAAY,MAAM,EAAE,IAAI,CAAC,MAAM;EAC/B,YAAY,EAAE,EAAE,IAAI,CAAC,EAAE;EACvB,SAAS,CAAC;EACV,KAAK,CAAC;EACN,IAAI,OAAO,YAAY,CAAC;EACxB,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;;ECnCjB,IAAI,cAAc,kBAAkB,UAAU,MAAM,EAAE;EACtD,IAAIA,SAAiB,CAAC,cAAc,EAAE,MAAM,CAAC,CAAC;EAC9C,IAAI,SAAS,cAAc,CAAC,MAAM,EAAE;EACpC,QAAQ,OAAO,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC;EACjD,KAAK;EACL,IAAI,cAAc,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EACjD,QAAQ,OAAO,IAAI,cAAc,CAAC,IAAI,CAAC,CAAC;EACxC,KAAK,CAAC;EACN,IAAI,cAAc,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EAC1D,QAAQ,IAAI,EAAE,CAAC;EACf,QAAQ,OAAO,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,YAAY,CAAC,GAAG,IAAI,EAAE,EAAE,CAAC;EACpD,KAAK,CAAC;EACN,IAAI,cAAc,CAAC,SAAS,CAAC,QAAQ,GAAG,YAAY;EACpD,QAAQ,OAAO,EAAE,IAAI,EAAE,YAAY,EAAE,EAAE,EAAE,YAAY,EAAE,CAAC;EACxD,KAAK,CAAC;EACN,IAAI,OAAO,cAAc,CAAC;EAC1B,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;;ECjBjB;EACA;EACA;EACA;EACA;EACA,IAAI,aAAa,kBAAkB,UAAU,MAAM,EAAE;EACrD,IAAIA,SAAiB,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;EAC7C,IAAI,SAAS,aAAa,CAAC,QAAQ,EAAE,QAAQ,EAAE,YAAY,EAAE;EAC7D,QAAQ,IAAI,QAAQ,KAAK,KAAK,CAAC,EAAE,EAAE,QAAQ,GAAG,EAAE,CAAC,EAAE;EACnD,QAAQ,IAAI,QAAQ,KAAK,KAAK,CAAC,EAAE,EAAE,QAAQ,GAAG,EAAE,CAAC,EAAE;EACnD,QAAQ,IAAI,YAAY,KAAK,KAAK,CAAC,EAAE,EAAE,YAAY,GAAG,KAAK,CAAC,EAAE;EAC9D,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,QAAQ,EAAE,QAAQ,CAAC,IAAI,IAAI,CAAC;EAClE,QAAQ,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC;EAClC,QAAQ,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC;EAClC,QAAQ,KAAK,CAAC,YAAY,GAAG,YAAY,CAAC;EAC1C,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,aAAa,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EAChD,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACtD,QAAQ,KAAK,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;EAC/C,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK,CAAC;EACN,IAAI,OAAO,aAAa,CAAC;EACzB,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;;ECpBV,IAAI,UAAU,kBAAkB,UAAU,MAAM,EAAE;EAClD,IAAIA,SAAiB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;EAC1C,IAAI,SAAS,UAAU,CAAC,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE;EACtD,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC;EACtD,QAAQ,KAAK,CAAC,SAAS,GAAG,SAAS,CAAC;EACpC,QAAQ,KAAK,CAAC,SAAS,GAAG,SAAS,CAAC;EACpC,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,UAAU,CAAC,IAAI,GAAG,UAAU,MAAM,EAAE,KAAK,EAAE,SAAS,EAAE,OAAO,EAAE;EACnE,QAAQ,IAAI,OAAO,GAAG,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC;EACnD,QAAQ,IAAI,CAAC,GAAG,IAAI,UAAU,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACpD,QAAQ,IAAI,UAAU,GAAG,OAAO,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC;EAC3C,QAAQ,IAAI,CAAC,UAAU,EAAE;EACzB,YAAY,OAAO,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC;EAClC,YAAY,UAAU,GAAG,CAAC,CAAC;EAC3B,SAAS;EACT,QAAQ,IAAI,cAAc,GAAG,KAAK,CAAC,OAAO,CAAC,SAAS,GAAG,OAAO,CAAC,CAAC;EAChE,QAAQ,IAAI,cAAc,GAAG,IAAI,UAAU,CAAC,UAAU,EAAE,cAAc,EAAE,QAAQ,EAAE,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;EAC5H,QAAQ,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,WAAW,CAAC,cAAc,CAAC,GAAG,cAAc,CAAC;EAC1E,QAAQ,OAAO,IAAI,UAAU,CAAC,MAAM,EAAE,SAAS,EAAE,cAAc,CAAC,SAAS,EAAE,CAAC,CAAC;EAC7E,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACtD,QAAQ,OAAO,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,YAAY,KAAK,IAAI,IAAI,CAAC,SAAS,CAAC,EAAE,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;EACrI,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,QAAQ,GAAG,YAAY;EAChD,QAAQ,IAAI,OAAO,CAAC;EACpB,QAAQ,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,EAAE;EACxC;EACA,YAAY,OAAO,GAAGlC,QAAgB,CAAC,EAAE,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,EAAE,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,GAAG,EAAE,EAAE,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,YAAY,KAAK,IAAI,IAAI,CAAC,SAAS,CAAC,EAAE,GAAG,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC;EAClM,SAAS;EACT,aAAa;EACb;EACA,YAAY,IAAI,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC;EAC3C,YAAY,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;EACnC,gBAAgBQ,IAAQ,CAACC,OAAW,CAAC,kBAAkB,CAAC,CAAC;EACzD,gBAAgB,MAAM,GAAG,SAAS,CAAC;EACnC,aAAa;EACb,YAAY,OAAO,GAAG;EACtB,gBAAgB,EAAE,EAAE,CAAC,MAAM,CAAC;EAC5B,aAAa,CAAC;EACd,SAAS;EACT,QAAQ,OAAOT,QAAgB,CAAC,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,IAAI,CAAC,SAAS,EAAE,GAAG,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,EAAE,MAAM,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,EAAE,EAAE,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,GAAG,EAAE,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,GAAG,EAAE,EAAE,CAAC;EACvN,KAAK,CAAC;EACN,IAAI,OAAO,UAAU,CAAC;EACtB,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;;EC7CjB;EACA;EACA;EACA,IAAI,mBAAmB,kBAAkB,UAAU,MAAM,EAAE;EAC3D,IAAIkC,SAAiB,CAAC,mBAAmB,EAAE,MAAM,CAAC,CAAC;EACnD,IAAI,SAAS,mBAAmB,CAAC,MAAM,EAAE,SAAS,EAAE;EACpD,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,IAAI,CAAC;EACtD,QAAQ,KAAK,CAAC,SAAS,GAAG,SAAS,CAAC;EACpC,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,mBAAmB,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EACtD,QAAQ,OAAO,IAAI,mBAAmB,CAAC,IAAI,CAAC,MAAM,EAAE,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;EAC/E,KAAK,CAAC;EACN,IAAI,mBAAmB,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EAC/D,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC;EACzB,QAAQ,IAAI,GAAG,GAAG,EAAE,CAAC;EACrB,QAAQ,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,UAAU,cAAc,EAAE;EAChE,YAAY,GAAG,CAAC,KAAK,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC,GAAG,IAAI,CAAC;EAC7D,SAAS,CAAC,CAAC;EACX,QAAQ,OAAO,GAAG,CAAC;EACnB,KAAK,CAAC;EACN,IAAI,mBAAmB,CAAC,SAAS,CAAC,cAAc,GAAG,UAAU,cAAc,EAAE;EAC7E,QAAQ,OAAO,cAAc,CAAC,EAAE,IAAI,OAAO,CAAC,cAAc,CAAC,CAAC;EAC5D,KAAK,CAAC;EACN,IAAI,mBAAmB,CAAC,SAAS,CAAC,QAAQ,GAAG,YAAY;EACzD,QAAQ,IAAI,MAAM,GAAG,EAAE,CAAC;EACxB,QAAQ,IAAI,GAAG,GAAG,EAAE,CAAC;EACrB,QAAQ,IAAI,EAAE,GAAG,EAAE,CAAC;EACpB,QAAQ,IAAI,MAAM,GAAG,EAAE,CAAC;EACxB,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC3E,YAAY,IAAI,QAAQ,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAClC,YAAY,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;EAClC,YAAY,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,CAAC;EACnD,YAAY,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,KAAK,SAAS,GAAG,IAAI,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;EAC9E,YAAY,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,KAAK,SAAS,GAAG,IAAI,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;EAC9E,SAAS;EACT,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC;EACzC,QAAQ,IAAI,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC;EAC7C,QAAQ,IAAI,UAAU,GAAG,EAAE,CAAC;EAC5B,QAAQ,IAAI,SAAS,GAAG,EAAE,CAAC;EAC3B,QAAQ,IAAI,IAAI,CAAC,SAAS,CAAC,IAAI,KAAK,SAAS,EAAE;EAC/C,YAAY,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC7E,gBAAgB,IAAI,SAAS,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EACvC,gBAAgB,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;EACjD,gBAAgB,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,KAAK,SAAS,GAAG,IAAI,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC;EACvF,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,IAAI,GAAG;EACnB,YAAY,KAAK,EAAE,UAAU;EAC7B,YAAY,KAAK,EAAE,SAAS;EAC5B,SAAS,CAAC;EACV,QAAQ,IAAI,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC;EACrD,QAAQ,IAAI,MAAM,GAAG;EACrB,YAAY,IAAI,EAAE,QAAQ;EAC1B,YAAY,MAAM,EAAE,MAAM;EAC1B,YAAY,EAAE,EAAE,EAAE;EAClB,YAAY,GAAG,EAAE,GAAG;EACpB,YAAY,MAAM,EAAE,MAAM;EAC1B,YAAY,IAAI,EAAE,IAAI;EACtB,SAAS,CAAC;EACV,QAAQ,IAAI,WAAW,KAAK,SAAS,EAAE;EACvC,YAAY,MAAM,CAAC,WAAW,GAAG,WAAW,CAAC;EAC7C,SAAS;EACT,QAAQ,IAAI,OAAO,KAAK,SAAS,EAAE;EACnC,YAAY,MAAM,CAAC,OAAO,GAAG,OAAO,CAAC;EACrC,SAAS;EACT,QAAQ,IAAI,KAAK,KAAK,SAAS,EAAE;EACjC,YAAY,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC;EACjC,SAAS;EACT,QAAQ,OAAO,MAAM,CAAC;EACtB,KAAK,CAAC;EACN,IAAI,OAAO,mBAAmB,CAAC;EAC/B,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;;ECpDjB,SAAS,SAAS,CAAC,KAAK,EAAE,OAAO,EAAE;EACnC,IAAI,IAAI,KAAK,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE;EACrC;EACA,QAAQ,IAAI,MAAM,GAAG,IAAI,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;EAChD,QAAQ,IAAIuC,OAAI,GAAG,MAAM,CAAC,IAAI,EAAE,CAAC;EACjC,QAAQ,IAAIA,OAAI,IAAI,OAAO,EAAE;EAC7B;EACA,YAAY,OAAO,OAAO,CAACA,OAAI,CAAC,CAAC;EACjC,SAAS;EACT,aAAa;EACb;EACA,YAAY,OAAO,CAACA,OAAI,CAAC,GAAG,MAAM,CAAC;EACnC,YAAY,OAAO,MAAM,CAAC;EAC1B,SAAS;EACT,KAAK;EACL,SAAS;EACT;EACA,QAAQ,OAAO,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC;EAChI,KAAK;EACL,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,mBAAmB,CAAC,IAAI,EAAE,KAAK,EAAE,aAAa,EAAE;EAChE,IAAI,IAAI,aAAa,GAAG,CAAC,CAAC;EAC1B,IAAI,KAAK,CAAC,UAAU,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;EAC1C,QAAQ,IAAI,WAAW,CAAC,CAAC,CAAC,EAAE;EAC5B,YAAY,IAAI,GAAG,IAAI,aAAa,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;EAC9C,YAAY,aAAa,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,SAAS,EAAE,KAAK,CAAC,CAAC;EACtD,SAAS;EACT,aAAa,IAAI,QAAQ,CAAC,CAAC,CAAC,EAAE;EAC9B,YAAY,IAAI,GAAG,SAAS,CAAC,+BAA+B,CAAC,IAAI,EAAE,CAAC,EAAE,aAAa,CAAC,IAAI,IAAI,CAAC;EAC7F,YAAY,IAAI,GAAG,IAAI,UAAU,CAAC,IAAI,EAAE,KAAK,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC;EACzD,SAAS;EACT,aAAa,IAAI,KAAK,CAAC,CAAC,CAAC,EAAE;EAC3B,YAAY,IAAI,GAAG,OAAO,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC,EAAE,KAAK,CAAC,CAAC;EAC7D,YAAY,aAAa,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,QAAQ,EAAE,KAAK,CAAC,CAAC;EACrD,SAAS;EACT,aAAa,IAAIF,YAAU,CAAC,CAAC,CAAC,EAAE;EAChC,YAAY,IAAI,GAAG,YAAY,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;EAC3D,YAAY,aAAa,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;EACnD,SAAS;EACT,aAAa,IAAIC,aAAW,CAAC,CAAC,CAAC,EAAE;EACjC,YAAY,IAAI,GAAG,GAAG,IAAI,GAAG,aAAa,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;EACtE,YAAY,IAAI,mBAAmB,CAAC,KAAK,CAAC,EAAE;EAC5C,gBAAgB,IAAI,GAAG,IAAI,cAAc,CAAC,IAAI,CAAC,CAAC;EAChD,aAAa;EACb,YAAY,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,cAAc,EAAE,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACpF,gBAAgB,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EACnC,gBAAgB,aAAa,CAAC,GAAG,CAAC,KAAK,EAAE,SAAS,EAAE,KAAK,CAAC,CAAC;EAC3D,aAAa;EACb,SAAS;EACT,aAAa,IAAI,QAAQ,CAAC,CAAC,CAAC,EAAE;EAC9B,YAAY,IAAI,MAAM,GAAG,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,CAAC,EAAE,aAAa,EAAE,CAAC,CAAC;EACjF,YAAY,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACvF,gBAAgB,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EACnC,gBAAgB,aAAa,CAAC,GAAG,CAAC,KAAK,EAAE,SAAS,EAAE,KAAK,CAAC,CAAC;EAC3D,aAAa;EACb,SAAS;EACT,aAAa,IAAI,QAAQ,CAAC,CAAC,CAAC,EAAE;EAC9B,YAAY,IAAI,QAAQ,GAAG,IAAI,GAAG,IAAI,mBAAmB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;EACnE,YAAY,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,QAAQ,CAAC,cAAc,EAAE,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACzF,gBAAgB,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EACnC,gBAAgB,aAAa,CAAC,GAAG,CAAC,KAAK,EAAE,SAAS,EAAE,KAAK,CAAC,CAAC;EAC3D,aAAa;EACb,SAAS;EACT,aAAa,IAAI,OAAO,CAAC,CAAC,CAAC,EAAE;EAC7B,YAAY,IAAI,KAAK,GAAG,IAAI,GAAG,SAAS,CAAC,iBAAiB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;EACpE,YAAY,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACtF,gBAAgB,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EACnC,gBAAgB,aAAa,CAAC,GAAG,CAAC,KAAK,EAAE,SAAS,EAAE,KAAK,CAAC,CAAC;EAC3D,aAAa;EACb,SAAS;EACT,aAAa;EACb,YAAYhE,IAAQ,CAACC,OAAW,CAAC,uBAAuB,CAAC,CAAC,CAAC,CAAC,CAAC;EAC7D,YAAY,OAAO;EACnB,SAAS;EACT,KAAK,CAAC,CAAC;EACP,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;EACD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,SAAS,CAAC,KAAK,EAAE;EACjC,IAAI,IAAI,IAAI,GAAG,SAAS,CAAC,KAAK,EAAE,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;EAC9D,IAAI,IAAI,EAAE,GAAG,KAAK,CAAC,SAAS,CAAC,IAAI,EAAE,WAAW,GAAG,EAAE,CAAC,WAAW,EAAE,mBAAmB,GAAG,EAAE,CAAC,mBAAmB,CAAC;EAC9G,IAAI,IAAI,aAAa,GAAG,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,EAAE,GAAG,IAAI,aAAa,EAAE,CAAC;EAC/G;EACA,IAAI,IAAI,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,CAAC,MAAM,IAAI,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,KAAK,IAAI,EAAE;EAC7E,QAAQ,aAAa,CAAC,YAAY,GAAG,IAAI,CAAC;EAC1C,KAAK;EACL,IAAI,IAAI,GAAG,SAAS,CAAC,YAAY,CAAC,IAAI,EAAE,KAAK,EAAE,aAAa,CAAC,IAAI,IAAI,CAAC;EACtE;EACA;EACA;EACA;EACA;EACA;EACA,IAAI,IAAI,mBAAmB,CAAC,KAAK,CAAC,KAAK,WAAW,CAAC,KAAK,CAAC,IAAI,YAAY,CAAC,KAAK,CAAC,CAAC,EAAE;EACnF,QAAQ,IAAI,GAAG,IAAI,cAAc,CAAC,IAAI,CAAC,CAAC;EACxC,KAAK;EACL;EACA;EACA,IAAI,IAAI,aAAa,GAAG,KAAK,CAAC,MAAM,IAAI,YAAY,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;EACnE,IAAI,IAAI,WAAW,CAAC,KAAK,CAAC,IAAI,YAAY,CAAC,KAAK,CAAC,EAAE;EACnD,QAAQ,IAAI,aAAa,EAAE;EAC3B,YAAY,IAAI,GAAG,OAAO,CAAC,gBAAgB,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,IAAI,CAAC;EACjE,SAAS;EACT,KAAK;EACL,IAAI,IAAI,KAAK,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;EACrC,QAAQ,IAAI,GAAG,mBAAmB,CAAC,IAAI,EAAE,KAAK,EAAE,aAAa,CAAC,CAAC;EAC/D,KAAK;EACL,IAAI,IAAI,GAAG,SAAS,CAAC,wBAAwB,CAAC,IAAI,EAAE,KAAK,EAAE,aAAa,CAAC,IAAI,IAAI,CAAC;EAClF,IAAI,IAAI,WAAW,CAAC,KAAK,CAAC,EAAE;EAC5B,QAAQ,IAAI,GAAG,WAAW,CAAC,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;EACjD,QAAQ,IAAI,GAAG,YAAY,CAAC,QAAQ,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;EAClD,KAAK;EACL,IAAI,IAAI,WAAW,CAAC,KAAK,CAAC,IAAI,YAAY,CAAC,KAAK,CAAC,EAAE;EACnD,QAAQ,IAAI,CAAC,aAAa,EAAE;EAC5B,YAAY,IAAI,GAAG,OAAO,CAAC,gBAAgB,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,IAAI,CAAC;EACjE,SAAS;EACT,QAAQ,IAAI,GAAG,YAAY,CAAC,gBAAgB,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,IAAI,CAAC;EAClE,QAAQ,IAAI,GAAG,aAAa,CAAC,oBAAoB,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;EAC/D,KAAK;EACL;EACA,IAAI,IAAI,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;EACrC,IAAI,IAAI,GAAG,GAAG,IAAI,UAAU,CAAC,IAAI,EAAE,OAAO,EAAE,GAAG,EAAE,mBAAmB,CAAC,CAAC;EACtE,IAAI,WAAW,CAAC,OAAO,CAAC,GAAG,GAAG,CAAC;EAC/B,IAAI,IAAI,GAAG,GAAG,CAAC;EACf,IAAI,IAAI,WAAW,CAAC,KAAK,CAAC,EAAE;EAC5B,QAAQ,IAAI,GAAG,GAAG,aAAa,CAAC,gBAAgB,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;EAC9D,QAAQ,IAAI,GAAG,EAAE;EACjB,YAAY,IAAI,GAAG,GAAG,CAAC;EACvB,YAAY,IAAI,mBAAmB,CAAC,KAAK,CAAC,EAAE;EAC5C,gBAAgB,IAAI,GAAG,IAAI,cAAc,CAAC,IAAI,CAAC,CAAC;EAChD,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,GAAG,SAAS,CAAC,gBAAgB,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,IAAI,CAAC;EAC/D,KAAK;EACL,IAAI,IAAI,WAAW,CAAC,KAAK,CAAC,EAAE;EAC5B,QAAQ,IAAI,GAAG,iBAAiB,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,IAAI,IAAI,CAAC;EAC3D,KAAK;EACL;EACA,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;EACvC,IAAI,IAAI,IAAI,GAAG,IAAI,UAAU,CAAC,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,mBAAmB,CAAC,CAAC;EACzE,IAAI,WAAW,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC;EACjC,IAAI,IAAI,GAAG,IAAI,CAAC;EAChB;EACA,IAAI,IAAI,SAAS,GAAG,IAAI,CAAC;EACzB,IAAI,IAAI,YAAY,CAAC,KAAK,CAAC,EAAE;EAC7B,QAAQ,IAAI,SAAS,GAAG,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;EAC/C,QAAQ,SAAS,GAAG,IAAI,SAAS,CAAC,IAAI,EAAE,KAAK,EAAE,SAAS,EAAE,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC;EAC5E,QAAQ,WAAW,CAAC,SAAS,CAAC,GAAG,SAAS,CAAC;EAC3C,QAAQ,IAAI,GAAG,SAAS,CAAC;EACzB,KAAK;EACL,IAAI,OAAOT,QAAgB,CAAC,EAAE,EAAE,KAAK,CAAC,SAAS,CAAC,IAAI,EAAE,EAAE,WAAW,EAAE,WAAW;EAChF,QAAQ,mBAAmB,EAAE,mBAAmB;EAChD,QAAQ,GAAG,EAAE,GAAG;EAChB,QAAQ,IAAI,EAAE,IAAI;EAClB,QAAQ,SAAS,EAAE,SAAS;EAC5B,QAAQ,aAAa,EAAE,aAAa,EAAE,CAAC,CAAC;EACxC,CAAC;;ECvOD,IAAI,eAAe,kBAAkB,UAAU,MAAM,EAAE;EACvD,IAAIkC,SAAiB,CAAC,eAAe,EAAE,MAAM,CAAC,CAAC;EAC/C,IAAI,SAAS,eAAe,CAAC,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,MAAM,EAAE,QAAQ,EAAE,OAAO,EAAE;EACvF,QAAQ,OAAO,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,MAAM,EAAE,QAAQ,EAAE,OAAO,CAAC,IAAI,IAAI,CAAC;EACnG,KAAK;EACL,IAAI,eAAe,CAAC,SAAS,CAAC,SAAS,GAAG,YAAY;EACtD,QAAQ,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC;EAC9C,QAAQ,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,KAAK,EAAE;EAC/C,YAAY,KAAK,CAAC,SAAS,EAAE,CAAC;EAC9B,SAAS,CAAC,CAAC;EACX,KAAK,CAAC;EACN,IAAI,eAAe,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EAC3D,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC;EACzB;EACA;EACA;EACA,QAAQ,IAAI,CAAC,SAAS,CAAC,SAAS,GAAG,EAAE,CAAC;EACtC,QAAQ,IAAI,OAAO,GAAG,UAAU,KAAK,EAAE;EACvC,YAAY,KAAK,CAAC,cAAc,EAAE,CAAC;EACnC,YAAY,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,UAAU,GAAG,EAAE;EACnE,gBAAgB,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;EAChF,aAAa,CAAC,CAAC;EACf,SAAS,CAAC;EACV,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACnE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,OAAO,CAAC,KAAK,CAAC,CAAC;EAC3B,SAAS;EACT,KAAK,CAAC;EACN,IAAI,eAAe,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EAC3D,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACnE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,KAAK,CAAC,cAAc,EAAE,CAAC;EACnC,SAAS;EACT,KAAK,CAAC;EACN,IAAI,eAAe,CAAC,SAAS,CAAC,kBAAkB,GAAG,YAAY;EAC/D,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACnE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,KAAK,CAAC,kBAAkB,EAAE,CAAC;EACvC,SAAS;EACT;EACA,KAAK,CAAC;EACN,IAAI,eAAe,CAAC,SAAS,CAAC,gCAAgC,GAAG,UAAU,OAAO,EAAE;EACpF,QAAQ,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,EAAE,EAAE,KAAK,EAAE,EAAE,OAAO,KAAK,CAAC,gCAAgC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;EAC1H,KAAK,CAAC;EACN,IAAI,eAAe,CAAC,SAAS,CAAC,wBAAwB,GAAG,YAAY;EACrE,QAAQ,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,KAAK,EAAE,EAAE,OAAO,KAAK,CAAC,wBAAwB,EAAE,CAAC,EAAE,CAAC,CAAC;EAC7F,QAAQ,OAAO,EAAE,CAAC;EAClB,KAAK,CAAC;EACN,IAAI,eAAe,CAAC,SAAS,CAAC,qBAAqB,GAAG,YAAY;EAClE,QAAQ,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,OAAO,EAAE,KAAK,EAAE;EAC9D,YAAY,OAAO,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,qBAAqB,EAAE,CAAC,CAAC;EACjE,SAAS,EAAE,qBAAqB,CAAC,IAAI,CAAC,CAAC,CAAC;EACxC,KAAK,CAAC;EACN,IAAI,eAAe,CAAC,SAAS,CAAC,qBAAqB,GAAG,UAAU,IAAI,EAAE;EACtE,QAAQ,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,EAAE,EAAE,KAAK,EAAE,EAAE,OAAO,KAAK,CAAC,qBAAqB,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;EAC5G,KAAK,CAAC;EACN,IAAI,eAAe,CAAC,SAAS,CAAC,aAAa,GAAG,YAAY;EAC1D;EACA,QAAQ,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,UAAU,KAAK,EAAE;EAClD,YAAY,IAAI,KAAK,GAAG,KAAK,CAAC,aAAa,EAAE,CAAC;EAC9C,YAAY,IAAI,KAAK,GAAG,KAAK,CAAC,kBAAkB,EAAE,CAAC;EACnD,YAAY,IAAI,qBAAqB,GAAG,KAAK,CAAC,kBAAkB,EAAE,CAAC;EACnE,YAAY,OAAOlC,QAAgB,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,GAAG,KAAK,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,KAAK,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,IAAI,qBAAqB,GAAG;EAChL,gBAAgB,MAAM,EAAE;EACxB,oBAAoB,MAAM,EAAE,qBAAqB;EACjD,iBAAiB;EACjB,aAAa,GAAG,EAAE,GAAG,KAAK,CAAC,aAAa,EAAE,CAAC,CAAC;EAC5C,SAAS,CAAC,CAAC;EACX,KAAK,CAAC;EACN,IAAI,OAAO,eAAe,CAAC;EAC3B,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;;ECxEH,SAAS,oBAAoB,CAAC,KAAK,EAAE;EAC5C,IAAI,uBAAuB,CAAC,KAAK,CAAC,CAAC;EACnC,IAAI,IAAI,cAAc,GAAG,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC;EACpD,IAAI,cAAc,CAAC,eAAe,CAAC,OAAO,EAAE,gCAAgC,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC,CAAC;EAC9F,IAAI,cAAc,CAAC,eAAe,CAAC,QAAQ,EAAE,gCAAgC,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC,CAAC;EAChG,CAAC;AACD,EAAO,IAAI,qBAAqB,GAAG,oBAAoB,CAAC;AACxD,EAAO,SAAS,qBAAqB,CAAC,KAAK,EAAE;EAC7C,IAAI,uBAAuB,CAAC,KAAK,CAAC,CAAC;EACnC,IAAI,IAAI,cAAc,GAAG,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC;EACpD,IAAI,IAAI,eAAe,GAAG,KAAK,CAAC,SAAS,GAAG,OAAO,GAAG,QAAQ,CAAC;EAC/D,IAAI,cAAc,CAAC,eAAe,CAAC,eAAe,EAAE,gCAAgC,CAAC,KAAK,EAAE,eAAe,CAAC,CAAC,CAAC;EAC9G,CAAC;AACD,EAAO,SAAS,uBAAuB,CAAC,KAAK,EAAE;EAC/C,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAChE,QAAQ,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC3B,QAAQ,KAAK,CAAC,eAAe,EAAE,CAAC;EAChC,KAAK;EACL,CAAC;EACD,SAAS,gCAAgC,CAAC,KAAK,EAAE,QAAQ,EAAE;EAC3D,IAAI,IAAI,OAAO,GAAG,QAAQ,KAAK,OAAO,GAAG,GAAG,GAAG,GAAG,CAAC;EACnD,IAAI,IAAI,OAAO,GAAG,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC;EAC1C,IAAI,IAAI,UAAU,CAAC;EACnB;EACA,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAChE,QAAQ,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC3B,QAAQ,IAAI,SAAS,GAAG,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;EAC7E,QAAQ,IAAI,YAAY,GAAG,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;EAClD,QAAQ,IAAI,YAAY,KAAK,aAAa,IAAI,SAAS,CAAC,KAAK,KAAK,YAAY,EAAE;EAChF;EACA;EACA,YAAY,UAAU,GAAG,SAAS,CAAC;EACnC,YAAY,MAAM;EAClB,SAAS;EACT,QAAQ,IAAI,UAAU,EAAE;EACxB,YAAY,IAAI,YAAY,KAAK,aAAa,IAAI,UAAU,CAAC,KAAK,KAAK,SAAS,CAAC,KAAK,EAAE;EACxF;EACA;EACA,gBAAgB,UAAU,GAAG,SAAS,CAAC;EACvC,gBAAgB,MAAM;EACtB,aAAa;EACb,YAAY,UAAU,GAAG,uBAAuB,CAAC,UAAU,EAAE,SAAS,EAAE,QAAQ,EAAE,EAAE,CAAC,CAAC;EACtF,SAAS;EACT,aAAa;EACb,YAAY,UAAU,GAAG,SAAS,CAAC;EACnC,SAAS;EACT,KAAK;EACL,IAAI,IAAI,UAAU,EAAE;EACpB;EACA,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACpE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,KAAK,CAAC,gBAAgB,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC;EACrF,YAAY,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,EAAE,QAAQ,EAAE,KAAK,CAAC,CAAC;EACtE,SAAS;EACT,QAAQ,OAAO,UAAU,CAAC;EAC1B,KAAK;EACL,SAAS;EACT;EACA,QAAQ,OAAO;EACf,YAAY,QAAQ,EAAE,KAAK;EAC3B,YAAY,KAAK,EAAE,SAAS;EAC5B,SAAS,CAAC;EACV,KAAK;EACL,CAAC;AACD,EAAO,SAAS,mBAAmB,CAAC,KAAK,EAAE;EAC3C,IAAI,IAAI,mBAAmB,GAAG,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC;EACzD,IAAI,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,KAAK,EAAE;EAC7C,QAAQ,IAAI,KAAK,GAAG,eAAe,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;EACpD,QAAQ,mBAAmB,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;EACvD,KAAK;EACL,IAAI,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,MAAM,EAAE;EAC9C,QAAQ,IAAI,MAAM,GAAG,eAAe,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;EACtD,QAAQ,mBAAmB,CAAC,GAAG,CAAC,QAAQ,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;EACzD,KAAK;EACL,CAAC;EACD,SAAS,eAAe,CAAC,KAAK,EAAE,QAAQ,EAAE;EAC1C,IAAI,IAAI,OAAO,GAAG,QAAQ,KAAK,OAAO,GAAG,GAAG,GAAG,GAAG,CAAC;EACnD,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;EAC9B,IAAI,IAAI,cAAc,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;EAC1D,IAAI,IAAI,cAAc,EAAE;EACxB,QAAQ,IAAI,SAAS,GAAG,cAAc,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EACnD,QAAQ,IAAI,KAAK,GAAG,cAAc,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;EAChD,QAAQ,IAAI,iBAAiB,CAAC,SAAS,CAAC,IAAI,aAAa,CAAC,KAAK,CAAC,EAAE;EAClE;EACA,YAAY,OAAO,YAAY,CAAC;EAChC,SAAS;EACT,aAAa;EACb,YAAY,OAAO,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;EACzC,SAAS;EACT,KAAK;EACL,SAAS,IAAI,KAAK,CAAC,aAAa,EAAE;EAClC,QAAQ,OAAO,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;EACrC,KAAK;EACL,SAAS;EACT;EACA,QAAQ,IAAI,QAAQ,KAAK,OAAO,IAAI,KAAK,CAAC,IAAI,KAAK,MAAM,EAAE;EAC3D;EACA,YAAY,OAAO,MAAM,CAAC,KAAK,CAAC,cAAc,CAAC;EAC/C,SAAS;EACT;EACA,QAAQ,OAAO,MAAM,CAAC,KAAK,CAAC,SAAS,IAAI,kBAAkB,CAAC,SAAS,CAAC;EACtE,KAAK;EACL,CAAC;;ECnGD,IAAI,WAAW,kBAAkB,UAAU,MAAM,EAAE;EACnD,IAAIkC,SAAiB,CAAC,WAAW,EAAE,MAAM,CAAC,CAAC;EAC3C,IAAI,SAAS,WAAW,CAAC,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,QAAQ,EAAE,MAAM,EAAE;EAC1E,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,MAAM,EAAE,QAAQ,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,IAAI,CAAC;EAC7G,QAAQ,KAAK,CAAC,IAAI,GAAG,QAAQ,CAAC;EAC9B,QAAQ,IAAI,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,KAAK,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,KAAK,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,KAAK,QAAQ,CAAC,EAAE;EACzH,YAAY1B,IAAQ,CAACC,OAAW,CAAC,wBAAwB,CAAC,CAAC;EAC3D,SAAS;EACT,QAAQ,KAAK,CAAC,SAAS,GAAG,aAAa,CAAC,IAAI,CAAC,CAAC;EAC9C,QAAQ,KAAK,CAAC,QAAQ,GAAG,CAAC,aAAa,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,EAAE,GAAG,CAAC,UAAU,KAAK,EAAE,CAAC,EAAE;EACrG,YAAY,OAAO,UAAU,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,SAAS,GAAG,CAAC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;EAC9G,SAAS,CAAC,CAAC;EACX,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,WAAW,CAAC,SAAS,CAAC,eAAe,GAAG,YAAY;EACxD,QAAQ,qBAAqB,CAAC,IAAI,CAAC,CAAC;EACpC,KAAK,CAAC;EACN,IAAI,WAAW,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACvD,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK,CAAC;EACN,IAAI,WAAW,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACvD;EACA,QAAQ,OAAOT,QAAgB,CAAC,EAAE,OAAO,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE,GAAG,IAAI,CAAC,SAAS,GAAG,EAAE,OAAO,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,MAAM,EAAE,MAAM;EAC1I;EACA,YAAY,KAAK,EAAE,MAAM,EAAE,CAAC,CAAC;EAC7B,KAAK,CAAC;EACN,IAAI,OAAO,WAAW,CAAC;EACvB,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC;;ECHpB,SAAS,YAAY,CAAC,IAAI,EAAE;EAC5B;EACA,IAAI,IAAI,YAAY,GAAG,CAAC,CAAC;EACzB;EACA;EACA;EACA,IAAI,SAAS,QAAQ,CAAC,IAAI,EAAE,UAAU,EAAE;EACxC,QAAQ,IAAI,IAAI,YAAY,UAAU,EAAE;EACxC;EACA;EACA,YAAY,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;EACvC,gBAAgB,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;EACtC,gBAAgB,IAAI,OAAO,GAAG;EAC9B,oBAAoB,IAAI,EAAE,IAAI;EAC9B,oBAAoB,MAAM,EAAE,UAAU,CAAC,IAAI;EAC3C,oBAAoB,SAAS,EAAE,EAAE;EACjC,iBAAiB,CAAC;EAClB,gBAAgB,UAAU,GAAG,OAAO,CAAC;EACrC,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,IAAI,YAAY,SAAS,EAAE;EACvC,YAAY,IAAI,IAAI,CAAC,MAAM,YAAY,UAAU,IAAI,CAAC,UAAU,CAAC,MAAM,EAAE;EACzE;EACA,gBAAgB,UAAU,CAAC,MAAM,GAAGA,QAAgB,CAAC,EAAE,EAAE,UAAU,CAAC,MAAM,IAAI,EAAE,EAAE,EAAE,KAAK,EAAE,IAAI,CAAC,mBAAmB,EAAE,EAAE,CAAC,CAAC;EACzH;EACA,gBAAgB,UAAU,CAAC,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC,CAAC;EAClG,aAAa;EACb,iBAAiB;EACjB;EACA,gBAAgB,UAAU,CAAC,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC;EAC9F,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,IAAI,YAAY,SAAS,EAAE;EACvC,YAAY,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE;EAClC,gBAAgB,UAAU,CAAC,IAAI,GAAG,OAAO,GAAG,YAAY,EAAE,CAAC;EAC3D,aAAa;EACb,YAAY,IAAI,CAAC,UAAU,CAAC,MAAM,IAAI,UAAU,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;EACvE,gBAAgB,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;EACtC,gBAAgB,IAAI,CAAC,IAAI,GAAG,UAAU,CAAC,IAAI,CAAC;EAC5C,aAAa;EACb,iBAAiB;EACjB,gBAAgB,IAAI,CAAC,IAAI,GAAG,UAAU,CAAC,MAAM,CAAC;EAC9C,aAAa;EACb,YAAY,IAAI,CAAC,QAAQ,EAAE,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE,EAAE,OAAO,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;EAC3E;EACA,YAAY,OAAO;EACnB,SAAS;EACT,QAAQ,IAAI,IAAI,YAAY,UAAU;EACtC,YAAY,IAAI,YAAY,aAAa;EACzC,YAAY,IAAI,YAAY,YAAY;EACxC,YAAY,IAAI,YAAY,WAAW;EACvC,YAAY,IAAI,YAAY,aAAa;EACzC,YAAY,IAAI,YAAY,UAAU;EACtC,YAAY,IAAI,YAAY,mBAAmB;EAC/C,YAAY,IAAI,YAAY,cAAc,EAAE;EAC5C,YAAY,UAAU,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;EACvD,SAAS;EACT,QAAQ,IAAI,IAAI,YAAY,iBAAiB;EAC7C,YAAY,IAAI,YAAY,OAAO;EACnC,YAAY,IAAI,YAAY,YAAY;EACxC,YAAY,IAAI,YAAY,SAAS,EAAE;EACvC,YAAY,UAAU,CAAC,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;EAChF,SAAS;EACT,QAAQ,IAAI,IAAI,YAAY,aAAa,EAAE;EAC3C,YAAY,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE;EAClC,gBAAgB,UAAU,CAAC,IAAI,GAAG,OAAO,GAAG,YAAY,EAAE,CAAC;EAC3D,aAAa;EACb,SAAS;EACT,QAAQ,IAAI,IAAI,YAAY,UAAU,EAAE;EACxC,YAAY,IAAI,UAAU,CAAC,MAAM,IAAI,UAAU,CAAC,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;EACxE,gBAAgB,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;EAClD,aAAa;EACb,iBAAiB,IAAI,IAAI,CAAC,MAAM,YAAY,UAAU,EAAE;EACxD;EACA;EACA,gBAAgB,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;EAChD,aAAa;EACb,iBAAiB;EACjB,gBAAgB,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE;EACtC,oBAAoB,UAAU,CAAC,IAAI,GAAG,OAAO,GAAG,YAAY,EAAE,CAAC;EAC/D,iBAAiB;EACjB;EACA;EACA,gBAAgB,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;EAChD;EACA,gBAAgB,IAAI,IAAI,CAAC,WAAW,EAAE,KAAK,CAAC,EAAE;EAC9C,oBAAoB,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;EAC1C,oBAAoB,IAAI,OAAO,GAAG;EAClC,wBAAwB,IAAI,EAAE,IAAI;EAClC,wBAAwB,MAAM,EAAE,UAAU,CAAC,IAAI;EAC/C,wBAAwB,SAAS,EAAE,EAAE;EACrC,qBAAqB,CAAC;EACtB,oBAAoB,UAAU,GAAG,OAAO,CAAC;EACzC,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,QAAQ,QAAQ,IAAI,CAAC,WAAW,EAAE;EAClC,YAAY,KAAK,CAAC;EAClB;EACA,gBAAgB,IAAI,IAAI,YAAY,UAAU,KAAK,CAAC,UAAU,CAAC,MAAM,IAAI,UAAU,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,EAAE;EAC3G;EACA,oBAAoB,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;EAC1C,iBAAiB;EACjB,gBAAgB,MAAM;EACtB,YAAY,KAAK,CAAC;EAClB,gBAAgB,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC;EACvD,gBAAgB,MAAM;EACtB,YAAY;EACZ,gBAAgB,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE;EACtC,oBAAoB,UAAU,CAAC,IAAI,GAAG,OAAO,GAAG,YAAY,EAAE,CAAC;EAC/D,iBAAiB;EACjB,gBAAgB,IAAI,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC;EAC/C,gBAAgB,IAAI,CAAC,UAAU,CAAC,MAAM,IAAI,UAAU,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;EAC3E,oBAAoB,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;EAC1C,iBAAiB;EACjB,qBAAqB;EACrB,oBAAoB,QAAQ,GAAG,UAAU,CAAC,MAAM,CAAC;EACjD,iBAAiB;EACjB,gBAAgB,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,KAAK,EAAE;EACvD,oBAAoB,IAAI,OAAO,GAAG;EAClC,wBAAwB,IAAI,EAAE,IAAI;EAClC,wBAAwB,MAAM,EAAE,QAAQ;EACxC,wBAAwB,SAAS,EAAE,EAAE;EACrC,qBAAqB,CAAC;EACtB,oBAAoB,QAAQ,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;EAC7C,iBAAiB,CAAC,CAAC;EACnB,gBAAgB,MAAM;EACtB,SAAS;EACT,KAAK;EACL,IAAI,OAAO,QAAQ,CAAC;EACpB,CAAC;EACD;EACA;EACA;AACA,EAAO,SAAS,iBAAiB,CAAC,IAAI,EAAE;EACxC,IAAI,IAAI,IAAI,GAAG,EAAE,CAAC;EAClB,IAAI,IAAI,QAAQ,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC;EACtC,IAAI,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,KAAK,EAAE,EAAE,OAAO,QAAQ,CAAC,KAAK,EAAE;EACpE,QAAQ,MAAM,EAAE,IAAI,CAAC,IAAI;EACzB,QAAQ,IAAI,EAAE,IAAI;EAClB,QAAQ,SAAS,EAAE,EAAE;EACrB,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;EACX,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;EACD;EACA;EACA;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,gBAAgB,CAAC,aAAa,EAAE,QAAQ,EAAE;EAC1D,IAAI,IAAI,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;EAC5C,IAAI,IAAI,IAAI,GAAG,EAAE,CAAC;EAClB;EACA,IAAI,IAAI,QAAQ,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC;EACtC,IAAI,IAAI,WAAW,GAAG,CAAC,CAAC;EACxB,IAAI,KAAK,CAAC,OAAO,CAAC,UAAU,IAAI,EAAE;EAClC;EACA,QAAQ,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE;EAC7B,YAAY,IAAI,CAAC,QAAQ,GAAG,SAAS,GAAG,WAAW,EAAE,CAAC;EACtD,SAAS;EACT,QAAQ,IAAI,OAAO,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC;EACtC,QAAQ,QAAQ,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;EAChC,KAAK,CAAC,CAAC;EACP;EACA,IAAI,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;EAC9B,QAAQ,IAAI,CAAC,CAAC,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;EACtC,YAAY,OAAO,CAAC,CAAC,SAAS,CAAC;EAC/B,SAAS;EACT,KAAK,CAAC,CAAC;EACP;EACA,IAAI,IAAI,OAAO,GAAG,CAAC,CAAC;EACpB,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;EAC1C,QAAQ,IAAI,CAAC,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;EACxB,QAAQ,IAAI,CAAC,CAAC,CAAC,SAAS,IAAI,EAAE,EAAE,MAAM,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,MAAM,EAAE;EAC3D,YAAY,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,EAAE,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;EAC5D,SAAS;EACT,KAAK;EACL;EACA,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,MAAM,GAAG,IAAI,EAAE,EAAE,GAAG,MAAM,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC9D,QAAQ,IAAI,CAAC,GAAG,MAAM,CAAC,EAAE,CAAC,CAAC;EAC3B,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC,SAAS,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACvE,YAAY,IAAI,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC3B,YAAY,IAAI,CAAC,CAAC,IAAI,KAAK,QAAQ,EAAE;EACrC,gBAAgB,CAAC,CAAC,IAAI,GAAG,aAAa,CAAC,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,SAAS,EAAE,CAAC;EACvE,aAAa;EACb,SAAS;EACT,KAAK;EACL;EACA,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,MAAM,GAAG,IAAI,EAAE,EAAE,GAAG,MAAM,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC9D,QAAQ,IAAI,CAAC,GAAG,MAAM,CAAC,EAAE,CAAC,CAAC;EAC3B,QAAQ,IAAI,CAAC,CAAC,IAAI,IAAI,QAAQ,EAAE;EAChC,YAAY,CAAC,CAAC,MAAM,GAAG,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;EACxC,SAAS;EACT,KAAK;EACL,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;;EC9NM,SAAS,sBAAsB,CAAC,KAAK,EAAE,QAAQ,EAAE;EACxD,IAAI,OAAO,eAAe,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;EAC5C,CAAC;AACD,EAAO,SAAS,yBAAyB,CAAC,QAAQ,EAAE,QAAQ,EAAE;EAC9D,IAAI,OAAO,eAAe,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;EAC/C,CAAC;EACD;EACA;EACA;EACA,SAAS,aAAa,CAAC,CAAC,EAAE,QAAQ,EAAE;EACpC,IAAI,IAAI,WAAW,CAAC,CAAC,CAAC,KAAK,CAAC,EAAE;EAC9B,QAAQ,IAAI,CAAC,CAAC,KAAK,CAAC,MAAM,IAAI,QAAQ,EAAE;EACxC;EACA,YAAY,OAAOA,QAAgB,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;EAChF,SAAS;EACT,aAAa;EACb,YAAYQ,IAAQ,CAACC,OAAW,CAAC,mBAAmB,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;EACtE,YAAY,OAAO,SAAS,CAAC;EAC7B,SAAS;EACT,KAAK;EACL,IAAI,OAAO,CAAC,CAAC;EACb,CAAC;EACD;EACA;EACA;EACA,SAAS,yBAAyB,CAAC,QAAQ,EAAE,QAAQ,EAAE;EACvD,IAAI,QAAQ,GAAG,aAAa,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;EACjD,IAAI,IAAI,QAAQ,KAAK,SAAS,EAAE;EAChC;EACA,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK;EACL,IAAI,IAAI,QAAQ,CAAC,IAAI,IAAI,WAAW,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;EACrD,QAAQ,IAAI,IAAI,GAAG,aAAa,CAAC,QAAQ,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;EAC1D,QAAQ,QAAQ,GAAGT,QAAgB,CAAC,EAAE,EAAE,QAAQ,GAAG,IAAI,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,EAAE,CAAC;EAChF,KAAK;EACL,IAAI,OAAO,QAAQ,CAAC;EACpB,CAAC;EACD,SAAS,2BAA2B,CAAC,UAAU,EAAE,QAAQ,EAAE;EAC3D,IAAI,IAAI,UAAU,CAAC,UAAU,CAAC,EAAE;EAChC,QAAQ,IAAI,EAAE,GAAG,yBAAyB,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;EACjE,QAAQ,IAAI,EAAE,EAAE;EAChB,YAAY,OAAO,EAAE,CAAC;EACtB,SAAS;EACT,aAAa,IAAI,gBAAgB,CAAC,UAAU,CAAC,EAAE;EAC/C,YAAY,OAAO,EAAE,SAAS,EAAE,UAAU,CAAC,SAAS,EAAE,CAAC;EACvD,SAAS;EACT,KAAK;EACL,SAAS;EACT,QAAQ,IAAI,sBAAsB,CAAC,UAAU,CAAC,EAAE;EAChD,YAAY,IAAI,EAAE,GAAG,yBAAyB,CAAC,UAAU,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;EAC/E,YAAY,IAAI,EAAE,EAAE;EACpB,gBAAgB,OAAOA,QAAgB,CAAC,EAAE,EAAE,UAAU,EAAE,EAAE,SAAS,EAAE,EAAE,EAAE,CAAC,CAAC;EAC3E,aAAa;EACb,iBAAiB;EACjB,gBAAgB,IAAI,SAAS,GAAG,UAAU,CAAC,SAAS,EAAE,0BAA0B,GAAGK,MAAc,CAAC,UAAU,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC;EAC7H,gBAAgB,OAAO,0BAA0B,CAAC;EAClD,aAAa;EACb,SAAS;EACT,QAAQ,OAAO,UAAU,CAAC;EAC1B,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;EACD,SAAS,eAAe,CAAC,OAAO,EAAE,QAAQ,EAAE;EAC5C,IAAI,IAAI,GAAG,GAAG,EAAE,CAAC;EACjB,IAAI,KAAK,IAAI,OAAO,IAAI,OAAO,EAAE;EACjC,QAAQ,IAAI,OAAO,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE;EAC7C,YAAY,IAAI,UAAU,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;EAC9C,YAAY,IAAI,OAAO,CAAC,UAAU,CAAC,EAAE;EACrC;EACA,gBAAgB,GAAG,CAAC,OAAO,CAAC,GAAG,UAAU,CAAC,GAAG,CAAC,UAAU,EAAE,EAAE,EAAE,OAAO,2BAA2B,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC,EAAE,CAAC;EAClH,qBAAqB,MAAM,CAAC,UAAU,EAAE,EAAE,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;EAC1D,aAAa;EACb,iBAAiB;EACjB,gBAAgB,IAAI,EAAE,GAAG,2BAA2B,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;EAC3E,gBAAgB,IAAI,EAAE,EAAE;EACxB,oBAAoB,GAAG,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;EACtC,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,KAAK;EACL,IAAI,OAAO,GAAG,CAAC;EACf,CAAC;;ECpED,IAAI,UAAU,kBAAkB,UAAU,MAAM,EAAE;EAClD,IAAI6B,SAAiB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;EAC1C,IAAI,SAAS,UAAU,CAAC,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,QAAQ,EAAE,MAAM,EAAE;EACzE,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,MAAM,EAAE,QAAQ,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,IAAI,CAAC;EAC7G,QAAQ,KAAK,CAAC,IAAI,GAAG,OAAO,CAAC;EAC7B,QAAQ,KAAK,CAAC,KAAK,GAAG,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;EAC/G,QAAQ,KAAK,CAAC,QAAQ,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;EACvC,QAAQ,IAAI,KAAK,GAAG,sBAAsB,CAAC,IAAI,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;EACjE,QAAQ,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;EAC7C,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,UAAU,CAAC,SAAS,CAAC,SAAS,GAAG,UAAU,KAAK,EAAE;EACtD;EACA,QAAQ,OAAO,MAAM,CAAC,KAAK,EAAE,UAAU,eAAe,EAAE,QAAQ,EAAE,OAAO,EAAE;EAC3E,YAAY,IAAI,CAAC,QAAQ,CAAC,CAAC,GAAG,EAAE,MAAM,CAAC,EAAE,OAAO,CAAC,EAAE;EACnD;EACA,gBAAgB1B,IAAQ,CAACC,OAAW,CAAC,mBAAmB,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC;EAC5E,gBAAgB,OAAO,eAAe,CAAC;EACvC,aAAa;EACb,YAAY,IAAI,QAAQ,CAAC,KAAK,KAAK,SAAS,EAAE;EAC9C,gBAAgBD,IAAQ,CAACC,OAAW,CAAC,aAAa,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC;EACvE,gBAAgB,OAAO,eAAe,CAAC;EACvC,aAAa;EACb;EACA,YAAY,eAAe,CAAC,OAAO,CAAC,GAAG,SAAS,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;EACpE,YAAY,OAAO,eAAe,CAAC;EACnC,SAAS,EAAE,EAAE,CAAC,CAAC;EACf,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,eAAe,GAAG,UAAU,OAAO,EAAE;EAC9D,QAAQ,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;EACrC,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,QAAQ,GAAG,UAAU,OAAO,EAAE;EACvD,QAAQ,OAAO,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;EACnC,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,SAAS,GAAG,YAAY;EACjD,QAAQ,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC;EAC9C,QAAQ,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,CAAC;EAC/B,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,eAAe,GAAG,YAAY;EACvD,QAAQ,uBAAuB,CAAC,IAAI,CAAC,CAAC;EACtC,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACtD;EACA;EACA;EACA,QAAQ,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC;EACpC,QAAQ,IAAI,CAAC,SAAS,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC;EAClE,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACtD,QAAQ,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC;EACpC,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,kBAAkB,GAAG,YAAY;EAC1D,QAAQ,IAAI,CAAC,KAAK,CAAC,kBAAkB,EAAE,CAAC;EACxC,QAAQ,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;EACnC,QAAQ,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;EAChC,QAAQ,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC;EACjC,QAAQ,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC;EACjC,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,WAAW,GAAG,UAAU,OAAO,EAAE;EAC1D,QAAQ,IAAI,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,EAAE;EAC3C,YAAY,IAAI,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;EAC/C,YAAY,IAAI,MAAM,GAAG,QAAQ,CAAC,MAAM,IAAI,EAAE,CAAC;EAC/C,YAAY,IAAIY,QAAK,GAAG,QAAQ,CAAC,KAAK,KAAK,SAAS,GAAG,QAAQ,CAAC,KAAK;EACrE,gBAAgB,MAAM,CAAC,KAAK,KAAK,SAAS,GAAG,MAAM,CAAC,KAAK,GAAGC,KAAa,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;EACjG,YAAY,IAAI,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,KAAK,EAAE;EACnE;EACA,gBAAgBD,QAAK,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,KAAK,CAAC;EACnF,gBAAgB,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC;EACzE,aAAa;EACb,YAAY,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,OAAO,CAAC,GAAG;EACpD,gBAAgB,KAAK,EAAEA,QAAK;EAC5B,gBAAgB,aAAa,EAAE,QAAQ;EACvC;EACA,gBAAgB,MAAM,EAAE,CAAC,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;EACjE,aAAa,CAAC;EACd,SAAS;EACT,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,mBAAmB,GAAG,UAAU,OAAO,EAAE,MAAM,EAAE;EAC1E,QAAQ,IAAI,QAAQ,GAAG,OAAO,KAAK,KAAK,GAAG,QAAQ,GAAG,OAAO,CAAC;EAC9D,QAAQ,OAAO;EACf,YAAY,MAAM,EAAE,MAAM;EAC1B,YAAY,UAAU,EAAE,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,QAAQ,CAAC,GAAG,SAAS;EACzH,YAAY,IAAI,EAAE,EAAE;EACpB,SAAS,CAAC;EACV,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,cAAc,GAAG,UAAU,OAAO,EAAE;EAC7D,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;EAC/B,QAAQ,IAAI,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;EAC3C,YAAY,IAAI,EAAE,GAAG,IAAI,CAAC,SAAS,EAAE,aAAa,GAAG,EAAE,CAAC,aAAa,EAAE,OAAO,GAAG,EAAE,CAAC,OAAO,CAAC;EAC5F,YAAY,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,iBAAiB,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;EACxE,YAAY,IAAI,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,QAAQ,EAAE;EACpD;EACA,gBAAgB,IAAI,aAAa,GAAG,OAAO,KAAK,GAAG,GAAG,QAAQ,GAAG,KAAK,CAAC;EACvE,gBAAgB,IAAI,YAAY,GAAG,aAAa,CAAC,aAAa,CAAC,CAAC;EAChE,gBAAgB,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC3F,oBAAoB,IAAI,aAAa,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/C,oBAAoB,IAAI,UAAU,GAAG,aAAa,CAAC,aAAa,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC;EAChF,oBAAoB,YAAY,CAAC,UAAU,CAAC,GAAG,YAAY,CAAC,UAAU,CAAC;EACvE,wBAAwB,CAAC,IAAI,CAAC,mBAAmB,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC,CAAC;EACzE,oBAAoB,IAAI,QAAQ,GAAG,YAAY,CAAC,aAAa,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC,CAAC;EACtG;EACA,oBAAoB,YAAY,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;EACpE,oBAAoB,aAAa,CAAC,aAAa,GAAG,IAAI,CAAC;EACvD,iBAAiB;EACjB,aAAa,AAGA;EACb,SAAS;EACT,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,gCAAgC,GAAG,UAAU,OAAO,EAAE;EAC/E,QAAQ,OAAO,IAAI,CAAC,KAAK,CAAC,gCAAgC,CAAC,OAAO,CAAC,CAAC;EACpE,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,wBAAwB,GAAG,YAAY;EAChE,QAAQ,IAAI,CAAC,KAAK,CAAC,wBAAwB,EAAE,CAAC;EAC9C,QAAQ,OAAO,EAAE,CAAC;EAClB,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,qBAAqB,GAAG,UAAU,IAAI,EAAE;EACjE,QAAQ,OAAO,IAAI,CAAC,KAAK,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;EACtD,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,mBAAmB,GAAG,UAAU,UAAU,EAAE;EACrE,QAAQ,IAAI,UAAU,GAAG,EAAE,CAAC;EAC5B,QAAQ,IAAI,QAAQ,GAAG,UAAU,KAAK,QAAQ,GAAG,YAAY,GAAG,YAAY,CAAC;EAC7E,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC,KAAK,EAAE,QAAQ,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACvE,YAAY,IAAI,OAAO,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EACjC,YAAY,IAAI,qBAAqB,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;EAC9E,YAAY,IAAI,eAAe,GAAG,qBAAqB,CAAC,UAAU,CAAC,CAAC;EACpE,YAAY,IAAI,eAAe,IAAI,eAAe,CAAC,CAAC,CAAC,EAAE;EACvD,gBAAgB,IAAI,QAAQ,GAAG,OAAO,KAAK,KAAK,GAAG,QAAQ,GAAG,OAAO,CAAC;EACtE,gBAAgB,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE;EACpE;EACA,oBAAoB,UAAU,CAAC,QAAQ,CAAC,GAAG,UAAU,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;EACtE,oBAAoB,UAAU,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,GAAG,GAAG,CAAC;EACxD,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,QAAQ,OAAO,UAAU,CAAC;EAC1B,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACtD,QAAQ,IAAI,OAAO,GAAG,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC,oBAAoB,EAAE,GAAG,CAAC,CAAC;EACvF;EACA,QAAQ,OAAOrB,QAAgB,CAAC,EAAE,OAAO,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,EAAE,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,EAAE;EAC9I;EACA,YAAY,MAAM,EAAE,EAAE,EAAE,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;EAC1E,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,qBAAqB,GAAG,YAAY;EAC7D;EACA,QAAQ,OAAO,IAAI,CAAC,KAAK,CAAC,qBAAqB,EAAE,CAAC;EAClD,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,oBAAoB,GAAG,YAAY;EAC5D,QAAQ,IAAI,IAAI,CAAC,MAAM,KAAK,IAAI,CAAC,MAAM,YAAY,UAAU,CAAC,EAAE;EAChE;EACA;EACA;EACA,YAAY,OAAO,SAAS,CAAC;EAC7B,SAAS;EACT,aAAa;EACb;EACA,YAAY,IAAI,mBAAmB,GAAG,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC;EACpE,YAAY,OAAO,EAAE,MAAM,EAAE,eAAe,GAAG,mBAAmB,GAAG,KAAK,EAAE,CAAC;EAC7E,SAAS;EACT,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,aAAa,GAAG,UAAU,OAAO,EAAE;EAC5D,QAAQ,IAAI,IAAI,CAAC,MAAM,KAAK,IAAI,CAAC,MAAM,YAAY,UAAU,CAAC,EAAE;EAChE;EACA;EACA;EACA,YAAY,OAAOA,QAAgB,CAAC,EAAE,GAAG,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,GAAG;EAC1E,gBAAgB,MAAM,EAAE;EACxB,oBAAoB,MAAM,EAAE;EAC5B;EACA;EACA,wBAAwB,OAAO,EAAE,EAAE,KAAK,EAAE,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,EAAE,MAAM,EAAE,UAAU,EAAE,CAAC,EAAE;EAC9F,qBAAqB;EACrB,iBAAiB;EACjB,aAAa,GAAG,EAAE,GAAG,MAAM,CAAC,SAAS,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC,CAAC;EACzE,SAAS;EACT,QAAQ,OAAO,MAAM,CAAC,SAAS,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;EAClE,KAAK,CAAC;EACN;EACA;EACA;EACA,IAAI,UAAU,CAAC,SAAS,CAAC,+BAA+B,GAAG,YAAY;EACvE,QAAQ,IAAI,MAAM,GAAG,EAAE,CAAC;EACxB,QAAQ,IAAI,GAAG,GAAG,EAAE,CAAC;EACrB,QAAQ,IAAI,IAAI,CAAC,KAAK,YAAY,UAAU,EAAE;EAC9C,YAAY,IAAI,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,QAAQ,CAAC,EAAE;EACtD,gBAAgB,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;EAC9D,gBAAgB,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;EACrC,aAAa;EACb,SAAS;EACT,aAAa;EACb,YAAY,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACpE,gBAAgB,IAAI,OAAO,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EACrC,gBAAgB,IAAI,mBAAmB,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;EAC/E,gBAAgB,IAAI,mBAAmB,IAAI,CAAC,mBAAmB,CAAC,MAAM,EAAE;EACxE,oBAAoB,IAAI,IAAI,GAAG,mBAAmB,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAC/D,oBAAoB,IAAI,KAAK,GAAG,mBAAmB,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;EACjE,oBAAoB,IAAI,iBAAiB,CAAC,IAAI,CAAC,IAAI,aAAa,CAAC,KAAK,CAAC,EAAE;EACzE,wBAAwB,IAAI,MAAM,GAAG,cAAc,CAAC,IAAI,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;EACzE,wBAAwB,IAAI,KAAK,GAAG,kBAAkB,CAAC,MAAM,CAAC,CAAC;EAC/D,wBAAwB,IAAI,KAAK,EAAE;EACnC,4BAA4B,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;EAC/C,4BAA4B,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;EACjD,yBAAyB;EACzB,6BAA6B;EAC7B,4BAA4BQ,IAAQ,CAAC,4DAA4D,CAAC,CAAC;EACnG,yBAAyB;EACzB,qBAAqB;EACrB,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,QAAQ,OAAO,MAAM,CAAC,MAAM,GAAG,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,SAAS,CAAC;EACxE,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,aAAa,GAAG,YAAY;EACrD,QAAQ,IAAI,EAAE,GAAG,IAAI,EAAE,KAAK,GAAG,EAAE,CAAC,KAAK,EAAE,KAAK,GAAG,EAAE,CAAC,KAAK,CAAC;EAC1D,QAAQ,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC;EACtD,QAAQ,IAAI,IAAI,GAAG,iBAAiB,CAAC,SAAS,CAAC,CAAC;EAChD;EACA;EACA,QAAQ,IAAI,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC;EAC/C,QAAQ,IAAI,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;EACrD,QAAQ,IAAI,qBAAqB,GAAG,KAAK,CAAC,kBAAkB,EAAE,CAAC;EAC/D,QAAQ,IAAI,eAAe,GAAG,EAAE,CAAC;EACjC,QAAQ,IAAI,MAAM,IAAI,SAAS,EAAE;EACjC,YAAY,eAAe,CAAC,SAAS,GAAG,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;EACxD,SAAS;EACT,QAAQ,IAAI,4BAA4B,GAAG,IAAI,CAAC,+BAA+B,EAAE,CAAC;EAClF,QAAQ,IAAI,4BAA4B,EAAE;EAC1C,YAAY,eAAe,CAAC,SAAS,GAAGR,QAAgB,CAAC,EAAE,EAAE,eAAe,CAAC,SAAS,EAAE,4BAA4B,CAAC,CAAC;EACtH,SAAS;EACT,QAAQ,IAAIqB,QAAK,GAAG,KAAK,CAAC,aAAa,EAAE,CAAC;EAC1C,QAAQ,IAAI,KAAK,GAAG,KAAK,CAAC,kBAAkB,EAAE,CAAC;EAC/C,QAAQ,IAAI,SAAS,GAAGrB,QAAgB,CAAC,EAAE,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,GAAGqB,QAAK,GAAG,EAAE,KAAK,EAAEA,QAAK,EAAE,GAAG,EAAE,IAAI,KAAK,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE;EAClK,gBAAgB,KAAK,EAAErB,QAAgB,CAAC,EAAE,IAAI,EAAE,SAAS,CAAC,IAAI,EAAE,IAAI,EAAE,SAAS,CAAC,IAAI,EAAE,OAAO,EAAE,EAAE,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,SAAS,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,EAAE,eAAe,CAAC;EACxM,aAAa,EAAE,IAAI,EAAE;EACrB,gBAAgB,KAAK,EAAE,EAAE,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,EAAE,IAAI,EAAE,OAAO,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,SAAS,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC;EACnJ,gBAAgB,KAAK,EAAE,EAAE,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,KAAK,WAAW,CAAC,GAAG,EAAE,EAAE,SAAS,GAAG,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,KAAK,WAAW,CAAC,GAAG,EAAE,CAAC;EACxI,aAAa,EAAE,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,qBAAqB,GAAG,EAAE,MAAM,EAAE,EAAE,MAAM,EAAE,qBAAqB,EAAE,EAAE,GAAG,EAAE,GAAG,KAAK,CAAC,aAAa,EAAE,CAAC,CAAC;EAC/J,QAAQ,OAAO,CAAC,SAAS,CAAC,CAAC;EAC3B,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,UAAU,GAAG,YAAY;EAClD,QAAQ,OAAO,IAAI,CAAC,KAAK,CAAC;EAC1B,KAAK,CAAC;EACN,IAAI,OAAO,UAAU,CAAC;EACtB,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC;;ECpQnB,SAAS,aAAa,CAAC,CAAC,EAAE;EAC1B,IAAI,OAAO,CAAC,KAAK,KAAK,IAAI,CAAC,KAAK,IAAI,CAAC;EACrC,CAAC;EACD,IAAI,aAAa,kBAAkB,UAAU,MAAM,EAAE;EACrD,IAAIkC,SAAiB,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;EAC7C,IAAI,SAAS,aAAa,CAAC,QAAQ,EAAE,QAAQ,EAAE,aAAa,EAAE;EAC9D,QAAQ,IAAI,QAAQ,KAAK,KAAK,CAAC,EAAE,EAAE,QAAQ,GAAG,EAAE,CAAC,EAAE;EACnD,QAAQ,IAAI,QAAQ,KAAK,KAAK,CAAC,EAAE,EAAE,QAAQ,GAAG,EAAE,CAAC,EAAE;EACnD,QAAQ,IAAI,aAAa,KAAK,KAAK,CAAC,EAAE,EAAE,aAAa,GAAG,KAAK,CAAC,EAAE;EAChE,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC;EAC9C,QAAQ,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC;EAClC,QAAQ,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC;EAClC,QAAQ,KAAK,CAAC,aAAa,GAAG,aAAa,CAAC;EAC5C,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,aAAa,CAAC,SAAS,CAAC,KAAK,GAAG,YAAY;EAChD,QAAQ,OAAO,IAAI,aAAa,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;EACzG,KAAK,CAAC;EACN,IAAI,aAAa,CAAC,SAAS,CAAC,WAAW,GAAG,UAAU,IAAI,EAAE;EAC1D;EACA,QAAQ,IAAI,IAAI,KAAK,MAAM,EAAE;EAC7B,YAAY,OAAO,IAAI,CAAC;EACxB,SAAS;EACT,QAAQ,IAAI,IAAI,KAAK,MAAM,IAAI,IAAI,KAAK,OAAO,EAAE;EACjD,YAAY,OAAO,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;EACpC,SAAS;EACT;EACA,QAAQ,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC;EAC9C,KAAK,CAAC;EACN,IAAI,OAAO,aAAa,CAAC;EACzB,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;;ECjCH,SAAS,aAAa,CAAC,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,SAAS,EAAE;EAC5E,IAAI,IAAI,MAAM,KAAK,KAAK,CAAC,EAAE,EAAE,MAAM,GAAG,EAAE,CAAC,EAAE;EAC3C;EACA,IAAI,IAAI,WAAW,GAAG,CAAC,SAAS,KAAK,MAAM,GAAG,CAAC,UAAU,CAAC,GAAG,EAAE,EAAE,MAAM,CAAC;EACxE,QAAQ,OAAO,KAAK,GAAG,GAAG,OAAO,GAAG,OAAO;EAC3C,QAAQ,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;EACrE,QAAQ,MAAM;EACd,KAAK,CAAC,CAAC;EACP,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,aAAa,GAAG,WAAW,EAAE,EAAE,GAAG,aAAa,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACnF,QAAQ,IAAI,UAAU,GAAG,aAAa,CAAC,EAAE,CAAC,CAAC;EAC3C,QAAQ,IAAI,MAAM,CAAC,UAAU,CAAC,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,QAAQ,CAAC,KAAK,SAAS,EAAE;EAC9E,YAAY,OAAO,MAAM,CAAC,UAAU,CAAC,CAAC,QAAQ,CAAC,CAAC;EAChD,SAAS;EACT,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;;ECPM,SAASwC,QAAM,CAAC,KAAK,EAAE,OAAO,EAAE,mBAAmB,EAAE,MAAM,EAAE;EACpE,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC;EAC1C,SAAS,OAAO,KAAK,GAAG,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC;EAC/C,YAAY,OAAO,KAAK,GAAG,GAAG,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC;EAClD,gBAAgB,SAAS,CAAC,CAAC;EAC3B,IAAI,IAAI,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;EACnC,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;EAC9B,IAAI,IAAI,UAAU,GAAG,EAAE,CAAC;EACxB;EACA,IAAI,IAAI,cAAc,CAAC,QAAQ,CAAC,EAAE;EAClC,QAAQ,IAAI,UAAU,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,SAAS,CAAC,GAAG,CAAC;EACxF,QAAQ,IAAI,IAAI,GAAG,oBAAoB,CAAC,aAAa,EAAE,QAAQ,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,EAAE,MAAM,CAAC,IAAI,CAAC,eAAe,EAAE,MAAM,CAAC,UAAU,EAAE,UAAU,CAAC,CAAC;EACnJ,QAAQ,IAAI,IAAI,EAAE;EAClB,YAAY,UAAU,CAAC,IAAI,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC;EAC/C,SAAS;EACT,KAAK;EACL;EACA,IAAI,IAAI,KAAK,GAAG,aAAa,CAAC,YAAY,EAAE,KAAK,CAAC,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC;EACzH,IAAI,IAAI,KAAK,KAAK,SAAS,EAAE;EAC7B,QAAQ,KAAK,GAAG,UAAU,CAAC,IAAI,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;EACpD,QAAQ,IAAI,KAAK,EAAE;EACnB,YAAY,UAAU,CAAC,KAAK,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;EAChD,SAAS;EACT,KAAK;EACL,IAAI,IAAI,KAAK,KAAK,SAAS,EAAE;EAC7B,QAAQ,IAAI,KAAK,GAAGC,YAAU,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;EAC9C,QAAQ,IAAI,KAAK,EAAE;EACnB,YAAY,UAAU,CAAC,KAAK,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;EAChD,SAAS;EACT,QAAQ,UAAU,CAAC,QAAQ,GAAGC,eAAa,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;EAC3D,KAAK;EACL,IAAI,UAAU,GAAG5E,QAAgB,CAAC,EAAE,EAAE,UAAU,EAAE,mBAAmB,CAAC,CAAC;EACvE,IAAI,OAAO,IAAI,CAAC,UAAU,CAAC,CAAC,MAAM,KAAK,CAAC,GAAG,SAAS,GAAG,UAAU,CAAC;EAClE,CAAC;AACD,EAAO,SAAS4E,eAAa,CAAC,KAAK,EAAE,MAAM,EAAE;EAC7C,IAAI,IAAI,MAAM,KAAK,KAAK,IAAI,MAAM,KAAK,QAAQ,EAAE;EACjD,QAAQ,IAAI,KAAK,IAAI,EAAE,IAAI,GAAG,IAAI,KAAK,EAAE;EACzC,YAAY,OAAO,EAAE,KAAK,EAAE,MAAM,KAAK,KAAK,GAAG,QAAQ,GAAG,KAAK,EAAE,CAAC;EAClE,SAAS;EACT,aAAa,IAAI,GAAG,IAAI,KAAK,IAAI,KAAK,IAAI,GAAG,EAAE;EAC/C,YAAY,OAAO,EAAE,KAAK,EAAE,MAAM,KAAK,KAAK,GAAG,KAAK,GAAG,QAAQ,EAAE,CAAC;EAClE,SAAS;EACT,aAAa;EACb,YAAY,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC;EACvC,SAAS;EACT,KAAK;EACL,SAAS;EACT,QAAQ,IAAI,CAAC,KAAK,IAAI,EAAE,IAAI,GAAG,IAAI,KAAK,MAAM,GAAG,IAAI,KAAK,IAAI,KAAK,IAAI,GAAG,CAAC,EAAE;EAC7E,YAAY,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC;EACvC,SAAS;EACT,aAAa,IAAI,EAAE,IAAI,KAAK,IAAI,KAAK,IAAI,GAAG,EAAE;EAC9C,YAAY,OAAO,EAAE,KAAK,EAAE,MAAM,KAAK,MAAM,GAAG,KAAK,GAAG,QAAQ,EAAE,CAAC;EACnE,SAAS;EACT,aAAa;EACb,YAAY,OAAO,EAAE,KAAK,EAAE,MAAM,KAAK,MAAM,GAAG,QAAQ,GAAG,KAAK,EAAE,CAAC;EACnE,SAAS;EACT,KAAK;EACL,CAAC;AACD,EAAO,SAAS,UAAU,CAAC,IAAI,EAAE,OAAO,EAAE,QAAQ,EAAE;EACpD,IAAI,IAAI,IAAI,CAAC,UAAU,KAAK,SAAS,EAAE;EACvC;EACA,QAAQ,OAAO,CAAC,CAAC,IAAI,CAAC,UAAU,GAAG,GAAG,IAAI,GAAG,IAAI,GAAG,CAAC;EACrD,KAAK;EACL,SAAS;EACT,QAAQ,IAAI,OAAO,KAAK,CAAC,IAAI,QAAQ,CAAC,CAAC,OAAO,EAAE,OAAO,CAAC,EAAE,QAAQ,CAAC,IAAI,CAAC,EAAE;EAC1E,YAAY,OAAO,GAAG,CAAC;EACvB,SAAS;EACT,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;AACD,EAAO,SAASD,YAAU,CAAC,KAAK,EAAE,MAAM,EAAE;EAC1C,IAAI,KAAK,GAAG,CAAC,CAAC,KAAK,GAAG,GAAG,IAAI,GAAG,IAAI,GAAG,CAAC;EACxC,IAAI,IAAI,MAAM,KAAK,KAAK,IAAI,MAAM,KAAK,QAAQ,EAAE;EACjD,QAAQ,IAAI,KAAK,GAAG,GAAG,KAAK,CAAC,EAAE;EAC/B,YAAY,OAAO,QAAQ,CAAC;EAC5B,SAAS;EACT,aAAa,IAAI,CAAC,GAAG,KAAK,IAAI,KAAK,GAAG,GAAG,EAAE;EAC3C,YAAY,OAAO,MAAM,KAAK,KAAK,GAAG,OAAO,GAAG,MAAM,CAAC;EACvD,SAAS;EACT,aAAa;EACb,YAAY,OAAO,MAAM,KAAK,KAAK,GAAG,MAAM,GAAG,OAAO,CAAC;EACvD,SAAS;EACT,KAAK;EACL,SAAS;EACT,QAAQ,IAAI,CAAC,KAAK,GAAG,EAAE,IAAI,GAAG,KAAK,CAAC,EAAE;EACtC,YAAY,OAAO,QAAQ,CAAC;EAC5B,SAAS;EACT,aAAa,IAAI,EAAE,IAAI,KAAK,IAAI,KAAK,GAAG,GAAG,EAAE;EAC7C,YAAY,OAAO,MAAM,KAAK,MAAM,GAAG,MAAM,GAAG,OAAO,CAAC;EACxD,SAAS;EACT,aAAa;EACb,YAAY,OAAO,MAAM,KAAK,MAAM,GAAG,OAAO,GAAG,MAAM,CAAC;EACxD,SAAS;EACT,KAAK;EACL,CAAC;;EC7FD;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,IAAI,CAAC,SAAS,EAAE,QAAQ,EAAE;EAC1C,IAAI,OAAO,CAAC,iBAAiB,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC;EAC1D,CAAC;AACD,EAAO,SAAS,SAAS,CAAC,KAAK,EAAE,OAAO,EAAE;EAC1C,IAAI,IAAI,WAAW,GAAG,OAAO,KAAK,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC;EAClD,IAAI,IAAI,KAAK,CAAC,iBAAiB,CAAC,WAAW,CAAC,EAAE;EAC9C,QAAQ,OAAO,KAAK,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;EAC5C,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;AACD,EAAO,SAAS,UAAU,CAAC,QAAQ,EAAE,OAAO,EAAE,aAAa,EAAE;EAC7D,IAAI,IAAI,aAAa,CAAC,UAAU,KAAK,SAAS,EAAE;EAChD,QAAQ,OAAO,aAAa,CAAC,UAAU,CAAC;EACxC,KAAK;EACL,IAAI,IAAI,OAAO,KAAK,GAAG,IAAI,QAAQ,CAAC,CAAC,cAAc,EAAE,UAAU,CAAC,EAAE,QAAQ,CAAC,IAAI,CAAC,EAAE;EAClF,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;AACD,EAAO,SAAS,YAAY,CAAC,QAAQ,EAAE,aAAa,EAAE,OAAO,EAAE,SAAS,EAAE;EAC1E,IAAI,IAAI,aAAa,CAAC,YAAY,KAAK,SAAS,EAAE;EAClD,QAAQ,OAAO,aAAa,CAAC,YAAY,CAAC;EAC1C,KAAK;EACL;EACA,IAAI,IAAI,QAAQ,CAAC,IAAI,KAAK,SAAS,EAAE;EACrC,QAAQ,IAAI,SAAS,KAAK,KAAK,EAAE;EACjC,YAAY,OAAO,QAAQ,CAAC;EAC5B,SAAS;EACT,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;AACD,EAAO,SAAS,MAAM,CAAC,OAAO,EAAE;EAChC,IAAI,QAAQ,OAAO;EACnB,QAAQ,KAAK,CAAC;EACd,YAAY,OAAO,QAAQ,CAAC;EAC5B,QAAQ,KAAK,CAAC;EACd,YAAY,OAAO,MAAM,CAAC;EAC1B,KAAK;EACL;EACA,IAAI,MAAM,IAAI,KAAK,CAAClE,OAAW,CAAC,wBAAwB,CAAC,CAAC;EAC1D,CAAC;AACD,EAAO,SAAS,SAAS,CAAC,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,IAAI,EAAE;EAC9D,IAAI,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,IAAI,SAAS,KAAK,KAAK,IAAI,CAAC,QAAQ,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,SAAS,CAAC,EAAE,QAAQ,CAAC,QAAQ,CAAC,EAAE;EACpI,QAAQ,IAAI,QAAQ,CAAC,GAAG,EAAE;EAC1B;EACA,YAAY,OAAO,EAAE,MAAM,EAAE,OAAO,GAAG,IAAI,CAAC,MAAM,GAAG,MAAM,EAAE,CAAC;EAC9D,SAAS;EACT,QAAQ,OAAO,EAAE,MAAM,EAAE,OAAO,GAAG,IAAI,CAAC,MAAM,GAAG,MAAM,EAAE,CAAC;EAC1D,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;AACD,EAKO,SAASoE,QAAM,CAAC,aAAa,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE;EAChE,IAAI,IAAIzC,OAAI,GAAG,aAAa,CAAC,MAAM,CAAC;EACpC,IAAI,IAAI,aAAa,CAAC,MAAM,IAAI,UAAU,CAACA,OAAI,CAAC,CAAC,CAAC,CAAC,EAAE;EACrD,QAAQ,OAAOA,OAAI,CAAC,GAAG,CAAC,UAAU,EAAE,EAAE;EACtC;EACA,YAAY,OAAO,EAAE,MAAM,EAAE,YAAY,CAAC,EAAE,EAAE,IAAI,CAAC,EAAE,CAAC;EACtD,SAAS,CAAC,CAAC;EACX,KAAK;EACL,IAAI,IAAI,CAACA,OAAI,IAAI,QAAQ,CAAC,GAAG,IAAI,QAAQ,CAAC,IAAI,KAAK,YAAY,EAAE;EACjE,QAAQ,IAAI,MAAM,GAAG,KAAK,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;EAChD,QAAQ,IAAI,MAAM,IAAI,MAAM,KAAK,cAAc,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,EAAE;EAC/E,YAAY,OAAOA,OAAI,CAAC;EACxB,SAAS;EACT,QAAQ,IAAI,MAAM,GAAG,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,GAAG,GAAG,QAAQ,CAAC,KAAK,GAAG,OAAO,CAAC,CAAC;EAC/F,QAAQ,OAAO,EAAE,MAAM,EAAE,WAAW,GAAG,MAAM,GAAG,UAAU,GAAG,MAAM,GAAG,UAAU,GAAG,MAAM,GAAG,SAAS,GAAG,MAAM,GAAG,QAAQ,EAAE,CAAC;EAC5H,KAAK;EACL,IAAI,OAAOA,OAAI,CAAC;EAChB,CAAC;;EC7EM,SAAS,aAAa,CAAC,KAAK,EAAE;EACrC,IAAI,OAAO,uBAAuB,CAAC,MAAM,CAAC,UAAU,IAAI,EAAE,OAAO,EAAE;EACnE,QAAQ,IAAI,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;EACpE,YAAY,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC,CAAC;EACxD,SAAS;EACT,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK,EAAE,EAAE,CAAC,CAAC;EACX,CAAC;EACD,IAAI,eAAe,GAAG;EACtB,IAAI,MAAM,EAAE,KAAK;EACjB,IAAI,GAAG,EAAE,QAAQ;EACjB,IAAI,IAAI,EAAE,OAAO;EACjB,IAAI,KAAK,EAAE,MAAM;EACjB,CAAC,CAAC;AACF,EAAO,SAAS,cAAc,CAAC,KAAK,EAAE;EACtC,IAAI,IAAI,EAAE,GAAG,KAAK,CAAC,SAAS,EAAE,IAAI,GAAG,EAAE,CAAC,IAAI,EAAE,OAAO,GAAG,EAAE,CAAC,OAAO,CAAC;EACnE,IAAI,IAAI,SAAS,GAAG,EAAE,GAAG,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,CAAC;EAC7D,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAChE,QAAQ,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC3B,QAAQ,KAAK,CAAC,kBAAkB,EAAE,CAAC;EACnC,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAChF,YAAY,IAAI,OAAO,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EACjC,YAAY,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,iBAAiB,CAAC,KAAK,CAAC,SAAS,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;EACxF,YAAY,IAAI,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,QAAQ,EAAE;EACpD;EACA;EACA,gBAAgB,IAAI,CAAC,OAAO,CAAC,GAAG,mBAAmB,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;EAClG,gBAAgB,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;EACpC;EACA;EACA,oBAAoB,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,aAAa,CAAC;EAC1D,oBAAoB,OAAO,IAAI,CAAC,OAAO,CAAC,CAAC;EACzC,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,KAAK;EACL;EACA,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACxD,QAAQ,IAAI,OAAO,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC7B,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACpE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;EAChD;EACA,gBAAgB,SAAS;EACzB,aAAa;EACb,YAAY,IAAI,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,aAAa,EAAE;EACzD;EACA,gBAAgB,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;EAC5F;EACA,gBAAgB,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC3F,oBAAoB,IAAI,aAAa,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/C,oBAAoB,IAAI,EAAE,GAAG,aAAa,CAAC,eAAe,CAAC,QAAQ,CAAC,EAAE0C,SAAM,GAAG,EAAE,CAAC,KAAK,EAAE,QAAQ,GAAG,EAAE,CAAC,QAAQ,CAAC;EAChH,oBAAoB,IAAI,SAAS,CAACA,SAAM,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,EAAE;EAC5D;EACA,wBAAwB,IAAI,cAAc,GAAG,eAAe,CAACA,SAAM,CAAC,CAAC;EACrE,wBAAwB,IAAI,SAAS,CAACA,SAAM,CAAC,GAAG,SAAS,CAAC,cAAc,CAAC,EAAE;EAC3E,4BAA4B,aAAa,CAAC,GAAG,CAAC,QAAQ,EAAE,cAAc,EAAE,KAAK,CAAC,CAAC;EAC/E,yBAAyB;EACzB,qBAAqB;EACrB,oBAAoB,SAAS,CAACA,SAAM,CAAC,EAAE,CAAC;EACxC;EACA,iBAAiB;EACjB,aAAa;EACb;EACA,YAAY,OAAO,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;EACjD,SAAS;EACT,KAAK;EACL,CAAC;EACD,SAAS,mBAAmB,CAAC,eAAe,EAAE,cAAc,EAAE;EAC9D,IAAI,IAAI,eAAe,EAAE;EACzB;EACA,QAAQ,IAAI,eAAe,CAAC,MAAM,KAAK,cAAc,CAAC,MAAM,EAAE;EAC9D,YAAY,OAAO,SAAS,CAAC;EAC7B,SAAS;EACT,QAAQ,IAAI,QAAQ,GAAG,eAAe,CAAC,MAAM,CAAC;EAC9C,QAAQ,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,QAAQ,EAAE,CAAC,EAAE,EAAE;EAC3C,YAAY,IAAI,MAAM,GAAG,eAAe,CAAC,CAAC,CAAC,CAAC;EAC5C,YAAY,IAAI,KAAK,GAAG,cAAc,CAAC,CAAC,CAAC,CAAC;EAC1C,YAAY,IAAI,CAAC,CAAC,CAAC,MAAM,OAAO,CAAC,CAAC,KAAK,CAAC,EAAE;EAC1C,gBAAgB,OAAO,SAAS,CAAC;EACjC,aAAa;EACb,iBAAiB,IAAI,MAAM,IAAI,KAAK,EAAE;EACtC,gBAAgB,IAAI,YAAY,GAAG,MAAM,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;EACpE,gBAAgB,IAAI,WAAW,GAAG,KAAK,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;EAClE,gBAAgB,IAAI,YAAY,CAAC,QAAQ,IAAI,WAAW,CAAC,QAAQ,IAAI,YAAY,CAAC,KAAK,KAAK,WAAW,CAAC,KAAK,EAAE;EAC/G;EACA;EACA,oBAAoB,OAAO,SAAS,CAAC;EACrC,iBAAiB;EACjB,qBAAqB;EACrB,oBAAoB,eAAe,CAAC,CAAC,CAAC,GAAG,kBAAkB,CAAC,MAAM,EAAE,KAAK,CAAC,CAAC;EAC3E,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT,KAAK;EACL,SAAS;EACT;EACA,QAAQ,OAAO,cAAc,CAAC,GAAG,CAAC,UAAU,aAAa,EAAE,EAAE,OAAO,aAAa,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;EAC9F,KAAK;EACL,IAAI,OAAO,eAAe,CAAC;EAC3B,CAAC;EACD,SAAS,kBAAkB,CAAC,MAAM,EAAE,KAAK,EAAE;EAC3C,IAAI,IAAI,OAAO,GAAG,UAAU,IAAI,EAAE;EAClC,QAAQ,IAAI,uBAAuB,GAAG,uBAAuB,CAAC,MAAM,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,MAAM;EACrI;EACA,QAAQ,UAAU,EAAE,EAAE,EAAE,EAAE;EAC1B,YAAY,QAAQ,IAAI;EACxB,gBAAgB,KAAK,OAAO;EAC5B,oBAAoB,OAAO,mBAAmB,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;EACvD,gBAAgB,KAAK,WAAW;EAChC,oBAAoB,OAAO;EAC3B,wBAAwB,QAAQ,EAAE,EAAE,CAAC,QAAQ;EAC7C,wBAAwB,KAAK,EAAE,EAAE,CAAC,KAAK,IAAI,EAAE,CAAC,KAAK;EACnD,qBAAqB,CAAC;EACtB,aAAa;EACb,YAAY,OAAO,iBAAiB,CAAC,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;EAC3D,SAAS,CAAC,CAAC;EACX,QAAQ,MAAM,CAAC,eAAe,CAAC,IAAI,EAAE,uBAAuB,CAAC,CAAC;EAC9D,KAAK,CAAC;EACN,IAAI,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,oBAAoB,GAAG,kBAAkB,EAAE,EAAE,GAAG,oBAAoB,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACxG,QAAQ,IAAI,IAAI,GAAG,oBAAoB,CAAC,EAAE,CAAC,CAAC;EAC5C,QAAQ,OAAO,CAAC,IAAI,CAAC,CAAC;EACtB,KAAK;EACL,IAAI,OAAO,MAAM,CAAC;EAClB,CAAC;EACD,SAAS,gBAAgB,CAAC,KAAK,EAAE,OAAO,EAAE;EAC1C,IAAI,IAAI,QAAQ,GAAG,OAAO,KAAK,GAAG,GAAG,IAAI,GAAG,IAAI,CAAC;EACjD,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC3C,IAAI,IAAI,SAAS,GAAG,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;EAC7C,IAAI,IAAI,MAAM,GAAG,QAAQ,GAAG,QAAQ,CAAC,KAAK,GAAG,SAAS,CAAC;EACvD,IAAI,IAAI,MAAM,GAAG,SAAS,GAAG,SAAS,CAAC,KAAK,GAAG,SAAS,CAAC;EACzD,IAAI,IAAI,MAAM,IAAI,MAAM,EAAE;EAC1B,QAAQ,OAAO,UAAU,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;EAC1C,KAAK;EACL,SAAS,IAAI,MAAM,EAAE;EACrB,QAAQ,OAAO,MAAM,CAAC;EACtB,KAAK;EACL,SAAS,IAAI,MAAM,EAAE;EACrB,QAAQ,OAAO,MAAM,CAAC;EACtB,KAAK;EACL,SAAS,IAAI,MAAM,KAAK,SAAS,EAAE;EACnC,QAAQ,OAAO,MAAM,CAAC;EACtB,KAAK;EACL,SAAS,IAAI,MAAM,KAAK,SAAS,EAAE;EACnC,QAAQ,OAAO,MAAM,CAAC;EACtB,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;EACD,SAAS,SAAS,CAAC,OAAO,EAAE,KAAK,EAAE;EACnC,IAAI,IAAI,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;EACnC,IAAI,IAAI,aAAa,GAAG,IAAI,aAAa,EAAE,CAAC;EAC5C;EACA,IAAI,kBAAkB,CAAC,OAAO,CAAC,UAAU,QAAQ,EAAE;EACnD,QAAQ,IAAI,KAAK,GAAGC,aAAW,CAAC,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,CAAC,CAAC;EAChE,QAAQ,IAAI,KAAK,KAAK,SAAS,EAAE;EACjC,YAAY,IAAI,QAAQ;EACxB;EACA,YAAY,QAAQ,KAAK,QAAQ,GAAG,CAAC,CAAC,IAAI,CAAC,MAAM;EACjD;EACA,gBAAgB,QAAQ,KAAK,QAAQ,GAAG,CAAC,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAC,CAAC,IAAI,CAAC,UAAU;EAC5E;EACA,oBAAoB,QAAQ,KAAK,OAAO,IAAI,KAAK,KAAK,gBAAgB,CAAC,KAAK,EAAE,OAAO,CAAC,GAAG,IAAI;EAC7F;EACA,wBAAwB,KAAK,KAAK,IAAI,CAAC,QAAQ,CAAC,CAAC;EACjD,YAAY,IAAI,WAAW,GAAG,aAAa,CAAC,QAAQ,EAAE,KAAK,CAAC,MAAM,EAAE,OAAO,EAAE,aAAa,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC;EACxJ;EACA,YAAY,IAAI,QAAQ,IAAI,WAAW,KAAK,SAAS,EAAE;EACvD;EACA,gBAAgB,aAAa,CAAC,GAAG,CAAC,QAAQ,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAC;EAC7D,aAAa;EACb,iBAAiB,IAAI,QAAQ,KAAK,MAAM,IAAI,WAAW,EAAE;EACzD;EACA,gBAAgB,aAAa,CAAC,GAAG,CAAC,QAAQ,EAAE,WAAW,EAAE,KAAK,CAAC,CAAC;EAChE,aAAa;EACb,SAAS;EACT,KAAK,CAAC,CAAC;EACP;EACA,IAAI,IAAI,YAAY,GAAG,IAAI,CAAC,QAAQ,IAAI,EAAE,CAAC;EAC3C,IAAI,IAAI,UAAU,GAAG,UAAU,CAAC,MAAM,CAAC,UAAU,CAAC,EAAE,IAAI,EAAE;EAC1D,QAAQ,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE;EAC9C;EACA,YAAY,OAAO,CAAC,CAAC;EACrB,SAAS;EACT,QAAQ,IAAI,gBAAgB,GAAG,gBAAgB,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,KAAK,CAAC,CAAC;EACjF,QAAQ,IAAI,KAAK,GAAG,IAAI,KAAK,QAAQ;EACrC,YAAYC,QAAa,CAAC,KAAK,EAAE,OAAO,EAAE,gBAAgB,EAAE,aAAa,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;EACxF,YAAY,gBAAgB,CAAC;EAC7B,QAAQ,IAAI,KAAK,KAAK,SAAS,IAAI,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;EAC3D,YAAY,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,MAAM,EAAE,KAAK,EAAE,CAAC;EACxC,SAAS;EACT,QAAQ,OAAO,CAAC,CAAC;EACjB,KAAK,EAAE,EAAE,CAAC,CAAC;EACX;EACA,IAAI,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;EACrC,QAAQ,aAAa,CAAC,GAAG,CAAC,QAAQ,EAAE,UAAU,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,UAAU,KAAK,SAAS,CAAC,CAAC;EAClG,KAAK;EACL,IAAI,OAAO,aAAa,CAAC;EACzB,CAAC;EACD,SAASD,aAAW,CAAC,QAAQ,EAAE,aAAa,EAAE,OAAO,EAAE,KAAK,EAAE;EAC9D,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC3C,IAAI,QAAQ,QAAQ;EACpB,QAAQ,KAAK,OAAO;EACpB,YAAY,OAAO,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;EAC5C,QAAQ,KAAK,WAAW;EACxB,YAAY,OAAOE,SAAoB,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;EACxD,QAAQ,KAAK,QAAQ;EACrB;EACA,YAAY,OAAO,YAAY,CAAC,QAAQ,EAAE,aAAa,CAAC,MAAM,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;EAC9E,QAAQ,KAAK,MAAM,EAAE;EACrB,YAAY,IAAI,SAAS,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EACzE,YAAY,OAAO,0BAA0B,CAAC,aAAa,CAAC,IAAI,EAAEC,IAAe,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC,CAAC;EACxG,SAAS;EACT,QAAQ,KAAK,YAAY;EACzB,YAAY,OAAOC,UAAqB,CAAC,QAAQ,EAAE,OAAO,EAAE,aAAa,CAAC,CAAC;EAC3E,QAAQ,KAAK,cAAc,EAAE;EAC7B,YAAY,IAAI,SAAS,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EACzE,YAAY,OAAOC,YAAuB,CAAC,QAAQ,EAAE,aAAa,EAAE,OAAO,EAAE,SAAS,CAAC,CAAC;EACxF,SAAS;EACT,QAAQ,KAAK,QAAQ;EACrB,YAAY,OAAO,0BAA0B,CAAC,aAAa,CAAC,MAAM,EAAEC,MAAiB,CAAC,OAAO,CAAC,CAAC,CAAC;EAChG,QAAQ,KAAK,WAAW,EAAE;EAC1B,YAAY,IAAI,SAAS,GAAG,KAAK,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EACzE,YAAY,IAAI,QAAQ,GAAG,OAAO,KAAK,GAAG,GAAG,OAAO,GAAG,OAAO,KAAK,GAAG,GAAG,QAAQ,GAAG,SAAS,CAAC;EAC9F,YAAY,IAAI,IAAI,GAAG,QAAQ,GAAG,KAAK,CAAC,gBAAgB,CAAC,QAAQ,CAAC;EAClE,kBAAkB,SAAS,CAAC;EAC5B,YAAY,OAAO,0BAA0B,CAAC,aAAa,CAAC,SAAS,EAAEC,SAAoB,CAAC,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC,CAAC;EACjI,SAAS;EACT,QAAQ,KAAK,OAAO;EACpB,YAAY,IAAI,QAAQ,GAAG,OAAO,KAAK,GAAG,GAAG,IAAI,GAAG,IAAI,CAAC;EACzD,YAAY,IAAI,SAAS,GAAG,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;EACrD;EACA;EACA,YAAY,IAAI,aAAa,GAAG,gBAAgB,CAAC,KAAK,EAAE,OAAO,CAAC,CAAC;EACjE,YAAY,IAAI,cAAc,GAAG,aAAa,KAAK,SAAS,GAAG,aAAa;EAC5E,gBAAgB,aAAa,CAAC,KAAK,KAAK,SAAS,GAAG,SAAS,GAAG,aAAa,CAAC,KAAK,CAAC;EACpF,YAAY,OAAO,0BAA0B,CAAC,cAAc;EAC5D;EACA,YAAY,mBAAmB,CAAC,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,EAAE,SAAS,GAAG,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;EAC3G,QAAQ,KAAK,QAAQ;EACrB,YAAY,OAAOhD,QAAiB,CAAC,aAAa,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;EAC9E,KAAK;EACL;EACA,IAAI,OAAO,cAAc,CAAC,QAAQ,CAAC,GAAG,aAAa,CAAC,QAAQ,CAAC,GAAG,SAAS,CAAC;EAC1E,CAAC;;ECtPM,SAAS,gBAAgB,CAAC,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE;EACzD,IAAI,IAAI,OAAO,GAAG,SAAS,CAAC,IAAI,CAAC,GAAGtC,QAAgB,CAAC,EAAE,EAAE,IAAI,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;EAChF;EACA,IAAI,IAAI,eAAe,GAAG,OAAO,CAAC,MAAM,IAAI,aAAa,CAAC,QAAQ,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;EACrF,IAAI,OAAO,CAAC,MAAM,GAAG8E,QAAM,CAAC,OAAO,CAAC,IAAI,EAAE,QAAQ,EAAE,eAAe,CAAC,CAAC;EACrE,IAAI,IAAI,eAAe,KAAK,SAAS,IAAI,eAAe,KAAK,OAAO,CAAC,MAAM,EAAE;EAC7E,QAAQtE,IAAQ,CAACC,OAAW,CAAC,gBAAgB,CAAC,OAAO,CAAC,MAAM,EAAE,eAAe,CAAC,CAAC,CAAC;EAChF,KAAK;EACL;EACA,IAAI,IAAI,gBAAgB,GAAG,OAAO,CAAC,OAAO,KAAK,SAAS,GAAG,OAAO,CAAC,OAAO,GAAG,aAAa,CAAC,SAAS,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;EACvH,IAAI,IAAI,gBAAgB,KAAK,SAAS,EAAE;EACxC,QAAQ,OAAO,CAAC,OAAO,GAAG,cAAc,CAAC,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;EACjE,KAAK;EACL,IAAI,IAAI,eAAe,GAAG,OAAO,CAAC,MAAM,CAAC;EACzC,IAAI,IAAI,eAAe,KAAK,SAAS,EAAE;EACvC,QAAQ,OAAO,CAAC,MAAM,GAAG,MAAM,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;EACjD,KAAK;EACL,IAAI,OAAO,OAAO,CAAC;EACnB,CAAC;EACD,SAAS,cAAc,CAAC,IAAI,EAAE,QAAQ,EAAE;EACxC,IAAI,IAAI,QAAQ,CAAC,CAAC,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,CAAC,EAAE,IAAI,CAAC,EAAE;EACvD;EACA,QAAQ,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,EAAE;EACpC,YAAY,OAAO,GAAG,CAAC;EACvB,SAAS;EACT,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;EACD,SAAS,MAAM,CAAC,OAAO,EAAE,MAAM,EAAE;EACjC,IAAI,IAAI,YAAY,GAAG,aAAa,CAAC,QAAQ,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;EAChE,IAAI,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;EAC5B,IAAI,OAAO,YAAY,KAAK,SAAS,GAAG,YAAY,GAAG,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,IAAI,IAAI,IAAI,KAAK,IAAI,CAAC;EACxG,CAAC;EACD,SAASqE,QAAM,CAAC,IAAI,EAAE,QAAQ,EAAE,eAAe,EAAE;EACjD,IAAI,QAAQ,IAAI;EAChB,QAAQ,KAAK,KAAK,CAAC;EACnB,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAK,MAAM,CAAC;EACpB,QAAQ,KAAKxE,MAAI,CAAC;EAClB,QAAQ,KAAK,IAAI;EACjB;EACA,YAAY,OAAO,SAAS,CAAC;EAC7B,KAAK;EACL,IAAI,IAAI,QAAQ,GAAG,QAAQ,CAAC,EAAE,CAAC;EAC/B,IAAI,IAAI,QAAQ,GAAG,QAAQ,CAAC,EAAE,CAAC;EAC/B,IAAI,QAAQ,IAAI;EAChB,QAAQ,KAAK,GAAG;EAChB,YAAY,IAAI,QAAQ,IAAI,QAAQ,EAAE;EACtC;EACA,gBAAgB,IAAI,eAAe,EAAE;EACrC,oBAAoB,OAAO,eAAe,CAAC;EAC3C,iBAAiB;EACjB;EACA,gBAAgB,IAAI,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC;EACtC,gBAAgB,IAAI,CAAC,QAAQ,IAAI,UAAU,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,KAAK,YAAY,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;EAC9F,oBAAoB,OAAO,YAAY,CAAC;EACxC,iBAAiB;EACjB;EACA,gBAAgB,IAAI,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC;EACtC,gBAAgB,IAAI,CAAC,QAAQ,IAAI,UAAU,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,KAAK,YAAY,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE;EAC9F,oBAAoB,OAAO,UAAU,CAAC;EACtC,iBAAiB;EACjB,aAAa;EACb;EACA,QAAQ,KAAK,IAAI;EACjB;EACA,YAAY,IAAI,QAAQ,IAAI,QAAQ,EAAE;EACtC,gBAAgB,OAAO,SAAS,CAAC;EACjC,aAAa;EACb,QAAQ,KAAK,IAAI;EACjB;EACA,YAAY,IAAI,QAAQ,EAAE;EAC1B,gBAAgB,OAAO,UAAU,CAAC;EAClC,aAAa;EACb,iBAAiB,IAAI,QAAQ,EAAE;EAC/B,gBAAgB,OAAO,YAAY,CAAC;EACpC,aAAa;EACb,iBAAiB,IAAI,IAAI,KAAK,IAAI,EAAE;EACpC,gBAAgB,IAAI,QAAQ,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,EAAE;EAC/C,oBAAoB,OAAO,UAAU,CAAC;EACtC,iBAAiB;EACjB,qBAAqB,IAAI,QAAQ,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,EAAE;EACpD,oBAAoB,OAAO,YAAY,CAAC;EACxC,iBAAiB;EACjB,aAAa;EACb,QAAQ,KAAK,IAAI,CAAC;EAClB,QAAQ,KAAK,IAAI;EACjB;EACA,YAAY,IAAI,aAAa,GAAG,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,YAAY,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;EACnF,YAAY,IAAI,aAAa,GAAG,UAAU,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,YAAY,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;EACnF,YAAY,IAAI,aAAa,IAAI,CAAC,aAAa,EAAE;EACjD,gBAAgB,OAAO,IAAI,KAAK,MAAM,GAAG,YAAY,GAAG,UAAU,CAAC;EACnE,aAAa;EACb,iBAAiB,IAAI,CAAC,aAAa,IAAI,aAAa,EAAE;EACtD,gBAAgB,OAAO,IAAI,KAAK,MAAM,GAAG,UAAU,GAAG,YAAY,CAAC;EACnE,aAAa;EACb,iBAAiB,IAAI,aAAa,IAAI,aAAa,EAAE;EACrD,gBAAgB,IAAI,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC;EACtC,gBAAgB,IAAI,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC;EACtC,gBAAgB,IAAI,WAAW,GAAG,IAAI,CAAC,IAAI,KAAK,QAAQ,CAAC;EACzD,gBAAgB,IAAI,WAAW,GAAG,IAAI,CAAC,IAAI,KAAK,QAAQ,CAAC;EACzD;EACA,gBAAgB,IAAI,WAAW,IAAI,CAAC,WAAW,EAAE;EACjD,oBAAoB,OAAO,IAAI,KAAK,MAAM,GAAG,UAAU,GAAG,YAAY,CAAC;EACvE,iBAAiB;EACjB,qBAAqB,IAAI,CAAC,WAAW,IAAI,WAAW,EAAE;EACtD,oBAAoB,OAAO,IAAI,KAAK,MAAM,GAAG,YAAY,GAAG,UAAU,CAAC;EACvE,iBAAiB;EACjB,gBAAgB,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,SAAS,EAAE;EACvD,oBAAoB,OAAO,IAAI,KAAK,MAAM,GAAG,UAAU,GAAG,YAAY,CAAC;EACvE,iBAAiB;EACjB,qBAAqB,IAAI,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;EAC5D,oBAAoB,OAAO,IAAI,KAAK,MAAM,GAAG,YAAY,GAAG,UAAU,CAAC;EACvE,iBAAiB;EACjB,gBAAgB,IAAI,eAAe,EAAE;EACrC;EACA,oBAAoB,OAAO,eAAe,CAAC;EAC3C,iBAAiB;EACjB,gBAAgB,IAAI,EAAE,IAAI,KAAK,IAAI,IAAI,QAAQ,CAAC,KAAK,CAAC,EAAE;EACxD;EACA,oBAAoBE,IAAQ,CAACC,OAAW,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC,CAAC;EACxE,iBAAiB;EACjB,gBAAgB,OAAO,UAAU,CAAC;EAClC,aAAa;EACb,iBAAiB;EACjB;EACA,gBAAgBD,IAAQ,CAACC,OAAW,CAAC,4BAA4B,CAAC,IAAI,CAAC,CAAC,CAAC;EACzE,gBAAgB,OAAO,SAAS,CAAC;EACjC,aAAa;EACb,KAAK;EACL,IAAI,OAAO,UAAU,CAAC;EACtB,CAAC;;ECzIM,IAAI,IAAI,GAAG;EAClB,IAAI,MAAM,EAAE,MAAM;EAClB,IAAI,WAAW,EAAE,UAAU,KAAK,EAAE;EAClC,QAAQ,OAAOT,QAAgB,CAAC,EAAE,EAAEuF,eAAsB,CAAC,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,SAAS,EAAE,CAAC,EAAEC,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAE,WAAW,CAAC,EAAEA,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAE,WAAW,CAAC,EAAEC,cAAqB,CAAC,KAAK,EAAE,WAAW,EAAE,KAAK,CAAC,OAAO,CAAC,MAAM,KAAK,YAAY,GAAG,IAAI,GAAG,IAAI,CAAC,EAAEC,OAAc,CAAC,KAAK,CAAC,CAAC,CAAC;EAC/T,KAAK;EACL,CAAC,CAAC;;ECEK,IAAI,GAAG,GAAG;EACjB,IAAI,MAAM,EAAE,MAAM;EAClB,IAAI,WAAW,EAAE,UAAU,KAAK,EAAE;EAClC,QAAQ,OAAO1F,QAAgB,CAAC,EAAE,EAAEuF,eAAsB,CAAC,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,QAAQ,EAAE,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;EAC7H,KAAK;EACL,CAAC,CAAC;EACF,SAAS,CAAC,CAAC,KAAK,EAAE;EAClB,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,EAAE,QAAQ,GAAG,KAAK,CAAC,QAAQ,EAAE,OAAO,GAAG,KAAK,CAAC,OAAO,EAAE,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;EACvG,IAAI,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;EAChC,IAAI,IAAI,OAAO,GAAG,QAAQ,CAAC,IAAI,CAAC;EAChC,IAAI,IAAI,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC;EAC1B,IAAI,IAAI,KAAK,GAAG,QAAQ,CAAC,EAAE,CAAC;EAC5B,IAAI,IAAI,UAAU,GAAG,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;EACxC,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;EAC5C;EACA,IAAI,IAAI,MAAM,KAAK,YAAY,IAAI,KAAK,EAAE;EAC1C,QAAQ,OAAOvF,QAAgB,CAAC,EAAE,EAAEwF,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAE,WAAW,CAAC,EAAEC,cAAqB,CAAC,KAAK,EAAE,WAAW,EAAE,IAAI,CAAC,CAAC,CAAC;EACpI,KAAK;EACL,SAAS;EACT,QAAQ,IAAI,UAAU,CAAC,IAAI,CAAC,EAAE;EAC9B,YAAY,IAAI,UAAU,GAAG,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAChD,YAAY,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,OAAO,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,EAAE;EACxE,gBAAgB,OAAOE,cAAqB,CAAC,IAAI,EAAE,GAAG,EAAE,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,OAAO,CAAC,UAAU,KAAK,SAAS,GAAG,MAAM,CAAC,GAAG,CAAC,UAAU,GAAG,OAAO,CAAC,UAAU,EAAE,MAAM,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;EACpL,aAAa;EACb,iBAAiB;EACjB,gBAAgB,IAAI,UAAU,KAAK,SAAS,CAAC,IAAI,EAAE;EACnD,oBAAoB,OAAOC,YAAmB,CAAC,IAAI,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;EACjE,iBAAiB;EACjB,aAAa;EACb,SAAS;EACT;EACA,QAAQ,OAAOC,oBAA2B,CAAC,GAAG,EAAE,KAAK,EAAE7F,QAAgB,CAAC,EAAE,EAAE8F,GAAO,CAAC,KAAK,CAAC,CAAC,EAAE,cAAc,CAAC,OAAO,EAAE,UAAU,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC;EAClJ,KAAK;EACL,CAAC;EACD,SAAS,CAAC,CAAC,KAAK,EAAE;EAClB,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,EAAE,QAAQ,GAAG,KAAK,CAAC,QAAQ,EAAE,MAAM,GAAG,KAAK,CAAC,MAAM,EAAE,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC;EACzG,IAAI,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;EAChC,IAAI,IAAI,OAAO,GAAG,QAAQ,CAAC,IAAI,CAAC;EAChC,IAAI,IAAI,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC;EAC1B,IAAI,IAAI,KAAK,GAAG,QAAQ,CAAC,EAAE,CAAC;EAC5B,IAAI,IAAI,UAAU,GAAG,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;EACxC,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;EAC5C;EACA,IAAI,IAAI,MAAM,KAAK,UAAU,IAAI,KAAK,EAAE;EACxC,QAAQ,OAAO9F,QAAgB,CAAC,EAAE,EAAEwF,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAE,WAAW,CAAC,EAAEC,cAAqB,CAAC,KAAK,EAAE,WAAW,EAAE,IAAI,CAAC,CAAC,CAAC;EACpI,KAAK;EACL,SAAS;EACT,QAAQ,IAAI,UAAU,CAAC,IAAI,CAAC,EAAE;EAC9B,YAAY,IAAI,UAAU,GAAG,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAChD,YAAY,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,OAAO,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,EAAE;EACxE,gBAAgB,OAAOE,cAAqB,CAAC,IAAI,EAAE,GAAG,EAAE,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,OAAO,CAAC,UAAU,KAAK,SAAS,GAAG,MAAM,CAAC,GAAG,CAAC,UAAU,GAAG,OAAO,CAAC,UAAU,EAAE,MAAM,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;EACpL,aAAa;EACb,iBAAiB,IAAI,UAAU,KAAK,SAAS,CAAC,IAAI,EAAE;EACpD,gBAAgB,OAAOC,YAAmB,CAAC,IAAI,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;EAC7D,aAAa;EACb,SAAS;EACT,QAAQ,OAAOC,oBAA2B,CAAC,GAAG,EAAE,KAAK,EAAEC,GAAO,CAAC,MAAM,CAAC,EAAE,cAAc,CAAC,OAAO,EAAE,UAAU,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC;EAC7H,KAAK;EACL,CAAC;EACD,SAAS,cAAc,CAAC,OAAO,EAAE,SAAS,EAAE,KAAK,EAAE,MAAM,EAAE;EAC3D,IAAI,IAAI,OAAO,CAAC,IAAI,KAAK,SAAS,EAAE;EACpC,QAAQ,OAAO,EAAE,KAAK,EAAE,OAAO,CAAC,IAAI,EAAE,CAAC;EACvC,KAAK;EACL,SAAS,IAAI,MAAM,CAAC,GAAG,CAAC,gBAAgB,EAAE;EAC1C,QAAQ,OAAO,EAAE,KAAK,EAAE,MAAM,CAAC,GAAG,CAAC,gBAAgB,EAAE,CAAC;EACtD,KAAK;EACL,SAAS,IAAI,KAAK,EAAE;EACpB,QAAQ,IAAI,SAAS,GAAG,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAC1C,QAAQ,IAAI,SAAS,KAAK,SAAS,CAAC,KAAK,EAAE;EAC3C,YAAY,IAAI,UAAU,GAAG,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;EAChD,YAAY,IAAI,aAAa,CAAC,UAAU,CAAC,IAAI,QAAQ,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE;EACxE,gBAAgB,OAAO,EAAE,KAAK,EAAE,UAAU,CAAC,IAAI,GAAG,CAAC,EAAE,CAAC;EACtD,aAAa;EACb,YAAYtF,IAAQ,CAACC,OAAW,CAAC,uCAAuC,CAAC,CAAC;EAC1E,SAAS;EACT,aAAa,IAAI,SAAS,KAAK,SAAS,CAAC,IAAI,EAAE;EAC/C,YAAY,OAAOmB,OAAW,CAAC,SAAS,CAAC,CAAC;EAC1C,SAAS;EACT,aAAa;EACb,YAAY,OAAO,EAAE,KAAK,EAAE,MAAM,CAAC,GAAG,CAAC,kBAAkB,EAAE,CAAC;EAC5D,SAAS;EACT,KAAK;EACL,SAAS,IAAI,MAAM,CAAC,KAAK,CAAC,SAAS,IAAI,MAAM,CAAC,KAAK,CAAC,SAAS,KAAK,IAAI,EAAE;EACxE,QAAQ,OAAO,EAAE,KAAK,EAAE,MAAM,CAAC,KAAK,CAAC,SAAS,GAAG,CAAC,EAAE,CAAC;EACrD,KAAK;EACL,IAAI,OAAO,EAAE,KAAK,EAAE,EAAE,EAAE,CAAC;EACzB,CAAC;;EC3FM,IAAI,QAAQ,GAAG;EACtB,IAAI,MAAM,EAAE,OAAO;EACnB,IAAI,WAAW,EAAE,UAAU,KAAK,EAAE;EAClC,QAAQ,OAAO5B,QAAgB,CAAC,EAAE,EAAEuF,eAAsB,CAAC,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC;EACzG,KAAK;EACL,IAAI,qBAAqB,EAAE,UAAU,KAAK,EAAE;EAC5C,QAAQ,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;EACtC,QAAQ,IAAI,QAAQ,GAAG,QAAQ,CAAC,KAAK,CAAC;EACtC,QAAQ,IAAI,SAAS,GAAGvF,QAAgB,CAAC,EAAE,IAAI,EAAE,UAAU,EAAE,UAAU,EAAE,KAAK,CAAC,cAAc,EAAE,EAAE,GAAG,QAAQ,IAAI,UAAU,CAAC,QAAQ,CAAC,IAAI,QAAQ,CAAC,IAAI,KAAK,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,CAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,EAAE,GAAG,EAAE,EAAE,CAAC;EAC3N,QAAQ,OAAO,CAAC,SAAS,CAAC,CAAC;EAC3B,KAAK;EACL,CAAC,CAAC;;ECZK,IAAI,IAAI,GAAG;EAClB,IAAI,MAAM,EAAE,MAAM;EAClB,IAAI,WAAW,EAAE,UAAU,KAAK,EAAE;EAClC,QAAQ,IAAI,KAAK,GAAG,KAAK,CAAC,KAAK,EAAE,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;EACvD,QAAQ,OAAOA,QAAgB,CAAC,EAAE,EAAEuF,eAAsB,CAAC,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,QAAQ,EAAE,CAAC,EAAEC,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAEM,GAAO,CAAC,KAAK,CAAC,CAAC,EAAEN,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAEM,GAAO,CAAC,MAAM,CAAC,CAAC,EAAEC,WAAkB,CAAC,MAAM,EAAE,KAAK,EAAE;EAChP,YAAY,SAAS,EAAE,aAAa;EACpC,SAAS,CAAC,EAAEL,OAAc,CAAC,KAAK,CAAC,CAAC,CAAC;EACnC,KAAK;EACL,CAAC,CAAC;AACF,EAAO,IAAI,KAAK,GAAG;EACnB,IAAI,MAAM,EAAE,OAAO;EACnB,IAAI,WAAW,EAAE,UAAU,KAAK,EAAE;EAClC,QAAQ,IAAI,KAAK,GAAG,KAAK,CAAC,KAAK,EAAE,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;EACvD,QAAQ,OAAO1F,QAAgB,CAAC,EAAE,EAAEuF,eAAsB,CAAC,KAAK,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,MAAM,EAAE,QAAQ,EAAE,CAAC,EAAEC,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAEM,GAAO,CAAC,KAAK,CAAC,CAAC,EAAEN,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAEM,GAAO,CAAC,MAAM,CAAC,CAAC,EAAEC,WAAkB,CAAC,MAAM,EAAE,KAAK,CAAC,EAAEL,OAAc,CAAC,KAAK,CAAC,CAAC,CAAC;EACzQ,KAAK;EACL,CAAC,CAAC;;ECdF,SAAS,WAAW,CAAC,KAAK,EAAE,UAAU,EAAE;EACxC,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,EAAE,KAAK,GAAG,KAAK,CAAC,KAAK,EAAE,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;EAC1E,IAAI,OAAO1F,QAAgB,CAAC,EAAE,EAAEuF,eAAsB,CAAC,KAAK,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,MAAM,EAAE,QAAQ,EAAE,CAAC,EAAEC,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAEM,GAAO,CAAC,KAAK,CAAC,CAAC,EAAEN,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAEM,GAAO,CAAC,MAAM,CAAC,CAAC,EAAEC,WAAkB,CAAC,MAAM,EAAE,KAAK,CAAC,EAAE,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,UAAU,CAAC,CAAC,CAAC;EACtR,CAAC;AACD,EAAO,SAAS,WAAW,CAAC,KAAK,EAAE,MAAM,EAAE,UAAU,EAAE;EACvD,IAAI,IAAI,UAAU,EAAE;EACpB,QAAQ,OAAO,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,UAAU,EAAE,EAAE,CAAC;EAChD,KAAK;EACL,IAAI,OAAOA,WAAkB,CAAC,OAAO,EAAE,KAAK,EAAE,EAAE,YAAY,EAAE,aAAa,CAAC,OAAO,EAAE,KAAK,CAAC,OAAO,EAAE,MAAM,CAAC,EAAE,CAAC,CAAC;EAC/G,CAAC;AACD,EAAO,IAAI,KAAK,GAAG;EACnB,IAAI,MAAM,EAAE,QAAQ;EACpB,IAAI,WAAW,EAAE,UAAU,KAAK,EAAE;EAClC,QAAQ,OAAO,WAAW,CAAC,KAAK,CAAC,CAAC;EAClC,KAAK;EACL,CAAC,CAAC;AACF,EAAO,IAAI,MAAM,GAAG;EACpB,IAAI,MAAM,EAAE,QAAQ;EACpB,IAAI,WAAW,EAAE,UAAU,KAAK,EAAE;EAClC,QAAQ,OAAO,WAAW,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;EAC5C,KAAK;EACL,CAAC,CAAC;AACF,EAAO,IAAI,MAAM,GAAG;EACpB,IAAI,MAAM,EAAE,QAAQ;EACpB,IAAI,WAAW,EAAE,UAAU,KAAK,EAAE;EAClC,QAAQ,OAAO,WAAW,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;EAC5C,KAAK;EACL,CAAC,CAAC;;ECxBK,IAAI,IAAI,GAAG;EAClB,IAAI,MAAM,EAAE,MAAM;EAClB,IAAI,WAAW,EAAE,UAAU,KAAK,EAAE;EAClC,QAAQ,OAAO/F,QAAgB,CAAC,EAAE,EAAEuF,eAAsB,CAAC,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,QAAQ,EAAE,CAAC,EAAES,GAAC,CAAC,KAAK,CAAC,EAAEC,GAAC,CAAC,KAAK,CAAC,CAAC,CAAC;EAC7H,KAAK;EACL,CAAC,CAAC;AACF,EAAO,SAASD,GAAC,CAAC,KAAK,EAAE;EACzB,IAAI,IAAI,IAAI,GAAG,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;EAChC,IAAI,IAAI,KAAK,GAAG,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC;EAClC,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;EAC5C,IAAI,IAAI,UAAU,GAAG,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,SAAS,CAAC;EAC7D,IAAI,IAAI,UAAU,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,KAAK,EAAE;EAChD,QAAQ,OAAOL,cAAqB,CAAC,IAAI,EAAE,GAAG,EAAE,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;EAChG,KAAK;EACL,SAAS,IAAI,UAAU,CAAC,IAAI,CAAC,IAAI,MAAM,IAAI,iBAAiB,CAAC,UAAU,CAAC,EAAE;EAC1E;EACA,QAAQ,IAAI,UAAU,KAAK,SAAS,CAAC,IAAI,EAAE;EAC3C,YAAY,OAAOC,YAAmB,CAAC,IAAI,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;EACzD,SAAS;EACT,aAAa;EACb;EACA,YAAY,MAAM,IAAI,KAAK,CAACnF,OAAW,CAAC,wBAAwB,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC,CAAC;EACpF,SAAS;EACT,KAAK;EACL,SAAS;EACT,QAAQ,OAAOT,QAAgB,CAAC,EAAE,EAAEwF,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAE,WAAW,CAAC,EAAEC,cAAqB,CAAC,KAAK,EAAE,WAAW,EAAE,IAAI,CAAC,CAAC,CAAC;EACpI,KAAK;EACL,CAAC;AACD,EAAO,SAASQ,GAAC,CAAC,KAAK,EAAE;EACzB,IAAI,IAAI,IAAI,GAAG,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;EAChC,IAAI,IAAI,KAAK,GAAG,KAAK,CAAC,QAAQ,CAAC,EAAE,CAAC;EAClC,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;EAC5C,IAAI,IAAI,UAAU,GAAG,MAAM,GAAG,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,SAAS,CAAC;EAC7D,IAAI,IAAI,UAAU,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,KAAK,EAAE;EAChD,QAAQ,OAAON,cAAqB,CAAC,IAAI,EAAE,GAAG,EAAE,KAAK,CAAC,SAAS,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,MAAM,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC;EAChG,KAAK;EACL,SAAS,IAAI,UAAU,CAAC,IAAI,CAAC,IAAI,MAAM,IAAI,iBAAiB,CAAC,UAAU,CAAC,EAAE;EAC1E;EACA,QAAQ,IAAI,UAAU,KAAK,SAAS,CAAC,IAAI,EAAE;EAC3C,YAAY,OAAOC,YAAmB,CAAC,IAAI,EAAE,GAAG,EAAE,KAAK,CAAC,CAAC;EACzD,SAAS;EACT,aAAa;EACb;EACA,YAAY,MAAM,IAAI,KAAK,CAACnF,OAAW,CAAC,wBAAwB,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC,CAAC;EACpF,SAAS;EACT,KAAK;EACL,SAAS;EACT,QAAQ,OAAOT,QAAgB,CAAC,EAAE,EAAEwF,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAE,WAAW,CAAC,EAAEC,cAAqB,CAAC,KAAK,EAAE,WAAW,EAAE,IAAI,CAAC,CAAC,CAAC;EACpI,KAAK;EACL,CAAC;;ECrDM,IAAI,IAAI,GAAG;EAClB,IAAI,MAAM,EAAE,MAAM;EAClB,IAAI,WAAW,EAAE,UAAU,KAAK,EAAE;EAClC,QAAQ,IAAI,OAAO,GAAG,KAAK,CAAC,MAAM,EAAE,OAAO,GAAG,KAAK,CAAC,OAAO,EAAE,KAAK,GAAG,KAAK,CAAC,KAAK,EAAE,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;EACxG,QAAQ,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;EACpC,QAAQ,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,SAAS,EAAE;EAC7G;EACA,YAAY,OAAO,EAAE,CAAC;EACtB,SAAS;EACT,QAAQ,OAAOzF,QAAgB,CAAC,EAAE,EAAEuF,eAAsB,CAAC,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,QAAQ,EAAE,CAAC,EAAEC,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAE,MAAM,KAAK,YAAY,GAAG,WAAW,GAAGM,GAAO,CAAC,KAAK,CAAC,CAAC,EAAEN,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAE,MAAM,KAAK,UAAU,GAAG,WAAW,GAAGM,GAAO,CAAC,MAAM,CAAC,CAAC,GAAG,MAAM,KAAK,UAAU,GAAGL,cAAqB,CAAC,KAAK,EAAE,WAAW,EAAE,IAAI,CAAC,GAAG,EAAE,IAAI,MAAM,KAAK,YAAY,GAAGA,cAAqB,CAAC,KAAK,EAAE,WAAW,EAAE,IAAI,CAAC,GAAG,EAAE,GAAGM,WAAkB,CAAC,MAAM,EAAE,KAAK,EAAE;EAChe,YAAY,SAAS,EAAE,aAAa;EACpC,YAAY,YAAY,EAAE,OAAO,CAAC,IAAI;EACtC,SAAS,CAAC,CAAC,CAAC;EACZ,KAAK;EACL,CAAC,CAAC;;ECbK,IAAIvE,MAAI,GAAG;EAClB,IAAI,MAAM,EAAE,MAAM;EAClB,IAAI,WAAW,EAAE,UAAU,KAAK,EAAE;EAClC,QAAQ,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,EAAE,QAAQ,GAAG,KAAK,CAAC,QAAQ,EAAE,KAAK,GAAG,KAAK,CAAC,KAAK,EAAE,MAAM,GAAG,KAAK,CAAC,MAAM,EAAE,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC;EAClI,QAAQ,OAAOxB,QAAgB,CAAC,EAAE,EAAEuF,eAAsB,CAAC,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,QAAQ,EAAE,CAAC,EAAEC,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAEM,GAAO,CAAC,KAAK,CAAC,CAAC,EAAEN,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAEM,GAAO,CAAC,MAAM,CAAC,CAAC,EAAEI,MAAW,CAAC,KAAK,CAAC,EAAEH,WAAkB,CAAC,MAAM,EAAE,KAAK,EAAE/F,QAAgB,CAAC,EAAE,GAAG,OAAO,CAAC,IAAI,GAAG,EAAE,YAAY,EAAE,OAAO,CAAC,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,SAAS,EAAE,UAAU;EACtW,UAAU,CAAC,CAAC,EAAEmG,cAAqB,CAAC,OAAO,EAAE,KAAK,CAAC,KAAK,CAAC,OAAO,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC;EACtF,KAAK;EACL,CAAC,CAAC;EACF,SAAS,KAAK,CAAC,OAAO,EAAE,QAAQ,EAAE,MAAM,EAAE;EAC1C,IAAI,IAAI,CAAC,GAAG,OAAO,CAAC,KAAK,IAAI,aAAa,CAAC,OAAO,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;EACrE,IAAI,IAAI,CAAC,KAAK,SAAS,EAAE;EACzB,QAAQ,OAAO,QAAQ,CAAC;EACxB,KAAK;EACL;EACA,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;;ECfM,IAAI,IAAI,GAAG;EAClB,IAAI,MAAM,EAAE,MAAM;EAClB,IAAI,WAAW,EAAE,UAAU,KAAK,EAAE;EAClC,QAAQ,IAAI,EAAE,CAAC;EACf,QAAQ,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,EAAE,OAAO,GAAG,KAAK,CAAC,OAAO,EAAE,KAAK,GAAG,KAAK,CAAC,KAAK,EAAE,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC;EACvG,QAAQ,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;EACpC,QAAQ,IAAI,aAAa,GAAG,MAAM,KAAK,YAAY,GAAG,OAAO,GAAG,QAAQ,CAAC;EACzE,QAAQ,IAAI,kBAAkB,GAAG,MAAM,KAAK,YAAY,GAAG,QAAQ,GAAG,OAAO,CAAC;EAC9E,QAAQ,OAAOnG,QAAgB,CAAC,EAAE,EAAEuF,eAAsB,CAAC,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,QAAQ,EAAE,CAAC,EAAEC,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAEM,GAAO,CAAC,KAAK,CAAC,EAAE,IAAI,CAAC,EAAEN,aAAoB,CAAC,GAAG,EAAE,KAAK,EAAEM,GAAO,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,EAAEC,WAAkB,CAAC,MAAM,EAAE,KAAK,EAAE;EAC5P,YAAY,YAAY,EAAE,WAAW,CAAC,KAAK,CAAC;EAC5C,YAAY,SAAS,EAAE,aAAa;EACpC,SAAS,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,kBAAkB,CAAC,GAAG,EAAE,KAAK,EAAE,OAAO,CAAC,SAAS,IAAI,MAAM,CAAC,IAAI,CAAC,SAAS,EAAE,EAAE,EAAE,EAAE,CAAC;EAC3G,KAAK;EACL,CAAC,CAAC;EACF,SAAS,WAAW,CAAC,KAAK,EAAE;EAC5B,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,MAAM,EAAE,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC;EACvD,IAAI,IAAI,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;EAChC,IAAI,IAAI,KAAK,GAAG,KAAK,CAAC,iBAAiB,CAAC,MAAM,KAAK,YAAY,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;EAC7E,IAAI,IAAI,OAAO,CAAC,IAAI,KAAK,SAAS,EAAE;EACpC,QAAQ,OAAO,OAAO,CAAC,IAAI,CAAC;EAC5B,KAAK;EACL,SAAS,IAAI,MAAM,CAAC,IAAI,CAAC,QAAQ,KAAK,SAAS,EAAE;EACjD,QAAQ,OAAO,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC;EACpC,KAAK;EACL,SAAS;EACT,QAAQ,IAAI,UAAU,GAAG,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,SAAS,CAAC;EAChE,QAAQ,IAAI,SAAS,GAAG,UAAU,IAAI,aAAa,CAAC,UAAU,CAAC;EAC/D,YAAY,UAAU,CAAC,IAAI;EAC3B,YAAY,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC;EACnC,QAAQ,IAAI,OAAO,SAAS,KAAK,QAAQ,EAAE;EAC3C;EACA,YAAY,MAAM,IAAI,KAAK,CAAC,gDAAgD,CAAC,CAAC;EAC9E,SAAS;EACT,QAAQ,OAAO,SAAS,GAAG,GAAG,CAAC;EAC/B,KAAK;EACL,CAAC;;ECrBD,IAAI,YAAY,GAAG;EACnB,IAAI,IAAI,EAAE,IAAI;EACd,IAAI,GAAG,EAAE,GAAG;EACZ,IAAI,MAAM,EAAE,MAAM;EAClB,IAAI,QAAQ,EAAE,QAAQ;EACtB,IAAI,IAAI,EAAE,IAAI;EACd,IAAI,KAAK,EAAE,KAAK;EAChB,IAAI,IAAI,EAAE,IAAI;EACd,IAAI,IAAI,EAAE,IAAI;EACd,IAAI,MAAM,EAAE,MAAM;EAClB,IAAI,IAAI,EAAEvE,MAAI;EACd,IAAI,IAAI,EAAE,IAAI;EACd,IAAI,KAAK,EAAE,KAAK;EAChB,CAAC,CAAC;AACF,EAAO,SAAS,cAAc,CAAC,KAAK,EAAE;EACtC,IAAI,IAAI,QAAQ,CAAC,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,EAAE,KAAK,CAAC,IAAI,CAAC,EAAE;EACnD,QAAQ,OAAO,aAAa,CAAC,KAAK,CAAC,CAAC;EACpC,KAAK;EACL,SAAS;EACT,QAAQ,OAAO,aAAa,CAAC,KAAK,CAAC,CAAC;EACpC,KAAK;EACL,CAAC;EACD,IAAI,mBAAmB,GAAG,eAAe,CAAC;EAC1C,SAAS,aAAa,CAAC,KAAK,EAAE;EAC9B,IAAI,IAAI,OAAO,GAAG,kBAAkB,CAAC,KAAK,CAAC,IAAI,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;EACjE,IAAI,IAAI,SAAS,GAAG,aAAa,CAAC,KAAK,EAAE;EACzC;EACA,QAAQ,UAAU,GAAG,OAAO,CAAC,MAAM,GAAG,CAAC,GAAG,mBAAmB,GAAG,EAAE,CAAC;EACnE,KAAK,CAAC,CAAC;EACP,IAAI,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;EAC5B;EACA,QAAQ,OAAO,CAAC;EAChB,gBAAgB,IAAI,EAAE,KAAK,CAAC,OAAO,CAAC,WAAW,CAAC;EAChD,gBAAgB,IAAI,EAAE,OAAO;EAC7B,gBAAgB,IAAI,EAAE;EACtB,oBAAoB,KAAK,EAAE;EAC3B,wBAAwB,IAAI,EAAE,mBAAmB,GAAG,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC;EAC/E,wBAAwB,IAAI,EAAE,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC;EACzD,wBAAwB,OAAO,EAAE,OAAO;EACxC,qBAAqB;EACrB,iBAAiB;EACjB,gBAAgB,MAAM,EAAE;EACxB,oBAAoB,MAAM,EAAE;EAC5B,wBAAwB,KAAK,EAAE,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,OAAO,EAAE,EAAE;EAC5D,wBAAwB,MAAM,EAAE,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,QAAQ,EAAE,EAAE;EAC9D,qBAAqB;EACrB,iBAAiB;EACjB,gBAAgB,KAAK,EAAE,SAAS;EAChC,aAAa,CAAC,CAAC;EACf,KAAK;EACL,SAAS;EACT,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK;EACL,CAAC;AACD,EAAO,SAAS,OAAO,CAAC,KAAK,EAAE;EAC/B,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,EAAE,KAAK,GAAG,KAAK,CAAC,KAAK,EAAE,IAAI,GAAG,KAAK,CAAC,IAAI,EAAE,OAAO,GAAG,KAAK,CAAC,OAAO,CAAC;EACnG,IAAI,IAAI,KAAK,GAAG,QAAQ,CAAC,KAAK,CAAC;EAC/B,IAAI,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,UAAU,CAAC,KAAK,CAAC,EAAE;EAC9C,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK;EACL,SAAS,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,UAAU,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,EAAE;EAC9D;EACA,QAAQ,OAAO,UAAU,CAAC,KAAK,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;EACpD,KAAK;EACL,SAAS,IAAI,UAAU,CAAC,IAAI,CAAC,EAAE;EAC/B;EACA,QAAQ,IAAI,mBAAmB,GAAG,QAAQ,CAAC,OAAO,CAAC,MAAM,KAAK,YAAY,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC;EACxF,QAAQ,IAAI,UAAU,CAAC,mBAAmB,CAAC,EAAE;EAC7C,YAAY,IAAI,CAAC,GAAG,mBAAmB,CAAC,IAAI,CAAC;EAC7C,YAAY,IAAI,SAAS,GAAG,WAAW,CAAC,CAAC,CAAC;EAC1C,gBAAgB,OAAO,CAAC;EACxB;EACA;EACA,oBAAoB,SAAS,EAAE,WAAW,CAAC,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,SAAS;EAC7E,oBAAoB,KAAK,EAAE,CAAC,CAAC,KAAK;EAClC,iBAAiB,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC;EACrC,gBAAgB,OAAO,CAAC,mBAAmB,EAAE;EAC7C;EACA,oBAAoB,SAAS,EAAE,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,KAAK,GAAG,SAAS;EACpF,oBAAoB,IAAI,EAAE,OAAO;EACjC,iBAAiB,CAAC,CAAC;EACnB,YAAY,OAAO;EACnB,gBAAgB,KAAK,EAAE,SAAS;EAChC,gBAAgB,KAAK,EAAE,YAAY;EACnC,aAAa,CAAC;EACd,SAAS;EACT,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK;EACL,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC;EACD,SAAS,aAAa,CAAC,KAAK,EAAE,GAAG,EAAE;EACnC,IAAI,IAAI,GAAG,KAAK,KAAK,CAAC,EAAE,EAAE,GAAG,GAAG,EAAE,UAAU,EAAE,EAAE,EAAE,CAAC,EAAE;EACrD,IAAI,IAAI,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC;EAC1B,IAAI,IAAI,IAAI,GAAG,KAAK,CAAC,OAAO,CAAC,IAAI,KAAK,SAAS;EAC/C,QAAQ,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,GAAG,SAAS,CAAC,KAAK,CAAC,CAAC;EAChD,IAAI,IAAI,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;EACzC,IAAI,IAAIrB,MAAG,GAAG,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC;EACjC,IAAI,IAAI,IAAI,GAAG,OAAO,CAAC,KAAK,CAAC,CAAC;EAC9B,IAAI,IAAI,qBAAqB,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC,qBAAqB,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC,qBAAqB,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC;EAClI,IAAI,OAAO,CAACH,QAAgB,CAAC,EAAE,IAAI,EAAE,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,IAAI,EAAE,YAAY,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,GAAG,IAAI,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,IAAI,KAAK,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,IAAIG,MAAG,GAAG,EAAE,GAAG,EAAE,EAAE,KAAK,EAAEA,MAAG,CAAC,KAAK,EAAE,EAAE,GAAG,EAAE,IAAI,IAAI,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,EAAE,IAAI,EAAE,GAAG,CAAC,UAAU,GAAG,KAAK,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE,EAAE,MAAM,EAAE;EACjT,gBAAgB,MAAM,EAAE,YAAY,CAAC,IAAI,CAAC,CAAC,WAAW,CAAC,KAAK,CAAC;EAC7D,aAAa,EAAE,GAAG,qBAAqB,GAAG;EAC1C,YAAY,SAAS,EAAE,qBAAqB;EAC5C,SAAS,GAAG,EAAE,EAAE,CAAC,CAAC;EAClB,CAAC;EACD;EACA;EACA;EACA;AACA,EAAO,SAAS,kBAAkB,CAAC,IAAI,EAAE,QAAQ,EAAE;EACnD,IAAI,OAAO,IAAI,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,UAAU,OAAO,EAAE,OAAO,EAAE;EAC7D,QAAQ,QAAQ,OAAO;EACvB;EACA,YAAY,KAAK,GAAG,CAAC;EACrB,YAAY,KAAK,GAAG,CAAC;EACrB,YAAY,KAAK,OAAO,CAAC;EACzB,YAAY,KAAK,SAAS,CAAC;EAC3B,YAAY,KAAK,MAAM,CAAC;EACxB,YAAY,KAAK,IAAI,CAAC;EACtB,YAAY,KAAK,IAAI,CAAC;EACtB,YAAY,KAAK,UAAU,CAAC;EAC5B,YAAY,KAAK,WAAW,CAAC;EAC7B,YAAY,KAAK,WAAW,CAAC;EAC7B,YAAY,KAAK,YAAY,CAAC;EAC9B;EACA;EACA,YAAY,KAAK,MAAM,CAAC;EACxB,YAAY,KAAK,OAAO;EACxB,gBAAgB,OAAO,OAAO,CAAC;EAC/B,YAAY,KAAK,QAAQ,CAAC;EAC1B,YAAY,KAAK,KAAK;EACtB,gBAAgB,IAAI,UAAU,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;EACnD,gBAAgB,IAAI,UAAU,EAAE;EAChC,oBAAoB,CAAC,OAAO,CAAC,UAAU,CAAC,GAAG,UAAU,GAAG,CAAC,UAAU,CAAC,EAAE,OAAO,CAAC,UAAU,QAAQ,EAAE;EAClG,wBAAwB,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAE;EACjD,4BAA4B,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC,CAAC;EAChE,yBAAyB;EACzB,qBAAqB,CAAC,CAAC;EACvB,iBAAiB;EACjB,gBAAgB,OAAO,OAAO,CAAC;EAC/B,YAAY,KAAK,MAAM;EACvB,gBAAgB,IAAI,IAAI,KAAK,OAAO,EAAE;EACtC;EACA,oBAAoB,OAAO,OAAO,CAAC;EACnC,iBAAiB;EACjB;EACA;EACA;EACA,YAAY,KAAK,OAAO,CAAC;EACzB,YAAY,KAAK,MAAM,CAAC;EACxB,YAAY,KAAK,QAAQ,CAAC;EAC1B,YAAY,KAAK,SAAS;EAC1B;EACA;EACA,gBAAgB,IAAI,QAAQ,GAAG,WAAW,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;EAC9D,gBAAgB,IAAI,QAAQ,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAE;EACrD,oBAAoB,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC,CAAC;EACxD,iBAAiB;EACjB,gBAAgB,OAAO,OAAO,CAAC;EAC/B,YAAY;EACZ,gBAAgB,MAAM,IAAI,KAAK,CAAC,eAAe,GAAG,OAAO,GAAG,8BAA8B,CAAC,CAAC;EAC5F,SAAS;EACT,KAAK,EAAE,EAAE,CAAC,CAAC;EACX,CAAC;EACD;EACA;EACA;EACA;EACA;EACA,SAAS,SAAS,CAAC,KAAK,EAAE;EAC1B,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;EAC9C,IAAI,IAAI,MAAM,GAAG,KAAK,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC;EAC9C,IAAI,OAAO,CAAC,MAAM,IAAI,MAAM,CAAC,GAAG,CAAC,WAAW,CAAC;EAC7C,SAAS,MAAM,IAAI,MAAM,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,GAAG,IAAI,GAAG,KAAK,CAAC;EAC3D,CAAC;;EC/KD;EACA;EACA;EACA,IAAI,SAAS,kBAAkB,UAAU,MAAM,EAAE;EACjD,IAAI+B,SAAiB,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;EACzC,IAAI,SAAS,SAAS,CAAC,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,eAAe,EAAE,QAAQ,EAAE,MAAM,EAAE,GAAG,EAAE;EAC9F,QAAQ,IAAI,eAAe,KAAK,KAAK,CAAC,EAAE,EAAE,eAAe,GAAG,EAAE,CAAC,EAAE;EACjE,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,MAAM,EAAE,QAAQ,EAAE,SAAS,CAAC,IAAI,IAAI,CAAC;EAC1G,QAAQ,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC;EACxB,QAAQ,KAAK,CAAC,IAAI,GAAG,MAAM,CAAC;EAC5B,QAAQ,KAAK,CAAC,eAAe,GAAG,EAAE,CAAC;EACnC,QAAQ,KAAK,CAAC,aAAa,GAAG,EAAE,CAAC;EACjC,QAAQ,KAAK,CAAC,gBAAgB,GAAG,EAAE,CAAC;EACpC,QAAQ,KAAK,CAAC,mBAAmB,GAAG,EAAE,CAAC;EACvC,QAAQ,KAAK,CAAC,SAAS,GAAG,EAAE,CAAC;EAC7B,QAAQ,KAAK,CAAC,QAAQ,GAAG,EAAE,CAAC;EAC5B,QAAQ,KAAK,CAAC,QAAQ,CAAClC,QAAgB,CAAC,EAAE,EAAE,eAAe,GAAG,IAAI,CAAC,KAAK,GAAG,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,EAAE,GAAG,EAAE,IAAI,IAAI,CAAC,MAAM,GAAG,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;EACvJ,QAAQ,IAAI,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;EACrE,QAAQ,IAAI,QAAQ,GAAG,KAAK,CAAC,QAAQ,GAAG,iBAAiB,CAAC,yBAAyB,CAAC,IAAI,CAAC,QAAQ,IAAI,EAAE,EAAE,QAAQ,CAAC,EAAE,IAAI,CAAC,CAAC;EAC1H,QAAQ,KAAK,CAAC,OAAO,GAAG,gBAAgB,CAAC,IAAI,CAAC,IAAI,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;EACtE;EACA,QAAQ,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC,IAAI,EAAE,QAAQ,EAAE,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;EAChE,QAAQ,KAAK,CAAC,eAAe,GAAG,KAAK,CAAC,UAAU,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;EACjE,QAAQ,KAAK,CAAC,aAAa,GAAG,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;EACvD,QAAQ,KAAK,CAAC,gBAAgB,GAAG,KAAK,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;EAC5D,QAAQ,KAAK,CAAC,mBAAmB,GAAG,IAAI,CAAC,UAAU,CAAC;EACpD;EACA,QAAQ,KAAK,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;EACzC,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,SAAS,EAAE,eAAe,EAAE;EAChE,QAAQ,GAAG,EAAE,YAAY;EACzB,YAAY,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;EACzC,YAAY,IAAI,cAAc,GAAG,IAAI,CAAC,IAAI,KAAK,QAAQ,CAAC;EACxD,YAAY,IAAI,cAAc,GAAG,QAAQ,IAAI,oBAAoB,CAAC,IAAI,CAAC,UAAU,OAAO,EAAE,EAAE,OAAO,UAAU,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;EACrI,YAAY,OAAO,cAAc,IAAI,cAAc,CAAC;EACpD,SAAS;EACT,QAAQ,UAAU,EAAE,IAAI;EACxB,QAAQ,YAAY,EAAE,IAAI;EAC1B,KAAK,CAAC,CAAC;EACP;EACA;EACA;EACA;EACA,IAAI,SAAS,CAAC,SAAS,CAAC,WAAW,GAAG,UAAU,OAAO,EAAE;EACzD,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;EAClD,QAAQ,OAAO,KAAK,GAAG,KAAK,CAAC,MAAM,GAAG,SAAS,CAAC;EAChD,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,IAAI,GAAG,UAAU,OAAO,EAAE;EAClD,QAAQ,OAAO,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;EAC3C,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,MAAM,GAAG,UAAU,OAAO,EAAE;EACpD,QAAQ,OAAO,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;EAC9C,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,UAAU,GAAG,UAAU,IAAI,EAAE,QAAQ,EAAE;EAC/D,QAAQ,OAAO,cAAc,CAAC,MAAM,CAAC,UAAU,MAAM,EAAE,OAAO,EAAE;EAChE,YAAY,IAAI,QAAQ,CAAC;EACzB,YAAY,IAAI,cAAc,CAAC;EAC/B,YAAY,IAAI,UAAU,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC/C,YAAY,IAAI,UAAU,CAAC,UAAU,CAAC,EAAE;EACxC,gBAAgB,QAAQ,GAAG,UAAU,CAAC;EACtC,gBAAgB,cAAc,GAAG,UAAU,CAAC,KAAK,CAAC;EAClD,aAAa;EACb,iBAAiB,IAAI,sBAAsB,CAAC,UAAU,CAAC,EAAE;EACzD,gBAAgB,QAAQ,GAAG,UAAU,CAAC,SAAS,CAAC;EAChD,gBAAgB,cAAc,GAAG,UAAU,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;EAC/D,aAAa;EACb,iBAAiB,IAAI,OAAO,KAAK,GAAG,EAAE;EACtC,gBAAgB,QAAQ,GAAG,WAAW,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;EACpD,aAAa;EACb,iBAAiB,IAAI,OAAO,KAAK,GAAG,EAAE;EACtC,gBAAgB,QAAQ,GAAG,WAAW,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;EACpD,aAAa;EACb,YAAY,IAAI,QAAQ,EAAE;EAC1B,gBAAgB,MAAM,CAAC,OAAO,CAAC,GAAG,cAAc,IAAI,EAAE,CAAC;EACvD,aAAa;EACb,YAAY,OAAO,MAAM,CAAC;EAC1B,SAAS,EAAE,EAAE,CAAC,CAAC;EACf,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,QAAQ,GAAG,UAAU,QAAQ,EAAE;EACvD,QAAQ,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,UAAU,KAAK,EAAE,OAAO,EAAE;EACvD;EACA;EACA,YAAY,IAAI,UAAU,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC/C,YAAY,IAAI,UAAU,CAAC,UAAU,CAAC;EACtC,iBAAiB,OAAO,KAAK,CAAC,IAAI,UAAU,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;EAC1D,iBAAiB,OAAO,KAAK,CAAC,IAAI,UAAU,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,EAAE;EAC5D,gBAAgB,IAAI,QAAQ,GAAG,UAAU,CAAC,UAAU,CAAC,GAAG,UAAU,CAAC,IAAI,GAAG,IAAI,CAAC;EAC/E;EACA,gBAAgB,IAAI,QAAQ,KAAK,IAAI,IAAI,QAAQ,KAAK,KAAK,EAAE;EAC7D,oBAAoB,KAAK,CAAC,OAAO,CAAC,GAAGA,QAAgB,CAAC,EAAE,EAAE,QAAQ,CAAC,CAAC;EACpE,iBAAiB;EACjB,aAAa;EACb,YAAY,OAAO,KAAK,CAAC;EACzB,SAAS,EAAE,EAAE,CAAC,CAAC;EACf,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,UAAU,GAAG,UAAU,QAAQ,EAAE;EACzD,QAAQ,OAAO,0BAA0B,CAAC,MAAM,CAAC,UAAU,OAAO,EAAE,OAAO,EAAE;EAC7E,YAAY,IAAI,UAAU,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;EAC/C,YAAY,IAAI,UAAU,EAAE;EAC5B,gBAAgB,IAAI,MAAM,GAAG,UAAU,CAAC,UAAU,CAAC,GAAG,UAAU,CAAC,MAAM;EACvE,oBAAoB,CAAC,sBAAsB,CAAC,UAAU,CAAC,IAAI,UAAU,CAAC,SAAS,CAAC,QAAQ,CAAC,GAAG,IAAI,CAAC;EACjG,gBAAgB,IAAI,MAAM,KAAK,IAAI,IAAI,MAAM,KAAK,KAAK,EAAE;EACzD,oBAAoB,OAAO,CAAC,OAAO,CAAC,GAAGA,QAAgB,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;EACpE,iBAAiB;EACjB,aAAa;EACb,YAAY,OAAO,OAAO,CAAC;EAC3B,SAAS,EAAE,EAAE,CAAC,CAAC;EACf,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,SAAS,GAAG,YAAY;EAChD,QAAQ,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC;EAC9C,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,eAAe,GAAG,YAAY;EACtD,QAAQ,mBAAmB,CAAC,IAAI,CAAC,CAAC;EAClC,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACrD,QAAQ,IAAI,CAAC,SAAS,CAAC,SAAS,GAAG,kBAAkB,CAAC,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;EAC5E,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACrD,QAAQ,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,cAAc,CAAC,IAAI,CAAC,CAAC;EACnD,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,kBAAkB,GAAG,YAAY;EACzD,QAAQ,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,aAAa,CAAC,IAAI,CAAC,CAAC;EAClD,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,gCAAgC,GAAG,UAAU,OAAO,EAAE;EAC9E,QAAQ,OAAO,uBAAuB,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;EACtD,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,wBAAwB,GAAG,YAAY;EAC/D,QAAQ,OAAO,4BAA4B,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;EACtD,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,qBAAqB,GAAG,UAAU,IAAI,EAAE;EAChE,QAAQ,OAAO,yBAAyB,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;EACrD,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACrD,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,qBAAqB,GAAG,YAAY;EAC5D,QAAQ,OAAO,qBAAqB,CAAC,IAAI,CAAC,CAAC;EAC3C,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,aAAa,GAAG,YAAY;EACpD,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,EAAE,CAAC;EAC9C;EACA;EACA;EACA,QAAQ,IAAI,CAAC,IAAI,CAAC,MAAM,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;EACxD,YAAY,KAAK,GAAG,0BAA0B,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;EAC5D,SAAS;EACT,QAAQ,OAAO,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;EAChD,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,kBAAkB,GAAG,YAAY;EACzD,QAAQ,OAAO;EACf,YAAY,KAAK,EAAE,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC;EACjD,YAAY,MAAM,EAAE,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC;EACnD,SAAS,CAAC;EACV,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,UAAU,GAAG,YAAY;EACjD,QAAQ,OAAO,IAAI,CAAC,QAAQ,CAAC;EAC7B,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,MAAM,GAAG,UAAU,aAAa,EAAE,WAAW,EAAE;EACvE,QAAQ,IAAI,QAAQ,GAAG,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;EAChD,QAAQ,IAAI,IAAI,CAAC;EACjB,QAAQ,IAAI,GAAG;EACf,YAAY,IAAI,EAAE,IAAI,CAAC,OAAO;EAC9B,YAAY,QAAQ,EAAE,QAAQ;EAC9B,SAAS,CAAC;EACV,QAAQ,IAAI,CAAC,aAAa,EAAE;EAC5B,YAAY,IAAI,CAAC,MAAM,GAAG,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;EACjD,SAAS;EACT,QAAQ,IAAI,CAAC,WAAW,EAAE;EAC1B,YAAY,IAAI,CAAC,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EAC7C,SAAS;EACT;EACA,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK,CAAC;EACN,IAAI,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,SAAS,EAAE,MAAM,EAAE;EACvD,QAAQ,GAAG,EAAE,YAAY;EACzB,YAAY,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC;EACrC,SAAS;EACT,QAAQ,UAAU,EAAE,IAAI;EACxB,QAAQ,YAAY,EAAE,IAAI;EAC1B,KAAK,CAAC,CAAC;EACP,IAAI,SAAS,CAAC,SAAS,CAAC,eAAe,GAAG,UAAU,OAAO,EAAE;EAC7D,QAAQ,OAAOoG,eAA0B,CAAC,IAAI,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;EAClE,KAAK,CAAC;EACN,IAAI,SAAS,CAAC,SAAS,CAAC,QAAQ,GAAG,UAAU,OAAO,EAAE;EACtD,QAAQ,IAAI,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;EAChD,QAAQ,OAAO,WAAW,CAAC,UAAU,CAAC,CAAC;EACvC,KAAK,CAAC;EACN,IAAI,OAAO,SAAS,CAAC;EACrB,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC;;EClMnB,IAAI,UAAU,kBAAkB,UAAU,MAAM,EAAE;EAClD,IAAIlE,SAAiB,CAAC,UAAU,EAAE,MAAM,CAAC,CAAC;EAC1C,IAAI,SAAS,UAAU,CAAC,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,eAAe,EAAE,QAAQ,EAAE,MAAM,EAAE,GAAG,EAAE;EAC/F,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,MAAM,EAAE,QAAQ,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,IAAI,CAAC;EAC7G,QAAQ,KAAK,CAAC,IAAI,GAAG,OAAO,CAAC;EAC7B,QAAQ,IAAI,UAAU,GAAGlC,QAAgB,CAAC,EAAE,EAAE,eAAe,GAAG,IAAI,CAAC,KAAK,GAAG,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,EAAE,GAAG,EAAE,IAAI,IAAI,CAAC,MAAM,GAAG,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,EAAE,CAAC;EACxJ,QAAQ,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;EACnC,QAAQ,KAAK,CAAC,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,UAAU,KAAK,EAAE,CAAC,EAAE;EAC5D,YAAY,IAAI,WAAW,CAAC,KAAK,CAAC,EAAE;EACpC,gBAAgB,OAAO,IAAI,UAAU,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,QAAQ,GAAG,CAAC,CAAC,EAAE,UAAU,EAAE,QAAQ,EAAE,MAAM,EAAE,GAAG,CAAC,CAAC;EACpH,aAAa;EACb,YAAY,IAAI,UAAU,CAAC,KAAK,CAAC,EAAE;EACnC,gBAAgB,OAAO,IAAI,SAAS,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,OAAO,CAAC,QAAQ,GAAG,CAAC,CAAC,EAAE,UAAU,EAAE,QAAQ,EAAE,MAAM,EAAE,GAAG,CAAC,CAAC;EACnH,aAAa;EACb,YAAY,MAAM,IAAI,KAAK,CAACS,OAAW,CAAC,YAAY,CAAC,CAAC;EACtD,SAAS,CAAC,CAAC;EACX,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,UAAU,CAAC,SAAS,CAAC,SAAS,GAAG,YAAY;EACjD,QAAQ,IAAI,CAAC,SAAS,CAAC,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC,CAAC;EAC9C,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACnE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,KAAK,CAAC,SAAS,EAAE,CAAC;EAC9B,SAAS;EACT,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,eAAe,GAAG,YAAY;EACvD,QAAQ,oBAAoB,CAAC,IAAI,CAAC,CAAC;EACnC,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACtD,QAAQ,IAAI,KAAK,GAAG,IAAI,CAAC;EACzB;EACA;EACA;EACA,QAAQ,IAAI,CAAC,SAAS,CAAC,SAAS,GAAG,EAAE,CAAC;EACtC,QAAQ,IAAI,OAAO,GAAG,UAAU,KAAK,EAAE;EACvC,YAAY,KAAK,CAAC,cAAc,EAAE,CAAC;EACnC,YAAY,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,UAAU,GAAG,EAAE;EACnE,gBAAgB,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;EAChF,aAAa,CAAC,CAAC;EACf,SAAS,CAAC;EACV,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACnE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,OAAO,CAAC,KAAK,CAAC,CAAC;EAC3B,SAAS;EACT,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACtD,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACnE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,KAAK,CAAC,cAAc,EAAE,CAAC;EACnC,SAAS;EACT,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,kBAAkB,GAAG,YAAY;EAC1D,QAAQ,cAAc,CAAC,IAAI,CAAC,CAAC;EAC7B,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,gCAAgC,GAAG,UAAU,OAAO,EAAE;EAC/E,QAAQ,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,EAAE,EAAE,KAAK,EAAE,EAAE,OAAO,KAAK,CAAC,gCAAgC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,OAAO,CAAC,CAAC;EAC1H,KAAK,CAAC;EACN;EACA,IAAI,UAAU,CAAC,SAAS,CAAC,wBAAwB,GAAG,YAAY;EAChE,QAAQ,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,OAAO,EAAE,KAAK,EAAE;EAC9D,YAAY,OAAO,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,wBAAwB,EAAE,CAAC,CAAC;EACpE,SAAS,EAAE,EAAE,CAAC,CAAC;EACf,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,qBAAqB,GAAG,YAAY;EAC7D,QAAQ,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,OAAO,EAAE,KAAK,EAAE;EAC9D,YAAY,OAAO,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,qBAAqB,EAAE,CAAC,CAAC;EACjE,SAAS,EAAE,qBAAqB,CAAC,IAAI,CAAC,CAAC,CAAC;EACxC,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,qBAAqB,GAAG,UAAU,IAAI,EAAE;EACjE,QAAQ,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,EAAE,EAAE,KAAK,EAAE,EAAE,OAAO,KAAK,CAAC,qBAAqB,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;EAC5G,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,aAAa,GAAG,YAAY;EACrD,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,SAAS,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EAC9D,QAAQ,IAAI,KAAK,EAAE;EACnB,YAAY,OAAO,KAAK,CAAC;EACzB,SAAS;EACT;EACA,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI,CAAC,QAAQ,EAAE,EAAE,GAAG,EAAE,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EACnE,YAAY,IAAI,KAAK,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC;EAC/B,YAAY,KAAK,GAAG,KAAK,CAAC,aAAa,EAAE,CAAC;EAC1C,YAAY,IAAI,KAAK,EAAE;EACvB,gBAAgB,OAAO,KAAK,CAAC;EAC7B,aAAa;EACb,SAAS;EACT,QAAQ,OAAO,SAAS,CAAC;EACzB,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACtD,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,aAAa,GAAG,YAAY;EACrD,QAAQ,OAAO,2BAA2B,CAAC,IAAI,EAAE,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,UAAU,KAAK,EAAE;EAC5F,YAAY,OAAO,KAAK,CAAC,aAAa,EAAE,CAAC;EACzC,SAAS,CAAC,CAAC,CAAC,CAAC;EACb,KAAK,CAAC;EACN,IAAI,UAAU,CAAC,SAAS,CAAC,eAAe,GAAG,YAAY;EACvD,QAAQ,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,UAAU,OAAO,EAAE,KAAK,EAAE;EAC9D,YAAY,OAAO,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,eAAe,EAAE,CAAC,CAAC;EAC3D,SAAS,EAAE,eAAe,CAAC,IAAI,CAAC,CAAC,CAAC;EAClC,KAAK,CAAC;EACN,IAAI,OAAO,UAAU,CAAC;EACtB,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;;EC3GV,IAAI,WAAW,kBAAkB,UAAU,MAAM,EAAE;EACnD,IAAIyB,SAAiB,CAAC,WAAW,EAAE,MAAM,CAAC,CAAC;EAC3C,IAAI,SAAS,WAAW,CAAC,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,YAAY,EAAE,MAAM,EAAE;EAC9E,QAAQ,IAAI,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,MAAM,EAAE,YAAY,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,IAAI,CAAC;EACjH,QAAQ,KAAK,CAAC,IAAI,GAAG,QAAQ,CAAC;EAC9B,QAAQ,IAAI,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,KAAK,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,KAAK,QAAQ,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,KAAK,QAAQ,CAAC,EAAE;EACzH,YAAY1B,IAAQ,CAACC,OAAW,CAAC,wBAAwB,CAAC,CAAC;EAC3D,SAAS;EACT,QAAQ,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;EACnC,QAAQ,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,aAAa,CAAC,IAAI,EAAE,KAAK,CAAC,MAAM,EAAE,YAAY,EAAE,MAAM,CAAC,CAAC;EACvF,QAAQ,OAAO,KAAK,CAAC;EACrB,KAAK;EACL,IAAI,WAAW,CAAC,SAAS,CAAC,aAAa,GAAG,UAAU,IAAI,EAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE;EACpF,QAAQ,IAAI,QAAQ,GAAG,EAAE,CAAC;EAC1B,QAAQ,IAAI,GAAG,GAAG,MAAM,CAAC,GAAG,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC,GAAG,GAAG,IAAI,CAAC,CAAC;EACjE,QAAQ,IAAI,MAAM,GAAG,MAAM,CAAC,MAAM,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC,MAAM,GAAG,IAAI,CAAC,CAAC;EAC1E;EACA,QAAQ,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,KAAK,GAAG,GAAG,EAAE,EAAE,GAAG,KAAK,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC/D,YAAY,IAAI,QAAQ,GAAG,KAAK,CAAC,EAAE,CAAC,CAAC;EACrC,YAAY,KAAK,IAAI,EAAE,GAAG,CAAC,EAAE,QAAQ,GAAG,MAAM,EAAE,EAAE,GAAG,QAAQ,CAAC,MAAM,EAAE,EAAE,EAAE,EAAE;EAC5E,gBAAgB,IAAI,WAAW,GAAG,QAAQ,CAAC,EAAE,CAAC,CAAC;EAC/C,gBAAgB,IAAI,MAAM,GAAG,CAAC,QAAQ,GAAG,GAAG,GAAG,QAAQ,GAAG,EAAE,KAAK,WAAW,GAAG,GAAG,GAAG,WAAW,GAAG,EAAE,CAAC,CAAC;EACvG,gBAAgB,IAAI,WAAW,GAAG;EAClC,oBAAoB,GAAG,EAAE,QAAQ;EACjC,oBAAoB,MAAM,EAAE,WAAW;EACvC,iBAAiB,CAAC;EAClB,gBAAgB,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,MAAM,CAAC,EAAE,SAAS,EAAE,WAAW,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC;EAClI,aAAa;EACb,SAAS;EACT,QAAQ,OAAO,QAAQ,CAAC;EACxB,KAAK,CAAC;EACN,IAAI,WAAW,CAAC,SAAS,CAAC,eAAe,GAAG,YAAY;EACxD,QAAQ,qBAAqB,CAAC,IAAI,CAAC,CAAC;EACpC,KAAK,CAAC;EACN,IAAI,WAAW,CAAC,SAAS,CAAC,cAAc,GAAG,YAAY;EACvD;EACA,QAAQ,OAAO;EACf,YAAY,OAAO,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE;EAC5C,YAAY,MAAM,EAAE,EAAE;EACtB,YAAY,OAAO,EAAE,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC;EACtF,YAAY,MAAM,EAAE,MAAM;EAC1B,YAAY,KAAK,EAAE,KAAK;EACxB,SAAS,CAAC;EACV,KAAK,CAAC;EACN,IAAI,OAAO,WAAW,CAAC;EACvB,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC;;EC3Cb,SAAS,UAAU,CAAC,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,QAAQ,EAAE,QAAQ,EAAE,MAAM,EAAE,GAAG,EAAE;EAC3F,IAAI,IAAI,WAAW,CAAC,IAAI,CAAC,EAAE;EAC3B,QAAQ,OAAO,IAAI,UAAU,CAAC,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;EAC/E,KAAK;EACL,IAAI,IAAI,WAAW,CAAC,IAAI,CAAC,EAAE;EAC3B,QAAQ,OAAO,IAAI,UAAU,CAAC,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,QAAQ,EAAE,QAAQ,EAAE,MAAM,EAAE,GAAG,CAAC,CAAC;EAC9F,KAAK;EACL,IAAI,IAAI,UAAU,CAAC,IAAI,CAAC,EAAE;EAC1B,QAAQ,OAAO,IAAI,SAAS,CAAC,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,QAAQ,EAAE,QAAQ,EAAE,MAAM,EAAE,GAAG,CAAC,CAAC;EAC7F,KAAK;EACL,IAAI,IAAI,YAAY,CAAC,IAAI,CAAC,EAAE;EAC5B,QAAQ,OAAO,IAAI,WAAW,CAAC,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;EAChF,KAAK;EACL,IAAI,IAAI,YAAY,CAAC,IAAI,CAAC,EAAE;EAC5B,QAAQ,OAAO,IAAI,WAAW,CAAC,IAAI,EAAE,MAAM,EAAE,eAAe,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;EAChF,KAAK;EACL,IAAI,MAAM,IAAI,KAAK,CAACA,OAAW,CAAC,YAAY,CAAC,CAAC;EAC9C,CAAC;;ECdD;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,OAAO,CAAC,SAAS,EAAE,GAAG,EAAE;EACxC,IAAI,IAAI,GAAG,KAAK,KAAK,CAAC,EAAE,EAAE,GAAG,GAAG,EAAE,CAAC,EAAE;EACrC;EACA,IAAI,IAAI,GAAG,CAAC,MAAM,EAAE;EACpB;EACA,QAAQ4F,GAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;EAC5B,KAAK;EACL,IAAI,IAAI,GAAG,CAAC,UAAU,EAAE;EACxB;EACA,QAAQC,iBAA4B,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;EACrD,KAAK;EACL,IAAI,IAAI;EACR;EACA,QAAQ,IAAI,MAAM,GAAG,UAAU,CAAC,SAAS,CAAC,EAAE,EAAE,GAAG,CAAC,MAAM,EAAE,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;EAC7E;EACA;EACA,QAAQ,IAAI,IAAI,GAAG3F,WAAS,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;EAChD;EACA,QAAQ,IAAI,QAAQ,GAAG,iBAAiB,CAAC,SAAS,CAAC,QAAQ,EAAE,MAAM,CAAC,QAAQ,EAAE,WAAW,CAAC,IAAI,CAAC,IAAI,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC;EACrH;EACA;EACA;EACA,QAAQ,IAAI,KAAK,GAAG,UAAU,CAAC,IAAI,EAAE,IAAI,EAAE,EAAE,EAAE,SAAS,EAAE,SAAS,EAAE,MAAM,EAAE,QAAQ,CAAC,IAAI,KAAK,KAAK,CAAC,CAAC;EACtG;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA,QAAQ,KAAK,CAAC,KAAK,EAAE,CAAC;EACtB;EACA,QAAQ,gBAAgB,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;EAC/C;EACA,QAAQ,OAAO,qBAAqB,CAAC,KAAK,EAAE,qBAAqB,CAAC,SAAS,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,CAAC;EAChG,KAAK;EACL,YAAY;EACZ;EACA,QAAQ,IAAI,GAAG,CAAC,MAAM,EAAE;EACxB,YAAY4F,KAAS,EAAE,CAAC;EACxB,SAAS;EACT;EACA,QAAQ,IAAI,GAAG,CAAC,UAAU,EAAE;EAC5B,YAAYC,mBAA8B,EAAE,CAAC;EAC7C,SAAS;EACT,KAAK;EACL,CAAC;EACD,SAAS,qBAAqB,CAAC,YAAY,EAAE,MAAM,EAAE,QAAQ,EAAE;EAC/D,IAAI,OAAOxG,QAAgB,CAAC,EAAE,QAAQ,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,MAAM,KAAK,CAAC,IAAI,QAAQ,CAAC,IAAI,GAAG,QAAQ,CAAC,IAAI,GAAG,QAAQ,EAAE,EAAE,yBAAyB,CAAC,MAAM,CAAC,EAAE,yBAAyB,CAAC,YAAY,CAAC,CAAC,CAAC;EAC/L,CAAC;EACD;EACA;EACA;EACA;EACA;EACA;EACA,SAAS,qBAAqB,CAAC,KAAK,EAAE,kBAAkB,EAAE;EAC1D;EACA;EACA,IAAI,IAAI,QAAQ,GAAG,KAAK,CAAC,MAAM,GAAG,sBAAsB,CAAC,KAAK,CAAC,MAAM,CAAC,GAAG,SAAS,CAAC;EACnF,IAAI,IAAI,IAAI,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,qBAAqB,CAAC,EAAE,CAAC;EACxD;EACA,IAAI,gBAAgB,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,EAAE,kBAAkB,CAAC,QAAQ,IAAI,EAAE,CAAC,CAAC,CAAC;EAC/E,IAAI,OAAO,kBAAkB,CAAC,QAAQ,CAAC;EACvC,IAAI,IAAI,WAAW,GAAG,KAAK,CAAC,mBAAmB,EAAE,CAAC;EAClD,IAAI,IAAIqB,QAAK,GAAG,KAAK,CAAC,aAAa,EAAE,CAAC;EACtC,IAAI,IAAI,KAAK,GAAG,KAAK,CAAC,kBAAkB,EAAE,CAAC;EAC3C,IAAI,IAAI,aAAa,GAAG,KAAK,CAAC,qBAAqB,EAAE,CAAC;EACtD;EACA,IAAI,aAAa,GAAG,aAAa,CAAC,MAAM,CAAC,UAAU,MAAM,EAAE;EAC3D,QAAQ,IAAI,CAAC,MAAM,CAAC,IAAI,KAAK,OAAO,IAAI,MAAM,CAAC,IAAI,KAAK,QAAQ,KAAK,MAAM,CAAC,KAAK,KAAK,SAAS,EAAE;EACjG,YAAY,kBAAkB,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC;EAC5D,YAAY,OAAO,KAAK,CAAC;EACzB,SAAS;EACT,QAAQ,OAAO,IAAI,CAAC;EACpB,KAAK,CAAC,CAAC;EACP,IAAI,IAAI,MAAM,GAAGrB,QAAgB,CAAC,EAAE,OAAO,EAAE,4CAA4C,EAAE,GAAG,KAAK,CAAC,WAAW,GAAG,EAAE,WAAW,EAAE,KAAK,CAAC,WAAW,EAAE,GAAG,EAAE,GAAG,kBAAkB,GAAGqB,QAAK,GAAG,EAAE,KAAK,EAAEA,QAAK,EAAE,GAAG,EAAE,IAAI,KAAK,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,WAAW,CAAC,MAAM,GAAG,CAAC,GAAG,EAAE,WAAW,EAAE,WAAW,EAAE,GAAG,EAAE,GAAG,KAAK,CAAC,aAAa,CAAC,aAAa,CAAC,MAAM,CAAC,KAAK,CAAC,gCAAgC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,QAAQ,GAAG,EAAE,MAAM,EAAE,QAAQ,EAAE,GAAG,EAAE,EAAE,CAAC;EAC/b,IAAI,OAAO;EACX,QAAQ,IAAI,EAAE,MAAM;EACpB;EACA,KAAK,CAAC;EACN,CAAC;;;;;;;;ECtHD;EACA;EACA;AACA,EAAO,IAAI,4BAA4B,GAAG;EAC1C,IAAI,IAAI,EAAE,CAAC,MAAM,CAAC;EAClB,IAAI,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC;EACpB,IAAI,KAAK,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC;EACrB,IAAI,IAAI,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC;EACpB,CAAC,CAAC;EACF;EACA;EACA;AACA,EAAO,IAAI,8BAA8B,GAAG;EAC5C,IAAI,GAAG,EAAE,KAAK,CAAC,CAAC,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAG,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;EACxF,IAAI,IAAI,EAAE,KAAK,CAAC,CAAC,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC;EAC1F,IAAI,KAAK,EAAE,KAAK,CAAC,CAAC,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;EACnG,IAAI,IAAI,EAAE,KAAK,CAAC,CAAC,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;EACjF,IAAI,IAAI,EAAE,KAAK,CAAC,CAAC,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;EACjF,IAAI,MAAM,EAAE,KAAK,CAAC,CAAC,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC;EAC3F,IAAI,MAAM,EAAE,KAAK,CAAC,CAAC,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC;EAC3F,IAAI,KAAK,EAAE,KAAK,CAAC,CAAC,KAAK,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;EACnG,IAAI,QAAQ,EAAE,KAAK,CAAC,CAAC,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;EACpF,IAAI,IAAI,EAAE,KAAK,CAAC,CAAC,KAAK,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;EAC7E,CAAC,CAAC;EACF;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;AACA,EAAO,SAAS,uBAAuB,CAAC,IAAI,EAAE,kBAAkB,EAAE,mBAAmB,EAAE;EACvF,IAAI,IAAI,kBAAkB,KAAK,KAAK,CAAC,EAAE,EAAE,kBAAkB,GAAG,4BAA4B,CAAC,EAAE;EAC7F,IAAI,IAAI,mBAAmB,KAAK,KAAK,CAAC,EAAE,EAAE,mBAAmB,GAAG,8BAA8B,CAAC,EAAE;EACjG,IAAI,IAAI,IAAI,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;EACjE,IAAI,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;EACjC,IAAI,IAAI,gBAAgB,GAAG,kBAAkB,CAAC,IAAI,CAAC,CAAC;EACpD,IAAI,IAAI,iBAAiB,GAAG,mBAAmB,CAAC,IAAI,CAAC,CAAC;EACtD,IAAI,KAAK,IAAI,CAAC,IAAI,gBAAgB,EAAE;EACpC,QAAQ,IAAI,EAAE,gBAAgB,CAAC,CAAC,CAAC,IAAI,QAAQ,CAAC,EAAE;EAChD,YAAY,OAAO,6BAA6B,GAAG,gBAAgB,CAAC,CAAC,CAAC;EACtE,gBAAgB,gBAAgB,GAAG,IAAI,GAAG,IAAI,CAAC;EAC/C,SAAS;EACT,KAAK;EACL,IAAI,KAAK,IAAI,OAAO,IAAI,QAAQ,EAAE;EAClC,QAAQ,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,EAAE;EACzC,YAAY,OAAO,qBAAqB,GAAG,OAAO;EAClD,gBAAgB,qCAAqC,GAAG,IAAI,GAAG,IAAI,CAAC;EACpE,SAAS;EACT,KAAK;EACL,IAAI,IAAI,IAAI,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,EAAE;EACpD,QAAQ,OAAO,8BAA8B,CAAC;EAC9C,KAAK;EACL,IAAI,OAAO,IAAI,CAAC;EAChB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}