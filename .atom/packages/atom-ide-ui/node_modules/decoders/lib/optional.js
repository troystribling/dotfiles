'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.undefined_or_null = undefined;
exports.optional = optional;

var _debrief = require('debrief');

var _lemons = require('lemons');

var _constants = require('./constants');

var _either = require('./either');

/**
 * Decoder that only returns Ok for `null` or `undefined` inputs.  In both
 * cases, it will return `undefined`, so `null` inputs will get converted to
 * `undefined` outputs.  Err otherwise.
 */
var undefined_or_null = exports.undefined_or_null = function undefined_or_null(blob) {
  return blob === undefined || blob === null ? (0, _lemons.Ok)(undefined) : (0, _lemons.Err)((0, _debrief.annotate)(blob, 'Must be undefined or null'));
};

/**
 * Builds a Decoder that returns Ok for either `undefined` or `T` values,
 * given a Decoder for `T`.  Err otherwise.
 */
function optional(decoder) {
  var allowNull = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;

  return (0, _either.either)(allowNull ? undefined_or_null : _constants.undefined_, decoder);
}