var _chai = require('chai');

var _languageclient = require('../../lib/languageclient');

var _documentSyncAdapter = require('../../lib/adapters/document-sync-adapter');

var _documentSyncAdapter2 = _interopRequireDefault(_documentSyncAdapter);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

describe('DocumentSyncAdapter', () => {
  describe('canAdapt', () => {
    it('returns true if v2 incremental change notifications are supported', () => {
      const result = _documentSyncAdapter2.default.canAdapt({
        textDocumentSync: _languageclient.TextDocumentSyncKind.Incremental
      });
      (0, _chai.expect)(result).to.be.true;
    });

    it('returns true if v2 full change notifications are supported', () => {
      const result = _documentSyncAdapter2.default.canAdapt({
        textDocumentSync: _languageclient.TextDocumentSyncKind.Full
      });
      (0, _chai.expect)(result).to.be.true;
    });

    it('returns false if v2 none change notifications are supported', () => {
      const result = _documentSyncAdapter2.default.canAdapt({
        textDocumentSync: _languageclient.TextDocumentSyncKind.None
      });
      (0, _chai.expect)(result).to.be.false;
    });

    it('returns true if v3 incremental change notifications are supported', () => {
      const result = _documentSyncAdapter2.default.canAdapt({
        textDocumentSync: { change: _languageclient.TextDocumentSyncKind.Incremental }
      });
      (0, _chai.expect)(result).to.be.true;
    });

    it('returns true if v3 full change notifications are supported', () => {
      const result = _documentSyncAdapter2.default.canAdapt({
        textDocumentSync: { change: _languageclient.TextDocumentSyncKind.Full }
      });
      (0, _chai.expect)(result).to.be.true;
    });

    it('returns false if v3 none change notifications are supported', () => {
      const result = _documentSyncAdapter2.default.canAdapt({
        textDocumentSync: { change: _languageclient.TextDocumentSyncKind.None }
      });
      (0, _chai.expect)(result).to.be.false;
    });
  });

  describe('constructor', () => {
    function create(textDocumentSync) {
      return new _documentSyncAdapter2.default(null, textDocumentSync, null);
    }

    it('sets _documentSyncKind correctly Incremental for v2 capabilities', () => {
      const result = create(_languageclient.TextDocumentSyncKind.Incremental)._documentSyncKind;
      (0, _chai.expect)(result).equals(_languageclient.TextDocumentSyncKind.Incremental);
    });

    it('sets _documentSyncKind correctly Full for v2 capabilities', () => {
      const result = create(_languageclient.TextDocumentSyncKind.Full)._documentSyncKind;
      (0, _chai.expect)(result).equals(_languageclient.TextDocumentSyncKind.Full);
    });

    it('sets _documentSyncKind correctly Incremental for v3 capabilities', () => {
      const result = create({ change: _languageclient.TextDocumentSyncKind.Incremental })._documentSyncKind;
      (0, _chai.expect)(result).equals(_languageclient.TextDocumentSyncKind.Incremental);
    });

    it('sets _documentSyncKind correctly Full for v3 capabilities', () => {
      const result = create({ change: _languageclient.TextDocumentSyncKind.Full })._documentSyncKind;
      (0, _chai.expect)(result).equals(_languageclient.TextDocumentSyncKind.Full);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3Rlc3QvYWRhcHRlcnMvZG9jdW1lbnQtc3luYy1hZGFwdGVyLnRlc3QuanMiXSwibmFtZXMiOlsiZGVzY3JpYmUiLCJpdCIsInJlc3VsdCIsImNhbkFkYXB0IiwidGV4dERvY3VtZW50U3luYyIsIkluY3JlbWVudGFsIiwidG8iLCJiZSIsInRydWUiLCJGdWxsIiwiTm9uZSIsImZhbHNlIiwiY2hhbmdlIiwiY3JlYXRlIiwiX2RvY3VtZW50U3luY0tpbmQiLCJlcXVhbHMiXSwibWFwcGluZ3MiOiJBQUVBOztBQUNBOztBQUNBOzs7Ozs7QUFFQUEsU0FBUyxxQkFBVCxFQUFnQyxNQUFNO0FBQ3BDQSxXQUFTLFVBQVQsRUFBcUIsTUFBTTtBQUN6QkMsT0FBRyxtRUFBSCxFQUF3RSxNQUFNO0FBQzVFLFlBQU1DLFNBQVMsOEJBQW9CQyxRQUFwQixDQUE2QjtBQUMxQ0MsMEJBQWtCLHFDQUFxQkM7QUFERyxPQUE3QixDQUFmO0FBR0Esd0JBQU9ILE1BQVAsRUFBZUksRUFBZixDQUFrQkMsRUFBbEIsQ0FBcUJDLElBQXJCO0FBQ0QsS0FMRDs7QUFPQVAsT0FBRyw0REFBSCxFQUFpRSxNQUFNO0FBQ3JFLFlBQU1DLFNBQVMsOEJBQW9CQyxRQUFwQixDQUE2QjtBQUMxQ0MsMEJBQWtCLHFDQUFxQks7QUFERyxPQUE3QixDQUFmO0FBR0Esd0JBQU9QLE1BQVAsRUFBZUksRUFBZixDQUFrQkMsRUFBbEIsQ0FBcUJDLElBQXJCO0FBQ0QsS0FMRDs7QUFPQVAsT0FBRyw2REFBSCxFQUFrRSxNQUFNO0FBQ3RFLFlBQU1DLFNBQVMsOEJBQW9CQyxRQUFwQixDQUE2QjtBQUMxQ0MsMEJBQWtCLHFDQUFxQk07QUFERyxPQUE3QixDQUFmO0FBR0Esd0JBQU9SLE1BQVAsRUFBZUksRUFBZixDQUFrQkMsRUFBbEIsQ0FBcUJJLEtBQXJCO0FBQ0QsS0FMRDs7QUFPQVYsT0FBRyxtRUFBSCxFQUF3RSxNQUFNO0FBQzVFLFlBQU1DLFNBQVMsOEJBQW9CQyxRQUFwQixDQUE2QjtBQUMxQ0MsMEJBQWtCLEVBQUNRLFFBQVEscUNBQXFCUCxXQUE5QjtBQUR3QixPQUE3QixDQUFmO0FBR0Esd0JBQU9ILE1BQVAsRUFBZUksRUFBZixDQUFrQkMsRUFBbEIsQ0FBcUJDLElBQXJCO0FBQ0QsS0FMRDs7QUFPQVAsT0FBRyw0REFBSCxFQUFpRSxNQUFNO0FBQ3JFLFlBQU1DLFNBQVMsOEJBQW9CQyxRQUFwQixDQUE2QjtBQUMxQ0MsMEJBQWtCLEVBQUNRLFFBQVEscUNBQXFCSCxJQUE5QjtBQUR3QixPQUE3QixDQUFmO0FBR0Esd0JBQU9QLE1BQVAsRUFBZUksRUFBZixDQUFrQkMsRUFBbEIsQ0FBcUJDLElBQXJCO0FBQ0QsS0FMRDs7QUFPQVAsT0FBRyw2REFBSCxFQUFrRSxNQUFNO0FBQ3RFLFlBQU1DLFNBQVMsOEJBQW9CQyxRQUFwQixDQUE2QjtBQUMxQ0MsMEJBQWtCLEVBQUNRLFFBQVEscUNBQXFCRixJQUE5QjtBQUR3QixPQUE3QixDQUFmO0FBR0Esd0JBQU9SLE1BQVAsRUFBZUksRUFBZixDQUFrQkMsRUFBbEIsQ0FBcUJJLEtBQXJCO0FBQ0QsS0FMRDtBQU1ELEdBMUNEOztBQTRDQVgsV0FBUyxhQUFULEVBQXdCLE1BQU07QUFDNUIsYUFBU2EsTUFBVCxDQUFnQlQsZ0JBQWhCLEVBQWtDO0FBQ2hDLGFBQU8sa0NBQXlCLElBQXpCLEVBQXFDQSxnQkFBckMsRUFBd0QsSUFBeEQsQ0FBUDtBQUNEOztBQUVESCxPQUFHLGtFQUFILEVBQXVFLE1BQU07QUFDM0UsWUFBTUMsU0FBU1csT0FBTyxxQ0FBcUJSLFdBQTVCLEVBQXlDUyxpQkFBeEQ7QUFDQSx3QkFBT1osTUFBUCxFQUFlYSxNQUFmLENBQXNCLHFDQUFxQlYsV0FBM0M7QUFDRCxLQUhEOztBQUtBSixPQUFHLDJEQUFILEVBQWdFLE1BQU07QUFDcEUsWUFBTUMsU0FBU1csT0FBTyxxQ0FBcUJKLElBQTVCLEVBQWtDSyxpQkFBakQ7QUFDQSx3QkFBT1osTUFBUCxFQUFlYSxNQUFmLENBQXNCLHFDQUFxQk4sSUFBM0M7QUFDRCxLQUhEOztBQUtBUixPQUFHLGtFQUFILEVBQXVFLE1BQU07QUFDM0UsWUFBTUMsU0FBU1csT0FBTyxFQUFDRCxRQUFRLHFDQUFxQlAsV0FBOUIsRUFBUCxFQUFtRFMsaUJBQWxFO0FBQ0Esd0JBQU9aLE1BQVAsRUFBZWEsTUFBZixDQUFzQixxQ0FBcUJWLFdBQTNDO0FBQ0QsS0FIRDs7QUFLQUosT0FBRywyREFBSCxFQUFnRSxNQUFNO0FBQ3BFLFlBQU1DLFNBQVNXLE9BQU8sRUFBQ0QsUUFBUSxxQ0FBcUJILElBQTlCLEVBQVAsRUFBNENLLGlCQUEzRDtBQUNBLHdCQUFPWixNQUFQLEVBQWVhLE1BQWYsQ0FBc0IscUNBQXFCTixJQUEzQztBQUNELEtBSEQ7QUFJRCxHQXhCRDtBQXlCRCxDQXRFRCIsImZpbGUiOiJkb2N1bWVudC1zeW5jLWFkYXB0ZXIudGVzdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIEBmbG93XHJcblxyXG5pbXBvcnQge2V4cGVjdH0gZnJvbSAnY2hhaSc7XHJcbmltcG9ydCB7VGV4dERvY3VtZW50U3luY0tpbmR9IGZyb20gJy4uLy4uL2xpYi9sYW5ndWFnZWNsaWVudCc7XHJcbmltcG9ydCBEb2N1bWVudFN5bmNBZGFwdGVyIGZyb20gJy4uLy4uL2xpYi9hZGFwdGVycy9kb2N1bWVudC1zeW5jLWFkYXB0ZXInO1xyXG5cclxuZGVzY3JpYmUoJ0RvY3VtZW50U3luY0FkYXB0ZXInLCAoKSA9PiB7XHJcbiAgZGVzY3JpYmUoJ2NhbkFkYXB0JywgKCkgPT4ge1xyXG4gICAgaXQoJ3JldHVybnMgdHJ1ZSBpZiB2MiBpbmNyZW1lbnRhbCBjaGFuZ2Ugbm90aWZpY2F0aW9ucyBhcmUgc3VwcG9ydGVkJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBEb2N1bWVudFN5bmNBZGFwdGVyLmNhbkFkYXB0KHtcclxuICAgICAgICB0ZXh0RG9jdW1lbnRTeW5jOiBUZXh0RG9jdW1lbnRTeW5jS2luZC5JbmNyZW1lbnRhbCxcclxuICAgICAgfSk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLnRydWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgncmV0dXJucyB0cnVlIGlmIHYyIGZ1bGwgY2hhbmdlIG5vdGlmaWNhdGlvbnMgYXJlIHN1cHBvcnRlZCcsICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gRG9jdW1lbnRTeW5jQWRhcHRlci5jYW5BZGFwdCh7XHJcbiAgICAgICAgdGV4dERvY3VtZW50U3luYzogVGV4dERvY3VtZW50U3luY0tpbmQuRnVsbCxcclxuICAgICAgfSk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLnRydWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgncmV0dXJucyBmYWxzZSBpZiB2MiBub25lIGNoYW5nZSBub3RpZmljYXRpb25zIGFyZSBzdXBwb3J0ZWQnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IERvY3VtZW50U3luY0FkYXB0ZXIuY2FuQWRhcHQoe1xyXG4gICAgICAgIHRleHREb2N1bWVudFN5bmM6IFRleHREb2N1bWVudFN5bmNLaW5kLk5vbmUsXHJcbiAgICAgIH0pO1xyXG4gICAgICBleHBlY3QocmVzdWx0KS50by5iZS5mYWxzZTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdyZXR1cm5zIHRydWUgaWYgdjMgaW5jcmVtZW50YWwgY2hhbmdlIG5vdGlmaWNhdGlvbnMgYXJlIHN1cHBvcnRlZCcsICgpID0+IHtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gRG9jdW1lbnRTeW5jQWRhcHRlci5jYW5BZGFwdCh7XHJcbiAgICAgICAgdGV4dERvY3VtZW50U3luYzoge2NoYW5nZTogVGV4dERvY3VtZW50U3luY0tpbmQuSW5jcmVtZW50YWx9LFxyXG4gICAgICB9KTtcclxuICAgICAgZXhwZWN0KHJlc3VsdCkudG8uYmUudHJ1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdyZXR1cm5zIHRydWUgaWYgdjMgZnVsbCBjaGFuZ2Ugbm90aWZpY2F0aW9ucyBhcmUgc3VwcG9ydGVkJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBEb2N1bWVudFN5bmNBZGFwdGVyLmNhbkFkYXB0KHtcclxuICAgICAgICB0ZXh0RG9jdW1lbnRTeW5jOiB7Y2hhbmdlOiBUZXh0RG9jdW1lbnRTeW5jS2luZC5GdWxsfSxcclxuICAgICAgfSk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLnRydWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgncmV0dXJucyBmYWxzZSBpZiB2MyBub25lIGNoYW5nZSBub3RpZmljYXRpb25zIGFyZSBzdXBwb3J0ZWQnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IERvY3VtZW50U3luY0FkYXB0ZXIuY2FuQWRhcHQoe1xyXG4gICAgICAgIHRleHREb2N1bWVudFN5bmM6IHtjaGFuZ2U6IFRleHREb2N1bWVudFN5bmNLaW5kLk5vbmV9LFxyXG4gICAgICB9KTtcclxuICAgICAgZXhwZWN0KHJlc3VsdCkudG8uYmUuZmFsc2U7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ2NvbnN0cnVjdG9yJywgKCkgPT4ge1xyXG4gICAgZnVuY3Rpb24gY3JlYXRlKHRleHREb2N1bWVudFN5bmMpIHtcclxuICAgICAgcmV0dXJuIG5ldyBEb2N1bWVudFN5bmNBZGFwdGVyKChudWxsOiBhbnkpLCB0ZXh0RG9jdW1lbnRTeW5jLCAobnVsbDogYW55KSk7XHJcbiAgICB9XHJcblxyXG4gICAgaXQoJ3NldHMgX2RvY3VtZW50U3luY0tpbmQgY29ycmVjdGx5IEluY3JlbWVudGFsIGZvciB2MiBjYXBhYmlsaXRpZXMnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGNyZWF0ZShUZXh0RG9jdW1lbnRTeW5jS2luZC5JbmNyZW1lbnRhbCkuX2RvY3VtZW50U3luY0tpbmQ7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLmVxdWFscyhUZXh0RG9jdW1lbnRTeW5jS2luZC5JbmNyZW1lbnRhbCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnc2V0cyBfZG9jdW1lbnRTeW5jS2luZCBjb3JyZWN0bHkgRnVsbCBmb3IgdjIgY2FwYWJpbGl0aWVzJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBjcmVhdGUoVGV4dERvY3VtZW50U3luY0tpbmQuRnVsbCkuX2RvY3VtZW50U3luY0tpbmQ7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLmVxdWFscyhUZXh0RG9jdW1lbnRTeW5jS2luZC5GdWxsKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzZXRzIF9kb2N1bWVudFN5bmNLaW5kIGNvcnJlY3RseSBJbmNyZW1lbnRhbCBmb3IgdjMgY2FwYWJpbGl0aWVzJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBjcmVhdGUoe2NoYW5nZTogVGV4dERvY3VtZW50U3luY0tpbmQuSW5jcmVtZW50YWx9KS5fZG9jdW1lbnRTeW5jS2luZDtcclxuICAgICAgZXhwZWN0KHJlc3VsdCkuZXF1YWxzKFRleHREb2N1bWVudFN5bmNLaW5kLkluY3JlbWVudGFsKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzZXRzIF9kb2N1bWVudFN5bmNLaW5kIGNvcnJlY3RseSBGdWxsIGZvciB2MyBjYXBhYmlsaXRpZXMnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGNyZWF0ZSh7Y2hhbmdlOiBUZXh0RG9jdW1lbnRTeW5jS2luZC5GdWxsfSkuX2RvY3VtZW50U3luY0tpbmQ7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQpLmVxdWFscyhUZXh0RG9jdW1lbnRTeW5jS2luZC5GdWxsKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59KTtcclxuIl19