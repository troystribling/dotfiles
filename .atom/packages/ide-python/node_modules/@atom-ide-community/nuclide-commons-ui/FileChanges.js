"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createCustomLineNumberGutter = createCustomLineNumberGutter;
exports.LoadingFileChanges = exports.default = exports.HunkDiff = void 0;

var _AtomTextEditor = require("./AtomTextEditor");

var _goToLocation = require("@atom-ide-community/nuclide-commons-atom/go-to-location");

var _LoadingSpinner = require("./LoadingSpinner");

var _nullthrows = _interopRequireDefault(require("nullthrows"));

var _string = require("@atom-ide-community/nuclide-commons/string");

var _atom = require("atom");

var React = _interopRequireWildcard(require("react"));

var _reactDom = _interopRequireDefault(require("react-dom"));

var _renderReactRoot = require("./renderReactRoot");

var _Section = require("./Section");

var _UniversalDisposable = _interopRequireDefault(require("@atom-ide-community/nuclide-commons/UniversalDisposable"));

var _classnames = _interopRequireDefault(require("classnames"));

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Copyright (c) 2017-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * 
 * @format
 */
const MAX_GUTTER_WIDTH = 5;

function getHighlightClass(type) {
  if (type === 'add') {
    return 'nuclide-ui-hunk-diff-insert';
  }

  if (type === 'del') {
    return 'nuclide-ui-hunk-diff-delete';
  }

  return null;
} // add a gutter to a text editor with line numbers defined by an iterable, as
// opposed to being forced to start at 1 and counting up


function createCustomLineNumberGutter(editor, lineNumbers, gutterWidth, options = {}) {
  const {
    extraName,
    onClick
  } = options; // 'nuclide-ui-file-changes-line-number-gutter-wX' makes a gutter Xem wide.
  // 'nuclide-ui-file-changes-line-number-gutter' makes a gutter 5em wide

  const suffix = gutterWidth > 0 && gutterWidth < MAX_GUTTER_WIDTH ? `-w${gutterWidth}` : '';
  let name = `nuclide-ui-file-changes-line-number-gutter${suffix}`;

  if (extraName != null) {
    name += ` ${extraName}`;
  }

  const gutter = editor.addGutter({
    name
  });
  let index = -1;

  for (const lineNumber of lineNumbers) {
    index++;

    if (lineNumber == null) {
      continue;
    }

    const marker = editor.markBufferPosition([index, 0], {
      invalidate: 'touch'
    });
    const item = createGutterItem(lineNumber, gutterWidth, onClick);
    gutter.decorateMarker(marker, {
      type: 'gutter',
      item
    });
    gutter.onDidDestroy(() => {
      marker.destroy();

      _reactDom.default.unmountComponentAtNode(item);
    });
  }

  return gutter;
}

const NBSP = '\xa0';

function createGutterItem(lineNumber, gutterWidth, onClick) {
  const fillWidth = gutterWidth - String(lineNumber).length; // Paralleling the original line-number implementation,
  // pad the line number with leading spaces.

  const filler = fillWidth > 0 ? new Array(fillWidth).fill(NBSP).join('') : ''; // Attempt to reuse the existing line-number styles.

  return (0, _renderReactRoot.renderReactRoot)( /*#__PURE__*/React.createElement("div", {
    onClick: onClick && (() => onClick(lineNumber)),
    className: (0, _classnames.default)('line-number', {
      clickable: onClick != null
    })
  }, filler, lineNumber));
}

class HunkDiff extends React.Component {
  constructor(props) {
    super(props);
    this.editor = void 0;
    this._disposables = void 0;
    this._disposables = new _UniversalDisposable.default( // enable copying filename
    // core:copy isn't used because it breaks the custom copy behavior below,
    // and this selection doesn't work easily with cmd-c anyway.
    atom.contextMenu.add({
      '.nuclide-ui-file-changes-item': [{
        label: 'Copy',
        command: 'nuclide-ui-file-changes-item:copy'
      }]
    }), atom.commands.add('.nuclide-ui-file-changes-item', 'nuclide-ui-file-changes-item:copy', event => {
      // need to strip out zero-width spaces that were added to the filename
      if (!(event.target instanceof HTMLElement)) {
        return;
      }

      const element = event.target;
      const text = element.innerText;

      if (text == null) {
        return;
      }

      const allSpacesRegex = new RegExp(_string.ZERO_WIDTH_SPACE, 'g');
      atom.clipboard.write(text.replace(allSpacesRegex, ''));
      event.stopPropagation();
    }));
  }

  componentDidMount() {
    const editor = (0, _nullthrows.default)(this.editor);

    this._createLineMarkers(editor);

    this._createLineNumbers(editor);
  }

  UNSAFE_componentWillReceiveProps(nextProps) {
    const {
      hunk,
      grammar
    } = nextProps;
    const changes = hunk.changes;
    const prevHunk = this.props.hunk;
    const editor = (0, _nullthrows.default)(this.editor);
    const newText = changes.map(change => change.content.slice(1)).join('\n');
    const oldText = prevHunk.changes.map(change => change.content.slice(1)).join('\n');
    const oldGrammar = this.props.grammar;

    if (newText === oldText && grammar === oldGrammar) {
      return;
    }

    if (newText !== oldText) {
      editor.setText(newText);
    }

    if (grammar !== oldGrammar) {
      editor.setGrammar(grammar);
    }

    this._disposables.dispose();

    this._disposables = new _UniversalDisposable.default();

    this._createLineMarkers(editor);

    this._createLineNumbers(editor);
  }

  shouldComponentUpdate(nextProps) {
    return false;
  }

  componentWillUnmount() {
    this._disposables.dispose();
  } // Line numbers are contiguous, but have a random starting point, so we can't use the
  // default line-number gutter.


  _createLineNumbers(editor) {
    const {
      changes,
      newStart: initialOffset
    } = this.props.hunk;
    const changeCount = changes.length;
    const maxDisplayLineNumber = initialOffset + changeCount - 1; // The maximum required gutter width for this hunk, in characters:

    const gutterWidth = String(maxDisplayLineNumber).length;
    let deletedLinesInSection = 0;
    let deletedLines = 0; // use a generator to avoid having to precalculate and store an array of
    // line numbers

    function* lineNumberGenerator() {
      for (let line = 0; line < changeCount; line++) {
        if (changes[line].type === 'del') {
          deletedLinesInSection++;
        } else {
          deletedLines += deletedLinesInSection;
          deletedLinesInSection = 0;
        }

        yield line + initialOffset - deletedLines;
      }
    }

    const gutter = createCustomLineNumberGutter(editor, lineNumberGenerator(), gutterWidth, {
      onClick: this.props.onClickLine
    });

    this._disposables.add(() => {
      gutter.destroy();
    });
  }
  /**
   * @param lineNumber A buffer line number to be highlighted.
   * @param type The type of highlight to be applied to the line.
   *             Could be a value of: ['insert', 'delete'].
   */


  _createLineMarkers(editor) {
    let hunkIndex = 0;

    for (const hunkChanges of this.props.hunk.changes) {
      const lineNumber = hunkIndex++;
      const range = new _atom.Range([lineNumber, 0], [lineNumber + 1, 0]);
      const marker = editor.markBufferRange(range, {
        invalidate: 'never'
      });
      const className = getHighlightClass(hunkChanges.type);

      if (className == null) {
        // No need to highlight normal lines.
        continue;
      }

      const decoration = editor.decorateMarker(marker, {
        type: 'highlight',
        class: className
      });

      this._disposables.add(() => {
        decoration.destroy();
      });
    }
  }

  render() {
    const {
      hunk,
      grammar,
      softWrapped
    } = this.props;
    const {
      changes
    } = hunk; // Remove the first character in each line (/[+- ]/) which indicates addition / deletion

    const text = changes.map(change => change.content.slice(1)).join('\n');
    const textBuffer = new _atom.TextBuffer();
    textBuffer.setText(text);
    return /*#__PURE__*/React.createElement(_AtomTextEditor.AtomTextEditor, {
      autoGrow: true,
      className: "nuclide-ui-hunk-diff-text-editor",
      correctContainerWidth: false,
      grammar: grammar,
      gutterHidden: true,
      readOnly: true,
      softWrapped: softWrapped,
      ref: editorRef => {
        // $FlowFixMe(>=0.53.0) Flow suppress
        this.editor = editorRef && editorRef.getModel();
      },
      textBuffer: textBuffer
    });
  }

}

exports.HunkDiff = HunkDiff;

function handleFilenameClick(fullPath, event) {
  if (fullPath == null) {
    return;
  }

  (0, _goToLocation.goToLocation)(fullPath);
  event.stopPropagation();
}

function renderFileChangeContainer(content, isPreview, collapsable, fullPath, displayPath, collapsedByDefault, hideHeadline, diff) {
  const {
    additions,
    annotation,
    deletions,
    from: fromFileName,
    to: toFileName
  } = diff != null ? diff : {
    additions: null,
    annotation: null,
    deletions: null,
    from: fullPath,
    to: fullPath
  };

  if (toFileName == null || fromFileName == null) {
    // sanity check: toFileName & fromFileName should always be given
    return null;
  }

  const fileName = displayPath != null ? displayPath : toFileName !== '/dev/null' ? toFileName : fromFileName;
  let annotationComponent;

  if (!isPreview && annotation != null) {
    annotationComponent = /*#__PURE__*/React.createElement("span", null, annotation.split('\n').map((line, index) => /*#__PURE__*/React.createElement("span", {
      key: index
    }, line, /*#__PURE__*/React.createElement("br", null))));
  }

  let addedOrDeletedString = '';

  if (toFileName === '/dev/null') {
    addedOrDeletedString = 'file deleted - ';
  } else if (fromFileName === '/dev/null') {
    addedOrDeletedString = 'file added - ';
  }

  const diffDetails = isPreview ? null : /*#__PURE__*/React.createElement("span", {
    className: "nuclide-ui-file-changes-details"
  }, annotationComponent, " (", addedOrDeletedString, additions + deletions, " ", (0, _string.pluralize)('line', additions + deletions), ")"); // insert zero-width spaces so filenames are wrapped at '/'

  const breakableFilename = fileName.replace(/\//g, '/' + _string.ZERO_WIDTH_SPACE);
  const renderedFilename = fullPath != null ? /*#__PURE__*/React.createElement("a", {
    className: "nuclide-ui-file-changes-name",
    onClick: handleFilenameClick.bind(null, fullPath)
  }, breakableFilename) : breakableFilename;

  if (hideHeadline) {
    return content;
  }

  const headline = /*#__PURE__*/React.createElement("span", {
    className: (0, _classnames.default)('nuclide-ui-file-changes-item', 'native-key-bindings'),
    tabIndex: -1
  }, renderedFilename, " ", diffDetails);
  return /*#__PURE__*/React.createElement(_Section.Section, {
    collapsable: collapsable === true,
    collapsedByDefault: collapsedByDefault === true,
    headline: headline,
    title: "Click to open"
  }, content);
}
/* Renders changes to a single file. */


class FileChanges extends React.Component {
  render() {
    const {
      collapsable,
      fullPath,
      displayPath,
      collapsedByDefault,
      hideHeadline,
      diff,
      grammar,
      softWrapped
    } = this.props;
    const {
      chunks,
      from: fromFileName,
      to: toFileName
    } = diff;

    if (toFileName == null || fromFileName == null) {
      // sanity check: toFileName & fromFileName should always be given
      return null;
    }

    const fileName = toFileName !== '/dev/null' ? toFileName : fromFileName;
    const hunks = [];
    let i = 0;

    for (const chunk of chunks) {
      if (i > 0) {
        hunks.push( /*#__PURE__*/React.createElement("div", {
          className: "nuclide-ui-hunk-diff-spacer",
          key: `spacer-${i}`
        }));
      }

      hunks.push(
      /*#__PURE__*/
      // $FlowFixMe(>=0.53.0) Flow suppress
      React.createElement(this.props.hunkComponentClass, {
        extraData: this.props.extraData,
        key: chunk.oldStart,
        grammar: grammar != null ? grammar : atom.grammars.selectGrammar(fileName, ''),
        hunk: chunk,
        onClickLine: line => {
          if (fullPath != null) {
            (0, _goToLocation.goToLocation)(fullPath, {
              line
            });
          }
        },
        softWrapped: softWrapped
      }));
      i++;
    }

    return renderFileChangeContainer(hunks,
    /* isPreview */
    false, collapsable, fullPath, displayPath, collapsedByDefault, hideHeadline, diff);
  }

}

exports.default = FileChanges;
FileChanges.defaultProps = {
  hunkComponentClass: HunkDiff
};

class LoadingFileChanges extends React.Component {
  constructor(...args) {
    super(...args);

    this._handleFilenameClick = event => {
      const {
        fullPath
      } = this.props;

      if (fullPath == null) {
        return;
      }

      (0, _goToLocation.goToLocation)(fullPath);
      event.stopPropagation();
    };
  }

  render() {
    const spinner = /*#__PURE__*/React.createElement(_LoadingSpinner.LoadingSpinner, {
      size: _LoadingSpinner.LoadingSpinnerSizes.EXTRA_SMALL,
      className: "nuclide-ui-file-changes-file-spinner"
    });
    const {
      collapsable,
      fullPath,
      displayPath,
      collapsedByDefault,
      hideHeadline
    } = this.props;
    return renderFileChangeContainer(spinner,
    /* isPreview */
    true, collapsable, fullPath, displayPath, collapsedByDefault, hideHeadline,
    /* diff */
    null);
  }

}

exports.LoadingFileChanges = LoadingFileChanges;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL251Y2xpZGUvbnVjbGlkZS1jb21tb25zLXVpL0ZpbGVDaGFuZ2VzLmpzIl0sIm5hbWVzIjpbIk1BWF9HVVRURVJfV0lEVEgiLCJnZXRIaWdobGlnaHRDbGFzcyIsInR5cGUiLCJjcmVhdGVDdXN0b21MaW5lTnVtYmVyR3V0dGVyIiwiZWRpdG9yIiwibGluZU51bWJlcnMiLCJndXR0ZXJXaWR0aCIsIm9wdGlvbnMiLCJleHRyYU5hbWUiLCJvbkNsaWNrIiwic3VmZml4IiwibmFtZSIsImd1dHRlciIsImFkZEd1dHRlciIsImluZGV4IiwibGluZU51bWJlciIsIm1hcmtlciIsIm1hcmtCdWZmZXJQb3NpdGlvbiIsImludmFsaWRhdGUiLCJpdGVtIiwiY3JlYXRlR3V0dGVySXRlbSIsImRlY29yYXRlTWFya2VyIiwib25EaWREZXN0cm95IiwiZGVzdHJveSIsIlJlYWN0RE9NIiwidW5tb3VudENvbXBvbmVudEF0Tm9kZSIsIk5CU1AiLCJmaWxsV2lkdGgiLCJTdHJpbmciLCJsZW5ndGgiLCJmaWxsZXIiLCJBcnJheSIsImZpbGwiLCJqb2luIiwiY2xpY2thYmxlIiwiSHVua0RpZmYiLCJSZWFjdCIsIkNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwicHJvcHMiLCJfZGlzcG9zYWJsZXMiLCJVbml2ZXJzYWxEaXNwb3NhYmxlIiwiYXRvbSIsImNvbnRleHRNZW51IiwiYWRkIiwibGFiZWwiLCJjb21tYW5kIiwiY29tbWFuZHMiLCJldmVudCIsInRhcmdldCIsIkhUTUxFbGVtZW50IiwiZWxlbWVudCIsInRleHQiLCJpbm5lclRleHQiLCJhbGxTcGFjZXNSZWdleCIsIlJlZ0V4cCIsIlpFUk9fV0lEVEhfU1BBQ0UiLCJjbGlwYm9hcmQiLCJ3cml0ZSIsInJlcGxhY2UiLCJzdG9wUHJvcGFnYXRpb24iLCJjb21wb25lbnREaWRNb3VudCIsIl9jcmVhdGVMaW5lTWFya2VycyIsIl9jcmVhdGVMaW5lTnVtYmVycyIsIlVOU0FGRV9jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzIiwibmV4dFByb3BzIiwiaHVuayIsImdyYW1tYXIiLCJjaGFuZ2VzIiwicHJldkh1bmsiLCJuZXdUZXh0IiwibWFwIiwiY2hhbmdlIiwiY29udGVudCIsInNsaWNlIiwib2xkVGV4dCIsIm9sZEdyYW1tYXIiLCJzZXRUZXh0Iiwic2V0R3JhbW1hciIsImRpc3Bvc2UiLCJzaG91bGRDb21wb25lbnRVcGRhdGUiLCJjb21wb25lbnRXaWxsVW5tb3VudCIsIm5ld1N0YXJ0IiwiaW5pdGlhbE9mZnNldCIsImNoYW5nZUNvdW50IiwibWF4RGlzcGxheUxpbmVOdW1iZXIiLCJkZWxldGVkTGluZXNJblNlY3Rpb24iLCJkZWxldGVkTGluZXMiLCJsaW5lTnVtYmVyR2VuZXJhdG9yIiwibGluZSIsIm9uQ2xpY2tMaW5lIiwiaHVua0luZGV4IiwiaHVua0NoYW5nZXMiLCJyYW5nZSIsIlJhbmdlIiwibWFya0J1ZmZlclJhbmdlIiwiY2xhc3NOYW1lIiwiZGVjb3JhdGlvbiIsImNsYXNzIiwicmVuZGVyIiwic29mdFdyYXBwZWQiLCJ0ZXh0QnVmZmVyIiwiVGV4dEJ1ZmZlciIsImVkaXRvclJlZiIsImdldE1vZGVsIiwiaGFuZGxlRmlsZW5hbWVDbGljayIsImZ1bGxQYXRoIiwicmVuZGVyRmlsZUNoYW5nZUNvbnRhaW5lciIsImlzUHJldmlldyIsImNvbGxhcHNhYmxlIiwiZGlzcGxheVBhdGgiLCJjb2xsYXBzZWRCeURlZmF1bHQiLCJoaWRlSGVhZGxpbmUiLCJkaWZmIiwiYWRkaXRpb25zIiwiYW5ub3RhdGlvbiIsImRlbGV0aW9ucyIsImZyb20iLCJmcm9tRmlsZU5hbWUiLCJ0byIsInRvRmlsZU5hbWUiLCJmaWxlTmFtZSIsImFubm90YXRpb25Db21wb25lbnQiLCJzcGxpdCIsImFkZGVkT3JEZWxldGVkU3RyaW5nIiwiZGlmZkRldGFpbHMiLCJicmVha2FibGVGaWxlbmFtZSIsInJlbmRlcmVkRmlsZW5hbWUiLCJiaW5kIiwiaGVhZGxpbmUiLCJGaWxlQ2hhbmdlcyIsImNodW5rcyIsImh1bmtzIiwiaSIsImNodW5rIiwicHVzaCIsImV4dHJhRGF0YSIsIm9sZFN0YXJ0IiwiZ3JhbW1hcnMiLCJzZWxlY3RHcmFtbWFyIiwiZGVmYXVsdFByb3BzIiwiaHVua0NvbXBvbmVudENsYXNzIiwiTG9hZGluZ0ZpbGVDaGFuZ2VzIiwiX2hhbmRsZUZpbGVuYW1lQ2xpY2siLCJzcGlubmVyIiwiTG9hZGluZ1NwaW5uZXJTaXplcyIsIkVYVFJBX1NNQUxMIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQWNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7OztBQXpCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBZ0RBLE1BQU1BLGdCQUFnQixHQUFHLENBQXpCOztBQUVBLFNBQVNDLGlCQUFULENBQTJCQyxJQUEzQixFQUFpRTtBQUMvRCxNQUFJQSxJQUFJLEtBQUssS0FBYixFQUFvQjtBQUNsQixXQUFPLDZCQUFQO0FBQ0Q7O0FBQ0QsTUFBSUEsSUFBSSxLQUFLLEtBQWIsRUFBb0I7QUFDbEIsV0FBTyw2QkFBUDtBQUNEOztBQUNELFNBQU8sSUFBUDtBQUNELEMsQ0FFRDtBQUNBOzs7QUFDTyxTQUFTQyw0QkFBVCxDQUNMQyxNQURLLEVBRUxDLFdBRkssRUFHTEMsV0FISyxFQUlMQyxPQUdDLEdBQUcsRUFQQyxFQVFRO0FBQ2IsUUFBTTtBQUFDQyxJQUFBQSxTQUFEO0FBQVlDLElBQUFBO0FBQVosTUFBdUJGLE9BQTdCLENBRGEsQ0FFYjtBQUNBOztBQUNBLFFBQU1HLE1BQU0sR0FDVkosV0FBVyxHQUFHLENBQWQsSUFBbUJBLFdBQVcsR0FBR04sZ0JBQWpDLEdBQXFELEtBQUlNLFdBQVksRUFBckUsR0FBeUUsRUFEM0U7QUFFQSxNQUFJSyxJQUFJLEdBQUksNkNBQTRDRCxNQUFPLEVBQS9EOztBQUNBLE1BQUlGLFNBQVMsSUFBSSxJQUFqQixFQUF1QjtBQUNyQkcsSUFBQUEs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TixTQUFpQzFHLEtBQUssQ0FBQ0MsU0FBdkMsQ0FBK0Q7QUFBQTtBQUFBOztBQUFBLFNBQ3BFMEcsb0JBRG9FLEdBQzVDL0YsS0FBRCxJQUF3QztBQUM3RCxZQUFNO0FBQUMwRCxRQUFBQTtBQUFELFVBQWEsS0FBS25FLEtBQXhCOztBQUNBLFVBQUltRSxRQUFRLElBQUksSUFBaEIsRUFBc0I7QUFDcEI7QUFDRDs7QUFDRCxzQ0FBYUEsUUFBYjtBQUNBMUQsTUFBQUEsS0FBSyxDQUFDWSxlQUFOO0FBQ0QsS0FSbUU7QUFBQTs7QUFVcEV1QyxFQUFBQSxNQUFNLEdBQWU7QUFDbkIsVUFBTTZDLE9BQU8sZ0JBQ1gsb0JBQUMsOEJBQUQ7QUFDRSxNQUFBLElBQUksRUFBRUMsb0NBQW9CQyxXQUQ1QjtBQUVFLE1BQUEsU0FBUyxFQUFDO0FBRlosTUFERjtBQU9BLFVBQU07QUFDSnJDLE1BQUFBLFdBREk7QUFFSkgsTUFBQUEsUUFGSTtBQUdKSSxNQUFBQSxXQUhJO0FBSUpDLE1BQUFBLGtCQUpJO0FBS0pDLE1BQUFBO0FBTEksUUFNRixLQUFLekUsS0FOVDtBQU9BLFdBQU9vRSx5QkFBeUIsQ0FDOUJxQyxPQUQ4QjtBQUU5QjtBQUFnQixRQUZjLEVBRzlCbkMsV0FIOEIsRUFJOUJILFFBSjhCLEVBSzlCSSxXQUw4QixFQU05QkMsa0JBTjhCLEVBTzlCQyxZQVA4QjtBQVE5QjtBQUFXLFFBUm1CLENBQWhDO0FBVUQ7O0FBbkNtRSIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTctcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cclxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICpcclxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgQlNELXN0eWxlIGxpY2Vuc2UgZm91bmQgaW4gdGhlXHJcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS4gQW4gYWRkaXRpb25hbCBncmFudFxyXG4gKiBvZiBwYXRlbnQgcmlnaHRzIGNhbiBiZSBmb3VuZCBpbiB0aGUgUEFURU5UUyBmaWxlIGluIHRoZSBzYW1lIGRpcmVjdG9yeS5cclxuICpcclxuICogQGZsb3dcclxuICogQGZvcm1hdFxyXG4gKi9cclxuXHJcbmltcG9ydCB0eXBlIHtOdWNsaWRlVXJpfSBmcm9tICdAYXRvbS1pZGUtY29tbXVuaXR5L251Y2xpZGUtY29tbW9ucy9udWNsaWRlVXJpJztcclxuXHJcbmltcG9ydCB7QXRvbVRleHRFZGl0b3J9IGZyb20gJy4vQXRvbVRleHRFZGl0b3InO1xyXG5pbXBvcnQge2dvVG9Mb2NhdGlvbn0gZnJvbSAnQGF0b20taWRlLWNvbW11bml0eS9udWNsaWRlLWNvbW1vbnMtYXRvbS9nby10by1sb2NhdGlvbic7XHJcbmltcG9ydCB7TG9hZGluZ1NwaW5uZXIsIExvYWRpbmdTcGlubmVyU2l6ZXN9IGZyb20gJy4vTG9hZGluZ1NwaW5uZXInO1xyXG5pbXBvcnQgbnVsbHRocm93cyBmcm9tICdudWxsdGhyb3dzJztcclxuaW1wb3J0IHtwbHVyYWxpemUsIFpFUk9fV0lEVEhfU1BBQ0V9IGZyb20gJ0BhdG9tLWlkZS1jb21tdW5pdHkvbnVjbGlkZS1jb21tb25zL3N0cmluZyc7XHJcbmltcG9ydCB7UmFuZ2UsIFRleHRCdWZmZXJ9IGZyb20gJ2F0b20nO1xyXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCBSZWFjdERPTSBmcm9tICdyZWFjdC1kb20nO1xyXG5pbXBvcnQge3JlbmRlclJlYWN0Um9vdH0gZnJvbSAnLi9yZW5kZXJSZWFjdFJvb3QnO1xyXG5pbXBvcnQge1NlY3Rpb259IGZyb20gJy4vU2VjdGlvbic7XHJcbmltcG9ydCBVbml2ZXJzYWxEaXNwb3NhYmxlIGZyb20gJ0BhdG9tLWlkZS1jb21tdW5pdHkvbnVjbGlkZS1jb21tb25zL1VuaXZlcnNhbERpc3Bvc2FibGUnO1xyXG5pbXBvcnQgY2xhc3NuYW1lcyBmcm9tICdjbGFzc25hbWVzJztcclxuXHJcbnR5cGUgUHJvcHMgPSB7XHJcbiAgY29sbGFwc2FibGU/OiBib29sZWFuLFxyXG4gIGRpZmY6IGRpZmZwYXJzZXIkRmlsZURpZmYsXHJcbiAgZXh0cmFEYXRhPzogbWl4ZWQsXHJcbiAgZ3JhbW1hcj86IGF0b20kR3JhbW1hcixcclxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3Qvbm8tdW51c2VkLXByb3AtdHlwZXNcclxuICBodW5rQ29tcG9uZW50Q2xhc3M/OiBSZWFjdC5Db21wb25lbnRUeXBlPEh1bmtQcm9wcz4sXHJcbiAgZnVsbFBhdGg/OiBOdWNsaWRlVXJpLFxyXG4gIGRpc3BsYXlQYXRoPzogc3RyaW5nLFxyXG4gIGNvbGxhcHNhYmxlPzogYm9vbGVhbixcclxuICBjb2xsYXBzZWRCeURlZmF1bHQ/OiBib29sZWFuLFxyXG4gIGhpZGVIZWFkbGluZT86IGJvb2xlYW4sXHJcbiAgc29mdFdyYXBwZWQ/OiBib29sZWFuLFxyXG59O1xyXG5cclxudHlwZSBEZWZhdWx0UHJvcHMgPSB7XHJcbiAgaHVua0NvbXBvbmVudENsYXNzOiBSZWFjdC5Db21wb25lbnRUeXBlPEh1bmtQcm9wcz4sXHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBIdW5rUHJvcHMgPSB7XHJcbiAgLy8gVE9ETzogcmVtb3ZlIGRpc2FibGVcclxuICAvKiBlc2xpbnQtZGlzYWJsZSByZWFjdC9uby11bnVzZWQtcHJvcC10eXBlcyAqL1xyXG4gIGNvbGxhcHNhYmxlPzogYm9vbGVhbixcclxuICBleHRyYURhdGE/OiBtaXhlZCxcclxuICAvKiBlc2xpbnQtZW5hYmxlIHJlYWN0L25vLXVudXNlZC1wcm9wLXR5cGVzICovXHJcbiAgZ3JhbW1hcjogYXRvbSRHcmFtbWFyLFxyXG4gIGh1bms6IGRpZmZwYXJzZXIkSHVuayxcclxuICBvbkNsaWNrTGluZT86IChsaW5lTnVtOiBudW1iZXIpID0+IG1peGVkLFxyXG4gIHNvZnRXcmFwcGVkPzogYm9vbGVhbixcclxufTtcclxuXHJcbmNvbnN0IE1BWF9HVVRURVJfV0lEVEggPSA1O1xyXG5cclxuZnVuY3Rpb24gZ2V0SGlnaGxpZ2h0Q2xhc3ModHlwZTogZGlmZnBhcnNlciRDaGFuZ2VUeXBlKTogP3N0cmluZyB7XHJcbiAgaWYgKHR5cGUgPT09ICdhZGQnKSB7XHJcbiAgICByZXR1cm4gJ251Y2xpZGUtdWktaHVuay1kaWZmLWluc2VydCc7XHJcbiAgfVxyXG4gIGlmICh0eXBlID09PSAnZGVsJykge1xyXG4gICAgcmV0dXJuICdudWNsaWRlLXVpLWh1bmstZGlmZi1kZWxldGUnO1xyXG4gIH1cclxuICByZXR1cm4gbnVsbDtcclxufVxyXG5cclxuLy8gYWRkIGEgZ3V0dGVyIHRvIGEgdGV4dCBlZGl0b3Igd2l0aCBsaW5lIG51bWJlcnMgZGVmaW5lZCBieSBhbiBpdGVyYWJsZSwgYXNcclxuLy8gb3Bwb3NlZCB0byBiZWluZyBmb3JjZWQgdG8gc3RhcnQgYXQgMSBhbmQgY291bnRpbmcgdXBcclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUN1c3RvbUxpbmVOdW1iZXJHdXR0ZXIoXHJcbiAgZWRpdG9yOiBhdG9tJFRleHRFZGl0b3IsXHJcbiAgbGluZU51bWJlcnM6IEl0ZXJhYmxlPD9udW1iZXI+LFxyXG4gIGd1dHRlcldpZHRoOiBudW1iZXIsXHJcbiAgb3B0aW9uczoge1xyXG4gICAgZXh0cmFOYW1lPzogc3RyaW5nLFxyXG4gICAgb25DbGljaz86IChsaW5lTnVtYmVyOiBudW1iZXIpID0+IG1peGVkLFxyXG4gIH0gPSB7fSxcclxuKTogYXRvbSRHdXR0ZXIge1xyXG4gIGNvbnN0IHtleHRyYU5hbWUsIG9uQ2xpY2t9ID0gb3B0aW9ucztcclxuICAvLyAnbnVjbGlkZS11aS1maWxlLWNoYW5nZXMtbGluZS1udW1iZXItZ3V0dGVyLXdYJyBtYWtlcyBhIGd1dHRlciBYZW0gd2lkZS5cclxuICAvLyAnbnVjbGlkZS11aS1maWxlLWNoYW5nZXMtbGluZS1udW1iZXItZ3V0dGVyJyBtYWtlcyBhIGd1dHRlciA1ZW0gd2lkZVxyXG4gIGNvbnN0IHN1ZmZpeCA9XHJcbiAgICBndXR0ZXJXaWR0aCA+IDAgJiYgZ3V0dGVyV2lkdGggPCBNQVhfR1VUVEVSX1dJRFRIID8gYC13JHtndXR0ZXJXaWR0aH1gIDogJyc7XHJcbiAgbGV0IG5hbWUgPSBgbnVjbGlkZS11aS1maWxlLWNoYW5nZXMtbGluZS1udW1iZXItZ3V0dGVyJHtzdWZmaXh9YDtcclxuICBpZiAoZXh0cmFOYW1lICE9IG51bGwpIHtcclxuICAgIG5hbWUgKz0gYCAke2V4dHJhTmFtZX1gO1xyXG4gIH1cclxuICBjb25zdCBndXR0ZXIgPSBlZGl0b3IuYWRkR3V0dGVyKHtuYW1lfSk7XHJcblxyXG4gIGxldCBpbmRleCA9IC0xO1xyXG4gIGZvciAoY29uc3QgbGluZU51bWJlciBvZiBsaW5lTnVtYmVycykge1xyXG4gICAgaW5kZXgrKztcclxuICAgIGlmIChsaW5lTnVtYmVyID09IG51bGwpIHtcclxuICAgICAgY29udGludWU7XHJcbiAgICB9XHJcbiAgICBjb25zdCBtYXJrZXIgPSBlZGl0b3IubWFya0J1ZmZlclBvc2l0aW9uKFtpbmRleCwgMF0sIHtcclxuICAgICAgaW52YWxpZGF0ZTogJ3RvdWNoJyxcclxuICAgIH0pO1xyXG4gICAgY29uc3QgaXRlbSA9IGNyZWF0ZUd1dHRlckl0ZW0obGluZU51bWJlciwgZ3V0dGVyV2lkdGgsIG9uQ2xpY2spO1xyXG4gICAgZ3V0dGVyLmRlY29yYXRlTWFya2VyKG1hcmtlciwge1xyXG4gICAgICB0eXBlOiAnZ3V0dGVyJyxcclxuICAgICAgaXRlbSxcclxuICAgIH0pO1xyXG4gICAgZ3V0dGVyLm9uRGlkRGVzdHJveSgoKSA9PiB7XHJcbiAgICAgIG1hcmtlci5kZXN0cm95KCk7XHJcbiAgICAgIFJlYWN0RE9NLnVubW91bnRDb21wb25lbnRBdE5vZGUoaXRlbSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJldHVybiBndXR0ZXI7XHJcbn1cclxuXHJcbmNvbnN0IE5CU1AgPSAnXFx4YTAnO1xyXG5mdW5jdGlvbiBjcmVhdGVHdXR0ZXJJdGVtKFxyXG4gIGxpbmVOdW1iZXI6IG51bWJlcixcclxuICBndXR0ZXJXaWR0aDogbnVtYmVyLFxyXG4gIG9uQ2xpY2s6ID8obGluZU51bWJlcjogbnVtYmVyKSA9PiBtaXhlZCxcclxuKTogSFRNTEVsZW1lbnQge1xyXG4gIGNvbnN0IGZpbGxXaWR0aCA9IGd1dHRlcldpZHRoIC0gU3RyaW5nKGxpbmVOdW1iZXIpLmxlbmd0aDtcclxuICAvLyBQYXJhbGxlbGluZyB0aGUgb3JpZ2luYWwgbGluZS1udW1iZXIgaW1wbGVtZW50YXRpb24sXHJcbiAgLy8gcGFkIHRoZSBsaW5lIG51bWJlciB3aXRoIGxlYWRpbmcgc3BhY2VzLlxyXG4gIGNvbnN0IGZpbGxlciA9IGZpbGxXaWR0aCA+IDAgPyBuZXcgQXJyYXkoZmlsbFdpZHRoKS5maWxsKE5CU1ApLmpvaW4oJycpIDogJyc7XHJcbiAgLy8gQXR0ZW1wdCB0byByZXVzZSB0aGUgZXhpc3RpbmcgbGluZS1udW1iZXIgc3R5bGVzLlxyXG4gIHJldHVybiByZW5kZXJSZWFjdFJvb3QoXHJcbiAgICA8ZGl2XHJcbiAgICAgIG9uQ2xpY2s9e29uQ2xpY2sgJiYgKCgpID0+IG9uQ2xpY2sobGluZU51bWJlcikpfVxyXG4gICAgICBjbGFzc05hbWU9e2NsYXNzbmFtZXMoJ2xpbmUtbnVtYmVyJywge2NsaWNrYWJsZTogb25DbGljayAhPSBudWxsfSl9PlxyXG4gICAgICB7ZmlsbGVyfVxyXG4gICAgICB7bGluZU51bWJlcn1cclxuICAgIDwvZGl2PixcclxuICApO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgSHVua0RpZmYgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8SHVua1Byb3BzPiB7XHJcbiAgZWRpdG9yOiBhdG9tJFRleHRFZGl0b3I7XHJcbiAgX2Rpc3Bvc2FibGVzOiBVbml2ZXJzYWxEaXNwb3NhYmxlO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcm9wczogSHVua1Byb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLl9kaXNwb3NhYmxlcyA9IG5ldyBVbml2ZXJzYWxEaXNwb3NhYmxlKFxyXG4gICAgICAvLyBlbmFibGUgY29weWluZyBmaWxlbmFtZVxyXG4gICAgICAvLyBjb3JlOmNvcHkgaXNuJ3QgdXNlZCBiZWNhdXNlIGl0IGJyZWFrcyB0aGUgY3VzdG9tIGNvcHkgYmVoYXZpb3IgYmVsb3csXHJcbiAgICAgIC8vIGFuZCB0aGlzIHNlbGVjdGlvbiBkb2Vzbid0IHdvcmsgZWFzaWx5IHdpdGggY21kLWMgYW55d2F5LlxyXG4gICAgICBhdG9tLmNvbnRleHRNZW51LmFkZCh7XHJcbiAgICAgICAgJy5udWNsaWRlLXVpLWZpbGUtY2hhbmdlcy1pdGVtJzogW1xyXG4gICAgICAgICAge1xyXG4gICAgICAgICAgICBsYWJlbDogJ0NvcHknLFxyXG4gICAgICAgICAgICBjb21tYW5kOiAnbnVjbGlkZS11aS1maWxlLWNoYW5nZXMtaXRlbTpjb3B5JyxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgXSxcclxuICAgICAgfSksXHJcbiAgICAgIGF0b20uY29tbWFuZHMuYWRkKFxyXG4gICAgICAgICcubnVjbGlkZS11aS1maWxlLWNoYW5nZXMtaXRlbScsXHJcbiAgICAgICAgJ251Y2xpZGUtdWktZmlsZS1jaGFuZ2VzLWl0ZW06Y29weScsXHJcbiAgICAgICAgZXZlbnQgPT4ge1xyXG4gICAgICAgICAgLy8gbmVlZCB0byBzdHJpcCBvdXQgemVyby13aWR0aCBzcGFjZXMgdGhhdCB3ZXJlIGFkZGVkIHRvIHRoZSBmaWxlbmFtZVxyXG4gICAgICAgICAgaWYgKCEoZXZlbnQudGFyZ2V0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGNvbnN0IGVsZW1lbnQ6IEhUTUxFbGVtZW50ID0gZXZlbnQudGFyZ2V0O1xyXG4gICAgICAgICAgY29uc3QgdGV4dCA9IGVsZW1lbnQuaW5uZXJUZXh0O1xyXG4gICAgICAgICAgaWYgKHRleHQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBjb25zdCBhbGxTcGFjZXNSZWdleCA9IG5ldyBSZWdFeHAoWkVST19XSURUSF9TUEFDRSwgJ2cnKTtcclxuICAgICAgICAgIGF0b20uY2xpcGJvYXJkLndyaXRlKHRleHQucmVwbGFjZShhbGxTcGFjZXNSZWdleCwgJycpKTtcclxuICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICksXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50RGlkTW91bnQoKTogdm9pZCB7XHJcbiAgICBjb25zdCBlZGl0b3IgPSBudWxsdGhyb3dzKHRoaXMuZWRpdG9yKTtcclxuICAgIHRoaXMuX2NyZWF0ZUxpbmVNYXJrZXJzKGVkaXRvcik7XHJcbiAgICB0aGlzLl9jcmVhdGVMaW5lTnVtYmVycyhlZGl0b3IpO1xyXG4gIH1cclxuXHJcbiAgVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzOiBIdW5rUHJvcHMpOiB2b2lkIHtcclxuICAgIGNvbnN0IHtodW5rLCBncmFtbWFyfSA9IG5leHRQcm9wcztcclxuICAgIGNvbnN0IGNoYW5nZXMgPSBodW5rLmNoYW5nZXM7XHJcbiAgICBjb25zdCBwcmV2SHVuayA9IHRoaXMucHJvcHMuaHVuaztcclxuICAgIGNvbnN0IGVkaXRvciA9IG51bGx0aHJvd3ModGhpcy5lZGl0b3IpO1xyXG5cclxuICAgIGNvbnN0IG5ld1RleHQgPSBjaGFuZ2VzLm1hcChjaGFuZ2UgPT4gY2hhbmdlLmNvbnRlbnQuc2xpY2UoMSkpLmpvaW4oJ1xcbicpO1xyXG4gICAgY29uc3Qgb2xkVGV4dCA9IHByZXZIdW5rLmNoYW5nZXNcclxuICAgICAgLm1hcChjaGFuZ2UgPT4gY2hhbmdlLmNvbnRlbnQuc2xpY2UoMSkpXHJcbiAgICAgIC5qb2luKCdcXG4nKTtcclxuICAgIGNvbnN0IG9sZEdyYW1tYXIgPSB0aGlzLnByb3BzLmdyYW1tYXI7XHJcblxyXG4gICAgaWYgKG5ld1RleHQgPT09IG9sZFRleHQgJiYgZ3JhbW1hciA9PT0gb2xkR3JhbW1hcikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG5ld1RleHQgIT09IG9sZFRleHQpIHtcclxuICAgICAgZWRpdG9yLnNldFRleHQobmV3VGV4dCk7XHJcbiAgICB9XHJcbiAgICBpZiAoZ3JhbW1hciAhPT0gb2xkR3JhbW1hcikge1xyXG4gICAgICBlZGl0b3Iuc2V0R3JhbW1hcihncmFtbWFyKTtcclxuICAgIH1cclxuICAgIHRoaXMuX2Rpc3Bvc2FibGVzLmRpc3Bvc2UoKTtcclxuICAgIHRoaXMuX2Rpc3Bvc2FibGVzID0gbmV3IFVuaXZlcnNhbERpc3Bvc2FibGUoKTtcclxuICAgIHRoaXMuX2NyZWF0ZUxpbmVNYXJrZXJzKGVkaXRvcik7XHJcbiAgICB0aGlzLl9jcmVhdGVMaW5lTnVtYmVycyhlZGl0b3IpO1xyXG4gIH1cclxuXHJcbiAgc2hvdWxkQ29tcG9uZW50VXBkYXRlKG5leHRQcm9wczogSHVua1Byb3BzKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG5cclxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpOiB2b2lkIHtcclxuICAgIHRoaXMuX2Rpc3Bvc2FibGVzLmRpc3Bvc2UoKTtcclxuICB9XHJcblxyXG4gIC8vIExpbmUgbnVtYmVycyBhcmUgY29udGlndW91cywgYnV0IGhhdmUgYSByYW5kb20gc3RhcnRpbmcgcG9pbnQsIHNvIHdlIGNhbid0IHVzZSB0aGVcclxuICAvLyBkZWZhdWx0IGxpbmUtbnVtYmVyIGd1dHRlci5cclxuICBfY3JlYXRlTGluZU51bWJlcnMoZWRpdG9yOiBhdG9tJFRleHRFZGl0b3IpOiB2b2lkIHtcclxuICAgIGNvbnN0IHtjaGFuZ2VzLCBuZXdTdGFydDogaW5pdGlhbE9mZnNldH0gPSB0aGlzLnByb3BzLmh1bms7XHJcbiAgICBjb25zdCBjaGFuZ2VDb3VudCA9IGNoYW5nZXMubGVuZ3RoO1xyXG4gICAgY29uc3QgbWF4RGlzcGxheUxpbmVOdW1iZXIgPSBpbml0aWFsT2Zmc2V0ICsgY2hhbmdlQ291bnQgLSAxO1xyXG4gICAgLy8gVGhlIG1heGltdW0gcmVxdWlyZWQgZ3V0dGVyIHdpZHRoIGZvciB0aGlzIGh1bmssIGluIGNoYXJhY3RlcnM6XHJcbiAgICBjb25zdCBndXR0ZXJXaWR0aCA9IFN0cmluZyhtYXhEaXNwbGF5TGluZU51bWJlcikubGVuZ3RoO1xyXG5cclxuICAgIGxldCBkZWxldGVkTGluZXNJblNlY3Rpb24gPSAwO1xyXG4gICAgbGV0IGRlbGV0ZWRMaW5lcyA9IDA7XHJcbiAgICAvLyB1c2UgYSBnZW5lcmF0b3IgdG8gYXZvaWQgaGF2aW5nIHRvIHByZWNhbGN1bGF0ZSBhbmQgc3RvcmUgYW4gYXJyYXkgb2ZcclxuICAgIC8vIGxpbmUgbnVtYmVyc1xyXG4gICAgZnVuY3Rpb24qIGxpbmVOdW1iZXJHZW5lcmF0b3IoKTogSXRlcmF0b3I8bnVtYmVyPiB7XHJcbiAgICAgIGZvciAobGV0IGxpbmUgPSAwOyBsaW5lIDwgY2hhbmdlQ291bnQ7IGxpbmUrKykge1xyXG4gICAgICAgIGlmIChjaGFuZ2VzW2xpbmVdLnR5cGUgPT09ICdkZWwnKSB7XHJcbiAgICAgICAgICBkZWxldGVkTGluZXNJblNlY3Rpb24rKztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgZGVsZXRlZExpbmVzICs9IGRlbGV0ZWRMaW5lc0luU2VjdGlvbjtcclxuICAgICAgICAgIGRlbGV0ZWRMaW5lc0luU2VjdGlvbiA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHlpZWxkIGxpbmUgKyBpbml0aWFsT2Zmc2V0IC0gZGVsZXRlZExpbmVzO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZ3V0dGVyID0gY3JlYXRlQ3VzdG9tTGluZU51bWJlckd1dHRlcihcclxuICAgICAgZWRpdG9yLFxyXG4gICAgICBsaW5lTnVtYmVyR2VuZXJhdG9yKCksXHJcbiAgICAgIGd1dHRlcldpZHRoLFxyXG4gICAgICB7XHJcbiAgICAgICAgb25DbGljazogdGhpcy5wcm9wcy5vbkNsaWNrTGluZSxcclxuICAgICAgfSxcclxuICAgICk7XHJcbiAgICB0aGlzLl9kaXNwb3NhYmxlcy5hZGQoKCkgPT4ge1xyXG4gICAgICBndXR0ZXIuZGVzdHJveSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBAcGFyYW0gbGluZU51bWJlciBBIGJ1ZmZlciBsaW5lIG51bWJlciB0byBiZSBoaWdobGlnaHRlZC5cclxuICAgKiBAcGFyYW0gdHlwZSBUaGUgdHlwZSBvZiBoaWdobGlnaHQgdG8gYmUgYXBwbGllZCB0byB0aGUgbGluZS5cclxuICAgKiAgICAgICAgICAgICBDb3VsZCBiZSBhIHZhbHVlIG9mOiBbJ2luc2VydCcsICdkZWxldGUnXS5cclxuICAgKi9cclxuICBfY3JlYXRlTGluZU1hcmtlcnMoZWRpdG9yOiBhdG9tJFRleHRFZGl0b3IpOiB2b2lkIHtcclxuICAgIGxldCBodW5rSW5kZXggPSAwO1xyXG4gICAgZm9yIChjb25zdCBodW5rQ2hhbmdlcyBvZiB0aGlzLnByb3BzLmh1bmsuY2hhbmdlcykge1xyXG4gICAgICBjb25zdCBsaW5lTnVtYmVyID0gaHVua0luZGV4Kys7XHJcbiAgICAgIGNvbnN0IHJhbmdlID0gbmV3IFJhbmdlKFtsaW5lTnVtYmVyLCAwXSwgW2xpbmVOdW1iZXIgKyAxLCAwXSk7XHJcbiAgICAgIGNvbnN0IG1hcmtlciA9IGVkaXRvci5tYXJrQnVmZmVyUmFuZ2UocmFuZ2UsIHtpbnZhbGlkYXRlOiAnbmV2ZXInfSk7XHJcbiAgICAgIGNvbnN0IGNsYXNzTmFtZSA9IGdldEhpZ2hsaWdodENsYXNzKGh1bmtDaGFuZ2VzLnR5cGUpO1xyXG4gICAgICBpZiAoY2xhc3NOYW1lID09IG51bGwpIHtcclxuICAgICAgICAvLyBObyBuZWVkIHRvIGhpZ2hsaWdodCBub3JtYWwgbGluZXMuXHJcbiAgICAgICAgY29udGludWU7XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgZGVjb3JhdGlvbiA9IGVkaXRvci5kZWNvcmF0ZU1hcmtlcihtYXJrZXIsIHtcclxuICAgICAgICB0eXBlOiAnaGlnaGxpZ2h0JyxcclxuICAgICAgICBjbGFzczogY2xhc3NOYW1lLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHRoaXMuX2Rpc3Bvc2FibGVzLmFkZCgoKSA9PiB7XHJcbiAgICAgICAgZGVjb3JhdGlvbi5kZXN0cm95KCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCk6IFJlYWN0Lk5vZGUge1xyXG4gICAgY29uc3Qge2h1bmssIGdyYW1tYXIsIHNvZnRXcmFwcGVkfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCB7Y2hhbmdlc30gPSBodW5rO1xyXG4gICAgLy8gUmVtb3ZlIHRoZSBmaXJzdCBjaGFyYWN0ZXIgaW4gZWFjaCBsaW5lICgvWystIF0vKSB3aGljaCBpbmRpY2F0ZXMgYWRkaXRpb24gLyBkZWxldGlvblxyXG4gICAgY29uc3QgdGV4dCA9IGNoYW5nZXMubWFwKGNoYW5nZSA9PiBjaGFuZ2UuY29udGVudC5zbGljZSgxKSkuam9pbignXFxuJyk7XHJcbiAgICBjb25zdCB0ZXh0QnVmZmVyID0gbmV3IFRleHRCdWZmZXIoKTtcclxuICAgIHRleHRCdWZmZXIuc2V0VGV4dCh0ZXh0KTtcclxuXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8QXRvbVRleHRFZGl0b3JcclxuICAgICAgICBhdXRvR3Jvdz17dHJ1ZX1cclxuICAgICAgICBjbGFzc05hbWU9XCJudWNsaWRlLXVpLWh1bmstZGlmZi10ZXh0LWVkaXRvclwiXHJcbiAgICAgICAgY29ycmVjdENvbnRhaW5lcldpZHRoPXtmYWxzZX1cclxuICAgICAgICBncmFtbWFyPXtncmFtbWFyfVxyXG4gICAgICAgIGd1dHRlckhpZGRlbj17dHJ1ZX1cclxuICAgICAgICByZWFkT25seT17dHJ1ZX1cclxuICAgICAgICBzb2Z0V3JhcHBlZD17c29mdFdyYXBwZWR9XHJcbiAgICAgICAgcmVmPXtlZGl0b3JSZWYgPT4ge1xyXG4gICAgICAgICAgLy8gJEZsb3dGaXhNZSg+PTAuNTMuMCkgRmxvdyBzdXBwcmVzc1xyXG4gICAgICAgICAgdGhpcy5lZGl0b3IgPSBlZGl0b3JSZWYgJiYgZWRpdG9yUmVmLmdldE1vZGVsKCk7XHJcbiAgICAgICAgfX1cclxuICAgICAgICB0ZXh0QnVmZmVyPXt0ZXh0QnVmZmVyfVxyXG4gICAgICAvPlxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUZpbGVuYW1lQ2xpY2soXHJcbiAgZnVsbFBhdGg6ID9zdHJpbmcsXHJcbiAgZXZlbnQ6IFN5bnRoZXRpY01vdXNlRXZlbnQ8PixcclxuKTogdm9pZCB7XHJcbiAgaWYgKGZ1bGxQYXRoID09IG51bGwpIHtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgZ29Ub0xvY2F0aW9uKGZ1bGxQYXRoKTtcclxuICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyRmlsZUNoYW5nZUNvbnRhaW5lcihcclxuICBjb250ZW50OiBSZWFjdC5Ob2RlLFxyXG4gIGlzUHJldmlldzogYm9vbGVhbixcclxuICBjb2xsYXBzYWJsZTogP2Jvb2xlYW4sXHJcbiAgZnVsbFBhdGg6ID9OdWNsaWRlVXJpLFxyXG4gIGRpc3BsYXlQYXRoOiA/c3RyaW5nLFxyXG4gIGNvbGxhcHNlZEJ5RGVmYXVsdDogP2Jvb2xlYW4sXHJcbiAgaGlkZUhlYWRsaW5lOiA/Ym9vbGVhbixcclxuICBkaWZmOiA/ZGlmZnBhcnNlciRGaWxlRGlmZixcclxuKTogUmVhY3QuTm9kZSB7XHJcbiAgY29uc3Qge2FkZGl0aW9ucywgYW5ub3RhdGlvbiwgZGVsZXRpb25zLCBmcm9tOiBmcm9tRmlsZU5hbWUsIHRvOiB0b0ZpbGVOYW1lfSA9XHJcbiAgICBkaWZmICE9IG51bGxcclxuICAgICAgPyBkaWZmXHJcbiAgICAgIDoge1xyXG4gICAgICAgICAgYWRkaXRpb25zOiBudWxsLFxyXG4gICAgICAgICAgYW5ub3RhdGlvbjogbnVsbCxcclxuICAgICAgICAgIGRlbGV0aW9uczogbnVsbCxcclxuICAgICAgICAgIGZyb206IGZ1bGxQYXRoLFxyXG4gICAgICAgICAgdG86IGZ1bGxQYXRoLFxyXG4gICAgICAgIH07XHJcblxyXG4gIGlmICh0b0ZpbGVOYW1lID09IG51bGwgfHwgZnJvbUZpbGVOYW1lID09IG51bGwpIHtcclxuICAgIC8vIHNhbml0eSBjaGVjazogdG9GaWxlTmFtZSAmIGZyb21GaWxlTmFtZSBzaG91bGQgYWx3YXlzIGJlIGdpdmVuXHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbiAgY29uc3QgZmlsZU5hbWUgPVxyXG4gICAgZGlzcGxheVBhdGggIT0gbnVsbFxyXG4gICAgICA/IGRpc3BsYXlQYXRoXHJcbiAgICAgIDogdG9GaWxlTmFtZSAhPT0gJy9kZXYvbnVsbCdcclxuICAgICAgICA/IHRvRmlsZU5hbWVcclxuICAgICAgICA6IGZyb21GaWxlTmFtZTtcclxuICBsZXQgYW5ub3RhdGlvbkNvbXBvbmVudDtcclxuICBpZiAoIWlzUHJldmlldyAmJiBhbm5vdGF0aW9uICE9IG51bGwpIHtcclxuICAgIGFubm90YXRpb25Db21wb25lbnQgPSAoXHJcbiAgICAgIDxzcGFuPlxyXG4gICAgICAgIHthbm5vdGF0aW9uLnNwbGl0KCdcXG4nKS5tYXAoKGxpbmUsIGluZGV4KSA9PiAoXHJcbiAgICAgICAgICA8c3BhbiBrZXk9e2luZGV4fT5cclxuICAgICAgICAgICAge2xpbmV9XHJcbiAgICAgICAgICAgIDxiciAvPlxyXG4gICAgICAgICAgPC9zcGFuPlxyXG4gICAgICAgICkpfVxyXG4gICAgICA8L3NwYW4+XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgbGV0IGFkZGVkT3JEZWxldGVkU3RyaW5nID0gJyc7XHJcbiAgaWYgKHRvRmlsZU5hbWUgPT09ICcvZGV2L251bGwnKSB7XHJcbiAgICBhZGRlZE9yRGVsZXRlZFN0cmluZyA9ICdmaWxlIGRlbGV0ZWQgLSAnO1xyXG4gIH0gZWxzZSBpZiAoZnJvbUZpbGVOYW1lID09PSAnL2Rldi9udWxsJykge1xyXG4gICAgYWRkZWRPckRlbGV0ZWRTdHJpbmcgPSAnZmlsZSBhZGRlZCAtICc7XHJcbiAgfVxyXG4gIGNvbnN0IGRpZmZEZXRhaWxzID0gaXNQcmV2aWV3ID8gbnVsbCA6IChcclxuICAgIDxzcGFuIGNsYXNzTmFtZT1cIm51Y2xpZGUtdWktZmlsZS1jaGFuZ2VzLWRldGFpbHNcIj5cclxuICAgICAge2Fubm90YXRpb25Db21wb25lbnR9IChcclxuICAgICAge2FkZGVkT3JEZWxldGVkU3RyaW5nfVxyXG4gICAgICB7YWRkaXRpb25zICsgZGVsZXRpb25zfSB7cGx1cmFsaXplKCdsaW5lJywgYWRkaXRpb25zICsgZGVsZXRpb25zKX1cclxuICAgICAgKVxyXG4gICAgPC9zcGFuPlxyXG4gICk7XHJcblxyXG4gIC8vIGluc2VydCB6ZXJvLXdpZHRoIHNwYWNlcyBzbyBmaWxlbmFtZXMgYXJlIHdyYXBwZWQgYXQgJy8nXHJcbiAgY29uc3QgYnJlYWthYmxlRmlsZW5hbWUgPSBmaWxlTmFtZS5yZXBsYWNlKC9cXC8vZywgJy8nICsgWkVST19XSURUSF9TUEFDRSk7XHJcbiAgY29uc3QgcmVuZGVyZWRGaWxlbmFtZSA9XHJcbiAgICBmdWxsUGF0aCAhPSBudWxsID8gKFxyXG4gICAgICA8YVxyXG4gICAgICAgIGNsYXNzTmFtZT1cIm51Y2xpZGUtdWktZmlsZS1jaGFuZ2VzLW5hbWVcIlxyXG4gICAgICAgIG9uQ2xpY2s9e2hhbmRsZUZpbGVuYW1lQ2xpY2suYmluZChudWxsLCBmdWxsUGF0aCl9PlxyXG4gICAgICAgIHticmVha2FibGVGaWxlbmFtZX1cclxuICAgICAgPC9hPlxyXG4gICAgKSA6IChcclxuICAgICAgYnJlYWthYmxlRmlsZW5hbWVcclxuICAgICk7XHJcblxyXG4gIGlmIChoaWRlSGVhZGxpbmUpIHtcclxuICAgIHJldHVybiBjb250ZW50O1xyXG4gIH1cclxuXHJcbiAgY29uc3QgaGVhZGxpbmUgPSAoXHJcbiAgICA8c3BhblxyXG4gICAgICBjbGFzc05hbWU9e2NsYXNzbmFtZXMoXHJcbiAgICAgICAgJ251Y2xpZGUtdWktZmlsZS1jaGFuZ2VzLWl0ZW0nLFxyXG4gICAgICAgICduYXRpdmUta2V5LWJpbmRpbmdzJyxcclxuICAgICAgKX1cclxuICAgICAgdGFiSW5kZXg9ey0xfT5cclxuICAgICAge3JlbmRlcmVkRmlsZW5hbWV9IHtkaWZmRGV0YWlsc31cclxuICAgIDwvc3Bhbj5cclxuICApO1xyXG4gIHJldHVybiAoXHJcbiAgICA8U2VjdGlvblxyXG4gICAgICBjb2xsYXBzYWJsZT17Y29sbGFwc2FibGUgPT09IHRydWV9XHJcbiAgICAgIGNvbGxhcHNlZEJ5RGVmYXVsdD17Y29sbGFwc2VkQnlEZWZhdWx0ID09PSB0cnVlfVxyXG4gICAgICBoZWFkbGluZT17aGVhZGxpbmV9XHJcbiAgICAgIHRpdGxlPVwiQ2xpY2sgdG8gb3BlblwiPlxyXG4gICAgICB7Y29udGVudH1cclxuICAgIDwvU2VjdGlvbj5cclxuICApO1xyXG59XHJcblxyXG4vKiBSZW5kZXJzIGNoYW5nZXMgdG8gYSBzaW5nbGUgZmlsZS4gKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmlsZUNoYW5nZXMgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHM+IHtcclxuICBzdGF0aWMgZGVmYXVsdFByb3BzOiBEZWZhdWx0UHJvcHMgPSB7XHJcbiAgICBodW5rQ29tcG9uZW50Q2xhc3M6IEh1bmtEaWZmLFxyXG4gIH07XHJcblxyXG4gIHJlbmRlcigpOiBSZWFjdC5Ob2RlIHtcclxuICAgIGNvbnN0IHtcclxuICAgICAgY29sbGFwc2FibGUsXHJcbiAgICAgIGZ1bGxQYXRoLFxyXG4gICAgICBkaXNwbGF5UGF0aCxcclxuICAgICAgY29sbGFwc2VkQnlEZWZhdWx0LFxyXG4gICAgICBoaWRlSGVhZGxpbmUsXHJcbiAgICAgIGRpZmYsXHJcbiAgICAgIGdyYW1tYXIsXHJcbiAgICAgIHNvZnRXcmFwcGVkLFxyXG4gICAgfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCB7Y2h1bmtzLCBmcm9tOiBmcm9tRmlsZU5hbWUsIHRvOiB0b0ZpbGVOYW1lfSA9IGRpZmY7XHJcbiAgICBpZiAodG9GaWxlTmFtZSA9PSBudWxsIHx8IGZyb21GaWxlTmFtZSA9PSBudWxsKSB7XHJcbiAgICAgIC8vIHNhbml0eSBjaGVjazogdG9GaWxlTmFtZSAmIGZyb21GaWxlTmFtZSBzaG91bGQgYWx3YXlzIGJlIGdpdmVuXHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZmlsZU5hbWUgPSB0b0ZpbGVOYW1lICE9PSAnL2Rldi9udWxsJyA/IHRvRmlsZU5hbWUgOiBmcm9tRmlsZU5hbWU7XHJcblxyXG4gICAgY29uc3QgaHVua3MgPSBbXTtcclxuICAgIGxldCBpID0gMDtcclxuICAgIGZvciAoY29uc3QgY2h1bmsgb2YgY2h1bmtzKSB7XHJcbiAgICAgIGlmIChpID4gMCkge1xyXG4gICAgICAgIGh1bmtzLnB1c2goXHJcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm51Y2xpZGUtdWktaHVuay1kaWZmLXNwYWNlclwiIGtleT17YHNwYWNlci0ke2l9YH0gLz4sXHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG4gICAgICBodW5rcy5wdXNoKFxyXG4gICAgICAgIC8vICRGbG93Rml4TWUoPj0wLjUzLjApIEZsb3cgc3VwcHJlc3NcclxuICAgICAgICA8dGhpcy5wcm9wcy5odW5rQ29tcG9uZW50Q2xhc3NcclxuICAgICAgICAgIGV4dHJhRGF0YT17dGhpcy5wcm9wcy5leHRyYURhdGF9XHJcbiAgICAgICAgICBrZXk9e2NodW5rLm9sZFN0YXJ0fVxyXG4gICAgICAgICAgZ3JhbW1hcj17XHJcbiAgICAgICAgICAgIGdyYW1tYXIgIT0gbnVsbFxyXG4gICAgICAgICAgICAgID8gZ3JhbW1hclxyXG4gICAgICAgICAgICAgIDogYXRvbS5ncmFtbWFycy5zZWxlY3RHcmFtbWFyKGZpbGVOYW1lLCAnJylcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGh1bms9e2NodW5rfVxyXG4gICAgICAgICAgb25DbGlja0xpbmU9eyhsaW5lOiBudW1iZXIpID0+IHtcclxuICAgICAgICAgICAgaWYgKGZ1bGxQYXRoICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICBnb1RvTG9jYXRpb24oZnVsbFBhdGgsIHtsaW5lfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH19XHJcbiAgICAgICAgICBzb2Z0V3JhcHBlZD17c29mdFdyYXBwZWR9XHJcbiAgICAgICAgLz4sXHJcbiAgICAgICk7XHJcbiAgICAgIGkrKztcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcmVuZGVyRmlsZUNoYW5nZUNvbnRhaW5lcihcclxuICAgICAgaHVua3MsXHJcbiAgICAgIC8qIGlzUHJldmlldyAqLyBmYWxzZSxcclxuICAgICAgY29sbGFwc2FibGUsXHJcbiAgICAgIGZ1bGxQYXRoLFxyXG4gICAgICBkaXNwbGF5UGF0aCxcclxuICAgICAgY29sbGFwc2VkQnlEZWZhdWx0LFxyXG4gICAgICBoaWRlSGVhZGxpbmUsXHJcbiAgICAgIGRpZmYsXHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxudHlwZSBMb2FkaW5nUHJvcHMgPSB7XHJcbiAgY29sbGFwc2FibGU/OiBib29sZWFuLFxyXG4gIGZ1bGxQYXRoPzogTnVjbGlkZVVyaSxcclxuICBkaXNwbGF5UGF0aD86IHN0cmluZyxcclxuICBjb2xsYXBzZWRCeURlZmF1bHQ/OiBib29sZWFuLFxyXG4gIGhpZGVIZWFkbGluZT86IGJvb2xlYW4sXHJcbn07XHJcblxyXG5leHBvcnQgY2xhc3MgTG9hZGluZ0ZpbGVDaGFuZ2VzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PExvYWRpbmdQcm9wcz4ge1xyXG4gIF9oYW5kbGVGaWxlbmFtZUNsaWNrID0gKGV2ZW50OiBTeW50aGV0aWNNb3VzZUV2ZW50PD4pOiB2b2lkID0+IHtcclxuICAgIGNvbnN0IHtmdWxsUGF0aH0gPSB0aGlzLnByb3BzO1xyXG4gICAgaWYgKGZ1bGxQYXRoID09IG51bGwpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgZ29Ub0xvY2F0aW9uKGZ1bGxQYXRoKTtcclxuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gIH07XHJcblxyXG4gIHJlbmRlcigpOiBSZWFjdC5Ob2RlIHtcclxuICAgIGNvbnN0IHNwaW5uZXIgPSAoXHJcbiAgICAgIDxMb2FkaW5nU3Bpbm5lclxyXG4gICAgICAgIHNpemU9e0xvYWRpbmdTcGlubmVyU2l6ZXMuRVhUUkFfU01BTEx9XHJcbiAgICAgICAgY2xhc3NOYW1lPVwibnVjbGlkZS11aS1maWxlLWNoYW5nZXMtZmlsZS1zcGlubmVyXCJcclxuICAgICAgLz5cclxuICAgICk7XHJcblxyXG4gICAgY29uc3Qge1xyXG4gICAgICBjb2xsYXBzYWJsZSxcclxuICAgICAgZnVsbFBhdGgsXHJcbiAgICAgIGRpc3BsYXlQYXRoLFxyXG4gICAgICBjb2xsYXBzZWRCeURlZmF1bHQsXHJcbiAgICAgIGhpZGVIZWFkbGluZSxcclxuICAgIH0gPSB0aGlzLnByb3BzO1xyXG4gICAgcmV0dXJuIHJlbmRlckZpbGVDaGFuZ2VDb250YWluZXIoXHJcbiAgICAgIHNwaW5uZXIsXHJcbiAgICAgIC8qIGlzUHJldmlldyAqLyB0cnVlLFxyXG4gICAgICBjb2xsYXBzYWJsZSxcclxuICAgICAgZnVsbFBhdGgsXHJcbiAgICAgIGRpc3BsYXlQYXRoLFxyXG4gICAgICBjb2xsYXBzZWRCeURlZmF1bHQsXHJcbiAgICAgIGhpZGVIZWFkbGluZSxcclxuICAgICAgLyogZGlmZiAqLyBudWxsLFxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuIl19