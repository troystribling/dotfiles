"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
Object.defineProperty(exports, "ButtonSizes", {
  enumerable: true,
  get: function () {
    return _Button.ButtonSizes;
  }
});
exports.SplitButtonDropdown = void 0;

var _assert = _interopRequireDefault(require("assert"));

var React = _interopRequireWildcard(require("react"));

var _Button = require("./Button");

var _ButtonGroup = require("./ButtonGroup");

var _Dropdown = require("./Dropdown");

var _classnames = _interopRequireDefault(require("classnames"));

var _electron = _interopRequireDefault(require("electron"));

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Copyright (c) 2017-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * 
 * @format
 */
const {
  remote
} = _electron.default;
(0, _assert.default)(remote != null);

class SplitButtonDropdown extends React.Component {
  render() {
    const {
      buttonComponent,
      changeDisabled,
      className,
      confirmDisabled,
      onChange,
      onConfirm,
      options,
      size,
      value,
      selectionComparator
    } = this.props;
    const selectedOption = this._findSelectedOption(options) || options[0];
    (0, _assert.default)(selectedOption.type !== 'separator');
    const ButtonComponent = buttonComponent || _Button.Button; // $FlowFixMe(>=0.53.0) Flow suppress

    const dropdownOptions = options.map(option => ({ ...option,
      selectedLabel: ''
    }));
    return /*#__PURE__*/React.createElement(_ButtonGroup.ButtonGroup, {
      className: (0, _classnames.default)(className, 'nuclide-ui-split-button-dropdown')
    }, /*#__PURE__*/React.createElement(ButtonComponent, {
      buttonType: this.props.buttonType,
      size: size == null ? undefined : size,
      disabled: confirmDisabled === true,
      icon: selectedOption.icon || undefined,
      onClick: onConfirm.bind(null, value),
      tabIndex: this.props.tabIndex
    }, // flowlint-next-line sketchy-null-mixed:off, sketchy-null-string:off
    selectedOption.selectedLabel || selectedOption.label || ''), /*#__PURE__*/React.createElement(_Dropdown.Dropdown, {
      buttonType: this.props.buttonType,
      size: this._getDropdownSize(size),
      disabled: changeDisabled === true,
      options: dropdownOptions,
      value: value,
      onChange: onChange,
      selectionComparator: selectionComparator,
      tabIndex: this.props.tabIndex
    }));
  }

  _getDropdownSize(size) {
    switch (size) {
      case _Button.ButtonSizes.EXTRA_SMALL:
        return 'xs';

      case _Button.ButtonSizes.SMALL:
        return 'sm';

      case _Button.ButtonSizes.LARGE:
        return 'lg';

      default:
        return 'sm';
    }
  }

  _findSelectedOption(options) {
    let result = null;
    const selectionComparator = this.props.selectionComparator == null ? (a, b) => a === b : this.props.selectionComparator;

    for (const option of options) {
      if (option.type === 'separator') {
        continue;
      } else if (option.type === 'submenu') {
        const submenu = option.submenu;
        result = this._findSelectedOption(submenu);
      } else if (selectionComparator(option.value, this.props.value)) {
        result = option;
      }

      if (result) {
        break;
      }
    }

    return result;
  }

}

exports.SplitButtonDropdown = SplitButtonDropdown;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL251Y2xpZGUvbnVjbGlkZS1jb21tb25zLXVpL1NwbGl0QnV0dG9uRHJvcGRvd24uanMiXSwibmFtZXMiOlsicmVtb3RlIiwiZWxlY3Ryb24iLCJTcGxpdEJ1dHRvbkRyb3Bkb3duIiwiUmVhY3QiLCJDb21wb25lbnQiLCJyZW5kZXIiLCJidXR0b25Db21wb25lbnQiLCJjaGFuZ2VEaXNhYmxlZCIsImNsYXNzTmFtZSIsImNvbmZpcm1EaXNhYmxlZCIsIm9uQ2hhbmdlIiwib25Db25maXJtIiwib3B0aW9ucyIsInNpemUiLCJ2YWx1ZSIsInNlbGVjdGlvbkNvbXBhcmF0b3IiLCJwcm9wcyIsInNlbGVjdGVkT3B0aW9uIiwiX2ZpbmRTZWxlY3RlZE9wdGlvbiIsInR5cGUiLCJCdXR0b25Db21wb25lbnQiLCJCdXR0b24iLCJkcm9wZG93bk9wdGlvbnMiLCJtYXAiLCJvcHRpb24iLCJzZWxlY3RlZExhYmVsIiwiYnV0dG9uVHlwZSIsInVuZGVmaW5lZCIsImljb24iLCJiaW5kIiwidGFiSW5kZXgiLCJsYWJlbCIsIl9nZXREcm9wZG93blNpemUiLCJCdXR0b25TaXplcyIsIkVYVFJBX1NNQUxMIiwiU01BTEwiLCJMQVJHRSIsInJlc3VsdCIsImEiLCJiIiwic3VibWVudSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQWVBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7OztBQXJCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWUEsTUFBTTtBQUFDQSxFQUFBQTtBQUFELElBQVdDLGlCQUFqQjtBQUNBLHFCQUFVRCxNQUFNLElBQUksSUFBcEI7O0FBbUJPLE1BQU1FLG1CQUFOLFNBQWtDQyxLQUFLLENBQUNDLFNBQXhDLENBQXlEO0FBQzlEQyxFQUFBQSxNQUFNLEdBQWU7QUFDbkIsVUFBTTtBQUNKQyxNQUFBQSxlQURJO0FBRUpDLE1BQUFBLGNBRkk7QUFHSkMsTUFB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QUFDZ0IsT0FBekI7QUFDQUgsUUFBQUEsTUFBTSxHQUFHLEtBQUtuQixtQkFBTCxDQUF5QnNCLE9BQXpCLENBQVQ7QUFDRCxPQUhNLE1BR0EsSUFBSXpCLG1CQUFtQixDQUFDUyxNQUFNLENBQUNWLEtBQVIsRUFBZSxLQUFLRSxLQUFMLENBQVdGLEtBQTFCLENBQXZCLEVBQXlEO0FBQzlEdUIsUUFBQUEsTUFBTSxHQUFHYixNQUFUO0FBQ0Q7O0FBRUQsVUFBSWEsTUFBSixFQUFZO0FBQ1Y7QUFDRDtBQUNGOztBQUNELFdBQU9BLE1BQVA7QUFDRDs7QUFwRjZEIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENvcHlyaWdodCAoYykgMjAxNy1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxyXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKlxyXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBCU0Qtc3R5bGUgbGljZW5zZSBmb3VuZCBpbiB0aGVcclxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLiBBbiBhZGRpdGlvbmFsIGdyYW50XHJcbiAqIG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW4gdGhlIHNhbWUgZGlyZWN0b3J5LlxyXG4gKlxyXG4gKiBAZmxvd1xyXG4gKiBAZm9ybWF0XHJcbiAqL1xyXG5cclxuaW1wb3J0IHR5cGUge09wdGlvbn0gZnJvbSAnLi9Ecm9wZG93bic7XHJcbmltcG9ydCB0eXBlIHtCdXR0b25UeXBlfSBmcm9tICcuL0J1dHRvbic7XHJcblxyXG5pbXBvcnQgaW52YXJpYW50IGZyb20gJ2Fzc2VydCc7XHJcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IHtCdXR0b24sIEJ1dHRvblNpemVzfSBmcm9tICcuL0J1dHRvbic7XHJcbmltcG9ydCB7QnV0dG9uR3JvdXB9IGZyb20gJy4vQnV0dG9uR3JvdXAnO1xyXG5pbXBvcnQge0Ryb3Bkb3dufSBmcm9tICcuL0Ryb3Bkb3duJztcclxuaW1wb3J0IGNsYXNzbmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XHJcbmltcG9ydCBlbGVjdHJvbiBmcm9tICdlbGVjdHJvbic7XHJcbmNvbnN0IHtyZW1vdGV9ID0gZWxlY3Ryb247XHJcbmludmFyaWFudChyZW1vdGUgIT0gbnVsbCk7XHJcblxyXG50eXBlIEJ1dHRvblNpemUgPSAnRVhUUkFfU01BTEwnIHwgJ1NNQUxMJyB8ICdMQVJHRSc7XHJcblxyXG50eXBlIFByb3BzID0ge1xyXG4gIGJ1dHRvbkNvbXBvbmVudD86IFJlYWN0LkNvbXBvbmVudFR5cGU8YW55PixcclxuICBidXR0b25UeXBlPzogP0J1dHRvblR5cGUsXHJcbiAgY2hhbmdlRGlzYWJsZWQ/OiBib29sZWFuLFxyXG4gIGNsYXNzTmFtZT86IHN0cmluZyxcclxuICBjb25maXJtRGlzYWJsZWQ/OiBib29sZWFuLFxyXG4gIG9uQ2hhbmdlPzogKHZhbHVlOiBhbnkpID0+IG1peGVkLFxyXG4gIG9uQ29uZmlybTogKHZhbHVlOiBhbnkpID0+IG1peGVkLFxyXG4gIG9wdGlvbnM6IEFycmF5PE9wdGlvbj4sXHJcbiAgc2l6ZT86ID9CdXR0b25TaXplLFxyXG4gIHZhbHVlOiBhbnksXHJcbiAgc2VsZWN0aW9uQ29tcGFyYXRvcj86IChkcm9wZG93blZhbHVlOiBhbnksIG9wdGlvblZhbHVlOiBhbnkpID0+IGJvb2xlYW4sXHJcbiAgdGFiSW5kZXg/OiBzdHJpbmcsXHJcbn07XHJcblxyXG5leHBvcnQgY2xhc3MgU3BsaXRCdXR0b25Ecm9wZG93biBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcz4ge1xyXG4gIHJlbmRlcigpOiBSZWFjdC5Ob2RlIHtcclxuICAgIGNvbnN0IHtcclxuICAgICAgYnV0dG9uQ29tcG9uZW50LFxyXG4gICAgICBjaGFuZ2VEaXNhYmxlZCxcclxuICAgICAgY2xhc3NOYW1lLFxyXG4gICAgICBjb25maXJtRGlzYWJsZWQsXHJcbiAgICAgIG9uQ2hhbmdlLFxyXG4gICAgICBvbkNvbmZpcm0sXHJcbiAgICAgIG9wdGlvbnMsXHJcbiAgICAgIHNpemUsXHJcbiAgICAgIHZhbHVlLFxyXG4gICAgICBzZWxlY3Rpb25Db21wYXJhdG9yLFxyXG4gICAgfSA9IHRoaXMucHJvcHM7XHJcbiAgICBjb25zdCBzZWxlY3RlZE9wdGlvbiA9IHRoaXMuX2ZpbmRTZWxlY3RlZE9wdGlvbihvcHRpb25zKSB8fCBvcHRpb25zWzBdO1xyXG4gICAgaW52YXJpYW50KHNlbGVjdGVkT3B0aW9uLnR5cGUgIT09ICdzZXBhcmF0b3InKTtcclxuICAgIGNvbnN0IEJ1dHRvbkNvbXBvbmVudCA9IGJ1dHRvbkNvbXBvbmVudCB8fCBCdXR0b247XHJcbiAgICAvLyAkRmxvd0ZpeE1lKD49MC41My4wKSBGbG93IHN1cHByZXNzXHJcbiAgICBjb25zdCBkcm9wZG93bk9wdGlvbnMgPSBvcHRpb25zLm1hcChvcHRpb24gPT4gKHtcclxuICAgICAgLi4ub3B0aW9uLFxyXG4gICAgICBzZWxlY3RlZExhYmVsOiAnJyxcclxuICAgIH0pKTtcclxuXHJcbiAgICByZXR1cm4gKFxyXG4gICAgICA8QnV0dG9uR3JvdXBcclxuICAgICAgICBjbGFzc05hbWU9e2NsYXNzbmFtZXMoY2xhc3NOYW1lLCAnbnVjbGlkZS11aS1zcGxpdC1idXR0b24tZHJvcGRvd24nKX0+XHJcbiAgICAgICAgPEJ1dHRvbkNvbXBvbmVudFxyXG4gICAgICAgICAgYnV0dG9uVHlwZT17dGhpcy5wcm9wcy5idXR0b25UeXBlfVxyXG4gICAgICAgICAgc2l6ZT17c2l6ZSA9PSBudWxsID8gdW5kZWZpbmVkIDogc2l6ZX1cclxuICAgICAgICAgIGRpc2FibGVkPXtjb25maXJtRGlzYWJsZWQgPT09IHRydWV9XHJcbiAgICAgICAgICBpY29uPXtzZWxlY3RlZE9wdGlvbi5pY29uIHx8IHVuZGVmaW5lZH1cclxuICAgICAgICAgIG9uQ2xpY2s9e29uQ29uZmlybS5iaW5kKG51bGwsIHZhbHVlKX1cclxuICAgICAgICAgIHRhYkluZGV4PXt0aGlzLnByb3BzLnRhYkluZGV4fT5cclxuICAgICAgICAgIHsvLyBmbG93bGludC1uZXh0LWxpbmUgc2tldGNoeS1udWxsLW1peGVkOm9mZiwgc2tldGNoeS1udWxsLXN0cmluZzpvZmZcclxuICAgICAgICAgIHNlbGVjdGVkT3B0aW9uLnNlbGVjdGVkTGFiZWwgfHwgc2VsZWN0ZWRPcHRpb24ubGFiZWwgfHwgJyd9XHJcbiAgICAgICAgPC9CdXR0b25Db21wb25lbnQ+XHJcbiAgICAgICAgPERyb3Bkb3duXHJcbiAgICAgICAgICBidXR0b25UeXBlPXt0aGlzLnByb3BzLmJ1dHRvblR5cGV9XHJcbiAgICAgICAgICBzaXplPXt0aGlzLl9nZXREcm9wZG93blNpemUoc2l6ZSl9XHJcbiAgICAgICAgICBkaXNhYmxlZD17Y2hhbmdlRGlzYWJsZWQgPT09IHRydWV9XHJcbiAgICAgICAgICBvcHRpb25zPXtkcm9wZG93bk9wdGlvbnN9XHJcbiAgICAgICAgICB2YWx1ZT17dmFsdWV9XHJcbiAgICAgICAgICBvbkNoYW5nZT17b25DaGFuZ2V9XHJcbiAgICAgICAgICBzZWxlY3Rpb25Db21wYXJhdG9yPXtzZWxlY3Rpb25Db21wYXJhdG9yfVxyXG4gICAgICAgICAgdGFiSW5kZXg9e3RoaXMucHJvcHMudGFiSW5kZXh9XHJcbiAgICAgICAgLz5cclxuICAgICAgPC9CdXR0b25Hcm91cD5cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfZ2V0RHJvcGRvd25TaXplKHNpemU6ID9CdXR0b25TaXplKTogJ3NtJyB8ICd4cycgfCAnbGcnIHtcclxuICAgIHN3aXRjaCAoc2l6ZSkge1xyXG4gICAgICBjYXNlIEJ1dHRvblNpemVzLkVYVFJBX1NNQUxMOlxyXG4gICAgICAgIHJldHVybiAneHMnO1xyXG4gICAgICBjYXNlIEJ1dHRvblNpemVzLlNNQUxMOlxyXG4gICAgICAgIHJldHVybiAnc20nO1xyXG4gICAgICBjYXNlIEJ1dHRvblNpemVzLkxBUkdFOlxyXG4gICAgICAgIHJldHVybiAnbGcnO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiAnc20nO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2ZpbmRTZWxlY3RlZE9wdGlvbihvcHRpb25zOiBBcnJheTxPcHRpb24+KTogP09wdGlvbiB7XHJcbiAgICBsZXQgcmVzdWx0ID0gbnVsbDtcclxuICAgIGNvbnN0IHNlbGVjdGlvbkNvbXBhcmF0b3IgPVxyXG4gICAgICB0aGlzLnByb3BzLnNlbGVjdGlvbkNvbXBhcmF0b3IgPT0gbnVsbFxyXG4gICAgICAgID8gKGEsIGIpID0+IGEgPT09IGJcclxuICAgICAgICA6IHRoaXMucHJvcHMuc2VsZWN0aW9uQ29tcGFyYXRvcjtcclxuICAgIGZvciAoY29uc3Qgb3B0aW9uIG9mIG9wdGlvbnMpIHtcclxuICAgICAgaWYgKG9wdGlvbi50eXBlID09PSAnc2VwYXJhdG9yJykge1xyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9IGVsc2UgaWYgKG9wdGlvbi50eXBlID09PSAnc3VibWVudScpIHtcclxuICAgICAgICBjb25zdCBzdWJtZW51ID0gKChvcHRpb24uc3VibWVudTogYW55KTogQXJyYXk8T3B0aW9uPik7XHJcbiAgICAgICAgcmVzdWx0ID0gdGhpcy5fZmluZFNlbGVjdGVkT3B0aW9uKHN1Ym1lbnUpO1xyXG4gICAgICB9IGVsc2UgaWYgKHNlbGVjdGlvbkNvbXBhcmF0b3Iob3B0aW9uLnZhbHVlLCB0aGlzLnByb3BzLnZhbHVlKSkge1xyXG4gICAgICAgIHJlc3VsdCA9IG9wdGlvbjtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKHJlc3VsdCkge1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IHtCdXR0b25TaXplc307XHJcbiJdfQ==