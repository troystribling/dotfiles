"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Tree = Tree;
exports.TreeList = exports.NestedTreeItem = exports.TreeItem = void 0;

var React = _interopRequireWildcard(require("react"));

var _classnames = _interopRequireDefault(require("classnames"));

var _assert = _interopRequireDefault(require("assert"));

var _scrollIntoView = require("./scrollIntoView");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function Tree({
  className,
  style,
  ...props
}) {
  return /*#__PURE__*/React.createElement("ol", _extends({
    className: (0, _classnames.default)('list-tree', className),
    role: "tree",
    style: {
      position: 'relative',
      ...style
    }
  }, props));
}

class TreeItem extends React.Component {
  constructor(...args) {
    super(...args);
    this._liNode = void 0;
    this._handleClick = handleClick.bind(this);
  }

  scrollIntoView() {
    if (this._liNode != null) {
      (0, _scrollIntoView.scrollIntoView)(this._liNode);
    }
  }

  render() {
    const {
      className,
      selected,
      children,
      onMouseDown,
      onMouseEnter,
      onMouseLeave,
      path,
      name,
      title
    } = this.props;
    return /*#__PURE__*/React.createElement("div", {
      title: title
    }, /*#__PURE__*/React.createElement("li", {
      "aria-selected": selected,
      className: (0, _classnames.default)(className, {
        selected
      }, 'list-item'),
      onMouseDown: onMouseDown,
      onMouseEnter: onMouseEnter,
      onMouseLeave: onMouseLeave,
      "data-path": path,
      "data-name": name,
      onClick: this._handleClick,
      ref: liNode => this._liNode = liNode,
      role: "treeitem",
      tabIndex: selected ? '0' : '-1'
    }, selected && typeof children === 'string' ?
    /*#__PURE__*/
    // String children must be wrapped to receive correct styles when selected.
    React.createElement("span", null, children) : children));
  }

}

exports.TreeItem = TreeItem;

class NestedTreeItem extends React.Component {
  constructor(...args) {
    super(...args);
    this._itemNode = void 0;

    this._handleClick = e => {
      const itemNode = this._itemNode;

      if (itemNode == null) {
        return;
      }

      (0, _assert.default)(e.target instanceof Element);

      if (e.target.closest('.list-item') === itemNode) {
        handleClick.call(this, e);
      }
    };
  }

  render() {
    const {
      className,
      hasFlatChildren,
      selected,
      collapsed,
      title,
      children
    } = this.props;
    return /*#__PURE__*/React.createElement("li", {
      "aria-selected": selected,
      "aria-expanded": !collapsed,
      className: (0, _classnames.default)(className, {
        selected,
        collapsed
      }, 'list-nested-item'),
      onClick: this._handleClick,
      role: "treeitem",
      tabIndex: selected ? '0' : '-1'
    }, title == null ? null : /*#__PURE__*/React.createElement("div", {
      tabIndex: -1,
      className: "native-key-bindings list-item",
      ref: node => this._itemNode = node
    }, title), /*#__PURE__*/React.createElement(TreeList, {
      hasFlatChildren: hasFlatChildren
    }, children));
  }

}

exports.NestedTreeItem = NestedTreeItem;

const TreeList = props =>
/*#__PURE__*/
// $FlowFixMe(>=0.53.0) Flow suppress
React.createElement("ul", {
  className: (0, _classnames.default)(props.className, {
    'has-collapsable-children': props.showArrows,
    'has-flat-children': props.hasFlatChildren
  }, 'list-tree'),
  role: "group"
}, props.children);

exports.TreeList = TreeList;

function handleClick(e) {
  const {
    onSelect,
    onConfirm,
    onTripleClick
  } = this.props;
  const numberOfClicks = e.detail;

  switch (numberOfClicks) {
    case 1:
      onSelect && onSelect(e);
      break;

    case 2:
      onConfirm && onConfirm(e);
      break;

    case 3:
      onTripleClick && onTripleClick(e);
      break;

    default:
      break;
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL251Y2xpZGUvbnVjbGlkZS1jb21tb25zLXVpL1RyZWUuanMiXSwibmFtZXMiOlsiVHJlZSIsImNsYXNzTmFtZSIsInN0eWxlIiwicHJvcHMiLCJwb3NpdGlvbiIsIlRyZWVJdGVtIiwiUmVhY3QiLCJDb21wb25lbnQiLCJfbGlOb2RlIiwiX2hhbmRsZUNsaWNrIiwiaGFuZGxlQ2xpY2siLCJiaW5kIiwic2Nyb2xsSW50b1ZpZXciLCJyZW5kZXIiLCJzZWxlY3RlZCIsImNoaWxkcmVuIiwib25Nb3VzZURvd24iLCJvbk1vdXNlRW50ZXIiLCJvbk1vdXNlTGVhdmUiLCJwYXRoIiwibmFtZSIsInRpdGxlIiwibGlOb2RlIiwiTmVzdGVkVHJlZUl0ZW0iLCJfaXRlbU5vZGUiLCJlIiwiaXRlbU5vZGUiLCJ0YXJnZXQiLCJFbGVtZW50IiwiY2xvc2VzdCIsImNhbGwiLCJoYXNGbGF0Q2hpbGRyZW4iLCJjb2xsYXBzZWQiLCJub2RlIiwiVHJlZUxpc3QiLCJzaG93QXJyb3dzIiwib25TZWxlY3QiLCJvbkNvbmZpcm0iLCJvblRyaXBsZUNsaWNrIiwibnVtYmVyT2ZDbGlja3MiLCJkZXRhaWwiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBY0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7Ozs7Ozs7QUFFTyxTQUFTQSxJQUFULENBQWM7QUFBQ0MsRUFBQUEsU0FBRDtBQUFZQyxFQUFBQSxLQUFaO0FBQW1CLEtBQUdDO0FBQXRCLENBQWQsRUFBb0Q7QUFDekQsc0JBQ0U7QUFDRSxJQUFBLFNBQVMsRUFBRSx5QkFBVyxXQUFYLEVBQXdCRixTQUF4QixDQURiO0FBRUUsSUFBQSxJQUFJLEVBQUMsTUFGUDtBQUdFLElBQUEsS0FBSyxFQUFFO0FBQUNHLE1BQUFBLFFBQVEsRUFBRSxVQUFYO0FBQXVCLFNBQUdGO0FBQTFCO0FBSFQsS0FJTUMsS0FKTixFQURGO0FBUUQ7O0FBb0JNLE1BQU1FLFFBQU4sU0FBdUJDLEtBQUssQ0FBQ0MsU0FBN0IsQ0FBc0Q7QUFBQTtBQUFB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QSxHQUFHLEVBQUVZLElBQUksSUFBSyxLQUFLVCxTQUFMLEdBQWlCUztBQUhqQyxPQUlHWixLQUpILENBZkosZUFzQkUsb0JBQUMsUUFBRDtBQUFVLE1BQUEsZUFBZSxFQUFFVTtBQUEzQixPQUE2Q2hCLFFBQTdDLENBdEJGLENBREY7QUEwQkQ7O0FBbERzRTs7OztBQTREbEUsTUFBTW1CLFFBQVEsR0FBSS9CLEtBQUQ7QUFBQTtBQUN0QjtBQUNBO0FBQ0UsRUFBQSxTQUFTLEVBQUUseUJBQ1RBLEtBQUssQ0FBQ0YsU0FERyxFQUVUO0FBQ0UsZ0NBQTRCRSxLQUFLLENBQUNnQyxVQURwQztBQUVFLHlCQUFxQmhDLEtBQUssQ0FBQzRCO0FBRjdCLEdBRlMsRUFNVCxXQU5TLENBRGI7QUFTRSxFQUFBLElBQUksRUFBQztBQVRQLEdBVUc1QixLQUFLLENBQUNZLFFBVlQsQ0FGSzs7OztBQWdCUCxTQUFTTCxXQUFULENBQXFCZSxDQUFyQixFQUFxRDtBQUNuRCxRQUFNO0FBQUNXLElBQUFBLFFBQUQ7QUFBV0MsSUFBQUEsU0FBWDtBQUFzQkMsSUFBQUE7QUFBdEIsTUFBdUMsS0FBS25DLEtBQWxEO0FBRUEsUUFBTW9DLGNBQWMsR0FBR2QsQ0FBQyxDQUFDZSxNQUF6Qjs7QUFDQSxVQUFRRCxjQUFSO0FBQ0UsU0FBSyxDQUFMO0FBQ0VILE1BQUFBLFFBQVEsSUFBSUEsUUFBUSxDQUFDWCxDQUFELENBQXBCO0FBQ0E7O0FBQ0YsU0FBSyxDQUFMO0FBQ0VZLE1BQUFBLFNBQVMsSUFBSUEsU0FBUyxDQUFDWixDQUFELENBQXRCO0FBQ0E7O0FBQ0YsU0FBSyxDQUFMO0FBQ0VhLE1BQUFBLGFBQWEsSUFBSUEsYUFBYSxDQUFDYixDQUFELENBQTlCO0FBQ0E7O0FBQ0Y7QUFDRTtBQVhKO0FBYUQiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ29weXJpZ2h0IChjKSAyMDE3LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXHJcbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIEJTRC1zdHlsZSBsaWNlbnNlIGZvdW5kIGluIHRoZVxyXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuIEFuIGFkZGl0aW9uYWwgZ3JhbnRcclxuICogb2YgcGF0ZW50IHJpZ2h0cyBjYW4gYmUgZm91bmQgaW4gdGhlIFBBVEVOVFMgZmlsZSBpbiB0aGUgc2FtZSBkaXJlY3RvcnkuXHJcbiAqXHJcbiAqIEBmbG93XHJcbiAqIEBmb3JtYXRcclxuICovXHJcblxyXG4vKiBlc2xpbnQtZW52IGJyb3dzZXIgKi9cclxuXHJcbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0IGNsYXNzbmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XHJcbmltcG9ydCBpbnZhcmlhbnQgZnJvbSAnYXNzZXJ0JztcclxuaW1wb3J0IHtzY3JvbGxJbnRvVmlld30gZnJvbSAnLi9zY3JvbGxJbnRvVmlldyc7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gVHJlZSh7Y2xhc3NOYW1lLCBzdHlsZSwgLi4ucHJvcHN9OiBPYmplY3QpIHtcclxuICByZXR1cm4gKFxyXG4gICAgPG9sXHJcbiAgICAgIGNsYXNzTmFtZT17Y2xhc3NuYW1lcygnbGlzdC10cmVlJywgY2xhc3NOYW1lKX1cclxuICAgICAgcm9sZT1cInRyZWVcIlxyXG4gICAgICBzdHlsZT17e3Bvc2l0aW9uOiAncmVsYXRpdmUnLCAuLi5zdHlsZX19XHJcbiAgICAgIHsuLi5wcm9wc31cclxuICAgIC8+XHJcbiAgKTtcclxufVxyXG5cclxudHlwZSBUcmVlSXRlbVByb3BzID0ge3xcclxuICBjaGlsZHJlbj86IFJlYWN0Lk5vZGUsXHJcbiAgY2xhc3NOYW1lPzogc3RyaW5nLFxyXG4gIC8vIGhhbmRsZWQgYmVsb3cgaW4gYGhhbmRsZUNsaWNrYFxyXG4gIC8qIGVzbGludC1kaXNhYmxlIHJlYWN0L25vLXVudXNlZC1wcm9wLXR5cGVzICovXHJcbiAgb25TZWxlY3Q/OiAoZTogU3ludGhldGljTW91c2VFdmVudDw+KSA9PiBtaXhlZCxcclxuICBvbkNvbmZpcm0/OiAoZTogU3ludGhldGljTW91c2VFdmVudDw+KSA9PiBtaXhlZCxcclxuICBvblRyaXBsZUNsaWNrPzogKGU6IFN5bnRoZXRpY01vdXNlRXZlbnQ8PikgPT4gbWl4ZWQsXHJcbiAgLyogZXNsaW50LWVuYWJsZSByZWFjdC9uby11bnVzZWQtcHJvcC10eXBlcyAqL1xyXG4gIHNlbGVjdGVkPzogYm9vbGVhbixcclxuICBvbk1vdXNlRG93bj86IChlOiBTeW50aGV0aWNNb3VzZUV2ZW50PD4pID0+IG1peGVkLFxyXG4gIG9uTW91c2VFbnRlcj86IChlOiBTeW50aGV0aWNNb3VzZUV2ZW50PD4pID0+IG1peGVkLFxyXG4gIG9uTW91c2VMZWF2ZT86IChlOiBTeW50aGV0aWNNb3VzZUV2ZW50PD4pID0+IG1peGVkLFxyXG4gIHBhdGg/OiBzdHJpbmcsXHJcbiAgbmFtZT86IHN0cmluZyxcclxuICB0aXRsZT86IHN0cmluZyxcclxufH07XHJcblxyXG5leHBvcnQgY2xhc3MgVHJlZUl0ZW0gZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8VHJlZUl0ZW1Qcm9wcz4ge1xyXG4gIF9saU5vZGU6ID9IVE1MTElFbGVtZW50O1xyXG4gIF9oYW5kbGVDbGljayA9IGhhbmRsZUNsaWNrLmJpbmQodGhpcyk7XHJcblxyXG4gIHNjcm9sbEludG9WaWV3KCkge1xyXG4gICAgaWYgKHRoaXMuX2xpTm9kZSAhPSBudWxsKSB7XHJcbiAgICAgIHNjcm9sbEludG9WaWV3KHRoaXMuX2xpTm9kZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7XHJcbiAgICAgIGNsYXNzTmFtZSxcclxuICAgICAgc2VsZWN0ZWQsXHJcbiAgICAgIGNoaWxkcmVuLFxyXG4gICAgICBvbk1vdXNlRG93bixcclxuICAgICAgb25Nb3VzZUVudGVyLFxyXG4gICAgICBvbk1vdXNlTGVhdmUsXHJcbiAgICAgIHBhdGgsXHJcbiAgICAgIG5hbWUsXHJcbiAgICAgIHRpdGxlLFxyXG4gICAgfSA9IHRoaXMucHJvcHM7XHJcblxyXG4gICAgcmV0dXJuIChcclxuICAgICAgPGRpdiB0aXRsZT17dGl0bGV9PlxyXG4gICAgICAgIDxsaVxyXG4gICAgICAgICAgYXJpYS1zZWxlY3RlZD17c2VsZWN0ZWR9XHJcbiAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzbmFtZXMoXHJcbiAgICAgICAgICAgIGNsYXNzTmFtZSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgIHNlbGVjdGVkLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnbGlzdC1pdGVtJyxcclxuICAgICAgICAgICl9XHJcbiAgICAgICAgICBvbk1vdXNlRG93bj17b25Nb3VzZURvd259XHJcbiAgICAgICAgICBvbk1vdXNlRW50ZXI9e29uTW91c2VFbnRlcn1cclxuICAgICAgICAgIG9uTW91c2VMZWF2ZT17b25Nb3VzZUxlYXZlfVxyXG4gICAgICAgICAgZGF0YS1wYXRoPXtwYXRofVxyXG4gICAgICAgICAgZGF0YS1uYW1lPXtuYW1lfVxyXG4gICAgICAgICAgb25DbGljaz17dGhpcy5faGFuZGxlQ2xpY2t9XHJcbiAgICAgICAgICByZWY9e2xpTm9kZSA9PiAodGhpcy5fbGlOb2RlID0gbGlOb2RlKX1cclxuICAgICAgICAgIHJvbGU9XCJ0cmVlaXRlbVwiXHJcbiAgICAgICAgICB0YWJJbmRleD17c2VsZWN0ZWQgPyAnMCcgOiAnLTEnfT5cclxuICAgICAgICAgIHtzZWxlY3RlZCAmJiB0eXBlb2YgY2hpbGRyZW4gPT09ICdzdHJpbmcnID8gKFxyXG4gICAgICAgICAgICAvLyBTdHJpbmcgY2hpbGRyZW4gbXVzdCBiZSB3cmFwcGVkIHRvIHJlY2VpdmUgY29ycmVjdCBzdHlsZXMgd2hlbiBzZWxlY3RlZC5cclxuICAgICAgICAgICAgPHNwYW4+e2NoaWxkcmVufTwvc3Bhbj5cclxuICAgICAgICAgICkgOiAoXHJcbiAgICAgICAgICAgIGNoaWxkcmVuXHJcbiAgICAgICAgICApfVxyXG4gICAgICAgIDwvbGk+XHJcbiAgICAgIDwvZGl2PlxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbnR5cGUgTmVzdGVkVHJlZUl0ZW1Qcm9wcyA9IHt8XHJcbiAgdGl0bGU/OiBSZWFjdC5Ob2RlLFxyXG4gIGNoaWxkcmVuPzogbWl4ZWQsXHJcbiAgY2xhc3NOYW1lPzogc3RyaW5nLFxyXG4gIGhhc0ZsYXRDaGlsZHJlbj86IGJvb2xlYW4sIC8vIHBhc3N0aHJvdWdoIHRvIGlubmVyIFRyZWVMaXN0XHJcbiAgc2VsZWN0ZWQ/OiBib29sZWFuLFxyXG4gIGNvbGxhcHNlZD86IGJvb2xlYW4sXHJcbiAgLy8gaGFuZGxlZCBiZWxvdyBpbiBgaGFuZGxlQ2xpY2tgXHJcbiAgLyogZXNsaW50LWRpc2FibGUgcmVhY3Qvbm8tdW51c2VkLXByb3AtdHlwZXMgKi9cclxuICBvblNlbGVjdD86IChlOiBTeW50aGV0aWNNb3VzZUV2ZW50PD4pID0+IG1peGVkLFxyXG4gIG9uQ29uZmlybT86IChlOiBTeW50aGV0aWNNb3VzZUV2ZW50PD4pID0+IG1peGVkLFxyXG4gIG9uVHJpcGxlQ2xpY2s/OiAoZTogU3ludGhldGljTW91c2VFdmVudDw+KSA9PiBtaXhlZCxcclxuICAvKiBlc2xpbnQtZGlzYWJsZSByZWFjdC9uby11bnVzZWQtcHJvcC10eXBlcyAqL1xyXG58fTtcclxuXHJcbmV4cG9ydCBjbGFzcyBOZXN0ZWRUcmVlSXRlbSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxOZXN0ZWRUcmVlSXRlbVByb3BzPiB7XHJcbiAgX2l0ZW1Ob2RlOiA/SFRNTERpdkVsZW1lbnQ7XHJcbiAgX2hhbmRsZUNsaWNrID0gKGU6IFN5bnRoZXRpY01vdXNlRXZlbnQ8PikgPT4ge1xyXG4gICAgY29uc3QgaXRlbU5vZGUgPSB0aGlzLl9pdGVtTm9kZTtcclxuICAgIGlmIChpdGVtTm9kZSA9PSBudWxsKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICBpbnZhcmlhbnQoZS50YXJnZXQgaW5zdGFuY2VvZiBFbGVtZW50KTtcclxuICAgIGlmIChlLnRhcmdldC5jbG9zZXN0KCcubGlzdC1pdGVtJykgPT09IGl0ZW1Ob2RlKSB7XHJcbiAgICAgIGhhbmRsZUNsaWNrLmNhbGwodGhpcywgZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgcmVuZGVyKCkge1xyXG4gICAgY29uc3Qge1xyXG4gICAgICBjbGFzc05hbWUsXHJcbiAgICAgIGhhc0ZsYXRDaGlsZHJlbixcclxuICAgICAgc2VsZWN0ZWQsXHJcbiAgICAgIGNvbGxhcHNlZCxcclxuICAgICAgdGl0bGUsXHJcbiAgICAgIGNoaWxkcmVuLFxyXG4gICAgfSA9IHRoaXMucHJvcHM7XHJcblxyXG4gICAgcmV0dXJuIChcclxuICAgICAgPGxpXHJcbiAgICAgICAgYXJpYS1zZWxlY3RlZD17c2VsZWN0ZWR9XHJcbiAgICAgICAgYXJpYS1leHBhbmRlZD17IWNvbGxhcHNlZH1cclxuICAgICAgICBjbGFzc05hbWU9e2NsYXNzbmFtZXMoXHJcbiAgICAgICAgICBjbGFzc05hbWUsXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkLFxyXG4gICAgICAgICAgICBjb2xsYXBzZWQsXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgJ2xpc3QtbmVzdGVkLWl0ZW0nLFxyXG4gICAgICAgICl9XHJcbiAgICAgICAgb25DbGljaz17dGhpcy5faGFuZGxlQ2xpY2t9XHJcbiAgICAgICAgcm9sZT1cInRyZWVpdGVtXCJcclxuICAgICAgICB0YWJJbmRleD17c2VsZWN0ZWQgPyAnMCcgOiAnLTEnfT5cclxuICAgICAgICB7dGl0bGUgPT0gbnVsbCA/IG51bGwgOiAoXHJcbiAgICAgICAgICA8ZGl2XHJcbiAgICAgICAgICAgIHRhYkluZGV4PXstMX1cclxuICAgICAgICAgICAgY2xhc3NOYW1lPVwibmF0aXZlLWtleS1iaW5kaW5ncyBsaXN0LWl0ZW1cIlxyXG4gICAgICAgICAgICByZWY9e25vZGUgPT4gKHRoaXMuX2l0ZW1Ob2RlID0gbm9kZSl9PlxyXG4gICAgICAgICAgICB7dGl0bGV9XHJcbiAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICApfVxyXG4gICAgICAgIDxUcmVlTGlzdCBoYXNGbGF0Q2hpbGRyZW49e2hhc0ZsYXRDaGlsZHJlbn0+e2NoaWxkcmVufTwvVHJlZUxpc3Q+XHJcbiAgICAgIDwvbGk+XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxudHlwZSBUcmVlTGlzdFByb3BzID0ge1xyXG4gIGNsYXNzTmFtZT86IHN0cmluZyxcclxuICAvKiB0eXBpY2FsbHksIGluc3RhbmNlcyBvZiBUcmVlSXRlbSBvciBOZXN0ZWRUcmVlSXRlbS4gKi9cclxuICBjaGlsZHJlbj86IG1peGVkLFxyXG4gIHNob3dBcnJvd3M/OiBib29sZWFuLFxyXG4gIGhhc0ZsYXRDaGlsZHJlbj86IGJvb2xlYW4sXHJcbn07XHJcbmV4cG9ydCBjb25zdCBUcmVlTGlzdCA9IChwcm9wczogVHJlZUxpc3RQcm9wcykgPT4gKFxyXG4gIC8vICRGbG93Rml4TWUoPj0wLjUzLjApIEZsb3cgc3VwcHJlc3NcclxuICA8dWxcclxuICAgIGNsYXNzTmFtZT17Y2xhc3NuYW1lcyhcclxuICAgICAgcHJvcHMuY2xhc3NOYW1lLFxyXG4gICAgICB7XHJcbiAgICAgICAgJ2hhcy1jb2xsYXBzYWJsZS1jaGlsZHJlbic6IHByb3BzLnNob3dBcnJvd3MsXHJcbiAgICAgICAgJ2hhcy1mbGF0LWNoaWxkcmVuJzogcHJvcHMuaGFzRmxhdENoaWxkcmVuLFxyXG4gICAgICB9LFxyXG4gICAgICAnbGlzdC10cmVlJyxcclxuICAgICl9XHJcbiAgICByb2xlPVwiZ3JvdXBcIj5cclxuICAgIHtwcm9wcy5jaGlsZHJlbn1cclxuICA8L3VsPlxyXG4pO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ2xpY2soZTogU3ludGhldGljTW91c2VFdmVudDw+KTogdm9pZCB7XHJcbiAgY29uc3Qge29uU2VsZWN0LCBvbkNvbmZpcm0sIG9uVHJpcGxlQ2xpY2t9ID0gdGhpcy5wcm9wcztcclxuXHJcbiAgY29uc3QgbnVtYmVyT2ZDbGlja3MgPSBlLmRldGFpbDtcclxuICBzd2l0Y2ggKG51bWJlck9mQ2xpY2tzKSB7XHJcbiAgICBjYXNlIDE6XHJcbiAgICAgIG9uU2VsZWN0ICYmIG9uU2VsZWN0KGUpO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgMjpcclxuICAgICAgb25Db25maXJtICYmIG9uQ29uZmlybShlKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlIDM6XHJcbiAgICAgIG9uVHJpcGxlQ2xpY2sgJiYgb25UcmlwbGVDbGljayhlKTtcclxuICAgICAgYnJlYWs7XHJcbiAgICBkZWZhdWx0OlxyXG4gICAgICBicmVhaztcclxuICB9XHJcbn1cclxuIl19