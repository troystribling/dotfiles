"use strict";

// Generated by CoffeeScript 1.12.2
(function () {
  var itemIsAllowedInPane,
      indexOf = [].indexOf || function (item) {
    for (var i = 0, l = this.length; i < l; i++) {
      if (i in this && this[i] === item) return i;
    }

    return -1;
  };

  module.exports = {
    activate: function () {
      this.view = document.createElement('div');
      atom.workspace.getElement().appendChild(this.view);
      return this.view.classList.add('tabs-layout-overlay');
    },
    deactivate: function () {
      var ref;
      return (ref = this.view.parentElement) != null ? ref.removeChild(this.view) : void 0;
    },
    test: {},
    drag: function (e) {
      var coords, item, itemView, pane;
      this.lastCoords = e;
      pane = this.getPaneAt(e);
      itemView = this.getItemViewAt(e);
      item = e.target.item;

      if (pane != null && itemView != null && item && itemIsAllowedInPane(item, pane)) {
        coords = !(this.isOnlyTabInPane(pane, e.target) || pane.getItems().length === 0) ? [e.clientX, e.clientY] : void 0;
        return this.lastSplit = this.updateView(itemView, coords);
      } else {
        return this.disableView();
      }
    },
    end: function (e) {
      var fromPane, item, tab, target, toPane;
      this.disableView();

      if (!(this.lastCoords != null && this.getItemViewAt(this.lastCoords))) {
        return;
      }

      target = this.getPaneAt(this.lastCoords);

      if (target == null) {
        return;
      }

      tab = e.target;
      fromPane = tab.pane;
      item = tab.item;

      if (!itemIsAllowedInPane(item, typeof toPane !== "undefined" && toPane !== null ? toPane : target)) {
        return;
      }

      toPane = function () {
        switch (this.lastSplit) {
          case 'left':
            return target.splitLeft();

          case 'right':
            return target.splitRight();

          case 'up':
            return target.splitUp();

          case 'down':
            return target.splitDown();
        }
      }.call(this);

      if (toPane == null) {
        toPane = target;
      }

      if (toPane === fromPane) {
        return;
      }

      fromPane.moveItemToPane(item, toPane);
      toPane.activateItem(item);
      return toPane.activate();
    },
    getElement: function (arg, selector) {
      var clientX, clientY;
      clientX = arg.clientX, clientY = arg.clientY;

      if (selector == null) {
        selector = '*';
      }

      return document.elementFromPoint(clientX, clientY).closest(selector);
    },
    getItemViewAt: function (coords) {
      return this.test.itemView || this.getElement(coords, '.item-views');
    },
    getPaneAt: function (coords) {
      var ref;
      return this.test.pane || ((ref = this.getElement(this.lastCoords, 'atom-pane')) != null ? ref.getModel() : void 0);
    },
    isOnlyTabInPane: function (pane, tab) {
      return pane.getItems().length === 1 && pane === tab.pane;
    },
    normalizeCoords: function (arg, arg1) {
      var height, left, top, width, x, y;
      left = arg.left, top = arg.top, width = arg.width, height = arg.height;
      x = arg1[0], y = arg1[1];
      return [(x - left) / width, (y - top) / height];
    },
    splitType: function (arg) {
      var x, y;
      x = arg[0], y = arg[1];

      if (x < 1 / 3) {
        return 'left';
      } else if (x > 2 / 3) {
        return 'right';
      } else if (y < 1 / 3) {
        return 'up';
      } else if (y > 2 / 3) {
        return 'down';
      }
    },
    boundsForSplit: function (split) {
      var h, ref, w, x, y;
      return ref = function () {
        switch (split) {
          case 'left':
            return [0, 0, 0.5, 1];

          case 'right':
            return [0.5, 0, 0.5, 1];

          case 'up':
            return [0, 0, 1, 0.5];

          case 'down':
            return [0, 0.5, 1, 0.5];

          default:
            return [0, 0, 1, 1];
        }
      }(), x = ref[0], y = ref[1], w = ref[2], h = ref[3], ref;
    },
    innerBounds: function (arg, arg1) {
      var h, height, left, top, w, width, x, y;
      left = arg.left, top = arg.top, width = arg.width, height = arg.height;
      x = arg1[0], y = arg1[1], w = arg1[2], h = arg1[3];
      left += x * width;
      top += y * height;
      width *= w;
      height *= h;
      return {
        left: left,
        top: top,
        width: width,
        height: height
      };
    },
    updateViewBounds: function (arg) {
      var height, left, top, width;
      left = arg.left, top = arg.top, width = arg.width, height = arg.height;
      this.view.style.left = left + "px";
      this.view.style.top = top + "px";
      this.view.style.width = width + "px";
      return this.view.style.height = height + "px";
    },
    updateView: function (pane, coords) {
      var rect, split;
      this.view.classList.add('visible');
      rect = this.test.rect || pane.getBoundingClientRect();
      split = coords ? this.splitType(this.normalizeCoords(rect, coords)) : void 0;
      this.updateViewBounds(this.innerBounds(rect, this.boundsForSplit(split)));
      return split;
    },
    disableView: function () {
      return this.view.classList.remove('visible');
    }
  };

  itemIsAllowedInPane = function (item, pane) {
    var allowedLocations, container, location, ref;
    allowedLocations = typeof item.getAllowedLocations === "function" ? item.getAllowedLocations() : void 0;

    if (allowedLocations == null) {
      return true;
    }

    container = pane.getContainer();
    location = (ref = typeof container.getLocation === "function" ? container.getLocation() : void 0) != null ? ref : 'center';
    return indexOf.call(allowedLocations, location) >= 0;
  };
}).call(void 0);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL251Y2xpZGUvbnVjbGlkZS1jb21tb25zLXVpL1ZlbmRvckxpYi9hdG9tLXRhYnMvbGliL2xheW91dC5qcyJdLCJuYW1lcyI6WyJpdGVtSXNBbGxvd2VkSW5QYW5lIiwiaW5kZXhPZiIsIml0ZW0iLCJpIiwibCIsImxlbmd0aCIsIm1vZHVsZSIsImV4cG9ydHMiLCJhY3RpdmF0ZSIsInZpZXciLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJhdG9tIiwid29ya3NwYWNlIiwiZ2V0RWxlbWVudCIsImFwcGVuZENoaWxkIiwiY2xhc3NMaXN0IiwiYWRkIiwiZGVhY3RpdmF0ZSIsInJlZiIsInBhcmVudEVsZW1lbnQiLCJyZW1vdmVDaGlsZCIsInRlc3QiLCJkcmFnIiwiZSIsImNvb3JkcyIsIml0ZW1WaWV3IiwicGFuZSIsImxhc3RDb29yZHMiLCJnZXRQYW5lQXQiLCJnZXRJdGVtVmlld0F0IiwidGFyZ2V0IiwiaXNPbmx5VGFiSW5QYW5lIiwiZ2V0SXRlbXMiLCJjbGllbnRYIiwiY2xpZW50WSIsImxhc3RTcGxpdCIsInVwZGF0ZVZpZXciLCJkaXNhYmxlVmlldyIsImVuZCIsImZyb21QYW5lIiwidGFiIiwidG9QYW5lIiwic3BsaXRMZWZ0Iiwic3BsaXRSaWdodCIsInNwbGl0VXAiLCJzcGxpdERvd24iLCJjYWxsIiwibW92ZUl0ZW1Ub1BhbmUiLCJhY3RpdmF0ZUl0ZW0iLCJhcmciLCJzZWxlY3RvciIsImVsZW1lbnRGcm9tUG9pbnQiLCJjbG9zZXN0IiwiZ2V0TW9kZWwiLCJub3JtYWxpemVDb29yZHMiLCJhcmcxIiwiaGVpZ2h0IiwibGVmdCIsInRvcCIsIndpZHRoIiwieCIsInkiLCJzcGxpdFR5cGUiLCJib3VuZHNGb3JTcGxpdCIsInNwbGl0IiwiaCIsInciLCJpbm5lckJvdW5kcyIsInVwZGF0ZVZpZXdCb3VuZHMiLCJzdHlsZSIsInJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJyZW1vdmUiLCJhbGxvd2VkTG9jYXRpb25zIiwiY29udGFpbmVyIiwibG9jYXRpb24iLCJnZXRBbGxvd2VkTG9jYXRpb25zIiwiZ2V0Q29udGFpbmVyIiwiZ2V0TG9jYXRpb24iXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQSxDQUFDLFlBQVc7QUFDVixNQUFJQSxtQkFBSjtBQUFBLE1BQ0VDLE9BQU8sR0FBRyxHQUFHQSxPQUFILElBQWMsVUFBU0MsSUFBVCxFQUFlO0FBQUUsU0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBUixFQUFXQyxDQUFDLEdBQUcsS0FBS0MsTUFBekIsRUFBaUNGLENBQUMsR0FBR0MsQ0FBckMsRUFBd0NELENBQUMsRUFBekMsRUFBNkM7QUFBRSxVQUFJQSxDQUFDLElBQUksSUFBTCxJQUFhLEtBQUtBLENBQUwsTUFBWUQsSUFBN0IsRUFBbUMsT0FBT0MsQ0FBUDtBQUFXOztBQUFDLFdBQU8sQ0FBQyxDQUFSO0FBQVksR0FEcko7O0FBR0FHLEVBQUFBLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQjtBQUNmQyxJQUFBQSxRQUFRLEVBQUUsWUFBVztBQUNuQixXQUFLQyxJQUFMLEdBQVlDLFFBQVEsQ0FBQ0MsYUFBVCxDQUF1QixLQUF2QixDQUFaO0FBQ0FDLE1BQUFBLElBQUksQ0FBQ0MsU0FBTCxDQUFlQyxVQUFmLEdBQTRCQyxXQUE1QixDQUF3QyxLQUFLTixJQUE3QztBQUNBLGFBQU8sS0FBS0EsSUFBTCxDQUFVTyxTQUFWLENBQW9CQyxHQUFwQixDQUF3QixxQkFBeEIsQ0FBUDtBQUNELEtBTGM7QUFNZkMsSUFBQUEsVUFBVSxFQUFFLFlBQVc7QUFDckIsVUFBSUMsR0FBSjtBQUNBLGFBQU8sQ0FBQ0EsR0FBRyxHQUFHLEtBQUtWLElBQUwsQ0FBVVcsYUFBakIsS0FBbUMsSUFBbkMsR0FBMENELEdBQUcsQ0FBQ0UsV0FBSixDQUFnQixLQUFLWixJQUFyQixDQUExQyxHQUF1RSxLQUFLLENBQW5GO0FBQ0QsS0FUYztBQVVmYSxJQUFBQSxJQUFJLEVBQUUsRUFWUztBQVdmQyxJQUFBQSxJQUFJLEVBQUUsVUFBU0Ms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LGFBQU8sSUFBUDtBQUNEOztBQUNEQyxJQUFBQSxTQUFTLEdBQUdoRCxJQUFJLENBQUNtRCxZQUFMLEVBQVo7QUFDQUYsSUFBQUEsUUFBUSxHQUFHLENBQUN6RCxHQUFHLEdBQUcsT0FBT3dELFNBQVMsQ0FBQ0ksV0FBakIsS0FBaUMsVUFBakMsR0FBOENKLFNBQVMsQ0FBQ0ksV0FBVixFQUE5QyxHQUF3RSxLQUFLLENBQXBGLEtBQTBGLElBQTFGLEdBQWlHNUQsR0FBakcsR0FBdUcsUUFBbEg7QUFDQSxXQUFPbEIsT0FBTyxDQUFDOEMsSUFBUixDQUFhMkIsZ0JBQWIsRUFBK0JFLFFBQS9CLEtBQTRDLENBQW5EO0FBQ0QsR0FURDtBQVdELENBdktELEVBdUtHN0IsSUF2S0giLCJzb3VyY2VzQ29udGVudCI6WyIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuMTIuMlxyXG4oZnVuY3Rpb24oKSB7XHJcbiAgdmFyIGl0ZW1Jc0FsbG93ZWRJblBhbmUsXHJcbiAgICBpbmRleE9mID0gW10uaW5kZXhPZiB8fCBmdW5jdGlvbihpdGVtKSB7IGZvciAodmFyIGkgPSAwLCBsID0gdGhpcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsgaWYgKGkgaW4gdGhpcyAmJiB0aGlzW2ldID09PSBpdGVtKSByZXR1cm4gaTsgfSByZXR1cm4gLTE7IH07XHJcblxyXG4gIG1vZHVsZS5leHBvcnRzID0ge1xyXG4gICAgYWN0aXZhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICB0aGlzLnZpZXcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgYXRvbS53b3Jrc3BhY2UuZ2V0RWxlbWVudCgpLmFwcGVuZENoaWxkKHRoaXMudmlldyk7XHJcbiAgICAgIHJldHVybiB0aGlzLnZpZXcuY2xhc3NMaXN0LmFkZCgndGFicy1sYXlvdXQtb3ZlcmxheScpO1xyXG4gICAgfSxcclxuICAgIGRlYWN0aXZhdGU6IGZ1bmN0aW9uKCkge1xyXG4gICAgICB2YXIgcmVmO1xyXG4gICAgICByZXR1cm4gKHJlZiA9IHRoaXMudmlldy5wYXJlbnRFbGVtZW50KSAhPSBudWxsID8gcmVmLnJlbW92ZUNoaWxkKHRoaXMudmlldykgOiB2b2lkIDA7XHJcbiAgICB9LFxyXG4gICAgdGVzdDoge30sXHJcbiAgICBkcmFnOiBmdW5jdGlvbihlKSB7XHJcbiAgICAgIHZhciBjb29yZHMsIGl0ZW0sIGl0ZW1WaWV3LCBwYW5lO1xyXG4gICAgICB0aGlzLmxhc3RDb29yZHMgPSBlO1xyXG4gICAgICBwYW5lID0gdGhpcy5nZXRQYW5lQXQoZSk7XHJcbiAgICAgIGl0ZW1WaWV3ID0gdGhpcy5nZXRJdGVtVmlld0F0KGUpO1xyXG4gICAgICBpdGVtID0gZS50YXJnZXQuaXRlbTtcclxuICAgICAgaWYgKChwYW5lICE9IG51bGwpICYmIChpdGVtVmlldyAhPSBudWxsKSAmJiBpdGVtICYmIGl0ZW1Jc0FsbG93ZWRJblBhbmUoaXRlbSwgcGFuZSkpIHtcclxuICAgICAgICBjb29yZHMgPSAhKHRoaXMuaXNPbmx5VGFiSW5QYW5lKHBhbmUsIGUudGFyZ2V0KSB8fCBwYW5lLmdldEl0ZW1zKCkubGVuZ3RoID09PSAwKSA/IFtlLmNsaWVudFgsIGUuY2xpZW50WV0gOiB2b2lkIDA7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubGFzdFNwbGl0ID0gdGhpcy51cGRhdGVWaWV3KGl0ZW1WaWV3LCBjb29yZHMpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRpc2FibGVWaWV3KCk7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICBlbmQ6IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgdmFyIGZyb21QYW5lLCBpdGVtLCB0YWIsIHRhcmdldCwgdG9QYW5lO1xyXG4gICAgICB0aGlzLmRpc2FibGVWaWV3KCk7XHJcbiAgICAgIGlmICghKCh0aGlzLmxhc3RDb29yZHMgIT0gbnVsbCkgJiYgdGhpcy5nZXRJdGVtVmlld0F0KHRoaXMubGFzdENvb3JkcykpKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHRhcmdldCA9IHRoaXMuZ2V0UGFuZUF0KHRoaXMubGFzdENvb3Jkcyk7XHJcbiAgICAgIGlmICh0YXJnZXQgPT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB0YWIgPSBlLnRhcmdldDtcclxuICAgICAgZnJvbVBhbmUgPSB0YWIucGFuZTtcclxuICAgICAgaXRlbSA9IHRhYi5pdGVtO1xyXG4gICAgICBpZiAoIWl0ZW1Jc0FsbG93ZWRJblBhbmUoaXRlbSwgdHlwZW9mIHRvUGFuZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0b1BhbmUgIT09IG51bGwgPyB0b1BhbmUgOiB0YXJnZXQpKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHRvUGFuZSA9IChmdW5jdGlvbigpIHtcclxuICAgICAgICBzd2l0Y2ggKHRoaXMubGFzdFNwbGl0KSB7XHJcbiAgICAgICAgICBjYXNlICdsZWZ0JzpcclxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5zcGxpdExlZnQoKTtcclxuICAgICAgICAgIGNhc2UgJ3JpZ2h0JzpcclxuICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5zcGxpdFJpZ2h0KCk7XHJcbiAgICAgICAgICBjYXNlICd1cCc6XHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQuc3BsaXRVcCgpO1xyXG4gICAgICAgICAgY2FzZSAnZG93bic6XHJcbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQuc3BsaXREb3duKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KS5jYWxsKHRoaXMpO1xyXG4gICAgICBpZiAodG9QYW5lID09IG51bGwpIHtcclxuICAgICAgICB0b1BhbmUgPSB0YXJnZXQ7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRvUGFuZSA9PT0gZnJvbVBhbmUpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgZnJvbVBhbmUubW92ZUl0ZW1Ub1BhbmUoaXRlbSwgdG9QYW5lKTtcclxuICAgICAgdG9QYW5lLmFjdGl2YXRlSXRlbShpdGVtKTtcclxuICAgICAgcmV0dXJuIHRvUGFuZS5hY3RpdmF0ZSgpO1xyXG4gICAgfSxcclxuICAgIGdldEVsZW1lbnQ6IGZ1bmN0aW9uKGFyZywgc2VsZWN0b3IpIHtcclxuICAgICAgdmFyIGNsaWVudFgsIGNsaWVudFk7XHJcbiAgICAgIGNsaWVudFggPSBhcmcuY2xpZW50WCwgY2xpZW50WSA9IGFyZy5jbGllbnRZO1xyXG4gICAgICBpZiAoc2VsZWN0b3IgPT0gbnVsbCkge1xyXG4gICAgICAgIHNlbGVjdG9yID0gJyonO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KGNsaWVudFgsIGNsaWVudFkpLmNsb3Nlc3Qoc2VsZWN0b3IpO1xyXG4gICAgfSxcclxuICAgIGdldEl0ZW1WaWV3QXQ6IGZ1bmN0aW9uKGNvb3Jkcykge1xyXG4gICAgICByZXR1cm4gdGhpcy50ZXN0Lml0ZW1WaWV3IHx8IHRoaXMuZ2V0RWxlbWVudChjb29yZHMsICcuaXRlbS12aWV3cycpO1xyXG4gICAgfSxcclxuICAgIGdldFBhbmVBdDogZnVuY3Rpb24oY29vcmRzKSB7XHJcbiAgICAgIHZhciByZWY7XHJcbiAgICAgIHJldHVybiB0aGlzLnRlc3QucGFuZSB8fCAoKHJlZiA9IHRoaXMuZ2V0RWxlbWVudCh0aGlzLmxhc3RDb29yZHMsICdhdG9tLXBhbmUnKSkgIT0gbnVsbCA/IHJlZi5nZXRNb2RlbCgpIDogdm9pZCAwKTtcclxuICAgIH0sXHJcbiAgICBpc09ubHlUYWJJblBhbmU6IGZ1bmN0aW9uKHBhbmUsIHRhYikge1xyXG4gICAgICByZXR1cm4gcGFuZS5nZXRJdGVtcygpLmxlbmd0aCA9PT0gMSAmJiBwYW5lID09PSB0YWIucGFuZTtcclxuICAgIH0sXHJcbiAgICBub3JtYWxpemVDb29yZHM6IGZ1bmN0aW9uKGFyZywgYXJnMSkge1xyXG4gICAgICB2YXIgaGVpZ2h0LCBsZWZ0LCB0b3AsIHdpZHRoLCB4LCB5O1xyXG4gICAgICBsZWZ0ID0gYXJnLmxlZnQsIHRvcCA9IGFyZy50b3AsIHdpZHRoID0gYXJnLndpZHRoLCBoZWlnaHQgPSBhcmcuaGVpZ2h0O1xyXG4gICAgICB4ID0gYXJnMVswXSwgeSA9IGFyZzFbMV07XHJcbiAgICAgIHJldHVybiBbKHggLSBsZWZ0KSAvIHdpZHRoLCAoeSAtIHRvcCkgLyBoZWlnaHRdO1xyXG4gICAgfSxcclxuICAgIHNwbGl0VHlwZTogZnVuY3Rpb24oYXJnKSB7XHJcbiAgICAgIHZhciB4LCB5O1xyXG4gICAgICB4ID0gYXJnWzBdLCB5ID0gYXJnWzFdO1xyXG4gICAgICBpZiAoeCA8IDEgLyAzKSB7XHJcbiAgICAgICAgcmV0dXJuICdsZWZ0JztcclxuICAgICAgfSBlbHNlIGlmICh4ID4gMiAvIDMpIHtcclxuICAgICAgICByZXR1cm4gJ3JpZ2h0JztcclxuICAgICAgfSBlbHNlIGlmICh5IDwgMSAvIDMpIHtcclxuICAgICAgICByZXR1cm4gJ3VwJztcclxuICAgICAgfSBlbHNlIGlmICh5ID4gMiAvIDMpIHtcclxuICAgICAgICByZXR1cm4gJ2Rvd24nO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgYm91bmRzRm9yU3BsaXQ6IGZ1bmN0aW9uKHNwbGl0KSB7XHJcbiAgICAgIHZhciBoLCByZWYsIHcsIHgsIHk7XHJcbiAgICAgIHJldHVybiByZWYgPSAoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgc3dpdGNoIChzcGxpdCkge1xyXG4gICAgICAgICAgY2FzZSAnbGVmdCc6XHJcbiAgICAgICAgICAgIHJldHVybiBbMCwgMCwgMC41LCAxXTtcclxuICAgICAgICAgIGNhc2UgJ3JpZ2h0JzpcclxuICAgICAgICAgICAgcmV0dXJuIFswLjUsIDAsIDAuNSwgMV07XHJcbiAgICAgICAgICBjYXNlICd1cCc6XHJcbiAgICAgICAgICAgIHJldHVybiBbMCwgMCwgMSwgMC41XTtcclxuICAgICAgICAgIGNhc2UgJ2Rvd24nOlxyXG4gICAgICAgICAgICByZXR1cm4gWzAsIDAuNSwgMSwgMC41XTtcclxuICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJldHVybiBbMCwgMCwgMSwgMV07XHJcbiAgICAgICAgfVxyXG4gICAgICB9KSgpLCB4ID0gcmVmWzBdLCB5ID0gcmVmWzFdLCB3ID0gcmVmWzJdLCBoID0gcmVmWzNdLCByZWY7XHJcbiAgICB9LFxyXG4gICAgaW5uZXJCb3VuZHM6IGZ1bmN0aW9uKGFyZywgYXJnMSkge1xyXG4gICAgICB2YXIgaCwgaGVpZ2h0LCBsZWZ0LCB0b3AsIHcsIHdpZHRoLCB4LCB5O1xyXG4gICAgICBsZWZ0ID0gYXJnLmxlZnQsIHRvcCA9IGFyZy50b3AsIHdpZHRoID0gYXJnLndpZHRoLCBoZWlnaHQgPSBhcmcuaGVpZ2h0O1xyXG4gICAgICB4ID0gYXJnMVswXSwgeSA9IGFyZzFbMV0sIHcgPSBhcmcxWzJdLCBoID0gYXJnMVszXTtcclxuICAgICAgbGVmdCArPSB4ICogd2lkdGg7XHJcbiAgICAgIHRvcCArPSB5ICogaGVpZ2h0O1xyXG4gICAgICB3aWR0aCAqPSB3O1xyXG4gICAgICBoZWlnaHQgKj0gaDtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBsZWZ0OiBsZWZ0LFxyXG4gICAgICAgIHRvcDogdG9wLFxyXG4gICAgICAgIHdpZHRoOiB3aWR0aCxcclxuICAgICAgICBoZWlnaHQ6IGhlaWdodFxyXG4gICAgICB9O1xyXG4gICAgfSxcclxuICAgIHVwZGF0ZVZpZXdCb3VuZHM6IGZ1bmN0aW9uKGFyZykge1xyXG4gICAgICB2YXIgaGVpZ2h0LCBsZWZ0LCB0b3AsIHdpZHRoO1xyXG4gICAgICBsZWZ0ID0gYXJnLmxlZnQsIHRvcCA9IGFyZy50b3AsIHdpZHRoID0gYXJnLndpZHRoLCBoZWlnaHQgPSBhcmcuaGVpZ2h0O1xyXG4gICAgICB0aGlzLnZpZXcuc3R5bGUubGVmdCA9IGxlZnQgKyBcInB4XCI7XHJcbiAgICAgIHRoaXMudmlldy5zdHlsZS50b3AgPSB0b3AgKyBcInB4XCI7XHJcbiAgICAgIHRoaXMudmlldy5zdHlsZS53aWR0aCA9IHdpZHRoICsgXCJweFwiO1xyXG4gICAgICByZXR1cm4gdGhpcy52aWV3LnN0eWxlLmhlaWdodCA9IGhlaWdodCArIFwicHhcIjtcclxuICAgIH0sXHJcbiAgICB1cGRhdGVWaWV3OiBmdW5jdGlvbihwYW5lLCBjb29yZHMpIHtcclxuICAgICAgdmFyIHJlY3QsIHNwbGl0O1xyXG4gICAgICB0aGlzLnZpZXcuY2xhc3NMaXN0LmFkZCgndmlzaWJsZScpO1xyXG4gICAgICByZWN0ID0gdGhpcy50ZXN0LnJlY3QgfHwgcGFuZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcclxuICAgICAgc3BsaXQgPSBjb29yZHMgPyB0aGlzLnNwbGl0VHlwZSh0aGlzLm5vcm1hbGl6ZUNvb3JkcyhyZWN0LCBjb29yZHMpKSA6IHZvaWQgMDtcclxuICAgICAgdGhpcy51cGRhdGVWaWV3Qm91bmRzKHRoaXMuaW5uZXJCb3VuZHMocmVjdCwgdGhpcy5ib3VuZHNGb3JTcGxpdChzcGxpdCkpKTtcclxuICAgICAgcmV0dXJuIHNwbGl0O1xyXG4gICAgfSxcclxuICAgIGRpc2FibGVWaWV3OiBmdW5jdGlvbigpIHtcclxuICAgICAgcmV0dXJuIHRoaXMudmlldy5jbGFzc0xpc3QucmVtb3ZlKCd2aXNpYmxlJyk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgaXRlbUlzQWxsb3dlZEluUGFuZSA9IGZ1bmN0aW9uKGl0ZW0sIHBhbmUpIHtcclxuICAgIHZhciBhbGxvd2VkTG9jYXRpb25zLCBjb250YWluZXIsIGxvY2F0aW9uLCByZWY7XHJcbiAgICBhbGxvd2VkTG9jYXRpb25zID0gdHlwZW9mIGl0ZW0uZ2V0QWxsb3dlZExvY2F0aW9ucyA9PT0gXCJmdW5jdGlvblwiID8gaXRlbS5nZXRBbGxvd2VkTG9jYXRpb25zKCkgOiB2b2lkIDA7XHJcbiAgICBpZiAoYWxsb3dlZExvY2F0aW9ucyA9PSBudWxsKSB7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgY29udGFpbmVyID0gcGFuZS5nZXRDb250YWluZXIoKTtcclxuICAgIGxvY2F0aW9uID0gKHJlZiA9IHR5cGVvZiBjb250YWluZXIuZ2V0TG9jYXRpb24gPT09IFwiZnVuY3Rpb25cIiA/IGNvbnRhaW5lci5nZXRMb2NhdGlvbigpIDogdm9pZCAwKSAhPSBudWxsID8gcmVmIDogJ2NlbnRlcic7XHJcbiAgICByZXR1cm4gaW5kZXhPZi5jYWxsKGFsbG93ZWRMb2NhdGlvbnMsIGxvY2F0aW9uKSA+PSAwO1xyXG4gIH07XHJcblxyXG59KS5jYWxsKHRoaXMpO1xyXG4iXX0=