'use babel';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _fileIcons = _interopRequireDefault(require("./file-icons"));

var _path = _interopRequireDefault(require("path"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

class MRUItemView {
  initialize(listView, item) {
    this.listView = listView;
    this.item = item;
    this.element = document.createElement('li');
    this.element.itemViewData = this;
    this.element.classList.add('two-lines');
    let itemPath = null;

    if (item.getPath && typeof item.getPath === 'function') {
      itemPath = item.getPath();
    }

    const repo = MRUItemView.repositoryForPath(itemPath);

    if (repo != null) {
      const statusIconDiv = document.createElement('div');
      const status = repo.getCachedPathStatus(itemPath);

      if (repo.isStatusNew(status)) {
        statusIconDiv.className = 'status status-added icon icon-diff-added';
        this.element.appendChild(statusIconDiv);
      } else if (repo.isStatusModified(status)) {
        statusIconDiv.className = 'status status-modified icon icon-diff-modified';
        this.element.appendChild(statusIconDiv);
      }
    }

    const firstLineDiv = this.element.appendChild(document.createElement('div'));
    firstLineDiv.classList.add('primary-line', 'file');

    if (typeof item.getIconName === 'function') {
      if (atom.config.get('tabs.showIcons')) firstLineDiv.classList.add('icon', 'icon-' + item.getIconName());
    } else {
      let typeClasses = _fileIcons.default.getService().iconClassForPath(itemPath, 'tabs-mru-switcher');

      if (typeClasses) {
        if (!Array.isArray(typeClasses)) typeClasses = typeClasses.split(/\s+/g);
        if (typeClasses) firstLineDiv.classList.add('icon', ...typeClasses);
      }
    }

    firstLineDiv.setAttribute('data-name', item.getTitle());
    firstLineDiv.innerText = item.getTitle();

    if (itemPath) {
      firstLineDiv.setAttribute('data-path', itemPath);
      const secondLineDiv = this.element.appendChild(document.createElement('div'));
      secondLineDiv.classList.add('secondary-line', 'path', 'no-icon');
      secondLineDiv.innerText = itemPath;
    }
  }

  select() {
    this.element.classList.add('selected');
  }

  unselect() {
    this.element.classList.remove('selected');
  }

  static repositoryForPath(filePath) {
    if (filePath) {
      const projectPaths = atom.project.getPaths();

      for (let i = 0; i < projectPaths.length; i++) {
        if (filePath === projectPaths[i] || filePath.startsWith(projectPaths[i] + _path.default.sep)) {
          return atom.project.getRepositories()[i];
        }
      }
    }

    return null;
  }

}

exports.default = MRUItemView;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL251Y2xpZGUvbnVjbGlkZS1jb21tb25zLXVpL1ZlbmRvckxpYi9hdG9tLXRhYnMvbGliL21ydS1pdGVtLXZpZXcuanMiXSwibmFtZXMiOlsiTVJVSXRlbVZpZXciLCJpbml0aWFsaXplIiwibGlzdFZpZXciLCJpdGVtIiwiZWxlbWVudCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsIml0ZW1WaWV3RGF0YSIsImNsYXNzTGlzdCIsImFkZCIsIml0ZW1QYXRoIiwiZ2V0UGF0aCIsInJlcG8iLCJyZXBvc2l0b3J5Rm9yUGF0aCIsInN0YXR1c0ljb25EaXYiLCJzdGF0dXMiLCJnZXRDYWNoZWRQYXRoU3RhdHVzIiwiaXNTdGF0dXNOZXciLCJjbGFzc05hbWUiLCJhcHBlbmRDaGlsZCIsImlzU3RhdHVzTW9kaWZpZWQiLCJmaXJzdExpbmVEaXYiLCJnZXRJY29uTmFtZSIsImF0b20iLCJjb25maWciLCJnZXQiLCJ0eXBlQ2xhc3NlcyIsIkZpbGVJY29ucyIsImdldFNlcnZpY2UiLCJpY29uQ2xhc3NGb3JQYXRoIiwiQXJyYXkiLCJpc0FycmF5Iiwic3BsaXQiLCJzZXRBdHRyaWJ1dGUiLCJnZXRUaXRsZSIsImlubmVyVGV4dCIsInNlY29uZExpbmVEaXYiLCJzZWxlY3QiLCJ1bnNlbGVjdCIsInJlbW92ZSIsImZpbGVQYXRoIiwicHJvamVjdFBhdGhzIiwicHJvamVjdCIsImdldFBhdGhzIiwiaSIsImxlbmd0aCIsInN0YXJ0c1dpdGgiLCJwYXRoIiwic2VwIiwiZ2V0UmVwb3NpdG9yaWVzIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7OztBQUVBOztBQUNBOzs7O0FBRWUsTUFBTUEsV0FBTixDQUFrQjtBQUMvQkMsRUFBQUEsVUFBVSxDQUFFQyxRQUFGLEVBQVlDLElBQVosRUFBa0I7QUFDMUIsU0FBS0QsUUFBTCxHQUFnQkEsUUFBaEI7QUFDQSxTQUFLQyxJQUFMLEdBQVlBLElBQVo7QUFFQSxTQUFLQyxPQUFMLEdBQWVDLFFBQVEs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U0FBdEQ7QUFDQTJCLE1BQUFBLGFBQWEsQ0FBQ0QsU0FBZCxHQUEwQnpCLFFBQTFCO0FBQ0Q7QUFDRjs7QUFFRDJCLEVBQUFBLE1BQU0sR0FBSTtBQUNSLFNBQUtqQyxPQUFMLENBQWFJLFNBQWIsQ0FBdUJDLEdBQXZCLENBQTJCLFVBQTNCO0FBQ0Q7O0FBRUQ2QixFQUFBQSxRQUFRLEdBQUk7QUFDVixTQUFLbEMsT0FBTCxDQUFhSSxTQUFiLENBQXVCK0IsTUFBdkIsQ0FBOEIsVUFBOUI7QUFDRDs7QUFFdUIsU0FBakIxQixpQkFBaUIsQ0FBRTJCLFFBQUYsRUFBWTtBQUNsQyxRQUFJQSxRQUFKLEVBQWM7QUFDWixZQUFNQyxZQUFZLEdBQUdsQixJQUFJLENBQUNtQixPQUFMLENBQWFDLFFBQWIsRUFBckI7O0FBQ0EsV0FBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHSCxZQUFZLENBQUNJLE1BQWpDLEVBQXlDRCxDQUFDLEVBQTFDLEVBQThDO0FBQzVDLFlBQUlKLFFBQVEsS0FBS0MsWUFBWSxDQUFDRyxDQUFELENBQXpCLElBQWdDSixRQUFRLENBQUNNLFVBQVQsQ0FBb0JMLFlBQVksQ0FBQ0csQ0FBRCxDQUFaLEdBQWtCRyxjQUFLQyxHQUEzQyxDQUFwQyxFQUFxRjtBQUNuRixpQkFBT3pCLElBQUksQ0FBQ21CLE9BQUwsQ0FBYU8sZUFBYixHQUErQkwsQ0FBL0IsQ0FBUDtBQUNEO0FBQ0Y7QUFDRjs7QUFDRCxXQUFPLElBQVA7QUFDRDs7QUFuRThCIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCdcclxuXHJcbmltcG9ydCBGaWxlSWNvbnMgZnJvbSAnLi9maWxlLWljb25zJ1xyXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTVJVSXRlbVZpZXcge1xyXG4gIGluaXRpYWxpemUgKGxpc3RWaWV3LCBpdGVtKSB7XHJcbiAgICB0aGlzLmxpc3RWaWV3ID0gbGlzdFZpZXdcclxuICAgIHRoaXMuaXRlbSA9IGl0ZW1cclxuXHJcbiAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpXHJcbiAgICB0aGlzLmVsZW1lbnQuaXRlbVZpZXdEYXRhID0gdGhpc1xyXG4gICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3R3by1saW5lcycpXHJcblxyXG4gICAgbGV0IGl0ZW1QYXRoID0gbnVsbFxyXG4gICAgaWYgKGl0ZW0uZ2V0UGF0aCAmJiB0eXBlb2YgaXRlbS5nZXRQYXRoID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgIGl0ZW1QYXRoID0gaXRlbS5nZXRQYXRoKClcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCByZXBvID0gTVJVSXRlbVZpZXcucmVwb3NpdG9yeUZvclBhdGgoaXRlbVBhdGgpXHJcbiAgICBpZiAocmVwbyAhPSBudWxsKSB7XHJcbiAgICAgIGNvbnN0IHN0YXR1c0ljb25EaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxyXG4gICAgICBjb25zdCBzdGF0dXMgPSByZXBvLmdldENhY2hlZFBhdGhTdGF0dXMoaXRlbVBhdGgpXHJcbiAgICAgIGlmIChyZXBvLmlzU3RhdHVzTmV3KHN0YXR1cykpIHtcclxuICAgICAgICBzdGF0dXNJY29uRGl2LmNsYXNzTmFtZSA9ICdzdGF0dXMgc3RhdHVzLWFkZGVkIGljb24gaWNvbi1kaWZmLWFkZGVkJ1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChzdGF0dXNJY29uRGl2KVxyXG4gICAgICB9IGVsc2UgaWYgKHJlcG8uaXNTdGF0dXNNb2RpZmllZChzdGF0dXMpKSB7XHJcbiAgICAgICAgc3RhdHVzSWNvbkRpdi5jbGFzc05hbWUgPSAnc3RhdHVzIHN0YXR1cy1tb2RpZmllZCBpY29uIGljb24tZGlmZi1tb2RpZmllZCdcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYXBwZW5kQ2hpbGQoc3RhdHVzSWNvbkRpdilcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGZpcnN0TGluZURpdiA9IHRoaXMuZWxlbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSlcclxuICAgIGZpcnN0TGluZURpdi5jbGFzc0xpc3QuYWRkKCdwcmltYXJ5LWxpbmUnLCAnZmlsZScpXHJcbiAgICBpZiAodHlwZW9mIGl0ZW0uZ2V0SWNvbk5hbWUgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgaWYgKGF0b20uY29uZmlnLmdldCgndGFicy5zaG93SWNvbnMnKSkgZmlyc3RMaW5lRGl2LmNsYXNzTGlzdC5hZGQoJ2ljb24nLCAnaWNvbi0nICsgaXRlbS5nZXRJY29uTmFtZSgpKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbGV0IHR5cGVDbGFzc2VzID0gRmlsZUljb25zLmdldFNlcnZpY2UoKS5pY29uQ2xhc3NGb3JQYXRoKGl0ZW1QYXRoLCAndGFicy1tcnUtc3dpdGNoZXInKVxyXG4gICAgICBpZiAodHlwZUNsYXNzZXMpIHtcclxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodHlwZUNsYXNzZXMpKSB0eXBlQ2xhc3NlcyA9IHR5cGVDbGFzc2VzLnNwbGl0KC9cXHMrL2cpXHJcbiAgICAgICAgaWYgKHR5cGVDbGFzc2VzKSBmaXJzdExpbmVEaXYuY2xhc3NMaXN0LmFkZCgnaWNvbicsIC4uLnR5cGVDbGFzc2VzKVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBmaXJzdExpbmVEaXYuc2V0QXR0cmlidXRlKCdkYXRhLW5hbWUnLCBpdGVtLmdldFRpdGxlKCkpXHJcbiAgICBmaXJzdExpbmVEaXYuaW5uZXJUZXh0ID0gaXRlbS5nZXRUaXRsZSgpXHJcblxyXG4gICAgaWYgKGl0ZW1QYXRoKSB7XHJcbiAgICAgIGZpcnN0TGluZURpdi5zZXRBdHRyaWJ1dGUoJ2RhdGEtcGF0aCcsIGl0ZW1QYXRoKVxyXG4gICAgICBjb25zdCBzZWNvbmRMaW5lRGl2ID0gdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpKVxyXG4gICAgICBzZWNvbmRMaW5lRGl2LmNsYXNzTGlzdC5hZGQoJ3NlY29uZGFyeS1saW5lJywgJ3BhdGgnLCAnbm8taWNvbicpXHJcbiAgICAgIHNlY29uZExpbmVEaXYuaW5uZXJUZXh0ID0gaXRlbVBhdGhcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNlbGVjdCAoKSB7XHJcbiAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKVxyXG4gIH1cclxuXHJcbiAgdW5zZWxlY3QgKCkge1xyXG4gICAgdGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJylcclxuICB9XHJcblxyXG4gIHN0YXRpYyByZXBvc2l0b3J5Rm9yUGF0aCAoZmlsZVBhdGgpIHtcclxuICAgIGlmIChmaWxlUGF0aCkge1xyXG4gICAgICBjb25zdCBwcm9qZWN0UGF0aHMgPSBhdG9tLnByb2plY3QuZ2V0UGF0aHMoKVxyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb2plY3RQYXRocy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGlmIChmaWxlUGF0aCA9PT0gcHJvamVjdFBhdGhzW2ldIHx8IGZpbGVQYXRoLnN0YXJ0c1dpdGgocHJvamVjdFBhdGhzW2ldICsgcGF0aC5zZXApKSB7XHJcbiAgICAgICAgICByZXR1cm4gYXRvbS5wcm9qZWN0LmdldFJlcG9zaXRvcmllcygpW2ldXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbFxyXG4gIH1cclxufVxyXG4iXX0=