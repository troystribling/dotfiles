"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.highlightOnUpdate = highlightOnUpdate;

var React = _interopRequireWildcard(require("react"));

var _shallowequal = _interopRequireDefault(require("shallowequal"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

/**
 * Copyright (c) 2017-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * 
 * @format
 */

/**
 * Wraps DecoratedComponent in a special `span` with a configurable classname whenever the
 * component's props change.
 */
function highlightOnUpdate(ComposedComponent,
/**
 * The result of this function determines whether to apply the highlight or not.
 */
arePropsEqual = _shallowequal.default,
/**
 * className used in the wrapper. You can style both `className` and `<className>-highlight`.
 */
className = 'nuclide-ui-highlight-on-render',
/**
 * Delay in ms until the `*-highlight` className gets removed from the wrapper.
 * Effectively throttles the frequency of highlight pulses.
 */
unhighlightDelay = 200) {
  var _temp;

  // $FlowIssue The return type is guaranteed to be the same as the type of ComposedComponent.
  return _temp = class extends React.Component {
    constructor(props) {
      super(props);
      this.showFlash = void 0;
      this.timeout = void 0;
      this.showFlash = false;
    }

    UNSAFE_componentWillUpdate(nextProps, nextState) {
      if (arePropsEqual(nextProps, this.props)) {
        // Skip if prop values didn't actually change.
        return;
      }

      if (this.timeout != null || this.showFlash) {
        // Skip if already scheduled.
        return;
      }

      this.showFlash = true;
      this.timeout = setTimeout(() => {
        this.showFlash = false;
        this.timeout = null;
        this.forceUpdate();
      }, unhighlightDelay);
    }

    render() {
      return /*#__PURE__*/React.createElement("span", {
        className: `${className} ${this.showFlash ? className + '-highlight' : ''}`
      }, /*#__PURE__*/React.createElement(ComposedComponent, this.props));
    }

  }, _temp;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL251Y2xpZGUvbnVjbGlkZS1jb21tb25zLXVpL2hpZ2hsaWdodE9uVXBkYXRlLmpzIl0sIm5hbWVzIjpbImhpZ2hsaWdodE9uVXBkYXRlIiwiQ29tcG9zZWRDb21wb25lbnQiLCJhcmVQcm9wc0VxdWFsIiwic2hhbGxvd2VxdWFsIiwiY2xhc3NOYW1lIiwidW5oaWdobGlnaHREZWxheSIsIlJlYWN0IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsInNob3dGbGFzaCIsInRpbWVvdXQiLCJVTlNBRkVfY29tcG9uZW50V2lsbFVwZGF0ZSIsIm5leHRQcm9wcyIsIm5leHRTdGF0ZSIsInNldFRpbWVvdXQiLCJmb3JjZVVwZGF0ZSIsInJlbmRlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQVlBOztBQUNBOzs7Ozs7OztBQWJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDTyxTQUFTQSxpQkFBVCxDQUlMQyxpQkFKSztBQUtMO0FBQ0Y7QUFDQTtBQUNFQyxhQUF5QyxHQUFHQyxxQkFSdkM7QUFTTDtBQUNGO0FBQ0E7QUFDRUMsU0FBa0IsR0FBRyxnQ0FaaEI7QUFhTDtBQUNGO0FBQ0E7QUFDQTtBQUNFQyxnQkFBeUIsR0FBRyxHQWpCdkIsRUFrQkY7QUFBQTs7QUFDSDtBQUNBLGlCQUFPLGNBQWNDLEtBQUssQ0FBQ0MsU0FBcEIsQ0FBdUM7QUFJNUNDLElBQUFBLFdBQVcsQ0FBQ0MsS0FBRCxFQUFXO0FBQ3BCLFlBQU1BLEtBQU47QUFEb0IsV0FIdEJDLFNBR3NCO0FBQUEsV0FGdEJDLE9BRXNCO0FBRXBCLFdBQUtELFNBQUwsR0FBaUIsS0FBakI7QUFDRDs7QUFFREUsSUFBQUEsMEJBQTBCLENBQUNDLFNBQUQsRUFBZUMsU0FBZixFQUFzQztBQUM5RCxVQUFJWixhQUFhLENBQUNXLFNBQUQsRUFBWSxLQUFLSixLQUFqQixDQUFqQixFQUEwQztBQUN4QztBQUNBO0FBQ0Q7O0FBQ0QsVUFBSSxLQUFLRSxPQUFMLElBQWdCLElBQWhCLElBQXdCLEtBQUtELFNBQWpDLEVBQTRDO0FBQzFDO0FBQ0E7QUFDRDs7QUFDRCxXQUFLQSxTQUFMLEdBQWlCLElBQWpCO0FBQ0EsV0FBS0MsT0FBTCxHQUFlSSxVQUFVLENBQUMsTUFBTTtBQUM5QixhQUFLTCxTQUFMLEdBQWlCLEtBQWpCO0FBQ0EsYUFBS0MsT0FBTCxHQUFlLElBQWY7QUFDQSxhQUFLSyxXQUFMO0FBQ0QsT0FKd0IsRUFJdEJYLGdCQUpzQixDQUF6QjtBQUtEOztBQUVEWSxJQUFBQSxNQUFNLEdBQWU7QUFDbkIsMEJBQ0U7QUFDRSxRQUFBLFNBQVMsRUFBRyxHQUFFYixTQUFVLElBQ3RCLEtBQUtNLFNBQUwsR0FBaUJOLFNBQVMsR0FBRyxZQUE3QixHQUE0QyxFQUM3QztBQUhILHNCQUlFLG9CQUFDLGlCQUFELEVBQXVCLEtBQUtLLEtBQTVCLENBSkYsQ0FERjtBQVFEOztBQW5DMkMsR0FBOUM7QUFxQ0QiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ29weXJpZ2h0IChjKSAyMDE3LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXHJcbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIEJTRC1zdHlsZSBsaWNlbnNlIGZvdW5kIGluIHRoZVxyXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuIEFuIGFkZGl0aW9uYWwgZ3JhbnRcclxuICogb2YgcGF0ZW50IHJpZ2h0cyBjYW4gYmUgZm91bmQgaW4gdGhlIFBBVEVOVFMgZmlsZSBpbiB0aGUgc2FtZSBkaXJlY3RvcnkuXHJcbiAqXHJcbiAqIEBmbG93XHJcbiAqIEBmb3JtYXRcclxuICovXHJcblxyXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCBzaGFsbG93ZXF1YWwgZnJvbSAnc2hhbGxvd2VxdWFsJztcclxuXHJcbi8qKlxyXG4gKiBXcmFwcyBEZWNvcmF0ZWRDb21wb25lbnQgaW4gYSBzcGVjaWFsIGBzcGFuYCB3aXRoIGEgY29uZmlndXJhYmxlIGNsYXNzbmFtZSB3aGVuZXZlciB0aGVcclxuICogY29tcG9uZW50J3MgcHJvcHMgY2hhbmdlLlxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGhpZ2hsaWdodE9uVXBkYXRlPFxyXG4gIFQ6IFJlYWN0LkNvbXBvbmVudFR5cGU8YW55PixcclxuICBQOiB7K1trZXk6IHN0cmluZ106IG1peGVkfSxcclxuPihcclxuICBDb21wb3NlZENvbXBvbmVudDogVCxcclxuICAvKipcclxuICAgKiBUaGUgcmVzdWx0IG9mIHRoaXMgZnVuY3Rpb24gZGV0ZXJtaW5lcyB3aGV0aGVyIHRvIGFwcGx5IHRoZSBoaWdobGlnaHQgb3Igbm90LlxyXG4gICAqL1xyXG4gIGFyZVByb3BzRXF1YWw/OiAocDE6IFAsIHAyOiBQKSA9PiBib29sZWFuID0gc2hhbGxvd2VxdWFsLFxyXG4gIC8qKlxyXG4gICAqIGNsYXNzTmFtZSB1c2VkIGluIHRoZSB3cmFwcGVyLiBZb3UgY2FuIHN0eWxlIGJvdGggYGNsYXNzTmFtZWAgYW5kIGA8Y2xhc3NOYW1lPi1oaWdobGlnaHRgLlxyXG4gICAqL1xyXG4gIGNsYXNzTmFtZT86IHN0cmluZyA9ICdudWNsaWRlLXVpLWhpZ2hsaWdodC1vbi1yZW5kZXInLFxyXG4gIC8qKlxyXG4gICAqIERlbGF5IGluIG1zIHVudGlsIHRoZSBgKi1oaWdobGlnaHRgIGNsYXNzTmFtZSBnZXRzIHJlbW92ZWQgZnJvbSB0aGUgd3JhcHBlci5cclxuICAgKiBFZmZlY3RpdmVseSB0aHJvdHRsZXMgdGhlIGZyZXF1ZW5jeSBvZiBoaWdobGlnaHQgcHVsc2VzLlxyXG4gICAqL1xyXG4gIHVuaGlnaGxpZ2h0RGVsYXk/OiBudW1iZXIgPSAyMDAsXHJcbik6IFQge1xyXG4gIC8vICRGbG93SXNzdWUgVGhlIHJldHVybiB0eXBlIGlzIGd1YXJhbnRlZWQgdG8gYmUgdGhlIHNhbWUgYXMgdGhlIHR5cGUgb2YgQ29tcG9zZWRDb21wb25lbnQuXHJcbiAgcmV0dXJuIGNsYXNzIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFAsIHZvaWQ+IHtcclxuICAgIHNob3dGbGFzaDogYm9vbGVhbjtcclxuICAgIHRpbWVvdXQ6ID9UaW1lb3V0SUQ7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJvcHM6IFApIHtcclxuICAgICAgc3VwZXIocHJvcHMpO1xyXG4gICAgICB0aGlzLnNob3dGbGFzaCA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIFVOU0FGRV9jb21wb25lbnRXaWxsVXBkYXRlKG5leHRQcm9wczogUCwgbmV4dFN0YXRlOiB2b2lkKTogdm9pZCB7XHJcbiAgICAgIGlmIChhcmVQcm9wc0VxdWFsKG5leHRQcm9wcywgdGhpcy5wcm9wcykpIHtcclxuICAgICAgICAvLyBTa2lwIGlmIHByb3AgdmFsdWVzIGRpZG4ndCBhY3R1YWxseSBjaGFuZ2UuXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLnRpbWVvdXQgIT0gbnVsbCB8fCB0aGlzLnNob3dGbGFzaCkge1xyXG4gICAgICAgIC8vIFNraXAgaWYgYWxyZWFkeSBzY2hlZHVsZWQuXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuc2hvd0ZsYXNoID0gdHJ1ZTtcclxuICAgICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5zaG93Rmxhc2ggPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnRpbWVvdXQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcclxuICAgICAgfSwgdW5oaWdobGlnaHREZWxheSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyKCk6IFJlYWN0Lk5vZGUge1xyXG4gICAgICByZXR1cm4gKFxyXG4gICAgICAgIDxzcGFuXHJcbiAgICAgICAgICBjbGFzc05hbWU9e2Ake2NsYXNzTmFtZX0gJHtcclxuICAgICAgICAgICAgdGhpcy5zaG93Rmxhc2ggPyBjbGFzc05hbWUgKyAnLWhpZ2hsaWdodCcgOiAnJ1xyXG4gICAgICAgICAgfWB9PlxyXG4gICAgICAgICAgPENvbXBvc2VkQ29tcG9uZW50IHsuLi50aGlzLnByb3BzfSAvPlxyXG4gICAgICAgIDwvc3Bhbj5cclxuICAgICAgKTtcclxuICAgIH1cclxuICB9O1xyXG59XHJcbiJdfQ==