"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.AdbDeviceSelector = void 0;

var _nuclideAdb = require("@atom-ide-community/nuclide-adb");

var React = _interopRequireWildcard(require("react"));

var _Dropdown = require("@atom-ide-community/nuclide-commons-ui/Dropdown");

var _UniversalDisposable = _interopRequireDefault(require("@atom-ide-community/nuclide-commons/UniversalDisposable"));

var _expected = require("@atom-ide-community/nuclide-commons/expected");

var _LoadingSpinner = require("@atom-ide-community/nuclide-commons-ui/LoadingSpinner");

var _assert = _interopRequireDefault(require("assert"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

/**
 * Copyright (c) 2017-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * 
 * @format
 */
const NO_DEVICES_MSG = 'No adb devices attached!';

class AdbDeviceSelector extends React.Component {
  constructor(props) {
    super(props);
    this.props = void 0;
    this.state = void 0;
    this._disposables = void 0;
    this._disposables = new _UniversalDisposable.default();
    this._handleDeviceListChange = this._handleDeviceListChange.bind(this);
    this._handleDeviceDropdownChange = this._handleDeviceDropdownChange.bind(this);
    this.state = {
      deviceList: _expected.Expect.pending(),
      selectedDevice: null
    };
  }

  componentDidMount() {
    this._disposables.add((0, _nuclideAdb.observeAndroidDevices)(this.props.targetUri).startWith(_expected.Expect.pending()).subscribe(deviceList => this._handleDeviceListChange(deviceList)));
  }

  componentWillUnmount() {
    this._disposables.dispose();
  }

  _handleDeviceListChange(deviceList) {
    const previousDevice = this.state.selectedDevice;
    let selectedDevice = previousDevice == null ? null : deviceList.getOrDefault([]).find(device => device.serial === previousDevice.serial);

    if (selectedDevice == null && deviceList.isValue) {
      selectedDevice = deviceList.value[0];
    }

    this.setState({
      deviceList,
      selectedDevice
    });
    this.props.onChange(selectedDevice);
  }

  _getDeviceItems() {
    (0, _assert.default)(this.state.deviceList.isValue);

    if (this.state.deviceList.value.length === 0) {
      return [{
        value: null,
        label: NO_DEVICES_MSG
      }];
    }

    return this.state.deviceList.value.map(device => ({
      value: device,
      label: device.displayName
    }));
  }

  render() {
    if (this.state.deviceList.isPending) {
      return /*#__PURE__*/React.createElement(_LoadingSpinner.LoadingSpinner, {
        size: "EXTRA_SMALL"
      });
    }

    if (this.state.deviceList.isError) {
      return /*#__PURE__*/React.createElement("div", {
        className: "nuclide-ui-message-error"
      }, this.state.deviceList.error.toString());
    }

    const deviceItems = this._getDeviceItems();

    return /*#__PURE__*/React.createElement(_Dropdown.Dropdown, {
      options: deviceItems,
      onChange: this._handleDeviceDropdownChange,
      value: this.state.selectedDevice
    });
  }

  _handleDeviceDropdownChange(selectedDevice) {
    this.setState({
      selectedDevice
    });
    this.props.onChange(selectedDevice);
  }

}

exports.AdbDeviceSelector = AdbDeviceSelector;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL251Y2xpZGUvbnVjbGlkZS1kZWJ1Z2dlci1jb21tb24vQWRiRGV2aWNlU2VsZWN0b3IuanMiXSwibmFtZXMiOlsiTk9fREVWSUNFU19NU0ciLCJBZGJEZXZpY2VTZWxlY3RvciIsIlJlYWN0IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsInN0YXRlIiwiX2Rpc3Bvc2FibGVzIiwiVW5pdmVyc2FsRGlzcG9zYWJsZSIsIl9oYW5kbGVEZXZpY2VMaXN0Q2hhbmdlIiwiYmluZCIsIl9oYW5kbGVEZXZpY2VEcm9wZG93bkNoYW5nZSIsImRldmljZUxpc3QiLCJFeHBlY3QiLCJwZW5kaW5nIiwic2VsZWN0ZWREZXZpY2UiLCJjb21wb25lbnREaWRNb3VudCIsImFkZCIsInRhcmdldFVyaSIsInN0YXJ0V2l0aCIsInN1YnNjcmliZSIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwiZGlzcG9zZSIsInByZXZpb3VzRGV2aWNlIiwiZ2V0T3JEZWZhdWx0IiwiZmluZCIsImRldmljZSIsInNlcmlhbCIsImlzVmFsdWUiLCJ2YWx1ZSIsInNldFN0YXRlIiwib25DaGFuZ2UiLCJfZ2V0RGV2aWNlSXRlbXMiLCJsZW5ndGgiLCJsYWJlbCIsIm1hcCIsImRpc3BsYXlOYW1lIiwicmVuZGVyIiwiaXNQZW5kaW5nIiwiaXNFcnJvciIsImVycm9yIiwidG9TdHJpbmciLCJkZXZpY2VJdGVtcyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQWlCQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7Ozs7Ozs7QUF2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWVBLE1BQU1BLGNBQWMsR0FBRywwQkFBdkI7O0FBWU8sTUFBTUMsaUJBQU4sU0FBZ0NDLEtBQUssQ0FBQ0MsU0FBdEMsQ0FBOEQ7QUFLbkVDLEVBQUFBLFdBQVcsQ0FBQ0MsS0FBRCxFQUFlO0FBQ3hCLFVBQU1BLEtBQU47QUFEd0Is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OztBQUNBLHdCQUNFLG9CQUFDLGtCQUFEO0FBQ0UsTUFBQSxPQUFPLEVBQUVVLFdBRFg7QUFFRSxNQUFBLFFBQVEsRUFBRSxLQUFLL0IsMkJBRmpCO0FBR0UsTUFBQSxLQUFLLEVBQUUsS0FBS0wsS0FBTCxDQUFXUztBQUhwQixNQURGO0FBT0Q7O0FBRURKLEVBQUFBLDJCQUEyQixDQUFDSSxjQUFELEVBQW1DO0FBQzVELFNBQUtlLFFBQUwsQ0FBYztBQUNaZixNQUFBQTtBQURZLEtBQWQ7QUFHQSxTQUFLVixLQUFMLENBQVcwQixRQUFYLENBQW9CaEIsY0FBcEI7QUFDRDs7QUE5RmtFIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENvcHlyaWdodCAoYykgMjAxNy1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxyXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKlxyXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBCU0Qtc3R5bGUgbGljZW5zZSBmb3VuZCBpbiB0aGVcclxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLiBBbiBhZGRpdGlvbmFsIGdyYW50XHJcbiAqIG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW4gdGhlIHNhbWUgZGlyZWN0b3J5LlxyXG4gKlxyXG4gKiBAZmxvd1xyXG4gKiBAZm9ybWF0XHJcbiAqL1xyXG5cclxuaW1wb3J0IHR5cGUge0FkYkRldmljZX0gZnJvbSAnQGF0b20taWRlLWNvbW11bml0eS9udWNsaWRlLWFkYi9saWIvdHlwZXMnO1xyXG5pbXBvcnQgdHlwZSB7RXhwZWN0ZWR9IGZyb20gJ0BhdG9tLWlkZS1jb21tdW5pdHkvbnVjbGlkZS1jb21tb25zL2V4cGVjdGVkJztcclxuaW1wb3J0IHR5cGUge051Y2xpZGVVcml9IGZyb20gJ0BhdG9tLWlkZS1jb21tdW5pdHkvbnVjbGlkZS1jb21tb25zL251Y2xpZGVVcmknO1xyXG5pbXBvcnQgdHlwZSB7TWVudUl0ZW19IGZyb20gJ0BhdG9tLWlkZS1jb21tdW5pdHkvbnVjbGlkZS1jb21tb25zLXVpL0Ryb3Bkb3duJztcclxuXHJcbmltcG9ydCB7b2JzZXJ2ZUFuZHJvaWREZXZpY2VzfSBmcm9tICdAYXRvbS1pZGUtY29tbXVuaXR5L251Y2xpZGUtYWRiJztcclxuaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xyXG5pbXBvcnQge0Ryb3Bkb3dufSBmcm9tICdAYXRvbS1pZGUtY29tbXVuaXR5L251Y2xpZGUtY29tbW9ucy11aS9Ecm9wZG93bic7XHJcbmltcG9ydCBVbml2ZXJzYWxEaXNwb3NhYmxlIGZyb20gJ0BhdG9tLWlkZS1jb21tdW5pdHkvbnVjbGlkZS1jb21tb25zL1VuaXZlcnNhbERpc3Bvc2FibGUnO1xyXG5pbXBvcnQge0V4cGVjdH0gZnJvbSAnQGF0b20taWRlLWNvbW11bml0eS9udWNsaWRlLWNvbW1vbnMvZXhwZWN0ZWQnO1xyXG5pbXBvcnQge0xvYWRpbmdTcGlubmVyfSBmcm9tICdAYXRvbS1pZGUtY29tbXVuaXR5L251Y2xpZGUtY29tbW9ucy11aS9Mb2FkaW5nU3Bpbm5lcic7XHJcbmltcG9ydCBpbnZhcmlhbnQgZnJvbSAnYXNzZXJ0JztcclxuXHJcbmNvbnN0IE5PX0RFVklDRVNfTVNHID0gJ05vIGFkYiBkZXZpY2VzIGF0dGFjaGVkISc7XHJcblxyXG50eXBlIFByb3BzID0ge1xyXG4gIHRhcmdldFVyaTogTnVjbGlkZVVyaSxcclxuICBvbkNoYW5nZTogKHZhbHVlOiA/QWRiRGV2aWNlKSA9PiB2b2lkLFxyXG59O1xyXG5cclxudHlwZSBTdGF0ZSA9IHtcclxuICBkZXZpY2VMaXN0OiBFeHBlY3RlZDxBcnJheTxBZGJEZXZpY2U+PixcclxuICBzZWxlY3RlZERldmljZTogP0FkYkRldmljZSxcclxufTtcclxuXHJcbmV4cG9ydCBjbGFzcyBBZGJEZXZpY2VTZWxlY3RvciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxQcm9wcywgU3RhdGU+IHtcclxuICBwcm9wczogUHJvcHM7XHJcbiAgc3RhdGU6IFN0YXRlO1xyXG4gIF9kaXNwb3NhYmxlczogVW5pdmVyc2FsRGlzcG9zYWJsZTtcclxuXHJcbiAgY29uc3RydWN0b3IocHJvcHM6IFByb3BzKSB7XHJcbiAgICBzdXBlcihwcm9wcyk7XHJcbiAgICB0aGlzLl9kaXNwb3NhYmxlcyA9IG5ldyBVbml2ZXJzYWxEaXNwb3NhYmxlKCk7XHJcblxyXG4gICAgKHRoaXM6IGFueSkuX2hhbmRsZURldmljZUxpc3RDaGFuZ2UgPSB0aGlzLl9oYW5kbGVEZXZpY2VMaXN0Q2hhbmdlLmJpbmQoXHJcbiAgICAgIHRoaXMsXHJcbiAgICApO1xyXG4gICAgKHRoaXM6IGFueSkuX2hhbmRsZURldmljZURyb3Bkb3duQ2hhbmdlID0gdGhpcy5faGFuZGxlRGV2aWNlRHJvcGRvd25DaGFuZ2UuYmluZChcclxuICAgICAgdGhpcyxcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5zdGF0ZSA9IHtcclxuICAgICAgZGV2aWNlTGlzdDogRXhwZWN0LnBlbmRpbmcoKSxcclxuICAgICAgc2VsZWN0ZWREZXZpY2U6IG51bGwsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgY29tcG9uZW50RGlkTW91bnQoKTogdm9pZCB7XHJcbiAgICB0aGlzLl9kaXNwb3NhYmxlcy5hZGQoXHJcbiAgICAgIG9ic2VydmVBbmRyb2lkRGV2aWNlcyh0aGlzLnByb3BzLnRhcmdldFVyaSlcclxuICAgICAgICAuc3RhcnRXaXRoKEV4cGVjdC5wZW5kaW5nKCkpXHJcbiAgICAgICAgLnN1YnNjcmliZShkZXZpY2VMaXN0ID0+IHRoaXMuX2hhbmRsZURldmljZUxpc3RDaGFuZ2UoZGV2aWNlTGlzdCkpLFxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xyXG4gICAgdGhpcy5fZGlzcG9zYWJsZXMuZGlzcG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZURldmljZUxpc3RDaGFuZ2UoZGV2aWNlTGlzdDogRXhwZWN0ZWQ8QXJyYXk8QWRiRGV2aWNlPj4pOiB2b2lkIHtcclxuICAgIGNvbnN0IHByZXZpb3VzRGV2aWNlID0gdGhpcy5zdGF0ZS5zZWxlY3RlZERldmljZTtcclxuICAgIGxldCBzZWxlY3RlZERldmljZSA9XHJcbiAgICAgIHByZXZpb3VzRGV2aWNlID09IG51bGxcclxuICAgICAgICA/IG51bGxcclxuICAgICAgICA6IGRldmljZUxpc3RcclxuICAgICAgICAgICAgLmdldE9yRGVmYXVsdChbXSlcclxuICAgICAgICAgICAgLmZpbmQoZGV2aWNlID0+IGRldmljZS5zZXJpYWwgPT09IHByZXZpb3VzRGV2aWNlLnNlcmlhbCk7XHJcblxyXG4gICAgaWYgKHNlbGVjdGVkRGV2aWNlID09IG51bGwgJiYgZGV2aWNlTGlzdC5pc1ZhbHVlKSB7XHJcbiAgICAgIHNlbGVjdGVkRGV2aWNlID0gZGV2aWNlTGlzdC52YWx1ZVswXTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnNldFN0YXRlKHtcclxuICAgICAgZGV2aWNlTGlzdCxcclxuICAgICAgc2VsZWN0ZWREZXZpY2UsXHJcbiAgICB9KTtcclxuICAgIHRoaXMucHJvcHMub25DaGFuZ2Uoc2VsZWN0ZWREZXZpY2UpO1xyXG4gIH1cclxuXHJcbiAgX2dldERldmljZUl0ZW1zKCk6IEFycmF5PE1lbnVJdGVtPiB7XHJcbiAgICBpbnZhcmlhbnQodGhpcy5zdGF0ZS5kZXZpY2VMaXN0LmlzVmFsdWUpO1xyXG4gICAgaWYgKHRoaXMuc3RhdGUuZGV2aWNlTGlzdC52YWx1ZS5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIFt7dmFsdWU6IG51bGwsIGxhYmVsOiBOT19ERVZJQ0VTX01TR31dO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0aGlzLnN0YXRlLmRldmljZUxpc3QudmFsdWUubWFwKGRldmljZSA9PiAoe1xyXG4gICAgICB2YWx1ZTogZGV2aWNlLFxyXG4gICAgICBsYWJlbDogZGV2aWNlLmRpc3BsYXlOYW1lLFxyXG4gICAgfSkpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyKCk6IFJlYWN0Lk5vZGUge1xyXG4gICAgaWYgKHRoaXMuc3RhdGUuZGV2aWNlTGlzdC5pc1BlbmRpbmcpIHtcclxuICAgICAgcmV0dXJuIDxMb2FkaW5nU3Bpbm5lciBzaXplPVwiRVhUUkFfU01BTExcIiAvPjtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5zdGF0ZS5kZXZpY2VMaXN0LmlzRXJyb3IpIHtcclxuICAgICAgcmV0dXJuIChcclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIm51Y2xpZGUtdWktbWVzc2FnZS1lcnJvclwiPlxyXG4gICAgICAgICAge3RoaXMuc3RhdGUuZGV2aWNlTGlzdC5lcnJvci50b1N0cmluZygpfVxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGRldmljZUl0ZW1zID0gdGhpcy5fZ2V0RGV2aWNlSXRlbXMoKTtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIDxEcm9wZG93blxyXG4gICAgICAgIG9wdGlvbnM9e2RldmljZUl0ZW1zfVxyXG4gICAgICAgIG9uQ2hhbmdlPXt0aGlzLl9oYW5kbGVEZXZpY2VEcm9wZG93bkNoYW5nZX1cclxuICAgICAgICB2YWx1ZT17dGhpcy5zdGF0ZS5zZWxlY3RlZERldmljZX1cclxuICAgICAgLz5cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRGV2aWNlRHJvcGRvd25DaGFuZ2Uoc2VsZWN0ZWREZXZpY2U6ID9BZGJEZXZpY2UpOiB2b2lkIHtcclxuICAgIHRoaXMuc2V0U3RhdGUoe1xyXG4gICAgICBzZWxlY3RlZERldmljZSxcclxuICAgIH0pO1xyXG4gICAgdGhpcy5wcm9wcy5vbkNoYW5nZShzZWxlY3RlZERldmljZSk7XHJcbiAgfVxyXG59XHJcbiJdfQ==