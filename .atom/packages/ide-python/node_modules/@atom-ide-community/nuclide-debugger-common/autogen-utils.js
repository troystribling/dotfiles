"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.generatePropertyArray = generatePropertyArray;
exports.getNativeAutoGenConfig = getNativeAutoGenConfig;

var React = _interopRequireWildcard(require("react"));

var _constants = require("./constants");

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

/**
 * Copyright (c) 2017-present, Facebook, Inc.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 *
 * 
 * @format
 */
function generatePropertyArray(launchOrAttachConfigProperties, required, visible) {
  const propertyArray = Object.entries(launchOrAttachConfigProperties).map(property => {
    const name = property[0];
    const propertyDetails = property[1];
    const autoGenProperty = {
      name,
      type: propertyDetails.type,
      description: propertyDetails.description,
      required: required.includes(name),
      visible: visible.includes(name)
    };

    if (typeof propertyDetails.default !== 'undefined') {
      autoGenProperty.defaultValue = propertyDetails.default;
    }

    if (propertyDetails.items != null && typeof propertyDetails.items.type !== 'undefined') {
      autoGenProperty.itemType = propertyDetails.items.type;
    }

    if (typeof propertyDetails.enums !== 'undefined') {
      autoGenProperty.enums = propertyDetails.enums;
    }

    return autoGenProperty;
  }).sort((p1, p2) => {
    // TODO (goom): sort all configs, not just ones generated from the json
    if (p1.required && !p2.required) {
      return -1;
    }

    if (p2.required && !p1.required) {
      return 1;
    }

    return 0;
  });
  return propertyArray;
}

function getNativeAutoGenConfig(vsAdapterType) {
  const program = {
    name: 'program',
    type: 'path',
    description: 'Input the program/executable you want to launch',
    required: true,
    visible: true
  };
  const cwd = {
    name: 'cwd',
    type: 'path',
    description: 'Working directory for the launched executable',
    required: true,
    visible: true
  };
  const args = {
    name: 'args',
    type: 'array',
    itemType: 'string',
    description: '(Optional) Arguments to the executable',
    required: false,
    defaultValue: '',
    visible: true
  };
  const env = {
    name: 'env',
    type: 'array',
    itemType: 'string',
    description: '(Optional) Environment variables (e.g. SHELL=/bin/bash PATH=/bin)',
    required: false,
    defaultValue: '',
    visible: true
  };
  const corePath = {
    name: 'coreDumpPath',
    type: 'path',
    description: 'Optional path to a core file to load in the debugger',
    required: false,
    defaultValue: '',
    visible: true
  };
  const stopOnEntry = {
    name: 'pauseProgramOnEntry',
    type: 'boolean',
    description: 'If true, the debugger will stop the program at entry before starting execution.',
    required: false,
    defaultValue: false,
    visible: true
  };
  const debugTypeMessage = `using ${vsAdapterType === _constants.VsAdapterTypes.NATIVE_GDB ? 'gdb' : 'lldb'}`;
  const autoGenLaunchConfig = {
    launch: true,
    vsAdapterType,
    properties: [program, cwd, args, env, stopOnEntry, corePath],
    scriptPropertyName: 'program',
    scriptExtension: '.c',
    cwdPropertyName: 'working directory',
    header: /*#__PURE__*/React.createElement("p", null, "Debug native programs ", debugTypeMessage, "."),

    getProcessName(values) {
      let processName = values.program;
      const lastSlash = processName.lastIndexOf('/');

      if (lastSlash >= 0) {
        processName = processName.substring(lastSlash + 1, processName.length);
      }

      return processName;
    }

  };
  const pid = {
    name: 'pid',
    type: 'process',
    description: '',
    required: true,
    visible: true
  };
  const autoGenAttachConfig = {
    launch: false,
    vsAdapterType,
    properties: [pid],
    header: /*#__PURE__*/React.createElement("p", null, "Attach to a running native process ", debugTypeMessage),

    getProcessName(values) {
      return 'Pid: ' + values.pid + ' (' + debugTypeMessage + ')';
    }

  };
  return {
    launch: autoGenLaunchConfig,
    attach: autoGenAttachConfig
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL251Y2xpZGUvbnVjbGlkZS1kZWJ1Z2dlci1jb21tb24vYXV0b2dlbi11dGlscy5qcyJdLCJuYW1lcyI6WyJnZW5lcmF0ZVByb3BlcnR5QXJyYXkiLCJsYXVuY2hPckF0dGFjaENvbmZpZ1Byb3BlcnRpZXMiLCJyZXF1aXJlZCIsInZpc2libGUiLCJwcm9wZXJ0eUFycmF5IiwiT2JqZWN0IiwiZW50cmllcyIsIm1hcCIsInByb3BlcnR5IiwibmFtZSIsInByb3BlcnR5RGV0YWlscyIsImF1dG9HZW5Qcm9wZXJ0eSIsInR5cGUiLCJkZXNjcmlwdGlvbiIsImluY2x1ZGVzIiwiZGVmYXVsdCIsImRlZmF1bHRWYWx1ZSIsIml0ZW1zIiwiaXRlbVR5cGUiLCJlbnVtcyIsInNvcnQiLCJwMSIsInAyIiwiZ2V0TmF0aXZlQXV0b0dlbkNvbmZpZyIsInZzQWRhcHRlclR5cGUiLCJwcm9ncmFtIiwiY3dkIiwiYXJncyIsImVudiIsImNvcmVQYXRoIiwic3RvcE9uRW50cnkiLCJkZWJ1Z1R5cGVNZXNzYWdlIiwiVnNBZGFwdGVyVHlwZXMiLCJOQVRJVkVfR0RCIiwiYXV0b0dlbkxhdW5jaENvbmZpZyIsImxhdW5jaCIsInByb3BlcnRpZXMiLCJzY3JpcHRQcm9wZXJ0eU5hbWUiLCJzY3JpcHRFeHRlbnNpb24iLCJjd2RQcm9wZXJ0eU5hbWUiLCJoZWFkZXIiLCJnZXRQcm9jZXNzTmFtZSIsInZhbHVlcyIsInByb2Nlc3NOYW1lIiwibGFzdFNsYXNoIiwibGFzdEluZGV4T2YiLCJzdWJzdHJpbmciLCJsZW5ndGgiLCJwaWQiLCJhdXRvR2VuQXR0YWNoQ29uZmlnIiwiYXR0YWNoIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQW1CQTs7QUFFQTs7Ozs7O0FBckJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFhTyxTQUFTQSxxQkFBVCxDQUNMQyw4QkFESyxFQUVMQyxRQUZLLEVBR0xDLE9BSEssRUFJYztBQUNuQixR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Q1UsSUFBQUEsY0FBYyxDQUFDQyxNQUFELEVBQVM7QUFDckIsVUFBSUMsV0FBVyxHQUFHRCxNQUFNLENBQUNqQixPQUF6QjtBQUNBLFlBQU1tQixTQUFTLEdBQUdELFdBQVcsQ0FBQ0UsV0FBWixDQUF3QixHQUF4QixDQUFsQjs7QUFDQSxVQUFJRCxTQUFTLElBQUksQ0FBakIsRUFBb0I7QUFDbEJELFFBQUFBLFdBQVcsR0FBR0EsV0FBVyxDQUFDRyxTQUFaLENBQXNCRixTQUFTLEdBQUcsQ0FBbEMsRUFBcUNELFdBQVcsQ0FBQ0ksTUFBakQsQ0FBZDtBQUNEOztBQUNELGFBQU9KLFdBQVA7QUFDRDs7QUFmOEMsR0FBakQ7QUFrQkEsUUFBTUssR0FBRyxHQUFHO0FBQ1Z2QyxJQUFBQSxJQUFJLEVBQUUsS0FESTtBQUVWRyxJQUFBQSxJQUFJLEVBQUUsU0FGSTtBQUdWQyxJQUFBQSxXQUFXLEVBQUUsRUFISDtBQUlWWCxJQUFBQSxRQUFRLEVBQUUsSUFKQTtBQUtWQyxJQUFBQSxPQUFPLEVBQUU7QUFMQyxHQUFaO0FBT0EsUUFBTThDLG1CQUF3QyxHQUFHO0FBQy9DZCxJQUFBQSxNQUFNLEVBQUUsS0FEdUM7QUFFL0NYLElBQUFBLGFBRitDO0FBRy9DWSxJQUFBQSxVQUFVLEVBQUUsQ0FBQ1ksR0FBRCxDQUhtQztBQUkvQ1IsSUFBQUEsTUFBTSxlQUFFLHNFQUF1Q1QsZ0JBQXZDLENBSnVDOztBQUsvQ1UsSUFBQUEsY0FBYyxDQUFDQyxNQUFELEVBQVM7QUFDckIsYUFBTyxVQUFVQSxNQUFNLENBQUNNLEdBQWpCLEdBQXVCLElBQXZCLEdBQThCakIsZ0JBQTlCLEdBQWlELEdBQXhEO0FBQ0Q7O0FBUDhDLEdBQWpEO0FBU0EsU0FBTztBQUNMSSxJQUFBQSxNQUFNLEVBQUVELG1CQURIO0FBRUxnQixJQUFBQSxNQUFNLEVBQUVEO0FBRkgsR0FBUDtBQUlEIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENvcHlyaWdodCAoYykgMjAxNy1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxyXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKlxyXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBCU0Qtc3R5bGUgbGljZW5zZSBmb3VuZCBpbiB0aGVcclxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLiBBbiBhZGRpdGlvbmFsIGdyYW50XHJcbiAqIG9mIHBhdGVudCByaWdodHMgY2FuIGJlIGZvdW5kIGluIHRoZSBQQVRFTlRTIGZpbGUgaW4gdGhlIHNhbWUgZGlyZWN0b3J5LlxyXG4gKlxyXG4gKiBAZmxvd1xyXG4gKiBAZm9ybWF0XHJcbiAqL1xyXG5cclxuaW1wb3J0IHR5cGUge0F1dG9HZW5Qcm9wZXJ0eX0gZnJvbSAnLi90eXBlcyc7XHJcbmltcG9ydCB0eXBlIHtcclxuICBOYXRpdmVWc0FkYXB0ZXJUeXBlLFxyXG4gIEF1dG9HZW5MYXVuY2hDb25maWcsXHJcbiAgQXV0b0dlbkF0dGFjaENvbmZpZyxcclxuICBBdXRvR2VuQ29uZmlnLFxyXG59IGZyb20gJy4vdHlwZXMnO1xyXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcblxyXG5pbXBvcnQge1ZzQWRhcHRlclR5cGVzfSBmcm9tICcuL2NvbnN0YW50cyc7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVQcm9wZXJ0eUFycmF5KFxyXG4gIGxhdW5jaE9yQXR0YWNoQ29uZmlnUHJvcGVydGllczogT2JqZWN0LFxyXG4gIHJlcXVpcmVkOiBzdHJpbmdbXSxcclxuICB2aXNpYmxlOiBzdHJpbmdbXSxcclxuKTogQXV0b0dlblByb3BlcnR5W10ge1xyXG4gIGNvbnN0IHByb3BlcnR5QXJyYXkgPSBPYmplY3QuZW50cmllcyhsYXVuY2hPckF0dGFjaENvbmZpZ1Byb3BlcnRpZXMpXHJcbiAgICAubWFwKHByb3BlcnR5ID0+IHtcclxuICAgICAgY29uc3QgbmFtZSA9IHByb3BlcnR5WzBdO1xyXG4gICAgICBjb25zdCBwcm9wZXJ0eURldGFpbHM6IGFueSA9IHByb3BlcnR5WzFdO1xyXG4gICAgICBjb25zdCBhdXRvR2VuUHJvcGVydHk6IEF1dG9HZW5Qcm9wZXJ0eSA9IHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIHR5cGU6IHByb3BlcnR5RGV0YWlscy50eXBlLFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiBwcm9wZXJ0eURldGFpbHMuZGVzY3JpcHRpb24sXHJcbiAgICAgICAgcmVxdWlyZWQ6IHJlcXVpcmVkLmluY2x1ZGVzKG5hbWUpLFxyXG4gICAgICAgIHZpc2libGU6IHZpc2libGUuaW5jbHVkZXMobmFtZSksXHJcbiAgICAgIH07XHJcbiAgICAgIGlmICh0eXBlb2YgcHJvcGVydHlEZXRhaWxzLmRlZmF1bHQgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgYXV0b0dlblByb3BlcnR5LmRlZmF1bHRWYWx1ZSA9IHByb3BlcnR5RGV0YWlscy5kZWZhdWx0O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChcclxuICAgICAgICBwcm9wZXJ0eURldGFpbHMuaXRlbXMgIT0gbnVsbCAmJlxyXG4gICAgICAgIHR5cGVvZiBwcm9wZXJ0eURldGFpbHMuaXRlbXMudHlwZSAhPT0gJ3VuZGVmaW5lZCdcclxuICAgICAgKSB7XHJcbiAgICAgICAgYXV0b0dlblByb3BlcnR5Lml0ZW1UeXBlID0gcHJvcGVydHlEZXRhaWxzLml0ZW1zLnR5cGU7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHR5cGVvZiBwcm9wZXJ0eURldGFpbHMuZW51bXMgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgYXV0b0dlblByb3BlcnR5LmVudW1zID0gcHJvcGVydHlEZXRhaWxzLmVudW1zO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBhdXRvR2VuUHJvcGVydHk7XHJcbiAgICB9KVxyXG4gICAgLnNvcnQoKHAxLCBwMikgPT4ge1xyXG4gICAgICAvLyBUT0RPIChnb29tKTogc29ydCBhbGwgY29uZmlncywgbm90IGp1c3Qgb25lcyBnZW5lcmF0ZWQgZnJvbSB0aGUganNvblxyXG4gICAgICBpZiAocDEucmVxdWlyZWQgJiYgIXAyLnJlcXVpcmVkKSB7XHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChwMi5yZXF1aXJlZCAmJiAhcDEucmVxdWlyZWQpIHtcclxuICAgICAgICByZXR1cm4gMTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gMDtcclxuICAgIH0pO1xyXG4gIHJldHVybiBwcm9wZXJ0eUFycmF5O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0TmF0aXZlQXV0b0dlbkNvbmZpZyhcclxuICB2c0FkYXB0ZXJUeXBlOiBOYXRpdmVWc0FkYXB0ZXJUeXBlLFxyXG4pOiBBdXRvR2VuQ29uZmlnIHtcclxuICBjb25zdCBwcm9ncmFtID0ge1xyXG4gICAgbmFtZTogJ3Byb2dyYW0nLFxyXG4gICAgdHlwZTogJ3BhdGgnLFxyXG4gICAgZGVzY3JpcHRpb246ICdJbnB1dCB0aGUgcHJvZ3JhbS9leGVjdXRhYmxlIHlvdSB3YW50IHRvIGxhdW5jaCcsXHJcbiAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIHZpc2libGU6IHRydWUsXHJcbiAgfTtcclxuICBjb25zdCBjd2QgPSB7XHJcbiAgICBuYW1lOiAnY3dkJyxcclxuICAgIHR5cGU6ICdwYXRoJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnV29ya2luZyBkaXJlY3RvcnkgZm9yIHRoZSBsYXVuY2hlZCBleGVjdXRhYmxlJyxcclxuICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgdmlzaWJsZTogdHJ1ZSxcclxuICB9O1xyXG4gIGNvbnN0IGFyZ3MgPSB7XHJcbiAgICBuYW1lOiAnYXJncycsXHJcbiAgICB0eXBlOiAnYXJyYXknLFxyXG4gICAgaXRlbVR5cGU6ICdzdHJpbmcnLFxyXG4gICAgZGVzY3JpcHRpb246ICcoT3B0aW9uYWwpIEFyZ3VtZW50cyB0byB0aGUgZXhlY3V0YWJsZScsXHJcbiAgICByZXF1aXJlZDogZmFsc2UsXHJcbiAgICBkZWZhdWx0VmFsdWU6ICcnLFxyXG4gICAgdmlzaWJsZTogdHJ1ZSxcclxuICB9O1xyXG4gIGNvbnN0IGVudiA9IHtcclxuICAgIG5hbWU6ICdlbnYnLFxyXG4gICAgdHlwZTogJ2FycmF5JyxcclxuICAgIGl0ZW1UeXBlOiAnc3RyaW5nJyxcclxuICAgIGRlc2NyaXB0aW9uOlxyXG4gICAgICAnKE9wdGlvbmFsKSBFbnZpcm9ubWVudCB2YXJpYWJsZXMgKGUuZy4gU0hFTEw9L2Jpbi9iYXNoIFBBVEg9L2JpbiknLFxyXG4gICAgcmVxdWlyZWQ6IGZhbHNlLFxyXG4gICAgZGVmYXVsdFZhbHVlOiAnJyxcclxuICAgIHZpc2libGU6IHRydWUsXHJcbiAgfTtcclxuICBjb25zdCBjb3JlUGF0aCA9IHtcclxuICAgIG5hbWU6ICdjb3JlRHVtcFBhdGgnLFxyXG4gICAgdHlwZTogJ3BhdGgnLFxyXG4gICAgZGVzY3JpcHRpb246ICdPcHRpb25hbCBwYXRoIHRvIGEgY29yZSBmaWxlIHRvIGxvYWQgaW4gdGhlIGRlYnVnZ2VyJyxcclxuICAgIHJlcXVpcmVkOiBmYWxzZSxcclxuICAgIGRlZmF1bHRWYWx1ZTogJycsXHJcbiAgICB2aXNpYmxlOiB0cnVlLFxyXG4gIH07XHJcblxyXG4gIGNvbnN0IHN0b3BPbkVudHJ5ID0ge1xyXG4gICAgbmFtZTogJ3BhdXNlUHJvZ3JhbU9uRW50cnknLFxyXG4gICAgdHlwZTogJ2Jvb2xlYW4nLFxyXG4gICAgZGVzY3JpcHRpb246XHJcbiAgICAgICdJZiB0cnVlLCB0aGUgZGVidWdnZXIgd2lsbCBzdG9wIHRoZSBwcm9ncmFtIGF0IGVudHJ5IGJlZm9yZSBzdGFydGluZyBleGVjdXRpb24uJyxcclxuICAgIHJlcXVpcmVkOiBmYWxzZSxcclxuICAgIGRlZmF1bHRWYWx1ZTogZmFsc2UsXHJcbiAgICB2aXNpYmxlOiB0cnVlLFxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGRlYnVnVHlwZU1lc3NhZ2UgPSBgdXNpbmcgJHtcclxuICAgIHZzQWRhcHRlclR5cGUgPT09IFZzQWRhcHRlclR5cGVzLk5BVElWRV9HREIgPyAnZ2RiJyA6ICdsbGRiJ1xyXG4gIH1gO1xyXG5cclxuICBjb25zdCBhdXRvR2VuTGF1bmNoQ29uZmlnOiBBdXRvR2VuTGF1bmNoQ29uZmlnID0ge1xyXG4gICAgbGF1bmNoOiB0cnVlLFxyXG4gICAgdnNBZGFwdGVyVHlwZSxcclxuICAgIHByb3BlcnRpZXM6IFtwcm9ncmFtLCBjd2QsIGFyZ3MsIGVudiwgc3RvcE9uRW50cnksIGNvcmVQYXRoXSxcclxuICAgIHNjcmlwdFByb3BlcnR5TmFtZTogJ3Byb2dyYW0nLFxyXG4gICAgc2NyaXB0RXh0ZW5zaW9uOiAnLmMnLFxyXG4gICAgY3dkUHJvcGVydHlOYW1lOiAnd29ya2luZyBkaXJlY3RvcnknLFxyXG4gICAgaGVhZGVyOiA8cD5EZWJ1ZyBuYXRpdmUgcHJvZ3JhbXMge2RlYnVnVHlwZU1lc3NhZ2V9LjwvcD4sXHJcbiAgICBnZXRQcm9jZXNzTmFtZSh2YWx1ZXMpIHtcclxuICAgICAgbGV0IHByb2Nlc3NOYW1lID0gdmFsdWVzLnByb2dyYW07XHJcbiAgICAgIGNvbnN0IGxhc3RTbGFzaCA9IHByb2Nlc3NOYW1lLmxhc3RJbmRleE9mKCcvJyk7XHJcbiAgICAgIGlmIChsYXN0U2xhc2ggPj0gMCkge1xyXG4gICAgICAgIHByb2Nlc3NOYW1lID0gcHJvY2Vzc05hbWUuc3Vic3RyaW5nKGxhc3RTbGFzaCArIDEsIHByb2Nlc3NOYW1lLmxlbmd0aCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHByb2Nlc3NOYW1lO1xyXG4gICAgfSxcclxuICB9O1xyXG5cclxuICBjb25zdCBwaWQgPSB7XHJcbiAgICBuYW1lOiAncGlkJyxcclxuICAgIHR5cGU6ICdwcm9jZXNzJyxcclxuICAgIGRlc2NyaXB0aW9uOiAnJyxcclxuICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgdmlzaWJsZTogdHJ1ZSxcclxuICB9O1xyXG4gIGNvbnN0IGF1dG9HZW5BdHRhY2hDb25maWc6IEF1dG9HZW5BdHRhY2hDb25maWcgPSB7XHJcbiAgICBsYXVuY2g6IGZhbHNlLFxyXG4gICAgdnNBZGFwdGVyVHlwZSxcclxuICAgIHByb3BlcnRpZXM6IFtwaWRdLFxyXG4gICAgaGVhZGVyOiA8cD5BdHRhY2ggdG8gYSBydW5uaW5nIG5hdGl2ZSBwcm9jZXNzIHtkZWJ1Z1R5cGVNZXNzYWdlfTwvcD4sXHJcbiAgICBnZXRQcm9jZXNzTmFtZSh2YWx1ZXMpIHtcclxuICAgICAgcmV0dXJuICdQaWQ6ICcgKyB2YWx1ZXMucGlkICsgJyAoJyArIGRlYnVnVHlwZU1lc3NhZ2UgKyAnKSc7XHJcbiAgICB9LFxyXG4gIH07XHJcbiAgcmV0dXJuIHtcclxuICAgIGxhdW5jaDogYXV0b0dlbkxhdW5jaENvbmZpZyxcclxuICAgIGF0dGFjaDogYXV0b0dlbkF0dGFjaENvbmZpZyxcclxuICB9O1xyXG59XHJcbiJdfQ==