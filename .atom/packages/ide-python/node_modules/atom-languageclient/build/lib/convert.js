Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = undefined;

var _languageclient = require('./languageclient');

var ls = _interopRequireWildcard(_languageclient);

var _atom = require('atom');

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

// Public: Class that contains a number of helper methods for general conversions
// between the language server protocol and Atom/Atom packages.
let Convert = class Convert {
  // Public: Convert a path to a Uri.
  //
  // * `filePath` A file path to convert to a Uri.
  //
  // Returns the Uri corresponding to the path. e.g. file:///a/b/c.txt
  static pathToUri(filePath) {
    let newPath = filePath.replace(/\\/g, '/');
    if (newPath[0] !== '/') {
      newPath = `/${newPath}`;
    }
    return encodeURI(`file://${newPath}`).replace(/[?#]/g, encodeURIComponent);
  }

  // Public: Convert a Uri to a path.
  //
  // * `uri` A Uri to convert to a file path.
  //
  // Returns a file path corresponding to the Uri. e.g. /a/b/c.txt
  // If the Uri does not begin file:// then it is returned as-is to allow Atom
  // to deal with http/https sources in the future.
  static uriToPath(uri) {
    let filePath = decodeURIComponent(uri);
    if (!filePath.startsWith('file://')) {
      return uri;
    }

    filePath = filePath.substr(7);
    if (process.platform === 'win32') {
      // Deal with Windows drive names
      if (filePath[0] === '/') {
        filePath = filePath.substr(1);
      }
      return filePath.replace(/\//g, '\\');
    }
    return filePath;
  }

  // Public: Convert an Atom {PointObject} to a language server {Position}.
  //
  // * `point` An Atom {PointObject} to convert from.
  //
  // Returns the {Position} representation of the Atom {PointObject}.
  static pointToPosition(point) {
    return { line: point.row, character: point.column };
  }

  // Public: Convert a language server {Position} into an Atom {PointObject}.
  //
  // * 'position' A language server {Position} to convert from.
  //
  // Returns the Atom {PointObject} representation of the given {Position}.
  static positionToPoint(position) {
    return new _atom.Point(position.line, position.character);
  }

  // Public: Convert a language server {Range} into an Atom {Range}.
  //
  // * 'range' A language server {Range} to convert from.
  //
  // Returns the Atom {Range} representation of the given language server {Range}.
  static lsRangeToAtomRange(range) {
    return new _atom.Range(Convert.positionToPoint(range.start), Convert.positionToPoint(range.end));
  }

  // Public: Convert an Atom {Range} into an language server {Range}.
  //
  // * 'range' An Atom {Range} to convert from.
  //
  // Returns the language server {Range} representation of the given Atom {Range}.
  static atomRangeToLSRange(range) {
    return {
      start: Convert.pointToPosition(range.start),
      end: Convert.pointToPosition(range.end)
    };
  }

  // Public: Create a {TextDocumentIdentifier} from an Atom {TextEditor}.
  //
  // * `editor` A {TextEditor} that will be used to form the uri property.
  //
  // Returns a {TextDocumentIdentifier} that has a `uri` property with the Uri for the
  // given editor's path.
  static editorToTextDocumentIdentifier(editor) {
    return { uri: Convert.pathToUri(editor.getPath() || '') };
  }

  // Public: Create a {TextDocumentPositionParams} from a {TextEditor} and optional {Point}.
  //
  // * `editor` A {TextEditor} that will be used to form the uri property.
  // * `point`  An optional {Point} that will supply the position property. If not specified
  //            the current cursor position will be used.
  //
  // Returns a {TextDocumentPositionParams} that has textDocument property with the editors {TextDocumentIdentifier}
  // and a position property with the supplied point (or current cursor position when not specified).
  static editorToTextDocumentPositionParams(editor, point) {
    return {
      textDocument: Convert.editorToTextDocumentIdentifier(editor),
      position: Convert.pointToPosition(point != null ? point : editor.getCursorBufferPosition())
    };
  }

  // Public: Create a string of scopes for the atom text editor using the data-grammar selector from an
  // {Array} of grammarScope strings.
  //
  // * `grammarScopes` An {Array} of grammar scope string to convert from.
  //
  // Returns a single comma-separated list of CSS selectors targetting the grammars of Atom text editors.
  // e.g. `['c', 'cpp']` => `'atom-text-editor[data-grammar='c'], atom-text-editor[data-grammar='cpp']`
  static grammarScopesToTextEditorScopes(grammarScopes) {
    return grammarScopes.map(g => `atom-text-editor[data-grammar="${Convert.encodeHTMLAttribute(g.replace(/\./g, ' '))}"]`).join(', ');
  }

  // Public: Encode a string so that it can be safely used within a HTML attribute - i.e. replacing all quoted
  // values with their HTML entity encoded versions.  e.g. `Hello"` becomes `Hello&quot;`
  //
  // * 's' A string to be encoded.
  //
  // Returns a string that is HTML attribute encoded by replacing &, <, >, " and ' with their HTML entity
  // named equivalents.
  static encodeHTMLAttribute(s) {
    const attributeMap = {
      '&': '&amp;',
      '<': '&lt;',
      '>': '&gt;',
      '"': '&quot;',
      "'": '&apos;'
    };
    return s.replace(/[&<>'"]/g, c => attributeMap[c]);
  }

  // Public: Convert an Atom File Event as received from atom.project.onDidChangeFiles and convert
  // it into an Array of Language Server Protocol {FileEvent} objects. Normally this will be a 1-to-1
  // but renames will be represented by a deletion and a subsequent creation as LSP does not know about
  // renames.
  //
  // * 'fileEvent' An {atom$ProjectFileEvent} to be converted.
  //
  // Returns an array of LSP {ls.FileEvent} objects that equivalent conversions to the fileEvent parameter.
  static atomFileEventToLSFileEvents(fileEvent) {
    switch (fileEvent.action) {
      case 'created':
        return [{ uri: Convert.pathToUri(fileEvent.path), type: ls.FileChangeType.Created }];
      case 'modified':
        return [{ uri: Convert.pathToUri(fileEvent.path), type: ls.FileChangeType.Changed }];
      case 'deleted':
        return [{ uri: Convert.pathToUri(fileEvent.path), type: ls.FileChangeType.Deleted }];
      case 'renamed':
        {
          const results = [];
          if (fileEvent.oldPath) {
            results.push({ uri: Convert.pathToUri(fileEvent.oldPath || ''), type: ls.FileChangeType.Deleted });
          }
          if (fileEvent.path) {
            results.push({ uri: Convert.pathToUri(fileEvent.path), type: ls.FileChangeType.Created });
          }
          return results;
        }
      default:
        return [];
    }
  }

  static atomIdeDiagnosticToLSDiagnostic(diagnostic) {
    return {
      range: Convert.atomRangeToLSRange(diagnostic.range),
      severity: Convert.diagnosticTypeToLSSeverity(diagnostic.type),
      source: diagnostic.providerName,
      message: diagnostic.text || ''
    };
  }

  static diagnosticTypeToLSSeverity(type) {
    switch (type) {
      case 'Error':
        return ls.DiagnosticSeverity.Error;
      case 'Warning':
        return ls.DiagnosticSeverity.Warning;
      case 'Info':
        return ls.DiagnosticSeverity.Information;
      default:
        type;
        throw Error(`Unexpected diagnostic type ${type}`);
    }
  }

  // Public: Convert an array of language server protocol {TextEdit} objects to an
  // equivalent array of Atom {TextEdit} objects.
  //
  // * `textEdits` The language server protocol {TextEdit} objects to convert.
  //
  // Returns an {Array} of Atom {TextEdit} objects.
  static convertLsTextEdits(textEdits) {
    return (textEdits || []).map(Convert.convertLsTextEdit);
  }

  // Public: Convert a language server protocol {TextEdit} object to the
  // Atom equivalent {TextEdit}.
  //
  // * `textEdits` The language server protocol {TextEdit} objects to convert.
  //
  // Returns an Atom {TextEdit} object.
  static convertLsTextEdit(textEdit) {
    return {
      oldRange: Convert.lsRangeToAtomRange(textEdit.range),
      newText: textEdit.newText
    };
  }
};
exports.default = Convert;
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2xpYi9jb252ZXJ0LmpzIl0sIm5hbWVzIjpbImxzIiwiQ29udmVydCIsInBhdGhUb1VyaSIsImZpbGVQYXRoIiwibmV3UGF0aCIsInJlcGxhY2UiLCJlbmNvZGVVUkkiLCJlbmNvZGVVUklDb21wb25lbnQiLCJ1cmlUb1BhdGgiLCJ1cmkiLCJkZWNvZGVVUklDb21wb25lbnQiLCJzdGFydHNXaXRoIiwic3Vic3RyIiwicHJvY2VzcyIsInBsYXRmb3JtIiwicG9pbnRUb1Bvc2l0aW9uIiwicG9pbnQiLCJsaW5lIiwicm93IiwiY2hhcmFjdGVyIiwiY29sdW1uIiwicG9zaXRpb25Ub1BvaW50IiwicG9zaXRpb24iLCJsc1JhbmdlVG9BdG9tUmFuZ2UiLCJyYW5nZSIsInN0YXJ0IiwiZW5kIiwiYXRvbVJhbmdlVG9MU1JhbmdlIiwiZWRpdG9yVG9UZXh0RG9jdW1lbnRJZGVudGlmaWVyIiwiZWRpdG9yIiwiZ2V0UGF0aCIsImVkaXRvclRvVGV4dERvY3VtZW50UG9zaXRpb25QYXJhbXMiLCJ0ZXh0RG9jdW1lbnQiLCJnZXRDdXJzb3JCdWZmZXJQb3NpdGlvbiIsImdyYW1tYXJTY29wZXNUb1RleHRFZGl0b3JTY29wZXMiLCJncmFtbWFyU2NvcGVzIiwibWFwIiwiZyIsImVuY29kZUhUTUxBdHRyaWJ1dGUiLCJqb2luIiwicyIsImF0dHJpYnV0ZU1hcCIsImMiLCJhdG9tRmlsZUV2ZW50VG9MU0ZpbGVFdmVudHMiLCJmaWxlRXZlbnQiLCJhY3Rpb24iLCJwYXRoIiwidHlwZSIsIkZpbGVDaGFuZ2VUeXBlIiwiQ3JlYXRlZCIsIkNoYW5nZWQiLCJEZWxldGVkIiwicmVzdWx0cyIsIm9sZFBhdGgiLCJwdXNoIiwiYXRvbUlkZURpYWdub3N0aWNUb0xTRGlhZ25vc3RpYyIsImRpYWdub3N0aWMiLCJzZXZlcml0eSIsImRpYWdub3N0aWNUeXBlVG9MU1NldmVyaXR5Iiwic291cmNlIiwicHJvdmlkZXJOYW1lIiwibWVzc2FnZSIsInRleHQiLCJEaWFnbm9zdGljU2V2ZXJpdHkiLCJFcnJvciIsIldhcm5pbmciLCJJbmZvcm1hdGlvbiIsImNvbnZlcnRMc1RleHRFZGl0cyIsInRleHRFZGl0cyIsImNvbnZlcnRMc1RleHRFZGl0IiwidGV4dEVkaXQiLCJvbGRSYW5nZSIsIm5ld1RleHQiXSwibWFwcGluZ3MiOiI7Ozs7O0FBRUE7O0lBQVlBLEU7O0FBQ1o7Ozs7QUFFQTtBQUNBO0lBQ3FCQyxPLEdBQU4sTUFBTUEsT0FBTixDQUFjO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFPQyxTQUFQLENBQWlCQyxRQUFqQixFQUEyQztBQUN6QyxRQUFJQyxVQUFVRCxTQUFTRSxPQUFULENBQWlCLEtBQWpCLEVBQXdCLEdBQXhCLENBQWQ7QUFDQSxRQUFJRCxRQUFRLENBQVIsTUFBZSxHQUFuQixFQUF3QjtBQUN0QkEsZ0JBQVcsSUFBR0EsT0FBUSxFQUF0QjtBQUNEO0FBQ0QsV0FBT0UsVUFBVyxVQUFTRixPQUFRLEVBQTVCLEVBQStCQyxPQUEvQixDQUF1QyxPQUF2QyxFQUFnREUsa0JBQWhELENBQVA7QUFDRDs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQU9DLFNBQVAsQ0FBaUJDLEdBQWpCLEVBQXNDO0FBQ3BDLFFBQUlOLFdBQVdPLG1CQUFtQkQsR0FBbkIsQ0FBZjtBQUNBLFFBQUksQ0FBQ04sU0FBU1EsVUFBVCxDQUFvQixTQUFwQixDQUFMLEVBQXFDO0FBQ25DLGFBQU9GLEdBQVA7QUFDRDs7QUFFRE4sZUFBV0EsU0FBU1MsTUFBVCxDQUFnQixDQUFoQixDQUFYO0FBQ0EsUUFBSUMsUUFBUUMsUUFBUixLQUFxQixPQUF6QixFQUFrQztBQUNoQztBQUNBLFVBQUlYLFNBQVMsQ0FBVCxNQUFnQixHQUFwQixFQUF5QjtBQUN2QkEsbUJBQVdBLFNBQVNTLE1BQVQsQ0FBZ0IsQ0FBaEIsQ0FBWDtBQUNEO0FBQ0QsYUFBT1QsU0FBU0UsT0FBVCxDQUFpQixLQUFqQixFQUF3QixJQUF4QixDQUFQO0FBQ0Q7QUFDRCxX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SyxTQUFMO0FBQ0UsZUFBT2hFLEdBQUcrRCxrQkFBSCxDQUFzQkUsT0FBN0I7QUFDRixXQUFLLE1BQUw7QUFDRSxlQUFPakUsR0FBRytELGtCQUFILENBQXNCRyxXQUE3QjtBQUNGO0FBQ0duQixZQUFEO0FBQ0EsY0FBTWlCLE1BQU8sOEJBQTZCakIsSUFBSyxFQUF6QyxDQUFOO0FBVEo7QUFXRDs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFPb0Isa0JBQVAsQ0FBMEJDLFNBQTFCLEVBQW1GO0FBQ2pGLFdBQU8sQ0FBQ0EsYUFBYSxFQUFkLEVBQWtCaEMsR0FBbEIsQ0FBc0JuQyxRQUFRb0UsaUJBQTlCLENBQVA7QUFDRDs7QUFFRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFPQSxpQkFBUCxDQUF5QkMsUUFBekIsRUFBa0U7QUFDaEUsV0FBTztBQUNMQyxnQkFBVXRFLFFBQVFzQixrQkFBUixDQUEyQitDLFNBQVM5QyxLQUFwQyxDQURMO0FBRUxnRCxlQUFTRixTQUFTRTtBQUZiLEtBQVA7QUFJRDtBQW5OMEIsQztrQkFBUnZFLE8iLCJmaWxlIjoiY29udmVydC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIEBmbG93XHJcblxyXG5pbXBvcnQgKiBhcyBscyBmcm9tICcuL2xhbmd1YWdlY2xpZW50JztcclxuaW1wb3J0IHtQb2ludCwgUmFuZ2V9IGZyb20gJ2F0b20nO1xyXG5cclxuLy8gUHVibGljOiBDbGFzcyB0aGF0IGNvbnRhaW5zIGEgbnVtYmVyIG9mIGhlbHBlciBtZXRob2RzIGZvciBnZW5lcmFsIGNvbnZlcnNpb25zXHJcbi8vIGJldHdlZW4gdGhlIGxhbmd1YWdlIHNlcnZlciBwcm90b2NvbCBhbmQgQXRvbS9BdG9tIHBhY2thZ2VzLlxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb252ZXJ0IHtcclxuICAvLyBQdWJsaWM6IENvbnZlcnQgYSBwYXRoIHRvIGEgVXJpLlxyXG4gIC8vXHJcbiAgLy8gKiBgZmlsZVBhdGhgIEEgZmlsZSBwYXRoIHRvIGNvbnZlcnQgdG8gYSBVcmkuXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIHRoZSBVcmkgY29ycmVzcG9uZGluZyB0byB0aGUgcGF0aC4gZS5nLiBmaWxlOi8vL2EvYi9jLnR4dFxyXG4gIHN0YXRpYyBwYXRoVG9VcmkoZmlsZVBhdGg6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICBsZXQgbmV3UGF0aCA9IGZpbGVQYXRoLnJlcGxhY2UoL1xcXFwvZywgJy8nKTtcclxuICAgIGlmIChuZXdQYXRoWzBdICE9PSAnLycpIHtcclxuICAgICAgbmV3UGF0aCA9IGAvJHtuZXdQYXRofWA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZW5jb2RlVVJJKGBmaWxlOi8vJHtuZXdQYXRofWApLnJlcGxhY2UoL1s/I10vZywgZW5jb2RlVVJJQ29tcG9uZW50KTtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYzogQ29udmVydCBhIFVyaSB0byBhIHBhdGguXHJcbiAgLy9cclxuICAvLyAqIGB1cmlgIEEgVXJpIHRvIGNvbnZlcnQgdG8gYSBmaWxlIHBhdGguXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEgZmlsZSBwYXRoIGNvcnJlc3BvbmRpbmcgdG8gdGhlIFVyaS4gZS5nLiAvYS9iL2MudHh0XHJcbiAgLy8gSWYgdGhlIFVyaSBkb2VzIG5vdCBiZWdpbiBmaWxlOi8vIHRoZW4gaXQgaXMgcmV0dXJuZWQgYXMtaXMgdG8gYWxsb3cgQXRvbVxyXG4gIC8vIHRvIGRlYWwgd2l0aCBodHRwL2h0dHBzIHNvdXJjZXMgaW4gdGhlIGZ1dHVyZS5cclxuICBzdGF0aWMgdXJpVG9QYXRoKHVyaTogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgIGxldCBmaWxlUGF0aCA9IGRlY29kZVVSSUNvbXBvbmVudCh1cmkpO1xyXG4gICAgaWYgKCFmaWxlUGF0aC5zdGFydHNXaXRoKCdmaWxlOi8vJykpIHtcclxuICAgICAgcmV0dXJuIHVyaTtcclxuICAgIH1cclxuXHJcbiAgICBmaWxlUGF0aCA9IGZpbGVQYXRoLnN1YnN0cig3KTtcclxuICAgIGlmIChwcm9jZXNzLnBsYXRmb3JtID09PSAnd2luMzInKSB7XHJcbiAgICAgIC8vIERlYWwgd2l0aCBXaW5kb3dzIGRyaXZlIG5hbWVzXHJcbiAgICAgIGlmIChmaWxlUGF0aFswXSA9PT0gJy8nKSB7XHJcbiAgICAgICAgZmlsZVBhdGggPSBmaWxlUGF0aC5zdWJzdHIoMSk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIGZpbGVQYXRoLnJlcGxhY2UoL1xcLy9nLCAnXFxcXCcpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZpbGVQYXRoO1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBDb252ZXJ0IGFuIEF0b20ge1BvaW50T2JqZWN0fSB0byBhIGxhbmd1YWdlIHNlcnZlciB7UG9zaXRpb259LlxyXG4gIC8vXHJcbiAgLy8gKiBgcG9pbnRgIEFuIEF0b20ge1BvaW50T2JqZWN0fSB0byBjb252ZXJ0IGZyb20uXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIHRoZSB7UG9zaXRpb259IHJlcHJlc2VudGF0aW9uIG9mIHRoZSBBdG9tIHtQb2ludE9iamVjdH0uXHJcbiAgc3RhdGljIHBvaW50VG9Qb3NpdGlvbihwb2ludDogYXRvbSRQb2ludE9iamVjdCk6IGxzLlBvc2l0aW9uIHtcclxuICAgIHJldHVybiB7bGluZTogcG9pbnQucm93LCBjaGFyYWN0ZXI6IHBvaW50LmNvbHVtbn07XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IENvbnZlcnQgYSBsYW5ndWFnZSBzZXJ2ZXIge1Bvc2l0aW9ufSBpbnRvIGFuIEF0b20ge1BvaW50T2JqZWN0fS5cclxuICAvL1xyXG4gIC8vICogJ3Bvc2l0aW9uJyBBIGxhbmd1YWdlIHNlcnZlciB7UG9zaXRpb259IHRvIGNvbnZlcnQgZnJvbS5cclxuICAvL1xyXG4gIC8vIFJldHVybnMgdGhlIEF0b20ge1BvaW50T2JqZWN0fSByZXByZXNlbnRhdGlvbiBvZiB0aGUgZ2l2ZW4ge1Bvc2l0aW9ufS5cclxuICBzdGF0aWMgcG9zaXRpb25Ub1BvaW50KHBvc2l0aW9uOiBscy5Qb3NpdGlvbik6IGF0b20kUG9pbnQge1xyXG4gICAgcmV0dXJuIG5ldyBQb2ludChwb3NpdGlvbi5saW5lLCBwb3NpdGlvbi5jaGFyYWN0ZXIpO1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBDb252ZXJ0IGEgbGFuZ3VhZ2Ugc2VydmVyIHtSYW5nZX0gaW50byBhbiBBdG9tIHtSYW5nZX0uXHJcbiAgLy9cclxuICAvLyAqICdyYW5nZScgQSBsYW5ndWFnZSBzZXJ2ZXIge1JhbmdlfSB0byBjb252ZXJ0IGZyb20uXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIHRoZSBBdG9tIHtSYW5nZX0gcmVwcmVzZW50YXRpb24gb2YgdGhlIGdpdmVuIGxhbmd1YWdlIHNlcnZlciB7UmFuZ2V9LlxyXG4gIHN0YXRpYyBsc1JhbmdlVG9BdG9tUmFuZ2UocmFuZ2U6IGxzLlJhbmdlKTogYXRvbSRSYW5nZSB7XHJcbiAgICByZXR1cm4gbmV3IFJhbmdlKENvbnZlcnQucG9zaXRpb25Ub1BvaW50KHJhbmdlLnN0YXJ0KSwgQ29udmVydC5wb3NpdGlvblRvUG9pbnQocmFuZ2UuZW5kKSk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IENvbnZlcnQgYW4gQXRvbSB7UmFuZ2V9IGludG8gYW4gbGFuZ3VhZ2Ugc2VydmVyIHtSYW5nZX0uXHJcbiAgLy9cclxuICAvLyAqICdyYW5nZScgQW4gQXRvbSB7UmFuZ2V9IHRvIGNvbnZlcnQgZnJvbS5cclxuICAvL1xyXG4gIC8vIFJldHVybnMgdGhlIGxhbmd1YWdlIHNlcnZlciB7UmFuZ2V9IHJlcHJlc2VudGF0aW9uIG9mIHRoZSBnaXZlbiBBdG9tIHtSYW5nZX0uXHJcbiAgc3RhdGljIGF0b21SYW5nZVRvTFNSYW5nZShyYW5nZTogYXRvbSRSYW5nZSk6IGxzLlJhbmdlIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN0YXJ0OiBDb252ZXJ0LnBvaW50VG9Qb3NpdGlvbihyYW5nZS5zdGFydCksXHJcbiAgICAgIGVuZDogQ29udmVydC5wb2ludFRvUG9zaXRpb24ocmFuZ2UuZW5kKSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IENyZWF0ZSBhIHtUZXh0RG9jdW1lbnRJZGVudGlmaWVyfSBmcm9tIGFuIEF0b20ge1RleHRFZGl0b3J9LlxyXG4gIC8vXHJcbiAgLy8gKiBgZWRpdG9yYCBBIHtUZXh0RWRpdG9yfSB0aGF0IHdpbGwgYmUgdXNlZCB0byBmb3JtIHRoZSB1cmkgcHJvcGVydHkuXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGEge1RleHREb2N1bWVudElkZW50aWZpZXJ9IHRoYXQgaGFzIGEgYHVyaWAgcHJvcGVydHkgd2l0aCB0aGUgVXJpIGZvciB0aGVcclxuICAvLyBnaXZlbiBlZGl0b3IncyBwYXRoLlxyXG4gIHN0YXRpYyBlZGl0b3JUb1RleHREb2N1bWVudElkZW50aWZpZXIoZWRpdG9yOiBhdG9tJFRleHRFZGl0b3IpOiBscy5UZXh0RG9jdW1lbnRJZGVudGlmaWVyIHtcclxuICAgIHJldHVybiB7dXJpOiBDb252ZXJ0LnBhdGhUb1VyaShlZGl0b3IuZ2V0UGF0aCgpIHx8ICcnKX07XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IENyZWF0ZSBhIHtUZXh0RG9jdW1lbnRQb3NpdGlvblBhcmFtc30gZnJvbSBhIHtUZXh0RWRpdG9yfSBhbmQgb3B0aW9uYWwge1BvaW50fS5cclxuICAvL1xyXG4gIC8vICogYGVkaXRvcmAgQSB7VGV4dEVkaXRvcn0gdGhhdCB3aWxsIGJlIHVzZWQgdG8gZm9ybSB0aGUgdXJpIHByb3BlcnR5LlxyXG4gIC8vICogYHBvaW50YCAgQW4gb3B0aW9uYWwge1BvaW50fSB0aGF0IHdpbGwgc3VwcGx5IHRoZSBwb3NpdGlvbiBwcm9wZXJ0eS4gSWYgbm90IHNwZWNpZmllZFxyXG4gIC8vICAgICAgICAgICAgdGhlIGN1cnJlbnQgY3Vyc29yIHBvc2l0aW9uIHdpbGwgYmUgdXNlZC5cclxuICAvL1xyXG4gIC8vIFJldHVybnMgYSB7VGV4dERvY3VtZW50UG9zaXRpb25QYXJhbXN9IHRoYXQgaGFzIHRleHREb2N1bWVudCBwcm9wZXJ0eSB3aXRoIHRoZSBlZGl0b3JzIHtUZXh0RG9jdW1lbnRJZGVudGlmaWVyfVxyXG4gIC8vIGFuZCBhIHBvc2l0aW9uIHByb3BlcnR5IHdpdGggdGhlIHN1cHBsaWVkIHBvaW50IChvciBjdXJyZW50IGN1cnNvciBwb3NpdGlvbiB3aGVuIG5vdCBzcGVjaWZpZWQpLlxyXG4gIHN0YXRpYyBlZGl0b3JUb1RleHREb2N1bWVudFBvc2l0aW9uUGFyYW1zKFxyXG4gICAgZWRpdG9yOiBhdG9tJFRleHRFZGl0b3IsXHJcbiAgICBwb2ludDogP2F0b20kUG9pbnQsXHJcbiAgKTogbHMuVGV4dERvY3VtZW50UG9zaXRpb25QYXJhbXMge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdGV4dERvY3VtZW50OiBDb252ZXJ0LmVkaXRvclRvVGV4dERvY3VtZW50SWRlbnRpZmllcihlZGl0b3IpLFxyXG4gICAgICBwb3NpdGlvbjogQ29udmVydC5wb2ludFRvUG9zaXRpb24ocG9pbnQgIT0gbnVsbCA/IHBvaW50IDogZWRpdG9yLmdldEN1cnNvckJ1ZmZlclBvc2l0aW9uKCkpLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIC8vIFB1YmxpYzogQ3JlYXRlIGEgc3RyaW5nIG9mIHNjb3BlcyBmb3IgdGhlIGF0b20gdGV4dCBlZGl0b3IgdXNpbmcgdGhlIGRhdGEtZ3JhbW1hciBzZWxlY3RvciBmcm9tIGFuXHJcbiAgLy8ge0FycmF5fSBvZiBncmFtbWFyU2NvcGUgc3RyaW5ncy5cclxuICAvL1xyXG4gIC8vICogYGdyYW1tYXJTY29wZXNgIEFuIHtBcnJheX0gb2YgZ3JhbW1hciBzY29wZSBzdHJpbmcgdG8gY29udmVydCBmcm9tLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHNpbmdsZSBjb21tYS1zZXBhcmF0ZWQgbGlzdCBvZiBDU1Mgc2VsZWN0b3JzIHRhcmdldHRpbmcgdGhlIGdyYW1tYXJzIG9mIEF0b20gdGV4dCBlZGl0b3JzLlxyXG4gIC8vIGUuZy4gYFsnYycsICdjcHAnXWAgPT4gYCdhdG9tLXRleHQtZWRpdG9yW2RhdGEtZ3JhbW1hcj0nYyddLCBhdG9tLXRleHQtZWRpdG9yW2RhdGEtZ3JhbW1hcj0nY3BwJ11gXHJcbiAgc3RhdGljIGdyYW1tYXJTY29wZXNUb1RleHRFZGl0b3JTY29wZXMoZ3JhbW1hclNjb3BlczogQXJyYXk8c3RyaW5nPik6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gZ3JhbW1hclNjb3Blc1xyXG4gICAgICAubWFwKGcgPT4gYGF0b20tdGV4dC1lZGl0b3JbZGF0YS1ncmFtbWFyPVwiJHtDb252ZXJ0LmVuY29kZUhUTUxBdHRyaWJ1dGUoZy5yZXBsYWNlKC9cXC4vZywgJyAnKSl9XCJdYClcclxuICAgICAgLmpvaW4oJywgJyk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IEVuY29kZSBhIHN0cmluZyBzbyB0aGF0IGl0IGNhbiBiZSBzYWZlbHkgdXNlZCB3aXRoaW4gYSBIVE1MIGF0dHJpYnV0ZSAtIGkuZS4gcmVwbGFjaW5nIGFsbCBxdW90ZWRcclxuICAvLyB2YWx1ZXMgd2l0aCB0aGVpciBIVE1MIGVudGl0eSBlbmNvZGVkIHZlcnNpb25zLiAgZS5nLiBgSGVsbG9cImAgYmVjb21lcyBgSGVsbG8mcXVvdDtgXHJcbiAgLy9cclxuICAvLyAqICdzJyBBIHN0cmluZyB0byBiZSBlbmNvZGVkLlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhIHN0cmluZyB0aGF0IGlzIEhUTUwgYXR0cmlidXRlIGVuY29kZWQgYnkgcmVwbGFjaW5nICYsIDwsID4sIFwiIGFuZCAnIHdpdGggdGhlaXIgSFRNTCBlbnRpdHlcclxuICAvLyBuYW1lZCBlcXVpdmFsZW50cy5cclxuICBzdGF0aWMgZW5jb2RlSFRNTEF0dHJpYnV0ZShzOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgYXR0cmlidXRlTWFwID0ge1xyXG4gICAgICAnJic6ICcmYW1wOycsXHJcbiAgICAgICc8JzogJyZsdDsnLFxyXG4gICAgICAnPic6ICcmZ3Q7JyxcclxuICAgICAgJ1wiJzogJyZxdW90OycsXHJcbiAgICAgIFwiJ1wiOiAnJmFwb3M7JyxcclxuICAgIH07XHJcbiAgICByZXR1cm4gcy5yZXBsYWNlKC9bJjw+J1wiXS9nLCBjID0+IGF0dHJpYnV0ZU1hcFtjXSk7XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IENvbnZlcnQgYW4gQXRvbSBGaWxlIEV2ZW50IGFzIHJlY2VpdmVkIGZyb20gYXRvbS5wcm9qZWN0Lm9uRGlkQ2hhbmdlRmlsZXMgYW5kIGNvbnZlcnRcclxuICAvLyBpdCBpbnRvIGFuIEFycmF5IG9mIExhbmd1YWdlIFNlcnZlciBQcm90b2NvbCB7RmlsZUV2ZW50fSBvYmplY3RzLiBOb3JtYWxseSB0aGlzIHdpbGwgYmUgYSAxLXRvLTFcclxuICAvLyBidXQgcmVuYW1lcyB3aWxsIGJlIHJlcHJlc2VudGVkIGJ5IGEgZGVsZXRpb24gYW5kIGEgc3Vic2VxdWVudCBjcmVhdGlvbiBhcyBMU1AgZG9lcyBub3Qga25vdyBhYm91dFxyXG4gIC8vIHJlbmFtZXMuXHJcbiAgLy9cclxuICAvLyAqICdmaWxlRXZlbnQnIEFuIHthdG9tJFByb2plY3RGaWxlRXZlbnR9IHRvIGJlIGNvbnZlcnRlZC5cclxuICAvL1xyXG4gIC8vIFJldHVybnMgYW4gYXJyYXkgb2YgTFNQIHtscy5GaWxlRXZlbnR9IG9iamVjdHMgdGhhdCBlcXVpdmFsZW50IGNvbnZlcnNpb25zIHRvIHRoZSBmaWxlRXZlbnQgcGFyYW1ldGVyLlxyXG4gIHN0YXRpYyBhdG9tRmlsZUV2ZW50VG9MU0ZpbGVFdmVudHMoZmlsZUV2ZW50OiBhdG9tJFByb2plY3RGaWxlRXZlbnQpOiBscy5GaWxlRXZlbnRbXSB7XHJcbiAgICBzd2l0Y2ggKGZpbGVFdmVudC5hY3Rpb24pIHtcclxuICAgICAgY2FzZSAnY3JlYXRlZCc6XHJcbiAgICAgICAgcmV0dXJuIFt7dXJpOiBDb252ZXJ0LnBhdGhUb1VyaShmaWxlRXZlbnQucGF0aCksIHR5cGU6IGxzLkZpbGVDaGFuZ2VUeXBlLkNyZWF0ZWR9XTtcclxuICAgICAgY2FzZSAnbW9kaWZpZWQnOlxyXG4gICAgICAgIHJldHVybiBbe3VyaTogQ29udmVydC5wYXRoVG9VcmkoZmlsZUV2ZW50LnBhdGgpLCB0eXBlOiBscy5GaWxlQ2hhbmdlVHlwZS5DaGFuZ2VkfV07XHJcbiAgICAgIGNhc2UgJ2RlbGV0ZWQnOlxyXG4gICAgICAgIHJldHVybiBbe3VyaTogQ29udmVydC5wYXRoVG9VcmkoZmlsZUV2ZW50LnBhdGgpLCB0eXBlOiBscy5GaWxlQ2hhbmdlVHlwZS5EZWxldGVkfV07XHJcbiAgICAgIGNhc2UgJ3JlbmFtZWQnOiB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IFtdO1xyXG4gICAgICAgIGlmIChmaWxlRXZlbnQub2xkUGF0aCkge1xyXG4gICAgICAgICAgcmVzdWx0cy5wdXNoKHt1cmk6IENvbnZlcnQucGF0aFRvVXJpKGZpbGVFdmVudC5vbGRQYXRoIHx8ICcnKSwgdHlwZTogbHMuRmlsZUNoYW5nZVR5cGUuRGVsZXRlZH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZmlsZUV2ZW50LnBhdGgpIHtcclxuICAgICAgICAgIHJlc3VsdHMucHVzaCh7dXJpOiBDb252ZXJ0LnBhdGhUb1VyaShmaWxlRXZlbnQucGF0aCksIHR5cGU6IGxzLkZpbGVDaGFuZ2VUeXBlLkNyZWF0ZWR9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgICAgIH1cclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgYXRvbUlkZURpYWdub3N0aWNUb0xTRGlhZ25vc3RpYyhkaWFnbm9zdGljOiBhdG9tSWRlJERpYWdub3N0aWMpOiBscy5EaWFnbm9zdGljIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHJhbmdlOiBDb252ZXJ0LmF0b21SYW5nZVRvTFNSYW5nZShkaWFnbm9zdGljLnJhbmdlKSxcclxuICAgICAgc2V2ZXJpdHk6IENvbnZlcnQuZGlhZ25vc3RpY1R5cGVUb0xTU2V2ZXJpdHkoZGlhZ25vc3RpYy50eXBlKSxcclxuICAgICAgc291cmNlOiBkaWFnbm9zdGljLnByb3ZpZGVyTmFtZSxcclxuICAgICAgbWVzc2FnZTogZGlhZ25vc3RpYy50ZXh0IHx8ICcnLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBkaWFnbm9zdGljVHlwZVRvTFNTZXZlcml0eSh0eXBlOiBhdG9tSWRlJERpYWdub3N0aWNUeXBlKTogJFZhbHVlczx0eXBlb2YgbHMuRGlhZ25vc3RpY1NldmVyaXR5PiB7XHJcbiAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgY2FzZSAnRXJyb3InOlxyXG4gICAgICAgIHJldHVybiBscy5EaWFnbm9zdGljU2V2ZXJpdHkuRXJyb3I7XHJcbiAgICAgIGNhc2UgJ1dhcm5pbmcnOlxyXG4gICAgICAgIHJldHVybiBscy5EaWFnbm9zdGljU2V2ZXJpdHkuV2FybmluZztcclxuICAgICAgY2FzZSAnSW5mbyc6XHJcbiAgICAgICAgcmV0dXJuIGxzLkRpYWdub3N0aWNTZXZlcml0eS5JbmZvcm1hdGlvbjtcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICAodHlwZTogZW1wdHkpO1xyXG4gICAgICAgIHRocm93IEVycm9yKGBVbmV4cGVjdGVkIGRpYWdub3N0aWMgdHlwZSAke3R5cGV9YCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBQdWJsaWM6IENvbnZlcnQgYW4gYXJyYXkgb2YgbGFuZ3VhZ2Ugc2VydmVyIHByb3RvY29sIHtUZXh0RWRpdH0gb2JqZWN0cyB0byBhblxyXG4gIC8vIGVxdWl2YWxlbnQgYXJyYXkgb2YgQXRvbSB7VGV4dEVkaXR9IG9iamVjdHMuXHJcbiAgLy9cclxuICAvLyAqIGB0ZXh0RWRpdHNgIFRoZSBsYW5ndWFnZSBzZXJ2ZXIgcHJvdG9jb2wge1RleHRFZGl0fSBvYmplY3RzIHRvIGNvbnZlcnQuXHJcbiAgLy9cclxuICAvLyBSZXR1cm5zIGFuIHtBcnJheX0gb2YgQXRvbSB7VGV4dEVkaXR9IG9iamVjdHMuXHJcbiAgc3RhdGljIGNvbnZlcnRMc1RleHRFZGl0cyh0ZXh0RWRpdHM6ID9BcnJheTxscy5UZXh0RWRpdD4pOiBBcnJheTxhdG9tSWRlJFRleHRFZGl0PiB7XHJcbiAgICByZXR1cm4gKHRleHRFZGl0cyB8fCBbXSkubWFwKENvbnZlcnQuY29udmVydExzVGV4dEVkaXQpO1xyXG4gIH1cclxuXHJcbiAgLy8gUHVibGljOiBDb252ZXJ0IGEgbGFuZ3VhZ2Ugc2VydmVyIHByb3RvY29sIHtUZXh0RWRpdH0gb2JqZWN0IHRvIHRoZVxyXG4gIC8vIEF0b20gZXF1aXZhbGVudCB7VGV4dEVkaXR9LlxyXG4gIC8vXHJcbiAgLy8gKiBgdGV4dEVkaXRzYCBUaGUgbGFuZ3VhZ2Ugc2VydmVyIHByb3RvY29sIHtUZXh0RWRpdH0gb2JqZWN0cyB0byBjb252ZXJ0LlxyXG4gIC8vXHJcbiAgLy8gUmV0dXJucyBhbiBBdG9tIHtUZXh0RWRpdH0gb2JqZWN0LlxyXG4gIHN0YXRpYyBjb252ZXJ0THNUZXh0RWRpdCh0ZXh0RWRpdDogbHMuVGV4dEVkaXQpOiBhdG9tSWRlJFRleHRFZGl0IHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG9sZFJhbmdlOiBDb252ZXJ0LmxzUmFuZ2VUb0F0b21SYW5nZSh0ZXh0RWRpdC5yYW5nZSksXHJcbiAgICAgIG5ld1RleHQ6IHRleHRFZGl0Lm5ld1RleHQsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG4iXX0=