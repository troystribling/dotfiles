var _outlineViewAdapter = require('../../lib/adapters/outline-view-adapter');

var _outlineViewAdapter2 = _interopRequireDefault(_outlineViewAdapter);

var _languageclient = require('../../lib/languageclient');

var ls = _interopRequireWildcard(_languageclient);

var _sinon = require('sinon');

var _sinon2 = _interopRequireDefault(_sinon);

var _chai = require('chai');

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

describe('OutlineViewAdapter', () => {
  const createLocation = (a, b, c, d) => ({
    uri: '',
    range: { start: { line: a, character: b }, end: { line: c, character: d } }
  });

  beforeEach(() => {
    global.sinon = _sinon2.default.sandbox.create();
  });
  afterEach(() => {
    global.sinon.restore();
  });

  describe('canAdapt', () => {
    it('returns true if documentSymbolProvider is supported', () => {
      const result = _outlineViewAdapter2.default.canAdapt({ documentSymbolProvider: true });
      (0, _chai.expect)(result).to.be.true;
    });

    it('returns false if documentSymbolProvider not supported', () => {
      const result = _outlineViewAdapter2.default.canAdapt({});
      (0, _chai.expect)(result).to.be.false;
    });
  });

  describe('createOutlineTrees', () => {
    it('creates an empty array given an empty array', () => {
      const result = _outlineViewAdapter2.default.createOutlineTrees([]);
      (0, _chai.expect)(result).to.deep.equal([]);
    });

    it('creates a single converted root item from a single source item', () => {
      const sourceItem = { kind: ls.SymbolKind.Namespace, name: 'R', location: createLocation(5, 6, 7, 8) };
      const expected = _outlineViewAdapter2.default.symbolToOutline(sourceItem);
      const result = _outlineViewAdapter2.default.createOutlineTrees([sourceItem]);
      (0, _chai.expect)(result).to.deep.equal([expected]);
    });

    it('creates an empty root container with a single source item when containerName missing', () => {
      const sourceItem = {
        kind: ls.SymbolKind.Class,
        name: 'Program',
        location: createLocation(1, 2, 3, 4)
      };
      const expected = _outlineViewAdapter2.default.symbolToOutline(sourceItem);
      sourceItem.containerName = 'missing';
      const result = _outlineViewAdapter2.default.createOutlineTrees([sourceItem]);
      (0, _chai.expect)(result.length).to.equal(1);
      (0, _chai.expect)(result[0].representativeName).to.equal('missing');
      (0, _chai.expect)(result[0].startPosition.row).to.equal(0);
      (0, _chai.expect)(result[0].startPosition.column).to.equal(0);
      (0, _chai.expect)(result[0].children).to.deep.equal([expected]);
    });

    it('creates an empty root container with a single source item when containerName is missing and matches own name', () => {
      const sourceItem = {
        kind: ls.SymbolKind.Class,
        name: 'simple',
        location: createLocation(1, 2, 3, 4)
      };
      const expected = _outlineViewAdapter2.default.symbolToOutline(sourceItem);
      sourceItem.containerName = 'simple';
      const result = _outlineViewAdapter2.default.createOutlineTrees([sourceItem]);
      (0, _chai.expect)(result.length).to.equal(1);
      (0, _chai.expect)(result[0].representativeName).to.equal('simple');
      (0, _chai.expect)(result[0].startPosition.row).to.equal(0);
      (0, _chai.expect)(result[0].startPosition.column).to.equal(0);
      (0, _chai.expect)(result[0].children).to.deep.equal([expected]);
    });

    it('creates a simple named hierarchy', () => {
      const sourceItems = [{ kind: ls.SymbolKind.Namespace, name: 'java.com', location: createLocation(1, 0, 10, 0) }, { kind: ls.SymbolKind.Class, name: 'Program', location: createLocation(2, 0, 7, 0), containerName: 'java.com' }, { kind: ls.SymbolKind.Function, name: 'main', location: createLocation(4, 0, 5, 0), containerName: 'Program' }];
      const result = _outlineViewAdapter2.default.createOutlineTrees(sourceItems);
      (0, _chai.expect)(result.length).to.equal(1);
      (0, _chai.expect)(result[0].children.length).to.equal(1);
      (0, _chai.expect)(result[0].children[0].representativeName).to.equal('Program');
      (0, _chai.expect)(result[0].children[0].children.length).to.equal(1);
      (0, _chai.expect)(result[0].children[0].children[0].representativeName).to.equal('main');
    });

    it('retains duplicate named items', () => {
      const sourceItems = [{ kind: ls.SymbolKind.Namespace, name: 'duplicate', location: createLocation(1, 0, 5, 0) }, { kind: ls.SymbolKind.Namespace, name: 'duplicate', location: createLocation(6, 0, 10, 0) }, { kind: ls.SymbolKind.Function, name: 'main', location: createLocation(7, 0, 8, 0), containerName: 'duplicate' }];
      const result = _outlineViewAdapter2.default.createOutlineTrees(sourceItems);
      (0, _chai.expect)(result.length).to.equal(2);
      (0, _chai.expect)(result[0].representativeName).to.equal('duplicate');
      (0, _chai.expect)(result[1].representativeName).to.equal('duplicate');
    });

    it('disambiguates containerName based on range', () => {
      const sourceItems = [{ kind: ls.SymbolKind.Namespace, name: 'duplicate', location: createLocation(1, 0, 5, 0) }, { kind: ls.SymbolKind.Namespace, name: 'duplicate', location: createLocation(6, 0, 10, 0) }, { kind: ls.SymbolKind.Function, name: 'main', location: createLocation(7, 0, 8, 0), containerName: 'duplicate' }];
      const result = _outlineViewAdapter2.default.createOutlineTrees(sourceItems);
      (0, _chai.expect)(result[1].children.length).to.equal(1);
      (0, _chai.expect)(result[1].children[0].representativeName).to.equal('main');
    });

    it("does not become it's own parent", () => {
      const sourceItems = [{ kind: ls.SymbolKind.Namespace, name: 'duplicate', location: createLocation(1, 0, 10, 0) }, {
        kind: ls.SymbolKind.Namespace,
        name: 'duplicate',
        location: createLocation(6, 0, 7, 0),
        containerName: 'duplicate'
      }];
      const result = _outlineViewAdapter2.default.createOutlineTrees(sourceItems);
      (0, _chai.expect)(result.length).to.equal(1);
      const r = result;
      (0, _chai.expect)(r[0].endPosition.row).to.equal(10);
      (0, _chai.expect)(r[0].children.length).to.equal(1);
      (0, _chai.expect)(r[0].children[0].endPosition.row).to.equal(7);
    });

    it('parents to the innnermost named container', () => {
      const sourceItems = [{ kind: ls.SymbolKind.Namespace, name: 'turtles', location: createLocation(1, 0, 10, 0) }, {
        kind: ls.SymbolKind.Namespace,
        name: 'turtles',
        location: createLocation(4, 0, 8, 0),
        containerName: 'turtles'
      }, { kind: ls.SymbolKind.Class, name: 'disc', location: createLocation(4, 0, 5, 0), containerName: 'turtles' }];
      const result = _outlineViewAdapter2.default.createOutlineTrees(sourceItems);
      (0, _chai.expect)(result.length).to.equal(1);
      const r = result;
      (0, _chai.expect)(r[0].endPosition.row).to.equal(10);
      (0, _chai.expect)(r[0].children.length).to.equal(1);
      (0, _chai.expect)(r[0].children[0].endPosition.row).to.equal(8);
      (0, _chai.expect)(r[0].children[0].children.length).to.equal(1);
      (0, _chai.expect)(r[0].children[0].children[0].endPosition.row).to.equal(5);
    });
  });

  describe('symbolToOutline', () => {
    it('converts an individual item', () => {
      const sourceItem = { kind: ls.SymbolKind.Class, name: 'Program', location: createLocation(1, 2, 3, 4) };
      const result = _outlineViewAdapter2.default.symbolToOutline(sourceItem);
      (0, _chai.expect)(result.icon).to.equal('type-class');
      (0, _chai.expect)(result.representativeName).to.equal('Program');
      (0, _chai.expect)(result.children).to.deep.equal([]);
      const r = result;
      (0, _chai.expect)(r.tokenizedText[0].kind).to.equal('type');
      (0, _chai.expect)(r.tokenizedText[0].value).to.equal('Program');
      (0, _chai.expect)(r.startPosition.row).to.equal(1);
      (0, _chai.expect)(r.startPosition.column).to.equal(2);
      (0, _chai.expect)(r.endPosition.row).to.equal(3);
      (0, _chai.expect)(r.endPosition.column).to.equal(4);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3Rlc3QvYWRhcHRlcnMvb3V0bGluZS12aWV3LWFkYXB0ZXIudGVzdC5qcyJdLCJuYW1lcyI6WyJscyIsImRlc2NyaWJlIiwiY3JlYXRlTG9jYXRpb24iLCJhIiwiYiIsImMiLCJkIiwidXJpIiwicmFuZ2UiLCJzdGFydCIsImxpbmUiLCJjaGFyYWN0ZXIiLCJlbmQiLCJiZWZvcmVFYWNoIiwiZ2xvYmFsIiwic2lub24iLCJzYW5kYm94IiwiY3JlYXRlIiwiYWZ0ZXJFYWNoIiwicmVzdG9yZSIsIml0IiwicmVzdWx0IiwiY2FuQWRhcHQiLCJkb2N1bWVudFN5bWJvbFByb3ZpZGVyIiwidG8iLCJiZSIsInRydWUiLCJmYWxzZSIsImNyZWF0ZU91dGxpbmVUcmVlcyIsImRlZXAiLCJlcXVhbCIsInNvdXJjZUl0ZW0iLCJraW5kIiwiU3ltYm9sS2luZCIsIk5hbWVzcGFjZSIsIm5hbWUiLCJsb2NhdGlvbiIsImV4cGVjdGVkIiwic3ltYm9sVG9PdXRsaW5lIiwiQ2xhc3MiLCJjb250YWluZXJOYW1lIiwibGVuZ3RoIiwicmVwcmVzZW50YXRpdmVOYW1lIiwic3RhcnRQb3NpdGlvbiIsInJvdyIsImNvbHVtbiIsImNoaWxkcmVuIiwic291cmNlSXRlbXMiLCJGdW5jdGlvbiIsInIiLCJlbmRQb3NpdGlvbiIsImljb24iLCJ0b2tlbml6ZWRUZXh0IiwidmFsdWUiXSwibWFwcGluZ3MiOiJBQUVBOzs7O0FBQ0E7O0lBQVlBLEU7O0FBQ1o7Ozs7QUFDQTs7Ozs7O0FBRUFDLFNBQVMsb0JBQVQsRUFBK0IsTUFBTTtBQUNuQyxRQUFNQyxpQkFBaUIsQ0FBQ0MsQ0FBRCxFQUFJQyxDQUFKLEVBQU9DLENBQVAsRUFBVUMsQ0FBVixNQUFpQjtBQUN0Q0MsU0FBSyxFQURpQztBQUV0Q0MsV0FBTyxFQUFDQyxPQUFPLEVBQUNDLE1BQU1QLENBQVAsRUFBVVEsV0FBV1AsQ0FBckIsRUFBUixFQUFpQ1EsS0FBSyxFQUFDRixNQUFNTCxDQUFQLEVBQVVNLFdBQVdM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bUJpQixlQUFuQixDQUFtQ1AsVUFBbkMsQ0FBZjtBQUNBLHdCQUFPVixPQUFPOEIsSUFBZCxFQUFvQjNCLEVBQXBCLENBQXVCTSxLQUF2QixDQUE2QixZQUE3QjtBQUNBLHdCQUFPVCxPQUFPcUIsa0JBQWQsRUFBa0NsQixFQUFsQyxDQUFxQ00sS0FBckMsQ0FBMkMsU0FBM0M7QUFDQSx3QkFBT1QsT0FBT3lCLFFBQWQsRUFBd0J0QixFQUF4QixDQUEyQkssSUFBM0IsQ0FBZ0NDLEtBQWhDLENBQXNDLEVBQXRDO0FBQ0EsWUFBTW1CLElBQUs1QixNQUFYO0FBQ0Esd0JBQU80QixFQUFFRyxhQUFGLENBQWdCLENBQWhCLEVBQW1CcEIsSUFBMUIsRUFBZ0NSLEVBQWhDLENBQW1DTSxLQUFuQyxDQUF5QyxNQUF6QztBQUNBLHdCQUFPbUIsRUFBRUcsYUFBRixDQUFnQixDQUFoQixFQUFtQkMsS0FBMUIsRUFBaUM3QixFQUFqQyxDQUFvQ00sS0FBcEMsQ0FBMEMsU0FBMUM7QUFDQSx3QkFBT21CLEVBQUVOLGFBQUYsQ0FBZ0JDLEdBQXZCLEVBQTRCcEIsRUFBNUIsQ0FBK0JNLEtBQS9CLENBQXFDLENBQXJDO0FBQ0Esd0JBQU9tQixFQUFFTixhQUFGLENBQWdCRSxNQUF2QixFQUErQnJCLEVBQS9CLENBQWtDTSxLQUFsQyxDQUF3QyxDQUF4QztBQUNBLHdCQUFPbUIsRUFBRUMsV0FBRixDQUFjTixHQUFyQixFQUEwQnBCLEVBQTFCLENBQTZCTSxLQUE3QixDQUFtQyxDQUFuQztBQUNBLHdCQUFPbUIsRUFBRUMsV0FBRixDQUFjTCxNQUFyQixFQUE2QnJCLEVBQTdCLENBQWdDTSxLQUFoQyxDQUFzQyxDQUF0QztBQUNELEtBYkQ7QUFjRCxHQWZEO0FBZ0JELENBbktEIiwiZmlsZSI6Im91dGxpbmUtdmlldy1hZGFwdGVyLnRlc3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAZmxvd1xyXG5cclxuaW1wb3J0IE91dGxpbmVWaWV3QWRhcHRlciBmcm9tICcuLi8uLi9saWIvYWRhcHRlcnMvb3V0bGluZS12aWV3LWFkYXB0ZXInO1xyXG5pbXBvcnQgKiBhcyBscyBmcm9tICcuLi8uLi9saWIvbGFuZ3VhZ2VjbGllbnQnO1xyXG5pbXBvcnQgc2lub24gZnJvbSAnc2lub24nO1xyXG5pbXBvcnQge2V4cGVjdH0gZnJvbSAnY2hhaSc7XHJcblxyXG5kZXNjcmliZSgnT3V0bGluZVZpZXdBZGFwdGVyJywgKCkgPT4ge1xyXG4gIGNvbnN0IGNyZWF0ZUxvY2F0aW9uID0gKGEsIGIsIGMsIGQpID0+ICh7XHJcbiAgICB1cmk6ICcnLFxyXG4gICAgcmFuZ2U6IHtzdGFydDoge2xpbmU6IGEsIGNoYXJhY3RlcjogYn0sIGVuZDoge2xpbmU6IGMsIGNoYXJhY3RlcjogZH19LFxyXG4gIH0pO1xyXG5cclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIGdsb2JhbC5zaW5vbiA9IHNpbm9uLnNhbmRib3guY3JlYXRlKCk7XHJcbiAgfSk7XHJcbiAgYWZ0ZXJFYWNoKCgpID0+IHtcclxuICAgIGdsb2JhbC5zaW5vbi5yZXN0b3JlKCk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdjYW5BZGFwdCcsICgpID0+IHtcclxuICAgIGl0KCdyZXR1cm5zIHRydWUgaWYgZG9jdW1lbnRTeW1ib2xQcm92aWRlciBpcyBzdXBwb3J0ZWQnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IE91dGxpbmVWaWV3QWRhcHRlci5jYW5BZGFwdCh7ZG9jdW1lbnRTeW1ib2xQcm92aWRlcjogdHJ1ZX0pO1xyXG4gICAgICBleHBlY3QocmVzdWx0KS50by5iZS50cnVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3JldHVybnMgZmFsc2UgaWYgZG9jdW1lbnRTeW1ib2xQcm92aWRlciBub3Qgc3VwcG9ydGVkJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBPdXRsaW5lVmlld0FkYXB0ZXIuY2FuQWRhcHQoe30pO1xyXG4gICAgICBleHBlY3QocmVzdWx0KS50by5iZS5mYWxzZTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnY3JlYXRlT3V0bGluZVRyZWVzJywgKCkgPT4ge1xyXG4gICAgaXQoJ2NyZWF0ZXMgYW4gZW1wdHkgYXJyYXkgZ2l2ZW4gYW4gZW1wdHkgYXJyYXknLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IE91dGxpbmVWaWV3QWRhcHRlci5jcmVhdGVPdXRsaW5lVHJlZXMoW10pO1xyXG4gICAgICBleHBlY3QocmVzdWx0KS50by5kZWVwLmVxdWFsKFtdKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdjcmVhdGVzIGEgc2luZ2xlIGNvbnZlcnRlZCByb290IGl0ZW0gZnJvbSBhIHNpbmdsZSBzb3VyY2UgaXRlbScsICgpID0+IHtcclxuICAgICAgY29uc3Qgc291cmNlSXRlbSA9IHtraW5kOiBscy5TeW1ib2xLaW5kLk5hbWVzcGFjZSwgbmFtZTogJ1InLCBsb2NhdGlvbjogY3JlYXRlTG9jYXRpb24oNSwgNiwgNywgOCl9O1xyXG4gICAgICBjb25zdCBleHBlY3RlZCA9IE91dGxpbmVWaWV3QWRhcHRlci5zeW1ib2xUb091dGxpbmUoc291cmNlSXRlbSk7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IE91dGxpbmVWaWV3QWRhcHRlci5jcmVhdGVPdXRsaW5lVHJlZXMoW3NvdXJjZUl0ZW1dKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdCkudG8uZGVlcC5lcXVhbChbZXhwZWN0ZWRdKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdjcmVhdGVzIGFuIGVtcHR5IHJvb3QgY29udGFpbmVyIHdpdGggYSBzaW5nbGUgc291cmNlIGl0ZW0gd2hlbiBjb250YWluZXJOYW1lIG1pc3NpbmcnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHNvdXJjZUl0ZW06IGxzLlN5bWJvbEluZm9ybWF0aW9uID0ge1xyXG4gICAgICAgIGtpbmQ6IGxzLlN5bWJvbEtpbmQuQ2xhc3MsXHJcbiAgICAgICAgbmFtZTogJ1Byb2dyYW0nLFxyXG4gICAgICAgIGxvY2F0aW9uOiBjcmVhdGVMb2NhdGlvbigxLCAyLCAzLCA0KSxcclxuICAgICAgfTtcclxuICAgICAgY29uc3QgZXhwZWN0ZWQgPSBPdXRsaW5lVmlld0FkYXB0ZXIuc3ltYm9sVG9PdXRsaW5lKHNvdXJjZUl0ZW0pO1xyXG4gICAgICBzb3VyY2VJdGVtLmNvbnRhaW5lck5hbWUgPSAnbWlzc2luZyc7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IE91dGxpbmVWaWV3QWRhcHRlci5jcmVhdGVPdXRsaW5lVHJlZXMoW3NvdXJjZUl0ZW1dKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5sZW5ndGgpLnRvLmVxdWFsKDEpO1xyXG4gICAgICBleHBlY3QocmVzdWx0WzBdLnJlcHJlc2VudGF0aXZlTmFtZSkudG8uZXF1YWwoJ21pc3NpbmcnKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdFswXS5zdGFydFBvc2l0aW9uLnJvdykudG8uZXF1YWwoMCk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHRbMF0uc3RhcnRQb3NpdGlvbi5jb2x1bW4pLnRvLmVxdWFsKDApO1xyXG4gICAgICBleHBlY3QocmVzdWx0WzBdLmNoaWxkcmVuKS50by5kZWVwLmVxdWFsKFtleHBlY3RlZF0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ2NyZWF0ZXMgYW4gZW1wdHkgcm9vdCBjb250YWluZXIgd2l0aCBhIHNpbmdsZSBzb3VyY2UgaXRlbSB3aGVuIGNvbnRhaW5lck5hbWUgaXMgbWlzc2luZyBhbmQgbWF0Y2hlcyBvd24gbmFtZScsICgpID0+IHtcclxuICAgICAgY29uc3Qgc291cmNlSXRlbTogbHMuU3ltYm9sSW5mb3JtYXRpb24gPSB7XHJcbiAgICAgICAga2luZDogbHMuU3ltYm9sS2luZC5DbGFzcyxcclxuICAgICAgICBuYW1lOiAnc2ltcGxlJyxcclxuICAgICAgICBsb2NhdGlvbjogY3JlYXRlTG9jYXRpb24oMSwgMiwgMywgNCksXHJcbiAgICAgIH07XHJcbiAgICAgIGNvbnN0IGV4cGVjdGVkID0gT3V0bGluZVZpZXdBZGFwdGVyLnN5bWJvbFRvT3V0bGluZShzb3VyY2VJdGVtKTtcclxuICAgICAgc291cmNlSXRlbS5jb250YWluZXJOYW1lID0gJ3NpbXBsZSc7XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IE91dGxpbmVWaWV3QWRhcHRlci5jcmVhdGVPdXRsaW5lVHJlZXMoW3NvdXJjZUl0ZW1dKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5sZW5ndGgpLnRvLmVxdWFsKDEpO1xyXG4gICAgICBleHBlY3QocmVzdWx0WzBdLnJlcHJlc2VudGF0aXZlTmFtZSkudG8uZXF1YWwoJ3NpbXBsZScpO1xyXG4gICAgICBleHBlY3QocmVzdWx0WzBdLnN0YXJ0UG9zaXRpb24ucm93KS50by5lcXVhbCgwKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdFswXS5zdGFydFBvc2l0aW9uLmNvbHVtbikudG8uZXF1YWwoMCk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHRbMF0uY2hpbGRyZW4pLnRvLmRlZXAuZXF1YWwoW2V4cGVjdGVkXSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnY3JlYXRlcyBhIHNpbXBsZSBuYW1lZCBoaWVyYXJjaHknLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHNvdXJjZUl0ZW1zID0gW1xyXG4gICAgICAgIHtraW5kOiBscy5TeW1ib2xLaW5kLk5hbWVzcGFjZSwgbmFtZTogJ2phdmEuY29tJywgbG9jYXRpb246IGNyZWF0ZUxvY2F0aW9uKDEsIDAsIDEwLCAwKX0sXHJcbiAgICAgICAge2tpbmQ6IGxzLlN5bWJvbEtpbmQuQ2xhc3MsIG5hbWU6ICdQcm9ncmFtJywgbG9jYXRpb246IGNyZWF0ZUxvY2F0aW9uKDIsIDAsIDcsIDApLCBjb250YWluZXJOYW1lOiAnamF2YS5jb20nfSxcclxuICAgICAgICB7a2luZDogbHMuU3ltYm9sS2luZC5GdW5jdGlvbiwgbmFtZTogJ21haW4nLCBsb2NhdGlvbjogY3JlYXRlTG9jYXRpb24oNCwgMCwgNSwgMCksIGNvbnRhaW5lck5hbWU6ICdQcm9ncmFtJ30sXHJcbiAgICAgIF07XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IE91dGxpbmVWaWV3QWRhcHRlci5jcmVhdGVPdXRsaW5lVHJlZXMoc291cmNlSXRlbXMpO1xyXG4gICAgICBleHBlY3QocmVzdWx0Lmxlbmd0aCkudG8uZXF1YWwoMSk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHRbMF0uY2hpbGRyZW4ubGVuZ3RoKS50by5lcXVhbCgxKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdFswXS5jaGlsZHJlblswXS5yZXByZXNlbnRhdGl2ZU5hbWUpLnRvLmVxdWFsKCdQcm9ncmFtJyk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHRbMF0uY2hpbGRyZW5bMF0uY2hpbGRyZW4ubGVuZ3RoKS50by5lcXVhbCgxKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdFswXS5jaGlsZHJlblswXS5jaGlsZHJlblswXS5yZXByZXNlbnRhdGl2ZU5hbWUpLnRvLmVxdWFsKCdtYWluJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgncmV0YWlucyBkdXBsaWNhdGUgbmFtZWQgaXRlbXMnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHNvdXJjZUl0ZW1zID0gW1xyXG4gICAgICAgIHtraW5kOiBscy5TeW1ib2xLaW5kLk5hbWVzcGFjZSwgbmFtZTogJ2R1cGxpY2F0ZScsIGxvY2F0aW9uOiBjcmVhdGVMb2NhdGlvbigxLCAwLCA1LCAwKX0sXHJcbiAgICAgICAge2tpbmQ6IGxzLlN5bWJvbEtpbmQuTmFtZXNwYWNlLCBuYW1lOiAnZHVwbGljYXRlJywgbG9jYXRpb246IGNyZWF0ZUxvY2F0aW9uKDYsIDAsIDEwLCAwKX0sXHJcbiAgICAgICAge2tpbmQ6IGxzLlN5bWJvbEtpbmQuRnVuY3Rpb24sIG5hbWU6ICdtYWluJywgbG9jYXRpb246IGNyZWF0ZUxvY2F0aW9uKDcsIDAsIDgsIDApLCBjb250YWluZXJOYW1lOiAnZHVwbGljYXRlJ30sXHJcbiAgICAgIF07XHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IE91dGxpbmVWaWV3QWRhcHRlci5jcmVhdGVPdXRsaW5lVHJlZXMoc291cmNlSXRlbXMpO1xyXG4gICAgICBleHBlY3QocmVzdWx0Lmxlbmd0aCkudG8uZXF1YWwoMik7XHJcbiAgICAgIGV4cGVjdChyZXN1bHRbMF0ucmVwcmVzZW50YXRpdmVOYW1lKS50by5lcXVhbCgnZHVwbGljYXRlJyk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHRbMV0ucmVwcmVzZW50YXRpdmVOYW1lKS50by5lcXVhbCgnZHVwbGljYXRlJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnZGlzYW1iaWd1YXRlcyBjb250YWluZXJOYW1lIGJhc2VkIG9uIHJhbmdlJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBzb3VyY2VJdGVtcyA9IFtcclxuICAgICAgICB7a2luZDogbHMuU3ltYm9sS2luZC5OYW1lc3BhY2UsIG5hbWU6ICdkdXBsaWNhdGUnLCBsb2NhdGlvbjogY3JlYXRlTG9jYXRpb24oMSwgMCwgNSwgMCl9LFxyXG4gICAgICAgIHtraW5kOiBscy5TeW1ib2xLaW5kLk5hbWVzcGFjZSwgbmFtZTogJ2R1cGxpY2F0ZScsIGxvY2F0aW9uOiBjcmVhdGVMb2NhdGlvbig2LCAwLCAxMCwgMCl9LFxyXG4gICAgICAgIHtraW5kOiBscy5TeW1ib2xLaW5kLkZ1bmN0aW9uLCBuYW1lOiAnbWFpbicsIGxvY2F0aW9uOiBjcmVhdGVMb2NhdGlvbig3LCAwLCA4LCAwKSwgY29udGFpbmVyTmFtZTogJ2R1cGxpY2F0ZSd9LFxyXG4gICAgICBdO1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBPdXRsaW5lVmlld0FkYXB0ZXIuY3JlYXRlT3V0bGluZVRyZWVzKHNvdXJjZUl0ZW1zKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdFsxXS5jaGlsZHJlbi5sZW5ndGgpLnRvLmVxdWFsKDEpO1xyXG4gICAgICBleHBlY3QocmVzdWx0WzFdLmNoaWxkcmVuWzBdLnJlcHJlc2VudGF0aXZlTmFtZSkudG8uZXF1YWwoJ21haW4nKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KFwiZG9lcyBub3QgYmVjb21lIGl0J3Mgb3duIHBhcmVudFwiLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHNvdXJjZUl0ZW1zID0gW1xyXG4gICAgICAgIHtraW5kOiBscy5TeW1ib2xLaW5kLk5hbWVzcGFjZSwgbmFtZTogJ2R1cGxpY2F0ZScsIGxvY2F0aW9uOiBjcmVhdGVMb2NhdGlvbigxLCAwLCAxMCwgMCl9LFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGtpbmQ6IGxzLlN5bWJvbEtpbmQuTmFtZXNwYWNlLFxyXG4gICAgICAgICAgbmFtZTogJ2R1cGxpY2F0ZScsXHJcbiAgICAgICAgICBsb2NhdGlvbjogY3JlYXRlTG9jYXRpb24oNiwgMCwgNywgMCksXHJcbiAgICAgICAgICBjb250YWluZXJOYW1lOiAnZHVwbGljYXRlJyxcclxuICAgICAgICB9LFxyXG4gICAgICBdO1xyXG4gICAgICBjb25zdCByZXN1bHQgPSBPdXRsaW5lVmlld0FkYXB0ZXIuY3JlYXRlT3V0bGluZVRyZWVzKHNvdXJjZUl0ZW1zKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5sZW5ndGgpLnRvLmVxdWFsKDEpO1xyXG4gICAgICBjb25zdCByID0gKHJlc3VsdDogYW55KTtcclxuICAgICAgZXhwZWN0KHJbMF0uZW5kUG9zaXRpb24ucm93KS50by5lcXVhbCgxMCk7XHJcbiAgICAgIGV4cGVjdChyWzBdLmNoaWxkcmVuLmxlbmd0aCkudG8uZXF1YWwoMSk7XHJcbiAgICAgIGV4cGVjdChyWzBdLmNoaWxkcmVuWzBdLmVuZFBvc2l0aW9uLnJvdykudG8uZXF1YWwoNyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgncGFyZW50cyB0byB0aGUgaW5ubmVybW9zdCBuYW1lZCBjb250YWluZXInLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHNvdXJjZUl0ZW1zID0gW1xyXG4gICAgICAgIHtraW5kOiBscy5TeW1ib2xLaW5kLk5hbWVzcGFjZSwgbmFtZTogJ3R1cnRsZXMnLCBsb2NhdGlvbjogY3JlYXRlTG9jYXRpb24oMSwgMCwgMTAsIDApfSxcclxuICAgICAgICB7XHJcbiAgICAgICAgICBraW5kOiBscy5TeW1ib2xLaW5kLk5hbWVzcGFjZSxcclxuICAgICAgICAgIG5hbWU6ICd0dXJ0bGVzJyxcclxuICAgICAgICAgIGxvY2F0aW9uOiBjcmVhdGVMb2NhdGlvbig0LCAwLCA4LCAwKSxcclxuICAgICAgICAgIGNvbnRhaW5lck5hbWU6ICd0dXJ0bGVzJyxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHtraW5kOiBscy5TeW1ib2xLaW5kLkNsYXNzLCBuYW1lOiAnZGlzYycsIGxvY2F0aW9uOiBjcmVhdGVMb2NhdGlvbig0LCAwLCA1LCAwKSwgY29udGFpbmVyTmFtZTogJ3R1cnRsZXMnfSxcclxuICAgICAgXTtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gT3V0bGluZVZpZXdBZGFwdGVyLmNyZWF0ZU91dGxpbmVUcmVlcyhzb3VyY2VJdGVtcyk7XHJcbiAgICAgIGV4cGVjdChyZXN1bHQubGVuZ3RoKS50by5lcXVhbCgxKTtcclxuICAgICAgY29uc3QgciA9IChyZXN1bHQ6IGFueSk7XHJcbiAgICAgIGV4cGVjdChyWzBdLmVuZFBvc2l0aW9uLnJvdykudG8uZXF1YWwoMTApO1xyXG4gICAgICBleHBlY3QoclswXS5jaGlsZHJlbi5sZW5ndGgpLnRvLmVxdWFsKDEpO1xyXG4gICAgICBleHBlY3QoclswXS5jaGlsZHJlblswXS5lbmRQb3NpdGlvbi5yb3cpLnRvLmVxdWFsKDgpO1xyXG4gICAgICBleHBlY3QoclswXS5jaGlsZHJlblswXS5jaGlsZHJlbi5sZW5ndGgpLnRvLmVxdWFsKDEpO1xyXG4gICAgICBleHBlY3QoclswXS5jaGlsZHJlblswXS5jaGlsZHJlblswXS5lbmRQb3NpdGlvbi5yb3cpLnRvLmVxdWFsKDUpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdzeW1ib2xUb091dGxpbmUnLCAoKSA9PiB7XHJcbiAgICBpdCgnY29udmVydHMgYW4gaW5kaXZpZHVhbCBpdGVtJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBzb3VyY2VJdGVtID0ge2tpbmQ6IGxzLlN5bWJvbEtpbmQuQ2xhc3MsIG5hbWU6ICdQcm9ncmFtJywgbG9jYXRpb246IGNyZWF0ZUxvY2F0aW9uKDEsIDIsIDMsIDQpfTtcclxuICAgICAgY29uc3QgcmVzdWx0ID0gT3V0bGluZVZpZXdBZGFwdGVyLnN5bWJvbFRvT3V0bGluZShzb3VyY2VJdGVtKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5pY29uKS50by5lcXVhbCgndHlwZS1jbGFzcycpO1xyXG4gICAgICBleHBlY3QocmVzdWx0LnJlcHJlc2VudGF0aXZlTmFtZSkudG8uZXF1YWwoJ1Byb2dyYW0nKTtcclxuICAgICAgZXhwZWN0KHJlc3VsdC5jaGlsZHJlbikudG8uZGVlcC5lcXVhbChbXSk7XHJcbiAgICAgIGNvbnN0IHIgPSAocmVzdWx0OiBhbnkpO1xyXG4gICAgICBleHBlY3Qoci50b2tlbml6ZWRUZXh0WzBdLmtpbmQpLnRvLmVxdWFsKCd0eXBlJyk7XHJcbiAgICAgIGV4cGVjdChyLnRva2VuaXplZFRleHRbMF0udmFsdWUpLnRvLmVxdWFsKCdQcm9ncmFtJyk7XHJcbiAgICAgIGV4cGVjdChyLnN0YXJ0UG9zaXRpb24ucm93KS50by5lcXVhbCgxKTtcclxuICAgICAgZXhwZWN0KHIuc3RhcnRQb3NpdGlvbi5jb2x1bW4pLnRvLmVxdWFsKDIpO1xyXG4gICAgICBleHBlY3Qoci5lbmRQb3NpdGlvbi5yb3cpLnRvLmVxdWFsKDMpO1xyXG4gICAgICBleHBlY3Qoci5lbmRQb3NpdGlvbi5jb2x1bW4pLnRvLmVxdWFsKDQpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXX0=